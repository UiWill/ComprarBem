(()=>{"use strict";var a={452:(a,t,o)=>{o.d(t,{EO:()=>n,ND:()=>r});var e=o(9119);const i="https://ruagsbbczuwgfflgcaol.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1YWdzYmJjenV3Z2ZmbGdjYW9sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0Njg5MDQsImV4cCI6MjA2MDA0NDkwNH0.S2KD6-9DpBYAOsodjibI7LGa04CspZZ5OdRQagNjoK8",r=(0,e.UU)(i,s),n=async()=>{const{data:a}=await r.auth.getSession(),t=a?.session?.user;return t?.user_metadata?.tenant_id||null}},3405:(a,t,o)=>{o.d(t,{enviarEmailParticipanteStatus:()=>n,lY:()=>l});var e=o(452),i=o(365);const s={from:{email:"cpm@suaorganizacao.com.br",name:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"},provider:{apiKey:{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_API_KEY,apiUrl:"https://api.sendgrid.v3/mail/send"}},r={diligencia:{subject:"Dilig√™ncia Solicitada - Produto em An√°lise",template:a=>`\n      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">\n        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center;">\n          <h1>üìã Dilig√™ncia Solicitada</h1>\n          <p>Comiss√£o de Padroniza√ß√£o de Materiais</p>\n        </div>\n        \n        <div style="padding: 30px; background: #f8f9fa;">\n          <h2 style="color: #333;">Prezado(a) Fornecedor,</h2>\n          \n          <p>Foi solicitada uma <strong>dilig√™ncia</strong> para o produto em an√°lise:</p>\n          \n          <div style="background: white; padding: 20px; border-left: 4px solid #667eea; margin: 20px 0;">\n            <h3 style="color: #667eea; margin-top: 0;">üì¶ Dados do Produto:</h3>\n            <p><strong>Nome:</strong> ${a.produto.nome}</p>\n            <p><strong>Marca:</strong> ${a.produto.marca}</p>\n            <p><strong>Modelo:</strong> ${a.produto.modelo}</p>\n            <p><strong>Fabricante:</strong> ${a.produto.fabricante}</p>\n          </div>\n          \n          <div style="background: #fff3cd; padding: 20px; border-left: 4px solid #ffc107; margin: 20px 0;">\n            <h3 style="color: #856404; margin-top: 0;">‚ö†Ô∏è Tipo de Dilig√™ncia:</h3>\n            <p><strong>${a.diligencia.tipo}</strong></p>\n            <p>${a.diligencia.descricao}</p>\n          </div>\n          \n          <div style="background: #f8d7da; padding: 20px; border-left: 4px solid #dc3545; margin: 20px 0;">\n            <h3 style="color: #721c24; margin-top: 0;">‚è∞ Prazo para Resposta:</h3>\n            <p><strong>${a.diligencia.prazo_dias} dias √∫teis</strong></p>\n            <p><strong>Data Limite:</strong> ${new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR")}</p>\n          </div>\n          \n          <div style="background: #d4edda; padding: 20px; border-left: 4px solid #28a745; margin: 20px 0;">\n            <h3 style="color: #155724; margin-top: 0;">üìù Instru√ß√µes:</h3>\n            <ul>\n              <li>Responda a esta dilig√™ncia dentro do prazo estabelecido</li>\n              <li>Envie todos os documentos solicitados em formato PDF</li>\n              <li>Em caso de d√∫vidas, entre em contato conosco</li>\n              <li>O n√£o atendimento da dilig√™ncia pode resultar na reprova√ß√£o do produto</li>\n            </ul>\n          </div>\n          \n          <div style="text-align: center; margin: 30px 0;">\n            <p style="color: #666;">Para responder esta dilig√™ncia, entre em contato atrav√©s do nosso sistema ou envie os documentos por email.</p>\n          </div>\n          \n          <hr style="border: none; border-top: 1px solid #ddd; margin: 30px 0;">\n          \n          <div style="color: #666; font-size: 12px;">\n            <p><strong>CPM - Comiss√£o de Padroniza√ß√£o de Materiais</strong></p>\n            <p>Este √© um email autom√°tico. N√£o responda diretamente a este email.</p>\n            <p>Data de envio: ${(new Date).toLocaleDateString("pt-BR")} √†s ${(new Date).toLocaleTimeString("pt-BR")}</p>\n          </div>\n        </div>\n      </div>\n    `},participanteStatus:{subject:"{{titulo status}}",template:a=>`\nSUBJECT: ${"aprovado"===a.status?"‚úÖ APROVADO":"‚ùå REJEITADO"} - Sua empresa foi ${"aprovado"===a.status?"aprovada":"rejeitada"} no Edital ${a.numero_edital}\n\nPrezado(a) ${a.representante_legal},\n\n${"aprovado"===a.status?"√â com grande satisfa√ß√£o que informamos que sua empresa foi APROVADA para participar do processo de pr√©-qualifica√ß√£o!":"Informamos que sua empresa foi REJEITADA no processo de pr√©-qualifica√ß√£o."}\n\n=== DADOS DA EMPRESA ===\nRaz√£o Social: ${a.razao_social}\nCNPJ: ${a.cnpj}\nRepresentante Legal: ${a.representante_legal}\nEmail: ${a.email_empresa}\nTelefone: ${a.telefone}\n\n=== DADOS DO EDITAL ===\nN√∫mero: ${a.numero_edital}\nDescri√ß√£o: ${a.descricao_edital}\nData da Decis√£o: ${a.data_decisao}\nStatus: ${a.status.toUpperCase()}\n\n${"aprovado"===a.status?`=== PR√ìXIMOS PASSOS ===\n1. Documenta√ß√£o T√©cnica: Envie os documentos t√©cnicos dos produtos conforme especificado no edital\n2. Amostras (se aplic√°vel): Providencie as amostras f√≠sicas quando solicitado\n3. An√°lise CPM: Aguarde a an√°lise t√©cnica da Comiss√£o de Padroniza√ß√£o de Materiais\n4. Emiss√£o DCB: Ap√≥s aprova√ß√£o t√©cnica, ser√° emitido o DCB (Declara√ß√£o de Conformidade de Bem)\n5. Cat√°logo Eletr√¥nico: Produtos aprovados entrar√£o no cat√°logo para licita√ß√µes\n\n=== INFORMA√á√ïES IMPORTANTES ===\n- Esta aprova√ß√£o √© para participa√ß√£o no processo, n√£o garante aprova√ß√£o final dos produtos\n- Todos os produtos passar√£o por an√°lise t√©cnica rigorosa pela CPM\n- Documenta√ß√£o incompleta ou inadequada pode resultar em reprova√ß√£o\n- Mantenha seus dados atualizados em nosso sistema\n- Acompanhe o status atrav√©s do nosso portal\n\n=== PRAZOS ===\nEnvio de Documenta√ß√£o: ${a.prazo_documentacao}\nAn√°lise T√©cnica: At√© 30 dias √∫teis ap√≥s recebimento completo\nResultado Final: Ser√° comunicado por email e sistema`:`=== MOTIVO DA REJEI√á√ÉO ===\n${a.motivo_rejeicao||"Documenta√ß√£o n√£o atende aos requisitos do edital"}\n\n=== COMO PROCEDER ===\n- Revise a documenta√ß√£o enviada\n- Corrija os problemas identificados\n- Voc√™ pode se candidatar novamente em editais futuros\n- Em caso de d√∫vidas, entre em contato conosco`}\n\n=== CONTATO ===\nEmail: ${a.email_suporte}\nTelefone: ${a.telefone_suporte}\nHor√°rio: Segunda a Sexta, 8h √†s 17h\n\n=== SISTEMA COMPRARBEM ===\nAcesse: ${a.link_sistema}\n\n${a.nome_organizacao}\nEmail: ${a.email_organizacao}\nTelefone: ${a.telefone_organizacao}\nEndere√ßo: ${a.endereco_organizacao}\n\n---\nEste √© um email autom√°tico. N√£o responda diretamente a este email.\nEmail enviado em ${a.data_envio} √†s ${a.hora_envio}\n    `}};async function n(a,t,o="aprovado",e=null){try{console.log(`üìß Iniciando envio de email de ${o} para participante...`,a.email);const s={representante_legal:a.representante_legal,razao_social:a.razao_social,cnpj:a.cnpj,email_empresa:a.email,telefone:a.telefone||"N√£o informado",status:o,motivo_rejeicao:e,numero_edital:t.numero||"N/A",descricao_edital:t.descricao||"Edital de Pr√©-Qualifica√ß√£o",data_decisao:(new Date).toLocaleDateString("pt-BR"),prazo_documentacao:"30 dias √∫teis a partir desta data",link_sistema:window.location.origin,email_suporte:"comprarbemteste@gmail.com",telefone_suporte:"(61) 3315-2425",nome_organizacao:"Minist√©rio da Sa√∫de",email_organizacao:"cpm@saude.gov.br",telefone_organizacao:"(61) 3315-2425",endereco_organizacao:"Bras√≠lia - DF",data_envio:(new Date).toLocaleDateString("pt-BR"),hora_envio:(new Date).toLocaleTimeString("pt-BR")},n=r.participanteStatus.template(s),l="aprovado"===o?`‚úÖ APROVADO - Sua empresa foi aprovada no Edital ${s.numero_edital}`:`‚ùå REJEITADO - Sua empresa foi rejeitada no Edital ${s.numero_edital}`,d={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"},u={numero_edital:s.numero_edital,email_empresa:s.email_empresa,message:n,name:s.representante_legal,email:s.email_suporte,subject:l,status_participante:o,motivo_rejeicao:e||""};console.log(`üìß Enviando email de ${o} via EmailJS...`),console.log("üìß Para:",s.email_empresa),console.log("üìß Edital:",s.numero_edital),console.log("üìß Subject:",l),console.log("üìß Status:",o),console.log("üìß Motivo Rejei√ß√£o:",e),console.log("üìß Par√¢metros EmailJS:",u);const m=await i.Ay.send(d.serviceId,d.templateId,u,d.publicKey);return console.log(`üéâ EMAIL DE ${o.toUpperCase()} ENVIADO COM SUCESSO!`,m),await c({tipo:`participante_${o}`,destinatario:a.email,assunto:l,participante_id:a.id,edital_id:t.id,status:"enviado"}),{sucesso:!0,mensagem:`Email de ${o} enviado com sucesso!`,destinatario:a.email}}catch(s){throw console.error(`‚ùå Erro ao enviar email de ${o}:`,s),await c({tipo:`participante_${o}`,destinatario:a.email,assunto:`${"aprovado"===o?"‚úÖ APROVADO":"‚ùå REJEITADO"} - Edital ${t.numero}`,participante_id:a.id,edital_id:t.id,status:"erro",erro:s.message}),new Error(`Falha ao enviar email de ${o}: `+s.message)}}async function l(a){try{console.log("üìß Iniciando envio de email de dilig√™ncia...",a);try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);t.emailRemetente&&(s.from.email=t.emailRemetente),t.nomeRemetente&&(s.from.name=t.nomeRemetente)}}catch(t){console.error("Erro ao carregar configura√ß√µes do usu√°rio:",t)}if(!a.produto||!a.diligencia||!a.destinatario)throw new Error("Dados incompletos para envio do email");const l={personalizations:[{to:[{email:a.destinatario,name:a.produto.fabricante}]}],from:{email:s.from.email,name:s.from.name},subject:r.diligencia.subject,content:[{type:"text/html",value:r.diligencia.template(a)}]},{data:c,error:d}=await e.ND.from("emails_enviados").insert({tipo:"diligencia",destinatario:a.destinatario,assunto:r.diligencia.subject,produto_id:a.produto.id,diligencia_id:a.diligencia.id,status:"enviando",tentativas:1}).select().single();if(d&&console.error("‚ùå Erro ao registrar log de email:",d),"sendgrid"==={NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_PROVIDER&&{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_SENDGRID_API_KEY){console.log("üìß Enviando email via EmailJS (usando SendGrid configurado)...");try{const t={to_email:a.destinatario,fabricante:a.produto.fabricante,produto_nome:a.produto.nome,produto_marca:a.produto.marca,produto_modelo:a.produto.modelo,cnpj:a.produto.cnpj||"N√£o informado",tipo_diligencia:a.diligencia.tipo,descricao_diligencia:a.diligencia.descricao,prazo_dias:"30",data_limite:new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR"),data_envio:(new Date).toLocaleDateString("pt-BR")+" √†s "+(new Date).toLocaleTimeString("pt-BR"),nome_responsavel:"William Martins",cargo_responsavel:"Analista CPM",email_responsavel:"comprarbemteste@gmail.com"};console.log("üìß Enviando email via EmailJS..."),console.log("üìß Dados preparados:",t);const s={serviceId:"service_7sv1naw",templateId:"template_vbp986f",publicKey:"DqGKMNJ87ch3qVxGv"};try{console.log("üìß Enviando email REAL via EmailJS..."),console.log("üìß Configura√ß√£o:",s),console.log("üìß Dados:",t);const a=await i.Ay.send(s.serviceId,s.templateId,t,s.publicKey);console.log("üéâ EMAIL ENVIADO COM SUCESSO!",a)}catch(o){throw console.error("‚ùå Erro no EmailJS:",o),o}return c&&await e.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString(),corpo:t.message}).eq("id",c.id),console.log("‚úÖ EMAIL PREPARADO COM SUCESSO!"),console.log("üìß Para:",t.to_email),console.log("üìß Assunto:",t.subject),{success:!0,message:"Email preparado com sucesso! (SendGrid configurado)",emailId:c?.id}}catch(n){return console.error("‚ùå Erro ao preparar email:",n),c&&await e.ND.from("emails_enviados").update({status:"desenvolvimento",data_envio:(new Date).toISOString(),erro_detalhes:"Erro na prepara√ß√£o do email"}).eq("id",c.id),{success:!0,message:"Dilig√™ncia criada (modo desenvolvimento)",emailId:c?.id,development:!0}}}return console.log("üîÑ Modo desenvolvimento - Simulando envio de email"),console.log("üìß Email Data:",l),await new Promise((a=>setTimeout(a,1e3))),c&&await e.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString()}).eq("id",c.id),{success:!0,message:"Email enviado com sucesso (simulado)",emailId:c?.id}}catch(t){return console.error("‚ùå Erro ao enviar email de dilig√™ncia:",t),{success:!1,message:t.message||"Erro interno no envio do email",error:t}}}async function c(a){try{const{error:t}=await e.ND.from("emails_enviados").insert({tipo:a.tipo,destinatario:a.destinatario,assunto:a.assunto,participante_id:a.participante_id||null,edital_id:a.edital_id||null,produto_id:a.produto_id||null,diligencia_id:a.diligencia_id||null,status:a.status,erro:a.erro||null,tentativas:1,criado_em:(new Date).toISOString()});t?console.warn("‚ö†Ô∏è Erro ao registrar email no banco:",t):console.log("‚úÖ Email registrado no banco com sucesso")}catch(t){console.warn("‚ö†Ô∏è Falha ao registrar email no banco:",t)}}const d={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};i.Ay.init(d.publicKey)},3608:(a,t,o)=>{var e=o(6848),i=function(){var a=this,t=a._self._c;return t("div",{attrs:{id:"app"}},[t("router-view"),t("AIChat")],1)},s=[],r=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ai-chat",class:{"ai-chat--expanded":a.isExpanded}},[a.isExpanded?t("div",{staticClass:"ai-chat__window"},[t("div",{staticClass:"ai-chat__header"},[a._m(1),t("button",{staticClass:"ai-chat__close",on:{click:a.toggleChat}},[t("i",{staticClass:"fas fa-times"})])]),t("div",{ref:"messagesContainer",staticClass:"ai-chat__messages"},[a._l(a.messages,(function(o,e){return t("div",{key:e,class:["ai-chat__message",`ai-chat__message--${o.type}`,{"ai-chat__message--status":o.isStatus}]},["assistant"===o.type?t("div",{staticClass:"ai-chat__message-avatar"},[t("i",{staticClass:"fas fa-robot"}),t("i",{staticClass:"fas fa-bolt ai-chat__bolt-small"})]):a._e(),t("div",{staticClass:"ai-chat__message-content"},[o.isStatus?t("span",{staticClass:"ai-chat__status-text"},[t("i",{staticClass:"fas fa-spinner fa-spin"}),a._v(" "+a._s(o.text)+" ")]):t("span",[a._v(a._s(o.text))])])])})),a.isLoading?t("div",{staticClass:"ai-chat__message ai-chat__message--assistant"},[a._m(2),a._m(3)]):a._e()],2),t("div",{staticClass:"ai-chat__input"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.currentMessage,expression:"currentMessage"}],attrs:{placeholder:"Digite sua d√∫vida sobre licita√ß√µes...",rows:"2"},domProps:{value:a.currentMessage},on:{keydown:function(t){return!t.type.indexOf("key")&&a._k(t.keyCode,"enter",13,t.key,"Enter")?null:(t.preventDefault(),a.sendMessage.apply(null,arguments))},input:function(t){t.target.composing||(a.currentMessage=t.target.value)}}}),t("button",{staticClass:"ai-chat__send",attrs:{disabled:a.isLoading||!a.currentMessage.trim()},on:{click:a.sendMessage}},[t("i",{staticClass:"fas fa-paper-plane"})])])]):t("button",{staticClass:"ai-chat__button",attrs:{title:"QualiBot 2.0 - Seu Assistente de Licita√ß√µes"},on:{click:a.toggleChat}},[a._m(0),a.hasInteracted?a._e():t("div",{staticClass:"ai-chat__notification"},[t("i",{staticClass:"fas fa-bolt"}),a._v(" Como posso ajudar? ")])])])},n=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"ai-chat__button-content"},[t("i",{staticClass:"fas fa-robot"}),t("span",{staticClass:"ai-chat__button-label"},[a._v("QualiBot 2.0")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"ai-chat__header-info"},[t("div",{staticClass:"ai-chat__logo"},[t("i",{staticClass:"fas fa-robot"}),t("i",{staticClass:"fas fa-bolt ai-chat__bolt"})]),t("div",[t("h3",[a._v("QualiBot 2.0")]),t("span",{staticClass:"ai-chat__status"},[t("span",{staticClass:"ai-chat__status-dot"}),a._v(" Online e Pronto ")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"ai-chat__message-avatar"},[t("i",{staticClass:"fas fa-robot"}),t("i",{staticClass:"fas fa-bolt ai-chat__bolt-small"})])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"ai-chat__typing"},[t("span"),t("span"),t("span")])}];const l="AIzaSyAf-Oe56q4Rao0OodEOtnEjtI_FpOmDg6I",c=[{name:"gemini-2.0-flash-exp",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",description:"Gemini 2.0 Flash (Mais Novo e R√°pido - Experimental)"},{name:"gemini-1.5-flash",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent",description:"Gemini 1.5 Flash (R√°pido e Eficiente)"},{name:"gemini-1.5-pro",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",description:"Gemini 1.5 Pro (Mais Avan√ßado)"},{name:"gemini-1.0-pro",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.0-pro:generateContent",description:"Gemini 1.0 Pro (Vers√£o Est√°vel)"}],d={maxRetries:3,baseDelay:800,maxDelay:12e3,backoffFactor:1.8},u=a=>new Promise((t=>setTimeout(t,a))),m=a=>{const t=d.baseDelay*Math.pow(d.backoffFactor,a);return Math.min(t,d.maxDelay)},p=(a,t)=>{if(a&&a.message&&a.message.includes("Failed to fetch"))return!0;if(t){const a=t.status;return 429===a||503===a||502===a||504===a}return!1},v=a=>{try{return JSON.parse(a)}catch(t){return console.error("Erro ao fazer parse do JSON:",t),console.error("Texto que causou erro:",a),null}},g=async(a,t,o=0)=>{try{const e=`${a.url}?key=${l}`;console.log(`Tentando modelo ${a.name} (tentativa ${o+1}/${d.maxRetries+1})`);const i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contents:[{parts:[{text:`Voc√™ √© o QualiBot 2.0, um assistente especializado em licita√ß√µes e compras p√∫blicas, com foco em ajudar os usu√°rios de forma r√°pida e eficiente. Responda a seguinte pergunta de forma clara e objetiva, usando sua expertise em licita√ß√µes: ${t}`}]}]})});console.log(`Resposta do modelo ${a.name}:`,{status:i.status,statusText:i.statusText,ok:i.ok});const s=await i.text();if(!i.ok){const e=p(null,i);if(e&&o<d.maxRetries){const e=m(o);return console.log(`Erro tempor√°rio (${i.status}) no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,t,o+1)}let r=v(s);r||(r={error:{message:`Erro HTTP ${i.status}: ${i.statusText||"Erro desconhecido"}`}}),console.error(`Erro no modelo ${a.name}:`,r);let n=`Modelo ${a.name} falhou`;throw r.error&&r.error.message?n+=`: ${r.error.message}`:n+=`: ${i.status} ${i.statusText||"Erro desconhecido"}`,new Error(n)}const r=v(s);if(!r){if(o<d.maxRetries){const e=m(o);return console.log(`Erro de parse no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,t,o+1)}throw new Error(`Modelo ${a.name} retornou resposta inv√°lida`)}if(!r.candidates||!r.candidates[0]?.content?.parts?.[0]?.text){if(console.error(`Formato inv√°lido no modelo ${a.name}:`,r),o<d.maxRetries){const e=m(o);return console.log(`Formato inv√°lido no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,t,o+1)}throw new Error(`Modelo ${a.name} retornou formato inv√°lido`)}return console.log(`‚úÖ Sucesso com modelo ${a.name}!`),{text:r.candidates[0].content.parts[0].text,modelUsed:a.name}}catch(e){if(console.error(`Erro na tentativa ${o+1} do modelo ${a.name}:`,e),p(e,null)&&o<d.maxRetries){const e=m(o);return console.log(`Erro de rede no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,t,o+1)}throw e}},_={async chat(a){let t=null,o=[];for(let i=0;i<c.length;i++){const s=c[i];o.push(s.name);try{console.log(`üöÄ Tentando modelo ${i+1}/${c.length}: ${s.name}`);const t=await g(s,a);return console.log(`‚úÖ Resposta obtida com sucesso usando: ${t.modelUsed}`),t.text}catch(e){if(t=e,console.error(`‚ùå Modelo ${s.name} falhou:`,e.message),i<c.length-1){console.log(`üîÑ Tentando pr√≥ximo modelo: ${c[i+1].name}`);continue}}}if(console.error("‚ùå Todos os modelos falharam. Modelos tentados:",o),console.error("√öltimo erro:",t),t&&t.message&&t.message.includes("Failed to fetch"))throw new Error("N√£o foi poss√≠vel conectar aos servi√ßos de IA. Verifique sua conex√£o com a internet.");if(t&&t.message&&(t.message.includes("503")||t.message.includes("sobrecarregado")))throw new Error("Todos os servi√ßos de IA est√£o temporariamente sobrecarregados. Tente novamente em alguns minutos.");if(t&&t.message&&t.message.includes("429"))throw new Error("Limite de requisi√ß√µes atingido. Aguarde alguns minutos antes de tentar novamente.");throw new Error("Todos os servi√ßos de IA est√£o temporariamente indispon√≠veis. Tente novamente mais tarde.")}},f={name:"AIChat",data(){return{isExpanded:!1,hasInteracted:!1,messages:[{type:"assistant",text:"Ol√°! Sou o QualiBot 2.0, seu assistente virtual especializado em licita√ß√µes e compras p√∫blicas. Como posso ajudar hoje?"}],currentMessage:"",isLoading:!1}},methods:{toggleChat(){this.isExpanded=!this.isExpanded,this.hasInteracted=!0,this.isExpanded&&this.$nextTick((()=>{this.scrollToBottom()}))},async sendMessage(){if(!this.currentMessage.trim()||this.isLoading)return;const a=this.currentMessage.trim();this.messages.push({type:"user",text:a}),this.currentMessage="",this.isLoading=!0;const t={type:"assistant",text:"Processando sua solicita√ß√£o...",isStatus:!0};this.messages.push(t);const o=a=>{const t=this.messages.findIndex((a=>a.isStatus));-1!==t&&(this.messages[t].text=a)},e=console.log;console.log=(...a)=>{const t=a.join(" ");if(t.includes("üöÄ Tentando modelo")){const a=t.match(/üöÄ Tentando modelo \d+\/\d+: (.+)/);a&&o(`Tentando modelo ${a[1]}...`)}else if(t.includes("Erro tempor√°rio"))o("Erro tempor√°rio detectado, tentando novamente...");else if(t.includes("üîÑ Tentando pr√≥ximo modelo")){const a=t.match(/üîÑ Tentando pr√≥ximo modelo: (.+)/);if(a){let t=a[1];t.includes("gemini-2.0-flash-exp")?t="Gemini 2.0 Flash (Experimental)":t.includes("gemini-1.5-flash")?t="Gemini 1.5 Flash":t.includes("gemini-1.5-pro")?t="Gemini 1.5 Pro":t.includes("gemini-1.0-pro")&&(t="Gemini 1.0 Pro"),o(`Tentando modelo alternativo: ${t}...`)}}e.apply(console,a)};try{const t=await _.chat(a);console.log=e;const o=this.messages.findIndex((a=>a.isStatus));-1!==o&&this.messages.splice(o,1),this.messages.push({type:"assistant",text:t})}catch(i){console.error("Erro no chat:",i),console.log=e;const a=this.messages.findIndex((a=>a.isStatus));-1!==a&&this.messages.splice(a,1);let t="Desculpe, estou enfrentando algumas dificuldades t√©cnicas no momento.";i.message.includes("sobrecarregado")||i.message.includes("overloaded")?t="O servi√ßo est√° temporariamente sobrecarregado devido ao alto volume de usu√°rios. J√° tentei v√°rias vezes automaticamente. Por favor, aguarde alguns minutos e tente novamente.":i.message.includes("conex√£o")||i.message.includes("network")?t="Problema de conex√£o detectado. Verifique sua internet e tente novamente.":(i.message.includes("indispon√≠vel")||i.message.includes("unavailable"))&&(t="O servi√ßo est√° temporariamente indispon√≠vel. Nossa equipe j√° est√° trabalhando nisso. Tente novamente em alguns minutos."),this.messages.push({type:"assistant",text:t+"\n\nüí° **Dica**: Se o problema persistir, voc√™ pode tentar reformular sua pergunta ou contactar o suporte atrav√©s do menu principal."})}finally{this.isLoading=!1,this.$nextTick((()=>{this.scrollToBottom()}))}},scrollToBottom(){const a=this.$refs.messagesContainer;a.scrollTop=a.scrollHeight}}},h=f;var C=o(1656),b=(0,C.A)(h,r,n,!1,null,"26facc0e",null);const w=b.exports,D={name:"App",components:{AIChat:w}},E=D;var x=(0,C.A)(E,i,s,!1,null,null,null);const y=x.exports;var A=o(6178),P=function(){var a=this,t=a._self._c;return t("div",{staticClass:"home"},[t("Login")],1)},S=[],$=function(){var a=this,t=a._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-card"},[t("h2",[a._v("Comprar Bem: Compras Inteligentes")]),t("p",[a._v("Sa√∫de e Administra√ß√£o")]),t("div",{staticClass:"tabs"},[t("button",{class:{active:"login"===a.activeTab},on:{click:function(t){a.activeTab="login"}}},[a._v("Login")]),t("button",{class:{active:"register"===a.activeTab},on:{click:function(t){a.activeTab="register"}}},[a._v("Registrar")])]),"login"===a.activeTab?t("div",[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("E-mail")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.email,expression:"email"}],attrs:{id:"email",type:"email",placeholder:"Seu e-mail",required:""},domProps:{value:a.email},on:{input:function(t){t.target.composing||(a.email=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"password"}},[a._v("Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.password,expression:"password"}],attrs:{id:"password",type:"password",placeholder:"Sua senha",required:""},domProps:{value:a.password},on:{input:function(t){t.target.composing||(a.password=t.target.value)}}})]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.loading},on:{click:a.login}},[a._v(" "+a._s(a.loading?"Entrando...":"Entrar")+" ")])]):a._e(),"register"===a.activeTab?t("div",[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registerEmail"}},[a._v("E-mail")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.registerEmail,expression:"registerEmail"}],attrs:{id:"registerEmail",type:"email",placeholder:"Seu e-mail",required:""},domProps:{value:a.registerEmail},on:{input:function(t){t.target.composing||(a.registerEmail=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registerPassword"}},[a._v("Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.registerPassword,expression:"registerPassword"}],attrs:{id:"registerPassword",type:"password",placeholder:"Sua senha",required:""},domProps:{value:a.registerPassword},on:{input:function(t){t.target.composing||(a.registerPassword=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"confirmPassword"}},[a._v("Confirmar Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.confirmPassword,expression:"confirmPassword"}],attrs:{id:"confirmPassword",type:"password",placeholder:"Confirme sua senha",required:""},domProps:{value:a.confirmPassword},on:{input:function(t){t.target.composing||(a.confirmPassword=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeInstitucional"}},[a._v("Nome da Institui√ß√£o")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nomeInstitucional,expression:"nomeInstitucional"}],attrs:{id:"nomeInstitucional",type:"text",placeholder:"Nome da sua institui√ß√£o",required:""},domProps:{value:a.nomeInstitucional},on:{input:function(t){t.target.composing||(a.nomeInstitucional=t.target.value)}}})]),t("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:a.register}},[a._v(" "+a._s(a.loading?"Registrando...":"Registrar")+" ")]),t("button",{staticClass:"btn-test",staticStyle:{"margin-top":"10px"},on:{click:a.testeSimples}},[a._v(" Teste Simples ")]),a.validRegistration?a._e():t("div",{staticClass:"validation-info"},[t("p",[a._v("O formul√°rio n√£o est√° v√°lido porque:")]),t("ul",[a.registerEmail?a._e():t("li",[a._v("Falta o e-mail")]),a.registerPassword?a._e():t("li",[a._v("Falta a senha")]),a.registerPassword&&a.registerPassword.length<6?t("li",[a._v("A senha precisa ter pelo menos 6 caracteres")]):a._e(),a.registerPassword!==a.confirmPassword?t("li",[a._v("As senhas n√£o conferem")]):a._e(),a.nomeInstitucional?a._e():t("li",[a._v("Falta o nome da institui√ß√£o")])])])]):a._e(),a.errorMsg?t("p",{staticClass:"error-message"},[a._v(a._s(a.errorMsg))]):a._e(),t("div",{staticClass:"rdm-access"},[t("hr",{staticStyle:{margin:"20px 0"}}),a._m(0),t("router-link",{staticClass:"btn-rdm",attrs:{to:"/rdm"}},[a._v(" üìù Acessar Dashboard RDM ")]),t("p",{staticStyle:{"font-size":"12px",color:"#888","text-align":"center","margin-top":"10px"}},[a._v(" Para usu√°rios cadastrados emitir Requisi√ß√µes de Materiais ")])],1),t("div",{staticClass:"public-access"},[t("hr",{staticStyle:{margin:"20px 0"}}),a._m(1),t("router-link",{staticClass:"btn-public",attrs:{to:"/catalogo-publico"}},[a._v(" üîç Ver Cat√°logo e Avaliar Produtos ")]),t("p",{staticStyle:{"font-size":"12px",color:"#888","text-align":"center","margin-top":"10px"}},[a._v(" Acesso p√∫blico para consultar produtos e registrar avalia√ß√µes ")])],1),"register"===a.activeTab?t("div",{staticClass:"test-buttons"},[t("button",{staticClass:"btn-test",on:{click:a.testarSupabase}},[a._v("Testar Conex√£o Supabase")])]):a._e()])])},N=[function(){var a=this,t=a._self._c;return t("p",{staticStyle:{"text-align":"center",color:"#666","margin-bottom":"15px"}},[t("strong",[a._v("üè• Sistema RDM Online")])])},function(){var a=this,t=a._self._c;return t("p",{staticStyle:{"text-align":"center",color:"#666","margin-bottom":"15px"}},[t("strong",[a._v("üìã Cat√°logo P√∫blico de Produtos")])])}],R=o(452),I=o(4963);const M={name:"Login",data(){return{activeTab:"login",email:"",password:"",registerEmail:"",registerPassword:"",confirmPassword:"",nomeInstitucional:"",loading:!1,errorMsg:""}},computed:{validRegistration(){return this.registerEmail&&this.registerPassword&&this.registerPassword===this.confirmPassword&&this.nomeInstitucional&&this.registerPassword.length>=6}},mounted(){console.log("Componente Login montado",{activeTab:this.activeTab})},watch:{activeTab(a){console.log("Aba ativa alterada para:",a)},registerEmail(a){console.log("E-mail de registro alterado:",a)},registerPassword(a){console.log("Senha de registro alterada:",a?"****":"")}},methods:{async testarSupabase(){console.log("Testando conex√£o com Supabase...");try{const{data:a,error:t}=await R.ND.from("tenants").select("*").limit(1);console.log("Resultado do teste tabela tenants:",{data:a,error:t}),t?alert(`Erro ao acessar tabela: ${t.message}`):alert(`Conex√£o OK! ${a?a.length:0} registros encontrados.`);const o=(0,I.A)();console.log("Teste UUID gerado:",o)}catch(a){console.error("Erro no teste:",a),alert(`Erro na conex√£o: ${a.message}`)}},async login(){try{this.loading=!0,this.errorMsg="";const{error:a}=await R.ND.auth.signInWithPassword({email:this.email,password:this.password});if(a)throw a;this.$router.push("/dashboard")}catch(a){this.errorMsg=a.message||"Erro ao fazer login"}finally{this.loading=!1}},async register(){if(console.log("M√©todo register chamado",{email:this.registerEmail,password:"****",nomeInstitucional:this.nomeInstitucional}),!this.validRegistration)return console.log("Formul√°rio inv√°lido"),void(this.errorMsg="Verifique os campos do formul√°rio");try{this.loading=!0,this.errorMsg="",console.log("Iniciando registro de usu√°rio no Supabase...");const{data:t,error:o}=await R.ND.auth.signUp({email:this.registerEmail,password:this.registerPassword});if(console.log("Resposta do registro de usu√°rio:",{authData:t,authError:o}),o&&!o.message.includes("already registered"))throw o;const e=t?.user?.id;console.log("ID da autentica√ß√£o:",e);const i=(0,I.A)(),s=(0,I.A)();try{const{error:a}=await R.ND.from("usuarios").delete().eq("email",this.registerEmail);a&&console.warn("Aviso ao tentar remover usu√°rio existente:",a)}catch(a){console.warn("Erro ao tentar remover usu√°rio:",a)}console.log("Criando tenant...");const{data:r,error:n}=await R.ND.from("tenants").insert({id:i,nome:this.nomeInstitucional,descricao:`Tenant para ${this.registerEmail}`,ativo:!0}).select();if(n)throw new Error(`Erro ao criar tenant: ${n.message}`);console.log("Criando usu√°rio...");const{data:l,error:c}=await R.ND.from("usuarios").insert({id:s,email:this.registerEmail,nome:this.nomeInstitucional,tenant_id:i,tipo:"admin",ativo:!0}).select();if(c)throw c.message.includes("duplicate key")?(this.errorMsg="Este email j√° est√° registrado. Por favor, contate o suporte.",new Error(`Email j√° existe na base de dados: ${c.message}`)):new Error(`Erro ao criar usu√°rio: ${c.message}`);console.log("Atualizando tenant com user_id...");const{error:d}=await R.ND.from("tenants").update({user_id:e}).eq("id",i);d&&console.warn("Aviso: N√£o foi poss√≠vel atualizar o tenant com user_id:",d),console.log("Registro conclu√≠do com sucesso!"),alert("Registro realizado com sucesso! Verifique seu e-mail para confirmar a conta."),this.activeTab="login",this.email=this.registerEmail}catch(t){console.error("Erro detalhado no registro:",t),this.errorMsg=this.errorMsg||t.message||"Erro ao fazer registro"}finally{this.loading=!1}},testeSimples(){console.log("Bot√£o de teste simples clicado"),alert("Teste de evento de clique funcionando!")}}},F=M;var T=(0,C.A)(F,$,N,!1,null,"a93d22ca",null);const z=T.exports,k={name:"Home",components:{Login:z}},O=k;var B=(0,C.A)(O,P,S,!1,null,null,null);const q=B.exports;var L=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("‚ñº")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("DashboardCPM")],1)])},V=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])}],U=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard"},[t("h2",[a._v("Painel CPM")]),t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab",class:{active:"dashboard"===a.activeTab},on:{click:function(t){a.activeTab="dashboard"}}},[a._v(" Dashboard ")]),t("div",{staticClass:"tab",class:{active:"editais"===a.activeTab},on:{click:function(t){a.activeTab="editais"}}},[a._v(" Editais de Pr√©-Qualifica√ß√£o ")]),t("div",{staticClass:"tab",class:{active:"pesquisa"===a.activeTab},on:{click:function(t){a.activeTab="pesquisa"}}},[a._v(" Pesquisa de Mercado ")]),t("div",{staticClass:"tab",class:{active:"despadronizadas"===a.activeTab},on:{click:function(t){a.activeTab="despadronizadas"}}},[a._v(" Marcas Despadronizadas ")]),t("div",{staticClass:"tab",class:{active:"certificados"===a.activeTab},on:{click:function(t){a.activeTab="certificados"}}},[a._v(" Emiss√£o de Certificados (DCB) ")]),t("div",{staticClass:"tab",class:{active:"usuarios"===a.activeTab},on:{click:function(t){a.activeTab="usuarios"}}},[a._v(" Cadastro de Usu√°rios ")]),t("div",{staticClass:"tab",class:{active:"reclamacoes"===a.activeTab},on:{click:function(t){a.activeTab="reclamacoes"}}},[a._v(" Avalia√ß√µes de Usu√°rios ")])]),"dashboard"===a.activeTab?t("div",[t("div",{staticClass:"stats-container"},[t("div",{staticClass:"stat-card status-pendente-card"},[t("h3",[a._v("Produtos em Avalia√ß√£o")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))])]),t("div",{staticClass:"stat-card status-aprovado-card"},[t("h3",[a._v("Produtos Aprovados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))])]),t("div",{staticClass:"stat-card status-reprovado-card"},[t("h3",[a._v("Produtos Reprovados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.reprovados))])])]),t("div",{staticClass:"recent-products"},[t("div",{staticClass:"section-header"},[t("h3",[a._v("üìã Requerimentos Recentes")]),t("div",{staticClass:"pagination-controls"},[t("label",[a._v("Itens por p√°gina:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPagina,expression:"itensPorPagina"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.itensPorPagina=t.target.multiple?o:o[0]},a.aplicarPaginacao]}},[t("option",{attrs:{value:"5"}},[a._v("5")]),t("option",{attrs:{value:"10"}},[a._v("10")]),t("option",{attrs:{value:"20"}},[a._v("20")]),t("option",{attrs:{value:"50"}},[a._v("50")])])])]),t("div",{staticClass:"filtros-inline"},[t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üî§ Nome:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.nome,expression:"filtros.nome"}],attrs:{type:"text",placeholder:"Filtrar por nome..."},domProps:{value:a.filtros.nome},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"nome",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üè∑Ô∏è Marca:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.marca,expression:"filtros.marca"}],attrs:{type:"text",placeholder:"Filtrar por marca..."},domProps:{value:a.filtros.marca},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"marca",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üìä Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"pendente"}},[a._v("Em Avalia√ß√£o")]),t("option",{attrs:{value:"aprovado"}},[a._v("Aprovado")]),t("option",{attrs:{value:"reprovado"}},[a._v("Reprovado")]),t("option",{attrs:{value:"em_analise"}},[a._v("Em An√°lise")])])]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üìÖ Data:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.data,expression:"filtros.data"}],attrs:{type:"date"},domProps:{value:a.filtros.data},on:{change:a.aplicarFiltros,input:function(t){t.target.composing||a.$set(a.filtros,"data",t.target.value)}}})]),t("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar ")])]),a.produtosPaginados.length>0?t("table",[a._m(0),t("tbody",a._l(a.produtosPaginados,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.nome))]),t("td",[a._v(a._s(o.marca))]),t("td",[a._v(a._s(a.formatarEdital(o)))]),t("td",["aprovado"===o.status||"julgado_aprovado"===o.status||"homologado"===o.status?t("span",{staticStyle:{"background-color":"#2ecc71",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")]):"reprovado"===o.status||"julgado_reprovado"===o.status?t("span",{staticStyle:{"background-color":"#e74c3c",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")]):"pendente"===o.status?t("span",{staticStyle:{"background-color":"#f39c12",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")]):"em_analise"===o.status?t("span",{staticStyle:{"background-color":"#3498db",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")]):"diligencia"===o.status?t("span",{staticStyle:{"background-color":"#9b59b6",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")]):t("span",{staticStyle:{"background-color":"#6c757d",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")])]),t("td",[a._v(a._s(a.formatDate(o.criado_em)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.verProduto(o.id)}}},[a._v("Visualizar")])])])})),0)]):a._e(),a.totalPaginas>1?t("div",{staticClass:"paginacao"},[t("div",{staticClass:"paginacao-info"},[a._v(" P√°gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),t("div",{staticClass:"paginacao-botoes"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtual},on:{click:function(t){return a.irParaPagina(a.paginaAtual-1)}}},[a._v(" ‚óÄÔ∏è Anterior ")]),t("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveis,(function(o){return t("button",{key:o,class:["btn-numero",{active:o===a.paginaAtual}],on:{click:function(t){return a.irParaPagina(o)}}},[a._v(" "+a._s(o)+" ")])})),0),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual===a.totalPaginas},on:{click:function(t){return a.irParaPagina(a.paginaAtual+1)}}},[a._v(" ‚ñ∂Ô∏è Pr√≥xima ")])])]):0===a.produtos.length?t("p",[a._v("Nenhum requerimento cadastrado.")]):a.temFiltrosAplicados?t("p",[a._v("Nenhum produto encontrado com os filtros aplicados.")]):a._e()]),t("div",{staticClass:"diligencia-section"},[t("div",{staticClass:"section-header"},[t("h3",[a._v("üîç Requerimentos com Dilig√™ncias")]),t("div",{staticClass:"pagination-controls"},[t("label",[a._v("Itens por p√°gina:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPaginaDiligencia,expression:"itensPorPaginaDiligencia"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.itensPorPaginaDiligencia=t.target.multiple?o:o[0]},a.aplicarPaginacaoDiligencia]}},[t("option",{attrs:{value:"5"}},[a._v("5")]),t("option",{attrs:{value:"10"}},[a._v("10")]),t("option",{attrs:{value:"20"}},[a._v("20")])])])]),t("div",{staticClass:"filtros-inline"},[t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.busca,expression:"filtrosDiligencia.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDiligencia.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtrosDiligencia,"busca",t.target.value)},a.aplicarFiltrosDiligencia]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üè∑Ô∏è Marca:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.marca,expression:"filtrosDiligencia.marca"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosDiligencia,"marca",t.target.multiple?o:o[0])},a.aplicarFiltrosDiligencia]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),a._l(a.marcasUnicas,(function(o){return t("option",{key:o,domProps:{value:o}},[a._v(" "+a._s(o)+" ")])}))],2)]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("üìÖ Data:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.data,expression:"filtrosDiligencia.data"}],attrs:{type:"date"},domProps:{value:a.filtrosDiligencia.data},on:{change:a.aplicarFiltrosDiligencia,input:function(t){t.target.composing||a.$set(a.filtrosDiligencia,"data",t.target.value)}}})]),t("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltrosDiligencia}},[a._v(" üóëÔ∏è Limpar ")])]),a.diligenciasPaginadas.length>0?t("table",[a._m(1),t("tbody",a._l(a.diligenciasPaginadas,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.nome))]),t("td",[a._v(a._s(o.marca))]),t("td",[a._v(a._s(a.formatarEdital(o)))]),a._m(2,!0),t("td",[a._v(a._s(a.formatDate(o.criado_em)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.verProduto(o.id)}}},[a._v("Visualizar")]),t("button",{staticClass:"btn-small btn-diligencia",on:{click:function(t){return a.visualizarDiligencias(o.id)}}},[a._v("Ver Dilig√™ncias")])])])})),0)]):a._e(),a.totalPaginasDiligencia>1?t("div",{staticClass:"paginacao"},[t("div",{staticClass:"paginacao-info"},[a._v(" P√°gina "+a._s(a.paginaAtualDiligencia)+" de "+a._s(a.totalPaginasDiligencia)+" ")]),t("div",{staticClass:"paginacao-botoes"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtualDiligencia},on:{click:function(t){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia-1)}}},[a._v(" ‚óÄÔ∏è Anterior ")]),t("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveisDiligencia,(function(o){return t("button",{key:o,class:["btn-numero",{active:o===a.paginaAtualDiligencia}],on:{click:function(t){return a.irParaPaginaDiligencia(o)}}},[a._v(" "+a._s(o)+" ")])})),0),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtualDiligencia===a.totalPaginasDiligencia},on:{click:function(t){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia+1)}}},[a._v(" ‚ñ∂Ô∏è Pr√≥xima ")])])]):0===a.produtosComDiligencia.length?t("p",[a._v("Nenhum requerimento com dilig√™ncia encontrado.")]):a.temFiltrosDiligenciaAplicados?t("p",[a._v("Nenhuma dilig√™ncia encontrada com os filtros aplicados.")]):a._e()])]):a._e(),"pesquisa"===a.activeTab?t("div",{staticClass:"pesquisa-mercado"},[t("div",{staticClass:"pesquisa-mercado-container"},[t("div",{staticClass:"sub-tabs"},[t("div",{staticClass:"sub-tab",class:{active:"pesquisa-tecnica"===a.activeSubTab},on:{click:function(t){a.activeSubTab="pesquisa-tecnica"}}},[a._v(" ü§ñ PesquisaBot ")]),t("div",{staticClass:"sub-tab",class:{active:"cotacoes"===a.activeSubTab},on:{click:function(t){a.activeSubTab="cotacoes"}}},[a._v(" üí∞ Cota√ß√µes ")]),t("div",{staticClass:"sub-tab",class:{active:"comparativo"===a.activeSubTab},on:{click:function(t){a.activeSubTab="comparativo"}}},[a._v(" üìä Comparativo ")]),t("div",{staticClass:"sub-tab",class:{active:"analise-precos"===a.activeSubTab},on:{click:function(t){a.activeSubTab="analise-precos"}}},[a._v(" üìà An√°lise de Pre√ßos ")]),t("div",{staticClass:"sub-tab",class:{active:"relatorios"===a.activeSubTab},on:{click:function(t){a.activeSubTab="relatorios"}}},[a._v(" üìã Relat√≥rios ")]),t("div",{staticClass:"sub-tab",class:{active:"bancos-precos"===a.activeSubTab},on:{click:function(t){a.activeSubTab="bancos-precos"}}},[a._v(" üè¶ Bancos de Pre√ßos ")])]),"pesquisa-tecnica"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("div",{staticClass:"pesquisa-bot-section"},[a._m(3),t("PesquisaBot")],1)]):a._e(),"cotacoes"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("GerenciadorCotacoes")],1):a._e(),"comparativo"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("GerenciadorComparativo")],1):a._e(),"analise-precos"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("GerenciadorAnalisePrecos")],1):a._e(),"relatorios"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("GerenciadorRelatorios")],1):a._e(),"bancos-precos"===a.activeSubTab?t("div",{staticClass:"sub-content"},[t("div",{staticClass:"bancos-precos-section"},[a._m(4),t("div",{staticClass:"bancos-grid"},[t("div",{staticClass:"banco-card"},[t("div",{staticClass:"banco-icon"},[a._v("üèõÔ∏è")]),t("h5",[a._v("Banco de Pre√ßos do Governo Federal")]),t("p",[a._v("Consulta ao banco de pre√ßos oficial do governo")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.$swal({title:"üèõÔ∏è Banco Federal",text:"Funcionalidade em desenvolvimento - Consulta ao banco de pre√ßos oficial",icon:"info"})}}},[a._v("Consultar")])]),t("div",{staticClass:"banco-card"},[t("div",{staticClass:"banco-icon"},[a._v("üè•")]),t("h5",[a._v("Banco de Pre√ßos em Sa√∫de")]),t("p",[a._v("Pre√ßos de medicamentos e materiais m√©dicos")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.$swal({title:"üè• Banco de Sa√∫de",text:"Funcionalidade em desenvolvimento - Pre√ßos de medicamentos e materiais",icon:"info"})}}},[a._v("Consultar")])]),t("div",{staticClass:"banco-card"},[t("div",{staticClass:"banco-icon"},[a._v("üè¢")]),t("h5",[a._v("Outros Bancos Estaduais")]),t("p",[a._v("Consulta a bancos de pre√ßos estaduais")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.$swal({title:"üè¢ Bancos Estaduais",text:"Funcionalidade em desenvolvimento - Consulta a bancos estaduais",icon:"info"})}}},[a._v("Consultar")])])]),a._m(5)])]):a._e()])]):a._e(),"editais"===a.activeTab?t("div",{staticClass:"editais"},[t("div",{staticClass:"editais-container"},[t("div",{staticClass:"editais-stats"},[t("div",{staticClass:"stat-card editais-ativos"},[t("h4",[a._v("üìã Publicados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisAtivos.length))]),t("small",[a._v("Recebendo documenta√ß√£o")])]),t("div",{staticClass:"stat-card editais-rascunho"},[t("h4",[a._v("‚úèÔ∏è Em Elabora√ß√£o")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisRascunho.length))]),t("small",[a._v("Aguardando publica√ß√£o")])]),t("div",{staticClass:"stat-card editais-finalizados"},[t("h4",[a._v("‚úÖ Finalizados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisFinalizados.length))]),t("small",[a._v("Processos conclu√≠dos")])])]),t("div",{staticClass:"editais-actions"},[t("div",{staticClass:"actions-left"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" ‚ûï Novo Edital ")]),t("button",{staticClass:"btn-secondary",attrs:{disabled:a.loadingEditais},on:{click:a.carregarEditais}},[a._v(" üîÑ Atualizar ")])]),t("div",{staticClass:"actions-right"},[t("div",{staticClass:"filtro-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.busca,expression:"filtroEditais.busca"}],attrs:{type:"text",placeholder:"üîç Buscar edital..."},domProps:{value:a.filtroEditais.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroEditais,"busca",t.target.value)},a.aplicarFiltrosEditais]}})]),t("div",{staticClass:"filtro-group"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.status,expression:"filtroEditais.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroEditais,"status",t.target.multiple?o:o[0])},a.aplicarFiltrosEditais]}},[t("option",{attrs:{value:""}},[a._v("Todos os Status")]),t("option",{attrs:{value:"RASCUNHO"}},[a._v("üìù Em Elabora√ß√£o")]),t("option",{attrs:{value:"PUBLICADO"}},[a._v("üìã Publicado")]),t("option",{attrs:{value:"CANCELADO"}},[a._v("‚ùå Cancelado")])])])])]),a.loadingEditais?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"loading-spinner"}),t("p",[a._v("Carregando editais...")])]):a.editaisFiltrados.length>0?t("div",{staticClass:"editais-grid"},a._l(a.editaisFiltrados,(function(o){return t("div",{key:o.id,staticClass:"edital-card",class:{"status-ativo":"PUBLICADO"===o.status,"status-rascunho":"RASCUNHO"===o.status,"status-cancelado":"CANCELADO"===o.status}},[t("div",{staticClass:"edital-header"},[t("div",{staticClass:"edital-numero"},[a._v(a._s(o.numero))]),t("div",{staticClass:"edital-status"},["PUBLICADO"===o.status?t("span",{staticClass:"badge status-publicado"},[a._v("üìã Publicado")]):"RASCUNHO"===o.status?t("span",{staticClass:"badge status-rascunho"},[a._v("‚úèÔ∏è Em Elabora√ß√£o")]):"CANCELADO"===o.status?t("span",{staticClass:"badge status-cancelado"},[a._v("‚ùå Cancelado")]):a._e()])]),t("div",{staticClass:"edital-content"},[t("h4",[a._v(a._s(o.descricao))]),t("div",{staticClass:"edital-info"},["PUBLICADO"===o.status?[t("p",[t("strong",[a._v("üìÖ Publica√ß√£o:")]),a._v(" "+a._s(a.formatDate(o.data_publicacao)))]),o.data_limite_impugnacao?t("p",[t("strong",[a._v("‚è∞ Prazo Impugna√ß√£o:")]),a._v(" "+a._s(a.formatDate(o.data_limite_impugnacao))+" ")]):a._e()]:a._e()],2)]),t("div",{staticClass:"edital-actions"},[t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.visualizarEdital(o)}}},[a._v(" üëÅÔ∏è Visualizar ")]),"RASCUNHO"===o.status?t("button",{staticClass:"btn-primary btn-small",on:{click:function(t){return a.editarEdital(o)}}},[a._v(" ‚úèÔ∏è Editar ")]):a._e(),t("div",{staticClass:"dropdown"},[t("button",{staticClass:"btn-secondary btn-small dropdown-toggle"},[a._v("‚ãÆ")]),t("div",{staticClass:"dropdown-menu"},[o.url_documento?t("a",{on:{click:function(t){return a.baixarDocumento(o)}}},[a._v("üì• Baixar PDF")]):a._e(),t("a",{on:{click:function(t){return a.duplicarEdital(o)}}},[a._v("üìã Duplicar")]),"RASCUNHO"===o.status?t("a",{staticClass:"text-danger",on:{click:function(t){return a.cancelarEdital(o)}}},[a._v("‚ùå Cancelar")]):a._e()])])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìã")]),t("h3",[a._v("Nenhum edital encontrado")]),a.filtroEditais.busca||a.filtroEditais.status?t("p",[a._v(" Nenhum edital corresponde aos filtros aplicados. ")]):t("p",[a._v(' Ainda n√£o h√° editais cadastrados. Clique em "Novo Edital" para come√ßar. ')]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" ‚ûï Criar Primeiro Edital ")])])]),a.modalNovoEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoEdital}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìã Selecionar Minuta-Padr√£o")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoEdital}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"minuta-selecao"},[a._m(6),t("div",{staticClass:"minutas-actions"},[t("button",{staticClass:"btn-secondary",on:{click:a.abrirModalAddMinuta}},[a._v(" ‚ûï Adicionar Nova Minuta-Padr√£o ")])]),t("div",{staticClass:"minutas-grid"},a._l(a.minutasDisponiveis,(function(o){return t("div",{key:o.id,staticClass:"minuta-card",class:{selected:a.minutaSelecionada===o.id},on:{click:function(t){return a.selecionarMinuta(o)}}},[t("div",{staticClass:"minuta-header"},[t("div",{staticClass:"minuta-icon"},[o.eh_padrao_sistema?t("span",[a._v("üèõÔ∏è")]):t("span",[a._v("üìÑ")])]),t("div",{staticClass:"minuta-info"},[t("h5",[a._v(a._s(o.nome))]),t("p",{staticClass:"minuta-categoria"},[a._v(a._s(o.categoria||"Geral"))])])]),t("div",{staticClass:"minuta-description"},[t("p",[a._v(a._s(o.descricao||"Sem descri√ß√£o"))])]),t("div",{staticClass:"minuta-meta"},[t("small",[o.eh_padrao_sistema?t("span",{staticClass:"badge badge-system"},[a._v("Sistema")]):t("span",{staticClass:"badge badge-custom"},[a._v("Personalizada")])])])])})),0),0===a.minutasDisponiveis.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìã")]),t("h3",[a._v("Nenhuma minuta-padr√£o dispon√≠vel")]),t("p",[a._v("Adicione uma minuta-padr√£o para come√ßar a criar editais.")]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalAddMinuta}},[a._v(" ‚ûï Adicionar Primeira Minuta ")])]):a._e()]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoEdital}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{disabled:!a.minutaSelecionada||a.criandoEdital},on:{click:a.processarCriacaoEdital}},[a._v(" "+a._s(a.criandoEdital?"Criando...":"Criar Edital com Minuta Selecionada")+" ")])])])])]):a._e(),a.modalAddMinuta?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalAddMinuta}},[t("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("‚ûï Adicionar Nova Minuta-Padr√£o")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalAddMinuta}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarNovaMinuta.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"minuta-nome"}},[a._v("Nome da Minuta*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.nome,expression:"novaMinuta.nome"}],attrs:{id:"minuta-nome",type:"text",placeholder:"Ex: Minuta para Material de Escrit√≥rio",required:""},domProps:{value:a.novaMinuta.nome},on:{input:function(t){t.target.composing||a.$set(a.novaMinuta,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"minuta-categoria"}},[a._v("Categoria")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.categoria,expression:"novaMinuta.categoria"}],attrs:{id:"minuta-categoria"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.novaMinuta,"categoria",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"geral"}},[a._v("Geral")]),t("option",{attrs:{value:"medicamentos"}},[a._v("Medicamentos")]),t("option",{attrs:{value:"material_escritorio"}},[a._v("Material de Escrit√≥rio")]),t("option",{attrs:{value:"material_odontologico"}},[a._v("Material Odontol√≥gico")]),t("option",{attrs:{value:"material_medico_hospitalar"}},[a._v("Material M√©dico-Hospitalar")]),t("option",{attrs:{value:"equipamentos"}},[a._v("Equipamentos")]),t("option",{attrs:{value:"outros_materiais"}},[a._v("Outros Materiais")])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"minuta-descricao"}},[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.descricao,expression:"novaMinuta.descricao"}],attrs:{id:"minuta-descricao",rows:"3",placeholder:"Descri√ß√£o opcional da minuta..."},domProps:{value:a.novaMinuta.descricao},on:{input:function(t){t.target.composing||a.$set(a.novaMinuta,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"minuta-arquivo"}},[a._v("Arquivo da Minuta (Word)*")]),t("input",{attrs:{id:"minuta-arquivo",type:"file",accept:".docx,.doc",required:""},on:{change:a.handleMinutaUpload}}),t("small",[a._v("Arquivo Word (.docx ou .doc) com a minuta-padr√£o (m√°ximo 10MB)")])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalAddMinuta}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvandoMinuta}},[a._v(" "+a._s(a.salvandoMinuta?"Salvando...":"Salvar Minuta")+" ")])])])])])]):a._e(),a.modalVisualizarEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVisualizarEdital}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üëÅÔ∏è "+a._s(a.editalSelecionado.numero)+" - "+a._s(a.editalSelecionado.descricao))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalVisualizarEdital}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"edital-detalhes"},[t("div",{staticClass:"info-section"},[t("h4",[a._v("üìã Informa√ß√µes Gerais")]),t("div",{staticClass:"info-grid"},[t("div",[t("strong",[a._v("N√∫mero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),t("div",[t("strong",[a._v("Status:")]),t("span",{class:"badge status-"+a.editalSelecionado.status.toLowerCase()},[a._v(" "+a._s(a.editalSelecionado.status)+" ")])]),"PUBLICADO"===a.editalSelecionado.status?[t("div",[t("strong",[a._v("Data Publica√ß√£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_publicacao)))]),a.editalSelecionado.data_limite_impugnacao?t("div",[t("strong",[a._v("Prazo Impugna√ß√£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_limite_impugnacao))+" ")]):a._e()]:a._e()],2)]),"RASCUNHO"===a.editalSelecionado.status?t("div",{staticClass:"info-section"},[t("h4",[a._v("üìÑ Minuta-Padr√£o")]),t("div",{staticClass:"minuta-workflow"},[t("div",{staticClass:"workflow-step",class:{active:!0}},[t("div",{staticClass:"step-number"},[a._v("1")]),t("div",{staticClass:"step-content"},[t("h5",[a._v("Baixar Minuta")]),t("p",[a._v("Baixe a minuta-padr√£o selecionada")]),t("button",{staticClass:"btn-primary btn-small",on:{click:function(t){return a.baixarMinutaPadrao(a.editalSelecionado)}}},[a._v(" üì• Baixar Minuta-Padr√£o ")])])]),t("div",{staticClass:"workflow-step",class:{active:a.editalSelecionado.minuta_preenchida_url}},[t("div",{staticClass:"step-number"},[a._v("2")]),t("div",{staticClass:"step-content"},[t("h5",[a._v("Enviar Minuta Preenchida")]),t("p",[a._v("Ap√≥s preencher, envie a minuta")]),a.editalSelecionado.minuta_preenchida_url?t("div",[t("p",{staticClass:"success-text"},[a._v("‚úÖ Minuta preenchida enviada")]),t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.visualizarMinutaPreenchida(a.editalSelecionado)}}},[a._v(" üëÅÔ∏è Visualizar ")])]):t("div",[t("input",{ref:"minutaPreenchidaInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".docx,.doc"},on:{change:a.handleMinutaPreenchidaUpload}}),t("button",{staticClass:"btn-primary btn-small",on:{click:function(t){return a.$refs.minutaPreenchidaInput.click()}}},[a._v(" üì§ Enviar Minuta Preenchida ")])])])]),t("div",{staticClass:"workflow-step",class:{active:a.editalSelecionado.pdf_convertido_url}},[t("div",{staticClass:"step-number"},[a._v("3")]),t("div",{staticClass:"step-content"},[t("h5",[a._v("Converter para PDF")]),t("p",[a._v("Finalizar e publicar edital")]),a.editalSelecionado.minuta_preenchida_url&&!a.editalSelecionado.pdf_convertido_url?t("div",[t("button",{staticClass:"btn-primary btn-small",on:{click:function(t){return a.processarConversaoPDF(a.editalSelecionado)}}},[a._v(" üìã Converter para PDF e Publicar ")])]):a.editalSelecionado.pdf_convertido_url?t("div",[t("p",{staticClass:"success-text"},[a._v("‚úÖ PDF gerado e publicado")])]):a._e()])])])]):a._e(),a.editalSelecionado.conteudo?t("div",{staticClass:"info-section"},[t("h4",[a._v("üìÑ Conte√∫do")]),t("div",{staticClass:"conteudo-texto"},[a._v(a._s(a.editalSelecionado.conteudo))])]):a._e(),t("div",{staticClass:"info-section"},[t("h4",[a._v("üìä Estat√≠sticas")]),t("div",{staticClass:"stats-grid"},[t("div",{staticClass:"mini-stat"}),t("div",{staticClass:"mini-stat"},[t("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.produtos_submetidos||0))]),t("span",{staticClass:"mini-stat-label"},[a._v("Produtos Submetidos")])]),t("div",{staticClass:"mini-stat"},[t("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.impugnacoes_count||0))]),t("span",{staticClass:"mini-stat-label"},[a._v("Impugna√ß√µes")])])])])]),t("div",{staticClass:"modal-actions"},[a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url?t("button",{staticClass:"btn-primary",on:{click:function(t){return a.abrirDocumento(a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url)}}},[a._v(" üìÑ Abrir PDF ")]):a._e(),a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url?t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.baixarDocumento(a.editalSelecionado)}}},[a._v(" üì• Baixar PDF ")]):a._e(),t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalVisualizarEdital}},[a._v(" Fechar ")])])])])]):a._e(),t("div",{staticClass:"impugnacoes-section"},[t("div",{staticClass:"section-header"},[t("h3",[a._v("Impugna√ß√µes ao Edital")]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaImpugnacao}},[a._v(" ‚ûï Nova Impugna√ß√£o ")])]),a.impugnacoes.length>0?t("table",[a._m(7),t("tbody",a._l(a.impugnacoes,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.impugnante))]),t("td",[a._v(a._s(o.produto_nome))]),t("td",[a._v(a._s(a.formatDate(o.data_impugnacao)))]),t("td",[a._v(a._s(a.formatDate(o.prazo_final)))]),t("td",["DEFERIDA"===o.status?t("span",{staticClass:"status-badge status-aprovado"},[a._v(" DEFERIDA ")]):"INDEFERIDA"===o.status?t("span",{staticClass:"status-badge status-reprovado"},[a._v(" INDEFERIDA ")]):t("span",{staticClass:"status-badge status-pendente"},[a._v(" "+a._s(o.status)+" ")])]),t("td",["EM_ANALISE"!==o.status&&o.data_decisao?a._e():t("button",{staticClass:"btn-small",on:{click:function(t){return a.analisarImpugnacao(o.id)}}},[a._v(" Visualizar ")]),"EM_ANALISE"!==o.status&&o.data_decisao?t("button",{staticClass:"btn-small btn-info",on:{click:function(t){return a.verDecisaoImpugnacao(o.id)}}},[a._v(" Ver Decis√£o ")]):a._e()])])})),0)]):t("p",[a._v("N√£o h√° impugna√ß√µes apresentadas.")])]),a.modalNovaImpugnacao?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovaImpugnacao}},[t("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("‚ûï Nova Impugna√ß√£o ao Edital")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovaImpugnacao}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarNovaImpugnacao.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"editalImpugnacao"}},[a._v("Edital *")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.edital_id,expression:"novaImpugnacao.edital_id"}],attrs:{id:"editalImpugnacao",required:"",disabled:a.carregandoEditais},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.novaImpugnacao,"edital_id",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v(a._s(a.carregandoEditais?"Carregando editais...":"Selecione um edital..."))]),a._l(a.editaisParaImpugnacao,(function(o){return t("option",{key:o.id,attrs:{disabled:!a.editalDentroDoPrazo(o)},domProps:{value:o.id}},[a._v(" "+a._s(o.numero)+" - "+a._s(o.descricao)+" "),a.editalDentroDoPrazo(o)?a._e():t("span",[a._v(" (Prazo vencido)")])])}))],2),a.editalSelecionadoInfo?t("small",{staticClass:"help-text"},[a._v(" Prazo para impugna√ß√£o: "+a._s(a.formatDate(a.editalSelecionadoInfo.data_limite_impugnacao))+" ")]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"impugnante"}},[a._v("Nome do Impugnante *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.impugnante,expression:"novaImpugnacao.impugnante"}],attrs:{id:"impugnante",type:"text",placeholder:"Ex: Jo√£o Silva",required:""},domProps:{value:a.novaImpugnacao.impugnante},on:{input:function(t){t.target.composing||a.$set(a.novaImpugnacao,"impugnante",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailImpugnante"}},[a._v("Email *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.email,expression:"novaImpugnacao.email"}],attrs:{id:"emailImpugnante",type:"email",placeholder:"Ex: joao@empresa.com",required:""},domProps:{value:a.novaImpugnacao.email},on:{input:function(t){t.target.composing||a.$set(a.novaImpugnacao,"email",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"empresaImpugnante"}},[a._v("Empresa")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.empresa,expression:"novaImpugnacao.empresa"}],attrs:{id:"empresaImpugnante",type:"text",placeholder:"Ex: Empresa XYZ Ltda"},domProps:{value:a.novaImpugnacao.empresa},on:{input:function(t){t.target.composing||a.$set(a.novaImpugnacao,"empresa",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"motivoImpugnacao"}},[a._v("Motivo da Impugna√ß√£o *")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.motivo,expression:"novaImpugnacao.motivo"}],attrs:{id:"motivoImpugnacao",rows:"4",placeholder:"Descreva o motivo da impugna√ß√£o...",required:""},domProps:{value:a.novaImpugnacao.motivo},on:{input:function(t){t.target.composing||a.$set(a.novaImpugnacao,"motivo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"documentosImpugnacao"}},[a._v("Documentos de Apoio")]),t("input",{attrs:{id:"documentosImpugnacao",type:"file",multiple:"",accept:".pdf,.doc,.docx,.jpg,.png"},on:{change:a.handleDocumentosUpload}}),t("small",[a._v("Arquivos suportados: PDF, DOC, DOCX, JPG, PNG (m√°ximo 5MB cada)")])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovaImpugnacao}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvandoImpugnacao}},[a.salvandoImpugnacao?t("span",[a._v("Salvando...")]):t("span",[a._v("Registrar Impugna√ß√£o")])])])])])])]):a._e()]):a._e(),"despadronizadas"===a.activeTab?t("div",{staticClass:"marcas-despadronizadas"},[t("GerenciadorMarcasDespadronizadas",{ref:"gerenciadorMarcas"})],1):a._e(),"certificados"===a.activeTab?t("div",{staticClass:"certificados-dcb"},[t("div",{staticClass:"dcb-container"},[t("div",{staticClass:"dcb-stats"},[t("div",{staticClass:"stat-card dcb-pendentes"},[t("h4",[a._v("üü° Prontos para DCB")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.produtosProntosDCB.length))]),t("small",[a._v("Produtos aprovados sem DCB")])]),t("div",{staticClass:"stat-card dcb-emitidos"},[t("h4",[a._v("‚úÖ DCBs Emitidas")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsEmitidos.length))]),t("small",[a._v("Certificados v√°lidos")])]),t("div",{staticClass:"stat-card dcb-vencendo"},[t("h4",[a._v("‚ö†Ô∏è DCBs Vencendo")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencendo.length))]),t("small",[a._v("Pr√≥ximos 30 dias")])]),t("div",{staticClass:"stat-card dcb-vencidos"},[t("h4",[a._v("üî¥ DCBs Vencidas")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencidos.length))]),t("small",[a._v("Precisam renova√ß√£o")])])]),t("div",{staticClass:"dcb-tabs"},[t("div",{staticClass:"dcb-tab",class:{active:"emitir"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="emitir"}}},[a._v(" üìù Emitir DCB ")]),t("div",{staticClass:"dcb-tab",class:{active:"historico"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="historico"}}},[a._v(" üìã Hist√≥rico DCBs ")]),t("div",{staticClass:"dcb-tab",class:{active:"vencimentos"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="vencimentos"}}},[a._v(" ‚è∞ Controle Vencimentos ")])]),"emitir"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(8),t("div",{staticClass:"filtros-dcb"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.busca,expression:"filtrosDCB.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDCB.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtrosDCB,"busca",t.target.value)},a.aplicarFiltrosDCB]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìÇ Categoria:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.categoria,expression:"filtrosDCB.categoria"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosDCB,"categoria",t.target.multiple?o:o[0])},a.aplicarFiltrosDCB]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"medicamentos"}},[a._v("Medicamentos")]),t("option",{attrs:{value:"materiais_medicos"}},[a._v("Materiais M√©dicos")]),t("option",{attrs:{value:"equipamentos"}},[a._v("Equipamentos")]),t("option",{attrs:{value:"administrativo"}},[a._v("Administrativo")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìÖ Data Aprova√ß√£o:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.dataAprovacao,expression:"filtrosDCB.dataAprovacao"}],attrs:{type:"date"},domProps:{value:a.filtrosDCB.dataAprovacao},on:{change:a.aplicarFiltrosDCB,input:function(t){t.target.composing||a.$set(a.filtrosDCB,"dataAprovacao",t.target.value)}}})]),t("button",{staticClass:"btn-limpar",on:{click:a.limparFiltrosDCB}},[a._v("üóëÔ∏è Limpar")])]),a.produtosProntosDCBFiltrados.length>0?t("div",{staticClass:"produtos-dcb-lista"},a._l(a.produtosProntosDCBFiltrados,(function(o){return t("div",{key:o.id,staticClass:"produto-dcb-card"},[t("div",{staticClass:"produto-info"},[t("div",{staticClass:"produto-header"},[t("h4",[a._v(a._s(o.nome))]),t("span",{staticClass:"status-badge status-aprovado"},[a._v("‚úÖ Aprovado")])]),t("div",{staticClass:"produto-details"},[t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(o.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(o.modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(o.fabricante))]),t("p",[t("strong",[a._v("Data Aprova√ß√£o:")]),a._v(" "+a._s(a.formatDate(o.data_aprovacao||o.aprovado_em||o.criado_em)))])])]),t("div",{staticClass:"produto-actions"},[t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarProdutoDetalhes(o)}}},[a._v(" üëÅÔ∏è Detalhes ")]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.emitindoDCB===o.id},on:{click:function(t){return a.emitirDCB(o)}}},[a.emitindoDCB===o.id?t("span",[a._v("‚è≥ Emitindo...")]):t("span",[a._v("üìú Emitir DCB")])])])])})),0):0===a.produtosProntosDCB.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìù")]),t("h3",[a._v("Nenhum produto pronto para DCB")]),t("p",[a._v("Todos os produtos aprovados j√° possuem DCB emitido ou n√£o h√° produtos aprovados.")])]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üîç")]),t("h3",[a._v("Nenhum produto encontrado")]),t("p",[a._v("Nenhum produto corresponde aos filtros aplicados.")])])]):a._e(),"historico"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(9),t("div",{staticClass:"filtros-dcb"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üî¢ N√∫mero DCB:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.numeroDCB,expression:"filtrosHistorico.numeroDCB"}],attrs:{type:"text",placeholder:"Ex: 001/2024"},domProps:{value:a.filtrosHistorico.numeroDCB},on:{input:[function(t){t.target.composing||a.$set(a.filtrosHistorico,"numeroDCB",t.target.value)},a.aplicarFiltrosHistorico]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìä Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.status,expression:"filtrosHistorico.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosHistorico,"status",t.target.multiple?o:o[0])},a.aplicarFiltrosHistorico]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"ativo"}},[a._v("Ativo")]),t("option",{attrs:{value:"vencido"}},[a._v("Vencido")]),t("option",{attrs:{value:"revogado"}},[a._v("Revogado")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìÖ Per√≠odo:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataInicio,expression:"filtrosHistorico.dataInicio"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataInicio},on:{change:a.aplicarFiltrosHistorico,input:function(t){t.target.composing||a.$set(a.filtrosHistorico,"dataInicio",t.target.value)}}}),t("span",[a._v("at√©")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataFim,expression:"filtrosHistorico.dataFim"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataFim},on:{change:a.aplicarFiltrosHistorico,input:function(t){t.target.composing||a.$set(a.filtrosHistorico,"dataFim",t.target.value)}}})])]),a.dcbsHistoricoFiltrados.length>0?t("div",{staticClass:"dcb-historico-tabela"},[t("table",[a._m(10),t("tbody",a._l(a.dcbsHistoricoFiltrados,(function(o){return t("tr",{key:o.id},[t("td",{staticClass:"dcb-numero"},[a._v(a._s(o.numero_dcb))]),t("td",[a._v(a._s(o.produto_nome))]),t("td",[a._v(a._s(o.produto_marca))]),t("td",[a._v(a._s(a.formatDate(o.data_emissao)))]),t("td",[a._v(a._s(a.formatDate(o.data_validade)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusDCBClass(o.status)},[a._v(" "+a._s(a.formatStatusDCB(o.status))+" ")])]),t("td",[t("div",{staticClass:"acoes-dcb"},[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarDCB(o)}}},[a._v(" üëÅÔ∏è Ver ")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.downloadDCB(o)}}},[a._v(" üì• PDF ")]),"ativo"===o.status?t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.revogarDCB(o)}}},[a._v(" üö´ Revogar ")]):a._e()])])])})),0)])]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìã")]),t("h3",[a._v("Nenhum DCB encontrado")]),t("p",[a._v("Nenhum certificado corresponde aos filtros aplicados.")])])]):a._e(),"vencimentos"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(11),t("div",{staticClass:"alertas-vencimento"},[a.dcbsVencendo.length>0?t("div",{staticClass:"alerta-warning"},[t("div",{staticClass:"alerta-icon"},[a._v("‚ö†Ô∏è")]),t("div",{staticClass:"alerta-content"},[t("h4",[a._v(a._s(a.dcbsVencendo.length)+" DCB(s) vencendo nos pr√≥ximos 30 dias")]),t("p",[a._v("√â recomendado iniciar o processo de renova√ß√£o.")])])]):a._e(),a.dcbsVencidos.length>0?t("div",{staticClass:"alerta-danger"},[t("div",{staticClass:"alerta-icon"},[a._v("üî¥")]),t("div",{staticClass:"alerta-content"},[t("h4",[a._v(a._s(a.dcbsVencidos.length)+" DCB(s) vencido(s)")]),t("p",[a._v("Produtos n√£o podem ser utilizados em licita√ß√µes at√© renova√ß√£o.")])])]):a._e()]),a.dcbsVencendo.length>0?t("div",{staticClass:"dcb-vencimento-section"},[t("h4",[a._v("‚ö†Ô∏è DCBs Vencendo (Pr√≥ximos 30 dias)")]),t("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencendo,(function(o){return t("div",{key:o.id,staticClass:"dcb-vencimento-card warning"},[t("div",{staticClass:"dcb-info"},[t("h5",[a._v(a._s(o.numero_dcb)+" - "+a._s(o.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(o.produto_marca))]),t("p",[t("strong",[a._v("Vence em:")]),a._v(" "+a._s(a.formatDate(o.data_validade)))]),t("p",[t("strong",[a._v("Dias restantes:")]),a._v(" "+a._s(a.calcularDiasRestantes(o.data_validade)))])]),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-warning",on:{click:function(t){return a.iniciarRenovacao(o)}}},[a._v(" üîÑ Renovar ")]),t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarDCB(o)}}},[a._v(" üëÅÔ∏è Ver DCB ")])])])})),0)]):a._e(),a.dcbsVencidos.length>0?t("div",{staticClass:"dcb-vencimento-section"},[t("h4",[a._v("üî¥ DCBs Vencidos")]),t("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencidos,(function(o){return t("div",{key:o.id,staticClass:"dcb-vencimento-card danger"},[t("div",{staticClass:"dcb-info"},[t("h5",[a._v(a._s(o.numero_dcb)+" - "+a._s(o.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(o.produto_marca))]),t("p",[t("strong",[a._v("Venceu em:")]),a._v(" "+a._s(a.formatDate(o.data_validade)))]),t("p",[t("strong",[a._v("Vencido h√°:")]),a._v(" "+a._s(a.calcularDiasVencidos(o.data_validade))+" dias")])]),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-danger",on:{click:function(t){return a.renovarDCBVencido(o)}}},[a._v(" üîÑ Renovar Urgente ")]),t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarDCB(o)}}},[a._v(" üëÅÔ∏è Ver DCB ")])])])})),0)]):a._e(),0===a.dcbsVencendo.length&&0===a.dcbsVencidos.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("‚úÖ")]),t("h3",[a._v("Todos os DCBs est√£o em dia!")]),t("p",[a._v("N√£o h√° certificados vencidos ou pr√≥ximos ao vencimento.")])]):a._e()]):a._e()]),a.modalProdutoDetalhes?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDetalhes}},[t("div",{staticClass:"modal-content produto-detalhes-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìã Detalhes do Produto")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalDetalhes}},[a._v("‚úï")])]),a.produtoSelecionado?t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-detalhes-grid"},[t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("üì¶ Informa√ß√µes B√°sicas")]),t("p",[t("strong",[a._v("Nome:")]),a._v(" "+a._s(a.produtoSelecionado.nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj_fabricante||a.produtoSelecionado.cnpj||"N√£o informado"))])]),t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("‚úÖ Status da Aprova√ß√£o")]),t("p",[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge status-aprovado"},[a._v(a._s(a.formatarStatus(a.produtoSelecionado.status)))])]),t("p",[t("strong",[a._v("Data Aprova√ß√£o:")]),a._v(" "+a._s(a.formatDate(a.produtoSelecionado.data_aprovacao||a.produtoSelecionado.aprovado_em||a.produtoSelecionado.criado_em)))]),t("p",[t("strong",[a._v("Aprovado por:")]),a._v(" "+a._s(a.produtoSelecionado.aprovado_por_nome||"Sistema"))])])]),a.produtoSelecionado.especificacoes_tecnicas?t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("üîß Especifica√ß√µes T√©cnicas")]),t("pre",[a._v(a._s(a.formatarEspecificacoes(a.produtoSelecionado.especificacoes_tecnicas)))])]):a._e(),a.produtoSelecionado.observacoes_internas?t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("üìù Observa√ß√µes")]),t("p",[a._v(a._s(a.produtoSelecionado.observacoes_internas))])]):a._e()]):a._e(),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDetalhes}},[a._v("Fechar")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.emitirDCB(a.produtoSelecionado)}}},[a._v(" üìú Emitir DCB ")])])])]):a._e(),a.modalVisualizarDCB?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDCB}},[t("div",{staticClass:"modal-content dcb-visualizar-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìú Visualizar DCB")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalDCB}},[a._v("‚úï")])]),a.dcbSelecionado?t("div",{staticClass:"modal-body"},[t("div",{staticClass:"dcb-preview"},[t("div",{staticClass:"dcb-header"},[t("h2",[a._v("DECLARA√á√ÉO DE CONFORMIDADE DE BEM")]),t("h3",[a._v("DCB N¬∫ "+a._s(a.dcbSelecionado.numero_dcb))])]),t("div",{staticClass:"dcb-content-preview"},[t("div",{staticClass:"dcb-section"},[t("h4",[a._v("PRODUTO CERTIFICADO")]),t("p",[t("strong",[a._v("Nome:")]),a._v(" "+a._s(a.dcbSelecionado.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.dcbSelecionado.produto_marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.dcbSelecionado.produto_modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.dcbSelecionado.produto_fabricante))])]),t("div",{staticClass:"dcb-section"},[t("h4",[a._v("DADOS DO CERTIFICADO")]),t("p",[t("strong",[a._v("Data de Emiss√£o:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_emissao)))]),t("p",[t("strong",[a._v("Validade:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_validade)))]),t("p",[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge",class:a.getStatusDCBClass(a.dcbSelecionado.status)},[a._v(" "+a._s(a.formatStatusDCB(a.dcbSelecionado.status))+" ")])])])])])]):a._e(),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDCB}},[a._v("Fechar")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.downloadDCB(a.dcbSelecionado)}}},[a._v(" üì• Download PDF ")])])])]):a._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:a.modalParticipantes,expression:"modalParticipantes"}],staticClass:"modal-participantes-overlay"},[t("div",{staticClass:"modal-participantes-content"},[t("div",{staticClass:"modal-participantes-header"},[t("h3",[a._v("üë• Participantes - "+a._s(a.editalSelecionado.numero))]),t("button",{staticClass:"btn-close-participantes",on:{click:a.fecharModalParticipantes}},[a._v("√ó")])]),t("div",{staticClass:"modal-participantes-body"},[t("div",{staticClass:"participantes-header"},[t("div",{staticClass:"filtros-participantes"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.busca,expression:"filtroParticipantes.busca"}],attrs:{type:"text",placeholder:"Nome, CNPJ, representante..."},domProps:{value:a.filtroParticipantes.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroParticipantes,"busca",t.target.value)},a.aplicarFiltrosParticipantes]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìä Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.status,expression:"filtroParticipantes.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroParticipantes,"status",t.target.multiple?o:o[0])},a.aplicarFiltrosParticipantes]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),t("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("Documenta√ß√£o Enviada")]),t("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em Avalia√ß√£o")]),t("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),t("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),t("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoParticipante}},[a._v(" ‚ûï Adicionar Participante ")])]),a.loadingParticipantes?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando participantes...")])]):a.participantesFiltrados.length>0?t("div",{staticClass:"participantes-lista"},a._l(a.participantesFiltrados,(function(o){return t("div",{key:o.id,staticClass:"participante-card"},[t("div",{staticClass:"participante-info"},[t("div",{staticClass:"participante-header"},[t("h4",[a._v(a._s(o.razao_social))]),t("span",{staticClass:"status-badge",class:a.getStatusClass(o.status)},[a._v(" "+a._s(a.formatarStatus(o.status))+" ")])]),t("div",{staticClass:"participante-details"},[t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.formatarCNPJ(o.cnpj)))]),t("p",[t("strong",[a._v("Representante:")]),a._v(" "+a._s(o.representante_legal))]),t("p",[t("strong",[a._v("Email:")]),a._v(" "+a._s(o.email))]),o.telefone?t("p",[t("strong",[a._v("Telefone:")]),a._v(" "+a._s(o.telefone))]):a._e(),t("p",[t("strong",[a._v("Data Participa√ß√£o:")]),a._v(" "+a._s(a.formatDate(o.data_participacao)))]),o.data_envio_documentacao?t("p",[t("strong",[a._v("Documenta√ß√£o Enviada:")]),a._v(" "+a._s(a.formatDate(o.data_envio_documentacao))+" ")]):a._e(),o.observacoes?t("p",[t("strong",[a._v("Observa√ß√µes:")]),a._v(" "+a._s(o.observacoes)+" ")]):a._e()])]),t("div",{staticClass:"participante-actions"},[t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.editarParticipante(o)}}},[a._v(" ‚úèÔ∏è Editar ")]),t("button",{staticClass:"btn-danger btn-small",on:{click:function(t){return a.removerParticipante(o)}}},[a._v(" üóëÔ∏è Remover ")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üë•")]),t("h3",[a._v("Nenhum participante encontrado")]),a.filtroParticipantes.busca||a.filtroParticipantes.status?t("p",[a._v(" Nenhum participante corresponde aos filtros aplicados. ")]):t("p",[a._v(' Ainda n√£o h√° participantes neste edital. Clique em "Adicionar Participante" para come√ßar. ')])])]),t("div",{staticClass:"modal-participantes-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalParticipantes}},[a._v("Fechar")])])])]),a.modalNovoParticipante?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoParticipante}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.participanteAtual.id?"‚úèÔ∏è Editar Participante":"‚ûï Novo Participante"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoParticipante}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarParticipante.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"razao_social"}},[a._v("Raz√£o Social*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.razao_social,expression:"participanteAtual.razao_social"}],attrs:{id:"razao_social",type:"text",placeholder:"Nome da empresa",required:""},domProps:{value:a.participanteAtual.razao_social},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"razao_social",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cnpj"}},[a._v("CNPJ*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.cnpj,expression:"participanteAtual.cnpj"}],attrs:{id:"cnpj",type:"text",placeholder:"00.000.000/0000-00",required:""},domProps:{value:a.participanteAtual.cnpj},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"cnpj",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"representante_legal"}},[a._v("Representante Legal*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.representante_legal,expression:"participanteAtual.representante_legal"}],attrs:{id:"representante_legal",type:"text",placeholder:"Nome do representante",required:""},domProps:{value:a.participanteAtual.representante_legal},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"representante_legal",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("Email*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.email,expression:"participanteAtual.email"}],attrs:{id:"email",type:"email",placeholder:"contato@empresa.com",required:""},domProps:{value:a.participanteAtual.email},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"email",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"telefone"}},[a._v("Telefone")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.telefone,expression:"participanteAtual.telefone"}],attrs:{id:"telefone",type:"text",placeholder:"(11) 99999-9999"},domProps:{value:a.participanteAtual.telefone},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"telefone",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"status"}},[a._v("Status")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.status,expression:"participanteAtual.status"}],attrs:{id:"status"},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.participanteAtual,"status",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),t("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("Documenta√ß√£o Enviada")]),t("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em Avalia√ß√£o")]),t("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),t("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),t("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"endereco"}},[a._v("Endere√ßo")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.endereco,expression:"participanteAtual.endereco"}],attrs:{id:"endereco",type:"text",placeholder:"Endere√ßo completo da empresa"},domProps:{value:a.participanteAtual.endereco},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"endereco",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"observacoes"}},[a._v("Observa√ß√µes")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.observacoes,expression:"participanteAtual.observacoes"}],attrs:{id:"observacoes",rows:"3",placeholder:"Observa√ß√µes sobre a participa√ß√£o..."},domProps:{value:a.participanteAtual.observacoes},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"observacoes",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoParticipante}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[a._v(" "+a._s(a.participanteAtual.id?"Atualizar":"Adicionar")+" Participante ")])])])])])]):a._e()]):a._e(),"usuarios"===a.activeTab?t("div",{staticClass:"usuarios-section"},[a._m(12),t("div",{staticClass:"section-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoUsuario}},[a._v(" ‚ûï Cadastrar Novo Usu√°rio ")])]),t("div",{staticClass:"usuarios-container"},[t("div",{staticClass:"filtros-usuarios"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroUsuarios.busca,expression:"filtroUsuarios.busca"}],attrs:{type:"text",placeholder:"Nome, unidade, coordenador..."},domProps:{value:a.filtroUsuarios.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroUsuarios,"busca",t.target.value)},a.aplicarFiltrosUsuarios]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üè¢ Unidade:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroUsuarios.unidade,expression:"filtroUsuarios.unidade"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroUsuarios,"unidade",t.target.multiple?o:o[0])},a.aplicarFiltrosUsuarios]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),a._l(a.unidadesUnicas,(function(o){return t("option",{key:o,domProps:{value:o}},[a._v(" "+a._s(o)+" ")])}))],2)])]),a.usuariosFiltrados.length>0?t("div",{staticClass:"usuarios-grid"},a._l(a.usuariosFiltrados,(function(o){return t("div",{key:o.id,staticClass:"usuario-card"},[t("div",{staticClass:"usuario-header"},[t("h4",[a._v(a._s(o.nome_usuario))]),t("div",{staticClass:"status-badges"},[t("span",{staticClass:"status-badge status-ativo"},[a._v("Ativo")]),o.user_id?t("span",{class:["status-convite",o.convite_aceito?"aceito":o.convite_enviado?"enviado":"pendente"]},[a._v(" "+a._s(o.convite_aceito?"üü¢ Conectado":o.convite_enviado?"üìß Convite Enviado":"‚è≥ Convite Pendente")+" ")]):a._e()])]),t("div",{staticClass:"usuario-details"},[t("p",[t("strong",[a._v("Unidade/Setor:")]),a._v(" "+a._s(o.unidade_setor))]),t("p",[t("strong",[a._v("Coordenador:")]),a._v(" "+a._s(o.nome_coordenador))]),t("p",[t("strong",[a._v("Telefone:")]),a._v(" "+a._s(o.telefone))]),t("p",[t("strong",[a._v("Email:")]),a._v(" "+a._s(o.email))]),t("p",[t("strong",[a._v("Materiais:")]),a._v(" "+a._s(o.materiais?.length||0)+" cadastrados")]),t("p",[t("strong",[a._v("Pr√≥ximo RDM:")]),t("span",{staticClass:"data-rdm"},[a._v(a._s(a.calcularProximoRDM(o)))])])]),t("div",{staticClass:"usuario-actions"},[t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.editarUsuario(o)}}},[a._v(" ‚úèÔ∏è Editar ")]),t("button",{staticClass:"btn-info btn-small",on:{click:function(t){return a.verMateriaisUsuario(o)}}},[a._v(" üì¶ Materiais ")]),o.user_id&&!o.convite_aceito?t("button",{staticClass:"btn-reenviar btn-small",on:{click:function(t){return a.reenviarConvite(o)}}},[a._v(" üìß Reenviar Convite ")]):a._e(),t("button",{staticClass:"btn-danger btn-small",on:{click:function(t){return a.removerUsuario(o)}}},[a._v(" üóëÔ∏è Remover ")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üë•")]),t("h3",[a._v("Nenhum usu√°rio cadastrado")]),t("p",[a._v('Clique em "Cadastrar Novo Usu√°rio" para come√ßar.')])])]),a.modalNovoUsuario?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoUsuario}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.usuarioAtual.id?"‚úèÔ∏è Editar Usu√°rio":"üë• Novo Usu√°rio"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoUsuario}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarUsuario.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"unidade_setor"}},[a._v("Unidade/Setor*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.unidade_setor,expression:"usuarioAtual.unidade_setor"}],attrs:{id:"unidade_setor",type:"text",placeholder:"Ex: Secretaria da Sa√∫de",required:""},domProps:{value:a.usuarioAtual.unidade_setor},on:{input:function(t){t.target.composing||a.$set(a.usuarioAtual,"unidade_setor",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome_coordenador"}},[a._v("Nome do Coordenador*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.nome_coordenador,expression:"usuarioAtual.nome_coordenador"}],attrs:{id:"nome_coordenador",type:"text",placeholder:"Nome completo do respons√°vel",required:""},domProps:{value:a.usuarioAtual.nome_coordenador},on:{input:function(t){t.target.composing||a.$set(a.usuarioAtual,"nome_coordenador",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"telefone_usuario"}},[a._v("Telefone*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.telefone,expression:"usuarioAtual.telefone"}],attrs:{id:"telefone_usuario",type:"tel",placeholder:"(00) 00000-0000",required:""},domProps:{value:a.usuarioAtual.telefone},on:{input:function(t){t.target.composing||a.$set(a.usuarioAtual,"telefone",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email_usuario"}},[a._v("Email*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.email,expression:"usuarioAtual.email"}],attrs:{id:"email_usuario",type:"email",placeholder:"email@exemplo.com",required:""},domProps:{value:a.usuarioAtual.email},on:{input:function(t){t.target.composing||a.$set(a.usuarioAtual,"email",t.target.value)}}})]),t("div",{staticClass:"login-system-section"},[t("h4",[a._v("üîê Sistema de Login")]),t("div",{staticClass:"form-group checkbox-group"},[t("label",{staticClass:"checkbox-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.criar_login,expression:"usuarioAtual.criar_login"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.usuarioAtual.criar_login)?a._i(a.usuarioAtual.criar_login,null)>-1:a.usuarioAtual.criar_login},on:{change:[function(t){var o=a.usuarioAtual.criar_login,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.usuarioAtual,"criar_login",o.concat([s])):r>-1&&a.$set(a.usuarioAtual,"criar_login",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.usuarioAtual,"criar_login",i)},a.toggleLoginSystem]}}),t("span",{staticClass:"checkmark"},[a._v("‚úì")]),a._v(" Permitir login no sistema (Dashboard RDM On-line) ")]),t("p",{staticClass:"help-text"},[a._v(" Ao marcar esta op√ß√£o, o usu√°rio receber√° um e-mail da CPM, com senha de acesso, para preencher o formul√°rio RDM. ")])]),a.usuarioAtual.criar_login?t("div",{staticClass:"convite-info"},[t("div",{staticClass:"info-card"},[t("h5",[a._v("üìß Convite Autom√°tico")]),t("p",[a._v("Ser√° enviado automaticamente um email para "),t("strong",[a._v(a._s(a.usuarioAtual.email))]),a._v(" com:")]),a._m(13)])]):a._e()]),t("div",{staticClass:"materiais-section"},[t("h4",[a._v("üì¶ Materiais sob Responsabilidade da Unidade")]),t("div",{staticClass:"materiais-lista"},[a._l(a.usuarioAtual.materiais,(function(o,e){return t("div",{key:e,staticClass:"material-item"},[t("div",{staticClass:"material-fields-novo"},[t("div",{staticClass:"material-select"},[t("label",[a._v("üì¶ Material/Produto:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:o.produto_id,expression:"material.produto_id"}],attrs:{disabled:a.loadingProdutos,required:""},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(o,"produto_id",t.target.multiple?e:e[0])},function(t){return a.selecionarProduto(e,t)}]}},[a.loadingProdutos?t("option",{attrs:{value:""}},[a._v("‚è≥ Carregando produtos...")]):0===a.produtosDisponiveis.length?t("option",{attrs:{value:""}},[a._v("Nenhum produto encontrado")]):t("option",{attrs:{value:""}},[a._v("Selecione um produto...")]),a._l(a.produtosDisponiveis,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" - "+a._s(o.marca||"S/Marca")+" ("+a._s(o.codigo_material||o.modelo||"S/C√≥digo")+") ")])})),t("option",{attrs:{value:"NOVO"}},[a._v("‚ûï Cadastrar Novo Material")])],2)]),"NOVO"===o.produto_id?t("div",{staticClass:"novo-material"},[t("input",{directives:[{name:"model",rawName:"v-model",value:o.nome,expression:"material.nome"}],attrs:{type:"text",placeholder:"Nome do novo material",required:""},domProps:{value:o.nome},on:{input:function(t){t.target.composing||a.$set(o,"nome",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:o.codigo,expression:"material.codigo"}],attrs:{type:"text",placeholder:"C√≥digo do material",required:""},domProps:{value:o.codigo},on:{input:function(t){t.target.composing||a.$set(o,"codigo",t.target.value)}}})]):a._e(),t("div",{staticClass:"material-periodo"},[t("label",[a._v("üìÖ Periodicidade RDM:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:o.periodicidade_rdm,expression:"material.periodicidade_rdm"}],attrs:{required:""},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(o,"periodicidade_rdm",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecionar...")]),t("option",{attrs:{value:"mensal"}},[a._v("Mensal")]),t("option",{attrs:{value:"bimestral"}},[a._v("Bimestral")]),t("option",{attrs:{value:"trimestral"}},[a._v("Trimestral")]),t("option",{attrs:{value:"semestral"}},[a._v("Semestral")]),t("option",{attrs:{value:"anual"}},[a._v("Anual")])])]),t("button",{staticClass:"btn-danger btn-small",attrs:{type:"button",title:"Remover material"},on:{click:function(t){return a.removerMaterial(e)}}},[a._v(" üóëÔ∏è ")])])])})),t("div",{staticClass:"material-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button",disabled:a.loadingProdutos},on:{click:a.adicionarMaterial}},[a.loadingProdutos?t("span",[a._v("‚è≥")]):t("span",[a._v("‚ûï")]),a._v(" Adicionar Material ")]),t("button",{staticClass:"btn-info btn-small",attrs:{type:"button",disabled:a.loadingProdutos},on:{click:a.carregarProdutos}},[a.loadingProdutos?t("span",[a._v("‚è≥")]):t("span",[a._v("üîÑ")]),a._v(" Atualizar Lista ")])]),a.loadingProdutos?a._e():t("div",{staticClass:"debug-info"},[t("small",[a._v(" üìä Debug: "+a._s(a.produtosDisponiveis.length)+" produtos dispon√≠veis "),a.currentTenantId?t("span",[a._v("(Tenant: "+a._s(a.currentTenantId.substring(0,8))+"...)")]):a._e(),t("br"),a._v(" üìã Materiais do usu√°rio: "+a._s(a.usuarioAtual.materiais?.length||0)+" "),a.usuarioAtual.materiais?.length>0?t("span",[a._v(" ("+a._s(a.usuarioAtual.materiais.map((a=>a.nome||"Sem nome")).join(", "))+") ")]):a._e()])])],2)]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoUsuario}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[a._v(" "+a._s(a.usuarioAtual.id?"Atualizar":"Cadastrar")+" Usu√°rio ")])])])])])]):a._e()]):a._e(),"reclamacoes"===a.activeTab?t("div",{staticClass:"avaliacoes-section"},[a._m(14),t("div",{staticClass:"section-actions"},[t("small",{staticStyle:{color:"#666"}},[a._v(" üìä Total: "+a._s(a.avaliacoes.length)+" | Filtradas: "+a._s(a.avaliacoesFiltradas.length)+" ")])]),t("div",{staticClass:"filtros-avaliacoes"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroAvaliacoes.busca,expression:"filtroAvaliacoes.busca"}],attrs:{type:"text",placeholder:"Material, usu√°rio, coment√°rio..."},domProps:{value:a.filtroAvaliacoes.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroAvaliacoes,"busca",t.target.value)},a.aplicarFiltrosAvaliacoes]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("‚≠ê Avalia√ß√£o:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroAvaliacoes.rating,expression:"filtroAvaliacoes.rating"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroAvaliacoes,"rating",t.target.multiple?o:o[0])},a.aplicarFiltrosAvaliacoes]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"5"}},[a._v("‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 estrelas)")]),t("option",{attrs:{value:"4"}},[a._v("‚≠ê‚≠ê‚≠ê‚≠ê (4 estrelas)")]),t("option",{attrs:{value:"3"}},[a._v("‚≠ê‚≠ê‚≠ê (3 estrelas)")]),t("option",{attrs:{value:"2"}},[a._v("‚≠ê‚≠ê (2 estrelas)")]),t("option",{attrs:{value:"1"}},[a._v("‚≠ê (1 estrela)")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üë§ Usu√°rio:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroAvaliacoes.usuario,expression:"filtroAvaliacoes.usuario"}],attrs:{type:"text",placeholder:"Nome do usu√°rio..."},domProps:{value:a.filtroAvaliacoes.usuario},on:{input:[function(t){t.target.composing||a.$set(a.filtroAvaliacoes,"usuario",t.target.value)},a.aplicarFiltrosAvaliacoes]}})])]),a.avaliacoesFiltradas.length>0?t("div",{staticClass:"avaliacoes-lista"},a._l(a.avaliacoesFiltradas,(function(o){return t("div",{key:o.id,staticClass:"avaliacao-card"},[t("div",{staticClass:"avaliacao-header"},[t("h4",[a._v(a._s(o.usuario_rdm?.nome_usuario||"Usu√°rio n√£o encontrado"))]),t("div",{staticClass:"rating-display"},[a._l(5,(function(e){return t("span",{key:e,staticClass:"star",class:{active:o.rating>=e}},[a._v("‚≠ê")])})),t("span",{staticClass:"rating-text"},[a._v(a._s(o.rating)+"/5")])],2)]),t("div",{staticClass:"avaliacao-content"},[t("div",{staticClass:"avaliacao-info"},[t("p",[t("strong",[a._v("Unidade/Setor:")]),a._v(" "+a._s(o.usuario_rdm?.unidade_setor||"N/A"))]),t("p",[t("strong",[a._v("Material:")]),a._v(" "+a._s(o.material_nome)+" ("+a._s(o.material_codigo)+")")]),t("p",[t("strong",[a._v("Data:")]),a._v(" "+a._s(a.formatDate(o.criado_em)))]),t("p",[t("strong",[a._v("Contato:")]),a._v(" "+a._s(o.usuario_rdm?.email||"N/A")+" | "+a._s(o.usuario_rdm?.telefone||"N/A"))])]),t("div",{staticClass:"avaliacao-detalhes"},[o.comentario?t("div",{staticClass:"comentario-texto"},[t("h5",[a._v("üí¨ Avalia√ß√£o:")]),t("p",[a._v(a._s(o.comentario))])]):a._e(),o.comentario?a._e():t("div",{staticClass:"sem-comentario"},[a._m(15,!0)]),t("div",{staticClass:"cpm-resposta"},[t("h5",[a._v("üìã Coment√°rio/Decis√£o da CPM:")]),o.resposta_cpm?t("div",{staticClass:"resposta-existente"},[t("p",[a._v(a._s(o.resposta_cpm))]),t("small",{staticClass:"data-resposta"},[a._v("Respondido em: "+a._s(a.formatDate(o.data_resposta_cpm)))])]):t("div",{staticClass:"sem-resposta"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:o.nova_resposta,expression:"avaliacao.nova_resposta"}],staticClass:"textarea-resposta",attrs:{rows:"3",placeholder:"Digite o coment√°rio ou decis√£o da CPM sobre esta avalia√ß√£o..."},domProps:{value:o.nova_resposta},on:{input:function(t){t.target.composing||a.$set(o,"nova_resposta",t.target.value)}}}),t("button",{staticClass:"btn-primary btn-small",attrs:{disabled:!o.nova_resposta||a.salvandoResposta},on:{click:function(t){return a.salvarRespostaCPM(o)}}},[a._v(" "+a._s(a.salvandoResposta?"Salvando...":"Salvar Resposta")+" ")])])])])])])})),0):a._e(),0===a.avaliacoesFiltradas.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("‚≠ê")]),t("h3",[a._v("Nenhuma avalia√ß√£o encontrada")]),t("p",[a._v("Quando houver avalia√ß√µes de materiais, elas aparecer√£o aqui.")])]):a._e()]):a._e(),a.modalEditarEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEditarEdital}},[t("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("‚úèÔ∏è Editar Edital")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEditarEdital}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarEdicaoEdital.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"numeroEdital"}},[a._v("N√∫mero do Edital *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.numero,expression:"editalEditando.numero"}],attrs:{id:"numeroEdital",type:"text",required:"",placeholder:"Ex: 001/2024",disabled:"RASCUNHO"!==a.editalEditando.status},domProps:{value:a.editalEditando.numero},on:{input:function(t){t.target.composing||a.$set(a.editalEditando,"numero",t.target.value)}}}),"RASCUNHO"!==a.editalEditando.status?t("small",{staticClass:"help-text"},[a._v(" O n√∫mero n√£o pode ser alterado ap√≥s a publica√ß√£o ")]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricaoEdital"}},[a._v("Descri√ß√£o/Nome do Edital *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.descricao,expression:"editalEditando.descricao"}],attrs:{id:"descricaoEdital",type:"text",required:"",placeholder:"Ex: Pr√©-qualifica√ß√£o de Equipamentos M√©dicos"},domProps:{value:a.editalEditando.descricao},on:{input:function(t){t.target.composing||a.$set(a.editalEditando,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"conteudoEdital"}},[a._v("Conte√∫do Adicional")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.conteudo,expression:"editalEditando.conteudo"}],attrs:{id:"conteudoEdital",rows:"4",placeholder:"Informa√ß√µes adicionais sobre o edital..."},domProps:{value:a.editalEditando.conteudo},on:{input:function(t){t.target.composing||a.$set(a.editalEditando,"conteudo",t.target.value)}}})]),"PUBLICADO"===a.editalEditando.status?t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"dataPublicacao"}},[a._v("Data de Publica√ß√£o")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.data_publicacao,expression:"editalEditando.data_publicacao"}],attrs:{id:"dataPublicacao",type:"datetime-local",disabled:!0},domProps:{value:a.editalEditando.data_publicacao},on:{input:function(t){t.target.composing||a.$set(a.editalEditando,"data_publicacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"dataLimiteImpugnacao"}},[a._v("Prazo para Impugna√ß√µes")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.data_limite_impugnacao,expression:"editalEditando.data_limite_impugnacao"}],attrs:{id:"dataLimiteImpugnacao",type:"datetime-local",disabled:!0},domProps:{value:a.editalEditando.data_limite_impugnacao},on:{input:function(t){t.target.composing||a.$set(a.editalEditando,"data_limite_impugnacao",t.target.value)}}})])]):a._e(),t("div",{staticClass:"form-group"},[t("label",[a._v("Status Atual")]),t("div",{staticClass:"status-display"},[t("span",{class:"badge status-"+a.editalEditando.status.toLowerCase()},[a._v(" "+a._s(a.getStatusText(a.editalEditando.status))+" ")])])])])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalEditarEdital}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"button",disabled:a.salvandoEdicaoEdital},on:{click:a.salvarEdicaoEdital}},[a.salvandoEdicaoEdital?t("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoEdicaoEdital?"Salvando...":"Salvar Altera√ß√µes")+" ")])])])]):a._e()])},j=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Marca")]),t("th",[a._v("Edital")]),t("th",[a._v("Status")]),t("th",[a._v("Data")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Marca")]),t("th",[a._v("Edital")]),t("th",[a._v("Status")]),t("th",[a._v("Data")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("td",[t("span",{staticClass:"status-badge status-diligencia"},[a._v(" Dilig√™ncia ")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-intro"},[t("h4",[a._v("ü§ñ PesquisaBot - Assistente de Pesquisa T√©cnica")]),t("p",[a._v("Ferramenta especializada para buscar informa√ß√µes t√©cnicas sobre produtos e marcas, incluindo manuais, laudos, normas, certifica√ß√µes e informa√ß√µes regulat√≥rias.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-intro"},[t("h4",[a._v("üè¶ Integra√ß√£o com Bancos de Pre√ßos P√∫blicos")]),t("p",[a._v("Consulte e integre dados de bancos de pre√ßos p√∫blicos para refer√™ncia de mercado.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"em-desenvolvimento"},[t("span",[a._v("üöß Em desenvolvimento")]),t("p",[a._v("Funcionalidade em constru√ß√£o - Integra√ß√£o autom√°tica com APIs de bancos de pre√ßos")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-intro"},[t("h4",[a._v("Escolha uma minuta-padr√£o para criar o edital:")]),t("p",[a._v('Selecione uma das minutas-padr√£o dispon√≠veis. Ap√≥s a sele√ß√£o, o novo edital ficar√° com o status "Em Elabora√ß√£o".')])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Impugnante")]),t("th",[a._v("Produto")]),t("th",[a._v("Data da Impugna√ß√£o")]),t("th",[a._v("Prazo Final")]),t("th",[a._v("Status")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("üìù Produtos Prontos para Certifica√ß√£o DCB")]),t("p",[a._v("Produtos aprovados pela CPM que ainda n√£o possuem DCB emitida.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("üìã Hist√≥rico de DCBs Emitidas")]),t("p",[a._v("Todos os certificados DCB emitidos pelo sistema.")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("N√∫mero DCB")]),t("th",[a._v("Produto")]),t("th",[a._v("Marca")]),t("th",[a._v("Data Emiss√£o")]),t("th",[a._v("Validade")]),t("th",[a._v("Status")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("‚è∞ Controle de Vencimentos DCB")]),t("p",[a._v("Monitoramento de DCBs pr√≥ximos ao vencimento ou j√° vencidos.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h2",[a._v("üë• Cadastro de Usu√°rios")]),t("p",[a._v("Gest√£o de usu√°rios autorizados a emitir RDMs no sistema")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[a._v("Senha de acesso definitiva")]),t("li",[a._v("Link direto para o sistema")]),t("li",[a._v("Instru√ß√µes de uso do Dashboard RDM")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h2",[a._v("‚≠ê Avalia√ß√µes de Usu√°rios")]),t("p",[a._v("Visualiza√ß√£o das avalia√ß√µes e feedbacks dos usu√°rios sobre materiais")])])},function(){var a=this,t=a._self._c;return t("p",[t("em",[a._v("Nenhuma avalia√ß√£o adicional fornecida.")])])}],J=o(365);var G=function(){var a=this,t=a._self._c;return t("div",{staticClass:"pesquisa-bot"},[a._m(0),t("div",{staticClass:"search-form"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"produto"}},[a._v("Produto *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.produto,expression:"formData.produto"}],attrs:{id:"produto",type:"text",placeholder:"Ex: Luvas de procedimento, M√°scara N95, etc.",required:""},domProps:{value:a.formData.produto},on:{input:function(t){t.target.composing||a.$set(a.formData,"produto",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"marca"}},[a._v("Marca *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.marca,expression:"formData.marca"}],attrs:{id:"marca",type:"text",placeholder:"Ex: 3M, Medline, etc.",required:""},domProps:{value:a.formData.marca},on:{input:function(t){t.target.composing||a.$set(a.formData,"marca",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"especificacoes"}},[a._v("Especifica√ß√µes T√©cnicas (opcional)")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.formData.especificacoes,expression:"formData.especificacoes"}],attrs:{id:"especificacoes",placeholder:"Descreva especifica√ß√µes t√©cnicas espec√≠ficas que deseja pesquisar...",rows:"3"},domProps:{value:a.formData.especificacoes},on:{input:function(t){t.target.composing||a.$set(a.formData,"especificacoes",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Categorias de Busca")]),t("div",{staticClass:"categories-grid"},a._l(a.categorias,(function(o){return t("div",{key:o.id,staticClass:"category-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.categoriasEscolhidas,expression:"categoriasEscolhidas"}],attrs:{id:o.id,type:"checkbox"},domProps:{value:o.id,checked:Array.isArray(a.categoriasEscolhidas)?a._i(a.categoriasEscolhidas,o.id)>-1:a.categoriasEscolhidas},on:{change:function(t){var e=a.categoriasEscolhidas,i=t.target,s=!!i.checked;if(Array.isArray(e)){var r=o.id,n=a._i(e,r);i.checked?n<0&&(a.categoriasEscolhidas=e.concat([r])):n>-1&&(a.categoriasEscolhidas=e.slice(0,n).concat(e.slice(n+1)))}else a.categoriasEscolhidas=s}}}),t("label",{attrs:{for:o.id}},[t("strong",[a._v(a._s(o.nome))]),t("span",[a._v(a._s(o.descricao))])])])})),0)]),t("div",{staticClass:"action-buttons"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.selecionarTodas}},[a._v(" Selecionar Todas ")]),t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.limparSelecao}},[a._v(" Limpar Sele√ß√£o ")]),t("button",{staticClass:"btn-primary",attrs:{disabled:!a.podeRealizar||a.carregando},on:{click:a.buscarInformacoes}},[a.carregando?t("i",{staticClass:"fas fa-spinner fa-spin"}):t("i",{staticClass:"fas fa-search"}),a._v(" "+a._s(a.carregando?"Pesquisando...":"Pesquisar")+" ")])])]),a.carregando?t("div",{staticClass:"loading-status"},[t("div",{staticClass:"progress-info"},[t("p",[a._v(a._s(a.statusAtual))]),t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress-fill",style:{width:a.progresso+"%"}})])])]):a._e(),a.resultados.length>0?t("div",{staticClass:"results-section"},[t("h3",[a._v("Resultados da Pesquisa")]),t("div",{staticClass:"consolidation-section"},[t("button",{staticClass:"btn-consolidate",attrs:{disabled:a.gerandoRelatorio},on:{click:a.gerarRelatorioConsolidado}},[a.gerandoRelatorio?t("i",{staticClass:"fas fa-spinner fa-spin"}):t("i",{staticClass:"fas fa-file-alt"}),a._v(" "+a._s(a.gerandoRelatorio?"Gerando Relat√≥rio...":"Gerar Relat√≥rio Consolidado")+" ")])]),a.relatorioConsolidado?t("div",{staticClass:"consolidated-report"},[t("h4",[a._v("Relat√≥rio Consolidado")]),t("div",{staticClass:"report-content",domProps:{innerHTML:a._s(a.formatarTexto(a.relatorioConsolidado.relatorio))}}),t("div",{staticClass:"report-meta"},[t("small",[a._v("Gerado em: "+a._s(a.formatarData(a.relatorioConsolidado.timestamp)))])])]):a._e(),t("div",{staticClass:"results-grid"},a._l(a.resultados,(function(o){return t("div",{key:o.categoria,staticClass:"result-card"},[t("div",{staticClass:"result-header"},[t("h4",[a._v(a._s(a.getCategoriaInfo(o.categoria).nome))]),t("span",{staticClass:"result-timestamp"},[a._v(a._s(a.formatarData(o.timestamp)))])]),t("div",{staticClass:"result-content"},[t("div",{domProps:{innerHTML:a._s(a.formatarTexto(o.resultado))}})]),t("div",{staticClass:"result-sources"},[t("strong",[a._v("Fontes consultadas:")]),t("ul",a._l(a.getCategoriaInfo(o.categoria).fontes,(function(o){return t("li",{key:o},[a._v(" "+a._s(o)+" ")])})),0)])])})),0)]):a._e(),a.historico.length>0?t("div",{staticClass:"history-section"},[t("h3",[a._v("Hist√≥rico de Pesquisas")]),t("div",{staticClass:"history-list"},a._l(a.historico.slice(0,5),(function(o,e){return t("div",{key:e,staticClass:"history-item",on:{click:function(t){return a.carregarPesquisa(o)}}},[t("div",{staticClass:"history-info"},[t("strong",[a._v(a._s(o.produto)+" - "+a._s(o.marca))]),t("span",[a._v(a._s(a.formatarData(o.timestamp)))])]),t("div",{staticClass:"history-categories"},[a._v(" "+a._s(o.categorias.length)+" categoria(s) pesquisada(s) ")])])})),0)]):a._e()])},H=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"header"},[t("div",{staticClass:"icon"},[t("i",{staticClass:"fas fa-search"})]),t("div",{staticClass:"title"},[t("h2",[a._v("PesquisaBot")]),t("p",[a._v("Assistente especializado em pesquisas t√©cnicas de produtos")])])])}],Q=o(6288);const Y="AIzaSyAf-Oe56q4Rao0OodEOtnEjtI_FpOmDg6I";class K{constructor(){this.genAI=new Q.ij(Y),this.model=this.genAI.getGenerativeModel({model:"gemini-1.5-flash"})}getCategoriasBusca(){return[{id:"manuais",nome:"Manuais do Fabricante",descricao:"Manuais t√©cnicos e de instru√ß√µes do fabricante",fontes:["Sites oficiais dos fabricantes","Portais t√©cnicos","Documenta√ß√£o oficial"]},{id:"laudos",nome:"Laudos e Testes",descricao:"Laudos t√©cnicos e resultados de testes de funcionalidade",fontes:["Laborat√≥rios certificados","Institutos de pesquisa","√ìrg√£os reguladores"]},{id:"normas",nome:"Normas T√©cnicas",descricao:"Normas ABNT, NR e outras regulamenta√ß√µes t√©cnicas",fontes:["ABNT","Minist√©rio do Trabalho","√ìrg√£os reguladores setoriais"]},{id:"anvisa",nome:"Informa√ß√µes ANVISA",descricao:"Registros, alertas e informa√ß√µes da ANVISA",fontes:["Portal ANVISA","Sistema de notifica√ß√µes","Boletins t√©cnicos"]},{id:"vigilancia",nome:"Vigil√¢ncia Sanit√°ria",descricao:"Informa√ß√µes de vigil√¢ncias sanit√°rias estaduais e municipais",fontes:["√ìrg√£os estaduais","Vigil√¢ncias municipais","Sistemas de notifica√ß√£o"]},{id:"reclamacoes",nome:"Reclama√ß√µes de Usu√°rios",descricao:"Reclama√ß√µes e avalia√ß√µes de usu√°rios sobre produtos",fontes:["Reclame Aqui","Procon","F√≥runs especializados"]},{id:"recalls",nome:"Recalls e Alertas",descricao:"Recalls de produtos e alertas de seguran√ßa",fontes:["Portal do Consumidor","INMETRO","Fabricantes"]},{id:"certificacoes",nome:"Certifica√ß√µes",descricao:"Certifica√ß√µes de qualidade e conformidade",fontes:["INMETRO","Organismos certificadores","ISO"]}]}gerarPromptEspecializado(a,t,o,e){const i={manuais:`\n        Voc√™ √© um especialista em pesquisa t√©cnica de produtos. Preciso encontrar informa√ß√µes sobre manuais do fabricante para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, forne√ßa informa√ß√µes detalhadas sobre:\n        1. Onde encontrar o manual oficial do fabricante\n        2. Especifica√ß√µes t√©cnicas principais\n        3. Instru√ß√µes de uso e instala√ß√£o\n        4. Requisitos de manuten√ß√£o\n        5. Garantias e condi√ß√µes de uso\n        \n        Seja espec√≠fico e cite fontes confi√°veis quando poss√≠vel.\n      `,laudos:`\n        Voc√™ √© um especialista em an√°lise t√©cnica de produtos. Preciso encontrar informa√ß√µes sobre laudos e testes para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, forne√ßa informa√ß√µes sobre:\n        1. Laudos t√©cnicos dispon√≠veis\n        2. Testes de funcionalidade realizados\n        3. Certifica√ß√µes de qualidade\n        4. Resultados de desempenho\n        5. Laborat√≥rios que realizaram os testes\n        \n        Priorize informa√ß√µes de fontes oficiais e laborat√≥rios certificados.\n      `,normas:`\n        Voc√™ √© um especialista em normas t√©cnicas. Preciso encontrar informa√ß√µes sobre regulamenta√ß√µes para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, identifique:\n        1. Normas ABNT aplic√°veis\n        2. Normas Regulamentadoras (NR) relevantes\n        3. Outras regulamenta√ß√µes t√©cnicas\n        4. Requisitos de conformidade\n        5. Certifica√ß√µes obrigat√≥rias\n        \n        Cite os n√∫meros das normas e √≥rg√£os respons√°veis.\n      `,anvisa:`\n        Voc√™ √© um especialista em regulamenta√ß√µes sanit√°rias. Preciso encontrar informa√ß√µes da ANVISA sobre:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, pesquise:\n        1. Registro na ANVISA (se aplic√°vel)\n        2. Alertas ou notifica√ß√µes\n        3. Restri√ß√µes de uso\n        4. Classifica√ß√£o de risco\n        5. Hist√≥rico de irregularidades\n        \n        Foque em informa√ß√µes oficiais do portal da ANVISA.\n      `,vigilancia:`\n        Voc√™ √© um especialista em vigil√¢ncia sanit√°ria. Preciso encontrar informa√ß√µes sobre:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, pesquise em vigil√¢ncias sanit√°rias:\n        1. Notifica√ß√µes estaduais\n        2. Alertas municipais\n        3. Interdi√ß√µes ou apreens√µes\n        4. Irregularidades encontradas\n        5. Medidas cautelares\n        \n        Inclua informa√ß√µes de diferentes estados quando relevante.\n      `,reclamacoes:`\n        Voc√™ √© um especialista em an√°lise de satisfa√ß√£o do consumidor. Preciso encontrar informa√ß√µes sobre reclama√ß√µes para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, analise:\n        1. Principais reclama√ß√µes dos usu√°rios\n        2. Problemas mais frequentes\n        3. Avalia√ß√µes e notas\n        4. Resolu√ß√µes de problemas\n        5. Tend√™ncias de satisfa√ß√£o\n        \n        Use fontes como Reclame Aqui, Procon e f√≥runs especializados.\n      `,recalls:`\n        Voc√™ √© um especialista em seguran√ßa de produtos. Preciso encontrar informa√ß√µes sobre recalls para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, pesquise:\n        1. Recalls oficiais\n        2. Alertas de seguran√ßa\n        3. Defeitos identificados\n        4. Medidas corretivas\n        5. Cronograma de corre√ß√µes\n        \n        Priorize informa√ß√µes do Portal do Consumidor e INMETRO.\n      `,certificacoes:`\n        Voc√™ √© um especialista em certifica√ß√µes de qualidade. Preciso encontrar informa√ß√µes sobre certifica√ß√µes para:\n        \n        Produto: ${t}\n        Marca: ${o}\n        Especifica√ß√µes: ${e}\n        \n        Por favor, identifique:\n        1. Certifica√ß√µes de qualidade\n        2. Selos de conformidade\n        3. Organismos certificadores\n        4. Validade das certifica√ß√µes\n        5. Processos de certifica√ß√£o\n        \n        Foque em certifica√ß√µes oficiais e reconhecidas.\n      `};return i[a]||i.manuais}async buscarInformacoesTecnicas(a,t,o,e=""){try{console.log(`üîç PesquisaService: Iniciando busca para categoria ${a}`);const i=this.gerarPromptEspecializado(a,t,o,e);console.log(`üìù PesquisaService: Prompt gerado para ${a}:`,i.substring(0,200)+"..."),console.log("ü§ñ PesquisaService: Enviando para Gemini API...");const s=await this.model.generateContent(i),r=await s.response,n=r.text();return console.log(`‚úÖ PesquisaService: Resposta recebida para ${a}:`,n.substring(0,200)+"..."),{success:!0,categoria:a,produto:t,marca:o,resultado:n,timestamp:(new Date).toISOString()}}catch(i){return console.error(`‚ùå PesquisaService: Erro na busca t√©cnica para ${a}:`,i),{success:!1,error:i.message,categoria:a,produto:t,marca:o}}}async buscarMultiplasCategorias(a,t,o,e=""){const i=a.map((a=>this.buscarInformacoesTecnicas(a,t,o,e)));try{const a=await Promise.all(i);return{success:!0,produto:t,marca:o,resultados:a.filter((a=>a.success)),erros:a.filter((a=>!a.success))}}catch(s){return console.error("Erro na busca m√∫ltipla:",s),{success:!1,error:s.message,produto:t,marca:o}}}async gerarRelatorioConsolidado(a,t,o=""){const e=this.getCategoriasBusca().map((a=>a.id)),i=await this.buscarMultiplasCategorias(e,a,t,o);if(i.success){const o=`\n        Voc√™ √© um especialista em an√°lise t√©cnica de produtos. Com base nas informa√ß√µes coletadas sobre o produto "${a}" da marca "${t}", gere um relat√≥rio consolidado que inclua:\n        \n        1. RESUMO EXECUTIVO\n        2. ESPECIFICA√á√ïES T√âCNICAS\n        3. CONFORMIDADE REGULAT√ìRIA\n        4. QUALIDADE E CERTIFICA√á√ïES\n        5. HIST√ìRICO DE PROBLEMAS\n        6. RECOMENDA√á√ïES\n        \n        Informa√ß√µes coletadas:\n        ${i.resultados.map((a=>`\n=== ${a.categoria.toUpperCase()} ===\n${a.resultado}`)).join("\n")}\n        \n        Organize as informa√ß√µes de forma clara e profissional, destacando pontos importantes para a pr√©-qualifica√ß√£o de bens.\n      `;try{const e=await this.model.generateContent(o),s=await e.response,r=s.text();return{success:!0,produto:a,marca:t,relatorio:r,detalhes:i.resultados,timestamp:(new Date).toISOString()}}catch(s){return{success:!0,produto:a,marca:t,relatorio:"Erro ao gerar relat√≥rio consolidado",detalhes:i.resultados,timestamp:(new Date).toISOString()}}}return i}}const W=new K,X={name:"PesquisaBot",data(){return{formData:{produto:"",marca:"",especificacoes:""},categorias:[],categoriasEscolhidas:[],resultados:[],relatorioConsolidado:null,historico:[],carregando:!1,gerandoRelatorio:!1,statusAtual:"",progresso:0}},computed:{podeRealizar(){return this.formData.produto.trim()&&this.formData.marca.trim()&&this.categoriasEscolhidas.length>0}},mounted(){this.carregarCategorias(),this.carregarHistorico()},methods:{carregarCategorias(){this.categorias=W.getCategoriasBusca(),this.categoriasEscolhidas=["manuais","laudos","normas"]},carregarHistorico(){const a=localStorage.getItem("pesquisa-historico");a&&(this.historico=JSON.parse(a))},salvarHistorico(){localStorage.setItem("pesquisa-historico",JSON.stringify(this.historico))},selecionarTodas(){this.categoriasEscolhidas=this.categorias.map((a=>a.id))},limparSelecao(){this.categoriasEscolhidas=[]},async buscarInformacoes(){if(this.podeRealizar){this.carregando=!0,this.resultados=[],this.relatorioConsolidado=null,this.progresso=0,console.log("üîç Iniciando pesquisa:",{produto:this.formData.produto,marca:this.formData.marca,categorias:this.categoriasEscolhidas});try{const a=this.categoriasEscolhidas.length;let t=0;this.statusAtual="Iniciando pesquisa...";const o=this.categoriasEscolhidas.map((async o=>{this.statusAtual=`Pesquisando ${this.getCategoriaInfo(o).nome}...`,console.log(`üîç Pesquisando categoria: ${o}`);const e=await W.buscarInformacoesTecnicas(o,this.formData.produto,this.formData.marca,this.formData.especificacoes);return console.log(`üìä Resultado da categoria ${o}:`,e),t++,this.progresso=t/a*100,e})),e=await Promise.all(o);console.log("üìã Todos os resultados:",e),this.resultados=e.filter((a=>a.success)),console.log("‚úÖ Resultados filtrados (success):",this.resultados),this.historico.unshift({produto:this.formData.produto,marca:this.formData.marca,especificacoes:this.formData.especificacoes,categorias:this.categoriasEscolhidas,timestamp:(new Date).toISOString(),resultados:this.resultados.length}),this.historico=this.historico.slice(0,10),this.salvarHistorico(),this.statusAtual="Pesquisa conclu√≠da!",0===this.resultados.length&&(console.warn("‚ö†Ô∏è Nenhum resultado encontrado"),this.$swal({title:"‚ö†Ô∏è Aviso",text:"Nenhum resultado encontrado. Verifique sua conex√£o com a internet ou tente novamente.",icon:"warning"}))}catch(a){console.error("‚ùå Erro na pesquisa:",a),this.statusAtual="Erro na pesquisa. Tente novamente.",this.$swal({title:"‚ùå Erro",text:"Erro na pesquisa: "+a.message,icon:"error"})}finally{this.carregando=!1,setTimeout((()=>{this.statusAtual="",this.progresso=0}),2e3)}}},async gerarRelatorioConsolidado(){if(0!==this.resultados.length){this.gerandoRelatorio=!0;try{const a=await W.gerarRelatorioConsolidado(this.formData.produto,this.formData.marca,this.formData.especificacoes);a.success&&(this.relatorioConsolidado=a)}catch(a){console.error("Erro ao gerar relat√≥rio:",a)}finally{this.gerandoRelatorio=!1}}},getCategoriaInfo(a){return this.categorias.find((t=>t.id===a))||{}},formatarTexto(a){return a?a.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/(\d+\.)/g,"<br><strong>$1</strong>"):""},formatarData(a){return new Date(a).toLocaleString("pt-BR")},carregarPesquisa(a){this.formData.produto=a.produto,this.formData.marca=a.marca,this.formData.especificacoes=a.especificacoes,this.categoriasEscolhidas=[...a.categorias]},limparFormulario(){this.formData={produto:"",marca:"",especificacoes:""},this.categoriasEscolhidas=["manuais","laudos","normas"],this.resultados=[],this.relatorioConsolidado=null}}},Z=X;var aa=(0,C.A)(Z,G,H,!1,null,"0a824c4e",null);const ta=aa.exports;var oa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"gerenciador-cotacoes"},[t("div",{staticClass:"cotacoes-header"},[a._m(0),t("div",{staticClass:"header-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaCotacao}},[a._v(" ‚ûï Nova Cota√ß√£o ")]),t("button",{staticClass:"btn-secondary",on:{click:a.exportarCotacoes}},[a._v(" üì§ Exportar ")])])]),t("div",{staticClass:"cotacoes-filtros"},[t("div",{staticClass:"filtros-row"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Produto, fornecedor ou CNPJ..."},domProps:{value:a.filtros.busca},on:{input:function(t){t.target.composing||a.$set(a.filtros,"busca",t.target.value)}}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"ativa"}},[a._v("Ativa")]),t("option",{attrs:{value:"vencida"}},[a._v("Vencida")]),t("option",{attrs:{value:"aceita"}},[a._v("Aceita")]),t("option",{attrs:{value:"cancelada"}},[a._v("Cancelada")])])]),t("div",{staticClass:"filtro-group-periodo"},[t("label",[a._v("Per√≠odo:")]),t("div",{staticClass:"periodo-inputs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataInicio",t.target.value)}}}),t("span",{staticClass:"periodo-separador"},[a._v("at√©")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataFim",t.target.value)}}})])]),t("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar ")])])]),a.loading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),t("p",[a._v("Carregando cota√ß√µes...")])]):t("div",{staticClass:"cotacoes-container"},[0!==a.cotacoesFiltradas.length||a.temFiltrosAplicados?0===a.cotacoesFiltradas.length&&a.temFiltrosAplicados?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üîç")]),t("h3",[a._v("Nenhuma cota√ß√£o encontrada")]),t("p",[a._v("Nenhuma cota√ß√£o corresponde aos filtros aplicados.")]),t("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar Filtros ")])]):t("div",{staticClass:"cotacoes-grid"},a._l(a.cotacoesFiltradas,(function(o){return t("div",{key:o.id,staticClass:"cotacao-card",class:{vencida:a.isCotacaoVencida(o),aceita:"aceita"===o.status}},[t("div",{staticClass:"cotacao-header"},[t("div",{staticClass:"cotacao-info"},[t("h5",[a._v(a._s(o.produto_nome))]),t("div",{staticClass:"cotacao-meta"},[t("span",{staticClass:"data"},[a._v(a._s(a.formatDate(o.data_cotacao)))]),t("span",{staticClass:"status",class:o.status},[a._v(a._s(a.getStatusLabel(o.status)))])])]),t("div",{staticClass:"cotacao-preco"},[t("div",{staticClass:"preco-unitario"},[a._v(a._s(a.formatCurrency(o.preco_unitario)))]),o.preco_total?t("div",{staticClass:"preco-total"},[a._v(" Total: "+a._s(a.formatCurrency(o.preco_total))+" ")]):a._e()])]),t("div",{staticClass:"cotacao-body"},[t("div",{staticClass:"fornecedor-info"},[t("p",[t("strong",[a._v("Fornecedor:")]),a._v(" "+a._s(o.fornecedor_nome))]),o.fornecedor_cnpj?t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.formatCNPJ(o.fornecedor_cnpj)))]):a._e(),o.quantidade?t("p",[t("strong",[a._v("Quantidade:")]),a._v(" "+a._s(o.quantidade)+" "+a._s(o.unidade_medida))]):a._e()]),t("div",{staticClass:"condicoes-info"},[o.prazo_entrega?t("p",[t("strong",[a._v("Prazo:")]),a._v(" "+a._s(o.prazo_entrega)+" dias")]):a._e(),o.data_validade?t("p",[t("strong",[a._v("V√°lida at√©:")]),a._v(" "+a._s(a.formatDate(o.data_validade)))]):a._e(),o.condicoes_pagamento?t("p",[t("strong",[a._v("Assist√™ncia T√©cnica:")]),a._v(" "+a._s(o.condicoes_pagamento))]):a._e()])]),t("div",{staticClass:"cotacao-actions"},[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarCotacao(o)}}},[a._v("üëÅÔ∏è Ver")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.editarCotacao(o)}}},[a._v("‚úèÔ∏è Editar")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.duplicarCotacao(o)}}},[a._v("üìã Duplicar")]),"ativa"===o.status?t("button",{staticClass:"btn-small btn-success",on:{click:function(t){return a.aceitarCotacao(o)}}},[a._v(" ‚úÖ Aceitar ")]):a._e(),t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.removerCotacao(o)}}},[a._v("üóëÔ∏è Remover")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üí∞")]),t("h3",[a._v("Nenhuma cota√ß√£o registrada")]),t("p",[a._v("Comece registrando cota√ß√µes de fornecedores para an√°lise t√©cnica e padroniza√ß√£o de produtos.")]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaCotacao}},[a._v(" ‚ûï Registrar Primeira Cota√ß√£o ")])])]),a.modalCotacao.show?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalCotacao}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modalCotacao.editando?"‚úèÔ∏è Editar Cota√ß√£o":"‚ûï Nova Cota√ß√£o"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalCotacao}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("form",{staticClass:"form-cotacao",on:{submit:function(t){return t.preventDefault(),a.salvarCotacao.apply(null,arguments)}}},[t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üì¶ Dados do Produto")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Nome do Produto*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_nome,expression:"cotacaoForm.produto_nome"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Notebook Dell Inspiron 15"},domProps:{value:a.cotacaoForm.produto_nome},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"produto_nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Unidade")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.unidade_medida,expression:"cotacaoForm.unidade_medida"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.cotacaoForm,"unidade_medida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"UN"}},[a._v("Unidade")]),t("option",{attrs:{value:"CX"}},[a._v("Caixa")]),t("option",{attrs:{value:"KG"}},[a._v("Quilograma")]),t("option",{attrs:{value:"LT"}},[a._v("Litro")]),t("option",{attrs:{value:"MT"}},[a._v("Metro")]),t("option",{attrs:{value:"M2"}},[a._v("Metro¬≤")]),t("option",{attrs:{value:"M3"}},[a._v("Metro¬≥")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Quantidade")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.quantidade,expression:"cotacaoForm.quantidade",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",step:"0.01"},domProps:{value:a.cotacaoForm.quantidade},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"quantidade",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_descricao,expression:"cotacaoForm.produto_descricao"}],staticClass:"textarea-field",attrs:{rows:"2",placeholder:"Descri√ß√£o detalhada do produto..."},domProps:{value:a.cotacaoForm.produto_descricao},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"produto_descricao",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Especifica√ß√£o T√©cnica")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_especificacao,expression:"cotacaoForm.produto_especificacao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"Especifica√ß√µes t√©cnicas detalhadas..."},domProps:{value:a.cotacaoForm.produto_especificacao},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"produto_especificacao",t.target.value)}}})])])]),t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üè¢ Dados do Fornecedor")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Nome do Fornecedor*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_nome,expression:"cotacaoForm.fornecedor_nome"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Dell Computadores do Brasil Ltda"},domProps:{value:a.cotacaoForm.fornecedor_nome},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"fornecedor_nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("CNPJ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_cnpj,expression:"cotacaoForm.fornecedor_cnpj"}],staticClass:"input-field",attrs:{type:"text",placeholder:"00.000.000/0000-00"},domProps:{value:a.cotacaoForm.fornecedor_cnpj},on:{input:[function(t){t.target.composing||a.$set(a.cotacaoForm,"fornecedor_cnpj",t.target.value)},a.formatarCNPJ]}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Contato")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_contato,expression:"cotacaoForm.fornecedor_contato"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Nome do contato"},domProps:{value:a.cotacaoForm.fornecedor_contato},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"fornecedor_contato",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Telefone")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_telefone,expression:"cotacaoForm.fornecedor_telefone"}],staticClass:"input-field",attrs:{type:"text",placeholder:"(00) 0000-0000"},domProps:{value:a.cotacaoForm.fornecedor_telefone},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"fornecedor_telefone",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("E-mail")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_email,expression:"cotacaoForm.fornecedor_email"}],staticClass:"input-field",attrs:{type:"email",placeholder:"contato@fornecedor.com"},domProps:{value:a.cotacaoForm.fornecedor_email},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"fornecedor_email",t.target.value)}}})])])]),t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üí∞ Dados Comerciais")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Pre√ßo Unit√°rio*")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.preco_unitario,expression:"cotacaoForm.preco_unitario",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",step:"0.01",required:"",placeholder:"0,00"},domProps:{value:a.cotacaoForm.preco_unitario},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"preco_unitario",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Prazo Entrega (dias)")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.prazo_entrega,expression:"cotacaoForm.prazo_entrega",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",placeholder:"Ex: 15"},domProps:{value:a.cotacaoForm.prazo_entrega},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"prazo_entrega",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Validade (dias)")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.validade_cotacao,expression:"cotacaoForm.validade_cotacao",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"1",placeholder:"30"},domProps:{value:a.cotacaoForm.validade_cotacao},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"validade_cotacao",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Assist√™ncia T√©cnica (Prestador e Endere√ßo)")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.condicoes_pagamento,expression:"cotacaoForm.condicoes_pagamento"}],staticClass:"textarea-field",attrs:{rows:"2",placeholder:"Ex: Autorizada Brand Tech - Rua das Flores, 123, S√£o Paulo/SP | Especializada MultiServ - Av. Central, 456, Rio de Janeiro/RJ..."},domProps:{value:a.cotacaoForm.condicoes_pagamento},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"condicoes_pagamento",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Observa√ß√µes")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.observacoes,expression:"cotacaoForm.observacoes"}],staticClass:"textarea-field",attrs:{rows:"4",placeholder:"Informa√ß√µes t√©cnicas, assist√™ncia t√©cnica, garantias, condi√ß√µes especiais, qualidade, aspectos est√©ticos... (Foco em an√°lise t√©cnica para padroniza√ß√£o, n√£o apenas pre√ßo)"},domProps:{value:a.cotacaoForm.observacoes},on:{input:function(t){t.target.composing||a.$set(a.cotacaoForm,"observacoes",t.target.value)}}})])])])])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalCotacao}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoCotacao},on:{click:a.salvarCotacao}},[a._v(" "+a._s(a.salvandoCotacao?"Salvando...":"Salvar Cota√ß√£o")+" ")])])])]):a._e()])},ea=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-info"},[t("h4",[a._v("üí∞ Gerenciamento de Cota√ß√µes")]),t("p",[a._v("Registre e gerencie cota√ß√µes de fornecedores para an√°lise t√©cnica e padroniza√ß√£o de marcas e modelos. Foco em informa√ß√µes t√©cnicas, qualidade e assist√™ncia t√©cnica para sele√ß√£o rigorosa de produtos.")])])}];const ia={name:"GerenciadorCotacoes",data(){return{cotacoes:[],loading:!1,salvandoCotacao:!1,filtros:{busca:"",status:"",dataInicio:"",dataFim:""},modalCotacao:{show:!1,editando:!1},cotacaoForm:{id:null,produto_nome:"",produto_descricao:"",produto_especificacao:"",unidade_medida:"UN",quantidade:null,fornecedor_nome:"",fornecedor_cnpj:"",fornecedor_contato:"",fornecedor_telefone:"",fornecedor_email:"",preco_unitario:null,prazo_entrega:null,validade_cotacao:30,condicoes_pagamento:"",observacoes:""}}},computed:{cotacoesFiltradas(){let a=[...this.cotacoes];if(this.filtros.busca){const t=this.filtros.busca.toLowerCase();a=a.filter((a=>a.produto_nome.toLowerCase().includes(t)||a.fornecedor_nome.toLowerCase().includes(t)||a.fornecedor_cnpj&&a.fornecedor_cnpj.includes(t)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.dataInicio&&(a=a.filter((a=>a.data_cotacao>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.data_cotacao<=this.filtros.dataFim))),a.sort(((a,t)=>new Date(t.data_cotacao)-new Date(a.data_cotacao)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.dataInicio||this.filtros.dataFim}},async mounted(){await this.carregarCotacoes()},methods:{async carregarCotacoes(){this.loading=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const{data:t,error:o}=await R.ND.from("cotacoes").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(o)throw o;this.cotacoes=t||[]}catch(a){console.error("Erro ao carregar cota√ß√µes:",a),this.$swal({title:"Erro",text:"Erro ao carregar cota√ß√µes: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovaCotacao(){this.modalCotacao.show=!0,this.modalCotacao.editando=!1,this.resetarFormulario()},fecharModalCotacao(){this.modalCotacao.show=!1,this.resetarFormulario()},resetarFormulario(){this.cotacaoForm={id:null,produto_nome:"",produto_descricao:"",produto_especificacao:"",unidade_medida:"UN",quantidade:null,fornecedor_nome:"",fornecedor_cnpj:"",fornecedor_contato:"",fornecedor_telefone:"",fornecedor_email:"",preco_unitario:null,prazo_entrega:null,validade_cotacao:30,condicoes_pagamento:"",observacoes:""}},async salvarCotacao(){this.salvandoCotacao=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const t={...this.cotacaoForm,tenant_id:a};if(this.modalCotacao.editando){const{error:a}=await R.ND.from("cotacoes").update(t).eq("id",this.cotacaoForm.id);if(a)throw a}else{delete t.id;const{error:a}=await R.ND.from("cotacoes").insert([t]);if(a)throw a}this.$swal({title:"Sucesso!",text:`Cota√ß√£o ${this.modalCotacao.editando?"atualizada":"registrada"} com sucesso`,icon:"success",timer:2e3}),await this.carregarCotacoes(),this.fecharModalCotacao()}catch(a){console.error("Erro ao salvar cota√ß√£o:",a),this.$swal({title:"Erro",text:"Erro ao salvar cota√ß√£o: "+a.message,icon:"error"})}finally{this.salvandoCotacao=!1}},editarCotacao(a){this.cotacaoForm={...a},this.modalCotacao.show=!0,this.modalCotacao.editando=!0},async removerCotacao(a){const t=await this.$swal({title:"Confirmar exclus√£o",text:`Deseja realmente remover a cota√ß√£o de "${a.produto_nome}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("cotacoes").delete().eq("id",a.id);if(t)throw t;this.$swal({title:"Removida!",text:"Cota√ß√£o removida com sucesso",icon:"success",timer:2e3}),await this.carregarCotacoes()}catch(o){console.error("Erro ao remover cota√ß√£o:",o),this.$swal({title:"Erro",text:"Erro ao remover cota√ß√£o: "+o.message,icon:"error"})}},visualizarCotacao(a){this.$swal({title:`Cota√ß√£o: ${a.produto_nome}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>üì¶ Produto</h4>\n            <p><strong>Nome:</strong> ${a.produto_nome}</p>\n            ${a.produto_descricao?`<p><strong>Descri√ß√£o:</strong> ${a.produto_descricao}</p>`:""}\n            ${a.quantidade?`<p><strong>Quantidade:</strong> ${a.quantidade} ${a.unidade_medida}</p>`:""}\n            \n            <h4>üè¢ Fornecedor</h4>\n            <p><strong>Nome:</strong> ${a.fornecedor_nome}</p>\n            ${a.fornecedor_cnpj?`<p><strong>CNPJ:</strong> ${this.formatCNPJ(a.fornecedor_cnpj)}</p>`:""}\n            ${a.fornecedor_contato?`<p><strong>Contato:</strong> ${a.fornecedor_contato}</p>`:""}\n            \n            <h4>üí∞ Comercial</h4>\n            <p><strong>Pre√ßo Unit√°rio:</strong> ${this.formatCurrency(a.preco_unitario)}</p>\n            ${a.preco_total?`<p><strong>Pre√ßo Total:</strong> ${this.formatCurrency(a.preco_total)}</p>`:""}\n            ${a.prazo_entrega?`<p><strong>Prazo:</strong> ${a.prazo_entrega} dias</p>`:""}\n            ${a.data_validade?`<p><strong>V√°lida at√©:</strong> ${this.formatDate(a.data_validade)}</p>`:""}\n            ${a.condicoes_pagamento?`<p><strong>Assist√™ncia T√©cnica:</strong> ${a.condicoes_pagamento}</p>`:""}\n            ${a.observacoes?`<p><strong>Observa√ß√µes:</strong> ${a.observacoes}</p>`:""}\n          </div>\n        `,width:"600px",confirmButtonText:"Fechar"})},duplicarCotacao(a){this.cotacaoForm={...a,id:null,produto_nome:a.produto_nome+" (C√≥pia)"},this.modalCotacao.show=!0,this.modalCotacao.editando=!1},async aceitarCotacao(a){const t=await this.$swal({title:"Aceitar Cota√ß√£o",text:`Deseja aceitar a cota√ß√£o de "${a.produto_nome}" de ${a.fornecedor_nome}?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, aceitar",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("cotacoes").update({status:"aceita"}).eq("id",a.id);if(t)throw t;this.$swal({title:"Aceita!",text:"Cota√ß√£o aceita com sucesso",icon:"success",timer:2e3}),await this.carregarCotacoes()}catch(o){console.error("Erro ao aceitar cota√ß√£o:",o),this.$swal({title:"Erro",text:"Erro ao aceitar cota√ß√£o: "+o.message,icon:"error"})}},limparFiltros(){this.filtros={busca:"",status:"",dataInicio:"",dataFim:""}},async exportarCotacoes(){try{if(0===this.cotacoesFiltradas.length)return void this.$swal({title:"Aten√ß√£o",text:"N√£o h√° cota√ß√µes para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"üì§ Exportar Cota√ß√µes",text:`Exportar ${this.cotacoesFiltradas.length} cota√ß√£o(√µes). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"üìä Excel (.xlsx)",cancelButtonText:"üìÑ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportCotacoes:t}=await o.e(913).then(o.bind(o,1913)),e=a?"excel":"csv";await t(this.cotacoesFiltradas,e),this.$swal({title:"Sucesso!",text:`${this.cotacoesFiltradas.length} cota√ß√£o(√µes) exportada(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar cota√ß√µes:",a),this.$swal({title:"Erro",text:"Erro ao exportar cota√ß√µes: "+a.message,icon:"error"})}},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},formatCNPJ(a){return a?a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatarCNPJ(a){let t=a.target.value.replace(/\D/g,"");t=t.replace(/^(\d{2})(\d)/,"$1.$2"),t=t.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),t=t.replace(/\.(\d{3})(\d)/,".$1/$2"),t=t.replace(/(\d{4})(\d)/,"$1-$2"),a.target.value=t,this.cotacaoForm.fornecedor_cnpj=t},getStatusLabel(a){const t={ativa:"Ativa",vencida:"Vencida",aceita:"Aceita",cancelada:"Cancelada"};return t[a]||a},isCotacaoVencida(a){return!!a.data_validade&&new Date(a.data_validade)<new Date}}},sa=ia;var ra=(0,C.A)(sa,oa,ea,!1,null,"129476b6",null);const na=ra.exports;var la=function(){var a=this,t=a._self._c;return t("div",{staticClass:"gerenciador-comparativo"},[t("div",{staticClass:"comparativo-header"},[a._m(0),t("div",{staticClass:"header-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoComparativo}},[a._v(" ‚ûï Novo Comparativo ")]),t("button",{staticClass:"btn-secondary",on:{click:a.exportarComparativos}},[a._v(" üì§ Exportar ")])])]),t("div",{staticClass:"comparativo-filtros"},[t("div",{staticClass:"filtros-row"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"T√≠tulo, categoria ou descri√ß√£o..."},domProps:{value:a.filtros.busca},on:{input:function(t){t.target.composing||a.$set(a.filtros,"busca",t.target.value)}}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"em_andamento"}},[a._v("Em Andamento")]),t("option",{attrs:{value:"finalizado"}},[a._v("Finalizado")]),t("option",{attrs:{value:"cancelado"}},[a._v("Cancelado")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"tecnico"}},[a._v("T√©cnico")]),t("option",{attrs:{value:"preco"}},[a._v("Pre√ßo")]),t("option",{attrs:{value:"completo"}},[a._v("Completo")])])]),t("div",{staticClass:"filtro-group-periodo"},[t("label",[a._v("Per√≠odo:")]),t("div",{staticClass:"periodo-inputs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataInicio",t.target.value)}}}),t("span",{staticClass:"periodo-separador"},[a._v("at√©")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataFim",t.target.value)}}})])]),t("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar ")])])]),a.loading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),t("p",[a._v("Carregando comparativos...")])]):t("div",{staticClass:"comparativos-container"},[0!==a.comparativosFiltrados.length||a.temFiltrosAplicados?0===a.comparativosFiltrados.length&&a.temFiltrosAplicados?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üîç")]),t("h3",[a._v("Nenhum comparativo encontrado")]),t("p",[a._v("Nenhum comparativo corresponde aos filtros aplicados.")]),t("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar Filtros ")])]):t("div",{staticClass:"comparativos-grid"},a._l(a.comparativosFiltrados,(function(o){return t("div",{key:o.id,staticClass:"comparativo-card",class:{finalizado:"finalizado"===o.status,cancelado:"cancelado"===o.status,vencido:a.isComparativoVencido(o)}},[t("div",{staticClass:"comparativo-header-card"},[t("div",{staticClass:"comparativo-info"},[t("h5",[a._v(a._s(o.titulo))]),t("div",{staticClass:"comparativo-meta"},[t("span",{staticClass:"categoria"},[a._v(a._s(o.categoria||"Sem categoria"))]),t("span",{staticClass:"data"},[a._v(a._s(a.formatDate(o.data_inicio)))]),t("span",{staticClass:"status",class:o.status},[a._v(a._s(a.getStatusLabel(o.status)))])])]),t("div",{staticClass:"comparativo-stats"},[t("div",{staticClass:"stat"},[t("span",{staticClass:"number"},[a._v(a._s(a.getItensCount(o.id)))]),t("span",{staticClass:"label"},[a._v("Itens")])])])]),t("div",{staticClass:"comparativo-body"},[t("div",{staticClass:"comparativo-desc"},[o.descricao?t("p",[a._v(a._s(a.truncateText(o.descricao,100)))]):t("p",{staticClass:"sem-descricao"},[a._v("Sem descri√ß√£o")])]),t("div",{staticClass:"comparativo-detalhes"},[t("div",{staticClass:"detalhe"},[t("strong",[a._v("Tipo:")]),a._v(" "+a._s(a.getTipoLabel(o.tipo_comparativo))+" ")]),o.prazo_resposta?t("div",{staticClass:"detalhe"},[t("strong",[a._v("Prazo:")]),a._v(" "+a._s(a.formatDate(o.prazo_resposta))+" ")]):a._e(),o.metodologia?t("div",{staticClass:"detalhe"},[t("strong",[a._v("Metodologia:")]),a._v(" "+a._s(a.getMetodologiaLabel(o.metodologia))+" ")]):a._e()])]),t("div",{staticClass:"comparativo-actions"},[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarComparativo(o)}}},[a._v("üëÅÔ∏è Ver")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.editarComparativo(o)}}},[a._v("‚úèÔ∏è Editar")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.gerenciarItens(o)}}},[a._v("üìã Itens")]),"em_andamento"===o.status?t("button",{staticClass:"btn-small btn-success",on:{click:function(t){return a.finalizarComparativo(o)}}},[a._v(" ‚úÖ Finalizar ")]):a._e(),t("button",{staticClass:"btn-small",on:{click:function(t){return a.duplicarComparativo(o)}}},[a._v("üìã Duplicar")]),t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.removerComparativo(o)}}},[a._v("üóëÔ∏è Remover")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìä")]),t("h3",[a._v("Nenhum comparativo registrado")]),t("p",[a._v("Comece criando comparativos t√©cnicos para an√°lise detalhada de produtos e fornecedores.")]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoComparativo}},[a._v(" ‚ûï Criar Primeiro Comparativo ")])])]),a.modalComparativo.show?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalComparativo}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modalComparativo.editando?"‚úèÔ∏è Editar Comparativo":"‚ûï Novo Comparativo"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalComparativo}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("form",{staticClass:"form-comparativo",on:{submit:function(t){return t.preventDefault(),a.salvarComparativo.apply(null,arguments)}}},[t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üìã Dados B√°sicos")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("T√≠tulo do Comparativo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.titulo,expression:"comparativoForm.titulo"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Comparativo Notebooks Dell vs HP"},domProps:{value:a.comparativoForm.titulo},on:{input:function(t){t.target.composing||a.$set(a.comparativoForm,"titulo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Categoria")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.categoria,expression:"comparativoForm.categoria"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Ex: Inform√°tica, M√≥veis, Ve√≠culos"},domProps:{value:a.comparativoForm.categoria},on:{input:function(t){t.target.composing||a.$set(a.comparativoForm,"categoria",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.descricao,expression:"comparativoForm.descricao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"Descreva o objetivo e escopo do comparativo..."},domProps:{value:a.comparativoForm.descricao},on:{input:function(t){t.target.composing||a.$set(a.comparativoForm,"descricao",t.target.value)}}})])])]),t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("‚öôÔ∏è Configura√ß√µes")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Tipo de Comparativo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.tipo_comparativo,expression:"comparativoForm.tipo_comparativo"}],staticClass:"select-field",attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.comparativoForm,"tipo_comparativo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"tecnico"}},[a._v("T√©cnico")]),t("option",{attrs:{value:"preco"}},[a._v("Pre√ßo")]),t("option",{attrs:{value:"completo"}},[a._v("Completo")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Metodologia")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.metodologia,expression:"comparativoForm.metodologia"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.comparativoForm,"metodologia",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"matriz_decisao"}},[a._v("Matriz de Decis√£o")]),t("option",{attrs:{value:"ranking"}},[a._v("Ranking Ponderado")]),t("option",{attrs:{value:"pontuacao"}},[a._v("Sistema de Pontua√ß√£o")])])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Data de In√≠cio")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.data_inicio,expression:"comparativoForm.data_inicio"}],staticClass:"input-field",attrs:{type:"date"},domProps:{value:a.comparativoForm.data_inicio},on:{input:function(t){t.target.composing||a.$set(a.comparativoForm,"data_inicio",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Prazo para Respostas")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.prazo_resposta,expression:"comparativoForm.prazo_resposta"}],staticClass:"input-field",attrs:{type:"date"},domProps:{value:a.comparativoForm.prazo_resposta},on:{input:function(t){t.target.composing||a.$set(a.comparativoForm,"prazo_resposta",t.target.value)}}})])])])])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalComparativo}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoComparativo},on:{click:a.salvarComparativo}},[a._v(" "+a._s(a.salvandoComparativo?"Salvando...":"Salvar Comparativo")+" ")])])])]):a._e(),a.modalItens.show?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalItens}},[t("div",{staticClass:"modal-content extra-large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìã Gerenciar Itens - "+a._s(a.modalItens.comparativo?.titulo))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalItens}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"itens-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.adicionarItem}},[a._v(" ‚ûï Adicionar Item ")]),t("button",{staticClass:"btn-secondary",on:{click:a.importarDeCotacoes}},[a._v(" üì• Importar de Cota√ß√µes ")])]),t("div",{staticClass:"itens-lista"},[0===a.itensComparativo.length?t("div",{staticClass:"empty-state-small"},[t("p",[a._v("Nenhum item adicionado ao comparativo")])]):t("div",{staticClass:"itens-grid"},a._l(a.itensComparativo,(function(o){return t("div",{key:o.id,staticClass:"item-card"},[t("div",{staticClass:"item-header"},[t("h6",[a._v(a._s(o.produto_nome))]),t("span",{staticClass:"fornecedor"},[a._v(a._s(o.fornecedor_nome))])]),t("div",{staticClass:"item-body"},[o.preco_unitario?t("div",{staticClass:"item-preco"},[a._v(" "+a._s(a.formatCurrency(o.preco_unitario))+" ")]):a._e(),o.pontuacao_final?t("div",{staticClass:"item-pontuacao"},[t("span",{staticClass:"pontuacao"},[a._v(a._s(o.pontuacao_final)+"pts")]),o.posicao_ranking?t("span",{staticClass:"ranking"},[a._v("#"+a._s(o.posicao_ranking))]):a._e()]):a._e()]),t("div",{staticClass:"item-actions"},[t("button",{staticClass:"btn-mini",on:{click:function(t){return a.editarItem(o)}}},[a._v("‚úèÔ∏è")]),t("button",{staticClass:"btn-mini btn-danger",on:{click:function(t){return a.removerItem(o)}}},[a._v("üóëÔ∏è")])])])})),0)])])])]):a._e()])},ca=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-info"},[t("h4",[a._v("üìä Gerenciamento de Comparativos T√©cnicos")]),t("p",[a._v("Compare especifica√ß√µes t√©cnicas, pre√ßos e condi√ß√µes de produtos similares para tomada de decis√£o fundamentada.")])])}];const da={name:"GerenciadorComparativo",data(){return{comparativos:[],itensComparativo:[],loading:!1,salvandoComparativo:!1,filtros:{busca:"",status:"",tipo:"",dataInicio:"",dataFim:""},modalComparativo:{show:!1,editando:!1},modalItens:{show:!1,comparativo:null},comparativoForm:{id:null,titulo:"",descricao:"",categoria:"",tipo_comparativo:"tecnico",metodologia:"matriz_decisao",data_inicio:"",prazo_resposta:""}}},computed:{comparativosFiltrados(){let a=[...this.comparativos];if(this.filtros.busca){const t=this.filtros.busca.toLowerCase();a=a.filter((a=>a.titulo.toLowerCase().includes(t)||a.categoria&&a.categoria.toLowerCase().includes(t)||a.descricao&&a.descricao.toLowerCase().includes(t)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_comparativo===this.filtros.tipo))),this.filtros.dataInicio&&(a=a.filter((a=>a.data_inicio>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.data_inicio<=this.filtros.dataFim))),a.sort(((a,t)=>new Date(t.created_at)-new Date(a.created_at)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.tipo||this.filtros.dataInicio||this.filtros.dataFim}},async mounted(){await this.carregarComparativos()},methods:{async carregarComparativos(){this.loading=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const{data:t,error:o}=await R.ND.from("comparativos").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(o)throw o;this.comparativos=t||[]}catch(a){console.error("Erro ao carregar comparativos:",a),this.$swal({title:"Erro",text:"Erro ao carregar comparativos: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovoComparativo(){this.modalComparativo.show=!0,this.modalComparativo.editando=!1,this.resetarFormulario()},fecharModalComparativo(){this.modalComparativo.show=!1,this.resetarFormulario()},fecharModalItens(){this.modalItens.show=!1,this.modalItens.comparativo=null,this.itensComparativo=[]},resetarFormulario(){this.comparativoForm={id:null,titulo:"",descricao:"",categoria:"",tipo_comparativo:"tecnico",metodologia:"matriz_decisao",data_inicio:(new Date).toISOString().split("T")[0],prazo_resposta:""}},async salvarComparativo(){this.salvandoComparativo=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const t={...this.comparativoForm,tenant_id:a};if(this.modalComparativo.editando){const{error:a}=await R.ND.from("comparativos").update(t).eq("id",this.comparativoForm.id);if(a)throw a}else{delete t.id;const{error:a}=await R.ND.from("comparativos").insert([t]);if(a)throw a}this.$swal({title:"Sucesso!",text:`Comparativo ${this.modalComparativo.editando?"atualizado":"criado"} com sucesso`,icon:"success",timer:2e3}),await this.carregarComparativos(),this.fecharModalComparativo()}catch(a){console.error("Erro ao salvar comparativo:",a),this.$swal({title:"Erro",text:"Erro ao salvar comparativo: "+a.message,icon:"error"})}finally{this.salvandoComparativo=!1}},editarComparativo(a){this.comparativoForm={...a},this.modalComparativo.show=!0,this.modalComparativo.editando=!0},async removerComparativo(a){const t=await this.$swal({title:"Confirmar exclus√£o",text:`Deseja realmente remover o comparativo "${a.titulo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("comparativos").delete().eq("id",a.id);if(t)throw t;this.$swal({title:"Removido!",text:"Comparativo removido com sucesso",icon:"success",timer:2e3}),await this.carregarComparativos()}catch(o){console.error("Erro ao remover comparativo:",o),this.$swal({title:"Erro",text:"Erro ao remover comparativo: "+o.message,icon:"error"})}},visualizarComparativo(a){this.$swal({title:`üìä ${a.titulo}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>üìã Informa√ß√µes B√°sicas</h4>\n            <p><strong>Categoria:</strong> ${a.categoria||"N√£o informada"}</p>\n            <p><strong>Tipo:</strong> ${this.getTipoLabel(a.tipo_comparativo)}</p>\n            <p><strong>Status:</strong> ${this.getStatusLabel(a.status)}</p>\n            <p><strong>Metodologia:</strong> ${this.getMetodologiaLabel(a.metodologia)}</p>\n            \n            ${a.descricao?`<h4>üìù Descri√ß√£o</h4><p>${a.descricao}</p>`:""}\n            \n            <h4>üìÖ Datas</h4>\n            <p><strong>In√≠cio:</strong> ${this.formatDate(a.data_inicio)}</p>\n            ${a.prazo_resposta?`<p><strong>Prazo:</strong> ${this.formatDate(a.prazo_resposta)}</p>`:""}\n            ${a.data_conclusao?`<p><strong>Conclus√£o:</strong> ${this.formatDate(a.data_conclusao)}</p>`:""}\n          </div>\n        `,width:"600px",confirmButtonText:"Fechar"})},duplicarComparativo(a){this.comparativoForm={...a,id:null,titulo:a.titulo+" (C√≥pia)",status:"em_andamento"},this.modalComparativo.show=!0,this.modalComparativo.editando=!1},async finalizarComparativo(a){const t=await this.$swal({title:"Finalizar Comparativo",text:`Deseja finalizar o comparativo "${a.titulo}"?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, finalizar",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("comparativos").update({status:"finalizado",data_conclusao:(new Date).toISOString().split("T")[0]}).eq("id",a.id);if(t)throw t;this.$swal({title:"Finalizado!",text:"Comparativo finalizado com sucesso",icon:"success",timer:2e3}),await this.carregarComparativos()}catch(o){console.error("Erro ao finalizar comparativo:",o),this.$swal({title:"Erro",text:"Erro ao finalizar comparativo: "+o.message,icon:"error"})}},async gerenciarItens(a){this.modalItens.show=!0,this.modalItens.comparativo=a,await this.carregarItensComparativo(a.id)},async carregarItensComparativo(a){try{const{data:t,error:o}=await R.ND.from("comparativos_itens").select("*").eq("comparativo_id",a).order("posicao_ranking",{ascending:!0});if(o)throw o;this.itensComparativo=t||[]}catch(t){console.error("Erro ao carregar itens:",t)}},adicionarItem(){this.$swal({title:"‚ûï Adicionar Item",text:"Funcionalidade em desenvolvimento - Adicionar item ao comparativo",icon:"info"})},editarItem(a){this.$swal({title:"‚úèÔ∏è Editar Item",text:"Funcionalidade em desenvolvimento - Editar item do comparativo",icon:"info"})},async removerItem(a){const t=await this.$swal({title:"Confirmar exclus√£o",text:`Deseja remover "${a.produto_nome}" do comparativo?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("comparativos_itens").delete().eq("id",a.id);if(t)throw t;await this.carregarItensComparativo(this.modalItens.comparativo.id),this.$swal({title:"Removido!",text:"Item removido do comparativo",icon:"success",timer:2e3})}catch(o){console.error("Erro ao remover item:",o),this.$swal({title:"Erro",text:"Erro ao remover item: "+o.message,icon:"error"})}},limparFiltros(){this.filtros={busca:"",status:"",tipo:"",dataInicio:"",dataFim:""}},importarDeCotacoes(){this.$swal({title:"üì• Importar de Cota√ß√µes",text:"Funcionalidade em desenvolvimento - Importar cota√ß√µes para este comparativo",icon:"info"})},async exportarComparativos(){try{if(0===this.comparativosFiltrados.length)return void this.$swal({title:"Aten√ß√£o",text:"N√£o h√° comparativos para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"üì§ Exportar Comparativos",text:`Exportar ${this.comparativosFiltrados.length} comparativo(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"üìä Excel (.xlsx)",cancelButtonText:"üìÑ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportComparativos:t}=await o.e(913).then(o.bind(o,1913)),e=a?"excel":"csv";await t(this.comparativosFiltrados,e),this.$swal({title:"Sucesso!",text:`${this.comparativosFiltrados.length} comparativo(s) exportado(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar comparativos:",a),this.$swal({title:"Erro",text:"Erro ao exportar comparativos: "+a.message,icon:"error"})}},getItensCount(a){return Math.floor(5*Math.random())+1},isComparativoVencido(a){return!!a.prazo_resposta&&new Date(a.prazo_resposta)<new Date},truncateText(a,t){return a?a.length>t?a.substring(0,t)+"...":a:""},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},getStatusLabel(a){const t={em_andamento:"Em Andamento",finalizado:"Finalizado",cancelado:"Cancelado"};return t[a]||a},getTipoLabel(a){const t={tecnico:"T√©cnico",preco:"Pre√ßo",completo:"Completo"};return t[a]||a},getMetodologiaLabel(a){const t={matriz_decisao:"Matriz de Decis√£o",ranking:"Ranking Ponderado",pontuacao:"Sistema de Pontua√ß√£o"};return t[a]||a}}},ua=da;var ma=(0,C.A)(ua,la,ca,!1,null,"2bbe8de0",null);const pa=ma.exports;var va=function(){var a=this,t=a._self._c;return t("div",{staticClass:"gerenciador-analise-precos"},[t("div",{staticClass:"analise-header"},[a._m(0),t("div",{staticClass:"header-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaAnalise}},[a._v(" ‚ûï Nova An√°lise ")]),t("button",{staticClass:"btn-secondary",on:{click:a.gerarRelatorioConsolidado}},[a._v(" üìä Relat√≥rio Consolidado ")]),t("button",{staticClass:"btn-secondary",on:{click:a.exportarDados}},[a._v(" üì§ Exportar Dados ")])])]),t("div",{staticClass:"analise-filtros"},[t("div",{staticClass:"filtros-row"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"T√≠tulo, categoria ou produto..."},domProps:{value:a.filtros.busca},on:{input:function(t){t.target.composing||a.$set(a.filtros,"busca",t.target.value)}}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"processando"}},[a._v("Processando")]),t("option",{attrs:{value:"concluida"}},[a._v("Conclu√≠da")]),t("option",{attrs:{value:"erro"}},[a._v("Erro")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"tipo",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"temporal"}},[a._v("Temporal")]),t("option",{attrs:{value:"comparativa"}},[a._v("Comparativa")]),t("option",{attrs:{value:"estatistica"}},[a._v("Estat√≠stica")]),t("option",{attrs:{value:"tendencia"}},[a._v("Tend√™ncia")])])]),t("div",{staticClass:"filtro-group-periodo"},[t("label",[a._v("Per√≠odo:")]),t("div",{staticClass:"periodo-inputs"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataInicio",t.target.value)}}}),t("span",{staticClass:"periodo-separador"},[a._v("at√©")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(t){t.target.composing||a.$set(a.filtros,"dataFim",t.target.value)}}})])]),t("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar ")])])]),!a.loading&&a.analises.length>0?t("div",{staticClass:"metricas-destaque"},[t("div",{staticClass:"metrica-card"},[t("div",{staticClass:"metrica-icon"},[a._v("üìä")]),t("div",{staticClass:"metrica-content"},[t("h4",[a._v(a._s(a.analises.length))]),t("p",[a._v("An√°lises Realizadas")])])]),t("div",{staticClass:"metrica-card"},[t("div",{staticClass:"metrica-icon"},[a._v("üìà")]),t("div",{staticClass:"metrica-content"},[t("h4",[a._v(a._s(a.analisesComTendencia))]),t("p",[a._v("Com Tend√™ncias")])])]),t("div",{staticClass:"metrica-card"},[t("div",{staticClass:"metrica-icon"},[a._v("‚ö†Ô∏è")]),t("div",{staticClass:"metrica-content"},[t("h4",[a._v(a._s(a.alertasAtivos))]),t("p",[a._v("Alertas Ativos")])])]),t("div",{staticClass:"metrica-card"},[t("div",{staticClass:"metrica-icon"},[a._v("üí∞")]),t("div",{staticClass:"metrica-content"},[t("h4",[a._v(a._s(a.mediaVariacao)+"%")]),t("p",[a._v("Varia√ß√£o M√©dia")])])])]):a._e(),a.loading?t("div",{staticClass:"loading-container"},[t("div",{staticClass:"loading-spinner"}),t("p",[a._v("Carregando an√°lises...")])]):t("div",{staticClass:"analises-container"},[0!==a.analisesFiltradas.length||a.temFiltrosAplicados?0===a.analisesFiltradas.length&&a.temFiltrosAplicados?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üîç")]),t("h3",[a._v("Nenhuma an√°lise encontrada")]),t("p",[a._v("Nenhuma an√°lise corresponde aos filtros aplicados.")]),t("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" üóëÔ∏è Limpar Filtros ")])]):t("div",{staticClass:"analises-grid"},a._l(a.analisesFiltradas,(function(o){return t("div",{key:o.id,staticClass:"analise-card",class:{concluida:"concluida"===o.status,erro:"erro"===o.status,processando:"processando"===o.status}},[t("div",{staticClass:"analise-header-card"},[t("div",{staticClass:"analise-info"},[t("h5",[a._v(a._s(o.titulo))]),t("div",{staticClass:"analise-meta"},[t("span",{staticClass:"categoria"},[a._v(a._s(o.categoria||"Sem categoria"))]),t("span",{staticClass:"tipo"},[a._v(a._s(a.getTipoLabel(o.tipo_analise)))]),t("span",{staticClass:"status",class:o.status},[a._v(a._s(a.getStatusLabel(o.status)))])])]),"processando"===o.status?t("div",{staticClass:"analise-progresso"},[t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress-fill",style:{width:o.progresso+"%"}})]),t("span",{staticClass:"progress-text"},[a._v(a._s(o.progresso)+"%")])]):a._e()]),"concluida"===o.status?t("div",{staticClass:"analise-metricas"},[t("div",{staticClass:"metrica-item"},[t("span",{staticClass:"label"},[a._v("Per√≠odo:")]),t("span",{staticClass:"value"},[a._v(a._s(a.formatPeriodo(o.periodo_inicio,o.periodo_fim)))])]),o.preco_medio?t("div",{staticClass:"metrica-item"},[t("span",{staticClass:"label"},[a._v("Pre√ßo M√©dio:")]),t("span",{staticClass:"value"},[a._v(a._s(a.formatCurrency(o.preco_medio)))])]):a._e(),o.variacao_percentual?t("div",{staticClass:"metrica-item"},[t("span",{staticClass:"label"},[a._v("Varia√ß√£o:")]),t("span",{staticClass:"value",class:a.getVariacaoClass(o.variacao_percentual)},[a._v(" "+a._s(a.formatPercentual(o.variacao_percentual))+" ")])]):a._e(),o.desvio_padrao?t("div",{staticClass:"metrica-item"},[t("span",{staticClass:"label"},[a._v("Volatilidade:")]),t("span",{staticClass:"value"},[a._v(a._s(a.formatCurrency(o.desvio_padrao)))])]):a._e()]):a._e(),t("div",{staticClass:"analise-body"},[t("div",{staticClass:"analise-desc"},[o.descricao?t("p",[a._v(a._s(a.truncateText(o.descricao,120)))]):t("p",{staticClass:"sem-descricao"},[a._v("Sem descri√ß√£o")])]),"concluida"===o.status?t("div",{staticClass:"analise-detalhes"},[t("div",{staticClass:"detalhe-badges"},[o.preco_minimo&&o.preco_maximo?t("span",{staticClass:"badge"},[a._v(" üí∞ "+a._s(a.formatCurrency(o.preco_minimo))+" - "+a._s(a.formatCurrency(o.preco_maximo))+" ")]):a._e(),o.granularidade?t("span",{staticClass:"badge"},[a._v(" üìÖ "+a._s(a.getGranularidadeLabel(o.granularidade))+" ")]):a._e(),a.temTendencias(o.id)?t("span",{staticClass:"badge"},[a._v(" üìà Com Tend√™ncias ")]):a._e(),a.temAlertas(o.id)?t("span",{staticClass:"badge warning"},[a._v(" ‚ö†Ô∏è Alertas ")]):a._e()])]):a._e()]),t("div",{staticClass:"analise-actions"},[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarAnalise(o)}}},[a._v("üëÅÔ∏è Ver")]),"concluida"===o.status?t("button",{staticClass:"btn-small",on:{click:function(t){return a.verGraficos(o)}}},[a._v(" üìä Gr√°ficos ")]):a._e(),"concluida"===o.status?t("button",{staticClass:"btn-small",on:{click:function(t){return a.verTendencias(o)}}},[a._v(" üìà Tend√™ncias ")]):a._e(),t("button",{staticClass:"btn-small",on:{click:function(t){return a.editarAnalise(o)}}},[a._v("‚úèÔ∏è Editar")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.duplicarAnalise(o)}}},[a._v("üìã Duplicar")]),"processando"===o.status?t("button",{staticClass:"btn-small btn-warning",on:{click:function(t){return a.cancelarAnalise(o)}}},[a._v(" ‚ùå Cancelar ")]):a._e(),t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.removerAnalise(o)}}},[a._v("üóëÔ∏è Remover")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìà")]),t("h3",[a._v("Nenhuma an√°lise registrada")]),t("p",[a._v("Comece criando an√°lises de pre√ßos para identificar tend√™ncias e oportunidades de economia.")]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaAnalise}},[a._v(" ‚ûï Criar Primeira An√°lise ")])])]),a.modalAnalise.show?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalAnalise}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modalAnalise.editando?"‚úèÔ∏è Editar An√°lise":"‚ûï Nova An√°lise de Pre√ßos"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalAnalise}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[t("form",{staticClass:"form-analise",on:{submit:function(t){return t.preventDefault(),a.salvarAnalise.apply(null,arguments)}}},[t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üìã Dados B√°sicos")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("T√≠tulo da An√°lise*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.titulo,expression:"analiseForm.titulo"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: An√°lise de Notebooks - Q1 2024"},domProps:{value:a.analiseForm.titulo},on:{input:function(t){t.target.composing||a.$set(a.analiseForm,"titulo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Categoria")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.categoria,expression:"analiseForm.categoria"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Ex: Inform√°tica, M√≥veis, Ve√≠culos"},domProps:{value:a.analiseForm.categoria},on:{input:function(t){t.target.composing||a.$set(a.analiseForm,"categoria",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group full-width"},[t("label",[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.descricao,expression:"analiseForm.descricao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"Descreva o objetivo e escopo da an√°lise..."},domProps:{value:a.analiseForm.descricao},on:{input:function(t){t.target.composing||a.$set(a.analiseForm,"descricao",t.target.value)}}})])])]),t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("‚öôÔ∏è Configura√ß√µes da An√°lise")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Tipo de An√°lise*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.tipo_analise,expression:"analiseForm.tipo_analise"}],staticClass:"select-field",attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.analiseForm,"tipo_analise",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"temporal"}},[a._v("Temporal (evolu√ß√£o no tempo)")]),t("option",{attrs:{value:"comparativa"}},[a._v("Comparativa (entre produtos)")]),t("option",{attrs:{value:"estatistica"}},[a._v("Estat√≠stica (distribui√ß√µes)")]),t("option",{attrs:{value:"tendencia"}},[a._v("Tend√™ncia (previs√µes)")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Granularidade")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.granularidade,expression:"analiseForm.granularidade"}],staticClass:"select-field",on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.analiseForm,"granularidade",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"diaria"}},[a._v("Di√°ria")]),t("option",{attrs:{value:"semanal"}},[a._v("Semanal")]),t("option",{attrs:{value:"mensal"}},[a._v("Mensal")]),t("option",{attrs:{value:"trimestral"}},[a._v("Trimestral")]),t("option",{attrs:{value:"anual"}},[a._v("Anual")])])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Data In√≠cio*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.periodo_inicio,expression:"analiseForm.periodo_inicio"}],staticClass:"input-field",attrs:{type:"date",required:""},domProps:{value:a.analiseForm.periodo_inicio},on:{input:function(t){t.target.composing||a.$set(a.analiseForm,"periodo_inicio",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Data Fim*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.periodo_fim,expression:"analiseForm.periodo_fim"}],staticClass:"input-field",attrs:{type:"date",required:""},domProps:{value:a.analiseForm.periodo_fim},on:{input:function(t){t.target.composing||a.$set(a.analiseForm,"periodo_fim",t.target.value)}}})])])]),t("fieldset",{staticClass:"form-section"},[t("legend",[a._v("üîç Filtros de Dados")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Produtos Espec√≠ficos")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosProdutos,expression:"filtrosProdutos"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Digite nomes de produtos separados por v√≠rgula"},domProps:{value:a.filtrosProdutos},on:{input:function(t){t.target.composing||(a.filtrosProdutos=t.target.value)}}}),t("small",{staticClass:"form-help"},[a._v("Deixe vazio para incluir todos os produtos")])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Fornecedores Espec√≠ficos")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosFornecedores,expression:"filtrosFornecedores"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Digite nomes de fornecedores separados por v√≠rgula"},domProps:{value:a.filtrosFornecedores},on:{input:function(t){t.target.composing||(a.filtrosFornecedores=t.target.value)}}}),t("small",{staticClass:"form-help"},[a._v("Deixe vazio para incluir todos os fornecedores")])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Faixa de Pre√ßos")]),t("div",{staticClass:"price-range"},[t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.faixaPrecos.min,expression:"faixaPrecos.min",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",step:"0.01",placeholder:"Pre√ßo m√≠nimo"},domProps:{value:a.faixaPrecos.min},on:{input:function(t){t.target.composing||a.$set(a.faixaPrecos,"min",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}}),t("span",[a._v("at√©")]),t("input",{directives:[{name:"model",rawName:"v-model.number",value:a.faixaPrecos.max,expression:"faixaPrecos.max",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",step:"0.01",placeholder:"Pre√ßo m√°ximo"},domProps:{value:a.faixaPrecos.max},on:{input:function(t){t.target.composing||a.$set(a.faixaPrecos,"max",a._n(t.target.value))},blur:function(t){return a.$forceUpdate()}}})])])])])])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalAnalise}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoAnalise},on:{click:a.salvarAnalise}},[a._v(" "+a._s(a.salvandoAnalise?"Processando...":"Iniciar An√°lise")+" ")])])])]):a._e(),a.modalVisualizacao.show?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVisualizacao}},[t("div",{staticClass:"modal-content extra-large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìä "+a._s(a.modalVisualizacao.analise?.titulo))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalVisualizacao}},[a._v("‚úï")])]),t("div",{staticClass:"modal-body"},[a.modalVisualizacao.analise?t("div",{staticClass:"analise-detalhada"},[t("div",{staticClass:"resumo-executivo"},[t("h4",[a._v("üìà Resumo Executivo")]),t("div",{staticClass:"resumo-grid"},[t("div",{staticClass:"resumo-item"},[t("span",{staticClass:"label"},[a._v("Per√≠odo Analisado:")]),t("span",{staticClass:"value"},[a._v(a._s(a.formatPeriodo(a.modalVisualizacao.analise.periodo_inicio,a.modalVisualizacao.analise.periodo_fim)))])]),t("div",{staticClass:"resumo-item"},[t("span",{staticClass:"label"},[a._v("Tipo de An√°lise:")]),t("span",{staticClass:"value"},[a._v(a._s(a.getTipoLabel(a.modalVisualizacao.analise.tipo_analise)))])]),t("div",{staticClass:"resumo-item"},[t("span",{staticClass:"label"},[a._v("Granularidade:")]),t("span",{staticClass:"value"},[a._v(a._s(a.getGranularidadeLabel(a.modalVisualizacao.analise.granularidade)))])]),t("div",{staticClass:"resumo-item"},[t("span",{staticClass:"label"},[a._v("Status:")]),t("span",{staticClass:"value"},[a._v(a._s(a.getStatusLabel(a.modalVisualizacao.analise.status)))])])])]),"concluida"===a.modalVisualizacao.analise.status?t("div",{staticClass:"metricas-principais"},[t("h4",[a._v("üìä M√©tricas Principais")]),t("div",{staticClass:"metricas-grid"},[t("div",{staticClass:"metrica-detalhada"},[t("div",{staticClass:"metrica-icon"},[a._v("üí∞")]),t("div",{staticClass:"metrica-content"},[t("h5",[a._v(a._s(a.formatCurrency(a.modalVisualizacao.analise.preco_medio||0)))]),t("p",[a._v("Pre√ßo M√©dio")])])]),t("div",{staticClass:"metrica-detalhada"},[t("div",{staticClass:"metrica-icon"},[a._v("üìà")]),t("div",{staticClass:"metrica-content"},[t("h5",{class:a.getVariacaoClass(a.modalVisualizacao.analise.variacao_percentual)},[a._v(" "+a._s(a.formatPercentual(a.modalVisualizacao.analise.variacao_percentual||0))+" ")]),t("p",[a._v("Varia√ß√£o Total")])])]),t("div",{staticClass:"metrica-detalhada"},[t("div",{staticClass:"metrica-icon"},[a._v("üìä")]),t("div",{staticClass:"metrica-content"},[t("h5",[a._v(a._s(a.formatCurrency(a.modalVisualizacao.analise.desvio_padrao||0)))]),t("p",[a._v("Desvio Padr√£o")])])]),t("div",{staticClass:"metrica-detalhada"},[t("div",{staticClass:"metrica-icon"},[a._v("üéØ")]),t("div",{staticClass:"metrica-content"},[t("h5",[a._v(a._s(a.formatPercentual(a.modalVisualizacao.analise.coeficiente_variacao||0)))]),t("p",[a._v("Coef. Varia√ß√£o")])])])])]):a._e(),"concluida"===a.modalVisualizacao.analise.status?t("div",{staticClass:"graficos-section"},[t("h4",[a._v("üìà Visualiza√ß√µes")]),a._m(1)]):a._e()]):a._e()])])]):a._e()])},ga=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"header-info"},[t("h4",[a._v("üìà Gerenciamento de An√°lise de Pre√ßos")]),t("p",[a._v("Analise varia√ß√µes de pre√ßos ao longo do tempo, identifique tend√™ncias e tome decis√µes baseadas em dados estat√≠sticos.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"graficos-placeholder"},[t("div",{staticClass:"placeholder-box"},[t("div",{staticClass:"placeholder-icon"},[a._v("üìä")]),t("h5",[a._v("Gr√°ficos em desenvolvimento")]),t("p",[a._v("Em breve: gr√°ficos interativos de evolu√ß√£o de pre√ßos, histogramas e box plots")])])])}];const _a={name:"GerenciadorAnalisePrecos",data(){return{analises:[],loading:!1,salvandoAnalise:!1,filtros:{busca:"",status:"",tipo:"",dataInicio:"",dataFim:""},modalAnalise:{show:!1,editando:!1},modalVisualizacao:{show:!1,analise:null},analiseForm:{id:null,titulo:"",descricao:"",categoria:"",tipo_analise:"temporal",granularidade:"mensal",periodo_inicio:"",periodo_fim:""},filtrosProdutos:"",filtrosFornecedores:"",faixaPrecos:{min:null,max:null}}},computed:{analisesFiltradas(){let a=[...this.analises];if(this.filtros.busca){const t=this.filtros.busca.toLowerCase();a=a.filter((a=>a.titulo.toLowerCase().includes(t)||a.categoria&&a.categoria.toLowerCase().includes(t)||a.descricao&&a.descricao.toLowerCase().includes(t)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_analise===this.filtros.tipo))),this.filtros.dataInicio&&(a=a.filter((a=>a.periodo_inicio>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.periodo_fim<=this.filtros.dataFim))),a.sort(((a,t)=>new Date(t.created_at)-new Date(a.created_at)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.tipo||this.filtros.dataInicio||this.filtros.dataFim},analisesComTendencia(){return this.analises.filter((a=>"concluida"===a.status)).length},alertasAtivos(){return Math.floor(5*Math.random())},mediaVariacao(){const a=this.analises.filter((a=>"concluida"===a.status&&a.variacao_percentual));if(0===a.length)return 0;const t=a.reduce(((a,t)=>a+(t.variacao_percentual||0)),0);return(t/a.length).toFixed(1)}},async mounted(){await this.carregarAnalises(),this.definirDatasPadrao()},methods:{async carregarAnalises(){this.loading=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const{data:t,error:o}=await R.ND.from("analises_precos").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(o)throw o;this.analises=t||[]}catch(a){console.error("Erro ao carregar an√°lises:",a),this.$swal({title:"Erro",text:"Erro ao carregar an√°lises: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovaAnalise(){this.modalAnalise.show=!0,this.modalAnalise.editando=!1,this.resetarFormulario()},fecharModalAnalise(){this.modalAnalise.show=!1,this.resetarFormulario()},fecharModalVisualizacao(){this.modalVisualizacao.show=!1,this.modalVisualizacao.analise=null},resetarFormulario(){this.analiseForm={id:null,titulo:"",descricao:"",categoria:"",tipo_analise:"temporal",granularidade:"mensal",periodo_inicio:"",periodo_fim:""},this.filtrosProdutos="",this.filtrosFornecedores="",this.faixaPrecos={min:null,max:null}},definirDatasPadrao(){const a=new Date,t=new Date(a.getFullYear(),0,1);this.analiseForm.periodo_fim=a.toISOString().split("T")[0],this.analiseForm.periodo_inicio=t.toISOString().split("T")[0]},async salvarAnalise(){this.salvandoAnalise=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const t={};this.filtrosProdutos&&(t.produtos=this.filtrosProdutos.split(",").map((a=>a.trim()))),this.filtrosFornecedores&&(t.fornecedores=this.filtrosFornecedores.split(",").map((a=>a.trim()))),(this.faixaPrecos.min||this.faixaPrecos.max)&&(t.faixa_precos=this.faixaPrecos);const o={...this.analiseForm,tenant_id:a,filtros_aplicados:Object.keys(t).length>0?t:null,status:"processando",progresso:0};if(this.modalAnalise.editando){const{error:a}=await R.ND.from("analises_precos").update(o).eq("id",this.analiseForm.id);if(a)throw a}else{delete o.id;const{error:a}=await R.ND.from("analises_precos").insert([o]);if(a)throw a}this.$swal({title:"Sucesso!",text:`An√°lise ${this.modalAnalise.editando?"atualizada":"iniciada"} com sucesso`,icon:"success",timer:2e3}),await this.carregarAnalises(),this.fecharModalAnalise()}catch(a){console.error("Erro ao salvar an√°lise:",a),this.$swal({title:"Erro",text:"Erro ao salvar an√°lise: "+a.message,icon:"error"})}finally{this.salvandoAnalise=!1}},editarAnalise(a){this.analiseForm={...a},this.modalAnalise.show=!0,this.modalAnalise.editando=!0},async removerAnalise(a){const t=await this.$swal({title:"Confirmar exclus√£o",text:`Deseja realmente remover a an√°lise "${a.titulo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("analises_precos").delete().eq("id",a.id);if(t)throw t;this.$swal({title:"Removida!",text:"An√°lise removida com sucesso",icon:"success",timer:2e3}),await this.carregarAnalises()}catch(o){console.error("Erro ao remover an√°lise:",o),this.$swal({title:"Erro",text:"Erro ao remover an√°lise: "+o.message,icon:"error"})}},visualizarAnalise(a){this.modalVisualizacao.show=!0,this.modalVisualizacao.analise=a},duplicarAnalise(a){this.analiseForm={...a,id:null,titulo:a.titulo+" (C√≥pia)",status:"processando"},this.modalAnalise.show=!0,this.modalAnalise.editando=!1},async cancelarAnalise(a){const t=await this.$swal({title:"Cancelar An√°lise",text:`Deseja cancelar o processamento da an√°lise "${a.titulo}"?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, cancelar",cancelButtonText:"Continuar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("analises_precos").update({status:"erro",progresso:0}).eq("id",a.id);if(t)throw t;await this.carregarAnalises()}catch(o){console.error("Erro ao cancelar an√°lise:",o)}},verGraficos(a){this.$swal({title:"üìä Gr√°ficos da An√°lise",text:"Funcionalidade em desenvolvimento - Visualiza√ß√µes gr√°ficas interativas",icon:"info"})},verTendencias(a){this.$swal({title:"üìà An√°lise de Tend√™ncias",text:"Funcionalidade em desenvolvimento - Detec√ß√£o autom√°tica de tend√™ncias",icon:"info"})},limparFiltros(){this.filtros={busca:"",status:"",tipo:"",dataInicio:"",dataFim:""}},async gerarRelatorioConsolidado(){try{if(0===this.analisesFiltradas.length)return void this.$swal({title:"Aten√ß√£o",text:"N√£o h√° an√°lises para incluir no relat√≥rio com os filtros aplicados.",icon:"warning"});const a=await this.$swal({title:"üìä Gerar Relat√≥rio Consolidado",html:`\n            <div style="text-align: left; margin: 20px 0;">\n              <p><strong>An√°lises a serem inclu√≠das:</strong> ${this.analisesFiltradas.length}</p>\n              <p><strong>An√°lises conclu√≠das:</strong> ${this.analisesFiltradas.filter((a=>"concluida"===a.status)).length}</p>\n              <br>\n              <p>O relat√≥rio ser√° aberto em uma nova janela e poder√° ser impresso ou salvo como PDF.</p>\n            </div>\n          `,icon:"question",showCancelButton:!0,confirmButtonText:"üìä Gerar Relat√≥rio",cancelButtonText:"Cancelar"});if(!a.isConfirmed)return;const{gerarRelatorioAnalisePrecos:t}=await o.e(236).then(o.bind(o,5236));await t(this.analisesFiltradas,"Relat√≥rio Consolidado de An√°lise de Pre√ßos"),this.$swal({title:"Sucesso!",text:"Relat√≥rio consolidado gerado com sucesso!",icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao gerar relat√≥rio:",a),this.$swal({title:"Erro",text:"Erro ao gerar relat√≥rio: "+a.message,icon:"error"})}},async exportarDados(){try{if(0===this.analisesFiltradas.length)return void this.$swal({title:"Aten√ß√£o",text:"N√£o h√° dados para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"üì§ Exportar Dados de An√°lise",text:`Exportar dados de ${this.analisesFiltradas.length} an√°lise(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"üìä Excel (.xlsx)",cancelButtonText:"üìÑ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportAnalises:t}=await o.e(913).then(o.bind(o,1913)),e=a?"excel":"csv";await t(this.analisesFiltradas,e),this.$swal({title:"Sucesso!",text:`Dados de ${this.analisesFiltradas.length} an√°lise(s) exportados com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar dados:",a),this.$swal({title:"Erro",text:"Erro ao exportar dados: "+a.message,icon:"error"})}},temTendencias(a){return Math.random()>.5},temAlertas(a){return Math.random()>.7},truncateText(a,t){return a?a.length>t?a.substring(0,t)+"...":a:""},getVariacaoClass(a){return a?a>5?"positiva":a<-5?"negativa":"neutra":""},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatPeriodo(a,t){return`${this.formatDate(a)} - ${this.formatDate(t)}`},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},formatPercentual(a){return a?(a>0?"+":"")+a.toFixed(1)+"%":"0%"},getStatusLabel(a){const t={processando:"Processando",concluida:"Conclu√≠da",erro:"Erro"};return t[a]||a},getTipoLabel(a){const t={temporal:"Temporal",comparativa:"Comparativa",estatistica:"Estat√≠stica",tendencia:"Tend√™ncia"};return t[a]||a},getGranularidadeLabel(a){const t={diaria:"Di√°ria",semanal:"Semanal",mensal:"Mensal",trimestral:"Trimestral",anual:"Anual"};return t[a]||a}}},fa=_a;var ha=(0,C.A)(fa,va,ga,!1,null,"0372ce16",null);const Ca=ha.exports;var ba=function(){var a=this,t=a._self._c;return t("div",{staticClass:"gerenciador-relatorios"},[t("div",{staticClass:"header-section"},[t("div",{staticClass:"title-and-stats"},[t("h2",[a._v("üìã Gerenciador de Relat√≥rios")]),t("div",{staticClass:"stats-mini"},[t("span",{staticClass:"stat-item"},[t("strong",[a._v(a._s(a.totalRelatorios))]),a._v(" Relat√≥rios ")]),t("span",{staticClass:"stat-item pendentes"},[t("strong",[a._v(a._s(a.relatoriosPendentes))]),a._v(" Pendentes ")]),t("span",{staticClass:"stat-item concluidos"},[t("strong",[a._v(a._s(a.relatoriosConcluidos))]),a._v(" Conclu√≠dos ")])])]),t("div",{staticClass:"actions-header"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoRelatorio}},[a._v(" + Novo Relat√≥rio ")]),t("button",{staticClass:"btn-secondary",on:{click:a.carregarRelatorios}},[a._v(" üîÑ Atualizar ")])])]),t("div",{staticClass:"filtros-section"},[t("div",{staticClass:"filtros-linha"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìù T√≠tulo:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.titulo,expression:"filtros.titulo"}],attrs:{type:"text",placeholder:"Filtrar por t√≠tulo..."},domProps:{value:a.filtros.titulo},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"titulo",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìä Categoria:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.categoria,expression:"filtros.categoria"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"categoria",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"pesquisa_mercado"}},[a._v("Pesquisa de Mercado")]),t("option",{attrs:{value:"cotacoes"}},[a._v("Cota√ß√µes")]),t("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),t("option",{attrs:{value:"analise_precos"}},[a._v("An√°lise de Pre√ßos")]),t("option",{attrs:{value:"executivo"}},[a._v("Executivo")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìà Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"pendente"}},[a._v("Pendente")]),t("option",{attrs:{value:"gerando"}},[a._v("Gerando")]),t("option",{attrs:{value:"concluido"}},[a._v("Conclu√≠do")]),t("option",{attrs:{value:"erro"}},[a._v("Com Erro")]),t("option",{attrs:{value:"cancelado"}},[a._v("Cancelado")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìã Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo_relatorio,expression:"filtros.tipo_relatorio"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"tipo_relatorio",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"consolidado"}},[a._v("Consolidado")]),t("option",{attrs:{value:"analise_tecnica"}},[a._v("An√°lise T√©cnica")]),t("option",{attrs:{value:"comparativo_precos"}},[a._v("Comparativo de Pre√ßos")]),t("option",{attrs:{value:"executivo"}},[a._v("Executivo")]),t("option",{attrs:{value:"custom"}},[a._v("Personalizado")])])])])]),t("div",{staticClass:"relatorios-lista"},[a.loading?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando relat√≥rios...")])]):0===a.relatoriosFiltrados.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìä")]),t("h3",[a._v("Nenhum relat√≥rio encontrado")]),t("p",[a._v("N√£o h√° relat√≥rios que correspondam aos filtros aplicados.")]),t("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v("Limpar Filtros")])]):t("div",{staticClass:"relatorios-grid"},a._l(a.relatoriosPaginados,(function(o){return t("div",{key:o.id,staticClass:"relatorio-card",class:"status-"+o.status},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"titulo-e-categoria"},[t("h4",[a._v(a._s(o.titulo))]),t("span",{staticClass:"categoria-badge",class:"categoria-"+o.categoria},[a._v(" "+a._s(a.getCategoriaLabel(o.categoria))+" ")])]),t("div",{staticClass:"status-badge",class:"status-"+o.status},[a._v(" "+a._s(a.getStatusLabel(o.status))+" ")])]),t("div",{staticClass:"card-content"},[t("div",{staticClass:"info-linha"},[t("strong",[a._v("Tipo:")]),a._v(" "+a._s(a.getTipoLabel(o.tipo_relatorio))+" ")]),o.descricao?t("div",{staticClass:"descricao"},[a._v(" "+a._s(o.descricao)+" ")]):a._e(),"gerando"===o.status?t("div",{staticClass:"progress-section"},[t("div",{staticClass:"progress-bar"},[t("div",{staticClass:"progress-fill",style:{width:o.progresso+"%"}})]),t("span",{staticClass:"progress-text"},[a._v(a._s(o.progresso)+"%")])]):a._e(),t("div",{staticClass:"metadados"},[t("span",[t("strong",[a._v("Criado:")]),a._v(" "+a._s(a.formatarData(o.created_at)))]),o.gerado_em?t("span",[t("strong",[a._v("Gerado:")]),a._v(" "+a._s(a.formatarData(o.gerado_em))+" ")]):a._e(),o.visualizacoes>0?t("span",[t("strong",[a._v("Visualiza√ß√µes:")]),a._v(" "+a._s(o.visualizacoes)+" ")]):a._e()])]),t("div",{staticClass:"card-actions"},["concluido"===o.status&&o.url_arquivo_principal?t("button",{staticClass:"btn-action download",attrs:{title:"Baixar Relat√≥rio"},on:{click:function(t){return a.baixarRelatorio(o)}}},[a._v(" üì• Baixar ")]):a._e(),"concluido"===o.status?t("button",{staticClass:"btn-action view",attrs:{title:"Visualizar"},on:{click:function(t){return a.visualizarRelatorio(o)}}},[a._v(" üëÅÔ∏è Ver ")]):a._e(),t("button",{staticClass:"btn-action edit",attrs:{title:"Editar",disabled:"gerando"===o.status},on:{click:function(t){return a.editarRelatorio(o)}}},[a._v(" ‚úèÔ∏è Editar ")]),"pendente"===o.status||"erro"===o.status?t("button",{staticClass:"btn-action generate",attrs:{title:"Gerar Relat√≥rio"},on:{click:function(t){return a.gerarRelatorio(o)}}},[a._v(" ‚ö° Gerar ")]):a._e(),t("button",{staticClass:"btn-action delete",attrs:{title:"Excluir",disabled:"gerando"===o.status},on:{click:function(t){return a.excluirRelatorio(o)}}},[a._v(" üóëÔ∏è Excluir ")])])])})),0)]),a.totalPaginas>1?t("div",{staticClass:"paginacao"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual<=1},on:{click:function(t){a.paginaAtual--}}},[a._v(" ‚Äπ Anterior ")]),t("span",{staticClass:"pagina-info"},[a._v(" P√°gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual>=a.totalPaginas},on:{click:function(t){a.paginaAtual++}}},[a._v(" Pr√≥xima ‚Ä∫ ")])]):a._e(),a.showModal?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModal}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.relatorioEditando.id?"Editar Relat√≥rio":"Novo Relat√≥rio"))]),t("button",{staticClass:"modal-close",on:{click:a.fecharModal}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarRelatorio.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üìù T√≠tulo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.titulo,expression:"relatorioEditando.titulo"}],attrs:{type:"text",required:"",placeholder:"Digite o t√≠tulo do relat√≥rio"},domProps:{value:a.relatorioEditando.titulo},on:{input:function(t){t.target.composing||a.$set(a.relatorioEditando,"titulo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìä Categoria*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.categoria,expression:"relatorioEditando.categoria"}],attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.relatorioEditando,"categoria",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),t("option",{attrs:{value:"pesquisa_mercado"}},[a._v("Pesquisa de Mercado")]),t("option",{attrs:{value:"cotacoes"}},[a._v("Cota√ß√µes")]),t("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),t("option",{attrs:{value:"analise_precos"}},[a._v("An√°lise de Pre√ßos")]),t("option",{attrs:{value:"executivo"}},[a._v("Executivo")])])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üìã Tipo de Relat√≥rio*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.tipo_relatorio,expression:"relatorioEditando.tipo_relatorio"}],attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.relatorioEditando,"tipo_relatorio",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),t("option",{attrs:{value:"consolidado"}},[a._v("Consolidado")]),t("option",{attrs:{value:"analise_tecnica"}},[a._v("An√°lise T√©cnica")]),t("option",{attrs:{value:"comparativo_precos"}},[a._v("Comparativo de Pre√ßos")]),t("option",{attrs:{value:"executivo"}},[a._v("Executivo")]),t("option",{attrs:{value:"custom"}},[a._v("Personalizado")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìÑ Formato de Sa√≠da")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.formato_saida,expression:"relatorioEditando.formato_saida"}],on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.relatorioEditando,"formato_saida",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"pdf"}},[a._v("PDF")]),t("option",{attrs:{value:"xlsx"}},[a._v("Excel (XLSX)")]),t("option",{attrs:{value:"docx"}},[a._v("Word (DOCX)")]),t("option",{attrs:{value:"csv"}},[a._v("CSV")]),t("option",{attrs:{value:"html"}},[a._v("HTML")])])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìù Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.descricao,expression:"relatorioEditando.descricao"}],attrs:{rows:"3",placeholder:"Descreva o objetivo e conte√∫do do relat√≥rio"},domProps:{value:a.relatorioEditando.descricao},on:{input:function(t){t.target.composing||a.$set(a.relatorioEditando,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üìÖ Per√≠odo - In√≠cio")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.periodo_dados_inicio,expression:"relatorioEditando.periodo_dados_inicio"}],attrs:{type:"date"},domProps:{value:a.relatorioEditando.periodo_dados_inicio},on:{input:function(t){t.target.composing||a.$set(a.relatorioEditando,"periodo_dados_inicio",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìÖ Per√≠odo - Fim")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.periodo_dados_fim,expression:"relatorioEditando.periodo_dados_fim"}],attrs:{type:"date"},domProps:{value:a.relatorioEditando.periodo_dados_fim},on:{input:function(t){t.target.composing||a.$set(a.relatorioEditando,"periodo_dados_fim",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",[a._v("üéØ Fonte Principal dos Dados")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.fonte_principal,expression:"relatorioEditando.fonte_principal"}],on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.relatorioEditando,"fonte_principal",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),t("option",{attrs:{value:"cotacoes"}},[a._v("Cota√ß√µes")]),t("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),t("option",{attrs:{value:"analises"}},[a._v("An√°lises de Pre√ßos")]),t("option",{attrs:{value:"manual"}},[a._v("Entrada Manual")]),t("option",{attrs:{value:"multiplas"}},[a._v("M√∫ltiplas Fontes")])])]),t("div",{staticClass:"configuracoes-section"},[t("h4",[a._v("‚öôÔ∏è Configura√ß√µes de Gera√ß√£o")]),t("div",{staticClass:"checkbox-group"},[t("label",{staticClass:"checkbox-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_graficos,expression:"relatorioEditando.incluir_graficos"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_graficos)?a._i(a.relatorioEditando.incluir_graficos,null)>-1:a.relatorioEditando.incluir_graficos},on:{change:function(t){var o=a.relatorioEditando.incluir_graficos,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_graficos",o.concat([s])):r>-1&&a.$set(a.relatorioEditando,"incluir_graficos",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_graficos",i)}}}),t("span",[a._v("üìä Incluir Gr√°ficos")])]),t("label",{staticClass:"checkbox-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_tabelas,expression:"relatorioEditando.incluir_tabelas"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_tabelas)?a._i(a.relatorioEditando.incluir_tabelas,null)>-1:a.relatorioEditando.incluir_tabelas},on:{change:function(t){var o=a.relatorioEditando.incluir_tabelas,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_tabelas",o.concat([s])):r>-1&&a.$set(a.relatorioEditando,"incluir_tabelas",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_tabelas",i)}}}),t("span",[a._v("üìã Incluir Tabelas")])]),t("label",{staticClass:"checkbox-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_anexos,expression:"relatorioEditando.incluir_anexos"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_anexos)?a._i(a.relatorioEditando.incluir_anexos,null)>-1:a.relatorioEditando.incluir_anexos},on:{change:function(t){var o=a.relatorioEditando.incluir_anexos,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_anexos",o.concat([s])):r>-1&&a.$set(a.relatorioEditando,"incluir_anexos",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_anexos",i)}}}),t("span",[a._v("üìé Incluir Anexos")])]),t("label",{staticClass:"checkbox-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_assinaturas,expression:"relatorioEditando.incluir_assinaturas"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_assinaturas)?a._i(a.relatorioEditando.incluir_assinaturas,null)>-1:a.relatorioEditando.incluir_assinaturas},on:{change:function(t){var o=a.relatorioEditando.incluir_assinaturas,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_assinaturas",o.concat([s])):r>-1&&a.$set(a.relatorioEditando,"incluir_assinaturas",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_assinaturas",i)}}}),t("span",[a._v("‚úçÔ∏è Incluir Assinaturas")])])])]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModal}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar Relat√≥rio")+" ")])])])])])]):a._e()])},wa=[];const Da={name:"GerenciadorRelatorios",data(){return{relatorios:[],loading:!1,salvando:!1,showModal:!1,filtros:{titulo:"",categoria:"",status:"",tipo_relatorio:""},paginaAtual:1,itensPorPagina:12,relatorioEditando:this.getRelatorioVazio(),erro:null}},computed:{totalRelatorios(){return this.relatorios.length},relatoriosPendentes(){return this.relatorios.filter((a=>["pendente","gerando"].includes(a.status))).length},relatoriosConcluidos(){return this.relatorios.filter((a=>"concluido"===a.status)).length},relatoriosFiltrados(){let a=this.relatorios;return this.filtros.titulo&&(a=a.filter((a=>a.titulo.toLowerCase().includes(this.filtros.titulo.toLowerCase())))),this.filtros.categoria&&(a=a.filter((a=>a.categoria===this.filtros.categoria))),this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo_relatorio&&(a=a.filter((a=>a.tipo_relatorio===this.filtros.tipo_relatorio))),a.sort(((a,t)=>new Date(t.created_at)-new Date(a.created_at)))},totalPaginas(){return Math.ceil(this.relatoriosFiltrados.length/this.itensPorPagina)},relatoriosPaginados(){const a=(this.paginaAtual-1)*this.itensPorPagina,t=a+this.itensPorPagina;return this.relatoriosFiltrados.slice(a,t)}},async mounted(){await this.carregarRelatorios()},methods:{async carregarRelatorios(){this.loading=!0,this.erro=null;try{const a=(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const{data:t,error:o}=await R.ND.from("relatorios").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(o)throw o;this.relatorios=t||[]}catch(a){console.error("Erro ao carregar relat√≥rios:",a),this.erro="Erro ao carregar relat√≥rios: "+a.message}finally{this.loading=!1}},aplicarFiltros(){this.paginaAtual=1},limparFiltros(){this.filtros={titulo:"",categoria:"",status:"",tipo_relatorio:""},this.paginaAtual=1},abrirModalNovoRelatorio(){this.relatorioEditando=this.getRelatorioVazio(),this.showModal=!0},editarRelatorio(a){this.relatorioEditando={...a},this.showModal=!0},fecharModal(){this.showModal=!1,this.relatorioEditando=this.getRelatorioVazio()},async salvarRelatorio(){this.salvando=!0;try{const a=(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const t={...this.relatorioEditando,tenant_id:a,updated_at:(new Date).toISOString()};if(this.relatorioEditando.id){const{error:a}=await R.ND.from("relatorios").update(t).eq("id",this.relatorioEditando.id);if(a)throw a}else{t.created_at=(new Date).toISOString();const{error:a}=await R.ND.from("relatorios").insert([t]);if(a)throw a}await this.carregarRelatorios(),this.fecharModal()}catch(a){console.error("Erro ao salvar relat√≥rio:",a),alert("Erro ao salvar relat√≥rio: "+a.message)}finally{this.salvando=!1}},async excluirRelatorio(a){if(confirm(`Tem certeza que deseja excluir o relat√≥rio "${a.titulo}"?`))try{const{error:t}=await R.ND.from("relatorios").delete().eq("id",a.id);if(t)throw t;await this.carregarRelatorios()}catch(t){console.error("Erro ao excluir relat√≥rio:",t),alert("Erro ao excluir relat√≥rio: "+t.message)}},async gerarRelatorio(a){try{const{error:t}=await R.ND.from("relatorios").update({status:"gerando",progresso:0,updated_at:(new Date).toISOString()}).eq("id",a.id);if(t)throw t;this.simularGeracaoRelatorio(a.id),await this.carregarRelatorios()}catch(t){console.error("Erro ao iniciar gera√ß√£o:",t),alert("Erro ao iniciar gera√ß√£o: "+t.message)}},async simularGeracaoRelatorio(a){for(let t=10;t<=100;t+=10)await new Promise((a=>setTimeout(a,500))),await R.ND.from("relatorios").update({progresso:t,...100===t&&{status:"concluido",gerado_em:(new Date).toISOString(),url_arquivo_principal:`#relatorio-${a}.pdf`}}).eq("id",a),t%20===0&&await this.carregarRelatorios()},baixarRelatorio(a){alert(`Download do relat√≥rio "${a.titulo}" iniciado!`)},visualizarRelatorio(a){alert(`Visualizando relat√≥rio "${a.titulo}"`)},getRelatorioVazio(){return{titulo:"",descricao:"",categoria:"",tipo_relatorio:"",subtipo:"detalhado",formato_saida:"pdf",fonte_principal:"",periodo_dados_inicio:"",periodo_dados_fim:"",incluir_graficos:!0,incluir_tabelas:!0,incluir_anexos:!1,incluir_assinaturas:!0,status:"pendente",progresso:0}},getCategoriaLabel(a){const t={pesquisa_mercado:"Pesquisa de Mercado",cotacoes:"Cota√ß√µes",comparativos:"Comparativos",analise_precos:"An√°lise de Pre√ßos",executivo:"Executivo"};return t[a]||a},getStatusLabel(a){const t={pendente:"Pendente",gerando:"Gerando",concluido:"Conclu√≠do",erro:"Erro",cancelado:"Cancelado"};return t[a]||a},getTipoLabel(a){const t={consolidado:"Consolidado",analise_tecnica:"An√°lise T√©cnica",comparativo_precos:"Comparativo de Pre√ßos",executivo:"Executivo",custom:"Personalizado"};return t[a]||a},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):""}}},Ea=Da;var xa=(0,C.A)(Ea,ba,wa,!1,null,"27009c66",null);const ya=xa.exports;var Aa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"gerenciador-marcas-despadronizadas"},[t("div",{staticClass:"header-section"},[t("div",{staticClass:"title-and-stats"},[t("h2",[a._v("üö´ Gerenciador de Marcas Despadronizadas")]),t("div",{staticClass:"stats-mini"},[t("span",{staticClass:"stat-item"},[t("strong",[a._v(a._s(a.totalMarcas))]),a._v(" Total ")]),t("span",{staticClass:"stat-item ativas"},[t("strong",[a._v(a._s(a.marcasAtivas))]),a._v(" Ativas ")]),t("span",{staticClass:"stat-item revisao"},[t("strong",[a._v(a._s(a.marcasPendenteRevisao))]),a._v(" Pendente Revis√£o ")]),t("span",{staticClass:"stat-item criticas"},[t("strong",[a._v(a._s(a.marcasCriticas))]),a._v(" Cr√≠ticas ")])])]),t("div",{staticClass:"actions-header"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaMarca}},[a._v(" + Nova Despadroniza√ß√£o ")]),t("button",{staticClass:"btn-secondary",on:{click:a.carregarMarcas}},[a._v(" üîÑ Atualizar ")]),t("button",{staticClass:"btn-secondary",on:{click:a.exportarMarcas}},[a._v(" üì§ Exportar ")])])]),t("div",{staticClass:"filtros-section"},[t("div",{staticClass:"filtros-linha"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("üè∑Ô∏è Marca:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.marca,expression:"filtros.marca"}],attrs:{type:"text",placeholder:"Filtrar por marca..."},domProps:{value:a.filtros.marca},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"marca",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üìã Categoria:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.categoria,expression:"filtros.categoria"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"categoria",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"Impressoras"}},[a._v("Impressoras")]),t("option",{attrs:{value:"Computadores"}},[a._v("Computadores")]),t("option",{attrs:{value:"Tablets"}},[a._v("Tablets")]),t("option",{attrs:{value:"Telefones"}},[a._v("Telefones")]),t("option",{attrs:{value:"Mobili√°rio"}},[a._v("Mobili√°rio")]),t("option",{attrs:{value:"Ve√≠culos"}},[a._v("Ve√≠culos")]),t("option",{attrs:{value:"Outros"}},[a._v("Outros")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üéØ Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"ativa"}},[a._v("Ativa")]),t("option",{attrs:{value:"revogada"}},[a._v("DCB Cancelada")]),t("option",{attrs:{value:"expirada"}},[a._v("Expirada")]),t("option",{attrs:{value:"suspensa"}},[a._v("Suspensa")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("üîß Tipo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"tipo",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"total"}},[a._v("Total")]),t("option",{attrs:{value:"parcial"}},[a._v("Parcial")]),t("option",{attrs:{value:"temporaria"}},[a._v("Tempor√°ria")]),t("option",{attrs:{value:"definitiva"}},[a._v("Definitiva")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("‚ö†Ô∏è Criticidade:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.criticidade,expression:"filtros.criticidade"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"criticidade",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"baixo"}},[a._v("Baixa")]),t("option",{attrs:{value:"medio"}},[a._v("M√©dia")]),t("option",{attrs:{value:"alto"}},[a._v("Alta")])])])])]),a.marcasComRevisaoVencida.length>0?t("div",{staticClass:"alertas-section"},[t("div",{staticClass:"alerta-card alerta-warning"},[t("h4",[a._v("‚ö†Ô∏è Revis√µes Pendentes")]),t("p",[a._v(a._s(a.marcasComRevisaoVencida.length)+" marca(s) com revis√£o vencida.")]),t("button",{staticClass:"btn-warning btn-small",on:{click:a.mostrarRevisoesVencidas}},[a._v(" Ver Detalhes ")])])]):a._e(),t("div",{staticClass:"marcas-lista"},[a.loading?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando marcas despadronizadas...")])]):0===a.marcasFiltradas.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üö´")]),t("h3",[a._v("Nenhuma marca encontrada")]),t("p",[a._v("N√£o h√° marcas despadronizadas que correspondam aos filtros aplicados.")]),t("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v("Limpar Filtros")])]):t("div",{staticClass:"marcas-grid"},a._l(a.marcasPaginadas,(function(o){return t("div",{key:o.id,staticClass:"marca-card",class:["status-"+o.status_atual,"criticidade-"+o.nivel_criticidade]},[t("div",{staticClass:"card-header"},[t("div",{staticClass:"marca-info"},[t("h4",[a._v(a._s(o.marca)+" "+a._s(o.modelo))]),t("span",{staticClass:"categoria-badge"},[a._v(a._s(o.categoria))])]),t("div",{staticClass:"status-badges"},[t("span",{staticClass:"status-badge",class:"status-"+o.status_atual},[a._v(" "+a._s(a.getStatusLabel(o.status_atual))+" ")]),t("span",{staticClass:"tipo-badge",class:"tipo-"+o.tipo_despadronizacao},[a._v(" "+a._s(a.getTipoLabel(o.tipo_despadronizacao))+" ")])])]),t("div",{staticClass:"card-content"},[t("div",{staticClass:"info-row"},[t("strong",[a._v("Processo:")]),a._v(" "+a._s(o.numero_processo)+" ")]),t("div",{staticClass:"info-row"},[t("strong",[a._v("Motivo:")]),a._v(" "+a._s(a.getMotivoLabel(o.motivo_principal))+" ")]),t("div",{staticClass:"info-row"},[t("strong",[a._v("Despadronizada em:")]),a._v(" "+a._s(a.formatarData(o.data_despadronizacao))+" ")]),o.data_fim_vigencia?t("div",{staticClass:"info-row"},[t("strong",[a._v("Vig√™ncia at√©:")]),a._v(" "+a._s(a.formatarData(o.data_fim_vigencia))+" ")]):a._e(),t("div",{staticClass:"info-row criticidade"},[t("strong",[a._v("Criticidade:")]),t("span",{class:"nivel-"+o.nivel_criticidade},[a._v(" "+a._s(a.getCriticidadeLabel(o.nivel_criticidade))+" ")])]),o.proxima_revisao?t("div",{staticClass:"info-row revisao"},[t("strong",[a._v("Pr√≥xima Revis√£o:")]),t("span",{class:{vencida:a.isRevisaoVencida(o.proxima_revisao)}},[a._v(" "+a._s(a.formatarData(o.proxima_revisao))+" "),a.isRevisaoVencida(o.proxima_revisao)?t("span",{staticClass:"vencida-label"},[a._v(" ("+a._s(a.diasAtraso(o.proxima_revisao))+" dias atraso) ")]):a._e()])]):a._e()]),t("div",{staticClass:"card-actions"},[t("button",{staticClass:"btn-action view",attrs:{title:"Visualizar Detalhes"},on:{click:function(t){return a.visualizarMarca(o)}}},[a._v(" üëÅÔ∏è Ver ")]),t("button",{staticClass:"btn-action edit",attrs:{title:"Editar"},on:{click:function(t){return a.editarMarca(o)}}},[a._v(" ‚úèÔ∏è Editar ")]),"ativa"===o.status_atual?t("button",{staticClass:"btn-action review",attrs:{title:"Programar Revis√£o"},on:{click:function(t){return a.programarRevisao(o)}}},[a._v(" üìÖ Revis√£o ")]):a._e(),t("button",{staticClass:"btn-action notify",attrs:{title:"Notifica√ß√µes"},on:{click:function(t){return a.gerenciarNotificacoes(o)}}},[a._v(" üìß Notificar ")]),t("button",{staticClass:"btn-action history",attrs:{title:"Ver Hist√≥rico"},on:{click:function(t){return a.verHistorico(o)}}},[a._v(" üìã Hist√≥rico ")]),"ativa"===o.status_atual?t("button",{staticClass:"btn-action revoke",attrs:{title:"DCB Cancelada"},on:{click:function(t){return a.revogarMarca(o)}}},[a._v(" ‚ùå DCB Cancelada ")]):a._e()])])})),0)]),a.totalPaginas>1?t("div",{staticClass:"paginacao"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual<=1},on:{click:function(t){a.paginaAtual--}}},[a._v(" ‚Äπ Anterior ")]),t("span",{staticClass:"pagina-info"},[a._v(" P√°gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual>=a.totalPaginas},on:{click:function(t){a.paginaAtual++}}},[a._v(" Pr√≥xima ‚Ä∫ ")])]):a._e(),a.showModal?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModal}},[t("div",{staticClass:"modal-content modal-large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.marcaEditando.id?"Editar Despadroniza√ß√£o":"Nova Despadroniza√ß√£o"))]),t("button",{staticClass:"modal-close",on:{click:a.fecharModal}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarMarca.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("üîç Produto do Cat√°logo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.produto_id,expression:"marcaEditando.produto_id"}],staticClass:"produto-select",attrs:{required:""},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.marcaEditando,"produto_id",t.target.multiple?o:o[0])},a.preencherDadosProduto]}},[t("option",{attrs:{value:""}},[a._v("Selecione o produto a ser despadronizado...")]),a._l(a.produtosAtivos,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" - "+a._s(o.marca||"S/Marca")+" "+a._s(o.modelo||"")+" ")])}))],2),t("small",[a._v(a._s(a.produtosAtivos.length)+" produto(s) aprovado(s) dispon√≠vel(is) para despadroniza√ß√£o")])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üè∑Ô∏è Marca")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.marca,expression:"marcaEditando.marca"}],attrs:{type:"text",readonly:"",placeholder:"Ser√° preenchido automaticamente"},domProps:{value:a.marcaEditando.marca},on:{input:function(t){t.target.composing||a.$set(a.marcaEditando,"marca",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("üì± Modelo")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.modelo,expression:"marcaEditando.modelo"}],attrs:{type:"text",readonly:"",placeholder:"Ser√° preenchido automaticamente"},domProps:{value:a.marcaEditando.modelo},on:{input:function(t){t.target.composing||a.$set(a.marcaEditando,"modelo",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üìÑ N√∫mero do Processo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.numero_processo,expression:"marcaEditando.numero_processo"}],attrs:{type:"text",required:"",placeholder:"Ex: PROC-2024-001"},domProps:{value:a.marcaEditando.numero_processo},on:{input:function(t){t.target.composing||a.$set(a.marcaEditando,"numero_processo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìÖ Data de Despadroniza√ß√£o*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.data_despadronizacao,expression:"marcaEditando.data_despadronizacao"}],attrs:{type:"date",required:""},domProps:{value:a.marcaEditando.data_despadronizacao},on:{input:function(t){t.target.composing||a.$set(a.marcaEditando,"data_despadronizacao",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("üéØ Motivo Principal*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.motivo_principal,expression:"marcaEditando.motivo_principal"}],attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.marcaEditando,"motivo_principal",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),t("option",{attrs:{value:"qualidade"}},[a._v("Problemas de Qualidade")]),t("option",{attrs:{value:"custo"}},[a._v("Custo Elevado")]),t("option",{attrs:{value:"descontinuacao"}},[a._v("Descontinua√ß√£o")]),t("option",{attrs:{value:"seguranca"}},[a._v("Problemas de Seguran√ßa")]),t("option",{attrs:{value:"fornecimento"}},[a._v("Problemas de Fornecimento")]),t("option",{attrs:{value:"tecnico"}},[a._v("Obsolesc√™ncia T√©cnica")]),t("option",{attrs:{value:"outros"}},[a._v("Outros")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("üîß Tipo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.tipo_despadronizacao,expression:"marcaEditando.tipo_despadronizacao"}],attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.marcaEditando,"tipo_despadronizacao",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),t("option",{attrs:{value:"total"}},[a._v("Total")]),t("option",{attrs:{value:"temporaria"}},[a._v("Tempor√°ria")]),t("option",{attrs:{value:"definitiva"}},[a._v("Definitiva")])])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("üìù Justificativa*")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.justificativa,expression:"marcaEditando.justificativa"}],attrs:{rows:"4",required:"",placeholder:"Descreva os motivos que levaram √† despadroniza√ß√£o..."},domProps:{value:a.marcaEditando.justificativa},on:{input:function(t){t.target.composing||a.$set(a.marcaEditando,"justificativa",t.target.value)}}})]),t("div",{staticClass:"modal-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModal}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar Despadroniza√ß√£o")+" ")])])])])])]):a._e()])},Pa=[];const Sa={name:"GerenciadorMarcasDespadronizadas",data(){return{marcas:[],produtos:[],loading:!1,salvando:!1,showModal:!1,activeModalTab:"basicos",filtros:{marca:"",categoria:"",status:"",tipo:"",criticidade:""},paginaAtual:1,itensPorPagina:12,marcaEditando:this.getMarcaVazia(),erro:null}},computed:{totalMarcas(){return this.marcas.length},marcasAtivas(){return this.marcas.filter((a=>"ativa"===a.status_atual)).length},marcasPendenteRevisao(){return this.marcas.filter((a=>a.proxima_revisao&&new Date(a.proxima_revisao)<=new Date)).length},marcasCriticas(){return this.marcas.filter((a=>"critico"===a.nivel_criticidade)).length},marcasComRevisaoVencida(){return this.marcas.filter((a=>a.proxima_revisao&&new Date(a.proxima_revisao)<new Date&&"ativa"===a.status_atual))},marcasFiltradas(){let a=this.marcas;return this.filtros.marca&&(a=a.filter((a=>a.marca.toLowerCase().includes(this.filtros.marca.toLowerCase())||a.modelo&&a.modelo.toLowerCase().includes(this.filtros.marca.toLowerCase())))),this.filtros.categoria&&(a=a.filter((a=>a.categoria===this.filtros.categoria))),this.filtros.status&&(a=a.filter((a=>a.status_atual===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_despadronizacao===this.filtros.tipo))),this.filtros.criticidade&&(a=a.filter((a=>a.nivel_criticidade===this.filtros.criticidade))),a.sort(((a,t)=>new Date(t.created_at)-new Date(a.created_at)))},totalPaginas(){return Math.ceil(this.marcasFiltradas.length/this.itensPorPagina)},marcasPaginadas(){const a=(this.paginaAtual-1)*this.itensPorPagina,t=a+this.itensPorPagina;return this.marcasFiltradas.slice(a,t)},produtosAtivos(){const a=this.marcas.filter((a=>"ativa"===a.status_atual&&a.produto_id)).map((a=>a.produto_id));return this.produtos.filter((t=>!a.includes(t.id)))}},async mounted(){await this.carregarMarcas(),await this.carregarProdutos()},methods:{async carregarMarcas(){this.loading=!0,this.erro=null;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const{data:t,error:o}=await R.ND.from("marcas_despadronizadas").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(o)throw o;this.marcas=t||[],console.log("Marcas carregadas:",this.marcas.length)}catch(a){console.error("Erro ao carregar marcas:",a),this.erro="Erro ao carregar marcas: "+a.message}finally{this.loading=!1}},async carregarProdutos(){try{const a=await(0,R.EO)();if(console.log("üîë Carregando produtos para tenant:",a),!a)return;const{data:t,error:o}=await R.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status").eq("tenant_id",a).in("status",["aprovado","julgado_aprovado","homologado"]).order("nome",{ascending:!0});if(o)throw console.error("‚ùå Erro na query Supabase:",o),o;this.produtos=t||[],console.log("‚úÖ Produtos carregados no marcas-despadronizadas:",this.produtos.length),console.log("üìã Primeiros produtos:",this.produtos.slice(0,3));const e=this.produtos.filter((a=>["julgado_aprovado","homologado"].includes(a.status)));console.log("üèõÔ∏è Produtos julgados encontrados:",e.length),e.length>0&&console.log("üìã Produtos julgados:",e.map((a=>`${a.nome} (${a.status})`)));const i={};this.produtos.forEach((a=>{i[a.status]=(i[a.status]||0)+1})),console.log("üìä Status dos produtos:",i),0===this.produtos.length&&console.warn("‚ö†Ô∏è Nenhum produto APROVADO ou JULGADO_APROVADO encontrado")}catch(a){console.error("üí• Erro ao carregar produtos:",a)}},preencherDadosProduto(){if(!this.marcaEditando.produto_id)return this.marcaEditando.marca="",void(this.marcaEditando.modelo="");const a=this.produtos.find((a=>a.id===this.marcaEditando.produto_id));a?(this.marcaEditando.marca=a.marca||"",this.marcaEditando.modelo=a.modelo||"",console.log("‚úÖ Dados do produto preenchidos:",{nome:a.nome,marca:a.marca,modelo:a.modelo})):console.error("‚ùå Produto n√£o encontrado no array:",this.marcaEditando.produto_id)},aplicarFiltros(){this.paginaAtual=1},limparFiltros(){this.filtros={marca:"",categoria:"",status:"",tipo:"",criticidade:""},this.paginaAtual=1},abrirModalNovaMarca(){this.marcaEditando=this.getMarcaVazia(),this.showModal=!0},editarMarca(a){this.marcaEditando={...a},this.showModal=!0},fecharModal(){this.showModal=!1,this.marcaEditando=this.getMarcaVazia()},async salvarMarca(){this.salvando=!0;try{const a=await(0,R.EO)();if(!a)throw new Error("Tenant ID n√£o encontrado");const t={...this.marcaEditando,tenant_id:a,status_atual:"ativa",nivel_criticidade:"medio",updated_at:(new Date).toISOString()};if(this.marcaEditando.id){const{error:a}=await R.ND.from("marcas_despadronizadas").update(t).eq("id",this.marcaEditando.id);if(a)throw a}else{t.created_at=(new Date).toISOString();const{error:a}=await R.ND.from("marcas_despadronizadas").insert([t]);if(a)throw a;this.marcaEditando.produto_id&&"MANUAL"!==this.marcaEditando.produto_id&&await this.atualizarStatusProduto(this.marcaEditando.produto_id,"despadronizada")}await this.carregarMarcas(),this.fecharModal(),this.$swal({title:"Sucesso!",text:"Marca despadronizada salva com sucesso!",icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao salvar marca:",a),this.$swal({title:"Erro",text:"Erro ao salvar marca: "+a.message,icon:"error"})}finally{this.salvando=!1}},async revogarMarca(a){const t=await this.$swal({title:"DCB Cancelada?",text:`Tem certeza que deseja cancelar a DCB da marca "${a.marca} ${a.modelo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, Cancelar DCB",cancelButtonText:"Cancelar"});if(t.isConfirmed)try{const{error:t}=await R.ND.from("marcas_despadronizadas").update({status_atual:"revogada",updated_at:(new Date).toISOString()}).eq("id",a.id);if(t)throw t;a.produto_id&&await this.atualizarStatusProduto(a.produto_id,"ativa"),await this.carregarMarcas(),this.$swal({title:"DCB Cancelada!",text:"DCB cancelada com sucesso.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(o){console.error("Erro ao cancelar DCB:",o),this.$swal({title:"Erro",text:"Erro ao cancelar DCB: "+o.message,icon:"error"})}},async atualizarStatusProduto(a,t){try{await this.carregarProdutos(),console.log("‚úÖ Lista de produtos atualizada ap√≥s "+("despadronizada"===t?"despadroniza√ß√£o":"revoga√ß√£o")),console.log("‚ÑπÔ∏è O status ser√° sincronizado automaticamente no Cat√°logo de Marcas")}catch(o){console.error("‚ùå Erro ao atualizar lista de produtos:",o)}},async exportarMarcas(){try{if(0===this.marcasFiltradas.length)return void this.$swal({title:"Aten√ß√£o",text:"N√£o h√° marcas para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"üì§ Exportar Marcas Despadronizadas",text:`Exportar ${this.marcasFiltradas.length} marca(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"üìä Excel (.xlsx)",cancelButtonText:"üìÑ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;this.$swal({title:"Sucesso!",text:`${this.marcasFiltradas.length} marca(s) exportada(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar marcas:",a),this.$swal({title:"Erro",text:"Erro ao exportar marcas: "+a.message,icon:"error"})}},visualizarMarca(a){this.$swal({title:`${a.marca} ${a.modelo}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>üì¶ Dados do Produto</h4>\n            <p><strong>Categoria:</strong> ${a.categoria}</p>\n            <p><strong>Fabricante:</strong> ${a.fabricante||"N/A"}</p>\n            <p><strong>C√≥digo:</strong> ${a.codigo_produto||"N/A"}</p>\n            \n            <h4>üìã Despadroniza√ß√£o</h4>\n            <p><strong>Processo:</strong> ${a.numero_processo}</p>\n            <p><strong>Tipo:</strong> ${this.getTipoLabel(a.tipo_despadronizacao)}</p>\n            <p><strong>Motivo:</strong> ${this.getMotivoLabel(a.motivo_principal)}</p>\n            <p><strong>Status:</strong> ${this.getStatusLabel(a.status_atual)}</p>\n            <p><strong>Criticidade:</strong> ${this.getCriticidadeLabel(a.nivel_criticidade)}</p>\n            \n            <h4>üìù Justificativa</h4>\n            <p>${a.justificativa||"N/A"}</p>\n          </div>\n        `,icon:"info",customClass:{popup:"swal-wide"}})},programarRevisao(a){this.$swal({title:"üìÖ Programar Revis√£o",text:`Funcionalidade em desenvolvimento - Programar revis√£o para ${a.marca}`,icon:"info"})},gerenciarNotificacoes(a){this.$swal({title:"üìß Gerenciar Notifica√ß√µes",text:`Funcionalidade em desenvolvimento - Notifica√ß√µes para ${a.marca}`,icon:"info"})},verHistorico(a){this.$swal({title:"üìã Hist√≥rico",text:`Funcionalidade em desenvolvimento - Hist√≥rico de ${a.marca}`,icon:"info"})},mostrarRevisoesVencidas(){const a=this.marcasComRevisaoVencida.map((a=>`‚Ä¢ ${a.marca} ${a.modelo} - Vencida h√° ${this.diasAtraso(a.proxima_revisao)} dias`)).join("<br>");this.$swal({title:"‚ö†Ô∏è Revis√µes Vencidas",html:`<div style="text-align: left;">${a}</div>`,icon:"warning"})},getMarcaVazia(){return{produto_id:"",marca:"",modelo:"",numero_processo:"",data_despadronizacao:"",tipo_despadronizacao:"",motivo_principal:"",justificativa:""}},getStatusLabel(a){const t={ativa:"Ativa",revogada:"DCB Cancelada",expirada:"Expirada",suspensa:"Suspensa"};return t[a]||a},getTipoLabel(a){const t={total:"Total",parcial:"Parcial",temporaria:"Tempor√°ria",definitiva:"Definitiva"};return t[a]||a},getMotivoLabel(a){const t={qualidade:"Problemas de Qualidade",custo:"Custo Elevado",descontinuacao:"Descontinua√ß√£o",seguranca:"Problemas de Seguran√ßa",fornecimento:"Problemas de Fornecimento",tecnico:"Obsolesc√™ncia T√©cnica",manutencao:"Dificuldade de Manuten√ß√£o",outros:"Outros"};return t[a]||a},getCriticidadeLabel(a){const t={baixo:"Baixa",medio:"M√©dia",alto:"Alta",critico:"Cr√≠tica"};return t[a]||a},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},isRevisaoVencida(a){return!!a&&new Date(a)<new Date},diasAtraso(a){if(!a)return 0;const t=new Date,o=new Date(a),e=t-o,i=Math.ceil(e/864e5);return Math.max(0,i)}}},$a=Sa;var Na=(0,C.A)($a,Aa,Pa,!1,null,"00ed113b",null);const Ra=Na.exports,Ia={name:"DashboardCPM",components:{PesquisaBot:ta,GerenciadorCotacoes:na,GerenciadorComparativo:pa,GerenciadorAnalisePrecos:Ca,GerenciadorRelatorios:ya,GerenciadorMarcasDespadronizadas:Ra},data(){return{activeTab:"dashboard",activeSubTab:"pesquisa-tecnica",cotacoes:[],produtos:[],produtosComDiligencia:[],pendentes:0,aprovados:0,reprovados:0,currentTenantId:null,loading:!1,editais:[],editaisFiltrados:[],loadingEditais:!1,modalNovoEdital:!1,modalVisualizarEdital:!1,modalEditarEdital:!1,modalParticipantes:!1,modalNovoParticipante:!1,modoEdicaoEdital:!1,salvandoEdital:!1,salvandoEdicaoEdital:!1,editalEditando:{id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:""},modalAddMinuta:!1,minutasDisponiveis:[],minutaSelecionada:null,criandoEdital:!1,novaMinuta:{nome:"",categoria:"geral",descricao:"",arquivo:null},salvandoMinuta:!1,editalAtual:{id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:"",url_documento:"",nome_arquivo:""},editalSelecionado:{},filtroEditais:{busca:"",status:""},participantes:[],participantesFiltrados:[],loadingParticipantes:!1,participanteAtual:{id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},filtroParticipantes:{busca:"",status:""},impugnacoes:[],modalNovaImpugnacao:!1,salvandoImpugnacao:!1,editaisParaImpugnacao:[],carregandoEditais:!1,novaImpugnacao:{edital_id:"",impugnante:"",email:"",empresa:"",motivo:"",documentos:[]},certificados:[],activeTabDCB:"emitir",produtosProntosDCB:[],produtosProntosDCBFiltrados:[],dcbsEmitidos:[],dcbsHistoricoFiltrados:[],dcbsVencendo:[],dcbsVencidos:[],emitindoDCB:null,modalProdutoDetalhes:!1,modalVisualizarDCB:!1,produtoSelecionado:null,dcbSelecionado:null,filtrosDCB:{busca:"",categoria:"",dataAprovacao:""},filtrosHistorico:{numeroDCB:"",status:"",dataInicio:"",dataFim:""},itensPorPagina:5,paginaAtual:1,totalPaginas:1,paginasVisiveis:[],filtros:{nome:"",marca:"",status:"",data:""},produtosPaginados:[],produtosFiltrados:[],itensPorPaginaDiligencia:5,paginaAtualDiligencia:1,totalPaginasDiligencia:1,paginasVisiveisDiligencia:[],filtrosDiligencia:{busca:"",marca:"",data:""},diligenciasFiltradas:[],diligenciasPaginadas:[],usuarios:[],usuariosFiltrados:[],modalNovoUsuario:!1,usuarioAtual:{id:null,nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[],criar_login:!1,user_id:null,senha_temporaria:null,convite_enviado:!1,convite_aceito:!1},filtroUsuarios:{busca:"",unidade:""},statusConvites:{},notificacoes:[],produtosDisponiveis:[],loadingProdutos:!1,avaliacoes:[],avaliacoesFiltradas:[],salvandoResposta:!1,filtroAvaliacoes:{busca:"",rating:"",usuario:""}}},created(){this.obterTenantId().then((()=>{this.carregarDados()}))},async mounted(){await this.carregarDados(),this.inicializarFiltros(),await this.carregarProdutos(),"lembretes"===this.activeTab&&(await this.carregarEstatisticasLembretes(),await this.carregarRdmsPendentes())},watch:{activeTab(a){"lembretes"===a?this.$nextTick((()=>{this.carregarEstatisticasLembretes&&this.carregarEstatisticasLembretes(),this.carregarRdmsPendentes&&this.carregarRdmsPendentes()})):"despadronizadas"===a?this.$nextTick((()=>{this.$refs.gerenciadorMarcas&&this.$refs.gerenciadorMarcas.carregarProdutos&&(console.log("üîÑ Recarregando produtos no gerenciador de marcas..."),this.$refs.gerenciadorMarcas.carregarProdutos())})):"reclamacoes"===a&&this.$nextTick((()=>{this.carregarAvaliacoes()}))}},computed:{marcasUnicas(){const a=[...new Set(this.produtosComDiligencia.map((a=>a.marca)))];return a.filter((a=>a)).sort()},editalSelecionadoInfo(){return this.novaImpugnacao.edital_id?this.editaisParaImpugnacao.find((a=>a.id===this.novaImpugnacao.edital_id)):null},temFiltrosAplicados(){return this.filtros.nome||this.filtros.marca||this.filtros.status||this.filtros.data},temFiltrosDiligenciaAplicados(){return this.filtrosDiligencia.busca||this.filtrosDiligencia.marca||this.filtrosDiligencia.data},editaisAtivos(){return this.editais.filter((a=>"PUBLICADO"===a.status))},editaisRascunho(){return this.editais.filter((a=>"RASCUNHO"===a.status))},editaisFinalizados(){return this.editais.filter((a=>"CANCELADO"===a.status))},totalParticipantes(){return this.editais.reduce(((a,t)=>a+(t.participantes_count||0)),0)},unidadesUnicas(){const a=[...new Set(this.usuarios.map((a=>a.unidade_setor)))];return a.filter((a=>a)).sort()}},methods:{async obterTenantId(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usu√°rio n√£o est√° autenticado");if(t.user_metadata?.tenant_id)return this.currentTenantId=t.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:o,error:e}=await R.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);o?.tenant_id?(this.currentTenantId=o.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID n√£o encontrado para o usu√°rio")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){try{if(this.loading=!0,!this.currentTenantId&&(console.error("Tenant ID n√£o dispon√≠vel. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return void console.error("N√£o foi poss√≠vel obter o tenant_id, imposs√≠vel carregar dados");console.log("Carregando produtos para tenant_id:",this.currentTenantId);const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(t)throw t;const o=a||[];this.produtos=o.filter((a=>["pendente","aprovado","reprovado","em_analise","julgado_aprovado","julgado_reprovado"].includes(a.status))),console.log(`${this.produtos.length} requerimentos recentes carregados (sem dilig√™ncias)`),this.produtosComDiligencia=o.filter((a=>"diligencia"===a.status)),console.log(`${this.produtosComDiligencia.length} produtos com dilig√™ncia carregados`),await this.carregarImpugnacoes(),await this.carregarDadosDCB(),await this.carregarEditais(),await this.carregarMinutasDisponiveis(),await this.carregarUsuarios(),await this.carregarAvaliacoes();const e=await Promise.all([this.contarPorStatus("pendente"),this.contarPorStatus("aprovado"),this.contarPorStatus("reprovado")]);this.pendentes=e[0],this.aprovados=e[1],this.reprovados=e[2]}catch(a){console.error("Erro ao carregar dados:",a)}finally{this.loading=!1,this.$nextTick((()=>{this.inicializarFiltros()}))}},async contarPorStatus(a){if(!this.currentTenantId)return 0;let t=R.ND.from("produtos").select("id",{count:"exact"}).eq("tenant_id",this.currentTenantId);t="aprovado"===a?t.in("status",["aprovado","julgado_aprovado","homologado"]):"reprovado"===a?t.in("status",["reprovado","julgado_reprovado"]):t.eq("status",a);const{count:o,error:e}=await t;return e?(console.error(`Erro ao contar produtos ${a}:`,e),0):o||0},verProduto(a){this.$router.push(`/analise/${a}`)},getImpugnacaoStatusClass(a){switch(a){case"EM AN√ÅLISE":return"status-pendente";case"DEFERIDA":return"status-aprovado";case"INDEFERIDA":return"status-reprovado";default:return""}},async analisarImpugnacao(a){try{const{data:t,error:o}=await R.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("id",a).single();if(o)throw o;const{value:e}=await this.$swal({title:"An√°lise de Impugna√ß√£o",html:`\n            <div style="text-align: left;">\n              <h4>Impugna√ß√£o de: ${t.impugnante}</h4>\n              <p><strong>Edital:</strong> ${t.editais?.numero} - ${t.editais?.descricao}</p>\n              <p><strong>Data:</strong> ${this.formatDate(t.data_impugnacao)}</p>\n              <p><strong>Prazo Final:</strong> ${this.formatDate(t.prazo_final)}</p>\n              <p><strong>Motivo:</strong> ${t.motivo}</p>\n              <p><strong>Status Atual:</strong> ${t.status}</p>\n            </div>\n            <hr>\n            <label for="decisao"><strong>Decis√£o:</strong></label>\n            <select id="decisao" class="swal2-input">\n              <option value="">Selecione uma decis√£o</option>\n              <option value="DEFERIDA">DEFERIDA (Procedente)</option>\n              <option value="INDEFERIDA">INDEFERIDA (Improcedente)</option>\n              <option value="PARCIALMENTE_DEFERIDA">PARCIALMENTE DEFERIDA</option>\n            </select>\n            <label for="justificativa"><strong>Justificativa da Decis√£o:</strong></label>\n            <textarea id="justificativa" class="swal2-textarea" placeholder="Fundamente a decis√£o tomada..."></textarea>\n          `,focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("decisao").value,t=document.getElementById("justificativa").value;return a?!t||t.trim().length<10?(this.$swal.showValidationMessage("A justificativa deve ter pelo menos 10 caracteres"),!1):{decisao:a,justificativa:t}:(this.$swal.showValidationMessage("Selecione uma decis√£o"),!1)}});e&&await this.salvarDecisaoImpugnacao(a,e.decisao,e.justificativa)}catch(t){console.error("Erro ao analisar impugna√ß√£o:",t),this.$swal({title:"Erro",text:"Erro ao carregar dados da impugna√ß√£o",icon:"error"})}},async carregarImpugnacoes(){try{const{data:a,error:t}=await R.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("tenant_id",this.currentTenantId).order("data_impugnacao",{ascending:!1}).limit(10);if(t)throw t;this.impugnacoes=a?.map((a=>({...a,produto_nome:`Edital ${a.editais?.numero||"N/A"}`})))||[],console.log(`${this.impugnacoes.length} impugna√ß√µes carregadas`)}catch(a){console.error("Erro ao carregar impugna√ß√µes:",a),this.impugnacoes=[]}},async salvarDecisaoImpugnacao(a,t,o){try{const{error:e}=await R.ND.from("impugnacoes").update({status:t,justificativa_decisao:o,data_decisao:(new Date).toISOString(),analisado_por:"CPM"}).eq("id",a);if(e)throw e;this.$swal({title:"Sucesso!",text:"Decis√£o da impugna√ß√£o salva com sucesso",icon:"success"}),await this.carregarImpugnacoes()}catch(e){console.error("Erro ao salvar decis√£o:",e),this.$swal({title:"Erro",text:"Erro ao salvar decis√£o da impugna√ß√£o",icon:"error"})}},async verDecisaoImpugnacao(a){try{const{data:t,error:o}=await R.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("id",a).single();if(o)throw o;const e=t,i="DEFERIDA"===e.status?"Deferida":"INDEFERIDA"===e.status?"Indeferida":"Pendente de an√°lise";this.$swal({title:"Decis√£o da Impugna√ß√£o",html:`\n            <div style="text-align: left;">\n              <h4>Impugna√ß√£o de: ${e.impugnante}</h4>\n              <p><strong>Edital:</strong> ${e.editais?.numero} - ${e.editais?.descricao}</p>\n              <p><strong>Data da Impugna√ß√£o:</strong> ${this.formatDate(e.data_impugnacao)}</p>\n              <p><strong>Motivo:</strong> ${e.motivo}</p>\n              <hr>\n              <h4>Decis√£o:</h4>\n              <p><strong>Status:</strong> <span style="color: ${"DEFERIDA"===e.status?"#27ae60":"INDEFERIDA"===e.status?"#e74c3c":"#f39c12"}">${i}</span></p>\n              ${e.justificativa_decisao?`<p><strong>Justificativa:</strong> ${e.justificativa_decisao}</p>`:""}\n              ${e.data_decisao?`<p><strong>Data da Decis√£o:</strong> ${this.formatDate(e.data_decisao)}</p>`:""}\n              ${e.analisado_por?`<p><strong>Analisado por:</strong> ${e.analisado_por}</p>`:""}\n              ${e.data_decisao?"":"<p><em>Esta impugna√ß√£o ainda n√£o foi analisada.</em></p>"}\n            </div>\n          `,width:"600px",confirmButtonText:"Fechar"})}catch(t){console.error("Erro ao carregar decis√£o:",t),this.$swal({title:"Erro",text:"Erro ao carregar decis√£o da impugna√ß√£o",icon:"error"})}},async abrirModalNovaImpugnacao(){this.modalNovaImpugnacao=!0,this.limparFormularioImpugnacao(),await this.carregarEditaisParaImpugnacao()},fecharModalNovaImpugnacao(){this.modalNovaImpugnacao=!1,this.limparFormularioImpugnacao()},async carregarEditaisParaImpugnacao(){try{this.carregandoEditais=!0;const{data:a,error:t}=await R.ND.from("editais").select("id, numero, descricao, status, data_publicacao, data_limite_impugnacao").eq("tenant_id",this.currentTenantId).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(t)throw t;this.editaisParaImpugnacao=a||[],0===this.editaisParaImpugnacao.length&&this.$swal({title:"Nenhum Edital Dispon√≠vel",text:"N√£o h√° editais publicados dispon√≠veis para impugna√ß√£o no momento.",icon:"info"})}catch(a){console.error("Erro ao carregar editais:",a),this.$swal({title:"Erro",text:"Erro ao carregar editais dispon√≠veis.",icon:"error"})}finally{this.carregandoEditais=!1}},limparFormularioImpugnacao(){this.novaImpugnacao={edital_id:"",impugnante:"",email:"",empresa:"",motivo:"",documentos:[]}},editalDentroDoPrazo(a){if(!a.data_limite_impugnacao)return!1;const t=new Date,o=new Date(a.data_limite_impugnacao);return t<=o},handleDocumentosUpload(a){const t=a.target.files;this.novaImpugnacao.documentos=Array.from(t)},async salvarNovaImpugnacao(){if(!this.salvandoImpugnacao)try{this.salvandoImpugnacao=!0;const a=this.editaisParaImpugnacao.find((a=>a.id===this.novaImpugnacao.edital_id));if(!this.editalDentroDoPrazo(a))return void this.$swal({title:"Prazo Vencido",text:"O prazo para impugna√ß√£o deste edital j√° expirou.",icon:"error"});const t=new Date,o=new Date(t);o.setDate(o.getDate()+7);const e={edital_id:this.novaImpugnacao.edital_id,impugnante:this.novaImpugnacao.impugnante,email_impugnante:this.novaImpugnacao.email,documento_impugnante:this.novaImpugnacao.documento||"00000000000",motivo:this.novaImpugnacao.motivo,data_impugnacao:t.toISOString(),prazo_final:o.toISOString(),status:"EM_ANALISE",tenant_id:this.currentTenantId,criado_em:(new Date).toISOString()},{data:i,error:s}=await R.ND.from("impugnacoes").insert(e).select().single();if(s)throw s;this.novaImpugnacao.documentos.length>0&&console.log("Documentos a serem enviados:",this.novaImpugnacao.documentos),this.$swal({title:"Sucesso!",text:"Impugna√ß√£o registrada com sucesso. Voc√™ receber√° atualiza√ß√µes por email.",icon:"success",timer:4e3}),await this.carregarImpugnacoes(),this.fecharModalNovaImpugnacao()}catch(a){console.error("Erro ao salvar impugna√ß√£o:",a),this.$swal({title:"Erro",text:a.message||"Erro ao registrar impugna√ß√£o. Tente novamente.",icon:"error"})}finally{this.salvandoImpugnacao=!1}},async solicitarDiligencia(a){try{const{value:t}=await this.$swal({title:"Solicitar Dilig√™ncia",html:'\n             <label for="tipo_diligencia"><strong>Tipo de Dilig√™ncia:</strong></label>\n             <select id="tipo_diligencia" class="swal2-input">\n               <option value="">Selecione o tipo</option>\n               <option value="DOCUMENTACAO_FALTANTE">Documenta√ß√£o Faltante</option>\n               <option value="AMOSTRA_INADEQUADA">Amostra Inadequada</option>\n               <option value="ESPECIFICACAO_INCOMPLETA">Especifica√ß√£o Incompleta</option>\n               <option value="CERTIFICACAO_PENDENTE">Certifica√ß√£o Pendente</option>\n               <option value="ESCLARECIMENTO_TECNICO">Esclarecimento T√©cnico</option>\n             </select>\n             <label for="descricao_diligencia"><strong>Descri√ß√£o da Dilig√™ncia:</strong></label>\n             <textarea id="descricao_diligencia" class="swal2-textarea" placeholder="Descreva detalhadamente o que precisa ser providenciado..."></textarea>\n             <label for="prazo_dias"><strong>Prazo (dias √∫teis):</strong></label>\n             <input type="number" id="prazo_dias" class="swal2-input" value="5" min="1" max="30">\n           ',focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,t=document.getElementById("descricao_diligencia").value,o=parseInt(document.getElementById("prazo_dias").value);return a?!t||t.trim().length<10?(this.$swal.showValidationMessage("A descri√ß√£o deve ter pelo menos 10 caracteres"),!1):!o||o<1||o>30?(this.$swal.showValidationMessage("O prazo deve ser entre 1 e 30 dias"),!1):{tipo:a,descricao:t,prazo:o}:(this.$swal.showValidationMessage("Selecione o tipo de dilig√™ncia"),!1)}});t&&await this.salvarDiligencia(a,t)}catch(t){console.error("Erro ao solicitar dilig√™ncia:",t)}},async salvarDiligencia(a,t){try{const o=this.calcularDataUtil(new Date,t.prazo),{error:e}=await R.ND.from("diligencias").insert({produto_id:a,tenant_id:this.currentTenantId,tipo:t.tipo,descricao:t.descricao,prazo_dias:t.prazo,data_limite:o.toISOString(),status:"PENDENTE",solicitado_por:"CPM"});if(e)throw e;const{error:i}=await R.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(i)throw i;this.$swal({title:"Sucesso!",text:"Dilig√™ncia solicitada com sucesso",icon:"success"}),await this.carregarDados()}catch(o){console.error("Erro ao salvar dilig√™ncia:",o),this.$swal({title:"Erro",text:"Erro ao solicitar dilig√™ncia",icon:"error"})}},async visualizarDiligencias(a){try{const{data:t,error:o}=await R.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(o)throw o;let e='<div style="text-align: left;">';t&&t.length>0?(e+="<h4>Dilig√™ncias do Produto:</h4>",t.forEach(((a,t)=>{const o="PENDENTE"===a.status?"color: #f39c12":"color: #27ae60";e+=`\n               <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">\n                 <strong>Dilig√™ncia ${t+1}</strong><br>\n                 <strong>Tipo:</strong> ${a.tipo.replace(/_/g," ")}<br>\n                 <strong>Status:</strong> <span style="${o}">${a.status}</span><br>\n                 <strong>Descri√ß√£o:</strong> ${a.descricao}<br>\n                 <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}<br>\n                 <strong>Solicitado em:</strong> ${this.formatDate(a.criado_em)}\n               </div>\n             `}))):e+="<p>Nenhuma dilig√™ncia encontrada para este produto.</p>",e+="</div>",this.$swal({title:"Dilig√™ncias",html:e,width:"600px"})}catch(t){console.error("Erro ao carregar dilig√™ncias:",t),this.$swal({title:"Erro",text:"Erro ao carregar dilig√™ncias do produto",icon:"error"})}},calcularDataUtil(a,t){const o=new Date(a);let e=0;while(e<t)o.setDate(o.getDate()+1),0!==o.getDay()&&6!==o.getDay()&&e++;return o},inicializarFiltros(){this.produtosFiltrados=[...this.produtos],this.diligenciasFiltradas=[...this.produtosComDiligencia],this.aplicarFiltros(),this.aplicarFiltrosDiligencia()},aplicarFiltros(){this.produtosFiltrados=this.produtos.filter((a=>{const t=a.nome.toLowerCase().includes(this.filtros.nome.toLowerCase()),o=a.marca.toLowerCase().includes(this.filtros.marca.toLowerCase()),e=""===this.filtros.status||a.status===this.filtros.status;let i=!0;if(this.filtros.data){const t=new Date(a.criado_em).toDateString(),o=new Date(this.filtros.data).toDateString();i=t===o}return t&&o&&e&&i})),this.calcularPaginacao()},calcularPaginacao(){this.totalPaginas=Math.ceil(this.produtosFiltrados.length/this.itensPorPagina),this.paginaAtual>this.totalPaginas&&(this.paginaAtual=Math.max(1,this.totalPaginas)),this.paginasVisiveis=[];const a=5;if(this.totalPaginas<=a)for(let e=1;e<=this.totalPaginas;e++)this.paginasVisiveis.push(e);else{const t=Math.max(1,this.paginaAtual-2),o=Math.min(this.totalPaginas,t+a-1);for(let a=t;a<=o;a++)this.paginasVisiveis.push(a)}const t=(this.paginaAtual-1)*this.itensPorPagina,o=t+this.itensPorPagina;this.produtosPaginados=this.produtosFiltrados.slice(t,o)},aplicarPaginacao(){this.paginaAtual=1,this.calcularPaginacao()},irParaPagina(a){this.paginaAtual=a,this.calcularPaginacao()},limparFiltros(){this.filtros={nome:"",marca:"",status:"",data:""},this.paginaAtual=1,this.aplicarFiltros()},aplicarFiltrosDiligencia(){this.diligenciasFiltradas=this.produtosComDiligencia.filter((a=>{const t=!this.filtrosDiligencia.busca||a.nome.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.marca.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.fabricante&&a.fabricante.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase()),o=!this.filtrosDiligencia.marca||a.marca===this.filtrosDiligencia.marca;let e=!0;if(this.filtrosDiligencia.data){const t=new Date(a.criado_em).toDateString(),o=new Date(this.filtrosDiligencia.data).toDateString();e=t===o}return t&&o&&e})),this.calcularPaginacaoDiligencia()},calcularPaginacaoDiligencia(){this.totalPaginasDiligencia=Math.ceil(this.diligenciasFiltradas.length/this.itensPorPaginaDiligencia),this.paginaAtualDiligencia>this.totalPaginasDiligencia&&(this.paginaAtualDiligencia=Math.max(1,this.totalPaginasDiligencia)),this.paginasVisiveisDiligencia=[];const a=5;if(this.totalPaginasDiligencia<=a)for(let e=1;e<=this.totalPaginasDiligencia;e++)this.paginasVisiveisDiligencia.push(e);else{const t=Math.max(1,this.paginaAtualDiligencia-2),o=Math.min(this.totalPaginasDiligencia,t+a-1);for(let a=t;a<=o;a++)this.paginasVisiveisDiligencia.push(a)}const t=(this.paginaAtualDiligencia-1)*this.itensPorPaginaDiligencia,o=t+this.itensPorPaginaDiligencia;this.diligenciasPaginadas=this.diligenciasFiltradas.slice(t,o)},aplicarPaginacaoDiligencia(){this.paginaAtualDiligencia=1,this.calcularPaginacaoDiligencia()},irParaPaginaDiligencia(a){this.paginaAtualDiligencia=a,this.calcularPaginacaoDiligencia()},limparFiltrosDiligencia(){this.filtrosDiligencia={busca:"",marca:"",data:""},this.paginaAtualDiligencia=1,this.aplicarFiltrosDiligencia()},formatarStatus(a){const t={pendente:"Em Avalia√ß√£o",aprovado:"Aprovado",julgado_aprovado:"Julgado Aprovado",julgado_reprovado:"Julgado Reprovado",homologado:"Homologado",reprovado:"Reprovado",diligencia:"Dilig√™ncia",em_analise:"Em An√°lise",INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"Documenta√ß√£o Enviada",EM_AVALIACAO:"Em Avalia√ß√£o",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return t[a]||a},getStatusClass(a){const t={aprovado:"status-aprovado",julgado_aprovado:"status-aprovado",julgado_reprovado:"status-reprovado",homologado:"status-aprovado",pendente:"status-pendente",reprovado:"status-reprovado",diligencia:"status-diligencia",em_analise:"status-em_analise",INTERESSADO:"status-interessado",DOCUMENTACAO_ENVIADA:"status-documentacao",EM_AVALIACAO:"status-avaliacao",APROVADO:"status-aprovado",REPROVADO:"status-reprovado",DESISTENTE:"status-desistente"};return t[a]||`status-${a}`},formatDate(a){if(!a)return"N√£o informado";try{const t=new Date(a);return isNaN(t.getTime())?"Data inv√°lida":t.toLocaleDateString("pt-BR")}catch(t){return"Data inv√°lida"}},formatarEdital(a){if(a.edital_prequalificacao){const t=a.edital_prequalificacao.match(/n¬∫\s*(\d{3}\/\d{4})/i);return t?`n¬∫ ${t[1]}`:a.edital_prequalificacao}return a.numero_edital&&a.ano_edital?`n¬∫ ${a.numero_edital}`:"Sem edital vinculado"},async carregarDadosDCB(){try{if(!this.currentTenantId)return;console.log("Carregando dados DCB para tenant:",this.currentTenantId);const{data:a,error:t}=await R.ND.from("produtos").select("\n              *,\n              categorias(nome)\n            ").eq("tenant_id",this.currentTenantId).eq("status","aprovado").is("numero_dcb",null).order("data_aprovacao",{ascending:!1});if(t)throw t;this.produtosProntosDCB=a||[],this.produtosProntosDCBFiltrados=[...this.produtosProntosDCB];const{data:o,error:e}=await R.ND.from("dcb_certificados").select("\n              *,\n              produtos(nome, marca, modelo, fabricante)\n            ").eq("tenant_id",this.currentTenantId).order("data_emissao",{ascending:!1});if(e)throw e;const i=o||[];this.dcbsEmitidos=i.map((a=>({...a,produto_nome:a.produtos?.nome||"N/A",produto_marca:a.produtos?.marca||"N/A",produto_modelo:a.produtos?.modelo||"N/A",produto_fabricante:a.produtos?.fabricante||"N/A"}))),this.dcbsHistoricoFiltrados=[...this.dcbsEmitidos],this.calcularVencimentos(),console.log(`DCB dados carregados: ${this.produtosProntosDCB.length} prontos, ${this.dcbsEmitidos.length} emitidos`)}catch(a){console.error("Erro ao carregar dados DCB:",a),this.$swal.fire("Erro","Erro ao carregar dados DCB","error")}},calcularVencimentos(){const a=new Date,t=new Date;t.setDate(a.getDate()+30),this.dcbsVencendo=this.dcbsEmitidos.filter((o=>{if("ativo"!==o.status)return!1;const e=new Date(o.data_validade);return e>a&&e<=t})),this.dcbsVencidos=this.dcbsEmitidos.filter((t=>{if("ativo"!==t.status)return!1;const o=new Date(t.data_validade);return o<=a}))},aplicarFiltrosDCB(){let a=[...this.produtosProntosDCB];if(this.filtrosDCB.busca){const t=this.filtrosDCB.busca.toLowerCase();a=a.filter((a=>a.nome.toLowerCase().includes(t)||a.marca.toLowerCase().includes(t)||a.fabricante.toLowerCase().includes(t)))}if(this.filtrosDCB.categoria&&(a=a.filter((a=>a.categorias?.nome?.toLowerCase()===this.filtrosDCB.categoria))),this.filtrosDCB.dataAprovacao){const t=new Date(this.filtrosDCB.dataAprovacao);a=a.filter((a=>{if(!a.data_aprovacao)return!1;const o=new Date(a.data_aprovacao);return o.toDateString()===t.toDateString()}))}this.produtosProntosDCBFiltrados=a},limparFiltrosDCB(){this.filtrosDCB={busca:"",categoria:"",dataAprovacao:""},this.aplicarFiltrosDCB()},aplicarFiltrosHistorico(){let a=[...this.dcbsEmitidos];if(this.filtrosHistorico.numeroDCB){const t=this.filtrosHistorico.numeroDCB.toLowerCase();a=a.filter((a=>a.numero_dcb.toLowerCase().includes(t)))}if(this.filtrosHistorico.status&&(a=a.filter((a=>a.status===this.filtrosHistorico.status))),this.filtrosHistorico.dataInicio){const t=new Date(this.filtrosHistorico.dataInicio);a=a.filter((a=>{const o=new Date(a.data_emissao);return o>=t}))}if(this.filtrosHistorico.dataFim){const t=new Date(this.filtrosHistorico.dataFim);a=a.filter((a=>{const o=new Date(a.data_emissao);return o<=t}))}this.dcbsHistoricoFiltrados=a},async emitirDCB(a){try{this.emitindoDCB=a.id,console.log("Emitindo DCB para produto:",a.nome);const t=await this.gerarNumeroDCB(),o=new Date,e=new Date;e.setFullYear(e.getFullYear()+1);const i=e.toISOString().split("T")[0],{data:s,error:r}=await R.ND.from("dcb_certificados").insert({tenant_id:this.currentTenantId,produto_id:a.id,numero_dcb:t,data_emissao:o.toISOString(),data_validade:i,status:"ativo"}).select().single();if(r)throw r;const{error:n}=await R.ND.from("produtos").update({numero_dcb:t,validade_dcb:i}).eq("id",a.id);if(n)throw n;await this.registrarHistoricoDCB(a.id,"dcb_emitido",`DCB ${t} emitido`),await this.carregarDadosDCB(),await this.gerarPDFDCBAutomatico(s,a),this.$swal.fire({icon:"success",title:"üéâ DCB Emitido com Sucesso!",html:`\n              <div style="text-align: left; padding: 10px;">\n                <p><strong>üìú DCB:</strong> ${t}</p>\n                <p><strong>üì¶ Produto:</strong> ${a.nome}</p>\n                <p><strong>üè≠ Marca:</strong> ${a.marca}</p>\n                <p><strong>üìÖ Validade:</strong> ${this.formatDate(i)}</p>\n                <hr style="margin: 15px 0;">\n                <p style="color: #28a745; font-weight: bold;">\n                  ‚úÖ PDF oficial gerado automaticamente<br>\n                  üì• Use o bot√£o "PDF" para baixar\n                </p>\n              </div>\n            `,showConfirmButton:!0,confirmButtonText:"üì• Baixar PDF Agora",showCancelButton:!0,cancelButtonText:"Fechar",confirmButtonColor:"#dc3545"}).then((a=>{a.isConfirmed&&this.downloadDCB(s)})),console.log("DCB emitido com sucesso:",t)}catch(t){console.error("Erro ao emitir DCB:",t),this.$swal.fire("Erro","Erro ao emitir DCB: "+t.message,"error")}finally{this.emitindoDCB=null}},async gerarNumeroDCB(){try{const{data:a,error:t}=await R.ND.from("dcb_certificados").select("numero_dcb").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1}).limit(1);if(t)throw t;const o=(new Date).getFullYear();if(!a||0===a.length)return`001/${o}`;const e=a[0].numero_dcb,[i,s]=e.split("/");if(parseInt(s)===o){const a=parseInt(i)+1;return`${a.toString().padStart(3,"0")}/${o}`}return`001/${o}`}catch(a){throw console.error("Erro ao gerar n√∫mero DCB:",a),a}},async registrarHistoricoDCB(a,t,o){try{const{data:e}=await R.ND.auth.getSession(),i=e?.session?.user;await R.ND.from("workflow_historico").insert({tenant_id:this.currentTenantId,produto_id:a,usuario_id:i?.id,acao:t,observacoes:o})}catch(e){console.error("Erro ao registrar hist√≥rico:",e)}},visualizarProdutoDetalhes(a){this.produtoSelecionado=a,this.modalProdutoDetalhes=!0},fecharModalDetalhes(){this.modalProdutoDetalhes=!1,this.produtoSelecionado=null},visualizarDCB(a){this.dcbSelecionado=a,this.modalVisualizarDCB=!0},fecharModalDCB(){this.modalVisualizarDCB=!1,this.dcbSelecionado=null},async downloadDCB(a){try{console.log("Iniciando download DCB:",a.numero_dcb),this.$swal.fire({title:"Gerando PDF...",text:"Aguarde enquanto geramos seu DCB",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}}),await this.gerarPDFDCB(a),this.$swal.close()}catch(t){console.error("Erro ao fazer download:",t),this.$swal.fire("Erro","Erro ao gerar PDF do DCB: "+t.message,"error")}},async gerarPDFDCB(a){try{const e=(await Promise.resolve().then(o.bind(o,1749))).default,i=(await o.e(420).then(o.t.bind(o,8420,19))).default,{data:s,error:r}=await R.ND.from("produtos").select("*").eq("id",a.produto_id).single();if(r)throw r;const n=new e("portrait","mm","a4"),l=n.internal.pageSize.getWidth(),c=n.internal.pageSize.getHeight(),d=20;let u=d;n.setFontSize(16),n.setFont("helvetica","bold"),n.text("REP√öBLICA FEDERATIVA DO BRASIL",l/2,u,{align:"center"}),u+=8,n.setFontSize(14),n.text("MINIST√âRIO DA SA√öDE",l/2,u,{align:"center"}),u+=6,n.setFontSize(12),n.setFont("helvetica","normal"),n.text("Comiss√£o de Padroniza√ß√£o de Materiais - CPM",l/2,u,{align:"center"}),u+=15,n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,l-d,u),u+=15,n.setFontSize(18),n.setFont("helvetica","bold"),n.text("DECLARA√á√ÉO DE CONFORMIDADE DE BEM",l/2,u,{align:"center"}),u+=8,n.setFontSize(16),n.setTextColor(0,100,200),n.text(`DCB N¬∫ ${a.numero_dcb}`,l/2,u,{align:"center"}),n.setTextColor(0,0,0),u+=20,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("PRODUTO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal");const m=50;n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,l-2*d,m,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Nome do Produto:",d+5,u),n.setFont("helvetica","normal"),n.text(s.nome||"N/A",d+45,u),u+=7,n.setFont("helvetica","bold"),n.text("Marca:",d+5,u),n.setFont("helvetica","normal"),n.text(s.marca||"N/A",d+20,u),u+=7,n.setFont("helvetica","bold"),n.text("Modelo:",d+5,u),n.setFont("helvetica","normal"),n.text(s.modelo||"N/A",d+22,u),u+=7,n.setFont("helvetica","bold"),n.text("Fabricante:",d+5,u),n.setFont("helvetica","normal"),n.text(s.fabricante||"N/A",d+30,u),u+=7,n.setFont("helvetica","bold"),n.text("CNPJ:",d+5,u),n.setFont("helvetica","normal"),n.text(s.cnpj_fabricante||s.cnpj||"N/A",d+20,u),u+=25,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("DADOS DO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal"),n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,l-2*d,40,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Data de Emiss√£o:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_emissao),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Data de Validade:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_validade),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Status:",d+5,u),n.setFont("helvetica","normal"),n.setTextColor(0,150,0),n.text(this.formatStatusDCB(a.status),d+20,u),n.setTextColor(0,0,0),u+=25,n.setFontSize(12),n.setFont("helvetica","bold"),n.text("DECLARA√á√ÉO",d,u),u+=10,n.setFontSize(10),n.setFont("helvetica","normal");const p=`Declaramos que o produto acima identificado foi submetido a an√°lise t√©cnica pela Comiss√£o de Padroniza√ß√£o de Materiais (CPM) deste √≥rg√£o, tendo sido APROVADO para utiliza√ß√£o em processos licitat√≥rios, conforme previsto na Lei Federal n¬∫ 14.133/2021 (Lei de Licita√ß√µes e Contratos).\n\nO presente Documento de Comprova√ß√£o de Bem (DCB) atesta que o produto atende aos requisitos t√©cnicos m√≠nimos exigidos e est√° apto para fornecimento no √¢mbito da Administra√ß√£o P√∫blica.\n\nEsta declara√ß√£o possui validade at√© ${this.formatDate(a.data_validade)}, podendo ser renovada mediante nova an√°lise t√©cnica.`,v=n.splitTextToSize(p,l-2*d),g=4*v.length+80;u+g>c-30&&(n.addPage(),u=d),n.text(v,d,u),u+=4*v.length+25;try{const t=window.location.origin,o=t.includes("github.io"),e=o?`${t}/ComprarBem/#/validar-dcb/${a.numero_dcb}`:`${t}/validar-dcb/${a.numero_dcb}`,s=await i.toDataURL(e,{width:80,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),r=Math.max(u,c-120);n.addImage(s,"PNG",l-d-30,r,25,25),n.setFontSize(8),n.text("Validar DCB:",l-d-30,r+30),n.text(a.numero_dcb,l-d-30,r+33)}catch(t){console.warn("Erro ao gerar QR Code:",t)}u=c-90,n.setFontSize(10),n.setFont("helvetica","normal");const _=new Date;n.text(`Bras√≠lia, ${_.getDate().toString().padStart(2,"0")} de ${_.toLocaleDateString("pt-BR",{month:"long"})} de ${_.getFullYear()}`,d,u),u+=20,u=Math.max(u,c-85),n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,l/2-10,u),u+=8,n.setFontSize(9),n.setTextColor(0,0,0),n.text("Presidente da Comiss√£o de Padroniza√ß√£o de Materiais",d,u),u+=4,n.text("CPM - Minist√©rio da Sa√∫de",d,u),n.setFontSize(8),n.setTextColor(100,100,100);const f=`Este documento foi gerado eletronicamente pelo Sistema ComprarBem em ${_.toLocaleString("pt-BR")}`;n.text(f,l/2,c-10,{align:"center"});const h=`DCB_${a.numero_dcb.replace("/","_")}_${s.nome.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;n.save(h),console.log("PDF gerado com sucesso:",h),await this.salvarURLPDFNoBanco(a.id,h)}catch(e){throw console.error("Erro ao gerar PDF:",e),e}},async salvarURLPDFNoBanco(a,t){try{const{error:o}=await R.ND.from("dcb_certificados").update({arquivo_pdf_url:t}).eq("id",a);o&&console.warn("Erro ao salvar URL do PDF:",o)}catch(o){console.warn("Erro ao atualizar banco com PDF:",o)}},async gerarPDFDCBAutomatico(a,t){try{console.log("Gerando PDF automaticamente para DCB:",a.numero_dcb);const o={...a,produto_id:t.id};await this.gerarPDFDCB(o)}catch(o){console.warn("Erro ao gerar PDF automaticamente:",o)}},async revogarDCB(a){try{const t=await this.$swal.fire({title:"Revogar DCB?",text:`Tem certeza que deseja revogar o DCB ${a.numero_dcb}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, revogar",cancelButtonText:"Cancelar",input:"textarea",inputPlaceholder:"Digite o motivo da revoga√ß√£o...",inputValidator:a=>{if(!a)return"Voc√™ precisa inserir um motivo!"}});if(t.isConfirmed){const o=t.value,{error:e}=await R.ND.from("dcb_certificados").update({status:"revogado",revogado_em:(new Date).toISOString(),motivo_revogacao:o}).eq("id",a.id);if(e)throw e;await this.carregarDadosDCB(),this.$swal.fire("Sucesso!","DCB revogado com sucesso.","success")}}catch(t){console.error("Erro ao revogar DCB:",t),this.$swal.fire("Erro","Erro ao revogar DCB","error")}},async iniciarRenovacao(a){this.$swal.fire({icon:"info",title:"Renova√ß√£o de DCB",text:`Processo de renova√ß√£o do DCB ${a.numero_dcb} ser√° implementado em breve.`,timer:2e3})},async renovarDCBVencido(a){this.$swal.fire({icon:"info",title:"Renova√ß√£o Urgente",text:`Renova√ß√£o urgente do DCB ${a.numero_dcb} ser√° implementada em breve.`,timer:2e3})},getStatusDCBClass(a){switch(a){case"ativo":return"status-ativo";case"vencido":return"status-vencido";case"revogado":return"status-revogado";default:return"status-indefinido"}},formatStatusDCB(a){switch(a){case"ativo":return"Ativo";case"vencido":return"Vencido";case"revogado":return"Revogado";default:return a}},calcularDiasRestantes(a){const t=new Date,o=new Date(a),e=o-t,i=Math.ceil(e/864e5);return Math.max(0,i)},calcularDiasVencidos(a){const t=new Date,o=new Date(a),e=t-o,i=Math.ceil(e/864e5);return Math.max(0,i)},formatarEspecificacoes(a){return"string"===typeof a?a:"object"===typeof a?JSON.stringify(a,null,2):"N/A"},async carregarEditais(){try{if(this.loadingEditais=!0,!this.currentTenantId)return void console.error("Tenant ID n√£o dispon√≠vel para carregar editais");const{data:a,error:t}=await R.ND.from("editais").select("\n              *,\n              participantes_count:participantes_editais(count)\n            ").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(t)throw t;this.editais=(a||[]).map((a=>({...a,participantes_count:a.participantes_count?.[0]?.count||0}))),this.aplicarFiltrosEditais(),console.log(`${this.editais.length} editais carregados`),console.log("Editais com participantes:",this.editais.map((a=>({numero:a.numero,participantes:a.participantes_count}))))}catch(a){console.error("Erro ao carregar editais:",a),this.$swal.fire("Erro","Erro ao carregar editais","error")}finally{this.loadingEditais=!1}},aplicarFiltrosEditais(){let a=[...this.editais];if(this.filtroEditais.busca){const t=this.filtroEditais.busca.toLowerCase();a=a.filter((a=>a.numero.toLowerCase().includes(t)||a.descricao.toLowerCase().includes(t)))}this.filtroEditais.status&&(a=a.filter((a=>a.status===this.filtroEditais.status))),this.editaisFiltrados=a},async abrirModalNovoEdital(){await this.carregarMinutasDisponiveis(),this.minutaSelecionada=null,this.modalNovoEdital=!0},fecharModalNovoEdital(){this.modalNovoEdital=!1,this.minutaSelecionada=null},limparEstadoModal(){this.minutaSelecionada=null,this.criandoEdital=!1},async processarCriacaoEdital(){const a=this.minutaSelecionada;a?await this.criarEditalComMinuta(a):this.$swal.fire("Aten√ß√£o","Selecione uma minuta padr√£o para continuar","warning")},async carregarMinutasDisponiveis(){try{await this.verificarMinutaPadraoSistema();const{data:a,error:t}=await R.ND.from("minutas_padrao").select("*").eq("ativa",!0).order("eh_padrao_sistema",{ascending:!1}).order("nome",{ascending:!0});if(t)throw t;this.minutasDisponiveis=a||[]}catch(a){console.error("Erro ao carregar minutas:",a),this.$swal.fire("Erro","Erro ao carregar minutas padr√£o: "+a.message,"error")}},async verificarMinutaPadraoSistema(){try{const{data:a}=await R.ND.from("minutas_padrao").select("id, arquivo_url").eq("eh_padrao_sistema",!0).single();if(a){const{data:a}=await R.ND.storage.from("minutas-padrao").list("sistema/"),t=a?.some((a=>"MINUTA_PADRAO.docx"===a.name));t||await this.criarMinutaPadraoSistema()}else await this.criarMinutaPadraoSistema()}catch(a){console.warn("Aviso: N√£o foi poss√≠vel verificar minuta padr√£o do sistema:",a)}},async criarMinutaPadraoSistema(){try{const a=await fetch("/MINUTA_PADRAO.docx");if(!a.ok)return void console.warn("Arquivo MINUTA_PADRAO.docx n√£o encontrado localmente");const t=await a.blob(),o="MINUTA_PADRAO.docx",e=`sistema/${o}`,{data:i,error:s}=await R.ND.storage.from("minutas-padrao").upload(e,t,{cacheControl:"3600",upsert:!0});if(s)throw s;const{data:r}=R.ND.storage.from("minutas-padrao").getPublicUrl(e),{error:n}=await R.ND.from("minutas_padrao").upsert({nome:"Minuta-Padr√£o do Sistema",descricao:"Minuta-padr√£o oficial institu√≠da com o aux√≠lio dos √≥rg√£os de assessoramento jur√≠dico e de controle interno",arquivo_nome:o,arquivo_url:r.publicUrl,categoria:"SISTEMA",eh_padrao_sistema:!0,ativa:!0,criado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()});if(n)throw n;console.log("Minuta padr√£o do sistema configurada com sucesso")}catch(a){console.error("Erro ao criar minuta padr√£o do sistema:",a)}},selecionarMinuta(a){this.minutaSelecionada=a.id},async criarEditalComMinuta(a=null){try{this.criandoEdital=!0;const t=a||this.minutaSelecionada;if(!t)return void this.$swal.fire("Aten√ß√£o","Selecione uma minuta padr√£o para continuar","warning");if(!this.currentTenantId)throw new Error("Tenant ID n√£o dispon√≠vel");this.fecharModalNovoEdital(),await new Promise((a=>setTimeout(a,100)));const{value:o}=await this.$swal.fire({title:"N√∫mero do Edital",html:`\n              <label for="numero-edital"><strong>N√∫mero do Edital:</strong></label>\n              <input \n                id="numero-edital" \n                class="swal2-input" \n                placeholder="Ex: 001/2024"\n                value="${await this.gerarProximoNumeroEdital()}"\n              >\n              <small style="color: #666; font-size: 12px;">\n                Formato sugerido: 001/2024, 002/2024...\n              </small>\n            `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Criar Edital",cancelButtonText:"Cancelar",customClass:{popup:"swal2-popup-edital"},preConfirm:()=>{const a=document.getElementById("numero-edital").value;return a&&""!==a.trim()?a.trim():(this.$swal.showValidationMessage("N√∫mero do edital √© obrigat√≥rio"),!1)}});if(!o)return void(this.modalNovoEdital=!0);const{data:e}=await R.ND.from("editais").select("id").eq("tenant_id",this.currentTenantId).eq("numero",o).single();if(e)return this.$swal.fire("Erro",`J√° existe um edital com o n√∫mero "${o}". Por favor, escolha outro n√∫mero.`,"error"),void(this.modalNovoEdital=!0);const i={tenant_id:this.currentTenantId,numero:o,descricao:"Edital em elabora√ß√£o",status:"RASCUNHO",minuta_usada_id:t,criado_em:(new Date).toISOString()},{data:s,error:r}=await R.ND.from("editais").insert(i).select().single();if(r)throw r;await R.ND.from("minuta_uso_historico").insert({minuta_id:t,edital_id:s.id,usuario_id:this.currentTenantId,observacoes:"Edital criado com minuta padr√£o"}),await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Edital Criado!",text:`Edital ${o} criado com sucesso em elabora√ß√£o.`,timer:2e3})}catch(t){console.error("Erro ao criar edital:",t),this.$swal.fire("Erro","Erro ao criar edital: "+t.message,"error")}finally{this.criandoEdital=!1}},async gerarProximoNumeroEdital(){try{const a=(new Date).getFullYear(),{data:t,error:o}=await R.ND.from("editais").select("numero").eq("tenant_id",this.currentTenantId).like("numero",`%/${a}`).order("numero",{ascending:!1}).limit(1);if(o)throw o;let e=1;if(t&&t.length>0){const a=t[0].numero,o=parseInt(a.split("/")[0]);e=o+1}return String(e).padStart(3,"0")+"/"+a}catch(a){return console.error("Erro ao gerar n√∫mero:",a),"001/"+(new Date).getFullYear()}},abrirModalAddMinuta(){this.novaMinuta={nome:"",categoria:"geral",descricao:"",arquivo:null},this.modalAddMinuta=!0},fecharModalAddMinuta(){this.modalAddMinuta=!1,this.novaMinuta={nome:"",categoria:"geral",descricao:"",arquivo:null}},handleMinutaUpload(a){const t=a.target.files[0];if(t){const o=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];if(!o.includes(t.type))return this.$swal.fire("Erro","Por favor, selecione um arquivo Word (.docx ou .doc)","error"),void(a.target.value="");if(t.size>10485760)return this.$swal.fire("Erro","O arquivo deve ter no m√°ximo 10MB","error"),void(a.target.value="");this.novaMinuta.arquivo=t}},async salvarNovaMinuta(){try{if(this.salvandoMinuta=!0,!this.novaMinuta.arquivo)return void this.$swal.fire("Aten√ß√£o","Selecione um arquivo Word para a minuta","warning");const a=`minutas/${Date.now()}-${this.novaMinuta.arquivo.name}`,{data:t,error:o}=await R.ND.storage.from("documentos").upload(a,this.novaMinuta.arquivo);if(o)throw o;const{data:e}=R.ND.storage.from("documentos").getPublicUrl(a),{data:i,error:s}=await R.ND.from("minutas_padrao").insert({nome:this.novaMinuta.nome,categoria:this.novaMinuta.categoria,descricao:this.novaMinuta.descricao,arquivo_nome:this.novaMinuta.arquivo.name,arquivo_url:e.publicUrl,tipo_arquivo:this.novaMinuta.arquivo.name.split(".").pop(),criado_por:this.currentTenantId,eh_padrao_sistema:!1});if(s)throw s;await this.carregarMinutasDisponiveis(),this.fecharModalAddMinuta(),this.$swal.fire({icon:"success",title:"Minuta Adicionada!",text:`Minuta "${this.novaMinuta.nome}" adicionada com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar minuta:",a),this.$swal.fire("Erro","Erro ao salvar minuta: "+a.message,"error")}finally{this.salvandoMinuta=!1}},async baixarMinutaPadrao(a){try{const{data:t,error:o}=await R.ND.from("minutas_padrao").select("*").eq("id",a.minuta_usada_id).single();if(o)throw o;if(t.arquivo_url){const a=await fetch(t.arquivo_url),o=await a.blob(),e=window.URL.createObjectURL(o),i=document.createElement("a");i.href=e,i.download=t.arquivo_nome||"minuta_padrao.docx",document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(e),document.body.removeChild(i)}else{const a=document.createElement("a");a.href="/DOCUMENTOS ESCRITOS/MINUTA PADRAO.docx",a.download="MINUTA PADRAO.docx",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}catch(t){console.error("Erro ao baixar minuta:",t),this.$swal.fire("Erro","Erro ao baixar minuta padr√£o","error")}},async handleMinutaPreenchidaUpload(a){try{const t=a.target.files[0];if(!t)return;const o=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];if(!o.includes(t.type))return void this.$swal.fire("Erro","Por favor, selecione um arquivo Word (.docx ou .doc)","error");if(t.size>15728640)return void this.$swal.fire("Erro","O arquivo deve ter no m√°ximo 15MB","error");const e=`editais/preenchidas/${Date.now()}-${t.name}`,{data:i,error:s}=await R.ND.storage.from("documentos").upload(e,t);if(s)throw s;const{data:r}=R.ND.storage.from("documentos").getPublicUrl(e),{error:n}=await R.ND.from("editais").update({minuta_preenchida_url:r.publicUrl,minuta_preenchida_nome:t.name}).eq("id",this.editalSelecionado.id);if(n)throw n;this.editalSelecionado.minuta_preenchida_url=r.publicUrl,this.editalSelecionado.minuta_preenchida_nome=t.name,await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Minuta Enviada!",text:"Minuta preenchida enviada com sucesso.",timer:2e3})}catch(t){console.error("Erro ao enviar minuta:",t),this.$swal.fire("Erro","Erro ao enviar minuta preenchida: "+t.message,"error")}},visualizarMinutaPreenchida(a){a.minuta_preenchida_url&&window.open(a.minuta_preenchida_url,"_blank")},async processarConversaoPDF(a){const t={...a};await this.converterParaPDF(t)},async gerarPDFEdital(a){try{console.log("üìÑ Gerando PDF do edital:",a.numero);const t=(await Promise.resolve().then(o.bind(o,1749))).jsPDF||(await Promise.resolve().then(o.bind(o,1749))).default,{data:e}=await R.ND.from("minutas_padrao").select("*").eq("id",a.minuta_usada_id).single(),i=new t("portrait","mm","a4"),s=i.internal.pageSize.getWidth(),r=i.internal.pageSize.getHeight(),n=20;let l=n;i.setFontSize(16),i.setFont("helvetica","bold"),i.text("REP√öBLICA FEDERATIVA DO BRASIL",s/2,l,{align:"center"}),l+=8,i.setFontSize(14),i.text("MINIST√âRIO DA SA√öDE",s/2,l,{align:"center"}),l+=6,i.setFontSize(12),i.setFont("helvetica","normal"),i.text("Comiss√£o de Padroniza√ß√£o de Materiais - CPM",s/2,l,{align:"center"}),l+=15,i.setDrawColor(0,0,0),i.setLineWidth(.5),i.line(n,l,s-n,l),l+=15,i.setFontSize(18),i.setFont("helvetica","bold");const c=`EDITAL DE PREG√ÉO ELETR√îNICO N¬∫ ${a.numero}`;i.text(c,s/2,l,{align:"center"}),l+=15,i.setFontSize(14),i.setFont("helvetica","normal"),i.text(a.descricao||"Edital de Pr√©-qualifica√ß√£o de Materiais",s/2,l,{align:"center"}),l+=25,i.setFontSize(12),i.setFont("helvetica","bold"),i.text("DADOS DO PROCEDIMENTO",n,l),l+=10,i.setDrawColor(200,200,200),i.setFillColor(250,250,250),i.rect(n,l,s-2*n,35,"FD"),l+=10,i.setFontSize(11),i.setFont("helvetica","normal"),i.text(`N√∫mero do Edital: ${a.numero}`,n+5,l),l+=6,i.text(`Status: ${a.status}`,n+5,l),l+=6,i.text(`Data de Publica√ß√£o: ${this.formatDate(a.data_publicacao||new Date)}`,n+5,l),l+=6,i.text(`Prazo para Impugna√ß√µes: ${this.formatDate(a.data_limite_impugnacao||new Date)}`,n+5,l),l+=25,i.setFontSize(12),i.setFont("helvetica","bold"),i.text("OBJETO",n,l),l+=10,i.setFontSize(11),i.setFont("helvetica","normal");const d="Processo de pr√©-qualifica√ß√£o de materiais para aquisi√ß√£o futura, conforme especifica√ß√µes t√©cnicas definidas pela Comiss√£o de Padroniza√ß√£o de Materiais - CPM.",u=i.splitTextToSize(d,s-2*n);if(i.text(u,n,l),l+=6*u.length+15,e){if(i.setFontSize(12),i.setFont("helvetica","bold"),i.text("MINUTA PADR√ÉO UTILIZADA",n,l),l+=10,i.setFontSize(11),i.setFont("helvetica","normal"),i.text(`Nome: ${e.nome}`,n,l),l+=6,i.text(`Categoria: ${e.categoria||"Geral"}`,n,l),l+=6,e.descricao){const a=i.splitTextToSize(`Descri√ß√£o: ${e.descricao}`,s-2*n);i.text(a,n,l),l+=6*a.length}l+=15}i.setFontSize(12),i.setFont("helvetica","bold"),i.text("CONDI√á√ïES GERAIS",n,l),l+=10,i.setFontSize(11),i.setFont("helvetica","normal");const m=["1. Este edital visa a pr√©-qualifica√ß√£o de materiais conforme normas vigentes.","2. Os fornecedores interessados dever√£o apresentar documenta√ß√£o completa.","3. A avalia√ß√£o ser√° realizada pela Comiss√£o de Padroniza√ß√£o de Materiais.","4. Os materiais aprovados receber√£o Declara√ß√£o de Conformidade de Bem (DCB).","5. O processo poder√° ser impugnado no prazo estabelecido.","6. Maiores informa√ß√µes no Sistema ComprarBem."];m.forEach((a=>{const t=i.splitTextToSize(a,s-2*n-5);i.text(t,n,l),l+=6*t.length+3})),l=Math.max(l+30,r-120);const p=new Date;i.text(`Bras√≠lia, ${p.getDate().toString().padStart(2,"0")} de ${p.toLocaleDateString("pt-BR",{month:"long"})} de ${p.getFullYear()}`,n,l),l+=20,i.setDrawColor(0,0,0),i.setLineWidth(.5),i.line(n,l,s/2-10,l),l+=8,i.setFontSize(10),i.text("Presidente da Comiss√£o de Padroniza√ß√£o de Materiais",n,l),l+=4,i.text("CPM - Minist√©rio da Sa√∫de",n,l),i.setFontSize(8),i.setTextColor(100,100,100);const v=`Este documento foi gerado eletronicamente pelo Sistema ComprarBem em ${p.toLocaleString("pt-BR")}`;i.text(v,s/2,r-10,{align:"center"});const g=`Edital_${a.numero.replace("/","_")}_${p.getFullYear()}.pdf`,_=i.output("blob");console.log("üì§ Fazendo upload do PDF para Supabase...");const f=`editais-pdf/${this.currentTenantId}/${g}`,{data:h,error:C}=await R.ND.storage.from("documentos").upload(f,_,{cacheControl:"3600",upsert:!0,contentType:"application/pdf"});if(C)throw C;const{data:b}=R.ND.storage.from("documentos").getPublicUrl(f);return console.log("‚úÖ PDF gerado e enviado com sucesso:",b.publicUrl),{url:b.publicUrl,nome:g,caminho:f}}catch(t){console.error("‚ùå Erro ao gerar PDF do edital:",t),this.$swal&&this.$swal.close&&this.$swal.close();let a="N√£o foi poss√≠vel gerar o PDF do edital.";throw t.message.includes("storage")?a="Erro no armazenamento do arquivo. Verifique as permiss√µes.":t.message.includes("network")||t.message.includes("fetch")?a="Erro de conex√£o. Verifique sua internet e tente novamente.":t.message.includes("jsPDF")&&(a="Erro na gera√ß√£o do PDF. Tente novamente."),new Error(a+" Detalhes: "+t.message)}},async converterWordParaPDF(a){try{console.log("üìÑ Convertendo minuta Word para PDF (MODO VISUAL):",a.minuta_preenchida_url);const{convertWordToPdf:t}=await o.e(130).then(o.bind(o,4130)),e=a.minuta_preenchida_nome?.replace(/\.(docx?|doc)$/i,"")||"Minuta";console.log("üîÑ Iniciando convers√£o visual...");const i=await t(a.minuta_preenchida_url,e);console.log("‚úÖ Convers√£o conclu√≠da:",i.fileName),console.log("üì§ Fazendo upload do PDF convertido para Supabase...");const s=`editais-pdf/${this.currentTenantId}/${i.fileName}`,{data:r,error:n}=await R.ND.storage.from("documentos").upload(s,i.blob,{cacheControl:"3600",upsert:!0,contentType:"application/pdf"});if(n)throw n;const{data:l}=R.ND.storage.from("documentos").getPublicUrl(s);return console.log("üéâ PDF CONVERTIDO COM SUCESSO (MODO VISUAL)!"),console.log("üìÑ URL:",l.publicUrl),{url:l.publicUrl,nome:i.fileName,caminho:s}}catch(t){throw console.error("‚ùå Erro ao converter Word para PDF:",t),t}},async converterParaPDF(a){try{this.fecharModalVisualizarEdital(),await new Promise((a=>setTimeout(a,100)));const t=a.minuta_preenchida_url&&""!==a.minuta_preenchida_url.trim(),o=await this.$swal.fire({title:"Confirmar Convers√£o",html:`\n              <div style="text-align: left;">\n                <p><strong>Aten√ß√£o:</strong> Esta a√ß√£o ir√°:</p>\n                <ul>\n                  ${t?`<li>Converter sua minuta Word preenchida para PDF</li>\n                       <li>Arquivo: ${a.minuta_preenchida_nome||"Minuta preenchida"}</li>`:"<li>Gerar PDF oficial com base nos dados do edital</li>"}\n                  <li>Marcar o edital como PUBLICADO</li>\n                  <li>Tornar o edital dispon√≠vel para consulta</li>\n                </ul>\n                <p><strong>${t?"Tem certeza que a minuta preenchida est√° pronta para publica√ß√£o?":"Tem certeza que o edital est√° pronto para publica√ß√£o?"}</strong></p>\n              </div>\n            `,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, Converter e Publicar",cancelButtonText:"Cancelar",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",customClass:{popup:"swal2-popup-converter-pdf"}});if(!o.isConfirmed)return void(this.modalVisualizarEdital=!0);let e;console.log("üîÑ Iniciando convers√£o real para PDF..."),this.$swal.fire({title:"Convertendo para PDF...",text:t?"Aguarde enquanto convertemos sua minuta Word para PDF":"Aguarde enquanto geramos o PDF do edital",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}}),t?(console.log("üìÑ Convertendo minuta Word carregada pelo usu√°rio..."),e=await this.converterWordParaPDF(a)):(console.log("üìÑ Gerando PDF com dados do edital..."),e=await this.gerarPDFEdital(a));const i=new Date,s=i.toISOString(),r=new Date(i.getTime()+2592e6).toISOString(),{error:n}=await R.ND.from("editais").update({status:"PUBLICADO",data_publicacao:s,data_limite_impugnacao:r,pdf_convertido_url:e.url,pdf_convertido_nome:e.nome}).eq("id",a.id);if(n)throw n;this.$swal.close(),this.editalSelecionado.status="PUBLICADO",this.editalSelecionado.data_publicacao=s,this.editalSelecionado.data_limite_impugnacao=r,this.editalSelecionado.pdf_convertido_url=e.url,this.editalSelecionado.pdf_convertido_nome=e.nome,await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Edital Publicado!",html:`\n              <div style="text-align: left; padding: 10px;">\n                <p><strong>üìã Edital:</strong> ${a.numero}</p>\n                <p><strong>üìÑ PDF:</strong> ${e.nome}</p>\n                <p><strong>üìÖ Publicado em:</strong> ${this.formatDate(s)}</p>\n                <hr style="margin: 15px 0;">\n                <p style="color: #28a745; font-weight: bold;">\n                  ${t?"‚úÖ Minuta Word convertida para PDF oficial<br>üìù Conte√∫do baseado na minuta preenchida enviada":"‚úÖ PDF oficial gerado automaticamente<br>üìÑ Conte√∫do baseado nos dados do edital"}<br>\n                  üì• Use o bot√£o "Abrir PDF" para visualizar\n                </p>\n              </div>\n            `,showConfirmButton:!0,confirmButtonText:"üì• Abrir PDF Agora",showCancelButton:!0,cancelButtonText:"Fechar",confirmButtonColor:"#28a745"}).then((a=>{a.isConfirmed&&window.open(e.url,"_blank")}))}catch(t){console.error("‚ùå Erro ao converter para PDF:",t),this.$swal&&this.$swal.close&&this.$swal.close(),this.$swal.fire({icon:"error",title:"Erro na Convers√£o para PDF",html:`\n              <div style="text-align: left;">\n                <p><strong>N√£o foi poss√≠vel converter o edital para PDF.</strong></p>\n                <p><strong>Erro:</strong> ${t.message}</p>\n                <hr>\n                <p><strong>O que fazer:</strong></p>\n                <ul>\n                  <li>Verifique sua conex√£o com a internet</li>\n                  <li>Tente novamente em alguns minutos</li>\n                  <li>Se o problema persistir, contate o suporte</li>\n                </ul>\n                <p style="color: #666; font-size: 12px; margin-top: 15px;">\n                  üí° <strong>Dica:</strong> O edital continuar√° como "RASCUNHO" at√© a convers√£o ser bem-sucedida.\n                </p>\n              </div>\n            `,confirmButtonText:"Entendi",confirmButtonColor:"#dc3545"}),setTimeout((()=>{this.modalVisualizarEdital=!0}),500)}},validarDatas(){if(!this.editalAtual.data_publicacao)return this.$swal.fire("Erro","Data de publica√ß√£o √© obrigat√≥ria","error"),!1;if(!this.editalAtual.data_limite_impugnacao)return this.$swal.fire("Erro","Prazo para impugna√ß√µes √© obrigat√≥rio","error"),!1;const a=new Date(this.editalAtual.data_publicacao),t=new Date(this.editalAtual.data_limite_impugnacao);if(t<=a)return this.$swal.fire({icon:"error",title:"Erro de Data",html:`\n              <p><strong>O prazo para impugna√ß√µes deve ser posterior √† data de publica√ß√£o!</strong></p>\n              <br>\n              <p><strong>Data de Publica√ß√£o:</strong> ${this.formatDate(a)}</p>\n              <p><strong>Prazo para Impugna√ß√µes:</strong> ${this.formatDate(t)}</p>\n              <br>\n              <p>Por favor, ajuste as datas e tente novamente.</p>\n            `,confirmButtonText:"Entendi"}),!1;const o=new Date(a);if(o.setFullYear(o.getFullYear()+1),t>o){const a=this.$swal.fire({icon:"warning",title:"Prazo muito distante",text:"O prazo para impugna√ß√µes est√° mais de 1 ano ap√≥s a publica√ß√£o. Tem certeza?",showCancelButton:!0,confirmButtonText:"Sim, continuar",cancelButtonText:"Cancelar"});if(!a.isConfirmed)return!1}return!0},validarDataLimite(){if(!this.editalAtual.data_publicacao||!this.editalAtual.data_limite_impugnacao)return;const a=new Date(this.editalAtual.data_publicacao),t=new Date(this.editalAtual.data_limite_impugnacao);t<=a&&(this.$swal.fire({icon:"warning",title:"Aten√ß√£o!",text:"O prazo para impugna√ß√µes deve ser posterior √† data de publica√ß√£o.",timer:3e3,toast:!0,position:"top-end",showConfirmButton:!1}),this.editalAtual.data_limite_impugnacao="")},async salvarEdital(){try{if(this.salvandoEdital=!0,!this.currentTenantId)throw new Error("Tenant ID n√£o dispon√≠vel");if(!this.validarDatas())return;const a={tenant_id:this.currentTenantId,numero:this.editalAtual.numero,descricao:this.editalAtual.descricao,conteudo:this.editalAtual.conteudo,status:this.editalAtual.status,data_publicacao:this.editalAtual.data_publicacao||(new Date).toISOString(),data_limite_impugnacao:this.editalAtual.data_limite_impugnacao,url_documento:this.editalAtual.url_documento,nome_arquivo:this.editalAtual.nome_arquivo};let t;if(this.modoEdicaoEdital){const{data:o,error:e}=await R.ND.from("editais").update(a).eq("id",this.editalAtual.id).select().single();t={data:o,error:e}}else{const{data:o,error:e}=await R.ND.from("editais").insert(a).select().single();t={data:o,error:e}}if(t.error)throw t.error;await this.carregarEditais(),this.fecharModalNovoEdital(),this.$swal.fire({icon:"success",title:this.modoEdicaoEdital?"Edital Atualizado!":"Edital Criado!",text:`Edital ${this.editalAtual.numero} ${this.modoEdicaoEdital?"atualizado":"criado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar edital:",a),this.$swal.fire("Erro","Erro ao salvar edital: "+a.message,"error")}finally{this.salvandoEdital=!1}},visualizarEdital(a){this.editalSelecionado={...a},this.modalVisualizarEdital=!0},fecharModalVisualizarEdital(){this.modalVisualizarEdital=!1,this.editalSelecionado={}},editarEdital(a){this.editalEditando={id:a.id,numero:a.numero,descricao:a.descricao,conteudo:a.conteudo||"",status:a.status,data_publicacao:a.data_publicacao?new Date(a.data_publicacao).toISOString().slice(0,16):"",data_limite_impugnacao:a.data_limite_impugnacao?new Date(a.data_limite_impugnacao).toISOString().slice(0,16):""},this.modalEditarEdital=!0},editarEditalSelecionado(){this.fecharModalVisualizarEdital(),this.editarEdital(this.editalSelecionado)},fecharModalEditarEdital(){this.modalEditarEdital=!1,this.editalEditando={id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:""}},async salvarEdicaoEdital(){if(this.editalEditando.numero&&this.editalEditando.descricao){this.salvandoEdicaoEdital=!0;try{const{data:a}=await R.ND.from("editais").select("id").eq("numero",this.editalEditando.numero).eq("tenant_id",this.currentTenantId).neq("id",this.editalEditando.id).single();if(a)return void this.$swal.fire("Erro",`J√° existe outro edital com o n√∫mero "${this.editalEditando.numero}". Por favor, escolha outro n√∫mero.`,"error");const{error:t}=await R.ND.from("editais").update({numero:this.editalEditando.numero,descricao:this.editalEditando.descricao,conteudo:this.editalEditando.conteudo,data_publicacao:this.editalEditando.data_publicacao||null,data_limite_impugnacao:this.editalEditando.data_limite_impugnacao||null,updated_at:(new Date).toISOString()}).eq("id",this.editalEditando.id).eq("tenant_id",this.currentTenantId);if(t)throw t;this.$swal.fire({icon:"success",title:"Edital Atualizado!",text:`Edital "${this.editalEditando.numero}" atualizado com sucesso.`,timer:2e3,showConfirmButton:!1}),await this.carregarEditais(),this.fecharModalEditarEdital()}catch(a){console.error("Erro ao salvar edital:",a),this.$swal.fire("Erro","N√£o foi poss√≠vel salvar as altera√ß√µes. Tente novamente.","error")}finally{this.salvandoEdicaoEdital=!1}}else this.$swal.fire("Erro","N√∫mero e descri√ß√£o s√£o obrigat√≥rios","error")},getStatusText(a){const t={RASCUNHO:"Em Elabora√ß√£o",PUBLICADO:"Publicado",CANCELADO:"Cancelado",INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"Documenta√ß√£o Enviada",EM_AVALIACAO:"Em Avalia√ß√£o",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return t[a]||a},async duplicarEdital(a){try{const t=await this.$swal.fire({title:"Duplicar Edital",text:"Digite o n√∫mero do novo edital:",input:"text",inputValue:"",inputPlaceholder:"Ex: 002/2024",showCancelButton:!0,confirmButtonText:"Duplicar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"Voc√™ precisa inserir um n√∫mero!"}});if(t.isConfirmed){const o=t.value,e={tenant_id:this.currentTenantId,numero:o,descricao:a.descricao+" (C√≥pia)",conteudo:a.conteudo,status:"RASCUNHO",data_publicacao:(new Date).toISOString(),data_limite_impugnacao:a.data_limite_impugnacao},{error:i}=await R.ND.from("editais").insert(e);if(i)throw i;await this.carregarEditais(),this.$swal.fire("Sucesso!",`Edital ${o} criado com sucesso.`,"success")}}catch(t){console.error("Erro ao duplicar edital:",t),this.$swal.fire("Erro","Erro ao duplicar edital","error")}},async cancelarEdital(a){try{const t=await this.$swal.fire({title:"Cancelar Edital",text:`Tem certeza que deseja cancelar o edital ${a.numero}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, cancelar",cancelButtonText:"N√£o",confirmButtonColor:"#d33"});if(t.isConfirmed){const{error:t}=await R.ND.from("editais").update({status:"CANCELADO"}).eq("id",a.id);if(t)throw t;await this.carregarEditais(),this.$swal.fire("Cancelado!",`Edital ${a.numero} foi cancelado.`,"success")}}catch(t){console.error("Erro ao cancelar edital:",t),this.$swal.fire("Erro","Erro ao cancelar edital","error")}},gerenciarParticipantes(a){console.log("Abrindo modal de participantes para:",a.numero),this.criarModalParticipantes(a)},async criarModalParticipantes(a){const{data:t,error:e}=await R.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a.id).order("data_participacao",{ascending:!1});if(e)return console.error("Erro ao carregar participantes:",e),void this.$swal.fire("Erro","Erro ao carregar participantes","error");console.log("Participantes carregados:",t);const i=`\n          <div id="modal-participantes-custom" style="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            background: rgba(0,0,0,0.8);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 999999;\n          ">\n            <div style="\n              background: white;\n              border-radius: 12px;\n              width: 90%;\n              max-width: 1000px;\n              max-height: 80vh;\n              overflow-y: auto;\n              box-shadow: 0 10px 30px rgba(0,0,0,0.5);\n            ">\n              <div style="\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 20px 25px;\n                border-bottom: 1px solid #eee;\n                background: #f8f9fa;\n                border-radius: 12px 12px 0 0;\n              ">\n                <h3 style="margin: 0; color: #2c3e50;">üë• Participantes - ${a.numero}</h3>\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  background: none;\n                  border: none;\n                  font-size: 24px;\n                  cursor: pointer;\n                  color: #6c757d;\n                  width: 30px;\n                  height: 30px;\n                  border-radius: 50%;\n                ">&times;</button>\n              </div>\n              \n              <div style="padding: 25px;">\n                <div style="margin-bottom: 20px;">\n                  <h4>üìä Total de Participantes: ${t.length}</h4>\n                </div>\n                \n                ${t.length>0?`\n                  <div style="display: grid; gap: 15px;">\n                    ${t.map((a=>`\n                      <div style="\n                        border: 1px solid #ddd;\n                        border-radius: 8px;\n                        padding: 20px;\n                        background: #f9f9f9;\n                      ">\n                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">\n                          <h4 style="margin: 0; color: #2c3e50;">${a.razao_social}</h4>\n                          <span style="\n                            padding: 4px 12px;\n                            border-radius: 20px;\n                            font-size: 12px;\n                            font-weight: 600;\n                            background: ${this.getStatusColor(a.status)};\n                            color: white;\n                          ">${this.getStatusText(a.status)}</span>\n                        </div>\n                        \n                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 15px;">\n                          <p style="margin: 5px 0;"><strong>CNPJ:</strong> ${this.formatarCNPJSimples(a.cnpj)}</p>\n                          <p style="margin: 5px 0;"><strong>Representante:</strong> ${a.representante_legal}</p>\n                          <p style="margin: 5px 0;"><strong>Email:</strong> ${a.email}</p>\n                          <p style="margin: 5px 0;"><strong>Telefone:</strong> ${a.telefone||"N/A"}</p>\n                          <p style="margin: 5px 0;"><strong>Data Inscri√ß√£o:</strong> ${this.formatDateSimples(a.data_participacao)}</p>\n                          ${a.data_envio_documentacao?`<p style="margin: 5px 0;"><strong>Data Documenta√ß√£o:</strong> ${this.formatDateSimples(a.data_envio_documentacao)}</p>`:""}\n                        </div>\n                        \n                        ${a.endereco?`\n                          <div style="margin-bottom: 15px;">\n                            <p style="margin: 5px 0;"><strong>üìç Endere√ßo:</strong> ${a.endereco}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.observacoes?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #fff3cd;\n                            border: 1px solid #ffeaa7;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #856404;">üí¨ Observa√ß√µes da Empresa:</p>\n                            <p style="margin: 8px 0 0 0; color: #856404;">${a.observacoes}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.produtos_submetidos&&a.produtos_submetidos.length>0?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #d1ecf1;\n                            border: 1px solid #bee5eb;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #0c5460;">üì¶ Produtos Submetidos:</p>\n                            <ul style="margin: 8px 0 0 20px; color: #0c5460;">\n                              ${a.produtos_submetidos.map((a=>`<li>${a.nome||a}</li>`)).join("")}\n                            </ul>\n                          </div>\n                        `:""}\n                        \n                        <div style="margin-top: 15px;">\n                          <div style="display: flex; gap: 10px; margin-bottom: 10px;">\n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'APROVADO')" style="\n                              padding: 8px 16px;\n                              background: #28a745;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">‚úÖ Aprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'REPROVADO')" style="\n                              padding: 8px 16px;\n                              background: #dc3545;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">‚ùå Reprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'EM_AVALIACAO')" style="\n                              padding: 8px 16px;\n                              background: #ffc107;\n                              color: #212529;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">üîÑ Em Avalia√ß√£o</button>\n                            \n                            <button onclick="window.adicionarObservacaoInterna('${a.id}')" style="\n                              padding: 8px 16px;\n                              background: #6f42c1;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">üìù Adicionar Observa√ß√£o</button>\n                          </div>\n                          \n                          ${a.observacoes_internas?`\n                            <div style="\n                              padding: 12px;\n                              background: #e9ecef;\n                              border: 1px solid #ced4da;\n                              border-radius: 6px;\n                              margin-top: 10px;\n                            ">\n                              <p style="margin: 0; font-weight: 600; color: #495057;">üîí Observa√ß√µes Internas da CPM:</p>\n                              <p style="margin: 8px 0 0 0; color: #495057; font-style: italic;">${a.observacoes_internas}</p>\n                            </div>\n                          `:""}\n                        </div>\n                      </div>\n                    `)).join("")}\n                  </div>\n                `:'\n                  <div style="text-align: center; padding: 40px; color: #6c757d;">\n                    <div style="font-size: 48px; margin-bottom: 20px;">üë•</div>\n                    <h3>Nenhum participante encontrado</h3>\n                    <p>Ainda n√£o h√° empresas inscritas neste edital.</p>\n                  </div>\n                '}\n              </div>\n              \n              <div style="\n                padding: 20px 25px;\n                border-top: 1px solid #eee;\n                display: flex;\n                justify-content: flex-end;\n              ">\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  padding: 10px 20px;\n                  background: #6c757d;\n                  color: white;\n                  border: none;\n                  border-radius: 6px;\n                  cursor: pointer;\n                ">Fechar</button>\n              </div>\n            </div>\n          </div>\n        `;document.body.insertAdjacentHTML("beforeend",i),window.alterarStatusParticipante=async(t,i)=>{try{const{data:e,error:r}=await R.ND.from("participantes_editais").select("*").eq("id",t).single();if(r)throw r;const{error:n}=await R.ND.from("participantes_editais").update({status:i}).eq("id",t);if(n)throw n;let l=null;if("APROVADO"===i||"REPROVADO"===i)try{const{enviarEmailParticipanteStatus:t}=await Promise.resolve().then(o.bind(o,3405));if("REPROVADO"===i){document.getElementById("modal-participantes-custom").remove(),await new Promise((a=>setTimeout(a,100)));const a=await this.$swal.fire({title:"‚ùå Motivo da Reprova√ß√£o",text:"Informe o motivo da reprova√ß√£o (ser√° enviado por email):",input:"textarea",inputPlaceholder:"Ex: Documenta√ß√£o incompleta, dados inconsistentes, etc.",showCancelButton:!0,confirmButtonText:"Enviar Email",cancelButtonText:"Pular Email",inputValidator:a=>{if(!a)return"Por favor, informe o motivo da reprova√ß√£o!"},heightAuto:!1,backdrop:!0,allowOutsideClick:!1});a.isConfirmed?l=a.value:(console.log("üìß Usu√°rio cancelou envio de email de reprova√ß√£o"),l=null)}if("APROVADO"===i||"REPROVADO"===i&&l){const o="APROVADO"===i?"aprovado":"rejeitado";console.log(`üìß Enviando email de ${o} para:`,e.email),await t(e,a,o,l),console.log(`‚úÖ Email de ${o} enviado com sucesso!`)}else"REPROVADO"!==i||l||console.log("üìß Email de reprova√ß√£o n√£o enviado (usu√°rio cancelou)")}catch(s){console.warn(`‚ö†Ô∏è Erro ao enviar email de ${i.toLowerCase()}:`,s)}const c=document.getElementById("modal-participantes-custom");c&&c.remove();let d=`Status alterado para ${this.getStatusText(i)}`;if("APROVADO"===i)d+="\nüìß Email de aprova√ß√£o enviado automaticamente!";else if("REPROVADO"===i){const a=null!==l;d+=a?"\nüìß Email de reprova√ß√£o enviado automaticamente!":"\nüìß Email de reprova√ß√£o n√£o foi enviado"}this.$swal.fire({icon:"success",title:"Sucesso!",text:d,timer:"APROVADO"===i||"REPROVADO"===i?4e3:2e3}),await this.carregarEditais(),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}catch(e){console.error("Erro ao alterar status:",e);const o=document.getElementById("modal-participantes-custom");o&&o.remove(),this.$swal.fire({icon:"error",title:"Erro",text:"Erro ao alterar status do participante"}),setTimeout((()=>{this.criarModalParticipantes(a)}),2e3)}},window.adicionarObservacaoInterna=async t=>{try{document.getElementById("modal-participantes-custom").remove(),await new Promise((a=>setTimeout(a,100)));const o=await this.$swal.fire({title:"Observa√ß√£o Interna da CPM",text:"Esta observa√ß√£o ser√° vis√≠vel apenas para a equipe da CPM",input:"textarea",inputPlaceholder:"Digite suas observa√ß√µes sobre a an√°lise deste participante...",showCancelButton:!0,confirmButtonText:"Salvar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"Voc√™ precisa inserir uma observa√ß√£o!"}});if(o.isConfirmed){const e=o.value,{error:i}=await R.ND.from("participantes_editais").update({observacoes_internas:e}).eq("id",t);if(i)throw i;this.$swal.fire({icon:"success",title:"Sucesso!",text:"Observa√ß√£o interna adicionada com sucesso"}),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}}catch(e){console.error("Erro ao adicionar observa√ß√£o:",e),this.$swal.fire({icon:"error",title:"Erro",text:"Erro ao adicionar observa√ß√£o interna"}),setTimeout((()=>{this.criarModalParticipantes(a)}),2e3)}}},getStatusColor(a){const t={INTERESSADO:"#17a2b8",DOCUMENTACAO_ENVIADA:"#ffc107",EM_AVALIACAO:"#fd7e14",APROVADO:"#28a745",REPROVADO:"#dc3545",DESISTENTE:"#6c757d"};return t[a]||"#6c757d"},formatarCNPJSimples(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatDateSimples(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},abrirDocumento(a){console.log("üìÑ Abrindo documento:",a),a&&"uploads/documento-exemplo.pdf"!==a?a.includes("editais-pdf/")||a.includes(".pdf")?window.open(a,"_blank"):this.$swal.fire({icon:"warning",title:"Documento ainda n√£o convertido",html:'\n                <p>Este edital ainda cont√©m a minuta Word original.</p>\n                <p><strong>Para obter o PDF oficial:</strong></p>\n                <ol style="text-align: left; margin: 15px 0;">\n                  <li>Clique em "Converter para PDF e Publicar"</li>\n                  <li>Confirme a convers√£o</li>\n                  <li>O sistema gerar√° o PDF oficial automaticamente</li>\n                </ol>\n                <p style="color: #28a745;">Ap√≥s a convers√£o, o bot√£o "Abrir PDF" mostrar√° o documento oficial.</p>\n              ',confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"}):this.$swal.fire("Aviso","Documento n√£o dispon√≠vel","warning")},async baixarDocumento(a){if(a.url_documento&&"uploads/documento-exemplo.pdf"!==a.url_documento)try{this.$swal.fire({title:"Preparando download...",text:"Aguarde um momento",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const t=document.createElement("a");t.href=a.url_documento,t.download=a.nome_arquivo||`edital_${a.numero}.pdf`,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$swal.close()}catch(t){console.error("Erro no download:",t),this.$swal.fire({icon:"error",title:"Erro no download",text:"N√£o foi poss√≠vel baixar o arquivo. Tente novamente."})}else this.$swal.fire("Aviso","Documento n√£o dispon√≠vel para download","warning")},async handleFileUpload(a){const t=a.target.files[0];if(t){if("application/pdf"!==t.type)return this.$swal.fire("Erro","Apenas arquivos PDF s√£o permitidos","error"),void(a.target.value="");if(t.size>10485760)return this.$swal.fire("Erro","Arquivo muito grande. M√°ximo 10MB","error"),void(a.target.value="");try{this.$swal.fire({title:"Fazendo upload...",text:"Aguarde enquanto o arquivo √© enviado",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const a=Date.now(),o=localStorage.getItem("tenant_id")||"default",e=`edital_${a}_${t.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,i=`${o}/editais/${e}`,{data:s,error:r}=await R.ND.storage.from("editais").upload(i,t,{cacheControl:"3600",upsert:!1});if(r)throw console.error("Erro no upload:",r),r;const{data:n}=R.ND.storage.from("editais").getPublicUrl(i);if(!n?.publicUrl)throw new Error("N√£o foi poss√≠vel obter URL do arquivo");this.editalAtual.url_documento=n.publicUrl,this.editalAtual.nome_arquivo=t.name,this.$swal.fire({icon:"success",title:"Upload realizado!",text:"Arquivo PDF enviado com sucesso",timer:2e3})}catch(o){if(console.error("Erro no upload:",o),o.message?.includes("Bucket not found")||404===o.statusCode)try{return await this.criarBucketEditais(),void await this.handleFileUpload(a)}catch(e){console.error("Erro ao criar bucket:",e)}this.$swal.fire({icon:"error",title:"Erro no upload",text:"N√£o foi poss√≠vel enviar o arquivo. Tente novamente.",footer:o.message||"Erro desconhecido"}),a.target.value=""}}},async criarBucketEditais(){try{const{data:a,error:t}=await R.ND.storage.createBucket("editais",{public:!0,fileSizeLimit:10485760,allowedMimeTypes:["application/pdf"]});if(t&&!t.message.includes("already exists"))throw t;console.log("Bucket editais criado/verificado com sucesso")}catch(a){throw console.error("Erro ao criar bucket editais:",a),a}},async carregarParticipantes(a){try{console.log("Carregando participantes para edital ID:",a),console.log("Tenant ID:",this.currentTenantId),this.loadingParticipantes=!0;const{data:t,error:o}=await R.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a).order("data_participacao",{ascending:!1});if(o)throw o;console.log("Participantes carregados:",t),this.participantes=t||[],this.aplicarFiltrosParticipantes()}catch(t){console.error("Erro ao carregar participantes:",t),this.$swal.fire("Erro","Erro ao carregar participantes: "+t.message,"error")}finally{this.loadingParticipantes=!1}},aplicarFiltrosParticipantes(){let a=[...this.participantes];if(this.filtroParticipantes.busca){const t=this.filtroParticipantes.busca.toLowerCase();a=a.filter((a=>a.razao_social.toLowerCase().includes(t)||a.cnpj.includes(t)||a.representante_legal.toLowerCase().includes(t)||a.email.toLowerCase().includes(t)))}this.filtroParticipantes.status&&(a=a.filter((a=>a.status===this.filtroParticipantes.status))),this.participantesFiltrados=a},formatarCNPJ(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},abrirModalNovoParticipante(){this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},this.modalNovoParticipante=!0},fecharModalParticipantes(){this.modalParticipantes=!1,this.editalSelecionado={},this.participantes=[],this.participantesFiltrados=[],this.filtroParticipantes={busca:"",status:""}},fecharModalNovoParticipante(){this.modalNovoParticipante=!1,this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]}},async salvarParticipante(){try{if(!this.participanteAtual.razao_social||!this.participanteAtual.cnpj||!this.participanteAtual.representante_legal||!this.participanteAtual.email)return void this.$swal.fire("Erro","Preencha todos os campos obrigat√≥rios","error");const a={tenant_id:this.currentTenantId,edital_id:this.editalSelecionado.id,razao_social:this.participanteAtual.razao_social,cnpj:this.participanteAtual.cnpj,representante_legal:this.participanteAtual.representante_legal,email:this.participanteAtual.email,telefone:this.participanteAtual.telefone,endereco:this.participanteAtual.endereco,status:this.participanteAtual.status,observacoes:this.participanteAtual.observacoes,produtos_submetidos:this.participanteAtual.produtos_submetidos};let t;if(this.participanteAtual.id){const{data:o,error:e}=await R.ND.from("participantes_editais").update(a).eq("id",this.participanteAtual.id).select().single();t={data:o,error:e}}else{const{data:o,error:e}=await R.ND.from("participantes_editais").insert(a).select().single();t={data:o,error:e}}if(t.error)throw t.error;await this.carregarParticipantes(this.editalSelecionado.id),this.fecharModalNovoParticipante(),this.$swal.fire({icon:"success",title:"Participante salvo!",text:`${this.participanteAtual.razao_social} foi ${this.participanteAtual.id?"atualizado":"adicionado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar participante:",a),this.$swal.fire("Erro","Erro ao salvar participante: "+a.message,"error")}},editarParticipante(a){this.participanteAtual={...a},this.modalNovoParticipante=!0},async removerParticipante(a){try{const t=await this.$swal.fire({title:"Remover Participante",text:`Tem certeza que deseja remover ${a.razao_social}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar",confirmButtonColor:"#d33"});if(t.isConfirmed){const{error:t}=await R.ND.from("participantes_editais").delete().eq("id",a.id);if(t)throw t;await this.carregarParticipantes(this.editalSelecionado.id),await this.carregarEditais(),this.$swal.fire("Removido!","Participante removido com sucesso.","success")}}catch(t){console.error("Erro ao remover participante:",t),this.$swal.fire("Erro","Erro ao remover participante: "+t.message,"error")}},async carregarUsuarios(){try{const{data:a,error:t}=await R.ND.from("usuarios_rdm").select("*").eq("tenant_id",this.currentTenantId).order("nome_usuario",{ascending:!0});if(t)throw t;this.usuarios=a||[],this.aplicarFiltrosUsuarios()}catch(a){console.error("Erro ao carregar usu√°rios:",a)}},aplicarFiltrosUsuarios(){let a=[...this.usuarios];if(this.filtroUsuarios.busca){const t=this.filtroUsuarios.busca.toLowerCase();a=a.filter((a=>a.nome_usuario?.toLowerCase().includes(t)||a.unidade_setor?.toLowerCase().includes(t)||a.nome_coordenador?.toLowerCase().includes(t)||a.email?.toLowerCase().includes(t)))}this.filtroUsuarios.unidade&&(a=a.filter((a=>a.unidade_setor===this.filtroUsuarios.unidade))),this.usuariosFiltrados=a},async abrirModalNovoUsuario(){console.log("‚ûï Abrindo modal de novo usu√°rio..."),await this.carregarProdutos(),this.usuarioAtual={nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[{produto_id:"",nome:"",codigo:"",periodicidade_rdm:""}],criar_login:!1},console.log("‚úÖ Modal novo usu√°rio preparado"),console.log("üì¶ Produtos dispon√≠veis:",this.produtosDisponiveis.length),this.modalNovoUsuario=!0},fecharModalNovoUsuario(){this.modalNovoUsuario=!1,this.usuarioAtual={nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[],criar_login:!1}},adicionarMaterial(){this.usuarioAtual.materiais.push({produto_id:"",nome:"",codigo:"",periodicidade_rdm:""})},removerMaterial(a){this.usuarioAtual.materiais.splice(a,1)},async salvarUsuario(){console.log("üöÄ INICIANDO salvarUsuario..."),console.log("üìä Estado inicial:",{usuarioAtual:this.usuarioAtual,temCriarLogin:this.usuarioAtual?.criar_login,temId:!!this.usuarioAtual?.id});try{let o=null,e=null;if(console.log("‚úÖ Vari√°veis inicializadas com sucesso"),console.log("üîç Verificando necessidade de criar login..."),this.usuarioAtual.criar_login&&!this.usuarioAtual.id){console.log("üîê Criando login autom√°tico para:",this.usuarioAtual.email),console.log("üéØ Gerando senha tempor√°ria..."),o=this.gerarSenhaTemporaria(),console.log("‚úÖ Senha tempor√°ria gerada:",o?"SIM":"N√ÉO");try{console.log("üîê SIMULA√á√ÉO - Criando usu√°rio:",{email:this.usuarioAtual.email,senha:o,tipo:"rdm"});const a=crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const t=16*Math.random()|0,o="x"==a?t:3&t|8;return o.toString(16)})),t={user:{id:a}},i=null;if(i)throw console.error("Erro ao criar usu√°rio no Supabase Auth:",i),new Error("N√£o foi poss√≠vel criar o login. Verifique se o email j√° est√° cadastrado.");e=t.user.id,console.log("‚úÖ Usu√°rio criado no Supabase Auth:",e)}catch(a){console.error("Erro na cria√ß√£o do login:",a),alert("Erro ao criar login do usu√°rio. Usu√°rio ser√° cadastrado sem acesso ao sistema.")}}console.log("üìù Preparando dados do usu√°rio..."),console.log("üîë Dados de entrada:",{currentTenantId:this.currentTenantId,usuarioSupabaseId:e,senhaTemporaria:o?"EXISTE":"NULL"});const i={...this.usuarioAtual,tenant_id:this.currentTenantId,user_id:e,senha_temporaria:o,convite_enviado:!1,convite_aceito:!1,ativo:!0,criado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()};if(console.log("‚úÖ Dados do usu√°rio preparados com sucesso"),delete i.criar_login,this.usuarioAtual.id||(delete i.id,console.log("üÜî Campo ID removido para permitir gera√ß√£o autom√°tica de UUID")),console.log("üìù Dados preparados para inser√ß√£o:",{temId:!!i.id,tenant_id:i.tenant_id,nome_usuario:i.nome_usuario,email:i.email,materiais:i.materiais?.length||0}),console.log("üîç DIAGN√ìSTICO TENANT_ID:",{currentTenantId:this.currentTenantId,userDataTenantId:i.tenant_id,tenantIdType:typeof i.tenant_id,tenantIdLength:i.tenant_id?.length,isValidUUID:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i.tenant_id)}),this.usuarioAtual.id){const a={...i};this.usuarioAtual.criar_login||(delete a.user_id,delete a.senha_temporaria,delete a.convite_enviado,delete a.convite_aceito,console.log("üîê Campos de login preservados (n√£o ser√£o sobrescritos)"));const{error:t}=await R.ND.from("usuarios_rdm").update(a).eq("id",this.usuarioAtual.id).eq("tenant_id",this.currentTenantId);if(t)throw t;console.log("‚úÖ Usu√°rio atualizado com sucesso")}else{const{data:a,error:t}=await R.ND.from("usuarios_rdm").insert([i]).select();if(t)throw t;i.id=a[0].id,console.log("‚úÖ Usu√°rio criado com sucesso:",i.id)}console.log("üìß Verificando envio de email...");let s=null;if(e&&o){console.log("üìß Condi√ß√µes atendidas, enviando email..."),console.log("üìß Dados para envio:",{usuarioSupabaseId:e?"EXISTE":"NULL",senhaTemporaria:o?"EXISTE":"NULL",email:i.email});try{s=await this.enviarEmailConvite(i,o),console.log("üìß Resultado do email:",s)}catch(t){console.error("‚ùå ERRO ESPEC√çFICO NO EMAIL:",t),s={success:!1,message:t.message}}}else console.log("‚è© Pulando envio de email (condi√ß√µes n√£o atendidas)");this.fecharModalNovoUsuario(),await this.carregarUsuarios(),e?s&&s.success?alert(`üéâ USU√ÅRIO CADASTRADO COM SUCESSO!\n\n‚úÖ Usu√°rio: ${this.usuarioAtual.nome_usuario}\n‚úÖ Login criado no sistema\n‚úÖ Email enviado para: ${this.usuarioAtual.email}\n\nüìß O usu√°rio receber√°:\n‚Ä¢ Link de acesso: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\n‚Ä¢ Senha tempor√°ria para primeiro acesso\n‚Ä¢ Instru√ß√µes completas de uso\n\nO usu√°rio j√° pode fazer login no sistema!`):alert(`‚ö†Ô∏è USU√ÅRIO CADASTRADO (Email com problema)\n\n‚úÖ Usu√°rio: ${this.usuarioAtual.nome_usuario}\n‚úÖ Login criado no sistema\n‚ö†Ô∏è Email N√ÉO foi enviado automaticamente\n\nüîß A√á√ÉO NECESS√ÅRIA:\nEnvie manualmente os dados de acesso:\nüìß Email: ${this.usuarioAtual.email}\nüîë Senha: ${o}\nüîó Link: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\n\nO sistema funciona normalmente, apenas o email autom√°tico falhou.`):alert("‚úÖ Usu√°rio cadastrado com sucesso!"),this.programarAlertasRDM(i)}catch(o){console.error("‚ùå ERRO PRINCIPAL em salvarUsuario:",o),console.error("üìä INFORMA√á√ïES DO ERRO PRINCIPAL:",{tipo:typeof o,nome:o?.name,mensagem:o?.message,stack:o?.stack});let a="Erro desconhecido. Tente novamente.";try{o&&o.message?a=o.message:o&&"function"===typeof o.toString&&(a=o.toString())}catch(e){console.error("Erro ao extrair mensagem:",e)}alert(`‚ùå Erro ao salvar usu√°rio: ${a}`)}},async editarUsuario(a){console.log("üîß Editando usu√°rio:",a.nome_usuario),console.log("üìã Materiais do usu√°rio:",a.materiais),await this.carregarProdutos(),this.usuarioAtual={...a},this.usuarioAtual.materiais&&Array.isArray(this.usuarioAtual.materiais)||(console.log("‚ö†Ô∏è Materiais n√£o encontrados, inicializando array vazio"),this.usuarioAtual.materiais=[]),this.usuarioAtual.materiais=this.usuarioAtual.materiais.map(((a,t)=>{console.log(`üì¶ Processando material ${t+1}:`,a);const o={produto_id:a.produto_id||"",nome:a.nome||"",codigo:a.codigo||"",periodicidade_rdm:a.periodicidade_rdm||"mensal",marca:a.marca||"",categoria:a.categoria||"",...a};return console.log(`‚úÖ Material ${t+1} processado:`,o),o})),console.log("‚úÖ Usu√°rio preparado para edi√ß√£o:",this.usuarioAtual),console.log("üì¶ Produtos dispon√≠veis:",this.produtosDisponiveis.length),this.modalNovoUsuario=!0},async removerUsuario(a){if(confirm(`Tem certeza que deseja remover o usu√°rio "${a.nome_usuario}"?`))try{const{error:t}=await R.ND.from("usuarios_rdm").delete().eq("id",a.id).eq("tenant_id",this.currentTenantId);if(t)throw t;await this.carregarUsuarios()}catch(t){console.error("Erro ao remover usu√°rio:",t),alert("Erro ao remover usu√°rio. Tente novamente.")}},verMateriaisUsuario(a){alert(`Materiais de ${a.nome_usuario}:\n\n${a.materiais?.map((a=>`‚Ä¢ ${a.nome} (${a.codigo}) - RDM ${a.periodicidade_rdm}`)).join("\n")||"Nenhum material cadastrado"}`)},calcularProximoRDM(a){if(!a.materiais||0===a.materiais.length)return"N/A";const t=new Date,o=new Date(t.getFullYear(),t.getMonth()+1,1);return o.toLocaleDateString("pt-BR")},programarAlertasRDM(a){console.log("Alertas RDM programados para:",a.nome_usuario)},async testarEmailJS(){if(confirm("üß™ Testar configura√ß√£o do EmailJS?\n\nIsso enviar√° um email de teste para comprarbemteste@gmail.com"))try{if(console.log("üß™ Iniciando teste do EmailJS..."),"undefined"===typeof J.Ay||!J.Ay)throw new Error("‚ùå EmailJS n√£o est√° carregado");if("function"!==typeof J.Ay.init||"function"!==typeof J.Ay.send)throw new Error("‚ùå M√©todos EmailJS n√£o est√£o dispon√≠veis");const t={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};console.log("üß™ Configura√ß√£o:",t);try{console.log("üß™ Inicializando EmailJS para teste..."),J.Ay.init(t.publicKey),console.log("‚úÖ EmailJS inicializado com sucesso para teste")}catch(a){throw console.error("‚ùå Erro cr√≠tico na inicializa√ß√£o:",a),new Error("Falha na inicializa√ß√£o do EmailJS para teste: "+a.message)}const o={numero_edital:"TESTE-EMAILJS",email_empresa:"comprarbemteste@gmail.com",message:`\nüß™ TESTE DE CONFIGURA√á√ÉO EMAILJS\n\nEste √© um email de teste para verificar se o EmailJS est√° funcionando corretamente.\n\n=== INFORMA√á√ïES DO TESTE ===\nData do teste: ${(new Date).toLocaleString("pt-BR")}\nSistema: ${window.location.origin}\nTemplate: template_nyiw2ua\nService: service_7sv1naw\n\n=== RESULTADO ===\nSe voc√™ recebeu este email, a configura√ß√£o est√° funcionando perfeitamente!\n\n=== PR√ìXIMO PASSO ===\nAgora voc√™ pode cadastrar usu√°rios RDM com confian√ßa que os emails ser√£o enviados.\n\n---\nSistema Comprar Bem - Compras P√∫blicas Inteligentes\nTeste autom√°tico de configura√ß√£o EmailJS\n          `,name:"Teste do Sistema",email:"comprarbemteste@gmail.com",subject:"üß™ Teste de Configura√ß√£o EmailJS - Sistema Comprar Bem",status_participante:"aprovado",motivo_rejeicao:""};console.log("üß™ Enviando email de teste..."),console.log("üß™ Par√¢metros:",o);const e=await J.Ay.send(t.serviceId,t.templateId,o,t.publicKey);if(console.log("‚úÖ Teste bem-sucedido:",e),!e||200!==e.status)throw new Error(`Status de resposta inesperado: ${e?.status}`);alert("‚úÖ TESTE REALIZADO COM SUCESSO!\n\nüìß Email de teste enviado para comprarbemteste@gmail.com\n\n‚úÖ EmailJS est√° configurado corretamente")}catch(t){console.error("‚ùå Falha no teste:",t),alert(`‚ùå FALHA NO TESTE DO EMAILJS\n\nErro: ${t.message}\n\nPoss√≠veis causas:\n‚Ä¢ Configura√ß√£o incorreta do EmailJS\n‚Ä¢ Problemas de conectividade\n‚Ä¢ Service ID ou Template ID inv√°lidos\n‚Ä¢ Public Key incorreta\n\nVerifique:\n1. Configura√ß√£o no EmailJS Dashboard\n2. Conex√£o com a internet\n3. Console do navegador para mais detalhes`)}},async carregarAvaliacoes(){try{console.log("üîç [AVALIA√á√ïES CPM] === DEBUG COMPLETO ==="),console.log("üîç [AVALIA√á√ïES CPM] Tenant ID atual:",this.currentTenantId),console.log("üîç [AVALIA√á√ïES CPM] TESTE 1: TODAS as avalia√ß√µes (sem filtro)");const{data:a,error:t}=await R.ND.from("material_feedbacks").select("*").order("criado_em",{ascending:!1});console.log("üìä [AVALIA√á√ïES CPM] TESTE 1 - Total geral:",a?.length||0),a&&a.length>0&&(console.log("üìä [AVALIA√á√ïES CPM] TESTE 1 - Primeira avalia√ß√£o:",a[0]),console.log("üìä [AVALIA√á√ïES CPM] TESTE 1 - Tenant IDs encontrados:",[...new Set(a.map((a=>a.tenant_id)))])),console.log("üîç [AVALIA√á√ïES CPM] TESTE 2: Com filtro de tenant");const{data:o,error:e}=await R.ND.from("material_feedbacks").select("*").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(console.log("üìä [AVALIA√á√ïES CPM] TESTE 2 - Com tenant:",o?.length||0),e)return console.error("‚ùå [AVALIA√á√ïES CPM] Erro ao carregar avalia√ß√µes b√°sicas:",e),this.avaliacoes=[],void this.aplicarFiltrosAvaliacoes();if(!o||0===o.length)return console.log("üì≠ [AVALIA√á√ïES CPM] Nenhuma avalia√ß√£o encontrada para este tenant"),console.log("üîç [AVALIA√á√ïES CPM] Vamos usar TODAS as avalia√ß√µes temporariamente para debug..."),a&&a.length>0?(this.avaliacoes=await this.enriquecerAvaliacoesComUsuarios(a),console.log("üîÑ [AVALIA√á√ïES CPM] Usando TODAS as avalia√ß√µes (sem filtro de tenant)")):this.avaliacoes=[],void this.aplicarFiltrosAvaliacoes();console.log("üîç [AVALIA√á√ïES CPM] TESTE 3: JOIN com usu√°rios");const{data:i,error:s}=await R.ND.from("material_feedbacks").select("\n            *,\n            usuario_rdm:usuarios_rdm(nome_usuario, unidade_setor, email, telefone)\n          ").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});s?(console.error("‚ö†Ô∏è [AVALIA√á√ïES CPM] Erro no JOIN, usando dados b√°sicos:",s),this.avaliacoes=await this.enriquecerAvaliacoesComUsuarios(o)):(console.log("‚úÖ [AVALIA√á√ïES CPM] JOIN executado com sucesso:",i?.length||0),this.avaliacoes=i||[]),this.aplicarFiltrosAvaliacoes(),console.log("üéØ [AVALIA√á√ïES CPM] === FIM DEBUG - RESULTADO FINAL ==="),console.log("üéØ [AVALIA√á√ïES CPM] Avalia√ß√µes carregadas:",this.avaliacoes.length)}catch(a){console.error("‚ùå [AVALIA√á√ïES CPM] Erro geral ao carregar avalia√ß√µes:",a),this.avaliacoes=[],this.aplicarFiltrosAvaliacoes()}},async enriquecerAvaliacoesComUsuarios(a){try{const t=[];for(const o of a)if(o.usuario_rdm_id){const{data:a,error:e}=await R.ND.from("usuarios_rdm").select("nome_usuario, unidade_setor, email, telefone").eq("id",o.usuario_rdm_id).eq("tenant_id",this.currentTenantId).single();t.push({...o,usuario_rdm:a||null})}else t.push({...o,usuario_rdm:null});return t}catch(t){return console.error("‚ùå [AVALIA√á√ïES CPM] Erro ao enriquecer com usu√°rios:",t),a.map((a=>({...a,usuario_rdm:null})))}},aplicarFiltrosAvaliacoes(){let a=[...this.avaliacoes];if(this.filtroAvaliacoes.busca){const t=this.filtroAvaliacoes.busca.toLowerCase();a=a.filter((a=>a.material_nome?.toLowerCase().includes(t)||a.material_codigo?.toLowerCase().includes(t)||a.usuario_rdm?.nome_usuario?.toLowerCase().includes(t)||a.usuario_rdm?.unidade_setor?.toLowerCase().includes(t)||a.comentario?.toLowerCase().includes(t)))}this.filtroAvaliacoes.rating&&(a=a.filter((a=>a.rating==this.filtroAvaliacoes.rating))),this.filtroAvaliacoes.usuario&&(a=a.filter((a=>a.usuario_rdm?.nome_usuario?.toLowerCase().includes(this.filtroAvaliacoes.usuario.toLowerCase())))),this.avaliacoesFiltradas=a},async salvarRespostaCPM(a){if(a.nova_resposta&&a.nova_resposta.trim()){this.salvandoResposta=!0;try{const{error:t}=await R.ND.from("material_feedbacks").update({resposta_cpm:a.nova_resposta.trim(),data_resposta_cpm:(new Date).toISOString()}).eq("id",a.id);if(t)throw t;a.resposta_cpm=a.nova_resposta.trim(),a.data_resposta_cpm=(new Date).toISOString(),a.nova_resposta="",this.$swal({title:"Sucesso!",text:"Coment√°rio/Decis√£o da CPM salvo com sucesso",icon:"success",timer:2e3,showConfirmButton:!1})}catch(t){console.error("Erro ao salvar resposta da CPM:",t),this.$swal({title:"Erro",text:"Erro ao salvar resposta: "+t.message,icon:"error"})}finally{this.salvandoResposta=!1}}else this.$swal({title:"Aten√ß√£o",text:"Por favor, digite um coment√°rio ou decis√£o.",icon:"warning"})},toggleLoginSystem(){this.usuarioAtual.criar_login||(this.usuarioAtual.senha_temporaria=null,this.usuarioAtual.user_id=null)},gerarSenhaTemporaria(){const a=(new Date).getFullYear(),t=Math.floor(1e4*Math.random()).toString().padStart(4,"0");return`CB${a}${t}`},async enviarEmailConvite(a,t){try{if(console.log("üìß Enviando email REAL de convite para:",a.email),"undefined"===typeof J.Ay||!J.Ay)throw new Error("EmailJS n√£o est√° carregado. Verifique a importa√ß√£o.");if("function"!==typeof J.Ay.init||"function"!==typeof J.Ay.send)throw new Error("M√©todos EmailJS n√£o est√£o dispon√≠veis. Verifique a vers√£o.");const e={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};console.log("üìß EmailJS dispon√≠vel:",typeof J.Ay),console.log("üìß Configura√ß√£o:",e);const i={numero_edital:"RDM-CONVITE",email_empresa:a.email,message:`\nüîê BEM-VINDO AO SISTEMA COMPRAR BEM\n\nOl√° ${a.nome_usuario}!\n\nVoc√™ foi cadastrado(a) para acessar o Sistema Comprar Bem - Dashboard RDM Online.\n\n=== SEUS DADOS DE ACESSO ===\nEmail: ${a.email}\nSenha de Acesso: ${t}\nUnidade/Setor: ${a.unidade_setor}\nCoordenador: ${a.nome_coordenador}\n\n=== COMO ACESSAR ===\n1. Acesse: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\n2. Fa√ßa login com seu email e senha\n3. Comece a emitir suas RDMs online!\n\n=== FUNCIONALIDADES DISPON√çVEIS ===\n‚úÖ Emiss√£o de RDMs online\n‚úÖ Hist√≥rico de solicita√ß√µes\n‚úÖ Acompanhamento de status\n‚úÖ Notifica√ß√µes autom√°ticas\n\n=== IMPORTANTE ===\nüîë Use sempre a mesma senha para acessar o sistema\nüìù Guarde seus dados de acesso em local seguro\nüìû Em caso de d√∫vidas, entre em contato conosco\n\n=== SUPORTE ===\nEmail: comprarbemteste@gmail.com\nSistema: ${window.location.origin}\n\nData do cadastro: ${(new Date).toLocaleDateString("pt-BR")}\n\n---\nSistema Comprar Bem - Compras P√∫blicas Inteligentes\nEste √© um email autom√°tico. N√£o responda diretamente.\n          `,name:a.nome_usuario,email:"comprarbemteste@gmail.com",subject:"üîê Bem-vindo ao Sistema Comprar Bem - Acesso RDM Online",status_participante:"aprovado",motivo_rejeicao:""};console.log("üìß Enviando email REAL via EmailJS..."),console.log("üìß Para:",a.email),console.log("üìß Config EmailJS:",e),console.log("üìß Par√¢metros do email:",i);try{console.log("üìß Inicializando EmailJS com public key..."),J.Ay.init(e.publicKey),console.log("‚úÖ EmailJS inicializado com sucesso")}catch(o){throw console.error("‚ùå Erro na inicializa√ß√£o do EmailJS:",o),new Error("Falha na inicializa√ß√£o do EmailJS: "+o.message)}console.log("üìß Chamando emailjs.send...");const s=await J.Ay.send(e.serviceId,e.templateId,i,e.publicKey);if(console.log("üéâ EMAIL REAL ENVIADO COM SUCESSO!",s),!s||200!==s.status)throw new Error(`Falha no envio do email. Status: ${s?.status||"desconhecido"}`);return await R.ND.from("usuarios_rdm").update({convite_enviado:!0,data_convite:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId),console.log("‚úÖ Status do convite atualizado no banco"),await this.criarNotificacao(this.currentTenantId,this.currentTenantId,"SISTEMA","Convite RDM Enviado",`‚úÖ Email de convite enviado com SUCESSO!\n          \nüìß Destinat√°rio: ${a.nome_usuario} (${a.email})\nüîë Senha de acesso: ${t}\nüîó Link de acesso: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\nüìÖ Data: ${(new Date).toLocaleString("pt-BR")}\n\nO usu√°rio pode fazer login imediatamente no sistema RDM.`,null),console.log("üéâ PROCESSO COMPLETO - Email enviado e notifica√ß√£o criada!"),{success:!0,message:"Email enviado com sucesso!"}}catch(e){console.error("‚ùå ERRO DETALHADO ao enviar email de convite:",e),console.error("üìä INFORMA√á√ïES DO ERRO:",{tipo:typeof e,nome:e?.name||"SemNome",mensagem:e?.message||"SemMensagem",stack:e?.stack||"SemStack",usuario:a?.email||"SemEmail",emailjsDisponivel:typeof J.Ay,errorString:e?.toString()||"N√£oConvert√≠vel"});let t="Erro desconhecido";try{let a="Erro sem descri√ß√£o";e&&"object"===typeof e?"string"===typeof e.message?a=e.message:"function"===typeof e.toString&&(a=e.toString()):"string"===typeof e&&(a=e),console.log("üîç Mensagem de erro extra√≠da:",a),t="string"===typeof a&&a.length>0?-1!==a.indexOf("emailjs")?"EmailJS n√£o est√° carregado ou configurado corretamente":-1!==a.indexOf("network")||-1!==a.indexOf("fetch")?"Erro de conectividade. Verifique sua conex√£o com a internet":-1!==a.indexOf("service")||-1!==a.indexOf("template")?"Configura√ß√£o inv√°lida do EmailJS (service/template ID)":-1!==a.indexOf("422")?"Par√¢metros incorretos do template EmailJS (erro 422)":-1!==a.indexOf("includes")?"Erro interno do JavaScript (propriedade undefined)":a:"Erro sem mensagem v√°lida"}catch(i){console.error("‚ùå Erro na an√°lise do erro:",i),t="Erro complexo n√£o analis√°vel"}return{success:!1,message:t}}},async criarNotificacao(a,t,o,e,i,s=null){try{const{error:r}=await R.ND.from("notificacoes").insert([{tenant_id:a,usuario_destino:t,tipo:o,titulo:e,mensagem:i,link_acao:s,criado_em:(new Date).toISOString()}]);if(r)throw r}catch(r){console.error("Erro ao criar notifica√ß√£o:",r)}},async verificarStatusConvites(){try{const{data:a,error:t}=await R.ND.from("usuarios_rdm").select("id, nome_usuario, email, convite_enviado, convite_aceito, data_convite").eq("tenant_id",this.currentTenantId).eq("ativo",!0).not("user_id","is",null);if(t)throw t;this.statusConvites=a.reduce(((a,t)=>(a[t.id]={enviado:t.convite_enviado,aceito:t.convite_aceito,dataConvite:t.data_convite},a)),{})}catch(a){console.error("Erro ao verificar status dos convites:",a)}},async reenviarConvite(a){if(confirm(`Reenviar convite de acesso para ${a.nome_usuario}?`))try{const t=this.gerarSenhaTemporaria();await R.ND.from("usuarios_rdm").update({senha_temporaria:t,convite_enviado:!1}).eq("id",a.id).eq("tenant_id",this.currentTenantId),a.user_id&&console.log("üîê SIMULA√á√ÉO - Atualizando senha para:",a.email,t),await this.enviarEmailConvite({...a,senha_temporaria:t},t),alert("‚úÖ Convite reenviado com sucesso!"),await this.carregarUsuarios()}catch(t){console.error("Erro ao reenviar convite:",t),alert("‚ùå Erro ao reenviar convite. Tente novamente.")}},async carregarProdutos(){try{this.loadingProdutos=!0,console.log("üì¶ Carregando produtos dispon√≠veis..."),console.log("üîë Tenant ID atual:",this.currentTenantId);const{data:a,error:t}=await R.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status, tenant_id").order("nome");console.log("üìä Todos os produtos encontrados:",a?.length||0),console.log("üìã Primeiros 3 produtos:",a?.slice(0,3)),a?.length>0&&console.log("üîç Estrutura do primeiro produto:",{id:a[0].id,nome:a[0].nome,marca:a[0].marca,modelo:a[0].modelo,codigo_material:a[0].codigo_material,categoria_id:a[0].categoria_id,status:a[0].status,tenant_id:a[0].tenant_id});const{data:o,error:e}=await R.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status, tenant_id").eq("tenant_id",this.currentTenantId).order("nome");if(console.log("üéØ Produtos do tenant atual:",o?.length||0),console.log("üìã Status dos produtos:",o?.map((a=>a.status))),e)throw console.error("‚ùå Erro na query:",e),e;let i=o?.filter((a=>"aprovado"===a.status))||[];0===i.length&&(console.log('‚ö†Ô∏è Nenhum produto "aprovado" encontrado, carregando todos os produtos do tenant...'),i=o||[]),this.produtosDisponiveis=i,console.log(`‚úÖ ${this.produtosDisponiveis.length} produtos carregados para sele√ß√£o`),console.log("üì¶ Produtos dispon√≠veis:",this.produtosDisponiveis.map((a=>`${a.nome} (${a.status})`)))}catch(a){console.error("‚ùå Erro ao carregar produtos:",a),this.produtosDisponiveis=[],alert(`‚ùå Erro ao carregar produtos:\n${a.message}\n\nVerifique o console para mais detalhes.`)}finally{this.loadingProdutos=!1}},selecionarProduto(a,t){const o=t.target.value,e=this.usuarioAtual.materiais[a];if(console.log("üîç Selecionando produto:",o,"para material index:",a),"NOVO"===o)e.produto_id="NOVO",e.nome="",e.codigo="",console.log("üìù Modo novo material ativado");else if(o){const a=this.produtosDisponiveis.find((a=>a.id===o));console.log("üîç Produto encontrado:",a),a&&(e.produto_id=o,e.nome=a.nome,e.codigo=a.codigo_material||a.modelo||"",e.marca=a.marca||"",e.categoria=a.categoria_id||"",console.log("‚úÖ Dados do produto aplicados:",{nome:e.nome,codigo:e.codigo,marca:e.marca,categoria_id:e.categoria}))}else e.produto_id="",e.nome="",e.codigo="",console.log("üóëÔ∏è Sele√ß√£o limpa");console.log("üìã Material atualizado:",e)}},formatarData(a){if(!a)return"";const t=new Date(a);return t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},formatCurrency(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}},Ma=Ia;var Fa=(0,C.A)(Ma,U,j,!1,null,"ee461212",null);const Ta=Fa.exports,za={name:"Dashboard",components:{DashboardCPM:Ta},data(){return{showDropdown:!1,usuarioNome:"Usu√°rio",usuarioEmail:"",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await R.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usu√°rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},ka=za;var Oa=(0,C.A)(ka,L,V,!1,null,"78df32b2",null);const Ba=Oa.exports;var qa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"cadastro-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("‚ñº")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("CadastroProduto")],1)])},La=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])}],Va=function(){var a=this,t=a._self._c;return t("div",{staticClass:"cadastro-produto"},[t("h2",[a._v("Cadastro de Produto")]),t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarProduto.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome do Produto*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.nome,expression:"produto.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.produto.nome},on:{input:function(t){t.target.composing||a.$set(a.produto,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.grupo_id,expression:"produto.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.produto,"grupo_id",t.target.multiple?o:o[0])},a.onGrupoChange]}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" ")])}))],2)])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"classe"}},[a._v("Classe*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.classe_id,expression:"produto.classe_id"}],attrs:{id:"classe",required:"",disabled:!a.produto.grupo_id||0===a.classes.length},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.produto,"classe_id",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.filteredClasses,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" ")])}))],2),a.produto.grupo_id&&0===a.filteredClasses.length?t("div",{staticClass:"info-text"},[a._v(" N√£o h√° classes dispon√≠veis para este grupo. Por favor, cadastre uma classe primeiro. ")]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"marca"}},[a._v("Marca*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.marca,expression:"produto.marca"}],attrs:{id:"marca",type:"text",required:""},domProps:{value:a.produto.marca},on:{input:function(t){t.target.composing||a.$set(a.produto,"marca",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"modelo"}},[a._v("Modelo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.modelo,expression:"produto.modelo"}],attrs:{id:"modelo",type:"text",required:""},domProps:{value:a.produto.modelo},on:{input:function(t){t.target.composing||a.$set(a.produto,"modelo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"fabricante"}},[a._v("Fabricante*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.fabricante,expression:"produto.fabricante"}],attrs:{id:"fabricante",type:"text",required:""},domProps:{value:a.produto.fabricante},on:{input:function(t){t.target.composing||a.$set(a.produto,"fabricante",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cnpj"}},[a._v("CNPJ do Requerente*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cnpjFormatado,expression:"cnpjFormatado"}],class:{"input-error":a.cnpjInvalido,"input-success":a.cnpjValidado&&!a.cnpjInvalido},attrs:{id:"cnpj",type:"text",required:"",maxlength:"18",placeholder:"00.000.000/0000-00"},domProps:{value:a.cnpjFormatado},on:{input:[function(t){t.target.composing||(a.cnpjFormatado=t.target.value)},a.formatarCNPJ]}}),a.cnpjMensagem?t("div",{class:["mensagem",{"error-text":a.cnpjInvalido,"success-text":!a.cnpjInvalido}]},[a._v(" "+a._s(a.cnpjMensagem)+" ")]):a._e(),a.dadosEmpresa?t("div",{staticClass:"dados-empresa"},[t("p",[t("strong",[a._v("Raz√£o Social:")]),a._v(" "+a._s(a.dadosEmpresa.razaoSocial))]),a.dadosEmpresa.nomeFantasia?t("p",[t("strong",[a._v("Nome Fantasia:")]),a._v(" "+a._s(a.dadosEmpresa.nomeFantasia))]):a._e(),t("p",[t("strong",[a._v("Situa√ß√£o:")]),a._v(" "+a._s(a.dadosEmpresa.situacao))])]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email_fornecedor"}},[a._v("E-mail do Requerente*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.email_fornecedor,expression:"produto.email_fornecedor"}],attrs:{id:"email_fornecedor",type:"email",required:"",placeholder:"contato@empresa.com"},domProps:{value:a.produto.email_fornecedor},on:{input:function(t){t.target.composing||a.$set(a.produto,"email_fornecedor",t.target.value)}}}),t("small",{staticClass:"info-text"},[a._v("Email para comunica√ß√µes sobre dilig√™ncias")])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"origem"}},[a._v("Origem")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.origem,expression:"produto.origem"}],attrs:{id:"origem",type:"text",placeholder:"Nacional ou Importado"},domProps:{value:a.produto.origem},on:{input:function(t){t.target.composing||a.$set(a.produto,"origem",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registro_anvisa"}},[a._v("Registro na Anvisa/MS")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.registro_anvisa,expression:"produto.registro_anvisa"}],attrs:{id:"registro_anvisa",type:"text",placeholder:"N√∫mero do registro"},domProps:{value:a.produto.registro_anvisa},on:{input:function(t){t.target.composing||a.$set(a.produto,"registro_anvisa",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cbpf"}},[a._v("CBPF")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.cbpf,expression:"produto.cbpf"}],attrs:{id:"cbpf",type:"text",placeholder:"Certificado de Boas Pr√°ticas de Fabrica√ß√£o"},domProps:{value:a.produto.cbpf},on:{input:function(t){t.target.composing||a.$set(a.produto,"cbpf",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"codigo_material"}},[a._v("C√≥digo do Material")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.codigo_material,expression:"produto.codigo_material"}],attrs:{id:"codigo_material",type:"text",placeholder:"C√≥digo interno do material"},domProps:{value:a.produto.codigo_material},on:{input:function(t){t.target.composing||a.$set(a.produto,"codigo_material",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"norma_abnt"}},[a._v("Norma ABNT")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.norma_abnt,expression:"produto.norma_abnt"}],attrs:{id:"norma_abnt",type:"text",placeholder:"N√∫mero da norma ABNT"},domProps:{value:a.produto.norma_abnt},on:{input:function(t){t.target.composing||a.$set(a.produto,"norma_abnt",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"norma_regulamentadora"}},[a._v("Norma Regulamentadora")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.norma_regulamentadora,expression:"produto.norma_regulamentadora"}],attrs:{id:"norma_regulamentadora",type:"text",placeholder:"N√∫mero da norma regulamentadora"},domProps:{value:a.produto.norma_regulamentadora},on:{input:function(t){t.target.composing||a.$set(a.produto,"norma_regulamentadora",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Especifica√ß√£o Detalhada")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.produto.descricao,expression:"produto.descricao"}],attrs:{id:"descricao",rows:"4"},domProps:{value:a.produto.descricao},on:{input:function(t){t.target.composing||a.$set(a.produto,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Documenta√ß√£o do Produto (apenas PDF)")]),t("div",{staticClass:"file-upload"},[t("input",{attrs:{type:"file",multiple:"",accept:".pdf"},on:{change:a.onFileSelect}})]),t("small",{staticClass:"info-text"},[a._v("Apenas arquivos PDF s√£o aceitos (m√°x. 10MB por arquivo)")]),a.selectedFiles.length>0?t("div",{staticClass:"selected-files"},[t("p",[a._v("Arquivos selecionados:")]),t("ul",a._l(a.selectedFiles,(function(o,e){return t("li",{key:e,class:{"arquivo-invalido":!a.validarArquivoPDF(o)}},[a._v(" "+a._s(o.name)+" "),a.validarArquivoPDF(o)?a._e():t("span",{staticClass:"error-text"},[a._v("(Formato inv√°lido - apenas PDF permitido)")])])})),0)]):a._e(),a.arquivosInvalidos.length>0?t("div",{staticClass:"error-text"},[t("p",[a._v("Os seguintes arquivos n√£o ser√£o enviados (apenas PDF permitido):")]),t("ul",a._l(a.arquivosInvalidos,(function(o,e){return t("li",{key:e},[a._v(" "+a._s(o.name)+" ")])})),0)]):a._e()]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},Ua=[];const ja="https://publica.cnpj.ws/cnpj";async function Ja(a){try{const t=a.replace(/[^\d]/g,"");if(14!==t.length)return{valido:!1,mensagem:"CNPJ deve ter 14 d√≠gitos"};const o=await fetch(`${ja}/${t}`);if(!o.ok){if(404===o.status)return{valido:!1,mensagem:"CNPJ n√£o encontrado na base de dados"};throw new Error("Erro ao consultar CNPJ")}const e=await o.json();return{valido:!0,mensagem:"CNPJ v√°lido",dados:{razaoSocial:e.razao_social,nomeFantasia:e.estabelecimento?.nome_fantasia||"",situacao:e.estabelecimento?.situacao_cadastral||""}}}catch(t){return console.error("Erro ao validar CNPJ:",t),{valido:!1,mensagem:"Erro ao validar CNPJ. Tente novamente mais tarde."}}}const Ga={name:"CadastroProduto",data(){return{produto:{nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",email_fornecedor:"",origem:"",registro_anvisa:"",cbpf:"",codigo_material:"",norma_abnt:"",norma_regulamentadora:"",descricao:""},cnpjFormatado:"",cnpjInvalido:!1,cnpjMensagem:"",cnpjValidado:!1,dadosEmpresa:null,loading:!1,grupos:[],classes:[],selectedFiles:[],arquivosInvalidos:[],currentTenantId:null}},computed:{filteredClasses(){return this.produto.grupo_id?this.classes.filter((a=>a.grupo_id===this.produto.grupo_id)):[]}},async created(){this.carregarGrupos(),await this.obterTenantId()},methods:{async obterTenantId(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)throw new Error("Usu√°rio n√£o autenticado");if(t?.user_metadata?.tenant_id)return console.log("Obteve tenant_id dos metadados:",t.user_metadata.tenant_id),void(this.currentTenantId=t.user_metadata.tenant_id);const{data:o,error:e}=await R.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(console.log("Busca de tenant_id na tabela usuarios:",{userData:o,userError:e}),o&&o.tenant_id){console.log("Obteve tenant_id da tabela usuarios:",o.tenant_id),this.currentTenantId=o.tenant_id;const{error:a}=await R.ND.auth.updateUser({data:{tenant_id:o.tenant_id}});return void(a?console.error("Erro ao atualizar metadados do usu√°rio:",a):console.log("Metadados do usu√°rio atualizados com sucesso"))}const i=(0,I.A)();console.log("Gerando novo tenant_id:",i);const{error:s}=await R.ND.from("usuarios").insert({id:(0,I.A)(),email:t.email,tenant_id:i,ativo:!0});s&&console.error("Erro ao inserir novo tenant_id na tabela usuarios:",s);const{error:r}=await R.ND.auth.updateUser({data:{tenant_id:i}});r?console.error("Erro ao atualizar metadados do usu√°rio:",r):console.log("Metadados do usu√°rio atualizados com novo tenant_id"),this.currentTenantId=i}catch(a){console.error("Erro ao obter tenant_id:",a),alert("Erro ao obter identifica√ß√£o do tenant. Por favor, fa√ßa login novamente."),this.$router.push("/")}},async carregarGrupos(){try{const{data:a,error:t}=await R.ND.from("grupos").select("*").order("nome");if(t)throw t;a&&a.length>0?this.grupos=a:this.grupos=[{id:1,nome:"Equipamentos M√©dicos"},{id:2,nome:"Equipamentos Odontol√≥gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escrit√≥rio"},{id:5,nome:"Equipamentos de Inform√°tica"},{id:6,nome:"Mobili√°rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laborat√≥rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar grupos:",a),this.grupos=[{id:1,nome:"Equipamentos M√©dicos"},{id:2,nome:"Equipamentos Odontol√≥gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escrit√≥rio"},{id:5,nome:"Equipamentos de Inform√°tica"},{id:6,nome:"Mobili√°rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laborat√≥rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},onGrupoChange(){this.carregarClasses()},async carregarClasses(){try{const{data:a,error:t}=await R.ND.from("classes").select("*").eq("grupo_id",this.produto.grupo_id).order("nome");if(t)throw t;a&&a.length>0?this.classes=a:this.classes=[{id:1,nome:"Equipamentos M√©dicos"},{id:2,nome:"Equipamentos Odontol√≥gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escrit√≥rio"},{id:5,nome:"Equipamentos de Inform√°tica"},{id:6,nome:"Mobili√°rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laborat√≥rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar classes:",a),this.classes=[{id:1,nome:"Equipamentos M√©dicos"},{id:2,nome:"Equipamentos Odontol√≥gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escrit√≥rio"},{id:5,nome:"Equipamentos de Inform√°tica"},{id:6,nome:"Mobili√°rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laborat√≥rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},async formatarCNPJ(a){let t=a.target.value.replace(/\D/g,"");t.length<=14&&(t=t.replace(/^(\d{2})(\d)/,"$1.$2"),t=t.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),t=t.replace(/\.(\d{3})(\d)/,".$1/$2"),t=t.replace(/(\d{4})(\d)/,"$1-$2"),this.cnpjFormatado=t,this.produto.cnpj=t,this.cnpjValidado&&(this.cnpjValidado=!1,this.cnpjInvalido=!1,this.cnpjMensagem="",this.dadosEmpresa=null),14===t.replace(/\D/g,"").length&&await this.validarCNPJOnline())},async validarCNPJOnline(){try{const a=await Ja(this.cnpjFormatado);this.cnpjValidado=!0,this.cnpjInvalido=!a.valido,this.cnpjMensagem=a.mensagem,a.valido?this.dadosEmpresa=a.dados:this.dadosEmpresa=null}catch(a){console.error("Erro ao validar CNPJ:",a),this.cnpjInvalido=!0,this.cnpjMensagem="Erro ao validar CNPJ. Tente novamente mais tarde."}},onFileSelect(a){const t=Array.from(a.target.files);this.arquivosInvalidos=[],this.selectedFiles=t.filter((a=>{const t=this.validarArquivoPDF(a);return t||this.arquivosInvalidos.push(a),t}))},validarArquivoPDF(a){const t=a.name.split(".").pop().toLowerCase(),o=a.type.toLowerCase();return"pdf"===t&&"application/pdf"===o},sanitizarNomeArquivo(a){let t=a.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(t=t.replace(/[^a-zA-Z0-9_.]/g,"_"),t.length>100){const a=t.split(".").pop();t=t.substring(0,90)+"."+a}return t},async salvarProduto(){if(this.validarFormulario())try{if(this.loading=!0,this.currentTenantId||await this.obterTenantId(),console.log("Salvando produto com tenant_id:",this.currentTenantId),!this.cnpjValidado||this.cnpjInvalido)return this.$swal({icon:"error",title:"CNPJ Inv√°lido",text:"Por favor, informe um CNPJ v√°lido no formato 00.000.000/0000-00"}),void(this.loading=!1);const a={nome:this.produto.nome,descricao:this.produto.descricao,grupo_id:this.produto.grupo_id,classe_id:this.produto.classe_id,marca:this.produto.marca,modelo:this.produto.modelo,fabricante:this.produto.fabricante,cnpj:this.produto.cnpj,email_fornecedor:this.produto.email_fornecedor,origem:this.produto.origem,registro_anvisa:this.produto.registro_anvisa,cbpf:this.produto.cbpf,norma_abnt:this.produto.norma_abnt,norma_regulamentadora:this.produto.norma_regulamentadora,codigo_material:this.produto.codigo_material,status:"pendente",tenant_id:this.currentTenantId};console.log("Objeto produto a ser inserido:",a);const{data:t,error:o}=await R.ND.from("produtos").insert(a).select().single();if(o)throw console.error("Erro detalhado ao salvar produto:",o),new Error(`Erro ao salvar produto: ${o.message}`);console.log("Produto inserido com sucesso:",t);const e=this.selectedFiles.filter((a=>this.validarArquivoPDF(a)));if(e.length>0){const a=t.id;for(const t of e){const o=t.name,e=this.sanitizarNomeArquivo(t.name),i=`${Date.now()}-${e}`;console.log(`Upload de arquivo: Original "${o}" -> Sanitizado "${e}"`);const{data:s,error:r}=await R.ND.storage.from("documentos").upload(i,t);if(r){console.error("Erro ao fazer upload do arquivo:",r);continue}const{data:n}=R.ND.storage.from("documentos").getPublicUrl(i),l=n?.publicUrl||"",c={tenant_id:this.currentTenantId,produto_id:a,nome:o,tipo:t.type,arquivo_url:l},{error:d}=await R.ND.from("documentos").insert(c);d&&console.error("Erro ao registrar documento:",d)}}this.arquivosInvalidos.length>0?this.$swal({icon:"warning",title:"Produto salvo com ressalvas",text:`O produto foi salvo, mas ${this.arquivosInvalidos.length} arquivo(s) n√£o foi(ram) enviado(s) por n√£o serem PDFs v√°lidos.`}):this.$swal({icon:"success",title:"Produto salvo com sucesso!",text:"O produto foi cadastrado e est√° aguardando aprova√ß√£o."}),this.limparFormulario()}catch(a){console.error("Erro no processo de salvamento:",a),this.$swal({icon:"error",title:"Erro ao salvar produto",text:a.message||"Ocorreu um erro ao tentar salvar o produto."})}finally{this.loading=!1}},limparFormulario(){this.produto={nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",origem:"",registro_anvisa:"",cbpf:"",norma_abnt:"",norma_regulamentadora:"",codigo_material:"",descricao:"",status:"pendente"},this.cnpjFormatado="",this.cnpjInvalido=!1,this.selectedFiles=[],this.arquivosInvalidos=[]},validarFormulario(){return this.produto.nome&&""!==this.produto.nome.trim()?this.produto.grupo_id?this.produto.classe_id?this.produto.descricao&&""!==this.produto.descricao.trim()?!this.cnpjValidado||this.cnpjInvalido?(this.$swal({icon:"error",title:"Erro de valida√ß√£o",text:"O CNPJ informado √© inv√°lido"}),!1):(this.arquivosInvalidos.length>0&&this.$swal({icon:"error",title:"Arquivos inv√°lidos",text:"Alguns arquivos selecionados n√£o s√£o PDFs v√°lidos e n√£o ser√£o enviados."}),!0):(this.$swal({icon:"error",title:"Erro de valida√ß√£o",text:"A descri√ß√£o do produto √© obrigat√≥ria"}),!1):(this.$swal({icon:"error",title:"Erro de valida√ß√£o",text:"Selecione uma classe para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de valida√ß√£o",text:"Selecione um grupo para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de valida√ß√£o",text:"O nome do produto √© obrigat√≥rio"}),!1)},convertToUUID(a){if(!a)return null;const t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(t.test(a))return console.log("categoria_id j√° √© um UUID v√°lido:",a),a;const o=parseInt(a,10);if(isNaN(o))return console.warn("categoria_id n√£o √© um n√∫mero nem UUID v√°lido:",a),(0,I.A)();const e=`00000000-0000-0000-0000-${o.toString().padStart(12,"0")}`;return console.log(`Converteu categoria_id ${a} para UUID: ${e}`),e}}},Ha=Ga;var Qa=(0,C.A)(Ha,Va,Ua,!1,null,"645c5af1",null);const Ya=Qa.exports,Ka={name:"Cadastro",components:{CadastroProduto:Ya},data(){return{showDropdown:!1,modalEmailAberto:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await R.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usu√°rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},Wa=Ka;var Xa=(0,C.A)(Wa,qa,La,!1,null,"8173a3ba",null);const Za=Xa.exports;var at=function(){var a=this,t=a._self._c;return t("div",{staticClass:"analise-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("‚ñº")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("AnaliseProduto",{attrs:{id:a.produtoId}})],1)])},tt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])}],ot=function(){var a=this,t=a._self._c;return t("div",{staticClass:"analise-container"},[a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando...")])]):a.produto?t("div",{staticClass:"produto-analise"},[t("h2",[a._v("An√°lise de Produto")]),t("div",{staticClass:"produto-info"},[t("div",{staticClass:"produto-header"},[t("h3",[a._v(a._s(a.produto.nome))]),t("div",{staticClass:"produto-actions"},["pendente"===a.produto.status?t("button",{staticClass:"btn-diligencia",on:{click:function(t){return a.solicitarDiligencia(a.produto.id)}}},[a._v(" üîç Solicitar Dilig√™ncia ")]):a._e(),"diligencia"===a.produto.status?t("button",{staticClass:"btn-ver-diligencias",on:{click:function(t){return a.visualizarDiligencias(a.produto.id)}}},[a._v(" üìã Ver Dilig√™ncias ")]):a._e()])]),t("div",{staticClass:"info-grid"},[t("div",{staticClass:"info-item"},[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produto.marca)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produto.modelo)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produto.fabricante)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produto.cnpj)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Origem:")]),a._v(" "+a._s(a.produto.origem||"N√£o informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Registro na Anvisa/MS:")]),a._v(" "+a._s(a.produto.registro_anvisa||"N√£o informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CBPF:")]),a._v(" "+a._s(a.produto.cbpf||"N√£o informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("C√≥digo do Material:")]),a._v(" "+a._s(a.produto.codigo_material||"N√£o informado")+" ")]),t("div",{staticClass:"info-item full-width"},[t("strong",[a._v("Descri√ß√£o:")]),a._v(" "+a._s(a.produto.descricao||"N√£o informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Status Atual:")]),t("span",{staticClass:"status-pill",class:a.getStatusClass(a.produto.status)},[a._v(" "+a._s(a.produto.status)+" ")])]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Data de Cadastro:")]),a._v(" "+a._s(a.formatDate(a.produto.criado_em))+" ")])])]),a.documentos.length>0?t("div",{staticClass:"documentos-section"},[t("h3",[a._v("Documentos")]),t("div",{staticClass:"documentos-list"},a._l(a.documentos,(function(o){return t("div",{key:o.id,staticClass:"documento-item"},[t("div",{staticClass:"doc-icon"},[a._v("üìÑ")]),t("div",{staticClass:"doc-info"},[t("p",{staticClass:"doc-name"},[a._v(a._s(o.nome))]),t("p",{staticClass:"doc-type"},[a._v(a._s(o.tipo))])]),t("a",{staticClass:"doc-action",attrs:{href:o.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),t("div",{staticClass:"analise-form"},[t("h3",[a._v("Parecer T√©cnico")]),a.produto?t("div",{staticClass:"edital-section"},[t("div",{staticClass:"edital-info"},[t("h4",[a._v("üìã Edital de Pr√©-Qualifica√ß√£o")]),a.produto.edital_prequalificacao?t("div",{staticClass:"edital-vinculado"},[t("div",{staticClass:"edital-badge"},[t("span",{staticClass:"edital-icon"},[a._v("‚úÖ")]),t("span",{staticClass:"edital-text"},[a._v(a._s(a.produto.edital_prequalificacao))])]),t("button",{staticClass:"btn-edital-alterar",attrs:{type:"button"},on:{click:a.abrirModalVincularEdital}},[a._v(" üîÑ Alterar Edital ")])]):t("div",{staticClass:"edital-nao-vinculado"},[a._m(0),t("button",{staticClass:"btn-edital-vincular",attrs:{type:"button"},on:{click:a.abrirModalVincularEdital}},[a._v(" üîó Vincular Edital ")])])])]):a._e(),t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarAnalise.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"parecer"}},[a._v("Observa√ß√µes / Parecer")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.parecer,expression:"analise.parecer"}],attrs:{id:"parecer",rows:"4",required:""},domProps:{value:a.analise.parecer},on:{input:function(t){t.target.composing||a.$set(a.analise,"parecer",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Decis√£o")]),t("div",{staticClass:"radio-group"},[t("label",{staticClass:"radio-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"aprovado",required:""},domProps:{checked:a._q(a.analise.status,"aprovado")},on:{change:function(t){return a.$set(a.analise,"status","aprovado")}}}),a._v(" Aprovar ")]),t("label",{staticClass:"radio-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"reprovado",required:""},domProps:{checked:a._q(a.analise.status,"reprovado")},on:{change:function(t){return a.$set(a.analise,"status","reprovado")}}}),a._v(" Reprovar ")])])]),"reprovado"===a.analise.status?t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"motivacao"}},[a._v("Motiva√ß√£o da Reprova√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.motivacao,expression:"analise.motivacao"}],attrs:{id:"motivacao",rows:"6",placeholder:"Descreva detalhadamente os motivos que levaram √† reprova√ß√£o deste produto",required:""},domProps:{value:a.analise.motivacao},on:{input:function(t){t.target.composing||a.$set(a.analise,"motivacao",t.target.value)}}}),t("small",{staticClass:"helper-text"},[a._v("Este campo ser√° exibido ao fornecedor para justificar a reprova√ß√£o do produto")])]):a._e(),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.submitting}},[a._v(" "+a._s(a.submitting?"Salvando...":"Salvar An√°lise")+" ")]),t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.voltar}},[a._v(" Voltar ")])])])]),a.analisesAnteriores.length>0?t("div",{staticClass:"analises-anteriores"},[t("h3",[a._v("An√°lises Anteriores")]),a._l(a.analisesAnteriores,(function(o){return t("div",{key:o.id,staticClass:"analise-historico"},[t("div",{staticClass:"analise-header"},[t("span",{staticClass:"status-pill",class:a.getStatusClass(o.status)},[a._v(a._s(o.status))]),t("span",{staticClass:"analise-data"},[a._v(a._s(a.formatDate(o.criado_em)))])]),t("div",{staticClass:"analise-conteudo"},[a.produto.edital_prequalificacao?t("div",{staticClass:"edital-referencia"},[t("strong",[a._v(a._s(a.produto.edital_prequalificacao))])]):a._e(),t("p",[a._v(a._s(o.parecer))]),"reprovado"===o.status&&o.motivacao?t("div",{staticClass:"motivacao-reprovacao"},[t("h4",[a._v("Motiva√ß√£o da Reprova√ß√£o:")]),t("p",[a._v(a._s(o.motivacao))])]):a._e()])])}))],2):a._e()]):t("div",{staticClass:"not-found"},[t("p",[a._v("Produto n√£o encontrado ou voc√™ n√£o tem permiss√£o para visualiz√°-lo.")]),t("button",{staticClass:"btn-secondary",on:{click:a.voltar}},[a._v("Voltar")])]),a.modalVincularEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVincularEdital}},[t("div",{staticClass:"modal-content vincular-edital-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üîó Vincular Edital de Pr√©-Qualifica√ß√£o")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalVincularEdital}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-info-display"},[t("h4",[a._v("üì¶ Produto:")]),t("p",[t("strong",[a._v(a._s(a.produto?.nome))]),a._v(" - "+a._s(a.produto?.marca)+" "+a._s(a.produto?.modelo))])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.vincularEdital.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"editalSelect"}},[a._v("üìã Selecionar Edital Existente *")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.editalSelecionado,expression:"editalSelecionado"}],attrs:{id:"editalSelect",required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.editalSelecionado=t.target.multiple?o:o[0]}}},[t("option",{attrs:{value:""}},[a._v("Selecione um edital...")]),a._l(a.editaisDisponiveis,(function(o){return t("option",{key:o.id,domProps:{value:o}},[a._v(" Edital n¬∫ "+a._s(o.numero)+" - "+a._s(o.objeto)+" ")])}))],2)]),a.editalSelecionado?t("div",{staticClass:"edital-preview"},[t("h5",[a._v("üëÅÔ∏è Pr√©-visualiza√ß√£o:")]),t("div",{staticClass:"preview-content"},[t("p",[t("strong",[a._v("N√∫mero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),t("p",[t("strong",[a._v("Objeto:")]),a._v(" "+a._s(a.editalSelecionado.objeto))]),t("p",[t("strong",[a._v("Data de Publica√ß√£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_publicacao)))]),t("div",{staticClass:"preview-resultado"},[t("strong",[a._v("Resultado da vincula√ß√£o:")]),t("span",{staticClass:"edital-resultado"},[a._v("Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ "+a._s(a.editalSelecionado.numero))])])])]):a._e()])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalVincularEdital}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!a.editalSelecionado||a.salvandoVinculacao},on:{click:a.vincularEdital}},[a.salvandoVinculacao?t("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoVinculacao?"Vinculando...":"Vincular Edital")+" ")])])])]):a._e()])},et=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"edital-alerta"},[t("span",{staticClass:"alerta-icon"},[a._v("‚ö†Ô∏è")]),t("span",[a._v("Nenhum edital vinculado a este produto")])])}],it=o(3405);const st={name:"AnaliseProduto",props:{id:{type:String,required:!0}},data(){return{produto:null,documentos:[],analisesAnteriores:[],analise:{parecer:"",status:"",motivacao:""},modalVincularEdital:!1,editaisDisponiveis:[],editalSelecionado:null,salvandoVinculacao:!1,loading:!0,submitting:!1}},created(){this.carregarDados()},methods:{async carregarDados(){try{this.loading=!0;const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("id",this.id).single();if(t)throw t;this.produto=a;const{data:o,error:e}=await R.ND.from("documentos").select("*").eq("produto_id",this.id);if(e)throw e;this.documentos=o||[];const{data:i,error:s}=await R.ND.from("analises").select("*").eq("produto_id",this.id).order("criado_em",{ascending:!1});if(s)throw s;this.analisesAnteriores=i||[]}catch(a){console.error("Erro ao carregar dados:",a),alert("Erro ao carregar dados do produto. Por favor, tente novamente.")}finally{this.loading=!1}},async salvarAnalise(){try{if(this.submitting=!0,"reprovado"===this.analise.status&&!this.analise.motivacao)return this.$swal({icon:"error",title:"Campo obrigat√≥rio",text:"√â necess√°rio preencher a motiva√ß√£o da reprova√ß√£o"}),void(this.submitting=!1);const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;let o;if(t){console.log("Usu√°rio autenticado:",t.email);const{data:a,error:e}=await R.ND.from("usuarios").select("id").eq("email",t.email).maybeSingle();if(e&&console.error("Erro ao buscar ID do usu√°rio:",e),a?.id)console.log("ID do usu√°rio encontrado na tabela usuarios:",a.id),o=a.id;else{console.warn("Usu√°rio n√£o encontrado na tabela, gerando UUID"),o=this.gerarUUID();const{error:a}=await R.ND.from("usuarios").insert({id:o,email:t.email,nome:t.email.split("@")[0],tenant_id:this.produto.tenant_id,tipo:"avaliador",ativo:!0});a&&console.error("Erro ao criar usu√°rio automaticamente:",a)}}else console.warn("Nenhum usu√°rio autenticado, gerando UUID"),o=this.gerarUUID();console.log("Salvando an√°lise com avaliador_id:",o);const e={produto_id:this.id,tenant_id:this.produto.tenant_id,avaliador_id:o,parecer:this.analise.parecer,status:this.analise.status};"reprovado"===this.analise.status&&(e.motivacao=this.analise.motivacao);const{error:i}=await R.ND.from("analises").insert(e);if(i)throw console.error("Erro detalhado ao salvar an√°lise:",i),new Error(`Erro ao salvar an√°lise: ${i.message}`);const{error:s}=await R.ND.from("produtos").update({status:this.analise.status}).eq("id",this.id);if(s)throw s;this.$swal({icon:"success",title:"An√°lise salva com sucesso!",showConfirmButton:!1,timer:1500}),await this.carregarDados(),this.analise={parecer:"",status:"",motivacao:""}}catch(a){console.error("Erro ao salvar an√°lise:",a);let t="Erro ao salvar an√°lise.";a.message&&a.message.includes("uuid")?t="Erro no formato de identifica√ß√£o. Este problema foi corrigido, tente novamente.":a.message&&(t=a.message),this.$swal({icon:"error",title:"Erro ao processar an√°lise",text:t})}finally{this.submitting=!1}},formatDate(a){if(!a)return"";const t=new Date(a);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";default:return""}},voltar(){this.$router.push("/dashboard")},gerarUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const t=16*Math.random()|0,o="x"==a?t:3&t|8;return o.toString(16)}))},async abrirModalVincularEdital(){this.modalVincularEdital=!0,await this.carregarEditaisDisponiveis()},fecharModalVincularEdital(){this.modalVincularEdital=!1,this.editalSelecionado=null,this.editaisDisponiveis=[]},async carregarEditaisDisponiveis(){try{console.log("Carregando editais para tenant:",this.produto.tenant_id);const{data:a,error:t}=await R.ND.from("editais").select("*").eq("tenant_id",this.produto.tenant_id).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(t)throw console.error("Erro detalhado ao carregar editais:",t),t;console.log("Editais encontrados:",a),this.editaisDisponiveis=a||[],0===this.editaisDisponiveis.length&&this.$swal({icon:"info",title:"Nenhum edital encontrado",text:'N√£o h√° editais publicados dispon√≠veis para vincula√ß√£o. Verifique se existem editais com status "PUBLICADO" para este √≥rg√£o.'})}catch(a){console.error("Erro ao carregar editais dispon√≠veis:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel carregar os editais dispon√≠veis. Tente novamente."}),this.editaisDisponiveis=[]}},async vincularEdital(){if(this.editalSelecionado){this.salvandoVinculacao=!0;try{const a=`Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ ${this.editalSelecionado.numero}`,{error:t}=await R.ND.from("produtos").update({edital_prequalificacao:a,edital_id:this.editalSelecionado.id,updated_at:(new Date).toISOString()}).eq("id",this.produto.id).eq("tenant_id",this.produto.tenant_id);if(t)throw t;this.produto.edital_prequalificacao=a,this.produto.edital_id=this.editalSelecionado.id,this.$swal({icon:"success",title:"Sucesso!",text:"Edital vinculado com sucesso!",timer:2e3,showConfirmButton:!1}),this.fecharModalVincularEdital()}catch(a){console.error("Erro ao vincular edital:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel vincular o edital. Tente novamente."})}finally{this.salvandoVinculacao=!1}}},async solicitarDiligencia(a){try{const{value:t}=await this.$swal({title:"üîç Solicitar Dilig√™ncia",html:'\n            <div style="text-align: left; padding: 10px;">\n              <div style="margin-bottom: 20px;">\n                <label for="tipo_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  üìã Tipo de Dilig√™ncia:\n                </label>\n                <select id="tipo_diligencia" class="swal2-input" style="width: 100%; font-size: 14px;">\n                  <option value="">Selecione o tipo</option>\n                  <option value="DOCUMENTACAO_FALTANTE">üìÑ Documenta√ß√£o Faltante</option>\n                  <option value="AMOSTRA_INADEQUADA">üî¨ Amostra Inadequada</option>\n                  <option value="ESPECIFICACAO_INCOMPLETA">üìù Especifica√ß√£o Incompleta</option>\n                  <option value="CERTIFICACAO_PENDENTE">‚úÖ Certifica√ß√£o Pendente</option>\n                  <option value="ESCLARECIMENTO_TECNICO">üîß Esclarecimento T√©cnico</option>\n                  <option value="OUTRO">‚úèÔ∏è Outro (especificar)</option>\n                </select>\n                <div id="tipo_outro_container" style="display: none; margin-top: 10px;">\n                  <input \n                    type="text" \n                    id="tipo_outro_texto" \n                    class="swal2-input" \n                    placeholder="Digite o tipo de dilig√™ncia..."\n                    style="width: 100%; font-size: 14px;"\n                  >\n                </div>\n              </div>\n              \n              <div style="margin-bottom: 20px;">\n                <label for="descricao_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  ‚úçÔ∏è Descri√ß√£o Detalhada:\n                </label>\n                <textarea \n                  id="descricao_diligencia" \n                  class="swal2-textarea" \n                  placeholder="Descreva detalhadamente o que precisa ser providenciado pelo fornecedor..."\n                  style="width: 100%; min-height: 120px; font-size: 14px; line-height: 1.5;"\n                ></textarea>\n              </div>\n              \n              <div style="margin-bottom: 20px; padding: 15px; background: #e8f4fd; border-left: 4px solid #3498db; border-radius: 4px;">\n                <div style="display: flex; align-items: center; margin-bottom: 8px;">\n                  <span style="font-size: 18px; margin-right: 8px;">‚è∞</span>\n                  <strong style="color: #2c3e50;">Prazo para Resposta:</strong>\n                </div>\n                <p style="margin: 0; color: #34495e; font-size: 14px;">\n                  <strong>30 dias √∫teis</strong> (padr√£o do sistema)\n                </p>\n                <small style="color: #6c757d; font-size: 12px; margin-top: 5px; display: block;">\n                  üìÖ A data limite ser√° calculada automaticamente excluindo fins de semana\n                </small>\n              </div>\n            </div>\n          ',width:"600px",focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üì§ Enviar Dilig√™ncia",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#f39c12",cancelButtonColor:"#6c757d",didOpen:()=>{const a=document.getElementById("tipo_diligencia"),t=document.getElementById("tipo_outro_container");a.addEventListener("change",(function(){"OUTRO"===this.value?(t.style.display="block",setTimeout((()=>{document.getElementById("tipo_outro_texto").focus()}),100)):t.style.display="none"}))},preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,t=document.getElementById("tipo_outro_texto").value,o=document.getElementById("descricao_diligencia").value,e=30;let i=a;if("OUTRO"===a){if(!t||t.trim().length<3)return this.$swal.showValidationMessage("‚ö†Ô∏è Por favor, especifique o tipo de dilig√™ncia (m√≠nimo 3 caracteres)"),!1;i=t.trim()}return a?!o||o.trim().length<20?(this.$swal.showValidationMessage("‚ö†Ô∏è A descri√ß√£o deve ter pelo menos 20 caracteres"),!1):{tipo:i,descricao:o,prazo:e}:(this.$swal.showValidationMessage("‚ö†Ô∏è Por favor, selecione o tipo de dilig√™ncia"),!1)}});t&&await this.salvarDiligencia(a,t)}catch(t){console.error("Erro ao solicitar dilig√™ncia:",t)}},async salvarDiligencia(a,t){try{if(!this.produto.email_fornecedor)return void this.$swal({title:"‚ö†Ô∏è Email do Fornecedor Necess√°rio",text:"Para enviar a dilig√™ncia, √© necess√°rio que o produto tenha o email do fornecedor cadastrado. Deseja continuar sem enviar email?",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar sem Email",cancelButtonText:"Cancelar",confirmButtonColor:"#f39c12"}).then((async o=>{o.isConfirmed&&await this.processarDiligencia(a,t,!1)}));await this.processarDiligencia(a,t,!0)}catch(o){console.error("Erro ao salvar dilig√™ncia:",o),this.$swal({title:"‚ùå Erro",text:"Erro ao solicitar dilig√™ncia",icon:"error"})}},async processarDiligencia(a,t,o=!0){try{const i=this.calcularDataUtil(new Date,t.prazo),{data:s,error:r}=await R.ND.from("diligencias").insert({produto_id:a,tenant_id:this.produto.tenant_id,tipo:t.tipo,descricao:t.descricao,prazo_dias:t.prazo,data_limite:i.toISOString(),status:"PENDENTE",solicitado_por:"CPM"}).select().single();if(r)throw r;const{error:n}=await R.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(n)throw n;let l=!1;if(o&&this.produto.email_fornecedor)try{const a=await(0,it.lY)({destinatario:this.produto.email_fornecedor,produto:this.produto,diligencia:{...s,data_limite:i}});l=a.success,a.success||console.error("Erro no envio do email:",a.message)}catch(e){console.error("Erro ao enviar email:",e)}const c=o&&l?" O fornecedor foi notificado por email.":o&&!l?" ‚ö†Ô∏è A dilig√™ncia foi salva, mas houve erro no envio do email.":" (Sem notifica√ß√£o por email)";this.$swal({title:"‚úÖ Sucesso!",text:`Dilig√™ncia solicitada com sucesso.${c}`,icon:l||!o?"success":"warning",confirmButtonColor:"#28a745"}),await this.carregarDados()}catch(i){console.error("Erro ao processar dilig√™ncia:",i),this.$swal({title:"‚ùå Erro",text:"Erro ao processar dilig√™ncia",icon:"error"})}},async visualizarDiligencias(a){try{const{data:t,error:o}=await R.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(o)throw o;let e='<div style="text-align: left; padding: 10px;">';t&&t.length>0?(e+='<h4 style="color: #2c3e50; margin-bottom: 20px;">üìã Hist√≥rico de Dilig√™ncias:</h4>',t.forEach(((a,t)=>{const o="PENDENTE"===a.status?"#f39c12":"ATENDIDA"===a.status?"#28a745":"#dc3545",i="PENDENTE"===a.status?"‚è≥":"ATENDIDA"===a.status?"‚úÖ":"‚ùå";e+=`\n              <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin: 15px 0; background: ${"PENDENTE"===a.status?"#fff3cd":"ATENDIDA"===a.status?"#d4edda":"#f8d7da"};">\n                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                  <strong style="color: #2c3e50;">Dilig√™ncia #${t+1}</strong>\n                  <span style="color: ${o}; font-weight: bold;">\n                    ${i} ${a.status}\n                  </span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">Tipo:</strong> \n                  <span style="color: #6c757d;">${a.tipo.replace(/_/g," ")}</span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">Descri√ß√£o:</strong>\n                  <div style="background: white; padding: 10px; border-radius: 4px; margin-top: 5px; border-left: 4px solid ${o};">\n                    ${a.descricao}\n                  </div>\n                </div>\n                \n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; font-size: 12px; color: #6c757d;">\n                  <div>üìÖ <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}</div>\n                  <div>üïê <strong>Solicitado:</strong> ${this.formatDate(a.criado_em)}</div>\n                </div>\n              </div>\n            `}))):e+='\n            <div style="text-align: center; padding: 40px; color: #6c757d;">\n              <div style="font-size: 48px; margin-bottom: 15px;">üì≠</div>\n              <p>Nenhuma dilig√™ncia encontrada para este produto.</p>\n            </div>\n          ',e+="</div>",this.$swal({title:"üìã Dilig√™ncias do Produto",html:e,width:"700px",confirmButtonColor:"#007bff"})}catch(t){console.error("Erro ao carregar dilig√™ncias:",t),this.$swal({title:"‚ùå Erro",text:"Erro ao carregar dilig√™ncias do produto",icon:"error"})}},calcularDataUtil(a,t){const o=new Date(a);let e=0;while(e<t)o.setDate(o.getDate()+1),0!==o.getDay()&&6!==o.getDay()&&e++;return o}}},rt=st;var nt=(0,C.A)(rt,ot,et,!1,null,"184178ff",null);const lt=nt.exports,ct={name:"Analise",components:{AnaliseProduto:lt},data(){return{showDropdown:!1,usuarioNome:"Usu√°rio",usuarioEmail:""}},computed:{produtoId(){return this.$route.params.id}},async created(){await this.carregarDadosUsuario()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await R.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usu√°rio:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.$swal({title:"‚öôÔ∏è Configura√ß√µes",text:"Configure o email no Dashboard principal para salvar as configura√ß√µes globais.",icon:"info"})},abrirConfiguracoesEmail(){this.closeDropdown(),this.$swal({title:"üìß Configurar Email",text:"Acesse o Dashboard principal para configurar o email do sistema.",icon:"info"})},async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},dt=ct;var ut=(0,C.A)(dt,at,tt,!1,null,"3e68195d",null);const mt=ut.exports;var pt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"catalogo-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("‚ñº")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.nomeUsuario))]),t("small",[a._v(a._s(a.emailUsuario))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("CatalogoEletronico")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(2),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organiza√ß√£o")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comiss√£o de Padroniza√ß√£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comiss√£o de Padroniza√ß√£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},vt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organiza√ß√£o")])}],gt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"catalogo-container"},[t("h2",[a._v("Cat√°logo Eletr√¥nico de Bens Padronizados")]),t("div",{staticClass:"search-filters"},[t("div",{staticClass:"search-box"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.searchTerm,expression:"searchTerm"}],attrs:{type:"text",placeholder:"Buscar produto..."},domProps:{value:a.searchTerm},on:{input:[function(t){t.target.composing||(a.searchTerm=t.target.value)},a.filtrarProdutos]}})]),t("div",{staticClass:"filters"},[t("div",{staticClass:"categoria-filter"},[a._m(0),t("div",{staticClass:"dropdown"},[t("button",{staticClass:"dropdown-toggle",attrs:{type:"button"},on:{click:a.toggleCategoriaDropdown}},[a._v(" "+a._s(a.categoriaAtual)+" ")]),t("div",{staticClass:"dropdown-menu",class:{show:a.showCategoriaDropdown}},[a.carregandoCategorias?t("div",{staticClass:"dropdown-item loading"},[t("div",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status"}}),t("span",[a._v("Carregando...")])]):[t("a",{staticClass:"dropdown-item",on:{click:function(t){return a.selecionarCategoria(null)}}},[a._v("Todos os grupos")]),0===a.categorias.length?t("div",{staticClass:"dropdown-item empty"},[a._v(" Nenhum grupo dispon√≠vel ")]):a._l(a.categorias,(function(o){return t("a",{key:o.id,staticClass:"dropdown-item",class:{active:o.id===a.filtroCategoria},on:{click:function(t){return a.selecionarCategoria(o)}}},[a._v(" "+a._s(o.nome)+" ")])}))]],2)])])])]),a.produtosFiltradosOrdenados.length>0?t("div",{staticClass:"produtos-grid"},a._l(a.produtosFiltradosOrdenados,(function(o){return t("div",{key:o.id,staticClass:"produto-card",on:{click:function(t){return a.verDetalhesProduto(o.id)}}},[t("div",{staticClass:"produto-info"},[t("h3",[a._v(a._s(o.nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(o.marca))]),t("div",{staticClass:"status-marca"},[t("span",{staticClass:"status-badge",class:a.getStatusMarcaClass(o)},[a._v(a._s(a.getStatusMarca(o)))])]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(o.modelo))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(o.fabricante))])])])})),0):t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhum produto encontrado.")])]),a.produtoSelecionado?t("div",{staticClass:"produto-modal",on:{click:function(t){return t.target!==t.currentTarget?null:a.fecharModal.apply(null,arguments)}}},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.produtoSelecionado.nome))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModal}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-detalhes"},[t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj))]),t("p",[t("strong",[a._v("C√≥digo Material:")]),a._v(" "+a._s(a.produtoSelecionado.codigo_material))]),a.produtoSelecionado.descricao?t("p",[t("strong",[a._v("Descri√ß√£o:")]),a._v(" "+a._s(a.produtoSelecionado.descricao))]):a._e(),t("div",{staticClass:"avaliacoes-section"},[t("div",{staticClass:"avaliacoes-header",class:{active:a.showAvaliacoes},on:{click:a.toggleAvaliacoes}},[t("h4",[a._v("Avalia√ß√µes de Desempenho (RDM)")]),t("div",{staticClass:"avaliacao-summary"},[a.avaliacaoMedia>0?t("div",{staticClass:"stars-container"},[t("div",{staticClass:"stars"},a._l(5,(function(o){return t("span",{key:o,staticClass:"star",class:{filled:a.avaliacaoMedia>=o,half:a.avaliacaoMedia>=o-.5&&a.avaliacaoMedia<o}},[a._v("‚òÖ")])})),0),t("span",{staticClass:"rating-number"},[a._v(a._s(a.avaliacaoMedia))]),t("span",{staticClass:"rating-count"},[a._v("("+a._s(a.avaliacoes.length)+" avalia√ß√µes)")])]):t("div",{staticClass:"no-ratings"},[a._v(" Sem avalia√ß√µes ainda ")]),t("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showAvaliacoes?"‚ñ≤":"‚ñº"))])])]),a.showAvaliacoes?t("div",{staticClass:"avaliacoes-content"},[0===a.avaliacoes.length?t("div",{staticClass:"no-avaliacoes"},[a._v(" Este produto ainda n√£o possui avalia√ß√µes de desempenho. ")]):t("div",{staticClass:"avaliacoes-list"},a._l(a.avaliacoes,(function(o,e){return t("div",{key:e,staticClass:"avaliacao-item"},[t("div",{staticClass:"avaliacao-header"},[t("span",{staticClass:"avaliacao-tipo",class:o.tipo.toLowerCase()},[a._v(" "+a._s(o.tipo)+" ")]),t("div",{staticClass:"avaliacao-stars"},a._l(5,(function(e){return t("span",{key:e,staticClass:"star",class:{filled:o.avaliacao>=e}},[a._v("‚òÖ")])})),0)]),o.comentario?t("div",{staticClass:"avaliacao-comentario"},[a._v(" "+a._s(o.comentario)+" ")]):a._e(),t("div",{staticClass:"avaliacao-footer"},[t("span",{staticClass:"avaliador"},[a._v(a._s(o.avaliador))]),t("span",{staticClass:"avaliacao-data"},[a._v(a._s(a.formatarData(o.data)))])])])})),0)]):a._e()]),t("div",{staticClass:"tabs-container mt-4"},[t("div",{staticClass:"tabs-header"},[t("button",{staticClass:"tab-button",class:{active:"avaliacoes"===a.activeTab},on:{click:function(t){return a.setActiveTab("avaliacoes")}}},[t("span",[a._v("Avalia√ß√µes de Usu√°rios")]),t("div",{staticClass:"tab-info"},[a.avaliacoes.length>0?t("span",{staticClass:"tab-badge"},[a._v(a._s(a.avaliacoes.length))]):a._e(),t("span",{staticClass:"toggle-icon"},[a._v(a._s("avaliacoes"===a.activeTab&&a.showAvaliacoesContent?"‚ñ≤":"‚ñº"))])])]),t("button",{staticClass:"tab-button",class:{active:"reclamacoes"===a.activeTab},on:{click:function(t){return a.setActiveTab("reclamacoes")}}},[t("span",[a._v("Reclama√ß√µes de Usu√°rios")]),t("div",{staticClass:"tab-info"},[a.reclamacoes.length>0?t("span",{staticClass:"tab-badge"},[a._v(a._s(a.reclamacoes.length))]):a._e(),t("span",{staticClass:"toggle-icon"},[a._v(a._s("reclamacoes"===a.activeTab&&a.showReclamacoesContent?"‚ñ≤":"‚ñº"))])])])]),t("div",{staticClass:"tabs-content"},["avaliacoes"===a.activeTab?t("div",{staticClass:"tab-panel"},[t("div",{staticClass:"tab-header-toggle",on:{click:a.toggleAvaliacoesContent}},[t("h5",[a._v("Lista de Avalia√ß√µes")]),t("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showAvaliacoesContent?"‚ñ≤":"‚ñº"))])]),a.showAvaliacoesContent?t("div",{staticClass:"tab-content-collapsible"},[0===a.avaliacoes.length?t("div",{staticClass:"no-avaliacoes"},[a._v(" Este produto ainda n√£o possui avalia√ß√µes de desempenho. ")]):t("div",{staticClass:"avaliacoes-list"},a._l(a.avaliacoes,(function(o,e){return t("div",{key:e,staticClass:"avaliacao-item"},[t("div",{staticClass:"avaliacao-header"},[t("span",{staticClass:"avaliacao-tipo",class:o.tipo.toLowerCase()},[a._v(" "+a._s(o.tipo)+" ")]),t("div",{staticClass:"avaliacao-stars"},a._l(5,(function(e){return t("span",{key:e,staticClass:"star",class:{filled:o.avaliacao>=e}},[a._v("‚òÖ")])})),0)]),o.comentario?t("div",{staticClass:"avaliacao-comentario"},[a._v(" "+a._s(o.comentario)+" ")]):a._e(),t("div",{staticClass:"avaliacao-footer"},[t("span",{staticClass:"avaliador"},[a._v(a._s(o.avaliador))]),t("span",{staticClass:"avaliacao-data"},[a._v(a._s(a.formatarData(o.data)))])]),o.ciencia_cpm||o.manifestacao_cpm?t("div",{staticClass:"cpm-response"},[a._m(1,!0),o.ciencia_cpm?t("div",{staticClass:"cpm-ciencia"},[t("strong",[a._v("Ci√™ncia:")]),a._v(" "+a._s(a.formatarData(o.ciencia_cpm))+" ")]):a._e(),o.manifestacao_cpm?t("div",{staticClass:"cpm-manifestacao"},[t("strong",[a._v("Manifesta√ß√£o:")]),a._v(" "+a._s(o.manifestacao_cpm)+" ")]):a._e()]):a._e()])})),0)]):a._e()]):a._e(),"reclamacoes"===a.activeTab?t("div",{staticClass:"tab-panel"},[t("div",{staticClass:"tab-header-toggle",on:{click:a.toggleReclamacoesContent}},[t("h5",[a._v("Lista de Reclama√ß√µes")]),t("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showReclamacoesContent?"‚ñ≤":"‚ñº"))])]),a.showReclamacoesContent?t("div",{staticClass:"tab-content-collapsible"},[0===a.reclamacoes.length?t("div",{staticClass:"text-center text-muted py-3"},[a._v(" Nenhuma reclama√ß√£o registrada ")]):t("div",{staticClass:"reclamacoes-list"},a._l(a.reclamacoesSorted,(function(o){return t("div",{key:o.id,staticClass:"reclamacao-item"},[t("div",{staticClass:"reclamacao-header"},[t("div",{staticClass:"d-flex align-items-center"},[t("span",{staticClass:"badge",class:a.getStatusBadgeClass(o.status)},[a._v(a._s(o.status))]),t("span",{staticClass:"reclamante-nome"},[a._v(a._s(o.nome_reclamante))]),t("span",{staticClass:"reclamante-setor"},[a._v(a._s(o.unidade_setor))])]),t("span",{staticClass:"reclamacao-data"},[a._v(a._s(a.formatDate(o.data_reclamacao)))])]),t("div",{staticClass:"reclamacao-content"},[t("div",{staticClass:"problema-box"},[t("h6",{staticClass:"box-title"},[a._v("Problema Reportado:")]),t("p",{staticClass:"box-text"},[a._v(a._s(o.registro_reclamacao))])]),o.sugestoes?t("div",{staticClass:"sugestao-box"},[t("h6",{staticClass:"box-title"},[a._v("Sugest√µes de Melhoria:")]),t("p",{staticClass:"box-text"},[a._v(a._s(o.sugestoes))])]):a._e(),o.providencias_cpm?t("div",{staticClass:"providencias-box"},[t("h6",{staticClass:"box-title"},[a._v("Provid√™ncias Tomadas:")]),t("p",{staticClass:"box-text"},[a._v(a._s(o.providencias_cpm))])]):a._e()])])})),0)]):a._e()]):a._e()])]),t("div",{staticClass:"documentos-section"},[t("h4",[a._v("Documentos e Padroniza√ß√£o")]),t("div",{staticClass:"padronizacao-info"},[t("div",{staticClass:"info-row"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[a._v("Padroniza√ß√£o:")]),t("span",{staticClass:"info-value"},[a._v(" "+a._s(a.produtoSelecionado.edital_prequalificacao||"Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ ______/____")+" ")]),a.produtoSelecionado.edital_prequalificacao?a._e():t("button",{staticClass:"btn-action btn-vincular",on:{click:a.abrirModalVincularEdital}},[a._v(" üîó Vincular Edital ")])])]),a.produtoSelecionado.processo_cancelamento?t("div",{staticClass:"info-row"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[a._v("Despadroniza√ß√£o:")]),t("span",{staticClass:"info-value"},[a._v(" "+a._s(a.produtoSelecionado.processo_cancelamento||"Processo de cancelamento da DCB n¬∫ _______/____")+" ")])])]):a._e(),t("div",{staticClass:"info-row"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[a._v("Status Atual:")]),t("span",{staticClass:"status-badge",class:a.getStatusMarcaClass(a.produtoSelecionado)},[a._v(" "+a._s(a.getStatusMarca(a.produtoSelecionado))+" ")]),"Em Vigor"!==a.getStatusMarca(a.produtoSelecionado)||a.produtoSelecionado.processo_cancelamento?a._e():t("button",{staticClass:"btn-action btn-despadronizar",on:{click:a.abrirModalDespadronizar}},[a._v(" ‚ùå Despadronizar ")])])]),a.produtoSelecionado.validade_dcb?t("div",{staticClass:"info-row"},[t("div",{staticClass:"info-item"},[t("span",{staticClass:"info-label"},[a._v("Validade DCB:")]),t("span",{staticClass:"info-value"},[a._v(" "+a._s(a.formatarData(a.produtoSelecionado.validade_dcb))+" ")])])]):a._e()]),a.documentos.length>0?t("div",{staticClass:"documentos-anexos"},[t("h5",[a._v("Documentos Anexos")]),t("ul",a._l(a.documentos,(function(o){return t("li",{key:o.id},[t("a",{attrs:{href:o.arquivo_url,target:"_blank"}},[a._v(a._s(o.nome))])])})),0)]):a._e()])])])])]):a._e(),a.modalVincularEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVincularEdital}},[t("div",{staticClass:"modal-content vincular-edital-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("Vincular Edital de Pr√©-Qualifica√ß√£o")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalVincularEdital}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-info-display"},[t("h4",[a._v("Produto:")]),t("p",[t("strong",[a._v(a._s(a.produtoSelecionado?.nome))]),a._v(" - "+a._s(a.produtoSelecionado?.marca)+" "+a._s(a.produtoSelecionado?.modelo))])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.vincularEdital.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"editalSelect"}},[a._v("Selecionar Edital Existente *")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.editalSelecionado,expression:"editalSelecionado"}],attrs:{id:"editalSelect",required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.editalSelecionado=t.target.multiple?o:o[0]}}},[t("option",{attrs:{value:""}},[a._v("Selecione um edital...")]),a._l(a.editaisDisponiveis,(function(o){return t("option",{key:o.id,domProps:{value:o}},[a._v(" "+a._s(o.numero)+" - "+a._s(o.descricao)+" ")])}))],2)]),a.editalSelecionado?t("div",{staticClass:"edital-preview"},[t("h5",[a._v("Detalhes do Edital Selecionado:")]),t("p",[t("strong",[a._v("N√∫mero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),t("p",[t("strong",[a._v("Descri√ß√£o:")]),a._v(" "+a._s(a.editalSelecionado.descricao))]),a.editalSelecionado.data_publicacao?t("p",[t("strong",[a._v("Data de Publica√ß√£o:")]),a._v(" "+a._s(a.formatarData(a.editalSelecionado.data_publicacao)))]):a._e(),t("p",[t("strong",[a._v("Status:")]),a._v(" "+a._s(a.editalSelecionado.status))])]):a._e()])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalVincularEdital}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!a.editalSelecionado||a.salvandoVinculacao},on:{click:a.vincularEdital}},[a.salvandoVinculacao?t("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoVinculacao?"Vinculando...":"Vincular Edital")+" ")])])])]):a._e(),a.modalDespadronizar?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDespadronizar}},[t("div",{staticClass:"modal-content despadronizar-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("Despadronizar Produto")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalDespadronizar}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-info-display"},[t("h4",[a._v("Produto:")]),t("p",[t("strong",[a._v(a._s(a.produtoSelecionado?.nome))]),a._v(" - "+a._s(a.produtoSelecionado?.marca)+" "+a._s(a.produtoSelecionado?.modelo))])]),a._m(2),t("form",{on:{submit:function(t){return t.preventDefault(),a.despadronizarProduto.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"numeroProcesso"}},[a._v("N√∫mero do Processo de Cancelamento *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.numero_processo,expression:"despadronizacao.numero_processo"}],attrs:{id:"numeroProcesso",type:"text",required:"",placeholder:"Ex: 2024/001"},domProps:{value:a.despadronizacao.numero_processo},on:{input:function(t){t.target.composing||a.$set(a.despadronizacao,"numero_processo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"motivoDespadronizacao"}},[a._v("Motivo da Despadroniza√ß√£o *")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.motivo,expression:"despadronizacao.motivo"}],attrs:{id:"motivoDespadronizacao",rows:"4",required:"",placeholder:"Descreva detalhadamente o motivo da despadroniza√ß√£o..."},domProps:{value:a.despadronizacao.motivo},on:{input:function(t){t.target.composing||a.$set(a.despadronizacao,"motivo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"documentoDespadronizacao"}},[a._v("Documento Comprobat√≥rio *")]),t("input",{attrs:{type:"file",id:"documentoDespadronizacao",accept:".pdf,.doc,.docx",required:""},on:{change:a.handleFileUpload}}),t("small",{staticClass:"file-info"},[a._v("Formatos aceitos: PDF, DOC, DOCX (m√°x. 10MB)")])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"dataDespadronizacao"}},[a._v("Data de Vig√™ncia da Despadroniza√ß√£o *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.data_vigencia,expression:"despadronizacao.data_vigencia"}],attrs:{id:"dataDespadronizacao",type:"date",required:""},domProps:{value:a.despadronizacao.data_vigencia},on:{input:function(t){t.target.composing||a.$set(a.despadronizacao,"data_vigencia",t.target.value)}}})])])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalDespadronizar}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:!a.formularioDespadronizacaoValido||a.salvandoDespadronizacao},on:{click:a.despadronizarProduto}},[a.salvandoDespadronizacao?t("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoDespadronizacao?"Processando...":"Confirmar Despadroniza√ß√£o")+" ")])])])]):a._e()])},_t=[function(){var a=this,t=a._self._c;return t("label",[t("strong",[a._v("Grupo:")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"cpm-header"},[t("h6",[a._v("Manifesta√ß√£o da CPM")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"warning-message"},[t("p",[t("strong",[a._v("‚ö†Ô∏è Aten√ß√£o:")]),a._v(" Esta a√ß√£o ir√° remover este produto da lista de itens padronizados.")])])}];const ft={name:"CatalogoEletronico",data(){return{produtos:[],produtosFiltrados:[],categorias:[],searchTerm:"",filtroCategoria:"",categoriaAtual:"Todos os grupos",showCategoriaDropdown:!1,showAvaliacoes:!1,showReclamacoes:!1,activeTab:"avaliacoes",showAvaliacoesContent:!1,showReclamacoesContent:!1,produtoSelecionado:null,documentos:[],avaliacoes:[],avaliacaoMedia:0,carregandoCategorias:!0,categoriaSelecionada:null,currentTenantId:null,loading:!1,reclamacoes:(0,e.KR)([]),produtosDespadronizados:[],modalVincularEdital:!1,modalDespadronizar:!1,editaisDisponiveis:[],editalSelecionado:null,salvandoVinculacao:!1,salvandoDespadronizacao:!1,despadronizacao:{numero_processo:"",motivo:"",data_vigencia:"",arquivo:null}}},created(){this.obterTenantId().then((()=>{this.carregarDados()})),document.addEventListener("click",this.closeDropdownOnClickOutside)},mounted(){this.carregarCategoriasDireto(),this.showCategoriaDropdown=!1},beforeUnmount(){document.removeEventListener("click",this.closeDropdownOnClickOutside)},methods:{async obterTenantId(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usu√°rio n√£o est√° autenticado");if(t.user_metadata?.tenant_id)return this.currentTenantId=t.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:o,error:e}=await R.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);o?.tenant_id?(this.currentTenantId=o.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID n√£o encontrado para o usu√°rio")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){console.log("Iniciando carregamento de dados"),this.carregandoCategorias=!0,this.loading=!0;try{if(!this.currentTenantId&&(console.error("Tenant ID n√£o dispon√≠vel. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return console.error("N√£o foi poss√≠vel obter o tenant_id, imposs√≠vel carregar dados"),void this.$swal({icon:"error",title:"Erro ao carregar dados",text:"N√£o foi poss√≠vel identificar sua conta. Por favor, fa√ßa login novamente."});console.log("Buscando categorias do Supabase...");const{data:a,error:t}=await R.ND.from("categorias").select("*");t?console.error("Erro ao carregar categorias:",t):(this.categorias=a||[],console.log(`${this.categorias.length} categorias carregadas`)),console.log("Buscando produtos padronizados do Supabase...");let o=R.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).in("status",["aprovado","julgado_aprovado","homologado"]);const{data:e,error:i}=await o;i?(console.error("Erro ao carregar produtos:",i),this.produtos=[]):(this.produtos=e||[],console.log(`${this.produtos.length} produtos padronizados carregados`)),await this.carregarProdutosDespadronizados(),this.filtrarProdutos()}catch(a){console.error("Erro no carregamento de dados:",a),this.$swal({icon:"error",title:"Erro ao carregar dados",text:"Ocorreu um erro ao carregar os dados. Tente novamente."})}finally{this.carregandoCategorias=!1,this.loading=!1}},async carregarProdutosDespadronizados(){try{console.log("Carregando produtos despadronizados...");const{data:a,error:t}=await R.ND.from("marcas_despadronizadas").select("produto_id").eq("tenant_id",this.currentTenantId).eq("status_atual","ativa");t?(console.error("Erro ao carregar produtos despadronizados:",t),this.produtosDespadronizados=[]):(this.produtosDespadronizados=(a||[]).filter((a=>a.produto_id)).map((a=>a.produto_id)),console.log(`${this.produtosDespadronizados.length} produtos despadronizados encontrados`))}catch(a){console.error("Erro ao carregar produtos despadronizados:",a),this.produtosDespadronizados=[]}},async carregarCategoriasDireto(){try{console.log("Tentando carregar categorias diretamente...");const{data:a,error:t}=await R.ND.from("categorias").select("*");if(t)return void console.error("Erro ao carregar categorias direto:",t);console.log("Resposta direta de categorias:",a),a&&a.length>0&&0===this.categorias.length&&(console.log("Atualizando categorias com dados diretos"),this.categorias=a)}catch(a){console.error("Exce√ß√£o ao carregar categorias direto:",a)}},filtrarProdutos(){console.log("Filtrando produtos por:",this.filtroCategoria,"e texto:",this.searchTerm),this.produtosFiltrados=this.produtos.filter((a=>{const t=!this.filtroCategoria||a.categoria_id===this.filtroCategoria,o=!this.searchTerm||a.nome.toLowerCase().includes(this.searchTerm.toLowerCase())||a.descricao&&a.descricao.toLowerCase().includes(this.searchTerm.toLowerCase());return t&&o})),console.log("Produtos filtrados:",this.produtosFiltrados.length)},async verDetalhesProduto(a){try{if(!this.currentTenantId)return void console.error("N√£o foi poss√≠vel identificar o tenant_id");const{data:t,error:o}=await R.ND.from("produtos").select("*").eq("id",a).eq("tenant_id",this.currentTenantId).single();if(o)throw console.error("Erro ao carregar produto:",o),o;if(!t)return console.error("Produto n√£o encontrado ou n√£o pertence ao tenant atual"),void this.$swal({icon:"error",title:"Produto n√£o encontrado",text:"O produto solicitado n√£o existe ou voc√™ n√£o tem permiss√£o para visualiz√°-lo."});this.produtoSelecionado=t;const{data:e,error:i}=await R.ND.from("documentos").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId);if(i)throw i;this.documentos=e||[];const[s,r]=await Promise.all([R.ND.from("material_feedbacks").select("*").eq("produto_id",a),R.ND.from("rdm_feedbacks").select("*").eq("produto_id",a)]);s.error&&console.error("Erro ao carregar feedbacks:",s.error),r.error&&console.error("Erro ao carregar feedbacks RDM:",r.error);const n=s.data||[],l=r.data||[];if(this.avaliacoes=[...n.map((a=>({id:a.id,avaliacao:a.rating||0,comentario:a.comentario,data:a.data_feedback||a.criado_em,tipo:"Feedback",avaliador:"Feedback de Usu√°rio"}))),...l.map((a=>({id:a.id,avaliacao:a.rating||0,comentario:a.comentario,data:a.data_feedback||a.criado_em,tipo:"RDM",avaliador:"Avalia√ß√£o RDM"})))],this.avaliacoes.sort(((a,t)=>new Date(t.data)-new Date(a.data))),this.avaliacoes.length>0){const a=this.avaliacoes.reduce(((a,t)=>a+t.avaliacao),0);this.avaliacaoMedia=parseFloat((a/this.avaliacoes.length).toFixed(1))}else this.avaliacaoMedia=0;await this.carregarReclamacoes()}catch(t){console.error("Erro ao carregar detalhes do produto:",t),this.$swal({icon:"error",title:"Erro ao carregar detalhes",text:"N√£o foi poss√≠vel carregar os detalhes do produto. Tente novamente."})}},fecharModal(){this.produtoSelecionado=null,this.documentos=[],this.avaliacoes=[],this.avaliacaoMedia=0,this.showAvaliacoes=!1},closeDropdownOnClickOutside(a){const t=this.$el.querySelector(".dropdown");t&&!t.contains(a.target)&&(this.showCategoriaDropdown=!1)},selecionarCategoria(a){console.log("Categoria selecionada:",a),this.categoriaSelecionada=a,this.categoriaAtual=a?a.nome:"Todos os grupos",this.filtroCategoria=a?a.id:"",this.showCategoriaDropdown=!1,this.filtrarProdutos()},toggleCategoriaDropdown(){this.showCategoriaDropdown=!this.showCategoriaDropdown},toggleAvaliacoes(){this.showAvaliacoes=!this.showAvaliacoes},toggleReclamacoes(){this.showReclamacoes=!this.showReclamacoes},setActiveTab(a){this.activeTab=a,"avaliacoes"===a?(this.showAvaliacoesContent=!0,this.showReclamacoesContent=!1):"reclamacoes"===a&&(this.showReclamacoesContent=!0,this.showAvaliacoesContent=!1)},toggleAvaliacoesContent(){this.showAvaliacoesContent=!this.showAvaliacoesContent},toggleReclamacoesContent(){this.showReclamacoesContent=!this.showReclamacoesContent},formatarData(a){if(!a)return"Data n√£o dispon√≠vel";try{const t=new Date(a);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Erro ao formatar data:",t),"Data inv√°lida"}},async carregarReclamacoes(){try{if(!this.produtoSelecionado?.codigo_material)return void console.log("C√≥digo do material n√£o encontrado no produto");console.log("Buscando reclama√ß√µes para o c√≥digo de material:",this.produtoSelecionado.codigo_material);const{data:a,error:t}=await R.ND.from("reclamacoes_usuarios").select("*").eq("codigo_material",this.produtoSelecionado.codigo_material).order("data_reclamacao",{ascending:!1});if(t)throw console.error("Erro ao carregar reclama√ß√µes:",t),t;console.log(`Reclama√ß√µes encontradas: ${a?.length||0}`,a),this.reclamacoes=a||[]}catch(a){console.error("Erro ao carregar reclama√ß√µes:",a),this.reclamacoes=[]}},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""},getStatusBadgeClass(a){const t={ABERTA:"badge-warning",EM_ANALISE:"badge-info",RESOLVIDA:"badge-success",REJEITADA:"badge-danger"};return t[a]||"badge-secondary"},getTipoAvaliacao(a){return"RDM"===a.tipo?"RDM":"FEEDBACK"===a.tipo?"Feedback":"Avalia√ß√£o"},getDocumentName(a){if(!a)return"";const t=a.split("/");return t[t.length-1]},getStatusMarca(a){if(this.produtosDespadronizados.includes(a.id))return"Despadronizado";if(!a.validade_dcb)return"Aguardando DCB";const t=new Date,o=new Date(a.validade_dcb);return o<t?"Vencido":"Em Vigor"},getStatusMarcaClass(a){const t=this.getStatusMarca(a);switch(t){case"Em Vigor":return"status-em-vigor";case"Vencido":return"status-vencido";case"Despadronizado":return"status-despadronizado";case"Aguardando DCB":return"status-aguardando-dcb";default:return"status-despadronizado"}},async abrirModalVincularEdital(){this.modalVincularEdital=!0,await this.carregarEditaisDisponiveis()},fecharModalVincularEdital(){this.modalVincularEdital=!1,this.editalSelecionado=null,this.editaisDisponiveis=[]},async carregarEditaisDisponiveis(){try{console.log("Carregando editais para tenant:",this.currentTenantId);const{data:a,error:t}=await R.ND.from("editais").select("*").eq("tenant_id",this.currentTenantId).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(t)throw console.error("Erro detalhado ao carregar editais:",t),t;console.log("Editais encontrados:",a),this.editaisDisponiveis=a||[],0===this.editaisDisponiveis.length&&this.$swal({icon:"info",title:"Nenhum edital encontrado",text:'N√£o h√° editais publicados dispon√≠veis para vincula√ß√£o. Verifique se existem editais com status "PUBLICADO" para este √≥rg√£o.'})}catch(a){console.error("Erro ao carregar editais:",a),this.$swal({icon:"error",title:"Erro",text:`N√£o foi poss√≠vel carregar os editais dispon√≠veis: ${a.message}`})}},async vincularEdital(){if(this.editalSelecionado){this.salvandoVinculacao=!0;try{const a=`Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ ${this.editalSelecionado.numero}`,{error:t}=await R.ND.from("produtos").update({edital_prequalificacao:a,edital_id:this.editalSelecionado.id,updated_at:(new Date).toISOString()}).eq("id",this.produtoSelecionado.id).eq("tenant_id",this.currentTenantId);if(t)throw t;this.produtoSelecionado.edital_prequalificacao=a,this.produtoSelecionado.edital_id=this.editalSelecionado.id,this.$swal({icon:"success",title:"Sucesso!",text:"Edital vinculado com sucesso!",timer:2e3,showConfirmButton:!1}),this.fecharModalVincularEdital()}catch(a){console.error("Erro ao vincular edital:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel vincular o edital. Tente novamente."})}finally{this.salvandoVinculacao=!1}}},abrirModalDespadronizar(){this.modalDespadronizar=!0,this.despadronizacao={numero_processo:"",motivo:"",data_vigencia:"",arquivo:null}},fecharModalDespadronizar(){this.modalDespadronizar=!1,this.despadronizacao={numero_processo:"",motivo:"",data_vigencia:"",arquivo:null}},handleFileUpload(a){const t=a.target.files[0];if(t){if(t.size>10485760)return this.$swal({icon:"error",title:"Arquivo muito grande",text:"O arquivo deve ter no m√°ximo 10MB."}),void(a.target.value="");this.despadronizacao.arquivo=t}},async despadronizarProduto(){if(this.formularioDespadronizacaoValido){this.salvandoDespadronizacao=!0;try{let a=null;if(this.despadronizacao.arquivo){const t=`despadronizacao_${this.produtoSelecionado.id}_${Date.now()}_${this.despadronizacao.arquivo.name}`,{data:o,error:e}=await R.ND.storage.from("documentos").upload(t,this.despadronizacao.arquivo);if(e)throw e;const{data:{publicUrl:i}}=R.ND.storage.from("documentos").getPublicUrl(t);a=i}const t=`Processo de cancelamento da DCB n¬∫ ${this.despadronizacao.numero_processo}`,{error:o}=await R.ND.from("produtos").update({processo_cancelamento:t,motivo_despadronizacao:this.despadronizacao.motivo,data_despadronizacao:this.despadronizacao.data_vigencia,documento_despadronizacao:a,status:"despadronizado",updated_at:(new Date).toISOString()}).eq("id",this.produtoSelecionado.id).eq("tenant_id",this.currentTenantId);if(o)throw o;this.produtoSelecionado.processo_cancelamento=t,this.produtoSelecionado.motivo_despadronizacao=this.despadronizacao.motivo,this.produtoSelecionado.data_despadronizacao=this.despadronizacao.data_vigencia,this.produtoSelecionado.documento_despadronizacao=a,this.produtoSelecionado.status="despadronizado",this.$swal({icon:"success",title:"Produto Despadronizado",text:"O produto foi despadronizado com sucesso!",timer:3e3,showConfirmButton:!1}),this.fecharModalDespadronizar()}catch(a){console.error("Erro ao despadronizar produto:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel despadronizar o produto. Tente novamente."})}finally{this.salvandoDespadronizacao=!1}}}},computed:{avaliacoesSorted(){return[...this.avaliacoes].sort(((a,t)=>{const o=new Date(a.data),e=new Date(t.data);return e-o}))},reclamacoesSorted(){return[...this.reclamacoes].sort(((a,t)=>new Date(t.data_reclamacao)-new Date(a.data_reclamacao)))},averageRating(){if(!this.avaliacoes.length)return 0;const a=this.avaliacoes.reduce(((a,t)=>a+(t.avaliacao||0)),0);return(a/this.avaliacoes.length).toFixed(1)},produtosFiltradosOrdenados(){return[...this.produtosFiltrados].sort(((a,t)=>a.nome.localeCompare(t.nome,"pt-BR",{sensitivity:"base"})))},formularioDespadronizacaoValido(){return this.despadronizacao.numero_processo&&this.despadronizacao.motivo&&this.despadronizacao.data_vigencia&&this.despadronizacao.arquivo}}},ht=ft;var Ct=(0,C.A)(ht,gt,_t,!1,null,"b7bb0506",null);const bt=Ct.exports,wt={name:"Catalogo",components:{CatalogoEletronico:bt},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}},closeDropdown(){this.dropdownOpen=!1}}},Dt=wt;var Et=(0,C.A)(Dt,pt,vt,!1,null,"13acf7d7",null);const xt=Et.exports;var yt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"feedback-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[t("div",{staticClass:"profile-avatar"},[a._v(" üë§ ")]),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("‚ñº")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ‚öôÔ∏è Configura√ß√£o ")]),t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" üìß Configurar Email ")]),t("hr",{staticClass:"dropdown-divider"}),t("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" üö™ Sair ")])]):a._e()])])]),t("main",{staticClass:"main-content"},[t("FormularioRDM")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(1),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organiza√ß√£o")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comiss√£o de Padroniza√ß√£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comiss√£o de Padroniza√ß√£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},At=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organiza√ß√£o")])}],Pt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"rdm-container"},[t("h2",[a._v("Relat√≥rio de Desempenho de Material (RDM)")]),t("form",{on:{submit:function(t){return t.preventDefault(),a.enviarFeedback.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"produto"}},[a._v("Produto*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.feedback.rdm_id,expression:"feedback.rdm_id"}],attrs:{id:"produto",required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.feedback,"rdm_id",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione o produto...")]),a._l(a.produtos,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" - "+a._s(o.codigo||"Sem c√≥digo")+" ")])}))],2)]),t("div",{staticClass:"form-group"},[t("label",[a._v("Avalia√ß√£o*")]),t("div",{staticClass:"avaliacao"},a._l(5,(function(o){return t("div",{key:o,staticClass:"estrela",class:{ativa:a.feedback.rating>=o},on:{click:function(t){a.feedback.rating=o}}},[a._v(" ‚òÖ ")])})),0)]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"comentario"}},[a._v("Justificativa da avalia√ß√£o*")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.feedback.comentario,expression:"feedback.comentario"}],attrs:{id:"comentario",rows:"4",placeholder:"Ex: Equipamento apresentou falha ap√≥s 3 meses de uso...",required:""},domProps:{value:a.feedback.comentario},on:{input:function(t){t.target.composing||a.$set(a.feedback,"comentario",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"sugestoes"}},[a._v("Sugest√µes")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.feedback.sugestoes,expression:"feedback.sugestoes"}],attrs:{id:"sugestoes",rows:"3",placeholder:"Ex: Melhorar a qualidade do material, incluir manual em portugu√™s..."},domProps:{value:a.feedback.sugestoes},on:{input:function(t){t.target.composing||a.$set(a.feedback,"sugestoes",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},St=[];const $t={name:"FormularioRDM",data(){return{feedback:{rdm_id:"",rating:0,comentario:"",sugestoes:"",material_nome:"",material_codigo:""},produtos:[],loading:!1,currentUser:null,currentTenantId:null,error:null}},created(){this.carregarProdutos(),this.obterUsuarioAtual()},methods:{async obterUsuarioAtual(){try{const{data:{session:a},error:t}=await R.ND.auth.getSession();if(t)throw t;if(!a?.user)throw new Error("Usu√°rio n√£o est√° autenticado");{this.currentUser=a.user;const{data:t,error:o}=await R.ND.from("usuarios").select("tenant_id").eq("email",a.user.email).single();if(o&&"PGRST116"!==o.code)throw o;this.currentTenantId=t?.tenant_id||a.user.user_metadata?.tenant_id||(0,I.A)()}}catch(a){console.error("Erro ao obter dados do usu√°rio:",a),this.$swal({icon:"error",title:"Erro de Autentica√ß√£o",text:"Por favor, fa√ßa login novamente para enviar um feedback."})}},async carregarProdutos(){try{if(this.currentTenantId||await this.obterUsuarioAtual(),!this.currentTenantId)throw new Error("N√£o foi poss√≠vel identificar o tenant_id");const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("status","aprovado").eq("tenant_id",this.currentTenantId).order("nome");if(t)throw t;this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),this.$swal({icon:"error",title:"Erro ao carregar produtos",text:"N√£o foi poss√≠vel carregar a lista de produtos. Por favor, recarregue a p√°gina."})}},async enviarFeedback(){if(0!==this.feedback.rating)if(this.feedback.rdm_id)if(this.feedback.comentario&&""!==this.feedback.comentario.trim())try{if(this.loading=!0,this.error=null,!this.currentUser?.email)throw new Error("Usu√°rio n√£o est√° autenticado");const{data:a,error:t}=await R.ND.from("usuarios").select("id, tenant_id").eq("email",this.currentUser.email).single();if(t&&"PGRST116"!==t.code)throw t;const o=this.produtos.find((a=>a.id===this.feedback.rdm_id));if(!o)throw new Error("Produto n√£o encontrado");const e={id:(0,I.A)(),tenant_id:this.currentTenantId,rdm_id:this.feedback.rdm_id,usuario_rdm_id:a.id,rating:this.feedback.rating,comentario:this.feedback.comentario||null,sugestoes:this.feedback.sugestoes||null,material_nome:o.nome,material_codigo:o.codigo||"N/A",criado_em:(new Date).toISOString()},{error:i}=await R.ND.from("rdm_feedbacks").insert(e);if(i)throw i;this.$swal({icon:"success",title:"Feedback enviado!",text:"Seu feedback foi enviado com sucesso."}),this.limparFormulario()}catch(a){console.error("Erro ao enviar feedback:",a);let t="Por favor, tente novamente.";"Usu√°rio n√£o est√° autenticado"===a.message?t="Por favor, fa√ßa login para enviar um feedback.":"23505"===a.code&&(t="Voc√™ j√° enviou um feedback para este produto."),this.$swal({icon:"error",title:"Erro ao enviar feedback",text:t}),this.error=a}finally{this.loading=!1}else this.$swal({icon:"warning",title:"Justificativa necess√°ria",text:"Por favor, preencha a justificativa da avalia√ß√£o."});else this.$swal({icon:"warning",title:"Produto necess√°rio",text:"Por favor, selecione um produto para avaliar."});else this.$swal({icon:"warning",title:"Avalia√ß√£o necess√°ria",text:"Por favor, selecione uma avalia√ß√£o de 1 a 5 estrelas."})},limparFormulario(){this.feedback={rdm_id:"",rating:0,comentario:"",sugestoes:"",material_nome:"",material_codigo:""},this.error=null}}},Nt=$t;var Rt=(0,C.A)(Nt,Pt,St,!1,null,"4dd1cd6a",null);const It=Rt.exports,Mt={name:"Feedback",components:{FormularioRDM:It},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},mounted(){this.carregarConfiguracoes()},methods:{async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}}}},Ft=Mt;var Tt=(0,C.A)(Ft,yt,At,!1,null,"1cd129d6",null);const zt=Tt.exports;var kt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dcb-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[t("div",{staticClass:"profile-avatar"},[a._v(" üë§ ")]),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("‚ñº")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ‚öôÔ∏è Configura√ß√£o ")]),t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" üìß Configurar Email ")]),t("hr",{staticClass:"dropdown-divider"}),t("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" üö™ Sair ")])]):a._e()])])]),t("main",{staticClass:"main-content"},[t("FormularioDCB")],1)])},Ot=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])}],Bt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dcb-container"},[t("h2",[a._v("Declara√ß√£o de Conformidade de Bem (DCB)")]),t("div",{staticClass:"search-container"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"produto"}},[a._v("Selecione o produto")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produtoSelecionado,expression:"produtoSelecionado"}],attrs:{id:"produto"},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.produtoSelecionado=t.target.multiple?o:o[0]},a.carregarDetalhes]}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.produtos,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" - "+a._s(o.marca)+" - "+a._s(o.modelo)+" ")])}))],2)])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando informa√ß√µes...")])]):a.produtoDetalhes?t("div",{staticClass:"produto-detalhes"},[t("div",{staticClass:"dcb-section"},[t("h3",[a._v("PRODUTO CERTIFICADO")]),t("div",{staticClass:"primeiro-quadro"},[a._m(0),t("div",{staticClass:"info-grid"},[t("div",{staticClass:"info-item full-width"},[t("strong",[a._v("1.1. Nome do Produto:")]),a._v(" "+a._s(a.produtoDetalhes.nome||"N√£o informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoDetalhes.marca||"N√£o informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoDetalhes.modelo||"N√£o informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoDetalhes.fabricante||"N√£o informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CNPJ do Fabricante:")]),a._v(" "+a._s(a.produtoDetalhes.cnpj||"N√£o informado")+" ")])])])]),t("div",{staticClass:"dcb-section"},[t("h3",[a._v("DADOS DA CERTIFICA√á√ÉO")]),t("div",{staticClass:"primeiro-quadro"},[a._m(1),t("div",{staticClass:"status-info"},[a._m(2),t("div",{staticClass:"info-item",staticStyle:{"margin-left":"40px"}},[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge",class:a.getStatusDCBClass()},[a._v(" "+a._s(a.getStatusDCB())+" ")])]),t("div",{staticClass:"info-item",staticStyle:{"margin-left":"40px"}},[t("strong",[a._v("1.1.1. Origem:")]),a._v(" Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ "+a._s(a.produtoDetalhes.numero_edital||"XXX/YYYY")+" ")])]),t("div",{staticClass:"info-grid"},[t("div",{staticClass:"info-item"},[t("strong",[a._v("Data de Emiss√£o:")]),a._v(" "+a._s(a.formatarData(a.produtoDetalhes.data_emissao))+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Data de Validade:")]),a._v(" "+a._s(a.formatarData(a.produtoDetalhes.data_validade))+" ")])])])]),a.documentos.length>0?t("div",{staticClass:"documentos"},[t("h3",[a._v("Documentos Anexos")]),t("ul",{staticClass:"documentos-lista"},a._l(a.documentos,(function(o){return t("li",{key:o.id,staticClass:"documento-item"},[t("span",{staticClass:"doc-icon"},[a._v("üìÑ")]),t("span",{staticClass:"doc-nome"},[a._v(a._s(o.nome))]),t("a",{staticClass:"btn-download",attrs:{href:o.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),t("div",{staticClass:"dcb-actions"},[t("div",{staticClass:"button-group"},[t("button",{staticClass:"btn-primary",attrs:{disabled:!a.produtoAprovado},on:{click:a.visualizarDCB}},[a._v(" üëÅÔ∏è Visualizar DCB ")]),t("button",{staticClass:"btn-secondary",attrs:{disabled:!a.produtoAprovado},on:{click:a.baixarDCB}},[a._v(" üì• Baixar DCB (PDF) ")])]),a.produtoAprovado?a._e():t("p",{staticClass:"aviso"},[a._v(" ‚ö†Ô∏è Somente produtos aprovados possuem Declara√ß√£o de Conformidade dispon√≠vel. ")])])]):a._e()])},qt=[function(){var a=this,t=a._self._c;return t("p",[t("strong",[a._v("1. Primeiro quadro")])])},function(){var a=this,t=a._self._c;return t("p",[t("strong",[a._v("1. Primeiro quadro")])])},function(){var a=this,t=a._self._c;return t("p",{staticStyle:{"margin-left":"20px"}},[t("strong",[a._v("1.1.")]),a._v(' Incluir abaixo de "Status":')])}],Lt=o(1749);const Vt={name:"FormularioDCB",data(){return{produtoSelecionado:"",produtoDetalhes:null,documentos:[],produtos:[],loading:!1,currentTenantId:null}},computed:{produtoAprovado(){return this.produtoDetalhes&&"aprovado"===this.produtoDetalhes.status}},created(){this.obterTenantId().then((()=>{this.carregarProdutos()}))},methods:{async obterTenantId(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usu√°rio n√£o est√° autenticado");if(t.user_metadata?.tenant_id)return void(this.currentTenantId=t.user_metadata.tenant_id);const{data:o,error:e}=await R.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);o?.tenant_id&&(this.currentTenantId=o.tenant_id)}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarProdutos(){try{if(!this.currentTenantId)return void console.error("Tenant ID n√£o dispon√≠vel");const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).eq("status","aprovado").order("nome");if(t)throw t;this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel carregar os produtos."})}},async carregarDetalhes(){if(!this.produtoSelecionado)return this.produtoDetalhes=null,void(this.documentos=[]);try{this.loading=!0;const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("id",this.produtoSelecionado).single();if(t)throw t;if(console.log("Produto carregado:",a),a.data_emissao||(a.data_emissao=(new Date).toISOString().split("T")[0]),!a.data_validade){const t=new Date;t.setFullYear(t.getFullYear()+1),a.data_validade=t.toISOString().split("T")[0]}a.numero_edital||(a.numero_edital=`001/${(new Date).getFullYear()}`),this.produtoDetalhes=a,console.log("Detalhes do produto definidos:",this.produtoDetalhes);const{data:o,error:e}=await R.ND.from("documentos").select("*").eq("produto_id",this.produtoSelecionado);if(e)throw e;this.documentos=o||[]}catch(a){console.error("Erro ao carregar detalhes do produto:",a),this.$swal({icon:"error",title:"Erro",text:"N√£o foi poss√≠vel carregar os detalhes do produto."})}finally{this.loading=!1}},getStatusDCB(){if(!this.produtoDetalhes||!this.produtoDetalhes.data_validade)return"VENCIDA";const a=new Date,t=new Date(this.produtoDetalhes.data_validade);return t>a?"EM VIGOR":"VENCIDA"},getStatusDCBClass(){const a=this.getStatusDCB();return{"status-em-vigor":"EM VIGOR"===a,"status-vencida":"VENCIDA"===a}},formatarData(a){if(!a)return"N√£o informada";try{const t=new Date(a);return t.toLocaleDateString("pt-BR")}catch(t){return"Data inv√°lida"}},visualizarDCB(){if(!this.produtoDetalhes||!this.produtoAprovado)return void this.$swal({icon:"error",title:"N√£o dispon√≠vel",text:"Apenas produtos aprovados possuem Declara√ß√£o de Conformidade dispon√≠vel."});const a=this.criarConteudoDCB();this.$swal({title:"Declara√ß√£o de Conformidade de Bem",html:a,width:"800px",showConfirmButton:!0,confirmButtonText:"Fechar",showCancelButton:!0,cancelButtonText:"üì• Baixar PDF",cancelButtonColor:"#3498db"}).then((a=>{a.isDismissed&&"cancel"===a.dismiss&&this.baixarDCB()}))},baixarDCB(){if(this.produtoDetalhes&&this.produtoAprovado)try{const a=new Lt.jsPDF("p","mm","a4"),t=this.produtoDetalhes,o=(new Date).getFullYear();a.setFont("helvetica"),a.setFontSize(9),a.text("(Logo do √≥rg√£o ou entidade)",20,15),a.text("(Nome do √≥rg√£o ou entidade)",130,15),a.text("Comiss√£o de Padroniza√ß√£o de Materiais - CPM",115,22),a.setFontSize(14),a.setFont("helvetica","bold");const e="DECLARA√á√ÉO DE CONFORMIDADE DE BEM",i=a.getTextWidth(e);a.text(e,(210-i)/2,35),a.setFontSize(12);const s=`DCB N¬∫ ${t.id}/${o}`,r=a.getTextWidth(s);a.text(s,(210-r)/2,42),a.line(20,47,190,47);let n=55;a.setFontSize(11),a.setFont("helvetica","bold"),a.text("PRODUTO CERTIFICADO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("1. Primeiro quadro",20,n),n+=5,a.text(`1.1. Nome: ${t.nome||"N√£o informado"}`,25,n),n+=4,a.text(`Marca: ${t.marca||"N√£o informada"}`,25,n),n+=4,a.text(`Modelo: ${t.modelo||"N√£o informado"}`,25,n),n+=4,a.text(`Fabricante: ${t.fabricante||"N√£o informado"}`,25,n),n+=4,a.text(`CNPJ do Fabricante: ${t.cnpj||"N√£o informado"}`,25,n),n+=10,a.setFont("helvetica","bold"),a.setFontSize(11),a.text("DADOS DA CERTIFICA√á√ÉO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("1. Primeiro quadro",20,n),n+=5,a.text('1.1. Incluir abaixo de "Status":',25,n),n+=4,a.text(`Status: ${this.getStatusDCB()}`,30,n),n+=4,a.text(`1.1.1. Origem: Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ ${t.numero_edital||"XXX/YYYY"}`,30,n),n+=10,a.setFont("helvetica","bold"),a.setFontSize(11),a.text("DECLARA√á√ÉO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(8);const l=["A Comiss√£o de Padroniza√ß√£o de Materiais ‚Äì CPM do(a) _______ (nome do √≥rg√£o/entidade)","_______, constitu√≠da por meio do(a) __________ [informar o tipo de instrumento","(resolu√ß√£o/portaria), n√∫mero e ano de expedi√ß√£o], DECLARA que:","","1¬∫) o produto especificado nesta DCB foi submetido √† demonstra√ß√£o funcional e an√°lise","t√©cnica, devidamente monitoradas e documentadas por esta CPM em processo administrativo","pr√≥prio, com estrita observ√¢ncia √†s formalidades legais e regulamentares, tendo sido","considerado apto e, portanto, APROVADO para o uso e a finalidade a que se destina, uma","vez que atendeu aos requisitos t√©cnicos exigidos pelo Edital de Pr√©-Qualifica√ß√£o de Bens","em refer√™ncia, sendo a sua marca comercial e modelo lan√ßados no Cat√°logo Eletr√¥nico de","Bens Padronizados deste(a) √≥rg√£o/entidade, para fins de aquisi√ß√µes futuras e eventuais,","conforme previsto na Lei Federal n¬∫ 14.133/2021 (Lei de Licita√ß√µes e Contratos);","","2¬∫) expirada a sua vig√™ncia, esta DCB somente poder√° ser renovada mediante a realiza√ß√£o","de nova demonstra√ß√£o do produto nela especificado, para fins de rean√°lise t√©cnica e","funcional monitoradas e documentadas pela CPM."];l.forEach((t=>{a.text(t,20,n),n+=""===t?2:4})),n+=8,a.text("Local e data ___________",20,n),n+=12,a.text("(assinatura digital)",20,n),n+=5,a.setFont("helvetica","bold"),a.text("Comiss√£o de Padroniza√ß√£o de Materiais",20,n),n+=4,a.text("Presidente da CPM",20,n);const c=`DCB_${t.nome}_${t.id}_${o}.pdf`;a.save(c),this.$swal({icon:"success",title:"PDF Gerado!",text:`DCB baixada como: ${c}`,timer:3e3,showConfirmButton:!1})}catch(a){console.error("Erro ao gerar PDF:",a),this.$swal({icon:"error",title:"Erro ao gerar PDF",text:"Ocorreu um erro ao gerar o arquivo PDF."})}else this.$swal({icon:"error",title:"N√£o dispon√≠vel",text:"Apenas produtos aprovados possuem Declara√ß√£o de Conformidade dispon√≠vel."})},criarConteudoDCB(){const a=this.produtoDetalhes,t=((new Date).toLocaleDateString("pt-BR"),(new Date).getFullYear());return`\n        <div style="text-align: left; font-family: Arial, sans-serif; line-height: 1.6; padding: 20px;">\n          <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 20px;">\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">\n              <div style="text-align: left;">\n                <strong>(Logo do √≥rg√£o<br>ou entidade)</strong>\n              </div>\n              <div style="text-align: right;">\n                <strong>(Nome do √≥rg√£o ou entidade)<br>\n                Comiss√£o de Padroniza√ß√£o de Materiais - CPM</strong>\n              </div>\n            </div>\n            <h2 style="margin: 20px 0 10px 0; font-size: 18px; font-weight: bold;">DECLARA√á√ÉO DE CONFORMIDADE DE BEM</h2>\n            <h3 style="margin: 5px 0; font-size: 16px;">DCB N¬∫ ${a.id}/${t}</h3>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">PRODUTO CERTIFICADO</h4>\n            <p style="margin: 8px 0;"><strong>1. Primeiro quadro</strong></p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>1.1. Nome:</strong> ${a.nome||"N√£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Marca:</strong> ${a.marca||"N√£o informada"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Modelo:</strong> ${a.modelo||"N√£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Fabricante:</strong> ${a.fabricante||"N√£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>CNPJ do Fabricante:</strong> ${a.cnpj||"N√£o informado"}</p>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">DADOS DA CERTIFICA√á√ÉO</h4>\n            <p style="margin: 8px 0;"><strong>1. Primeiro quadro</strong></p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>1.1.</strong> Incluir abaixo de "Status":</p>\n            <p style="margin: 8px 0; margin-left: 40px;"><strong>Status:</strong> ${this.getStatusDCB()}</p>\n            <p style="margin: 8px 0; margin-left: 40px;"><strong>1.1.1. Origem:</strong> Edital de Pr√©-Qualifica√ß√£o de Bens n¬∫ ${a.numero_edital||"XXX/YYYY"}</p>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">DECLARA√á√ÉO</h4>\n            <p style="margin: 10px 0; text-align: justify;">\n              A Comiss√£o de Padroniza√ß√£o de Materiais ‚Äì CPM do(a) <strong>_______ (nome do √≥rg√£o/entidade) _______</strong>, constitu√≠da por meio do(a) <strong>__________ [informar o tipo de instrumento (resolu√ß√£o/portaria), n√∫mero e ano de expedi√ß√£o]</strong>, <strong>DECLARA</strong> que:\n            </p>\n            \n            <p style="margin: 15px 0; text-align: justify;">\n              <strong>1¬∫)</strong> o produto especificado nesta DCB foi submetido √† demonstra√ß√£o funcional e an√°lise t√©cnica, devidamente monitoradas e documentadas por esta CPM em processo administrativo pr√≥prio, com estrita observ√¢ncia √†s formalidades legais e regulamentares, tendo sido considerado apto e, portanto, <strong>APROVADO</strong> para o uso e a finalidade a que se destina, uma vez que atendeu aos requisitos t√©cnicos exigidos pelo Edital de Pr√©-Qualifica√ß√£o de Bens em refer√™ncia, sendo a sua marca comercial e modelo lan√ßados no <strong>Cat√°logo Eletr√¥nico de Bens Padronizados</strong> deste(a) √≥rg√£o/entidade, para fins de aquisi√ß√µes futuras e eventuais, conforme previsto na Lei Federal n¬∫ 14.133/2021 (Lei de Licita√ß√µes e Contratos);\n            </p>\n            \n            <p style="margin: 15px 0; text-align: justify;">\n              <strong>2¬∫)</strong> expirada a sua vig√™ncia, esta DCB somente poder√° ser renovada mediante a realiza√ß√£o de nova demonstra√ß√£o do produto nela especificado, para fins de rean√°lise t√©cnica e funcional monitoradas e documentadas pela CPM.\n            </p>\n          </div>\n          \n          <div style="margin-top: 50px; text-align: center;">\n            <p style="margin: 20px 0;">Local e data ___________</p>\n            <br><br>\n            <p style="margin: 10px 0;">(assinatura digital)</p>\n            <p style="margin: 5px 0; font-weight: bold;">Comiss√£o de Padroniza√ß√£o de Materiais</p>\n            <p style="margin: 5px 0; font-weight: bold;">Presidente da CPM</p>\n          </div>\n        </div>\n      `}}},Ut=Vt;var jt=(0,C.A)(Ut,Bt,qt,!1,null,"95e4a772",null);const Jt=jt.exports,Gt={name:"DCB",components:{FormularioDCB:Jt},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}}}},Ht=Gt;var Qt=(0,C.A)(Ht,kt,Ot,!1,null,"74acc79a",null);const Yt=Qt.exports;var Kt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ccl-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("‚ñº")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("DashboardCCL")],1)])},Wt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])}],Xt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard"},[t("h2",[a._v("Painel Comiss√£o de Contrata√ß√£o ou Licita√ß√£o")]),t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab",class:{active:"dashboard"===a.activeTab},on:{click:function(t){a.activeTab="dashboard"}}},[a._v(" Dashboard "),a.notificacoes.filter((a=>!a.lido)).length>0?t("span",{staticClass:"tab-notification"},[a._v(" "+a._s(a.notificacoes.filter((a=>!a.lido)).length)+" ")]):a._e()]),t("div",{staticClass:"tab",class:{active:"atas"===a.activeTab},on:{click:function(t){a.activeTab="atas"}}},[a._v(" Atas de Julgamento ")]),t("div",{staticClass:"tab",class:{active:"homologacoes"===a.activeTab},on:{click:function(t){a.activeTab="homologacoes"}}},[a._v(" Homologa√ß√µes ")])]),"dashboard"===a.activeTab?t("div",[t("div",{staticClass:"stats-container"},[t("div",{staticClass:"stat-card status-pendente-card"},[t("div",{staticClass:"stat-icon"},[a._v("‚öñÔ∏è")]),t("h3",[a._v("Processos em Julgamento")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))]),t("p",{staticClass:"stat-description"},[a._v("Aguardando decis√£o da CCL")])]),t("div",{staticClass:"stat-card status-aprovado-card"},[t("div",{staticClass:"stat-icon"},[a._v("‚úÖ")]),t("h3",[a._v("Homologa√ß√µes")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))]),t("p",{staticClass:"stat-description"},[a._v("Processos homologados este m√™s")])]),t("div",{staticClass:"stat-card status-diligencia-card"},[t("div",{staticClass:"stat-icon"},[a._v("üìã")]),t("h3",[a._v("Processos com Dilig√™ncias")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.diligencias))]),t("p",{staticClass:"stat-description"},[a._v("Solicita√ß√£o de documenta√ß√£o")])]),t("div",{staticClass:"stat-card status-recurso-card",class:{"stat-card-alert":a.prazosVencidos>0}},[t("div",{staticClass:"stat-icon"},[a._v("üìÑ")]),t("h3",[a._v("Recursos em An√°lise")]),t("div",{staticClass:"stat-value"},[a._v(" "+a._s(a.recursosEmAnalise)+" "),a.prazosVencidos>0?t("span",{staticClass:"alert-badge"},[a._v(" "+a._s(a.prazosVencidos)+" vencido"+a._s(a.prazosVencidos>1?"s":"")+" ")]):a._e()]),t("p",{staticClass:"stat-description"},[a._v("Aguardando julgamento")])])]),t("div",{staticClass:"dashboard-section"},[a._m(0),a.produtosPendentes.length>0?t("table",[a._m(1),t("tbody",a._l(a.produtosPendentes,(function(o){return t("tr",{key:o.id},[t("td",{staticClass:"produto-info"},[t("strong",[a._v(a._s(o.nome))]),t("br"),t("small",[a._v(a._s(o.modelo||"Modelo n√£o informado"))])]),t("td",[a._v(a._s(o.marca))]),t("td",[a._v(a._s(o.fabricante||"N√£o informado"))]),t("td",[a._v(a._s(a.getCategoriaName(o.categoria_id)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusClass(o.status)},[a._v(" "+a._s(a.formatarStatusCPM(o.status))+" ")])]),t("td",[a._v(a._s(a.formatDate(o.criado_em)))]),t("td",[t("span",{staticClass:"prazo-badge",class:a.getPrazoClass(o.criado_em)},[a._v(" "+a._s(a.calcularPrazoRestante(o.criado_em))+" ")])]),t("td",[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.julgarProcesso(o)}}},[a._v(" ‚öñÔ∏è Julgar ")]),t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.visualizarDocumentacao(o)}}},[a._v(" üìÑ Docs ")])])])})),0)]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("‚öñÔ∏è")]),t("h4",[a._v("N√£o h√° processos pendentes de julgamento")]),t("p",[a._v("Todos os processos analisados pela CPM j√° foram julgados pela CCL.")])])]),a.notificacoes.filter((a=>!a.lido)).length>0?t("div",{staticClass:"alertas-section"},[t("div",{staticClass:"alertas-header"},[t("h3",[a._v("üö® Alertas Cr√≠ticos")]),t("button",{staticClass:"btn-link",on:{click:a.marcarTodosComoLidos}},[a._v(" Marcar todos como lidos ")])]),t("div",{staticClass:"alertas-grid"},a._l(a.notificacoes.filter((a=>!a.lido)),(function(o){return t("div",{key:o.id,staticClass:"alerta-card",class:o.tipo},[t("div",{staticClass:"alerta-icon"},[a._v(" "+a._s(a.getAlertaIcon(o.tipo))+" ")]),t("div",{staticClass:"alerta-content"},[t("h5",[a._v(a._s(o.titulo))]),t("p",[a._v(a._s(o.mensagem))]),t("small",[a._v(a._s(a.formatDate(o.criado_em)))])]),t("div",{staticClass:"alerta-actions"},[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.abrirAlerta(o)}}},[a._v(" Ver Detalhes ")]),t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.marcarComoLido(o.id)}}},[a._v(" ‚úì Lido ")])])])})),0)]):a._e(),t("div",{staticClass:"dashboard-section"},[a._m(2),a.recursos.length>0?t("table",[a._m(3),t("tbody",a._l(a.recursos,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.recorrente))]),t("td",[t("strong",[a._v(a._s(o.produto_nome))]),t("br"),t("small",[a._v(a._s(o.ata_referencia))])]),t("td",[a._v(a._s(a.formatDate(o.data_recurso)))]),t("td",[t("span",{staticClass:"prazo-badge",class:a.getPrazoRecursoClass(o.prazo_final)},[a._v(" "+a._s(a.formatDate(o.prazo_final))+" ")])]),t("td",[t("span",{staticClass:"status-badge",class:a.getRecursoStatusClass(o.status)},[a._v(" "+a._s(o.status)+" ")])]),t("td",[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.analisarRecurso(o)}}},[a._v(" üìã Analisar ")]),t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.visualizarDocumentacaoRecurso(o)}}},[a._v(" üìÑ Docs ")])])])})),0)]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìÑ")]),t("h4",[a._v("N√£o h√° recursos em an√°lise")]),t("p",[a._v("Todas as decis√µes da CCL est√£o dentro do prazo recursal ou j√° foram julgadas.")])])])]):a._e(),"atas"===a.activeTab?t("div",{staticClass:"atas-julgamento"},[t("div",{staticClass:"atas-header"},[t("h3",[a._v("üìã Atas de Julgamento")]),t("p",{staticClass:"atas-description"},[a._v(" Gerenciamento de atas de julgamento da Comiss√£o de Contrata√ß√£o ou Licita√ß√£o (CCL) conforme art. 78, ¬ß 2¬∫ da Lei 14.133/2021 ")]),t("div",{staticClass:"atas-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.criarNovaAta}},[a._v(" ‚ûï Criar Nova Ata ")]),t("button",{staticClass:"btn-secondary",on:{click:a.visualizarHistorico}},[a._v(" üìä Hist√≥rico Completo ")])])]),t("div",{staticClass:"atas-stats"},[t("div",{staticClass:"ata-stat-card"},[t("div",{staticClass:"ata-stat-icon"},[a._v("üìã")]),t("div",{staticClass:"ata-stat-info"},[t("h4",[a._v(a._s(a.atasEmAndamento))]),t("p",[a._v("Atas em Elabora√ß√£o")])])]),t("div",{staticClass:"ata-stat-card"},[t("div",{staticClass:"ata-stat-icon"},[a._v("‚úÖ")]),t("div",{staticClass:"ata-stat-info"},[t("h4",[a._v(a._s(a.atasPublicadas))]),t("p",[a._v("Atas Publicadas")])])]),t("div",{staticClass:"ata-stat-card"},[t("div",{staticClass:"ata-stat-icon"},[a._v("üìÑ")]),t("div",{staticClass:"ata-stat-info"},[t("h4",[a._v(a._s(a.processosPendentes))]),t("p",[a._v("Processos Pendentes")])])])]),t("div",{staticClass:"atas-content"},[t("div",{staticClass:"atas-section"},[t("h4",[a._v("üìù Atas em Elabora√ß√£o")]),a.atasEmElaboracao.length>0?t("div",{staticClass:"atas-grid"},a._l(a.atasEmElaboracao,(function(o){return t("div",{key:o.id,staticClass:"ata-card em-elaboracao"},[t("div",{staticClass:"ata-card-header"},[t("h5",[a._v(a._s(o.numero))]),t("span",{staticClass:"ata-status status-elaboracao"},[a._v("Em Elabora√ß√£o")])]),t("div",{staticClass:"ata-card-content"},[t("p",[t("strong",[a._v("Per√≠odo:")]),a._v(" "+a._s(o.periodo))]),t("p",[t("strong",[a._v("Processos:")]),a._v(" "+a._s(o.totalProcessos)+" processos")]),t("p",[t("strong",[a._v("Iniciado em:")]),a._v(" "+a._s(a.formatDate(o.dataInicio)))])]),t("div",{staticClass:"ata-card-actions"},[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.editarAta(o)}}},[a._v(" ‚úèÔ∏è Continuar Edi√ß√£o ")]),t("button",{staticClass:"btn-small btn-success",on:{click:function(t){return a.finalizarAta(o)}}},[a._v(" ‚úÖ Finalizar ")])])])})),0):t("div",{staticClass:"empty-message"},[t("p",[a._v("N√£o h√° atas em elabora√ß√£o no momento.")])])]),t("div",{staticClass:"atas-section"},[t("h4",[a._v("üìã Atas Publicadas Recentemente")]),t("div",{staticClass:"atas-table-container"},[a.atasPublicadasRecentes.length>0?t("table",{staticClass:"atas-table"},[a._m(4),t("tbody",a._l(a.atasPublicadasRecentes,(function(o){return t("tr",{key:o.id},[t("td",[t("strong",[a._v(a._s(o.numero))])]),t("td",[a._v(a._s(a.formatDate(o.dataPublicacao)))]),t("td",[a._v(a._s(o.periodo))]),t("td",[t("span",{staticClass:"badge-info"},[a._v(a._s(o.totalProcessos)+" processos")])]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusRecursalClass(o.statusRecursal)},[a._v(" "+a._s(o.statusRecursal)+" ")])]),t("td",[t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.visualizarAta(o)}}},[a._v(" üëÅÔ∏è Visualizar ")]),t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.baixarPDF(o)}}},[a._v(" üì• PDF ")]),"EM PRAZO"===o.statusRecursal?t("button",{staticClass:"btn-small btn-warning",on:{click:function(t){return a.gerenciarRecursos(o)}}},[a._v(" üìÑ Recursos ")]):a._e()])])})),0)]):t("div",{staticClass:"empty-message"},[t("p",[a._v("N√£o h√° atas publicadas recentemente.")])])])])])]):a._e(),"homologacoes"===a.activeTab?t("div",{staticClass:"homologacoes"},[t("div",{staticClass:"homologacoes-header"},[t("h3",[a._v("üìã Homologa√ß√µes")]),t("p",{staticClass:"homologacoes-description"},[a._v(" Gest√£o de atos de homologa√ß√£o pela autoridade competente conforme Passo 8 dos documentos oficiais ")]),t("div",{staticClass:"homologacoes-actions"},[t("button",{staticClass:"btn-primary",on:{click:a.consultarPendentes}},[a._v(" üìã Processos Pendentes ")]),t("button",{staticClass:"btn-secondary",on:{click:a.relatorioHomologacoes}},[a._v(" üìä Relat√≥rio Geral ")])])]),t("div",{staticClass:"homologacoes-stats"},[t("div",{staticClass:"homo-stat-card pending"},[t("div",{staticClass:"homo-stat-icon"},[a._v("‚è≥")]),t("div",{staticClass:"homo-stat-info"},[t("h4",[a._v(a._s(a.homologacoesPendentes))]),t("p",[a._v("Aguardando Homologa√ß√£o")]),t("small",[a._v("Atas julgadas pela CCL")])])]),t("div",{staticClass:"homo-stat-card approved"},[t("div",{staticClass:"homo-stat-icon"},[a._v("‚úÖ")]),t("div",{staticClass:"homo-stat-info"},[t("h4",[a._v(a._s(a.homologacoesAprovadas))]),t("p",[a._v("Homologadas")]),t("small",[a._v("Este m√™s")])])]),t("div",{staticClass:"homo-stat-card rejected"},[t("div",{staticClass:"homo-stat-icon"},[a._v("‚ùå")]),t("div",{staticClass:"homo-stat-info"},[t("h4",[a._v(a._s(a.homologacoesIndeferidas))]),t("p",[a._v("Indeferidas")]),t("small",[a._v("Este m√™s")])])]),t("div",{staticClass:"homo-stat-card dcb"},[t("div",{staticClass:"homo-stat-icon"},[a._v("üìú")]),t("div",{staticClass:"homo-stat-info"},[t("h4",[a._v(a._s(a.dcbsEmitidas))]),t("p",[a._v("DCBs Emitidas")]),t("small",[a._v("Total ativo")])])])]),t("div",{staticClass:"homologacoes-content"},[t("div",{staticClass:"homo-section"},[t("div",{staticClass:"homo-section-header"},[t("h4",[a._v("‚è≥ Processos Aguardando Homologa√ß√£o")]),t("span",{staticClass:"homo-count"},[a._v(a._s(a.processosPendentesHomologacao.length)+" processos")])]),a.processosPendentesHomologacao.length>0?t("div",{staticClass:"homo-table-container"},[t("table",{staticClass:"homo-table"},[a._m(5),t("tbody",a._l(a.processosPendentesHomologacao,(function(o){return t("tr",{key:o.id},[t("td",[t("strong",[a._v(a._s(o.numeroAta))])]),t("td",[a._v(a._s(a.formatDate(o.dataJulgamento)))]),t("td",[t("span",{staticClass:"badge-info"},[a._v(a._s(o.totalProdutos)+" produtos")])]),t("td",[t("span",{staticClass:"status-badge status-aprovado"},[a._v(a._s(o.decisaoCCL))])]),t("td",[t("span",{staticClass:"status-badge",class:a.getRecursoStatusClass(o.statusRecursos)},[a._v(" "+a._s(o.statusRecursos)+" ")])]),t("td",[t("span",{staticClass:"prazo-badge",class:a.getPrazoHomologacaoClass(o.dataJulgamento)},[a._v(" "+a._s(a.calcularPrazoHomologacao(o.dataJulgamento))+" ")])]),t("td",[t("button",{staticClass:"btn-small btn-success",on:{click:function(t){return a.homologarProcesso(o)}}},[a._v(" ‚úÖ Homologar ")]),t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.indeferirProcesso(o)}}},[a._v(" ‚ùå Indeferir ")]),t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.visualizarAta(o)}}},[a._v(" üëÅÔ∏è Ver Ata ")])])])})),0)])]):t("div",{staticClass:"empty-message"},[t("div",{staticClass:"empty-icon"},[a._v("‚öñÔ∏è")]),t("h4",[a._v("N√£o h√° processos pendentes de homologa√ß√£o")]),t("p",[a._v("Todos os processos julgados pela CCL j√° foram homologados.")])])]),t("div",{staticClass:"homo-section"},[t("div",{staticClass:"homo-section-header"},[t("h4",[a._v("üìã Homologa√ß√µes Recentes")]),t("button",{staticClass:"btn-link",on:{click:a.verTodas}},[a._v("Ver todas")])]),a.homologacoesRecentes.length>0?t("div",{staticClass:"homo-cards-grid"},a._l(a.homologacoesRecentes,(function(o){return t("div",{key:o.id,staticClass:"homo-card"},[t("div",{staticClass:"homo-card-header"},[t("div",{staticClass:"homo-card-status",class:o.tipo},[t("span",{staticClass:"homo-status-icon"},[a._v(a._s("homologada"===o.tipo?"‚úÖ":"‚ùå"))]),t("span",{staticClass:"homo-status-text"},[a._v(a._s("homologada"===o.tipo?"HOMOLOGADA":"INDEFERIDA"))])]),t("span",{staticClass:"homo-date"},[a._v(a._s(a.formatDate(o.dataHomologacao)))])]),t("div",{staticClass:"homo-card-content"},[t("h5",[a._v(a._s(o.numeroAta))]),t("p",[t("strong",[a._v("Produtos:")]),a._v(" "+a._s(o.totalProdutos))]),t("p",[t("strong",[a._v("Autoridade:")]),a._v(" "+a._s(o.autoridade))]),t("p",[t("strong",[a._v("Motivo:")]),a._v(" "+a._s(o.motivo))])]),t("div",{staticClass:"homo-card-actions"},[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.baixarPDFHomologacao(o)}}},[a._v(" üì• PDF ")]),t("button",{staticClass:"btn-small btn-secondary",on:{click:function(t){return a.visualizarDCBs(o)}}},[a._v(" üìú DCBs ")]),t("button",{staticClass:"btn-small btn-info",on:{click:function(t){return a.notificarFornecedores(o)}}},[a._v(" üìß Notificar ")])])])})),0):t("div",{staticClass:"empty-message"},[t("p",[a._v("N√£o h√° homologa√ß√µes recentes.")])])]),t("div",{staticClass:"homo-section"},[t("div",{staticClass:"homo-section-header"},[t("h4",[a._v("üìú Declara√ß√µes de Conformidade de Bem (DCBs) Ativas")]),t("button",{staticClass:"btn-link",on:{click:a.gerenciarDCBs}},[a._v("Gerenciar todas")])]),a.dcbsAtivas.length>0?t("div",{staticClass:"dcb-grid"},a._l(a.dcbsAtivas,(function(o){return t("div",{key:o.id,staticClass:"dcb-card"},[t("div",{staticClass:"dcb-header"},[t("span",{staticClass:"dcb-number"},[a._v("DCB "+a._s(o.numero)+"/"+a._s(o.ano))]),t("span",{staticClass:"dcb-status",class:a.getDCBStatusClass(o.status)},[a._v(a._s(o.status))])]),t("div",{staticClass:"dcb-content"},[t("h6",[a._v(a._s(o.produto))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(o.marca))]),t("p",[t("strong",[a._v("Validade:")]),a._v(" "+a._s(a.formatDate(o.validade)))]),t("p",[t("strong",[a._v("Emitida em:")]),a._v(" "+a._s(a.formatDate(o.dataEmissao)))])]),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-small btn-primary",on:{click:function(t){return a.visualizarDCB(o)}}},[a._v(" üëÅÔ∏è Visualizar ")]),t("button",{staticClass:"btn-small btn-warning",on:{click:function(t){return a.renovarDCB(o)}}},[a._v(" üîÑ Renovar ")]),t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.cancelarDCB(o)}}},[a._v(" ‚ùå Cancelar ")])])])})),0):t("div",{staticClass:"empty-message"},[t("p",[a._v("N√£o h√° DCBs ativas no momento.")])])])])]):a._e()])},Zt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("üìã Processos Pendentes de Julgamento")]),t("p",{staticClass:"section-description"},[a._v(" Processos analisados pela CPM que aguardam julgamento pela Comiss√£o de Contrata√ß√£o ou Licita√ß√£o (CCL) ")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome do Produto")]),t("th",[a._v("Marca/Modelo")]),t("th",[a._v("Fornecedor")]),t("th",[a._v("Categoria")]),t("th",[a._v("Parecer CPM")]),t("th",[a._v("Data An√°lise")]),t("th",[a._v("Prazo CCL")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("üìÑ Recursos em An√°lise")]),t("p",{staticClass:"section-description"},[a._v(" Recursos apresentados contra decis√µes da CCL que aguardam julgamento (prazo: 3 dias √∫teis - art. 165 da Lei 14.133/2021) ")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Recorrente")]),t("th",[a._v("Produto/Ata")]),t("th",[a._v("Data do Recurso")]),t("th",[a._v("Prazo Final")]),t("th",[a._v("Status")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("N√∫mero da Ata")]),t("th",[a._v("Data Publica√ß√£o")]),t("th",[a._v("Per√≠odo")]),t("th",[a._v("Processos")]),t("th",[a._v("Status Recursal")]),t("th",[a._v("A√ß√µes")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("N√∫mero da Ata")]),t("th",[a._v("Data Julgamento")]),t("th",[a._v("Produtos")]),t("th",[a._v("Decis√£o CCL")]),t("th",[a._v("Recursos")]),t("th",[a._v("Prazo")]),t("th",[a._v("A√ß√µes")])])])}];const ao={name:"DashboardCCL",data(){return{activeTab:"dashboard",produtosPendentes:[],atasRecentes:[],pendentes:0,aprovados:0,diligencias:0,recursosEmAnalise:0,categorias:[],currentTenantId:null,loading:!1,recursos:[],notificacoes:[],prazosVencidos:0,prazosUrgentes:0,autoCheckInterval:null,atasEmAndamento:0,atasPublicadas:0,processosPendentes:0,atasEmElaboracao:[],atasPublicadasRecentes:[],homologacoesPendentes:0,homologacoesAprovadas:0,homologacoesIndeferidas:0,dcbsEmitidas:0,processosPendentesHomologacao:[],homologacoesRecentes:[],dcbsAtivas:[]}},created(){this.obterTenantId().then((()=>{this.carregarDados(),this.carregarCategorias(),this.carregarAtasJulgamento(),this.carregarAtasEmElaboracao(),this.carregarHomologacoes(),this.carregarProcessosPendentesHomologacao(),this.carregarDCBsAtivas(),this.iniciarMonitoramentoPrazos()}))},beforeUnmount(){this.autoCheckInterval&&clearInterval(this.autoCheckInterval)},methods:{async obterTenantId(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usu√°rio n√£o est√° autenticado");if(t.user_metadata?.tenant_id)return void(this.currentTenantId=t.user_metadata.tenant_id);const{data:o,error:e}=await R.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);o?.tenant_id?this.currentTenantId=o.tenant_id:console.error("Tenant ID n√£o encontrado para o usu√°rio")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarCategorias(){try{const{data:a,error:t}=await R.ND.from("categorias").select("*");if(t)throw t;this.categorias=a||[]}catch(a){console.error("Erro ao carregar categorias:",a)}},getCategoriaName(a){const t=this.categorias.find((t=>t.id===a));return t?t.nome:"Categoria n√£o encontrada"},async carregarDados(){try{if(this.loading=!0,!this.currentTenantId)return void console.error("Tenant ID n√£o dispon√≠vel");const{data:a,error:t}=await R.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).in("status",["aprovado","reprovado","julgado_aprovado","julgado_reprovado"]).order("criado_em",{ascending:!1}).limit(10);if(t)throw t;this.produtosPendentes=a||[],await this.carregarRecursos(),this.recursos||(this.recursos=[]);const o=await Promise.all([this.contarPorStatus(["aprovado","reprovado"]),this.contarPorStatus(["julgado_aprovado","julgado_reprovado"]),this.contarPorStatus("homologado"),this.contarPorStatus("diligencia")]);this.pendentes=o[0]||this.produtosPendentes.filter((a=>["aprovado","reprovado"].includes(a.status))).length,this.aprovados=o[1]||this.produtosPendentes.filter((a=>["julgado_aprovado","julgado_reprovado"].includes(a.status))).length,this.homologados=o[2],this.diligencias=o[3],this.recursosEmAnalise=this.recursos.filter((a=>"EM AN√ÅLISE"===a.status||"AGUARDANDO CPM"===a.status)).length}catch(a){console.error("Erro ao carregar dados:",a)}finally{this.loading=!1}},async contarPorStatus(a){if(!this.currentTenantId)return 0;let t=R.ND.from("produtos").select("id",{count:"exact"}).eq("tenant_id",this.currentTenantId);t=Array.isArray(a)?t.in("status",a):t.eq("status",a);const{count:o,error:e}=await t;return e?(console.error(`Erro ao contar produtos ${a}:`,e),0):o||0},formatDate(a){if(!a)return"";if(a.includes("T")){const t=new Date(a);return t.toLocaleDateString("pt-BR")}const t=a.split("-");return 3===t.length?`${t[2]}/${t[1]}/${t[0]}`:a},formatarStatus(a){switch(a){case"pendente":return"Em avalia√ß√£o";case"aprovado":return"Em Dilig√™ncia";case"reprovado":return"Em An√°lise";case"diligencia":return"Em dilig√™ncia";default:return a}},formatarStatusCPM(a){switch(a){case"aprovado":return"Favor√°vel";case"julgado_aprovado":return"Julgado Favor√°vel";case"julgado_reprovado":return"Julgado Desfavor√°vel";case"homologado":return"Homologado";case"reprovado":return"Desfavor√°vel";case"diligencia":return"Com Dilig√™ncia";case"pendente":return"Em An√°lise";default:return a}},calcularPrazoRestante(a){if(!a)return"Sem prazo";const t=new Date,o=this.adicionarDiasUteis(new Date(a),10);if(t>o)return"Vencido";const e=this.calcularDiasUteisEntre(t,o);return 0===e?"Hoje (√∫ltimo dia √∫til)":1===e?"1 dia √∫til":`${e} dias √∫teis`},getPrazoClass(a){if(!a)return"prazo-indefinido";const t=new Date,o=this.adicionarDiasUteis(new Date(a),10);if(t>o)return"prazo-vencido";const e=this.calcularDiasUteisEntre(t,o);return e<=1?"prazo-urgente":e<=3?"prazo-atencao":"prazo-normal"},async julgarProcesso(a){const t=await this.buscarInformacoesTecnicasProduto(a.id);this.$swal({title:"‚öñÔ∏è Julgamento CCL - An√°lise T√©cnica Completa",html:`\n          <div style="text-align: left; padding: 15px; max-height: 600px; overflow-y: auto;">\n            \x3c!-- Cabe√ßalho do Processo --\x3e\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h3 style="margin: 0 0 10px 0; color: #2c3e50;">üìã Dados do Processo</h3>\n              <p><strong>Produto:</strong> ${a.nome}</p>\n              <p><strong>Marca/Modelo:</strong> ${a.marca} ${a.modelo||""}</p>\n              <p><strong>Fabricante:</strong> ${a.fabricante||"N√£o informado"}</p>\n              <p><strong>Categoria:</strong> ${this.getCategoriaName(a.categoria_id)}</p>\n              <p><strong>Data de Cadastro:</strong> ${this.formatDate(a.criado_em)}</p>\n            </div>\n\n            \x3c!-- Parecer T√©cnico da CPM --\x3e\n            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #1976d2;">üî¨ Parecer T√©cnico da CPM</h4>\n              <p><strong>Status:</strong> <span style="color: ${this.getStatusColor(a.status)}; font-weight: bold;">${this.formatarStatusCPM(a.status)}</span></p>\n              <p><strong>Data da An√°lise:</strong> ${this.formatDate(a.atualizado_em)}</p>\n              ${a.observacoes_cpm?`<p><strong>Observa√ß√µes CPM:</strong> ${a.observacoes_cpm}</p>`:""}\n              ${t.laudos?`<p><strong>Laudos T√©cnicos:</strong> ${t.laudos}</p>`:""}\n              ${t.amostras?`<p><strong>Amostras Testadas:</strong> ${t.amostras}</p>`:""}\n            </div>\n\n            \x3c!-- Documenta√ß√£o T√©cnica --\x3e\n            <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #f57c00;">üìÑ Documenta√ß√£o T√©cnica</h4>\n              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px;">\n                <label><input type="checkbox" id="doc_catalogo" checked disabled> Cat√°logo T√©cnico</label>\n                <label><input type="checkbox" id="doc_manual" checked disabled> Manual do Produto</label>\n                <label><input type="checkbox" id="doc_certificados" checked disabled> Certificados (ABNT/ISO)</label>\n                <label><input type="checkbox" id="doc_laudos" checked disabled> Laudos de Laborat√≥rio</label>\n                <label><input type="checkbox" id="doc_normas" checked disabled> Atendimento a Normas</label>\n                <label><input type="checkbox" id="doc_garantia" checked disabled> Termo de Garantia</label>\n              </div>\n            </div>\n\n            \x3c!-- An√°lise de Conformidade --\x3e\n            <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 15px 0; color: #7b1fa2;">‚úÖ An√°lise de Conformidade CCL</h4>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">üîç Adequa√ß√£o √†s Especifica√ß√µes T√©cnicas:</label>\n                <select id="adequacao_tecnica" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="plenamente_adequado">Plenamente Adequado</option>\n                  <option value="adequado_ressalvas">Adequado com Ressalvas</option>\n                  <option value="inadequado">Inadequado</option>\n                </select>\n              </div>\n\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">üìã Atendimento aos Requisitos M√≠nimos:</label>\n                <select id="requisitos_minimos" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="atende_plenamente">Atende Plenamente</option>\n                  <option value="atende_parcialmente">Atende Parcialmente</option>\n                  <option value="nao_atende">N√£o Atende</option>\n                </select>\n              </div>\n\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">‚öñÔ∏è Conformidade Legal (Lei 14.133/2021):</label>\n                <select id="conformidade_legal" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="conforme">Conforme</option>\n                  <option value="nao_conforme">N√£o Conforme</option>\n                </select>\n              </div>\n            </div>\n\n            \x3c!-- Decis√£o da CCL --\x3e\n            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 15px 0; color: #388e3c;">‚öñÔ∏è Decis√£o da CCL</h4>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">Decis√£o Final:</label>\n                <select id="decisaoCCL" class="swal2-select" style="width: 100%;">\n                  <option value="">Selecione uma decis√£o</option>\n                  <option value="homologado">‚úÖ Homologar (Aprovar pr√©-qualifica√ß√£o)</option>\n                  <option value="indeferido">‚ùå Indeferir (Rejeitar pr√©-qualifica√ß√£o)</option>\n                  <option value="diligencia">üìã Solicitar Dilig√™ncia √† CPM</option>\n                  <option value="pendencia">‚è≥ Aguardar Documenta√ß√£o Complementar</option>\n                </select>\n              </div>\n            </div>\n\n            \x3c!-- Fundamenta√ß√£o --\x3e\n            <div style="background: #fff8e1; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n              <h4 style="margin: 0 0 15px 0; color: #f9a825;">üìù Fundamenta√ß√£o da Decis√£o</h4>\n              <textarea id="fundamentacao" class="swal2-textarea" placeholder="Fundamenta√ß√£o t√©cnica e jur√≠dica da decis√£o (obrigat√≥rio - art. 5¬∫ Lei 14.133/2021)..." style="height: 120px; width: 100%;"></textarea>\n              \n              <div style="margin-top: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">üìö Base Legal/Normativa:</label>\n                <textarea id="base_legal" class="swal2-textarea" placeholder="Cite artigos da Lei 14.133/2021, normas t√©cnicas (ABNT) e outros dispositivos aplic√°veis..." style="height: 80px; width: 100%;"></textarea>\n              </div>\n            </div>\n\n            \x3c!-- Informa√ß√µes Adicionais --\x3e\n            <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">\n              <h4 style="margin: 0 0 15px 0; color: #424242;">üìã Informa√ß√µes Complementares</h4>\n              <div style="margin-bottom: 10px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Observa√ß√µes da CCL:</label>\n                <textarea id="observacoes_ccl" class="swal2-textarea" placeholder="Observa√ß√µes adicionais (opcional)..." style="height: 60px; width: 100%;"></textarea>\n              </div>\n              \n              <div style="margin-top: 15px;">\n                <label><input type="checkbox" id="incluir_ata" checked> Incluir na pr√≥xima Ata de Julgamento</label>\n              </div>\n              \n              <div style="margin-top: 10px; font-size: 12px; color: #666;">\n                <strong>Nota:</strong> Esta decis√£o ser√° registrada conforme art. 78, ¬ß 2¬∫ da Lei 14.133/2021 e inclu√≠da na Ata de Julgamento da CCL.\n              </div>\n            </div>\n          </div>\n        `,width:"900px",showCancelButton:!0,confirmButtonText:"‚öñÔ∏è Confirmar Julgamento",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#2e7d32",cancelButtonColor:"#d32f2f",preConfirm:()=>{const a=document.getElementById("decisaoCCL").value,t=document.getElementById("fundamentacao").value.trim(),o=document.getElementById("base_legal").value.trim(),e=document.getElementById("adequacao_tecnica").value,i=document.getElementById("requisitos_minimos").value,s=document.getElementById("conformidade_legal").value,r=document.getElementById("observacoes_ccl").value.trim(),n=document.getElementById("incluir_ata").checked;return a?t?e?i?s?{decisao:a,fundamentacao:t,baseLegal:o,adequacaoTecnica:e,requisitosMinimos:i,conformidadeLegal:s,observacoesCcl:r,incluirAta:n}:(this.$swal.showValidationMessage("Informe a conformidade legal"),!1):(this.$swal.showValidationMessage("Informe o atendimento aos requisitos m√≠nimos"),!1):(this.$swal.showValidationMessage("Informe a adequa√ß√£o √†s especifica√ß√µes t√©cnicas"),!1):(this.$swal.showValidationMessage("A fundamenta√ß√£o √© obrigat√≥ria (art. 5¬∫ Lei 14.133/2021)"),!1):(this.$swal.showValidationMessage("Selecione uma decis√£o da CCL"),!1)}}).then((async t=>{if(t.isConfirmed)try{await this.salvarJulgamentoCCL(a,t.value),this.$swal({title:"‚öñÔ∏è Julgamento Registrado",text:"A decis√£o da CCL foi registrada com sucesso e ser√° inclu√≠da na pr√≥xima ata de julgamento.",icon:"success",confirmButtonText:"‚úÖ OK"}),await this.carregarDados()}catch(o){this.$swal({title:"‚ùå Erro",text:`Erro ao registrar julgamento: ${o.message}`,icon:"error"})}}))},async buscarInformacoesTecnicasProduto(a){try{const{data:t,error:o}=await R.ND.from("produtos").select("observacoes_cpm, laudos_tecnicos, amostras_testadas").eq("id",a).single();return o?(console.error("Erro ao buscar informa√ß√µes t√©cnicas:",o),{}):{laudos:t?.laudos_tecnicos||"N√£o informado",amostras:t?.amostras_testadas||"N√£o informado"}}catch(t){return console.error("Erro ao buscar informa√ß√µes t√©cnicas:",t),{}}},getStatusColor(a){switch(a){case"aprovado":return"#4caf50";case"reprovado":return"#f44336";case"diligencia":return"#ff9800";case"pendente":return"#2196f3";default:return"#666"}},async salvarJulgamentoCCL(a,t){try{const o=this.mapearDecisaoParaStatus(t.decisao),{error:e}=await R.ND.from("produtos").update({status:o,observacoes_ccl:t.fundamentacao,adequacao_tecnica:t.adequacaoTecnica,requisitos_minimos:t.requisitosMinimos,conformidade_legal:t.conformidadeLegal,base_legal:t.baseLegal,observacoes_ccl_adicional:t.observacoesCcl,julgado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()}).eq("id",a.id);if(e)throw new Error(`Erro ao atualizar produto: ${e.message}`);t.incluirAta&&"homologado"===t.decisao&&console.log("Produto ser√° inclu√≠do na pr√≥xima ata de julgamento"),console.log("Julgamento CCL salvo com sucesso para produto:",a.id)}catch(o){throw console.error("Erro ao salvar julgamento CCL:",o),o}},mapearDecisaoParaStatus(a){switch(a){case"homologado":return"julgado_aprovado";case"indeferido":return"julgado_reprovado";case"diligencia":return"diligencia";case"pendencia":return"pendencia_documentacao";default:return"julgamento_pendente"}},getFeriadosNacionais(a){const t=[`${a}-01-01`,`${a}-04-21`,`${a}-05-01`,`${a}-09-07`,`${a}-10-12`,`${a}-11-02`,`${a}-11-15`,`${a}-12-25`],o=[];return 2024===a?o.push("2024-02-12","2024-02-13","2024-03-29","2024-05-30"):2025===a&&o.push("2025-03-03","2025-03-04","2025-04-18","2025-06-19"),[...t,...o]},isFeriado(a){const t=a.toISOString().split("T")[0],o=a.getFullYear(),e=this.getFeriadosNacionais(o);return e.includes(t)},isFimDeSemana(a){const t=a.getDay();return 0===t||6===t},isDiaUtil(a){return!this.isFimDeSemana(a)&&!this.isFeriado(a)},adicionarDiasUteis(a,t){const o=new Date(a);let e=0;while(e<t)o.setDate(o.getDate()+1),this.isDiaUtil(o)&&e++;return o},calcularDiasUteisEntre(a,t){const o=new Date(a),e=new Date(t);let i=0;const s=new Date(o);while(s<=e)this.isDiaUtil(s)&&i++,s.setDate(s.getDate()+1);return i},calcularPrazoRecursal(a,t=3){const o=this.adicionarDiasUteis(new Date(a),t);return o},calcularPrazoHomologacaoUtil(a,t=10){const o=this.adicionarDiasUteis(new Date(a),t);return o},getPrazoRecursoClass(a){if(!a)return"prazo-indefinido";const t=new Date,o=new Date(a);if(t>o)return"prazo-vencido";const e=this.calcularDiasUteisEntre(t,o);return e<=0?"prazo-urgente":e<=1?"prazo-atencao":"prazo-normal"},visualizarDocumentacao(a){this.$swal({title:"üìÑ Documenta√ß√£o do Processo",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Produto: ${a.nome}</h4>\n            <p><strong>Marca:</strong> ${a.marca}</p>\n            <hr>\n            <h5>Documentos Dispon√≠veis:</h5>\n            <ul style="text-align: left;">\n              <li>üìã Parecer T√©cnico da CPM</li>\n              <li>üìë Documenta√ß√£o do Fornecedor</li>\n              <li>üî¨ Laudos T√©cnicos</li>\n              <li>üìù Ata de Recebimento de Amostras</li>\n              <li>üìÑ Edital de Chamamento P√∫blico</li>\n            </ul>\n            <div style="margin-top: 20px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.baixarDocumentacaoProduto('${a.id}')">\n                üì• Baixar Documenta√ß√£o Completa\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"‚ùå Fechar"})},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"julgado_aprovado":return"status-aprovado";case"julgado_reprovado":return"status-reprovado";case"homologado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";case"diligencia":return"status-diligencia";default:return"status-pendente"}},publicarDecisao(a){this.$swal({title:"A√ß√£o Simulada",text:"Em uma implementa√ß√£o completa, abriria um formul√°rio para registrar a decis√£o da comiss√£o e publicar no Di√°rio Oficial.",icon:"info"})},async visualizarAta(a){try{const{data:t,error:o}=await R.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status,\n            julgado_em,\n            adequacao_tecnica,\n            observacoes_ccl,\n            base_legal\n          ").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId);if(o)throw o;const e=t?.filter((a=>"julgado_aprovado"===a.status))||[],i=t?.filter((a=>"julgado_reprovado"===a.status))||[];this.$swal({title:`üìã Ata de Julgamento: ${a.numero}`,html:`\n            <div style="text-align: left; padding: 15px; max-height: 500px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üìÑ Informa√ß√µes da Ata</h4>\n                <p><strong>N√∫mero:</strong> ${a.numero}</p>\n                <p><strong>Per√≠odo:</strong> ${a.periodo}</p>\n                <p><strong>Data Publica√ß√£o:</strong> ${this.formatDate(a.dataPublicacao)}</p>\n                <p><strong>Status:</strong> ${a.statusRecursal}</p>\n                <p><strong>Total de Processos:</strong> ${a.totalProcessos}</p>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h5 style="color: #2d5a2d; margin: 0 0 10px 0;">‚úÖ Produtos Aprovados (${e.length})</h5>\n                ${e.length>0?e.map((a=>`\n                    <div style="border-bottom: 1px solid #c8e6c8; padding: 8px 0;">\n                      <strong>${a.nome}</strong> - ${a.marca}<br>\n                      <small>Julgado em: ${this.formatDate(a.julgado_em)}</small>\n                    </div>\n                  `)).join(""):'<p style="color: #666; font-style: italic;">Nenhum produto aprovado</p>'}\n              </div>\n              \n              <div style="background: #fce8e8; padding: 15px; border-radius: 8px;">\n                <h5 style="color: #5a2d2d; margin: 0 0 10px 0;">‚ùå Produtos Reprovados (${i.length})</h5>\n                ${i.length>0?i.map((a=>`\n                    <div style="border-bottom: 1px solid #f5c6c6; padding: 8px 0;">\n                      <strong>${a.nome}</strong> - ${a.marca}<br>\n                      <small>Julgado em: ${this.formatDate(a.julgado_em)}</small>\n                    </div>\n                  `)).join(""):'<p style="color: #666; font-style: italic;">Nenhum produto reprovado</p>'}\n              </div>\n              \n              ${a.conteudoAta?`\n                <div style="background: #fff; border: 1px solid #ddd; padding: 15px; border-radius: 8px; margin-top: 15px;">\n                  <h5>üìù Conte√∫do da Ata</h5>\n                  <pre style="white-space: pre-wrap; font-family: Arial; font-size: 12px;">${a.conteudoAta}</pre>\n                </div>\n              `:""}\n            </div>\n          `,width:"800px",showCancelButton:!0,confirmButtonText:"üì• Baixar PDF",cancelButtonText:"‚ùå Fechar"}).then((t=>{t.isConfirmed&&this.baixarPDF(a)}))}catch(t){console.error("Erro ao visualizar ata:",t),this.$swal({title:"‚ùå Erro ao Carregar Ata",text:`Erro: ${t.message}`,icon:"error"})}},getRecursoStatusClass(a){switch(a){case"EM AN√ÅLISE":return"status-pendente";case"DEFERIDO":return"status-aprovado";case"INDEFERIDO":return"status-reprovado";default:return""}},async carregarRecursos(){try{if(!this.currentTenantId)return;const{data:a,error:t}=await R.ND.from("recursos").select("\n            id,\n            ata_referencia,\n            recorrente,\n            produto_nome,\n            data_recurso,\n            prazo_final,\n            status,\n            fundamentacao_recurso,\n            decisao,\n            fundamentacao_decisao,\n            autoridade_decisao,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).order("data_recurso",{ascending:!1}).limit(10);if(t)return void console.error("Erro ao carregar recursos:",t);a&&a.length>0?(this.recursos=a,console.log("Recursos carregados do banco de dados:",a.length)):console.log("Nenhum recurso encontrado no banco")}catch(a){console.error("Erro ao carregar recursos:",a)}},async carregarAtasJulgamento(){try{if(!this.currentTenantId)return;const{data:a,error:t}=await R.ND.from("atas_julgamento").select("\n            id,\n            numero,\n            data_publicacao,\n            periodo,\n            total_processos,\n            status_ata,\n            conteudo_ata,\n            arquivo_pdf_url,\n            data_inicio_prazo_recursal,\n            data_fim_prazo_recursal,\n            observacoes,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).neq("status_ata","ELABORACAO").order("data_publicacao",{ascending:!1}).limit(10);if(t)return void console.error("Erro ao carregar atas de julgamento:",t);a&&a.length>0?(this.atasPublicadasRecentes=a.map((a=>({id:a.id,numero:a.numero,dataPublicacao:a.data_publicacao,periodo:a.periodo,totalProcessos:a.total_processos,statusRecursal:a.status_ata,conteudoAta:a.conteudo_ata,arquivoPdfUrl:a.arquivo_pdf_url,dataInicioPrazoRecursal:a.data_inicio_prazo_recursal,dataFimPrazoRecursal:a.data_fim_prazo_recursal,observacoes:a.observacoes,criadoEm:a.criado_em}))),this.atasPublicadas=a.length,console.log("Atas de julgamento carregadas do banco:",a.length)):(this.atasPublicadas=0,console.log("Nenhuma ata de julgamento encontrada no banco"))}catch(a){console.error("Erro ao carregar atas de julgamento:",a)}},async carregarAtasEmElaboracao(){try{if(!this.currentTenantId)return;const{data:a,error:t}=await R.ND.from("atas_julgamento").select("\n            id,\n            numero,\n            periodo,\n            total_processos,\n            status_ata,\n            data_inicio_elaboracao,\n            responsavel_elaboracao,\n            progresso_elaboracao,\n            observacoes,\n            criado_em,\n            atualizado_em\n          ").eq("tenant_id",this.currentTenantId).eq("status_ata","ELABORACAO").order("data_inicio_elaboracao",{ascending:!1});if(t)return void console.error("Erro ao carregar atas em elabora√ß√£o:",t);a&&a.length>0?(this.atasEmElaboracao=a.map((a=>({id:a.id,numero:a.numero,periodo:a.periodo,totalProcessos:a.total_processos,status:"elaboracao",dataInicio:a.data_inicio_elaboracao,responsavel:a.responsavel_elaboracao,progresso:a.progresso_elaboracao,observacoes:a.observacoes,criadoEm:a.criado_em,atualizadoEm:a.atualizado_em}))),this.atasEmAndamento=a.length,console.log("Atas em elabora√ß√£o carregadas do banco:",a.length)):(this.atasEmAndamento=0,console.log("Nenhuma ata em elabora√ß√£o encontrada no banco"))}catch(a){console.error("Erro ao carregar atas em elabora√ß√£o:",a)}},async carregarHomologacoes(){try{if(!this.currentTenantId)return;const{data:a,error:t}=await R.ND.from("homologacoes").select("\n            id,\n            numero_ata,\n            data_homologacao,\n            tipo_homologacao,\n            total_produtos,\n            autoridade_competente,\n            fundamentacao,\n            arquivo_pdf_url,\n            observacoes,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).order("data_homologacao",{ascending:!1}).limit(10);if(t)return void console.error("Erro ao carregar homologa√ß√µes:",t);a&&a.length>0?(this.homologacoesRecentes=a.map((a=>({id:a.id,numeroAta:a.numero_ata,dataHomologacao:a.data_homologacao,totalProdutos:a.total_produtos,tipo:a.tipo_homologacao.toLowerCase(),autoridade:a.autoridade_competente,motivo:a.fundamentacao,arquivoPdfUrl:a.arquivo_pdf_url,observacoes:a.observacoes,criadoEm:a.criado_em}))),this.homologacoesAprovadas=a.filter((a=>"HOMOLOGADA"===a.tipo_homologacao)).length,this.homologacoesIndeferidas=a.filter((a=>"INDEFERIDA"===a.tipo_homologacao)).length,console.log("Homologa√ß√µes carregadas do banco:",a.length)):console.log("Nenhuma homologa√ß√£o encontrada no banco")}catch(a){console.error("Erro ao carregar homologa√ß√µes:",a)}},async carregarProcessosPendentesHomologacao(){try{if(!this.currentTenantId)return;const{data:a,error:t}=await R.ND.from("atas_julgamento").select("\n            id,\n            numero,\n            data_publicacao,\n            total_processos,\n            status_ata,\n            observacoes\n          ").eq("tenant_id",this.currentTenantId).neq("status_ata","ELABORACAO").not("id","in",`(SELECT ata_julgamento_id FROM homologacoes WHERE tenant_id = '${this.currentTenantId}')`).order("data_publicacao",{ascending:!0});if(t)return void console.error("Erro ao carregar processos pendentes de homologa√ß√£o:",t);a&&a.length>0?(this.processosPendentesHomologacao=a.map((a=>({id:a.id,numeroAta:a.numero,dataJulgamento:a.data_publicacao,totalProdutos:a.total_processos,decisaoCCL:this.mapearStatusParaDecisao(a.status_ata),statusRecursos:this.determinarStatusRecursos(a.status_ata),observacoes:a.observacoes}))),this.homologacoesPendentes=a.length,this.processosPendentes=a.length,console.log("Processos pendentes de homologa√ß√£o carregados:",a.length)):(this.homologacoesPendentes=0,this.processosPendentes=0,console.log("Nenhum processo pendente de homologa√ß√£o encontrado"))}catch(a){console.error("Erro ao carregar processos pendentes de homologa√ß√£o:",a)}},mapearStatusParaDecisao(a){switch(a){case"PUBLICADA_EM_PRAZO":case"PUBLICADA_ENCERRADA":return"APROVADA";case"PUBLICADA_COM_RECURSOS":return"APROVADA COM RECURSOS";case"PUBLICADA_PRAZO_VENCIDO":return"PARCIALMENTE APROVADA";default:return"APROVADA"}},determinarStatusRecursos(a){switch(a){case"PUBLICADA_EM_PRAZO":return"EM PRAZO RECURSAL";case"PUBLICADA_ENCERRADA":return"SEM RECURSOS";case"PUBLICADA_COM_RECURSOS":return"RECURSOS JULGADOS";case"PUBLICADA_PRAZO_VENCIDO":return"PRAZO VENCIDO";default:return"SEM RECURSOS"}},async carregarDCBsAtivas(){try{if(!this.currentTenantId)return;await R.ND.rpc("atualizar_status_dcbs");const{data:a,error:t}=await R.ND.from("dcbs").select("\n            id,\n            numero_completo,\n            numero,\n            ano,\n            produto_nome,\n            marca,\n            modelo,\n            fabricante,\n            data_emissao,\n            data_validade,\n            status_dcb,\n            autoridade_emissora,\n            arquivo_pdf_url,\n            qr_code_data,\n            observacoes,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).in("status_dcb",["ATIVA","VENCENDO"]).order("data_emissao",{ascending:!1}).limit(20);if(t)return void console.error("Erro ao carregar DCBs ativas:",t);if(a&&a.length>0){this.dcbsAtivas=a.map((a=>({id:a.id,numero:a.numero_completo,numeroSeparado:a.numero,ano:a.ano,produto:a.produto_nome,marca:a.marca,modelo:a.modelo,fabricante:a.fabricante,dataEmissao:a.data_emissao,validade:a.data_validade,status:a.status_dcb,autoridade:a.autoridade_emissora,arquivoPdf:a.arquivo_pdf_url,qrCode:a.qr_code_data,observacoes:a.observacoes,criadoEm:a.criado_em})));const{count:t}=await R.ND.from("dcbs").select("*",{count:"exact",head:!0}).eq("tenant_id",this.currentTenantId);this.dcbsEmitidas=t||0,console.log("DCBs ativas carregadas do banco:",a.length),console.log("Total de DCBs emitidas:",this.dcbsEmitidas)}else console.log("Nenhuma DCB ativa encontrada no banco"),this.dcbsEmitidas=0}catch(a){console.error("Erro ao carregar DCBs ativas:",a)}},async gerarDCBsAutomaticamente(a,t){try{const{data:o,error:e}=await R.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status\n          ").eq("tenant_id",this.currentTenantId).eq("status","aprovado").limit(t.totalProdutos||50);if(e)return void console.error("Erro ao buscar produtos para DCB:",e);if(!o||0===o.length)return void console.log("Nenhum produto aprovado encontrado para gerar DCBs");const i=(new Date).getFullYear(),s=o.map(((t,o)=>({tenant_id:this.currentTenantId,homologacao_id:a.id,produto_id:t.id,numero:null,ano:i,produto_nome:t.nome,marca:t.marca,modelo:t.modelo||"N√£o informado",fabricante:t.fabricante||"N√£o informado",data_emissao:a.data_homologacao,data_validade:new Date(new Date(a.data_homologacao).getTime()+31536e6).toISOString(),status_dcb:"ATIVA",autoridade_emissora:a.autoridade_competente})));for(const a of s){const{data:t,error:o}=await R.ND.rpc("obter_proximo_numero_dcb",{tenant_uuid:this.currentTenantId,ano_dcb:i});if(o){console.error("Erro ao obter pr√≥ximo n√∫mero DCB:",o);continue}a.numero=t;const{error:e}=await R.ND.from("dcbs").insert([a]);e&&console.error("Erro ao inserir DCB:",e)}console.log(`${s.length} DCBs geradas automaticamente para homologa√ß√£o ${a.numero_ata}`)}catch(o){throw console.error("Erro ao gerar DCBs automaticamente:",o),o}},getPrazoRecursoClass(a){if(!a)return"prazo-indefinido";const t=new Date(a),o=new Date,e=t-o,i=Math.ceil(e/864e5);return i<0?"prazo-vencido":0===i||i<=1?"prazo-urgente":"prazo-normal"},analisarRecurso(a){this.$swal({title:"üìã Analisar Recurso",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Recurso: ${a.produto_nome}</h4>\n            <p><strong>Recorrente:</strong> ${a.recorrente}</p>\n            <p><strong>Ata:</strong> ${a.ata_referencia}</p>\n            <p><strong>Data:</strong> ${this.formatDate(a.data_recurso)}</p>\n            <p><strong>Prazo:</strong> ${this.formatDate(a.prazo_final)}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Decis√£o sobre o Recurso:</label>\n              <select id="decisaoRecurso" class="swal2-select" style="width: 100%;">\n                <option value="">Selecione uma decis√£o</option>\n                <option value="deferido">Deferir Recurso (Reverter decis√£o CCL)</option>\n                <option value="indeferido">Indeferir Recurso (Manter decis√£o CCL)</option>\n                <option value="encaminhar_cpm">Encaminhar para CPM</option>\n              </select>\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Fundamenta√ß√£o:</label>\n              <textarea id="fundamentacaoRecurso" class="swal2-textarea" placeholder="Justificativa da decis√£o..." style="height: 100px;"></textarea>\n            </div>\n            <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Nota:</strong> A decis√£o ser√° encaminhada para homologa√ß√£o pela autoridade competente.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚úÖ Confirmar Decis√£o",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("decisaoRecurso").value,t=document.getElementById("fundamentacaoRecurso").value;return a?t.trim()?{decisao:a,fundamentacao:t}:(this.$swal.showValidationMessage("Informe a fundamenta√ß√£o da decis√£o"),!1):(this.$swal.showValidationMessage("Selecione uma decis√£o"),!1)}}).then((async t=>{if(t.isConfirmed)try{const{error:o}=await R.ND.from("recursos").update({decisao:t.value.decisao,fundamentacao_decisao:t.value.fundamentacao,status:"encaminhar_cpm"===t.value.decisao?"AGUARDANDO CPM":"deferido"===t.value.decisao?"DEFERIDO":"INDEFERIDO",atualizado_em:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(o)return console.error("Erro ao salvar decis√£o:",o),void this.$swal({title:"‚ùå Erro",text:"Erro ao salvar a decis√£o. Tente novamente.",icon:"error"});this.$swal({title:"‚úÖ Recurso Analisado",text:"A decis√£o foi registrada e ser√° inclu√≠da na documenta√ß√£o oficial.",icon:"success"}),await this.carregarDados()}catch(o){console.error("Erro ao processar decis√£o:",o),this.$swal({title:"‚ùå Erro",text:"Erro ao processar a decis√£o. Tente novamente.",icon:"error"})}}))},visualizarDocumentacaoRecurso(a){this.$swal({title:"üìÑ Documenta√ß√£o do Recurso",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Recurso: ${a.produto_nome}</h4>\n            <p><strong>Recorrente:</strong> ${a.recorrente}</p>\n            <p><strong>Protocolo:</strong> ${a.id.toUpperCase()}</p>\n            <hr>\n            <h5>Documentos Dispon√≠veis:</h5>\n            <ul style="text-align: left;">\n              <li>üìã Raz√µes do Recurso</li>\n              <li>üìë Ata de Julgamento Original (${a.ata_referencia})</li>\n              <li>üîç Documenta√ß√£o T√©cnica</li>\n              <li>üìù Parecer da CPM</li>\n              <li>‚öñÔ∏è Fundamenta√ß√£o da CCL</li>\n            </ul>\n            <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Prazo Final:</strong> ${this.formatDate(a.prazo_final)}</small>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.baixarDocumentacaoRecursoEspecifico('${a.id}')">\n                üì• Baixar Documenta√ß√£o Completa\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"‚ùå Fechar"})},julgarRecurso(a){const t=this.recursos.find((t=>t.id===a));t&&this.analisarRecurso(t)},async criarRecurso(a){try{if(!this.currentTenantId)throw new Error("Tenant ID n√£o dispon√≠vel");const{data:t,error:o}=await R.ND.from("recursos").insert([{tenant_id:this.currentTenantId,produto_id:a.produto_id,ata_referencia:a.ata_referencia,recorrente:a.recorrente,produto_nome:a.produto_nome,data_recurso:a.data_recurso,prazo_final:a.prazo_final,status:"EM AN√ÅLISE",fundamentacao_recurso:a.fundamentacao_recurso}]).select();if(o)throw o;return await this.carregarDados(),t[0]}catch(t){throw console.error("Erro ao criar recurso:",t),t}},iniciarMonitoramentoPrazos(){this.verificarPrazos(),this.autoCheckInterval=setInterval((()=>{this.verificarPrazos()}),3e5),console.log("Sistema de monitoramento de prazos iniciado")},async verificarPrazos(){try{await this.verificarPrazosRecursos(),await this.verificarPrazosJulgamento(),await this.verificarPrazosHomologacao(),this.atualizarContadoresAlertas()}catch(a){console.error("Erro ao verificar prazos:",a)}},async verificarPrazosRecursos(){if(!this.recursos||0===this.recursos.length)return;const a=new Date;this.recursos.forEach((t=>{const o=new Date(t.prazo_final),e=o-a,i=Math.ceil(e/864e5);i<0&&"EM AN√ÅLISE"===t.status?this.criarNotificacao({tipo:"prazo-vencido",titulo:"Prazo de Recurso Vencido",mensagem:`Recurso de ${t.recorrente} para ${t.produto_nome} est√° ${Math.abs(i)} dia(s) em atraso`,recurso_id:t.id,prioridade:"alta"}):i<=1&&i>=0&&"EM AN√ÅLISE"===t.status&&this.criarNotificacao({tipo:"prazo-urgente",titulo:"Prazo de Recurso Urgente",mensagem:`Recurso de ${t.recorrente} para ${t.produto_nome} vence ${0===i?"hoje":"amanh√£"}`,recurso_id:t.id,prioridade:"media"})}))},async verificarPrazosJulgamento(){if(!this.produtosPendentes||0===this.produtosPendentes.length)return;const a=new Date;this.produtosPendentes.forEach((t=>{const o=new Date(t.criado_em),e=new Date(o);e.setDate(o.getDate()+10);const i=e-a,s=Math.ceil(i/864e5);s<0?this.criarNotificacao({tipo:"julgamento-vencido",titulo:"Prazo de Julgamento Vencido",mensagem:`Produto ${t.nome} est√° ${Math.abs(s)} dia(s) sem julgamento da CCL`,produto_id:t.id,prioridade:"alta"}):s<=2&&s>=0&&this.criarNotificacao({tipo:"julgamento-urgente",titulo:"Julgamento Urgente Necess√°rio",mensagem:`Produto ${t.nome} precisa ser julgado em ${s} dia(s)`,produto_id:t.id,prioridade:"media"})}))},async verificarPrazosHomologacao(){if(this.processosPendentesHomologacao&&this.processosPendentesHomologacao.length>0){const a=new Date;this.processosPendentesHomologacao.forEach((t=>{const o=new Date(t.dataJulgamento),e=a-o,i=Math.floor(e/864e5);i>10?this.criarNotificacao({tipo:"homologacao-atrasada",titulo:"Homologa√ß√£o Atrasada",mensagem:`Ata ${t.numeroAta} aguarda homologa√ß√£o h√° ${i} dias`,ata_id:t.id,prioridade:"alta"}):i>7&&this.criarNotificacao({tipo:"homologacao-urgente",titulo:"Homologa√ß√£o Pendente",mensagem:`Ata ${t.numeroAta} aguarda homologa√ß√£o h√° ${i} dias`,ata_id:t.id,prioridade:"media"})}))}},criarNotificacao(a){const t=this.notificacoes.find((t=>t.tipo===a.tipo&&(t.recurso_id===a.recurso_id||t.produto_id===a.produto_id||t.ata_id===a.ata_id)));if(!t){const t={id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...a,criado_em:(new Date).toISOString(),lido:!1};this.notificacoes.unshift(t),this.notificacoes.length>20&&(this.notificacoes=this.notificacoes.slice(0,20)),"alta"===a.prioridade&&this.mostrarToast(t)}},atualizarContadoresAlertas(){this.prazosVencidos=this.notificacoes.filter((a=>a.tipo.includes("vencido")&&!a.lido)).length,this.prazosUrgentes=this.notificacoes.filter((a=>a.tipo.includes("urgente")&&!a.lido)).length},getAlertaIcon(a){switch(a){case"prazo-vencido":case"julgamento-vencido":case"homologacao-atrasada":return"üö®";case"prazo-urgente":case"julgamento-urgente":case"homologacao-urgente":return"‚ö†Ô∏è";default:return"üì¢"}},abrirAlerta(a){let t=`\n        <div style="text-align: left; padding: 15px;">\n          <h4>${a.titulo}</h4>\n          <p>${a.mensagem}</p>\n          <hr>\n          <small><strong>Criado em:</strong> ${this.formatDate(a.criado_em)}</small>\n        `;if(a.recurso_id){const o=this.recursos.find((t=>t.id===a.recurso_id));o&&(t+=`\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="document.dispatchEvent(new CustomEvent('abrirRecurso', {detail: '${o.id}'}))">\n                üìã Analisar Recurso\n              </button>\n            </div>\n          `)}a.produto_id&&(t+=`\n          <div style="margin-top: 15px;">\n            <button class="swal2-confirm swal2-styled" onclick="document.dispatchEvent(new CustomEvent('abrirProduto', {detail: '${a.produto_id}'}))">\n              ‚öñÔ∏è Julgar Processo\n            </button>\n          </div>\n        `),t+="</div>",this.$swal({title:"üö® Detalhes do Alerta",html:t,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"‚ùå Fechar"}),this.marcarComoLido(a.id)},marcarComoLido(a){const t=this.notificacoes.find((t=>t.id===a));t&&(t.lido=!0,this.atualizarContadoresAlertas())},marcarTodosComoLidos(){this.notificacoes.forEach((a=>a.lido=!0)),this.atualizarContadoresAlertas()},mostrarToast(a){this.$swal({title:a.titulo,text:a.mensagem,icon:"warning",toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0})},async criarNovaAta(){try{const{data:a,error:t}=await R.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            categoria_id,\n            status,\n            julgado_em,\n            adequacao_tecnica,\n            observacoes_ccl,\n            base_legal\n          ").eq("tenant_id",this.currentTenantId).in("status",["julgado_aprovado","julgado_reprovado"]).not("julgado_em","is",null).is("ata_julgamento_id",null);if(t)throw t;if(!a||0===a.length)return void this.$swal({title:"‚ö†Ô∏è Nenhum Produto Dispon√≠vel",text:"N√£o h√° produtos julgados dispon√≠veis para incluir em uma nova ata. Realize julgamentos primeiro.",icon:"warning"});const o=a.map((a=>`\n          <tr style="border-bottom: 1px solid #eee;">\n            <td style="padding: 8px;">${a.nome}</td>\n            <td style="padding: 8px;">${a.marca}</td>\n            <td style="padding: 8px;">\n              <span class="status-badge ${"julgado_aprovado"===a.status?"status-aprovado":"status-reprovado"}">\n                ${"julgado_aprovado"===a.status?"Aprovado":"Reprovado"}\n              </span>\n            </td>\n            <td style="padding: 8px;">${this.formatDate(a.julgado_em)}</td>\n          </tr>\n        `)).join(""),e=await this.$swal({title:"üìã Criar Nova Ata de Julgamento",html:`\n            <div style="text-align: left; padding: 15px;">\n              \x3c!-- Formul√°rio da Ata --\x3e\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üìÑ Dados da Ata</h4>\n                <div style="margin-bottom: 15px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 5px;">Per√≠odo de Refer√™ncia:</label>\n                  <input id="periodoAta" class="swal2-input" type="text" placeholder="Ex: Janeiro 2025" value="${(new Date).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}">\n                </div>\n                <div style="margin-bottom: 15px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 5px;">N√∫mero da Ata:</label>\n                  <input id="numeroAta" class="swal2-input" type="text" placeholder="Ex: ATA-CCL-008/2025" value="ATA-CCL-${String(Math.floor(900*Math.random())+100)}/${(new Date).getFullYear()}">\n                </div>\n                <div style="margin-bottom: 15px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 5px;">Descri√ß√£o:</label>\n                  <textarea id="descricaoAta" class="swal2-textarea" placeholder="Descri√ß√£o da ata de julgamento..." rows="3">Ata de julgamento da Comiss√£o de Contrata√ß√£o ou Licita√ß√£o referente aos processos de pr√©-qualifica√ß√£o de bens do per√≠odo.</textarea>\n                </div>\n              </div>\n\n              \x3c!-- Lista de Produtos --\x3e\n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üì¶ Produtos a serem inclu√≠dos (${a.length})</h4>\n                <div style="max-height: 300px; overflow-y: auto;">\n                  <table style="width: 100%; font-size: 12px;">\n                    <thead>\n                      <tr style="background: #f8f9fa;">\n                        <th style="padding: 8px; text-align: left;">Produto</th>\n                        <th style="padding: 8px; text-align: left;">Marca</th>\n                        <th style="padding: 8px; text-align: left;">Decis√£o</th>\n                        <th style="padding: 8px; text-align: left;">Data Julgamento</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      ${o}\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n\n              <div style="background: #d1ecf1; padding: 10px; border-radius: 4px; margin-top: 15px;">\n                <small><strong>üìù Pr√≥ximos passos:</strong> Ap√≥s criar a ata, ela estar√° dispon√≠vel na aba "Atas de Julgamento" para elabora√ß√£o do conte√∫do e publica√ß√£o oficial.</small>\n              </div>\n            </div>\n          `,width:"900px",showCancelButton:!0,confirmButtonText:"‚úÖ Criar Ata com "+a.length+" Produtos",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#28a745",preConfirm:()=>{const a=document.getElementById("periodoAta").value.trim(),t=document.getElementById("numeroAta").value.trim(),o=document.getElementById("descricaoAta").value.trim();return a&&t?{periodo:a,numero:t,descricao:o}:(this.$swal.showValidationMessage("Preencha o per√≠odo e n√∫mero da ata"),!1)}});if(!e.isConfirmed)return;const i={tenant_id:this.currentTenantId,numero:e.value.numero,periodo:e.value.periodo,descricao:e.value.descricao,total_processos:a.length,status_ata:"ELABORACAO",data_inicio_elaboracao:(new Date).toISOString(),responsavel_elaboracao:this.usuarioNome||"CCL",progresso_elaboracao:10,conteudo_ata:this.gerarConteudoAtaInicial(a,e.value),criado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()},{data:s,error:r}=await R.ND.from("atas_julgamento").insert([i]).select();if(r)throw r;const n=s[0].id,{error:l}=await R.ND.from("produtos").update({ata_julgamento_id:n,atualizado_em:(new Date).toISOString()}).in("id",a.map((a=>a.id)));if(l)throw l;await this.carregarAtasJulgamento(),await this.carregarAtasEmElaboracao(),await this.carregarDados(),this.$swal({title:"‚úÖ Ata Criada com Sucesso!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>${e.value.numero}</h4>\n              <p><strong>Per√≠odo:</strong> ${e.value.periodo}</p>\n              <p><strong>Produtos inclu√≠dos:</strong> ${a.length}</p>\n              <hr>\n              <p>üîÑ <strong>Status:</strong> ELABORA√á√ÉO</p>\n              <p>A ata foi criada e est√° dispon√≠vel na se√ß√£o <strong>"üìù Atas em Elabora√ß√£o"</strong> para:</p>\n              <ul style="text-align: left; margin: 10px 0; padding-left: 30px;">\n                <li>Revisar conte√∫do</li>\n                <li>Ajustar fundamenta√ß√µes</li>\n                <li>Finalizar para publica√ß√£o</li>\n              </ul>\n            </div>\n          `,icon:"success",confirmButtonText:"üìù Ver Atas em Elabora√ß√£o",showCancelButton:!0,cancelButtonText:"‚úÖ OK"}).then((a=>{a.isConfirmed&&(this.activeTab="atas")}))}catch(a){console.error("Erro ao criar nova ata:",a),this.$swal({title:"‚ùå Erro ao Criar Ata",text:`Erro: ${a.message}`,icon:"error"})}},async editarAta(a){try{const{data:t,error:o}=await R.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status,\n            julgado_em,\n            adequacao_tecnica,\n            observacoes_ccl,\n            base_legal\n          ").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId).order("nome");if(o)throw o;const e=t?.filter((a=>"julgado_aprovado"===a.status))||[],i=t?.filter((a=>"julgado_reprovado"===a.status))||[],s=await this.$swal({title:"‚úèÔ∏è Editor de Ata de Julgamento",html:`\n            <div style="text-align: left; padding: 15px; max-height: 600px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üìã Informa√ß√µes da Ata</h4>\n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">\n                  <div>\n                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">N√∫mero da Ata:</label>\n                    <input id="numeroAta" class="swal2-input" type="text" value="${a.numero}" style="margin: 0;">\n                  </div>\n                  <div>\n                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">Per√≠odo:</label>\n                    <input id="periodoAta" class="swal2-input" type="text" value="${a.periodo}" style="margin: 0;">\n                  </div>\n                </div>\n                <div style="margin-top: 15px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 5px;">Descri√ß√£o:</label>\n                  <textarea id="descricaoAta" class="swal2-textarea" rows="2" style="margin: 0; width: 100%; max-width: 100%; resize: vertical;">${a.descricao||""}</textarea>\n                </div>\n              </div>\n              \n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üìù Conte√∫do da Ata</h4>\n                <textarea id="conteudoAta" class="swal2-textarea" rows="12" placeholder="Digite ou edite o conte√∫do completo da ata..." style="margin: 0; font-family: 'Courier New', monospace; font-size: 12px; width: 100%; max-width: 100%; resize: vertical;">${a.conteudoAta||""}</textarea>\n                <small style="color: #666; margin-top: 5px; display: block;">üí° Use este campo para redigir o conte√∫do oficial da ata que ser√° publicado</small>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h5 style="color: #2d5a2d; margin: 0 0 10px 0;">‚úÖ Produtos Aprovados (${e.length})</h5>\n                ${e.length>0?e.map((a=>`\n                    <div style="border-bottom: 1px solid #c8e6c8; padding: 5px 0; font-size: 12px;">\n                      <strong>${a.nome}</strong> - ${a.marca} (${a.modelo})\n                    </div>\n                  `)).join(""):'<p style="color: #666; font-style: italic;">Nenhum produto aprovado</p>'}\n              </div>\n              \n              <div style="background: #fce8e8; padding: 15px; border-radius: 8px;">\n                <h5 style="color: #5a2d2d; margin: 0 0 10px 0;">‚ùå Produtos Reprovados (${i.length})</h5>\n                ${i.length>0?i.map((a=>`\n                    <div style="border-bottom: 1px solid #f5c6c6; padding: 5px 0; font-size: 12px;">\n                      <strong>${a.nome}</strong> - ${a.marca} (${a.modelo})\n                    </div>\n                  `)).join(""):'<p style="color: #666; font-style: italic;">Nenhum produto reprovado</p>'}\n              </div>\n            </div>\n          `,width:"1100px",showCancelButton:!0,confirmButtonText:"üíæ Salvar Altera√ß√µes",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#28a745",preConfirm:()=>{const a=document.getElementById("numeroAta").value.trim(),t=document.getElementById("periodoAta").value.trim(),o=document.getElementById("descricaoAta").value.trim(),e=document.getElementById("conteudoAta").value.trim();return a&&t?{numero:a,periodo:t,descricao:o,conteudo:e}:(this.$swal.showValidationMessage("N√∫mero da ata e per√≠odo s√£o obrigat√≥rios"),!1)}});if(!s.isConfirmed)return;const{error:r}=await R.ND.from("atas_julgamento").update({numero:s.value.numero,periodo:s.value.periodo,descricao:s.value.descricao,conteudo_ata:s.value.conteudo,progresso_elaboracao:s.value.conteudo?50:10,atualizado_em:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(r)throw r;await this.carregarAtasEmElaboracao(),this.$swal({title:"‚úÖ Ata Atualizada!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>üìã ${s.value.numero}</h4>\n              <p><strong>Per√≠odo:</strong> ${s.value.periodo}</p>\n              <p>‚úèÔ∏è <strong>Status:</strong> Altera√ß√µes salvas com sucesso</p>\n              <hr>\n              <p>A ata continua em elabora√ß√£o e pode ser editada at√© a publica√ß√£o oficial.</p>\n              <div style="background: #d4edda; padding: 10px; border-radius: 4px; margin-top: 15px;">\n                <small><strong>üìù Pr√≥ximos passos:</strong> Continue editando ou clique em "Finalizar" quando estiver pronta para publica√ß√£o.</small>\n              </div>\n            </div>\n          `,icon:"success"})}catch(t){console.error("Erro ao editar ata:",t),this.$swal({title:"‚ùå Erro ao Editar Ata",text:`Erro: ${t.message}`,icon:"error"})}},async finalizarAta(a){const t=await this.$swal({title:"‚úÖ Finalizar Ata de Julgamento",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numero}</h4>\n            <p><strong>Per√≠odo:</strong> ${a.periodo}</p>\n            <p><strong>Total de processos:</strong> ${a.totalProcessos}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <h5>‚ö†Ô∏è Aten√ß√£o:</h5>\n              <p>Ao finalizar a ata:</p>\n              <ul style="text-align: left; margin-left: 20px;">\n                <li>Ser√° gerado o documento PDF oficial</li>\n                <li>Ser√° publicado extrato no Di√°rio Oficial</li>\n                <li>Ser√° aberto prazo recursal de 3 dias √∫teis</li>\n                <li>A ata n√£o poder√° mais ser editada</li>\n              </ul>\n            </div>\n            <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Confirma a finaliza√ß√£o?</strong> Esta a√ß√£o n√£o pode ser desfeita.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚úÖ Confirmar Finaliza√ß√£o",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#28a745"});if(t.isConfirmed)try{const t=new Date,o=this.adicionarDiasUteis(t,3),{error:e}=await R.ND.from("atas_julgamento").update({status_ata:"EM PRAZO",data_publicacao:t.toISOString(),data_inicio_prazo_recursal:t.toISOString(),data_fim_prazo_recursal:o.toISOString(),progresso_elaboracao:100,atualizado_em:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(e)throw e;await this.carregarAtasJulgamento(),await this.carregarAtasEmElaboracao(),await this.carregarDados(),this.$swal({title:"üéâ Ata Finalizada e Publicada!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>${a.numero}</h4>\n              <p>‚úÖ Status atualizado para: <strong>EM PRAZO RECURSAL</strong></p>\n              <p>üìÖ Publicada em: <strong>${t.toLocaleDateString("pt-BR")}</strong></p>\n              <p>‚è∞ Prazo recursal at√©: <strong>${o.toLocaleDateString("pt-BR")}</strong></p>\n              <hr>\n              <p>A ata agora est√° dispon√≠vel na se√ß√£o <strong>"üìã Atas Publicadas Recentemente"</strong></p>\n            </div>\n          `,icon:"success"})}catch(o){console.error("Erro ao finalizar ata:",o),this.$swal({title:"‚ùå Erro ao Finalizar",text:`Erro: ${o.message}`,icon:"error"})}},visualizarHistorico(){this.$swal({title:"üìä Hist√≥rico de Atas",html:'\n          <div style="text-align: left; padding: 15px;">\n            <h5>Filtros de Pesquisa:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data in√≠cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <select class="swal2-select" style="margin-bottom: 15px;">\n              <option value="">Todos os status</option>\n              <option value="elaboracao">Em elabora√ß√£o</option>\n              <option value="publicada">Publicadas</option>\n              <option value="prazo_recursal">Em prazo recursal</option>\n              <option value="encerrada">Encerradas</option>\n            </select>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>Estat√≠sticas Gerais:</h6>\n              <p>üìã Total de atas: 25</p>\n              <p>‚úÖ Atas publicadas: 23</p>\n              <p>üìÑ Processos julgados: 284</p>\n              <p>‚öñÔ∏è Taxa de aprova√ß√£o: 78%</p>\n            </div>\n          </div>\n        ',showCancelButton:!0,confirmButtonText:"üîç Pesquisar",cancelButtonText:"‚ùå Fechar"})},getStatusRecursalClass(a){switch(a){case"EM PRAZO":return"status-em-prazo";case"ENCERRADO":return"status-encerrado";case"COM RECURSOS":return"status-com-recursos";default:return"status-indefinido"}},async baixarPDF(a){try{const{jsPDF:t}=await Promise.resolve().then(o.bind(o,1749)),{data:e,error:i}=await R.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status,\n            julgado_em,\n            adequacao_tecnica,\n            observacoes_ccl,\n            base_legal\n          ").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId);if(i)throw i;const s=new t,r=s.internal.pageSize.getWidth(),n=s.internal.pageSize.getHeight();let l=25;s.setFontSize(16),s.setFont(void 0,"bold"),s.text("COMISS√ÉO DE CONTRATA√á√ÉO OU LICITA√á√ÉO (CCL)",r/2,l,{align:"center"}),l+=8,s.setFontSize(12),s.setFont(void 0,"normal"),s.text("Sistema de Pr√©-Qualifica√ß√£o de Bens - Lei 14.133/2021",r/2,l,{align:"center"}),l+=15,s.setLineWidth(.5),s.line(30,l,r-30,l),l+=20,s.setFontSize(18),s.setFont(void 0,"bold"),s.text("ATA DE JULGAMENTO",r/2,l,{align:"center"}),l+=15,s.setFontSize(12),s.setFont(void 0,"normal"),s.text(`N√∫mero: ${a.numero}`,30,l),l+=8,s.text(`Per√≠odo: ${a.periodo}`,30,l),l+=8,s.text(`Data de Publica√ß√£o: ${this.formatDate(a.dataPublicacao)}`,30,l),l+=8,s.text(`Status: ${a.statusRecursal}`,30,l),l+=20;const c=e?.filter((a=>"julgado_aprovado"===a.status))||[],d=e?.filter((a=>"julgado_reprovado"===a.status))||[];if(s.setFontSize(14),s.setFont(void 0,"bold"),s.text("RESUMO DOS JULGAMENTOS",30,l),l+=15,s.setFontSize(11),s.setFont(void 0,"normal"),s.text(`Total de processos julgados: ${e?.length||0}`,35,l),l+=8,s.text(`Produtos aprovados: ${c.length}`,35,l),l+=8,s.text(`Produtos reprovados: ${d.length}`,35,l),l+=20,c.length>0&&(s.setFontSize(14),s.setFont(void 0,"bold"),s.text("PRODUTOS APROVADOS",30,l),l+=12,c.forEach(((a,t)=>{l>n-40&&(s.addPage(),l=30),s.setFontSize(11),s.setFont(void 0,"bold"),s.text(`${t+1}. ${a.nome}`,35,l),l+=6,s.setFont(void 0,"normal"),s.text(`Marca: ${a.marca} | Modelo: ${a.modelo}`,40,l),l+=6,s.text(`Fabricante: ${a.fabricante}`,40,l),l+=6,s.text(`Julgado em: ${this.formatDate(a.julgado_em)}`,40,l),l+=6,a.adequacao_tecnica&&(s.text(`Adequa√ß√£o T√©cnica: ${a.adequacao_tecnica}`,40,l),l+=6),l+=5})),l+=10),d.length>0&&(l>n-60&&(s.addPage(),l=30),s.setFontSize(14),s.setFont(void 0,"bold"),s.text("PRODUTOS REPROVADOS",30,l),l+=12,d.forEach(((a,t)=>{l>n-40&&(s.addPage(),l=30),s.setFontSize(11),s.setFont(void 0,"bold"),s.text(`${t+1}. ${a.nome}`,35,l),l+=6,s.setFont(void 0,"normal"),s.text(`Marca: ${a.marca} | Modelo: ${a.modelo}`,40,l),l+=6,s.text(`Fabricante: ${a.fabricante}`,40,l),l+=6,s.text(`Julgado em: ${this.formatDate(a.julgado_em)}`,40,l),l+=6,a.observacoes_ccl&&(s.setFont(void 0,"italic"),s.text(`Motivo: ${a.observacoes_ccl}`,40,l),l+=6),l+=5}))),a.conteudoAta){l>n-80&&(s.addPage(),l=30),s.setFontSize(14),s.setFont(void 0,"bold"),s.text("CONTE√öDO COMPLETO DA ATA",30,l),l+=12,s.setFontSize(10),s.setFont(void 0,"normal");const t=s.splitTextToSize(a.conteudoAta,r-70);s.text(t,35,l)}const u=s.internal.getNumberOfPages();for(let a=1;a<=u;a++)s.setPage(a),s.setLineWidth(.3),s.line(30,n-25,r-30,n-25),s.setFontSize(8),s.setFont(void 0,"normal"),s.text("Sistema Comprar Bem - Atas de Julgamento CCL",30,n-18),s.text(`P√°gina ${a} de ${u}`,r/2,n-18,{align:"center"}),s.text("Lei 14.133/2021",r-30,n-18,{align:"right"}),s.text(`Gerado em: ${(new Date).toLocaleDateString("pt-BR")} √†s ${(new Date).toLocaleTimeString("pt-BR")}`,30,n-12);const m=`ATA_${a.numero.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;s.save(m),this.$swal({title:"‚úÖ PDF Gerado!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>üìã ${a.numero}</h4>\n              <p><strong>Arquivo:</strong> ${m}</p>\n              <p>PDF da ata de julgamento gerado com sucesso!</p>\n              <p><strong>üìä Conte√∫do:</strong></p>\n              <ul style="text-align: left; margin: 10px 0; padding-left: 30px;">\n                <li>${c.length} produto(s) aprovado(s)</li>\n                <li>${d.length} produto(s) reprovado(s)</li>\n                <li>Informa√ß√µes detalhadas de cada julgamento</li>\n                <li>Base legal e fundamenta√ß√µes</li>\n              </ul>\n            </div>\n          `,icon:"success"})}catch(t){console.error("Erro ao gerar PDF da ata:",t),this.$swal({title:"‚ùå Erro ao Gerar PDF",text:`Erro: ${t.message}`,icon:"error"})}},async gerenciarRecursos(a){try{const{data:t,error:o}=await R.ND.from("recursos").select("*").eq("ata_referencia",a.numero).eq("tenant_id",this.currentTenantId).order("data_recurso",{ascending:!1});o&&console.warn("Erro ao carregar recursos (talvez tabela n√£o exista):",o);const e=t||[],i=this.formatDate(a.dataFimPrazoRecursal),s=a.dataFimPrazoRecursal&&new Date(a.dataFimPrazoRecursal)<new Date;this.$swal({title:"üìÑ Gerenciar Recursos Administrativos",html:`\n            <div style="text-align: left; padding: 15px; max-height: 500px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 10px 0; color: #495057;">üìã Informa√ß√µes da Ata</h4>\n                <p><strong>N√∫mero:</strong> ${a.numero}</p>\n                <p><strong>Data Publica√ß√£o:</strong> ${this.formatDate(a.dataPublicacao)}</p>\n                <p><strong>Status Recursal:</strong> ${a.statusRecursal}</p>\n                <p><strong>Prazo para Recursos:</strong> ${i||"N√£o definido"}</p>\n                ${s?'<p style="color: #dc3545; font-weight: bold;">‚ö†Ô∏è Prazo recursal VENCIDO</p>':'<p style="color: #28a745; font-weight: bold;">‚úÖ Prazo recursal ATIVO</p>'}\n              </div>\n              \n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">üìÑ Recursos Protocolados (${e.length})</h4>\n                ${e.length>0?e.map((a=>`\n                    <div style="border-bottom: 1px solid #eee; padding: 10px 0;">\n                      <div style="display: flex; justify-content: space-between; align-items: center;">\n                        <div>\n                          <strong>${a.recorrente||"Recorrente n√£o informado"}</strong>\n                          <p style="margin: 5px 0; color: #666;">Produto: ${a.produto_nome||"N√£o especificado"}</p>\n                          <small>Protocolado em: ${this.formatDate(a.data_recurso)}</small>\n                        </div>\n                        <span class="status-badge ${this.getRecursoStatusClass(a.status)}">\n                          ${a.status||"EM AN√ÅLISE"}\n                        </span>\n                      </div>\n                    </div>\n                  `)).join(""):'<div style="text-align: center; color: #666; padding: 20px;"><p><em>Nenhum recurso protocolado ainda.</em></p></div>'}\n              </div>\n              \n              ${s?"":'\n                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                  <h5 style="color: #1976d2; margin: 0 0 10px 0;">‚ö° A√ß√µes Dispon√≠veis</h5>\n                  <button id="novoRecurso" class="swal2-confirm swal2-styled" style="margin: 5px;">\n                    ‚ûï Protocolar Novo Recurso\n                  </button>\n                  <button id="analisarRecursos" class="swal2-confirm swal2-styled" style="margin: 5px; background: #4caf50;">\n                    üîç Analisar Recursos Existentes\n                  </button>\n                </div>\n              '}\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px;">\n                <small><strong>üìö Base Legal:</strong> Art. 165-171 da Lei 14.133/2021 - Recursos administrativos em processos licitat√≥rios</small>\n              </div>\n            </div>\n          `,width:"700px",showCancelButton:!0,confirmButtonText:"üì• Gerar Relat√≥rio PDF",cancelButtonText:"‚ùå Fechar",didOpen:()=>{const t=document.getElementById("novoRecurso"),o=document.getElementById("analisarRecursos");t&&(t.onclick=()=>{this.$swal.close(),this.novoRecurso(a)}),o&&(o.onclick=()=>{this.$swal.close(),this.analisarRecursos(a,e)})}})}catch(t){console.error("Erro ao gerenciar recursos:",t),this.$swal({title:"‚ùå Erro ao Carregar Recursos",text:`Erro: ${t.message}`,icon:"error"})}},novoRecurso(a){this.$swal({title:"‚ûï Protocolar Novo Recurso",html:`\n          <div style="text-align: left; padding: 15px;">\n            <p><strong>Ata:</strong> ${a.numero}</p>\n            <hr>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Recorrente:</label>\n              <input id="recorrente" class="swal2-input" type="text" placeholder="Nome da empresa/pessoa">\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Produto/Processo:</label>\n              <input id="produtoNome" class="swal2-input" type="text" placeholder="Nome do produto contestado">\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Fundamenta√ß√£o do Recurso:</label>\n              <textarea id="fundamentacao" class="swal2-textarea" rows="4" placeholder="Descreva os motivos e fundamentos legais do recurso..."></textarea>\n            </div>\n            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">\n              <small><strong>‚ö†Ô∏è Prazo:</strong> Recursos devem ser protocolados em at√© 3 dias √∫teis ap√≥s a publica√ß√£o da ata.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚úÖ Protocolar Recurso",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("recorrente").value.trim(),t=document.getElementById("produtoNome").value.trim(),o=document.getElementById("fundamentacao").value.trim();return a&&t&&o?{recorrente:a,produtoNome:t,fundamentacao:o}:(this.$swal.showValidationMessage("Preencha todos os campos obrigat√≥rios"),!1)}}).then((a=>{a.isConfirmed&&this.$swal({title:"‚úÖ Recurso Protocolado!",html:`\n              <div style="text-align: center; padding: 20px;">\n                <h4>üìÑ Protocolo: REC-${Math.floor(9e3*Math.random())+1e3}/2025</h4>\n                <p><strong>Recorrente:</strong> ${a.value.recorrente}</p>\n                <p><strong>Produto:</strong> ${a.value.produtoNome}</p>\n                <p><strong>Status:</strong> EM AN√ÅLISE</p>\n                <hr>\n                <p>O recurso foi protocolado e ser√° analisado pela Comiss√£o.</p>\n              </div>\n            `,icon:"success"})}))},analisarRecursos(a,t){this.$swal({title:"üîç An√°lise de Recursos",html:`\n          <div style="text-align: left; padding: 15px;">\n            <p><strong>Ata:</strong> ${a.numero}</p>\n            <p><strong>Recursos para an√°lise:</strong> ${t.length}</p>\n            <hr>\n            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">\n              <h5 style="color: #1976d2; margin: 0 0 10px 0;">‚öñÔ∏è Processo de An√°lise</h5>\n              <ol>\n                <li>Verifica√ß√£o da tempestividade do recurso</li>\n                <li>An√°lise da fundamenta√ß√£o apresentada</li>\n                <li>Avalia√ß√£o t√©cnica do m√©rito</li>\n                <li>Decis√£o: Deferimento ou Indeferimento</li>\n                <li>Publica√ß√£o da decis√£o</li>\n              </ol>\n            </div>\n            <p><em>Em uma implementa√ß√£o completa, esta tela permitiria analisar cada recurso individualmente.</em></p>\n          </div>\n        `,confirmButtonText:"‚úÖ Entendi"})},calcularPrazoHomologacao(a){if(!a)return"Sem prazo";const t=new Date(a),o=new Date,e=this.adicionarDiasUteis(t,10);if(o>e){const a=this.calcularDiasUteisEntre(e,o);return`Vencido h√° ${a} dia${a>1?"s":""} √∫teis`}const i=this.calcularDiasUteisEntre(o,e);return 0===i?"√öltimo dia √∫til":1===i?"1 dia √∫til restante":`${i} dias √∫teis restantes`},getPrazoHomologacaoClass(a){if(!a)return"prazo-indefinido";const t=new Date(a),o=new Date,e=this.adicionarDiasUteis(t,10);if(o>e)return"prazo-vencido";const i=this.calcularDiasUteisEntre(o,e);return i<=1?"prazo-urgente":i<=3?"prazo-atencao":"prazo-normal"},homologarProcesso(a){this.$swal({title:"‚úÖ Homologar Processo",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Produtos:</strong> ${a.totalProdutos}</p>\n            <p><strong>Decis√£o CCL:</strong> ${a.decisaoCCL}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Autoridade Competente:</label>\n              <input id="autoridadeHomo" class="swal2-input" type="text" placeholder="Nome da autoridade" value="Dr. Jo√£o Silva - Secret√°rio">\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Fundamenta√ß√£o da Homologa√ß√£o:</label>\n              <textarea id="fundamentacaoHomo" class="swal2-textarea" placeholder="Justificativa para homologa√ß√£o..." style="height: 100px;">Os processos foram conduzidos em conformidade com a Lei 14.133/2021 e demais normas aplic√°veis, atendendo aos princ√≠pios da legalidade, impessoalidade e moralidade.</textarea>\n            </div>\n            <div style="background: #d4edda; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Efeitos:</strong> Ser√£o emitidas as DCBs para os produtos aprovados e inclu√≠dos no Cat√°logo de Bens Padronizados.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚úÖ Confirmar Homologa√ß√£o",cancelButtonText:"‚ùå Cancelar",confirmButtonColor:"#28a745",preConfirm:()=>{const a=document.getElementById("autoridadeHomo").value,t=document.getElementById("fundamentacaoHomo").value;return a.trim()&&t.trim()?{autoridade:a,fundamentacao:t}:(this.$swal.showValidationMessage("Preencha todos os campos obrigat√≥rios"),!1)}}).then((async t=>{if(t.isConfirmed)try{const o={tenant_id:this.currentTenantId,ata_julgamento_id:a.id,numero_ata:a.numeroAta,data_homologacao:(new Date).toISOString(),tipo_homologacao:"HOMOLOGADA",total_produtos:a.totalProdutos,autoridade_competente:t.value.autoridade,fundamentacao:t.value.fundamentacao},{data:e,error:i}=await R.ND.from("homologacoes").insert([o]).select().single();if(i)throw new Error(`Erro ao criar homologa√ß√£o: ${i.message}`);await this.gerarDCBsAutomaticamente(e,a),await this.carregarHomologacoes(),await this.carregarProcessosPendentesHomologacao(),await this.carregarDCBsAtivas(),this.$swal({title:"üéâ Processo Homologado",text:"O processo foi homologado com sucesso! As DCBs foram emitidas automaticamente.",icon:"success"})}catch(o){console.error("Erro ao homologar processo:",o),this.$swal({title:"‚ùå Erro",text:`Erro ao homologar processo: ${o.message}`,icon:"error"})}}))},indeferirProcesso(a){this.$swal({title:"‚ùå Indeferir Processo",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Produtos:</strong> ${a.totalProdutos}</p>\n            <p><strong>Decis√£o CCL:</strong> ${a.decisaoCCL}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Motivo do Indeferimento:</label>\n              <select id="motivoIndeferimento" class="swal2-select">\n                <option value="">Selecione o motivo</option>\n                <option value="irregularidade_processual">Irregularidade Processual</option>\n                <option value="documentacao_incompleta">Documenta√ß√£o Incompleta</option>\n                <option value="nao_atendimento_requisitos">N√£o Atendimento aos Requisitos</option>\n                <option value="interesse_publico">Contr√°rio ao Interesse P√∫blico</option>\n                <option value="outros">Outros Motivos</option>\n              </select>\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Fundamenta√ß√£o:</label>\n              <textarea id="fundamentacaoIndeferimento" class="swal2-textarea" placeholder="Justificativa detalhada..." style="height: 100px;"></textarea>\n            </div>\n            <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Aten√ß√£o:</strong> O indeferimento impedir√° a emiss√£o das DCBs e os produtos n√£o ser√£o inclu√≠dos no cat√°logo.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚ùå Confirmar Indeferimento",cancelButtonText:"üîô Cancelar",confirmButtonColor:"#dc3545",preConfirm:()=>{const a=document.getElementById("motivoIndeferimento").value,t=document.getElementById("fundamentacaoIndeferimento").value;return a&&t.trim()?{motivo:a,fundamentacao:t}:(this.$swal.showValidationMessage("Selecione o motivo e forne√ßa a fundamenta√ß√£o"),!1)}}).then((a=>{a.isConfirmed&&this.$swal({title:"üìù Processo Indeferido",text:"O processo foi indeferido. Os interessados ser√£o notificados automaticamente.",icon:"warning"})}))},consultarPendentes(){this.$swal({title:"üìã Consulta de Processos Pendentes",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h5>Filtros de Pesquisa:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data in√≠cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <select class="swal2-select" style="margin-bottom: 15px;">\n              <option value="">Todos os status de recursos</option>\n              <option value="sem_recursos">Sem recursos</option>\n              <option value="recursos_julgados">Recursos julgados</option>\n              <option value="com_recursos_pendentes">Com recursos pendentes</option>\n            </select>\n            <hr>\n            <div style="background: #e3f2fd; padding: 15px; border-radius: 4px;">\n              <h6>Resumo de Pend√™ncias:</h6>\n              <p>‚è≥ Aguardando homologa√ß√£o: ${this.homologacoesPendentes}</p>\n              <p>üìã Atas sem recursos: 2</p>\n              <p>üìÑ Atas com recursos julgados: 1</p>\n              <p>‚ö° Urgente (> 15 dias): 0</p>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"üîç Aplicar Filtros",cancelButtonText:"‚ùå Fechar"})},relatorioHomologacoes(){this.$swal({title:"üìä Relat√≥rio de Homologa√ß√µes",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h5>Per√≠odo do Relat√≥rio:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data in√≠cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>Estat√≠sticas Gerais (Este Ano):</h6>\n              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">\n                <div>\n                  <p><strong>‚úÖ Homologa√ß√µes:</strong> ${this.homologacoesAprovadas+47}</p>\n                  <p><strong>‚ùå Indeferimentos:</strong> ${this.homologacoesIndeferidas+3}</p>\n                  <p><strong>üìú DCBs Emitidas:</strong> ${this.dcbsEmitidas}</p>\n                </div>\n                <div>\n                  <p><strong>‚è±Ô∏è Tempo M√©dio:</strong> 5,2 dias</p>\n                  <p><strong>üìã Taxa Aprova√ß√£o:</strong> 94%</p>\n                  <p><strong>üîÑ Renova√ß√µes:</strong> 23</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"üì• Gerar PDF",cancelButtonText:"‚ùå Fechar"})},baixarPDFHomologacao(a){this.$swal({title:"üì• Download de Homologa√ß√£o",text:`Baixando documento de homologa√ß√£o ${a.numeroAta}...`,icon:"info",timer:2e3,showConfirmButton:!1})},visualizarDCBs(a){this.$swal({title:"üìú DCBs da Homologa√ß√£o",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n            <hr>\n            <h5>DCBs Emitidas:</h5>\n            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">\n              <p><strong>DCB 001/2024:</strong> Monitor de Sinais Vitais - MedTech Pro</p>\n              <p><strong>DCB 002/2024:</strong> Desfibrilador Autom√°tico - CardiacSafe</p>\n              <p><strong>DCB 003/2024:</strong> Autoclave Hospitalar - SterilMax</p>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.open('/api/downloads/dcbs-todas.pdf', '_blank')">\n                üì• Baixar Todas as DCBs\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"‚ùå Fechar"})},notificarFornecedores(a){this.$swal({title:"üìß Notificar Fornecedores",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Tipo:</strong> ${"homologada"===a.tipo?"Homologa√ß√£o":"Indeferimento"}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Tipo de Notifica√ß√£o:</label>\n              <select class="swal2-select">\n                <option value="email">E-mail</option>\n                <option value="postal">Correio</option>\n                <option value="ambos">E-mail + Correio</option>\n              </select>\n            </div>\n            <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <h6>Fornecedores a serem notificados:</h6>\n              <p>‚Ä¢ MedTech Pro - medtech@empresa.com</p>\n              <p>‚Ä¢ CardiacSafe - contato@cardiacsafe.com</p>\n              <p>‚Ä¢ SterilMax - vendas@sterilmax.com.br</p>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"üì§ Enviar Notifica√ß√µes",cancelButtonText:"‚ùå Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"‚úÖ Notifica√ß√µes Enviadas",text:"Todos os fornecedores foram notificados sobre a decis√£o.",icon:"success"})}))},getDCBStatusClass(a){switch(a){case"ATIVA":return"dcb-ativa";case"VENCENDO":return"dcb-vencendo";case"VENCIDA":return"dcb-vencida";case"CANCELADA":return"dcb-cancelada";default:return"dcb-indefinida"}},visualizarDCB(a){this.$swal({title:`üìú DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto}</h4>\n            <p><strong>Marca:</strong> ${a.marca}</p>\n            <p><strong>Status:</strong> ${a.status}</p>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>Informa√ß√µes da DCB:</h6>\n              <p><strong>Emitida em:</strong> ${this.formatDate(a.dataEmissao)}</p>\n              <p><strong>V√°lida at√©:</strong> ${this.formatDate(a.validade)}</p>\n              <p><strong>Autoridade:</strong> Dr. Jo√£o Silva - Secret√°rio</p>\n              <p><strong>CPM Respons√°vel:</strong> Comiss√£o de Padroniza√ß√£o de Materiais</p>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.open(\`/api/downloads/dcb-\${dcb.numero}.pdf\`, '_blank')">\n                üì• Baixar DCB Oficial\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"‚ùå Fechar"})},renovarDCB(a){this.$swal({title:`üîÑ Renovar DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto} - ${a.marca}</h4>\n            <p><strong>Validade atual:</strong> ${this.formatDate(a.validade)}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nova data de validade:</label>\n              <input id="novaValidade" class="swal2-input" type="date" value="">\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Justificativa:</label>\n              <textarea id="justificativaRenovacao" class="swal2-textarea" placeholder="Motivo da renova√ß√£o..." style="height: 80px;">Renova√ß√£o padr√£o - produto mant√©m conformidade t√©cnica e qualidade.</textarea>\n            </div>\n            <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Nota:</strong> A renova√ß√£o manter√° o mesmo n√∫mero da DCB com validade estendida.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"üîÑ Confirmar Renova√ß√£o",cancelButtonText:"‚ùå Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"‚úÖ DCB Renovada",text:"A DCB foi renovada com sucesso e permanece ativa no cat√°logo.",icon:"success"})}))},cancelarDCB(a){this.$swal({title:`‚ùå Cancelar DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto} - ${a.marca}</h4>\n            <p><strong>Status atual:</strong> ${a.status}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Motivo do cancelamento:</label>\n              <select id="motivoCancelamento" class="swal2-select">\n                <option value="">Selecione o motivo</option>\n                <option value="problemas_qualidade">Problemas de Qualidade</option>\n                <option value="descontinuacao">Descontinua√ß√£o do Produto</option>\n                <option value="mudanca_normativa">Mudan√ßa de Normativa</option>\n                <option value="solicitacao_fornecedor">Solicita√ß√£o do Fornecedor</option>\n                <option value="outros">Outros Motivos</option>\n              </select>\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Fundamenta√ß√£o:</label>\n              <textarea id="fundamentacaoCancelamento" class="swal2-textarea" placeholder="Justificativa detalhada..." style="height: 100px;"></textarea>\n            </div>\n            <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Aten√ß√£o:</strong> O cancelamento remove o produto do cat√°logo e impede futuras aquisi√ß√µes.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"‚ùå Confirmar Cancelamento",cancelButtonText:"üîô Cancelar",confirmButtonColor:"#dc3545"}).then((a=>{a.isConfirmed&&this.$swal({title:"üìù DCB Cancelada",text:"A DCB foi cancelada e o produto removido do cat√°logo oficial.",icon:"warning"})}))},verTodas(){this.$swal({title:"üìã Todas as Homologa√ß√µes",text:"Em uma implementa√ß√£o completa, abriria uma tela com filtros avan√ßados e pagina√ß√£o.",icon:"info"})},gerenciarDCBs(){this.$swal({title:"üìú Gerenciar DCBs",text:"Em uma implementa√ß√£o completa, abriria o m√≥dulo completo de gest√£o de DCBs.",icon:"info"})},gerarConteudoAtaInicial(a,t){const o=a.filter((a=>"julgado_aprovado"===a.status)),e=a.filter((a=>"julgado_reprovado"===a.status));return`\nATA DE JULGAMENTO DA COMISS√ÉO DE CONTRATA√á√ÉO OU LICITA√á√ÉO (CCL)\n\nN√∫mero: ${t.numero}\nPer√≠odo: ${t.periodo}\nData de Elabora√ß√£o: ${(new Date).toLocaleDateString("pt-BR")}\n\nRESUMO:\n- Total de processos julgados: ${a.length}\n- Produtos aprovados: ${o.length}\n- Produtos reprovados: ${e.length}\n\nPRODUTOS APROVADOS:\n${o.map(((a,t)=>`\n${t+1}. ${a.nome} - ${a.marca}\n   Adequa√ß√£o T√©cnica: ${a.adequacao_tecnica}\n   Base Legal: ${a.base_legal||"Lei 14.133/2021"}\n`)).join("")}\n\nPRODUTOS REPROVADOS:\n${e.map(((a,t)=>`\n${t+1}. ${a.nome} - ${a.marca}\n   Motivo: ${a.observacoes_ccl||"N√£o atendimento aos requisitos t√©cnicos"}\n`)).join("")}\n\n[CONTE√öDO A SER COMPLETADO NA ELABORA√á√ÉO FINAL]\n      `.trim()},async baixarDocumentacaoProduto(a){try{const{jsPDF:t}=await Promise.resolve().then(o.bind(o,1749)),{data:e,error:i}=await R.ND.from("produtos").select("*").eq("id",a).eq("tenant_id",this.currentTenantId).single();if(i)throw i;const{data:s,error:r}=await R.ND.from("documentos").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId).order("nome",{ascending:!0});if(r&&console.warn("Erro ao carregar documentos:",r),!e)return void this.$swal({title:"‚ö†Ô∏è Produto N√£o Encontrado",text:"N√£o foi poss√≠vel encontrar os dados do produto.",icon:"warning"});const n=new t,l=n.internal.pageSize.getWidth(),c=n.internal.pageSize.getHeight();let d=25;n.setFontSize(16),n.setFont(void 0,"bold"),n.text("COMISS√ÉO DE CONTRATA√á√ÉO OU LICITA√á√ÉO (CCL)",l/2,d,{align:"center"}),d+=8,n.setFontSize(12),n.setFont(void 0,"normal"),n.text("Sistema de Pr√©-Qualifica√ß√£o de Bens - Lei 14.133/2021",l/2,d,{align:"center"}),d+=15,n.setLineWidth(.5),n.line(30,d,l-30,d),d+=20,n.setFontSize(16),n.setFont(void 0,"bold"),n.text("DOCUMENTA√á√ÉO T√âCNICA COMPLETA",l/2,d,{align:"center"}),d+=8,n.setFontSize(12),n.text("Processo de Pr√©-Qualifica√ß√£o de Bem",l/2,d,{align:"center"}),d+=20,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("I. IDENTIFICA√á√ÉO DO BEM",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const u=[["Nome do Produto:",e.nome||"N√£o informado"],["Marca:",e.marca||"N√£o informado"],["Modelo:",e.modelo||"N√£o informado"],["Fabricante:",e.fabricante||"N√£o informado"],["C√≥digo do Material:",e.codigo_material||"N√£o informado"],["Categoria:",this.getCategoriaName(e.categoria_id)||"N√£o informado"],["CNPJ Fabricante:",e.cnpj_fabricante||e.cnpj||"N√£o informado"]];u.forEach((([a,t])=>{n.setFont(void 0,"bold"),n.text(a,35,d),n.setFont(void 0,"normal"),n.text(t,90,d),d+=8})),d+=10,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("II. HIST√ìRICO DO PROCESSO",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const m=[["Data de Cadastro:",this.formatDate(e.criado_em)],["Status Atual:",this.formatarStatusCPM(e.status)],["√öltima Atualiza√ß√£o:",this.formatDate(e.atualizado_em)]];if(e.julgado_em&&m.push(["Data do Julgamento CCL:",this.formatDate(e.julgado_em)]),e.adequacao_tecnica&&m.push(["Adequa√ß√£o T√©cnica:",e.adequacao_tecnica]),m.forEach((([a,t])=>{n.setFont(void 0,"bold"),n.text(a,35,d),n.setFont(void 0,"normal"),n.text(t,90,d),d+=8})),d+=15,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("III. PARECER T√âCNICO DA CPM",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),e.observacoes_cpm){const a=n.splitTextToSize(e.observacoes_cpm,l-70);n.text(a,35,d),d+=6*a.length+10}else n.setFont(void 0,"italic"),n.text("Parecer da CPM n√£o dispon√≠vel.",35,d),d+=15;if(d>c-80&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("IV. DECIS√ÉO DA COMISS√ÉO DE CONTRATA√á√ÉO OU LICITA√á√ÉO",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),e.observacoes_ccl){n.setFont(void 0,"bold"),n.text("Fundamenta√ß√£o da Decis√£o:",35,d),d+=8,n.setFont(void 0,"normal");const a=n.splitTextToSize(e.observacoes_ccl,l-70);n.text(a,35,d),d+=6*a.length+10}if(e.base_legal){n.setFont(void 0,"bold"),n.text("Base Legal:",35,d),d+=8,n.setFont(void 0,"normal");const a=n.splitTextToSize(e.base_legal,l-70);n.text(a,35,d),d+=6*a.length+10}if(e.observacoes_ccl||e.base_legal||(n.setFont(void 0,"italic"),n.text("Processo ainda n√£o foi julgado pela CCL.",35,d),d+=15),e.especificacoes_tecnicas){d>c-60&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("V. ESPECIFICA√á√ïES T√âCNICAS",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const a=n.splitTextToSize(e.especificacoes_tecnicas,l-70);n.text(a,35,d),d+=6*a.length+15}if(s&&s.length>0){d>c-80&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text(e.especificacoes_tecnicas?"VI. DOCUMENTOS ANEXOS":"V. DOCUMENTOS ANEXOS",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),n.text("Os seguintes documentos est√£o vinculados a este produto:",35,d),d+=10,s.forEach(((a,t)=>{d>c-40&&(n.addPage(),d=30),n.setFont(void 0,"bold"),n.text(`${t+1}. ${a.nome}`,35,d),d+=6,n.setFont(void 0,"normal"),n.text(`Tipo: ${a.tipo||"N√£o especificado"}`,40,d),d+=6,a.arquivo_url&&(n.setFontSize(9),n.setFont(void 0,"italic"),n.text(`URL: ${a.arquivo_url}`,40,d),d+=6,n.setFontSize(11)),d+=3})),d+=10,n.setFontSize(10),n.setFont(void 0,"italic");const a=n.splitTextToSize("Nota: Os documentos listados acima est√£o dispon√≠veis digitalmente no sistema e podem ser acessados atrav√©s das URLs fornecidas ou solicitados √† administra√ß√£o.",l-70);n.text(a,35,d),d+=5*a.length+15}const p=n.internal.getNumberOfPages();for(let a=1;a<=p;a++)n.setPage(a),n.setLineWidth(.3),n.line(30,c-25,l-30,c-25),n.setFontSize(8),n.setFont(void 0,"normal"),n.text("Sistema Comprar Bem - Pr√©-Qualifica√ß√£o de Bens",30,c-18),n.text(`P√°gina ${a} de ${p}`,l/2,c-18,{align:"center"}),n.text("Lei 14.133/2021",l-30,c-18,{align:"right"}),n.text(`Documento gerado em: ${(new Date).toLocaleDateString("pt-BR")} √†s ${(new Date).toLocaleTimeString("pt-BR")}`,30,c-12),n.text("Processo de Pr√©-Qualifica√ß√£o - CCL",l-30,c-12,{align:"right"});const v=`CCL_${e.nome.replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;n.save(v),this.$swal({title:"‚úÖ Documenta√ß√£o Gerada!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>üìã ${e.nome}</h4>\n              <p><strong>Arquivo:</strong> ${v}</p>\n              <p>Documenta√ß√£o t√©cnica completa gerada com sucesso!</p>\n              ${s&&s.length>0?`<p><strong>üìé ${s.length} documento(s) anexo(s)</strong> inclu√≠do(s) no PDF</p>`:"<p><em>Nenhum documento anexo vinculado ao produto</em></p>"}\n            </div>\n          `,icon:"success",confirmButtonText:"‚úÖ Perfeito!"})}catch(t){console.error("Erro ao gerar PDF:",t),this.$swal({title:"‚ùå Erro ao Gerar PDF",text:`Erro: ${t.message}`,icon:"error"})}},async baixarDocumentacaoRecursoEspecifico(a){try{const{jsPDF:t}=await Promise.resolve().then(o.bind(o,1749)),e=this.recursos?.find((t=>t.id===a));if(!e)return void this.$swal({title:"‚ö†Ô∏è Recurso N√£o Encontrado",text:"N√£o foi poss√≠vel encontrar os dados do recurso.",icon:"warning"});const i=new t,s=i.internal.pageSize.getWidth(),r=i.internal.pageSize.getHeight();let n=25;i.setFontSize(16),i.setFont(void 0,"bold"),i.text("COMISS√ÉO DE CONTRATA√á√ÉO OU LICITA√á√ÉO (CCL)",s/2,n,{align:"center"}),n+=8,i.setFontSize(12),i.setFont(void 0,"normal"),i.text("Recurso Administrativo - Lei 14.133/2021, Art. 165-171",s/2,n,{align:"center"}),n+=15,i.setLineWidth(.5),i.line(30,n,s-30,n),n+=20,i.setFontSize(16),i.setFont(void 0,"bold"),i.text("DOCUMENTA√á√ÉO DE RECURSO ADMINISTRATIVO",s/2,n,{align:"center"}),n+=20,i.setFontSize(14),i.setFont(void 0,"bold"),i.text("I. IDENTIFICA√á√ÉO DO RECURSO",30,n),n+=12,i.setFontSize(11),i.setFont(void 0,"normal");const l=[["Protocolo:",a],["Produto:",e.produto_nome||"N√£o informado"],["Recorrente:",e.recorrente||"N√£o informado"],["Data do Recurso:",this.formatDate(e.data_recurso)],["Prazo Final:",this.formatDate(e.prazo_final)],["Status Atual:",e.status||"Em An√°lise"],["Ata de Refer√™ncia:",e.ata_referencia||"N√£o informado"]];if(l.forEach((([a,t])=>{i.setFont(void 0,"bold"),i.text(a,35,n),i.setFont(void 0,"normal"),i.text(t,90,n),n+=8})),n+=15,i.setFontSize(14),i.setFont(void 0,"bold"),i.text("II. FUNDAMENTA√á√ÉO DO RECURSO",30,n),n+=12,i.setFontSize(11),i.setFont(void 0,"normal"),e.fundamentacao){const a=i.splitTextToSize(e.fundamentacao,s-70);i.text(a,35,n),n+=6*a.length+15}else i.setFont(void 0,"italic"),i.text("Fundamenta√ß√£o n√£o dispon√≠vel.",35,n),n+=15;if(i.setFontSize(14),i.setFont(void 0,"bold"),i.text("III. AN√ÅLISE E DECIS√ÉO DA CCL",30,n),n+=12,i.setFontSize(11),i.setFont(void 0,"normal"),e.decisao){if(i.setFont(void 0,"bold"),i.text("Decis√£o:",35,n),n+=8,i.setFont(void 0,"normal"),i.text(e.decisao.toUpperCase(),35,n),n+=10,e.fundamentacao_decisao){i.setFont(void 0,"bold"),i.text("Fundamenta√ß√£o da Decis√£o:",35,n),n+=8,i.setFont(void 0,"normal");const a=i.splitTextToSize(e.fundamentacao_decisao,s-70);i.text(a,35,n),n+=6*a.length+15}}else i.setFont(void 0,"italic"),i.text("Recurso ainda em an√°lise pela CCL.",35,n),n+=15;i.setFontSize(14),i.setFont(void 0,"bold"),i.text("IV. BASE LEGAL",30,n),n+=12,i.setFontSize(11),i.setFont(void 0,"normal");const c=["‚Ä¢ Lei n¬∫ 14.133/2021 - Nova Lei de Licita√ß√µes e Contratos","‚Ä¢ Art. 165 - Direito de recurso dos interessados","‚Ä¢ Art. 166 - Prazo para interposi√ß√£o de recurso","‚Ä¢ Art. 167 - Processamento dos recursos","‚Ä¢ Art. 168 - Efeito suspensivo dos recursos","‚Ä¢ Art. 169 - Decis√£o dos recursos","‚Ä¢ Art. 170 - Recursos contra atos da CCL","‚Ä¢ Art. 171 - Irrecorribilidade das decis√µes"];c.forEach((a=>{i.text(a,35,n),n+=6}));const d=i.internal.getNumberOfPages();for(let o=1;o<=d;o++)i.setPage(o),i.setLineWidth(.3),i.line(30,r-25,s-30,r-25),i.setFontSize(8),i.setFont(void 0,"normal"),i.text("Sistema Comprar Bem - Recursos Administrativos",30,r-18),i.text(`P√°gina ${o} de ${d}`,s/2,r-18,{align:"center"}),i.text("Lei 14.133/2021 - Art. 165-171",s-30,r-18,{align:"right"}),i.text(`Documento gerado em: ${(new Date).toLocaleDateString("pt-BR")} √†s ${(new Date).toLocaleTimeString("pt-BR")}`,30,r-12),i.text(`Protocolo: ${a}`,s-30,r-12,{align:"right"});const u=`CCL_Recurso_${e.produto_nome?.replace(/[^a-zA-Z0-9]/g,"_")||"Recurso"}_${(new Date).toISOString().split("T")[0]}.pdf`;i.save(u),this.$swal({title:"‚úÖ Documenta√ß√£o do Recurso Gerada!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>‚öñÔ∏è ${e.produto_nome||"Recurso Administrativo"}</h4>\n              <p><strong>Recorrente:</strong> ${e.recorrente}</p>\n              <p><strong>Arquivo:</strong> ${u}</p>\n              <p>Documenta√ß√£o completa do recurso gerada com sucesso!</p>\n            </div>\n          `,icon:"success",confirmButtonText:"‚úÖ Perfeito!"})}catch(t){console.error("Erro ao gerar PDF do recurso:",t),this.$swal({title:"‚ùå Erro ao Gerar PDF",text:`Erro: ${t.message}`,icon:"error"})}}},mounted(){window.baixarDocumentacaoProduto=a=>this.baixarDocumentacaoProduto(a),window.baixarDocumentacaoRecursoEspecifico=a=>this.baixarDocumentacaoRecursoEspecifico(a)}},to=ao;var oo=(0,C.A)(to,Xt,Zt,!1,null,"37d5f998",null);const eo=oo.exports,io={name:"CCL",components:{DashboardCCL:eo},data(){return{dropdownOpen:!1,modalEmailAberto:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",configEmail:{nomeOrganizacao:"",emailRemetente:"",nomeRemetente:"",assinatura:""},showDropdown:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},mounted(){},beforeUnmount(){},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await R.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usu√°rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},closeDropdown(){this.showDropdown=!1}}},so=io;var ro=(0,C.A)(so,Kt,Wt,!1,null,"b663c0c6",null);const no=ro.exports;var lo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classificacao-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("‚ñº")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("üë§")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.nomeUsuario))]),t("small",[a._v(a._s(a.emailUsuario))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("‚öôÔ∏è")]),t("span",[a._v("Configura√ß√µes")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("üìß")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("üö™")]),t("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("Classificacao")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(2),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organiza√ß√£o")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comiss√£o de Padroniza√ß√£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comiss√£o de Padroniza√ß√£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},co=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("üë§")])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organiza√ß√£o")])}],uo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classificacao-container"},[t("h2",[a._v("Classifica√ß√£o de Materiais")]),t("div",{staticClass:"tabs"},[t("button",{class:["tab-button",{active:"grupos"===a.activeTab}],on:{click:function(t){a.activeTab="grupos"}}},[a._v(" Grupos ")]),t("button",{class:["tab-button",{active:"classes"===a.activeTab}],on:{click:function(t){a.activeTab="classes"}}},[a._v(" Classes ")])]),t("div",{staticClass:"tab-content"},["grupos"===a.activeTab?t("GruposList"):a._e(),"classes"===a.activeTab?t("ClassesList"):a._e()],1)])},mo=[],po=function(){var a=this,t=a._self._c;return t("div",{staticClass:"grupos-list"},[t("div",{staticClass:"header"},[t("h3",[a._v("Gerenciamento de Grupos")]),t("button",{staticClass:"btn-add",on:{click:function(t){a.mostrarFormulario=!0}}},[a._v(" Adicionar Grupo ")])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando grupos...")])]):0===a.grupos.length?t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhum grupo cadastrado.")])]):t("div",{staticClass:"grupos-table"},[t("table",[a._m(0),t("tbody",a._l(a.grupos,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.codigo||o.id.slice(0,8)))]),t("td",[a._v(a._s(o.nome))]),t("td",[a._v(a._s(o.descricao||"-"))]),t("td",[a._v(a._s(a.formatarData(o.created_at)))]),t("td",{staticClass:"actions"},[t("button",{staticClass:"btn-edit",on:{click:function(t){return a.editarGrupo(o)}}},[a._v("Editar")]),t("button",{staticClass:"btn-delete",on:{click:function(t){return a.confirmarExclusao(o)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Grupo")]),t("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarGrupo.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"codigo"}},[a._v("C√≥digo do Grupo")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.codigo,expression:"grupoAtual.codigo"}],attrs:{id:"codigo",type:"text",placeholder:"Ex: GRP001"},domProps:{value:a.grupoAtual.codigo},on:{input:function(t){t.target.composing||a.$set(a.grupoAtual,"codigo",t.target.value)}}}),t("small",[a._v("Se n√£o informado, ser√° gerado automaticamente")])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome do Grupo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.nome,expression:"grupoAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.grupoAtual.nome},on:{input:function(t){t.target.composing||a.$set(a.grupoAtual,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.descricao,expression:"grupoAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.grupoAtual.descricao},on:{input:function(t){t.target.composing||a.$set(a.grupoAtual,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},vo=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("C√≥digo do Grupo")]),t("th",[a._v("Nome")]),t("th",[a._v("Descri√ß√£o")]),t("th",[a._v("Data de Cria√ß√£o")]),t("th",[a._v("A√ß√µes")])])])}];const go={name:"GruposList",setup(){const a=(0,e.KR)([]),t=(0,e.KR)(!0),o=(0,e.KR)(!1),i=(0,e.KR)(!1),s=(0,e.KR)(!1),r=(0,e.Kh)({id:null,codigo:"",nome:"",descricao:""});(0,e.sV)((async()=>{await n()}));const n=async()=>{try{t.value=!0;const{data:o,error:e}=await R.ND.from("grupos").select("*").order("nome");if(e)throw e;a.value=o||[]}catch(o){console.error("Erro ao carregar grupos:",o),alert("Erro ao carregar grupos. Por favor, tente novamente.")}finally{t.value=!1}},l=a=>{if(!a)return"-";const t=new Date(a);return t.toLocaleDateString("pt-BR")},c=a=>{s.value=!0,r.id=a.id,r.codigo=a.codigo||"",r.nome=a.nome,r.descricao=a.descricao||"",i.value=!0},d=()=>{i.value=!1,s.value=!1,r.id=null,r.codigo="",r.nome="",r.descricao=""},u=async()=>{try{if(o.value=!0,s.value){console.log("Atualizando grupo:",{id:r.id,codigo:r.codigo,nome:r.nome,descricao:r.descricao});const{data:a,error:t}=await R.ND.from("grupos").select("*").eq("id",r.id).single();if(t)throw console.error("Erro ao buscar grupo:",t),new Error(`Grupo n√£o encontrado: ${t.message}`);console.log("Grupo encontrado:",a);const o={nome:r.nome.trim()};r.codigo&&r.codigo.trim()&&(o.codigo=r.codigo.trim()),r.descricao&&r.descricao.trim()&&(o.descricao=r.descricao.trim()),console.log("Dados para atualiza√ß√£o:",o);const{data:e,error:i}=await R.ND.from("grupos").update(o).eq("id",r.id).select();if(i)throw console.error("Erro na atualiza√ß√£o:",i),new Error(`Erro ao atualizar: ${i.message}`);console.log("Grupo atualizado com sucesso:",e),alert("Grupo atualizado com sucesso!")}else{let a=r.codigo;if(!a){const{data:t}=await R.ND.from("grupos").select("codigo").order("created_at",{ascending:!1}).limit(1),o=t&&t[0]&&t[0].codigo&&parseInt(t[0].codigo.replace(/\D/g,""))||0;a=`GRP${String(o+1).padStart(3,"0")}`}const{error:t}=await R.ND.from("grupos").insert({codigo:a,nome:r.nome,descricao:r.descricao});if(t)throw t;alert("Grupo adicionado com sucesso!")}await n(),d()}catch(a){console.error("Erro ao salvar grupo:",a),alert(`Erro ao ${s.value?"atualizar":"adicionar"} grupo: ${a.message}`)}finally{o.value=!1}},m=a=>{confirm(`Deseja realmente excluir o grupo "${a.nome}"?`)&&p(a.id)},p=async a=>{try{t.value=!0;const{data:o,error:e}=await R.ND.from("classes").select("id").eq("grupo_id",a);if(e)throw e;if(o&&o.length>0)return void alert(`N√£o √© poss√≠vel excluir este grupo porque existem ${o.length} classes associadas a ele.`);const{data:i,error:s}=await R.ND.from("produtos").select("id").eq("grupo_id",a);if(s)throw s;if(i&&i.length>0)return void alert(`N√£o √© poss√≠vel excluir este grupo porque existem ${i.length} produtos associados a ele.`);const{error:r}=await R.ND.from("grupos").delete().eq("id",a);if(r)throw r;alert("Grupo exclu√≠do com sucesso!"),await n()}catch(o){console.error("Erro ao excluir grupo:",o),alert(`Erro ao excluir grupo: ${o.message}`)}finally{t.value=!1}};return{grupos:a,loading:t,salvando:o,mostrarFormulario:i,modoEdicao:s,grupoAtual:r,carregarGrupos:n,formatarData:l,editarGrupo:c,fecharFormulario:d,salvarGrupo:u,confirmarExclusao:m}}},_o=go;var fo=(0,C.A)(_o,po,vo,!1,null,"761478a4",null);const ho=fo.exports;var Co=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classes-list"},[t("div",{staticClass:"header"},[t("h3",[a._v("Gerenciamento de Classes")]),t("button",{staticClass:"btn-add",on:{click:function(t){a.mostrarFormulario=!0}}},[a._v(" Adicionar Classe ")])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando classes...")])]):0===a.classes.length?t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhuma classe cadastrada.")])]):t("div",{staticClass:"classes-table"},[t("table",[a._m(0),t("tbody",a._l(a.classes,(function(o){return t("tr",{key:o.id},[t("td",[a._v(a._s(o.codigo||o.id.slice(0,8)))]),t("td",[a._v(a._s(o.nome))]),t("td",[a._v(a._s(a.getNomeGrupo(o.grupo_id)))]),t("td",[a._v(a._s(o.descricao||"-"))]),t("td",[a._v(a._s(a.formatarData(o.created_at)))]),t("td",{staticClass:"actions"},[t("button",{staticClass:"btn-edit",on:{click:function(t){return a.editarClasse(o)}}},[a._v("Editar")]),t("button",{staticClass:"btn-delete",on:{click:function(t){return a.confirmarExclusao(o)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Classe")]),t("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarClasse.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.grupo_id,expression:"classeAtual.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.classeAtual,"grupo_id",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(o){return t("option",{key:o.id,domProps:{value:o.id}},[a._v(" "+a._s(o.nome)+" ")])}))],2),0===a.grupos.length?t("div",{staticClass:"error-text"},[t("p",[a._v("√â necess√°rio cadastrar pelo menos um grupo antes de adicionar classes.")])]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"codigo"}},[a._v("C√≥digo da Classe")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.codigo,expression:"classeAtual.codigo"}],attrs:{id:"codigo",type:"text",placeholder:"Ex: CLS001"},domProps:{value:a.classeAtual.codigo},on:{input:function(t){t.target.composing||a.$set(a.classeAtual,"codigo",t.target.value)}}}),t("small",[a._v("Se n√£o informado, ser√° gerado automaticamente")])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome da Classe*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.nome,expression:"classeAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.classeAtual.nome},on:{input:function(t){t.target.composing||a.$set(a.classeAtual,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.descricao,expression:"classeAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.classeAtual.descricao},on:{input:function(t){t.target.composing||a.$set(a.classeAtual,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando||0===a.grupos.length}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},bo=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("C√≥digo da Classe")]),t("th",[a._v("Nome")]),t("th",[a._v("Grupo")]),t("th",[a._v("Descri√ß√£o")]),t("th",[a._v("Data de Cria√ß√£o")]),t("th",[a._v("A√ß√µes")])])])}];const wo={name:"ClassesList",setup(){const a=(0,e.KR)([]),t=(0,e.KR)([]),o=(0,e.KR)(!0),i=(0,e.KR)(!1),s=(0,e.KR)(!1),r=(0,e.KR)(!1),n=(0,e.Kh)({id:null,grupo_id:"",codigo:"",nome:"",descricao:""});(0,e.sV)((async()=>{await Promise.all([l(),c()])}));const l=async()=>{try{const{data:a,error:o}=await R.ND.from("grupos").select("*").order("nome");if(o)throw o;t.value=a||[]}catch(a){console.error("Erro ao carregar grupos:",a),alert("Erro ao carregar grupos. Por favor, tente novamente.")}},c=async()=>{try{o.value=!0;const{data:t,error:e}=await R.ND.from("classes").select("*").order("nome");if(e)throw e;a.value=t||[]}catch(t){console.error("Erro ao carregar classes:",t),alert("Erro ao carregar classes. Por favor, tente novamente.")}finally{o.value=!1}},d=a=>{const o=t.value.find((t=>t.id===a));return o?o.nome:"Grupo n√£o encontrado"},u=a=>{if(!a)return"-";const t=new Date(a);return t.toLocaleDateString("pt-BR")},m=a=>{r.value=!0,n.id=a.id,n.grupo_id=a.grupo_id,n.codigo=a.codigo||"",n.nome=a.nome,n.descricao=a.descricao||"",s.value=!0},p=()=>{s.value=!1,r.value=!1,n.id=null,n.grupo_id="",n.codigo="",n.nome="",n.descricao=""},v=async()=>{try{if(i.value=!0,r.value){const{error:a}=await R.ND.from("classes").update({grupo_id:n.grupo_id,codigo:n.codigo,nome:n.nome,descricao:n.descricao}).eq("id",n.id);if(a)throw a;alert("Classe atualizada com sucesso!")}else{let a=n.codigo;if(!a){const{data:t}=await R.ND.from("classes").select("codigo").order("created_at",{ascending:!1}).limit(1),o=t&&t[0]&&t[0].codigo&&parseInt(t[0].codigo.replace(/\D/g,""))||0;a=`CLS${String(o+1).padStart(3,"0")}`}const{error:t}=await R.ND.from("classes").insert({grupo_id:n.grupo_id,codigo:a,nome:n.nome,descricao:n.descricao});if(t)throw t;alert("Classe adicionada com sucesso!")}await c(),p()}catch(a){console.error("Erro ao salvar classe:",a),alert(`Erro ao ${r.value?"atualizar":"adicionar"} classe: ${a.message}`)}finally{i.value=!1}},g=a=>{confirm(`Deseja realmente excluir a classe "${a.nome}"?`)&&_(a.id)},_=async a=>{try{o.value=!0;const{data:t,error:e}=await R.ND.from("produtos").select("id").eq("classe_id",a);if(e)throw e;if(t&&t.length>0)return void alert(`N√£o √© poss√≠vel excluir esta classe porque existem ${t.length} produtos associados a ela.`);const{error:i}=await R.ND.from("classes").delete().eq("id",a);if(i)throw i;alert("Classe exclu√≠da com sucesso!"),await c()}catch(t){console.error("Erro ao excluir classe:",t),alert(`Erro ao excluir classe: ${t.message}`)}finally{o.value=!1}};return{classes:a,grupos:t,loading:o,salvando:i,mostrarFormulario:s,modoEdicao:r,classeAtual:n,carregarClasses:c,carregarGrupos:l,getNomeGrupo:d,formatarData:u,editarClasse:m,fecharFormulario:p,salvarClasse:v,confirmarExclusao:g}}},Do=wo;var Eo=(0,C.A)(Do,Co,bo,!1,null,"32eb1edc",null);const xo=Eo.exports,yo={name:"Classificacao",components:{GruposList:ho,ClassesList:xo},setup(){const a=(0,e.KR)("grupos");return{activeTab:a}}},Ao=yo;var Po=(0,C.A)(Ao,uo,mo,!1,null,"ae10c55c",null);const So=Po.exports,$o={name:"ClassificacaoView",components:{Classificacao:So},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comiss√£o de Padroniza√ß√£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"üìß Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das dilig√™ncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comiss√£o de Padroniza√ß√£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"üíæ Salvar",cancelButtonText:"‚ùå Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"‚úÖ Sucesso!",text:"Configura√ß√µes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configura√ß√µes:",a)}},closeDropdown(){this.dropdownOpen=!1}}},No=$o;var Ro=(0,C.A)(No,lo,co,!1,null,"18ae67b5",null);const Io=Ro.exports;var Mo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"login-rdm-container"},[a._m(0),t("main",{staticClass:"login-main"},[t("div",{staticClass:"container"},[t("div",{staticClass:"login-card"},[a._m(1),t("form",{staticClass:"login-form",on:{submit:function(t){return t.preventDefault(),a.fazerLogin.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("üìß Email:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.email,expression:"loginData.email"}],attrs:{type:"email",id:"email",placeholder:"Digite seu email",required:"",disabled:a.carregando},domProps:{value:a.loginData.email},on:{input:function(t){t.target.composing||a.$set(a.loginData,"email",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"senha"}},[a._v("üîí Senha:")]),t("div",{staticClass:"password-input"},["checkbox"===(a.mostrarSenha?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:"checkbox"},domProps:{checked:Array.isArray(a.loginData.senha)?a._i(a.loginData.senha,null)>-1:a.loginData.senha},on:{change:function(t){var o=a.loginData.senha,e=t.target,i=!!e.checked;if(Array.isArray(o)){var s=null,r=a._i(o,s);e.checked?r<0&&a.$set(a.loginData,"senha",o.concat([s])):r>-1&&a.$set(a.loginData,"senha",o.slice(0,r).concat(o.slice(r+1)))}else a.$set(a.loginData,"senha",i)}}}):"radio"===(a.mostrarSenha?"text":"password")?t("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:"radio"},domProps:{checked:a._q(a.loginData.senha,null)},on:{change:function(t){return a.$set(a.loginData,"senha",null)}}}):t("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:a.mostrarSenha?"text":"password"},domProps:{value:a.loginData.senha},on:{input:function(t){t.target.composing||a.$set(a.loginData,"senha",t.target.value)}}}),t("button",{staticClass:"toggle-password",attrs:{type:"button",disabled:a.carregando},on:{click:function(t){a.mostrarSenha=!a.mostrarSenha}}},[a._v(" "+a._s(a.mostrarSenha?"üôà":"üëÅÔ∏è")+" ")])]),a.primeiroAcesso?t("small",{staticClass:"password-hint"},[a._v(" üí° Use a senha tempor√°ria enviada por email ")]):a._e()]),a.mensagem?t("div",{staticClass:"alert",class:a.tipoMensagem},[a._v(" "+a._s(a.mensagem)+" ")]):a._e(),t("button",{staticClass:"btn-login",attrs:{type:"submit",disabled:a.carregando||!a.loginData.email||!a.loginData.senha}},[a.carregando?t("span",[a._v("‚è≥ Entrando...")]):t("span",[a._v("üöÄ Entrar no Sistema")])])]),t("div",{staticClass:"login-footer"},[t("div",{staticClass:"links"},[t("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),a.mostrarModalAjuda=!0}}},[a._v("‚ùì Esqueci minha senha")]),t("a",{attrs:{href:"#"},on:{click:function(t){t.preventDefault(),a.mostrarModalContato=!0}}},[a._v("üìû Suporte")])]),a._m(2)])]),a._m(3)])]),a.mostrarModalAjuda?t("div",{staticClass:"modal-overlay",on:{click:function(t){a.mostrarModalAjuda=!1}}},[t("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("‚ùì Esqueci minha senha")]),t("button",{staticClass:"btn-close",on:{click:function(t){a.mostrarModalAjuda=!1}}},[a._v("‚úï")])]),a._m(4)])]):a._e(),a.mostrarModalContato?t("div",{staticClass:"modal-overlay",on:{click:function(t){a.mostrarModalContato=!1}}},[t("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("üìû Suporte T√©cnico")]),t("button",{staticClass:"btn-close",on:{click:function(t){a.mostrarModalContato=!1}}},[a._v("‚úï")])]),a._m(5)])]):a._e()])},Fo=[function(){var a=this,t=a._self._c;return t("header",{staticClass:"login-header"},[t("div",{staticClass:"container"},[t("div",{staticClass:"logo-section"},[t("h1",[a._v("üè• Sistema Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Dashboard RDM Online")])])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"card-header"},[t("h2",[a._v("üîê Acesso RDM")]),t("p",[a._v("Fa√ßa login para emitir suas Requisi√ß√µes de Materiais")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info"},[t("small",[a._v("üîí Acesso seguro e criptografado")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info-cards"},[t("div",{staticClass:"info-card"},[t("h3",[a._v("üìù O que voc√™ pode fazer")]),t("ul",[t("li",[a._v("‚úÖ Emitir RDMs online")]),t("li",[a._v("üìä Acompanhar status das solicita√ß√µes")]),t("li",[a._v("üìã Consultar hist√≥rico")]),t("li",[a._v("üîî Receber notifica√ß√µes autom√°ticas")])])]),t("div",{staticClass:"info-card"},[t("h3",[a._v("‚ö° Primeiro Acesso?")]),t("ol",[t("li",[a._v("Use o email e senha enviados por email")]),t("li",[a._v("Altere sua senha no primeiro login")]),t("li",[a._v("Configure suas prefer√™ncias")]),t("li",[a._v("Comece a usar o sistema!")])])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"modal-body"},[t("p",[a._v("Entre em contato com o CPM para redefinir sua senha:")]),t("div",{staticClass:"contact-info"},[t("p",[a._v("üìß "),t("strong",[a._v("Email:")]),a._v(" comprarbemteste@gmail.com")]),t("p",[a._v("üìû "),t("strong",[a._v("Telefone:")]),a._v(" (61) 3315-2425")])]),t("p",[t("small",[a._v("üí° Informe seu nome completo e unidade/setor")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"modal-body"},[t("div",{staticClass:"contact-info"},[t("h4",[a._v("üí¨ Canais de Atendimento:")]),t("p",[a._v("üìß "),t("strong",[a._v("Email:")]),a._v(" comprarbemteste@gmail.com")]),t("p",[a._v("üìû "),t("strong",[a._v("Telefone:")]),a._v(" (61) 3315-2425")]),t("p",[a._v("üïê "),t("strong",[a._v("Hor√°rio:")]),a._v(" Segunda a Sexta, 8h √†s 17h")])]),t("div",{staticClass:"faq"},[t("h4",[a._v("‚ùì Problemas Comuns:")]),t("ul",[t("li",[t("strong",[a._v("N√£o recebi o email:")]),a._v(" Verifique spam/lixeira")]),t("li",[t("strong",[a._v("Senha n√£o funciona:")]),a._v(" Certifique-se de usar a senha tempor√°ria")]),t("li",[t("strong",[a._v("Conta bloqueada:")]),a._v(" Contate o CPM")])])])])}];const To={name:"LoginRDM",data(){return{loginData:{email:"",senha:""},carregando:!1,mostrarSenha:!1,mensagem:"",tipoMensagem:"",primeiroAcesso:!1,mostrarModalAjuda:!1,mostrarModalContato:!1}},async mounted(){await this.verificarSessaoExistente()},methods:{async verificarSessaoExistente(){try{const{data:a}=await R.ND.auth.getSession();if(a?.session?.user){const{data:t,error:o}=await R.ND.from("usuarios_rdm").select("*").eq("email",a.session.user.email).single();!o&&t&&(console.log("Usu√°rio RDM j√° logado, redirecionando..."),this.$router.push("/dashboard-rdm"))}}catch(a){console.log("Nenhuma sess√£o ativa encontrada")}},async fazerLogin(){if(!this.carregando){this.carregando=!0,this.mensagem="";try{console.log("üîê Tentativa de login RDM:",this.loginData.email);const{data:a,error:t}=await R.ND.from("usuarios_rdm").select("*").eq("email",this.loginData.email).eq("ativo",!0).single();if(t||!a)throw new Error("Email n√£o encontrado ou usu√°rio inativo. Verifique seus dados ou contate o CPM.");if(console.log("‚úÖ Usu√°rio RDM encontrado:",a.nome_usuario),a.senha_temporaria!==this.loginData.senha)throw new Error("Senha incorreta. Verifique sua senha cadastrada.");console.log("‚úÖ Login realizado com sucesso - senha validada"),localStorage.setItem("usuarioRDM",JSON.stringify({id:a.id,user_id:a.user_id,nome_usuario:a.nome_usuario,email:a.email,unidade_setor:a.unidade_setor,nome_coordenador:a.nome_coordenador,materiais:a.materiais,tenant_id:a.tenant_id})),await R.ND.from("usuarios_rdm").update({atualizado_em:(new Date).toISOString(),convite_aceito:!0}).eq("id",a.id),this.mensagem=`üéâ Bem-vindo(a), ${a.nome_usuario}!`,this.tipoMensagem="success",console.log("‚úÖ Login RDM realizado com sucesso!"),setTimeout((()=>{this.$router.push("/dashboard-rdm")}),1500)}catch(a){console.error("‚ùå Erro no login RDM:",a),this.mensagem=a.message,this.tipoMensagem="error"}finally{this.carregando=!1}}}}},zo=To;var ko=(0,C.A)(zo,Mo,Fo,!1,null,"3d6c719e",null);const Oo=ko.exports;var Bo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard-rdm"},[t("header",{staticClass:"dashboard-header"},[t("div",{staticClass:"container"},[t("div",{staticClass:"header-content"},[a._m(0),t("div",{staticClass:"user-section"},[t("div",{staticClass:"user-info"},[t("span",{staticClass:"user-name"},[a._v("üë§ "+a._s(a.usuarioAtual.nome_usuario))]),t("span",{staticClass:"user-sector"},[a._v("üè¢ "+a._s(a.usuarioAtual.unidade_setor))])]),t("button",{staticClass:"btn-logout",on:{click:a.logout}},[a._v("üö™ Sair")])])])])]),t("nav",{staticClass:"nav-tabs"},[t("div",{staticClass:"container"},[t("div",{staticClass:"tabs"},[t("button",{staticClass:"tab-btn",class:{active:"avaliacao"===a.activeTab},on:{click:function(t){a.activeTab="avaliacao"}}},[a._v(" ‚≠ê Avalia√ß√£o de Materiais ")]),t("button",{staticClass:"tab-btn",class:{active:"historico"===a.activeTab},on:{click:function(t){a.activeTab="historico"}}},[a._v(" üìã Hist√≥rico ")]),t("button",{staticClass:"tab-btn",class:{active:"materiais"===a.activeTab},on:{click:function(t){a.activeTab="materiais"}}},[a._v(" üì¶ Meus Materiais ")]),t("button",{staticClass:"tab-btn",class:{active:"perfil"===a.activeTab},on:{click:function(t){a.activeTab="perfil"}}},[a._v(" ‚öôÔ∏è Perfil ")])])])]),t("main",{staticClass:"main-content"},[t("div",{staticClass:"container"},["avaliacao"===a.activeTab?t("div",{staticClass:"tab-content"},[a._m(1),t("div",{staticClass:"reclamacao-form-card"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.enviarReclamacao.apply(null,arguments)}}},[t("div",{staticClass:"form-section"},[t("h3",[a._v("üë§ Dados do Reclamante")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Nome do Reclamante:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.nome_reclamante,expression:"novaReclamacao.nome_reclamante"}],attrs:{type:"text",required:""},domProps:{value:a.novaReclamacao.nome_reclamante},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"nome_reclamante",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Telefone:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.telefone,expression:"novaReclamacao.telefone"}],attrs:{type:"tel",placeholder:"(00) 00000-0000",required:""},domProps:{value:a.novaReclamacao.telefone},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"telefone",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Email:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.email,expression:"novaReclamacao.email"}],attrs:{type:"email",required:""},domProps:{value:a.novaReclamacao.email},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"email",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Unidade/Setor:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.unidade_setor,expression:"novaReclamacao.unidade_setor"}],attrs:{type:"text",required:""},domProps:{value:a.novaReclamacao.unidade_setor},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"unidade_setor",t.target.value)}}})])])]),t("div",{staticClass:"form-section"},[t("h3",[a._v("üì¶ Dados do Material")]),t("div",{staticClass:"form-group"},[t("label",[a._v("Selecionar Material:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.materialSelecionadoReclamacao,expression:"materialSelecionadoReclamacao"}],attrs:{required:""},on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.materialSelecionadoReclamacao=t.target.multiple?o:o[0]},a.preencherDadosMaterial]}},[t("option",{attrs:{value:""}},[a._v("Selecione um material sob sua responsabilidade")]),a._l(a.usuarioAtual.materiais,(function(o){return t("option",{key:o.produto_id,domProps:{value:o}},[a._v(" "+a._s(o.nome)+" - "+a._s(o.codigo)+" ")])}))],2),0===a.usuarioAtual.materiais?.length?t("small",{staticClass:"error-text"},[a._v(" ‚ö†Ô∏è Voc√™ n√£o possui materiais cadastrados. Entre em contato com a CPM. ")]):a._e()]),a.materialSelecionadoReclamacao?t("div",{staticClass:"material-info-reclamacao"},[t("h4",[a._v("üìã Dados do Material Selecionado:")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",[a._v("Nome do Material:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.nome_material,expression:"novaReclamacao.nome_material"}],staticClass:"readonly-input",attrs:{type:"text",readonly:""},domProps:{value:a.novaReclamacao.nome_material},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"nome_material",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("C√≥digo do Material:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.codigo_material,expression:"novaReclamacao.codigo_material"}],staticClass:"readonly-input",attrs:{type:"text",readonly:""},domProps:{value:a.novaReclamacao.codigo_material},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"codigo_material",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Marca e Modelo:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.marca_modelo,expression:"novaReclamacao.marca_modelo"}],attrs:{type:"text",placeholder:"Informe a marca e modelo espec√≠ficos (se necess√°rio)"},domProps:{value:a.novaReclamacao.marca_modelo},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"marca_modelo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("‚≠ê Avalia√ß√£o da Qualidade (obrigat√≥rio):")]),t("div",{staticClass:"star-rating"},a._l(5,(function(o){return t("span",{key:o,staticClass:"star",class:{active:(a.novaReclamacao.rating||0)>=o},attrs:{title:`${o} estrela${o>1?"s":""}`},on:{click:function(t){a.novaReclamacao.rating=o}}},[a._v(" ‚≠ê ")])})),0),a.novaReclamacao.rating?t("small",{staticClass:"rating-info"},[a._v(" Avalia√ß√£o: "+a._s(a.novaReclamacao.rating)+"/5 estrelas ")]):t("small",{staticClass:"error-text"},[a._v(" ‚ö†Ô∏è Por favor, d√™ uma avalia√ß√£o de 1 a 5 estrelas ")])])]):a._e()]),t("div",{staticClass:"form-section"},[t("h3",[a._v("üí¨ Coment√°rios e Observa√ß√µes")]),t("div",{staticClass:"form-group"},[t("label",[a._v("Observa√ß√µes sobre o Material:")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.comentario,expression:"novaReclamacao.comentario"}],attrs:{rows:"3",placeholder:"Como est√° sendo a experi√™ncia com este material? Qualidade, durabilidade, efic√°cia..."},domProps:{value:a.novaReclamacao.comentario},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"comentario",t.target.value)}}})])]),t("div",{staticClass:"form-section"},[t("h3",[a._v("üö® Problemas e Reclama√ß√µes (opcional)")]),t("div",{staticClass:"form-group"},[t("label",[a._v("Descri√ß√£o de Problemas:")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.registro_reclamacao,expression:"novaReclamacao.registro_reclamacao"}],attrs:{rows:"4",placeholder:"Se houver problemas, defeitos ou situa√ß√µes negativas, descreva detalhadamente aqui... (opcional)"},domProps:{value:a.novaReclamacao.registro_reclamacao},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"registro_reclamacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Sugest√µes de Melhoria:")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.sugestoes,expression:"novaReclamacao.sugestoes"}],attrs:{rows:"3",placeholder:"Sugest√µes para melhorias ou solu√ß√µes... (opcional)"},domProps:{value:a.novaReclamacao.sugestoes},on:{input:function(t){t.target.composing||a.$set(a.novaReclamacao,"sugestoes",t.target.value)}}})])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.limparAvaliacao}},[a._v(" üóëÔ∏è Limpar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.enviandoReclamacao||!a.novaReclamacao.rating}},[a.enviandoReclamacao?t("span",[a._v("‚è≥ Enviando...")]):t("span",[a._v("‚≠ê Enviar Avalia√ß√£o")])])])])])]):a._e(),"historico"===a.activeTab?t("div",{staticClass:"tab-content"},[a._m(2),t("div",{staticClass:"historico-container"},[t("div",{staticClass:"filters-card"},[t("div",{staticClass:"filters-row"},[t("div",{staticClass:"filter-group"},[t("label",[a._v("üîç Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],attrs:{type:"text",placeholder:"Material, c√≥digo..."},domProps:{value:a.filtros.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"busca",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filter-group"},[t("label",[a._v("‚≠ê Avalia√ß√£o:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.rating,expression:"filtros.rating"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"rating",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"5"}},[a._v("‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5 estrelas)")]),t("option",{attrs:{value:"4"}},[a._v("‚≠ê‚≠ê‚≠ê‚≠ê (4 estrelas)")]),t("option",{attrs:{value:"3"}},[a._v("‚≠ê‚≠ê‚≠ê (3 estrelas)")]),t("option",{attrs:{value:"2"}},[a._v("‚≠ê‚≠ê (2 estrelas)")]),t("option",{attrs:{value:"1"}},[a._v("‚≠ê (1 estrela)")])])]),t("div",{staticClass:"filter-group"},[t("label",[a._v("üìÖ Per√≠odo:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.periodo,expression:"filtros.periodo"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"periodo",t.target.multiple?o:o[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"hoje"}},[a._v("Hoje")]),t("option",{attrs:{value:"semana"}},[a._v("Esta Semana")]),t("option",{attrs:{value:"mes"}},[a._v("Este M√™s")]),t("option",{attrs:{value:"trimestre"}},[a._v("√öltimo Trimestre")])])])])]),t("div",{staticClass:"feedbacks-list"},[a.carregandoHistorico?t("div",{staticClass:"loading-card"},[a._v(" ‚è≥ Carregando hist√≥rico... ")]):0===a.historicoFeedbacks.length?t("div",{staticClass:"empty-state-card"},[t("div",{staticClass:"empty-icon"},[a._v("üì≠")]),t("h3",[a._v("Nenhuma avalia√ß√£o encontrada")]),t("p",[a._v("Voc√™ ainda n√£o enviou nenhuma avalia√ß√£o de material.")]),t("button",{staticClass:"btn-primary",on:{click:function(t){a.activeTab="avaliacao"}}},[a._v(" ‚≠ê Fazer Primeira Avalia√ß√£o ")])]):t("div",{staticClass:"feedbacks-grid"},a._l(a.historicoFeedbacks,(function(o){return t("div",{key:o.id,staticClass:"feedback-card-history"},[t("div",{staticClass:"feedback-header"},[t("h4",[a._v(a._s(o.material_nome))]),t("div",{staticClass:"rating-display"},a._l(5,(function(e){return t("span",{key:e,staticClass:"star",class:{active:o.rating>=e}},[a._v("‚≠ê")])})),0)]),t("div",{staticClass:"feedback-content"},[t("p",{staticClass:"feedback-details"},[t("strong",[a._v("C√≥digo:")]),a._v(" "+a._s(o.material_codigo)),t("br"),t("strong",[a._v("Avalia√ß√£o:")]),a._v(" "+a._s(o.rating)+"/5 estrelas ")]),o.comentario?t("p",{staticClass:"feedback-comentario"},[t("strong",[a._v("Coment√°rio:")]),a._v(" "+a._s(o.comentario)+" ")]):a._e()]),t("div",{staticClass:"feedback-footer"},[t("span",{staticClass:"feedback-date"},[a._v("üìÖ "+a._s(a.formatDate(o.criado_em)))])])])})),0)])])]):a._e(),"materiais"===a.activeTab?t("div",{staticClass:"tab-content"},[a._m(3),t("div",{staticClass:"materiais-container"},[0===a.usuarioAtual.materiais?.length?t("div",{staticClass:"empty-state-card"},[t("div",{staticClass:"empty-icon"},[a._v("üì¶")]),t("h3",[a._v("Nenhum material cadastrado")]),t("p",[a._v("Voc√™ ainda n√£o possui materiais sob sua responsabilidade.")]),t("p",[a._v("Entre em contato com a CPM para solicitar acesso aos materiais do seu setor.")])]):t("div",{staticClass:"materiais-grid"},a._l(a.usuarioAtual.materiais,(function(o){return t("div",{key:o.produto_id,staticClass:"material-card"},[t("div",{staticClass:"material-header"},[t("h4",[a._v(a._s(o.nome))]),t("span",{staticClass:"material-code"},[a._v(a._s(o.codigo))])]),t("div",{staticClass:"material-info"},[t("p",[t("strong",[a._v("Periodicidade de Avalia√ß√£o:")]),a._v(" "+a._s(o.periodicidade_rdm))]),t("p",[t("strong",[a._v("Pr√≥xima Avalia√ß√£o:")]),a._v(" "+a._s(a.calcularProximaAvaliacao(o)))])]),t("div",{staticClass:"material-actions"},[t("button",{staticClass:"btn-avaliar",on:{click:function(t){a.activeTab="avaliacao"}}},[a._v(" ‚≠ê Avaliar Material ")])])])})),0)])]):a._e(),"perfil"===a.activeTab?t("div",{staticClass:"tab-content"},[a._m(4),t("div",{staticClass:"perfil-container"},[t("div",{staticClass:"perfil-cards"},[t("div",{staticClass:"perfil-card"},[t("h3",[a._v("üë§ Dados Pessoais")]),t("div",{staticClass:"perfil-info"},[t("p",[t("strong",[a._v("Nome:")]),a._v(" "+a._s(a.usuarioAtual.nome_usuario))]),t("p",[t("strong",[a._v("Email:")]),a._v(" "+a._s(a.usuarioAtual.email))]),t("p",[t("strong",[a._v("Unidade/Setor:")]),a._v(" "+a._s(a.usuarioAtual.unidade_setor))]),t("p",[t("strong",[a._v("Coordenador:")]),a._v(" "+a._s(a.usuarioAtual.nome_coordenador))])])]),t("div",{staticClass:"perfil-card"},[t("h3",[a._v("üìä Estat√≠sticas")]),t("div",{staticClass:"stats-grid"},[t("div",{staticClass:"stat-item"},[t("span",{staticClass:"stat-number"},[a._v(a._s(a.totalFeedbacks))]),t("span",{staticClass:"stat-label"},[a._v("Avalia√ß√µes Enviadas")])]),t("div",{staticClass:"stat-item"},[t("span",{staticClass:"stat-number"},[a._v(a._s(a.feedbacksRecentes))]),t("span",{staticClass:"stat-label"},[a._v("√öltimos 30 dias")])]),t("div",{staticClass:"stat-item"},[t("span",{staticClass:"stat-number"},[a._v(a._s(a.usuarioAtual.materiais?.length||0))]),t("span",{staticClass:"stat-label"},[a._v("Materiais Sob Responsabilidade")])])])]),t("div",{staticClass:"perfil-card"},[t("h3",[a._v("üîí Alterar Senha")]),t("form",{staticClass:"senha-form",on:{submit:function(t){return t.preventDefault(),a.alterarSenha.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("Senha Atual:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.senhaAtual,expression:"alteracaoSenha.senhaAtual"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.senhaAtual},on:{input:function(t){t.target.composing||a.$set(a.alteracaoSenha,"senhaAtual",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Nova Senha:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.novaSenha,expression:"alteracaoSenha.novaSenha"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.novaSenha},on:{input:function(t){t.target.composing||a.$set(a.alteracaoSenha,"novaSenha",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Confirmar Nova Senha:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.confirmaSenha,expression:"alteracaoSenha.confirmaSenha"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.confirmaSenha},on:{input:function(t){t.target.composing||a.$set(a.alteracaoSenha,"confirmaSenha",t.target.value)}}})]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.alterandoSenha}},[a.alterandoSenha?t("span",[a._v("‚è≥ Alterando...")]):t("span",[a._v("üîí Alterar Senha")])])])])])])]):a._e()])])])},qo=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo-section"},[t("h1",[a._v("üè• Sistema Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Dashboard RDM")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"page-header"},[t("h2",[a._v("‚≠ê Avalia√ß√£o de Materiais")]),t("p",[a._v("Avalie a qualidade dos materiais e registre problemas ou sugest√µes")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"page-header"},[t("h2",[a._v("üìã Hist√≥rico de Avalia√ß√µes")]),t("p",[a._v("Veja suas avalia√ß√µes e feedbacks anteriores")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"page-header"},[t("h2",[a._v("üì¶ Meus Materiais")]),t("p",[a._v("Materiais sob sua responsabilidade para avalia√ß√£o")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"page-header"},[t("h2",[a._v("‚öôÔ∏è Meu Perfil")]),t("p",[a._v("Informa√ß√µes da sua conta e configura√ß√µes")])])}];const Lo={name:"DashboardRDM",data(){return{activeTab:"avaliacao",usuarioAtual:{},novaReclamacao:{nome_reclamante:"",telefone:"",email:"",unidade_setor:"",nome_material:"",codigo_material:"",marca_modelo:"",rating:0,comentario:"",registro_reclamacao:"",sugestoes:""},materialSelecionadoReclamacao:null,enviandoReclamacao:!1,historicoFeedbacks:[],carregandoHistorico:!1,filtros:{busca:"",rating:"",periodo:""},alteracaoSenha:{senhaAtual:"",novaSenha:"",confirmaSenha:""},alterandoSenha:!1}},computed:{totalFeedbacks(){return this.historicoFeedbacks.length},feedbacksRecentes(){return this.historicoFeedbacks.filter((a=>{const t=new Date;return t.setMonth(t.getMonth()-1),new Date(a.criado_em)>=t})).length}},async mounted(){await this.carregarDadosUsuario(),await this.carregarHistoricoFeedbacks(),this.inicializarReclamacao()},watch:{activeTab(a){"historico"===a&&this.carregarHistoricoFeedbacks()}},methods:{async carregarDadosUsuario(){try{const a=localStorage.getItem("usuarioRDM");if(!a)throw new Error("Dados do usu√°rio n√£o encontrados");if(this.usuarioAtual=JSON.parse(a),!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usu√°rio incompletos");console.log("‚úÖ Dados do usu√°rio carregados:",{nome:this.usuarioAtual.nome_usuario,id:this.usuarioAtual.id,tenant_id:this.usuarioAtual.tenant_id,materiais:this.usuarioAtual.materiais?.length||0})}catch(a){console.error("‚ùå Erro ao carregar dados do usu√°rio:",a),alert("Erro ao carregar dados do usu√°rio. Por favor, fa√ßa login novamente."),this.$router.push("/rdm")}},inicializarReclamacao(){this.novaReclamacao.nome_reclamante=this.usuarioAtual.nome_usuario||"",this.novaReclamacao.email=this.usuarioAtual.email||"",this.novaReclamacao.unidade_setor=this.usuarioAtual.unidade_setor||"",this.novaReclamacao.rating=0,this.novaReclamacao.comentario=""},async carregarHistoricoFeedbacks(){this.carregandoHistorico=!0;try{if(!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usu√°rio incompletos");const{data:a,error:t}=await R.ND.from("material_feedbacks").select("*").eq("usuario_rdm_id",this.usuarioAtual.id).eq("tenant_id",this.usuarioAtual.tenant_id).order("criado_em",{ascending:!1});if(t)throw t;this.historicoFeedbacks=a||[],this.aplicarFiltros()}catch(a){console.error("‚ùå [HIST√ìRICO] Erro:",a),this.historicoFeedbacks=[],alert("Erro ao carregar hist√≥rico: "+a.message)}finally{this.carregandoHistorico=!1}},aplicarFiltros(){if(!this.historicoFeedbacks)return;let a=[...this.historicoFeedbacks];if(this.filtros.busca){const t=this.filtros.busca.toLowerCase();a=a.filter((a=>a.material_nome?.toLowerCase().includes(t)||a.material_codigo?.toLowerCase().includes(t)))}if(this.filtros.rating&&(a=a.filter((a=>a.rating==this.filtros.rating))),this.filtros.periodo){const t=new Date;a=a.filter((a=>{const o=new Date(a.criado_em);switch(this.filtros.periodo){case"hoje":return o.toDateString()===t.toDateString();case"semana":const a=new Date(t.getTime()-6048e5);return o>=a;case"mes":return o.getMonth()===t.getMonth()&&o.getFullYear()===t.getFullYear();case"trimestre":const e=new Date(t.getTime()-7776e6);return o>=e;default:return!0}}))}},calcularProximaAvaliacao(a){const t=new Date,o=a.periodicidade_rdm||"MENSAL";switch(o.toUpperCase()){case"SEMANAL":t.setDate(t.getDate()+7);break;case"QUINZENAL":t.setDate(t.getDate()+15);break;case"MENSAL":t.setMonth(t.getMonth()+1);break;case"TRIMESTRAL":t.setMonth(t.getMonth()+3);break;case"SEMESTRAL":t.setMonth(t.getMonth()+6);break;case"ANUAL":t.setFullYear(t.getFullYear()+1);break;default:t.setMonth(t.getMonth()+1)}return t.toLocaleDateString("pt-BR")},async enviarReclamacao(){if(!this.enviandoReclamacao){this.enviandoReclamacao=!0;try{if(console.log("üì§ [RECLAMA√á√ÉO] Enviando reclama√ß√£o..."),!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usu√°rio incompletos");if(!this.materialSelecionadoReclamacao)throw new Error("Nenhum material selecionado");const a={id:crypto.randomUUID(),tenant_id:this.usuarioAtual.tenant_id,usuario_rdm_id:this.usuarioAtual.id,produto_id:this.materialSelecionadoReclamacao.produto_id,material_nome:this.novaReclamacao.nome_material,material_codigo:this.novaReclamacao.codigo_material,rating:this.novaReclamacao.rating,comentario:this.novaReclamacao.comentario||"",criado_em:(new Date).toISOString()};console.log("üíæ [AVALIA√á√ÉO] Dados preparados:",a);const{error:t}=await R.ND.from("material_feedbacks").insert([a]);if(t)throw console.error("‚ùå [AVALIA√á√ÉO] Erro ao salvar feedback:",t),new Error(t.message);if(console.log("‚úÖ [AVALIA√á√ÉO] Feedback salvo com sucesso!"),this.novaReclamacao.registro_reclamacao?.trim()){const a={id:crypto.randomUUID(),tenant_id:this.usuarioAtual.tenant_id,usuario_rdm_id:this.usuarioAtual.id,nome_reclamante:this.novaReclamacao.nome_reclamante,telefone:this.novaReclamacao.telefone,email:this.novaReclamacao.email,unidade_setor:this.novaReclamacao.unidade_setor,nome_material:this.novaReclamacao.nome_material,codigo_material:this.novaReclamacao.codigo_material,marca_modelo:this.novaReclamacao.marca_modelo,registro_reclamacao:this.novaReclamacao.registro_reclamacao,sugestoes:this.novaReclamacao.sugestoes||"",status:"ABERTA",data_reclamacao:(new Date).toISOString()},{error:t}=await R.ND.from("reclamacoes_usuarios").insert([a]);if(t)throw console.error("‚ùå [RECLAMA√á√ÉO] Erro ao salvar reclama√ß√£o:",t),new Error(t.message)}await this.carregarHistoricoFeedbacks(),alert("‚úÖ Avalia√ß√£o enviada com sucesso!"),this.limparAvaliacao()}catch(a){console.error("‚ùå [RECLAMA√á√ÉO] Erro ao enviar:",a),alert("Erro ao enviar: "+a.message)}finally{this.enviandoReclamacao=!1}}},preencherDadosMaterial(){this.materialSelecionadoReclamacao&&(this.novaReclamacao.nome_material=this.materialSelecionadoReclamacao.nome,this.novaReclamacao.codigo_material=this.materialSelecionadoReclamacao.codigo,this.novaReclamacao.marca_modelo="",console.log("üì¶ [RECLAMA√á√ÉO] Material selecionado:",this.materialSelecionadoReclamacao.nome))},limparAvaliacao(){this.novaReclamacao={nome_reclamante:this.usuarioAtual.nome_usuario||"",telefone:"",email:this.usuarioAtual.email||"",unidade_setor:this.usuarioAtual.unidade_setor||"",nome_material:"",codigo_material:"",marca_modelo:"",rating:0,comentario:"",registro_reclamacao:"",sugestoes:""},this.materialSelecionadoReclamacao=null},formatDate(a){return new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},async alterarSenha(){if(this.alteracaoSenha.novaSenha===this.alteracaoSenha.confirmaSenha){this.alterandoSenha=!0;try{alert("üéâ Senha alterada com sucesso!"),this.alteracaoSenha={senhaAtual:"",novaSenha:"",confirmaSenha:""}}catch(a){console.error("‚ùå Erro ao alterar senha:",a),alert("‚ùå Erro ao alterar senha: "+a.message)}finally{this.alterandoSenha=!1}}else alert("‚ùå As senhas n√£o coincidem!")},async logout(){confirm("Tem certeza que deseja sair?")&&(localStorage.removeItem("usuarioRDM"),this.$router.push("/rdm"))}}},Vo=Lo;var Uo=(0,C.A)(Vo,Bo,qo,!1,null,"c149abe6",null);const jo=Uo.exports;var Jo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"pesquisa-tecnica-view"},[t("PesquisaBot")],1)},Go=[];const Ho={name:"PesquisaTecnica",components:{PesquisaBot:ta}},Qo=Ho;var Yo=(0,C.A)(Qo,Jo,Go,!1,null,"923bc138",null);const Ko=Yo.exports;var Wo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"processos-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Cat√°logo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classifica√ß√£o")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[t("span",[a._v("Processos")]),t("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),t("div",{staticClass:"user-menu"},[t("div",{staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[t("div",{staticClass:"profile-avatar"},[a._v(" üë§ ")]),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("‚ñº")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ‚öôÔ∏è Configura√ß√£o ")]),t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" üìß Configurar Email ")]),t("hr",{staticClass:"dropdown-divider"}),t("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" üö™ Sair ")])]):a._e()])])]),t("main",{staticClass:"main-content"},[t("ProcessosAdministrativosComponent")],1)])},Xo=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras P√∫blicas Inteligentes")])])])}],Zo=function(){var a=this,t=a._self._c;return t("div",{staticClass:"processos-container"},[t("div",{staticClass:"content-wrapper"},[t("aside",{staticClass:"sidebar"},[t("div",{staticClass:"filter-section"},[t("h3",[a._v("üîç Filtros Avan√ßados")]),t("div",{staticClass:"filter-group"},[t("label",[a._v("üìÅ Categoria")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroCategoria,expression:"filtroCategoria"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroCategoria=t.target.multiple?o:o[0]},a.filtrarDocumentos]}},[t("option",{attrs:{value:""}},[a._v("Todas as categorias")]),t("option",{attrs:{value:"manual"}},[a._v("üìñ Manuais")]),t("option",{attrs:{value:"template"}},[a._v("üìÑ Templates")]),t("option",{attrs:{value:"instrucao"}},[a._v("üìã Instru√ß√µes")]),t("option",{attrs:{value:"normativa"}},[a._v("‚öñÔ∏è Normativas")]),t("option",{attrs:{value:"formulario"}},[a._v("üìù Formul√°rios")])])]),t("div",{staticClass:"filter-group"},[t("label",[a._v("üîé Buscar Documentos")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.termoBusca,expression:"termoBusca"}],staticClass:"search-input",attrs:{type:"text",placeholder:"Digite palavras-chave..."},domProps:{value:a.termoBusca},on:{input:[function(t){t.target.composing||(a.termoBusca=t.target.value)},a.filtrarDocumentos]}})]),t("div",{staticClass:"filter-group"},[t("label",[a._v("üìÖ Per√≠odo")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroPeriodo,expression:"filtroPeriodo"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.filtroPeriodo=t.target.multiple?o:o[0]},a.filtrarDocumentos]}},[t("option",{attrs:{value:""}},[a._v("Todos os per√≠odos")]),t("option",{attrs:{value:"ultima_semana"}},[a._v("√öltima semana")]),t("option",{attrs:{value:"ultimo_mes"}},[a._v("√öltimo m√™s")]),t("option",{attrs:{value:"ultimos_3_meses"}},[a._v("√öltimos 3 meses")]),t("option",{attrs:{value:"ultimo_ano"}},[a._v("√öltimo ano")])])]),t("div",{staticClass:"filter-group"},[t("label",[a._v("üìä Ordenar por")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.ordenacao,expression:"ordenacao"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.ordenacao=t.target.multiple?o:o[0]},a.filtrarDocumentos]}},[t("option",{attrs:{value:"data_desc"}},[a._v("Mais recentes")]),t("option",{attrs:{value:"data_asc"}},[a._v("Mais antigos")]),t("option",{attrs:{value:"titulo_asc"}},[a._v("A-Z (T√≠tulo)")]),t("option",{attrs:{value:"titulo_desc"}},[a._v("Z-A (T√≠tulo)")]),t("option",{attrs:{value:"categoria"}},[a._v("Por categoria")])])]),t("div",{staticClass:"stats-section"},[t("h4",[a._v("üìà Estat√≠sticas")]),t("div",{staticClass:"stats-item"},[t("span",{staticClass:"stats-label"},[a._v("Total:")]),t("span",{staticClass:"stats-value"},[a._v(a._s(a.documentos.length))])]),t("div",{staticClass:"stats-item"},[t("span",{staticClass:"stats-label"},[a._v("Filtrados:")]),t("span",{staticClass:"stats-value"},[a._v(a._s(a.documentosFiltrados.length))])])])]),a.podeUpload?t("div",{staticClass:"upload-section"},[t("h3",[a._v("Adicionar Documento")]),t("button",{staticClass:"btn-upload",on:{click:a.abrirModalUpload}},[a._v(" üìÑ Novo Documento ")])]):a._e()]),t("section",{staticClass:"documents-section"},[t("div",{staticClass:"documents-header"},[t("h3",[a._v("Documentos ("+a._s(a.documentosFiltrados.length)+")")]),t("div",{staticClass:"view-options"},[t("button",{class:{active:"grid"===a.visualizacao},on:{click:function(t){a.visualizacao="grid"}}},[a._v(" ‚äû Grade ")]),t("button",{class:{active:"list"===a.visualizacao},on:{click:function(t){a.visualizacao="list"}}},[a._v(" ‚ò∞ Lista ")])])]),a.carregando?t("div",{staticClass:"loading"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando documentos...")])]):0===a.documentosFiltrados.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("üìÇ")]),t("h4",[a._v("Nenhum documento encontrado")]),t("p",[a._v("Tente ajustar os filtros ou adicione novos documentos")])]):t("div",{staticClass:"documents-container",class:a.visualizacao},a._l(a.documentosFiltrados,(function(o){return t("div",{key:o.id,staticClass:"document-card",on:{click:function(t){return a.visualizarDocumento(o)}}},[t("div",{staticClass:"document-icon"},[a._v(" "+a._s(a.getIconeCategoria(o.categoria))+" ")]),t("div",{staticClass:"document-info"},[t("h4",[a._v(a._s(o.titulo))]),t("p",{staticClass:"document-desc"},[a._v(a._s(o.descricao))]),t("div",{staticClass:"document-meta"},[t("span",{staticClass:"categoria"},[a._v(a._s(a.getNomeCategoria(o.categoria)))]),t("span",{staticClass:"data"},[a._v(a._s(a.formatarData(o.criado_em)))])])]),t("div",{staticClass:"document-actions"},[t("button",{staticClass:"btn-action",on:{click:function(t){return t.stopPropagation(),a.baixarDocumento(o)}}},[a._v(" ‚¨áÔ∏è ")]),a.podeEditar?t("button",{staticClass:"btn-action",on:{click:function(t){return t.stopPropagation(),a.editarDocumento(o)}}},[a._v(" ‚úèÔ∏è ")]):a._e()])])})),0)])]),a.modalUploadAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalUpload}},[t("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("Adicionar Documento")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalUpload}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.uploadDocumento.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",[a._v("T√≠tulo *")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.novoDocumento.titulo,expression:"novoDocumento.titulo"}],attrs:{type:"text",required:""},domProps:{value:a.novoDocumento.titulo},on:{input:function(t){t.target.composing||a.$set(a.novoDocumento,"titulo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Descri√ß√£o")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novoDocumento.descricao,expression:"novoDocumento.descricao"}],attrs:{rows:"3"},domProps:{value:a.novoDocumento.descricao},on:{input:function(t){t.target.composing||a.$set(a.novoDocumento,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Categoria *")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.novoDocumento.categoria,expression:"novoDocumento.categoria"}],attrs:{required:""},on:{change:function(t){var o=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.novoDocumento,"categoria",t.target.multiple?o:o[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione uma categoria")]),t("option",{attrs:{value:"manual"}},[a._v("Manual")]),t("option",{attrs:{value:"template"}},[a._v("Template")]),t("option",{attrs:{value:"instrucao"}},[a._v("Instru√ß√£o")]),t("option",{attrs:{value:"normativa"}},[a._v("Normativa")]),t("option",{attrs:{value:"formulario"}},[a._v("Formul√°rio")])])]),t("div",{staticClass:"form-group"},[t("label",[a._v("Arquivo *")]),t("input",{attrs:{type:"file",accept:".pdf,.doc,.docx,.xlsx,.xls",required:""},on:{change:a.selecionarArquivo}}),t("small",[a._v("Formatos aceitos: PDF, DOC, DOCX, XLS, XLSX")])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalUpload}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.enviandoUpload}},[a._v(" "+a._s(a.enviandoUpload?"Enviando...":"Salvar")+" ")])])])])])]):a._e(),a.documentoSelecionado?t("div",{staticClass:"modal-overlay",on:{click:a.fecharVisualizacao}},[t("div",{staticClass:"modal modal-large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("div",{staticClass:"document-title-section"},[t("div",{staticClass:"document-icon-large"},[a._v(" "+a._s(a.getIconeCategoria(a.documentoSelecionado.categoria))+" ")]),t("div",[t("h3",[a._v(a._s(a.documentoSelecionado.titulo))]),t("span",{staticClass:"document-category-badge"},[a._v(a._s(a.getNomeCategoria(a.documentoSelecionado.categoria)))])])]),t("button",{staticClass:"btn-close",on:{click:a.fecharVisualizacao}},[a._v("√ó")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"document-viewer-container"},[t("div",{staticClass:"document-details-panel"},[t("h4",[a._v("üìã Informa√ß√µes do Documento")]),t("div",{staticClass:"detail-item"},[t("strong",[a._v("üìù Descri√ß√£o:")]),t("p",[a._v(a._s(a.documentoSelecionado.descricao||"Sem descri√ß√£o dispon√≠vel"))])]),t("div",{staticClass:"detail-item"},[t("strong",[a._v("üìÅ Categoria:")]),t("span",{staticClass:"category-pill"},[a._v(a._s(a.getNomeCategoria(a.documentoSelecionado.categoria)))])]),t("div",{staticClass:"detail-item"},[t("strong",[a._v("üìÖ Data de Cria√ß√£o:")]),t("span",[a._v(a._s(a.formatarData(a.documentoSelecionado.criado_em)))])]),a.documentoSelecionado.tamanho_arquivo?t("div",{staticClass:"detail-item"},[t("strong",[a._v("üíæ Tamanho:")]),t("span",[a._v(a._s(a.formatarTamanho(a.documentoSelecionado.tamanho_arquivo)))])]):a._e(),a.documentoSelecionado.tipo_mime?t("div",{staticClass:"detail-item"},[t("strong",[a._v("üìÑ Tipo:")]),t("span",[a._v(a._s(a.documentoSelecionado.tipo_mime))])]):a._e(),t("div",{staticClass:"document-actions-panel"},[t("button",{staticClass:"btn-primary btn-large",on:{click:function(t){return a.baixarDocumento(a.documentoSelecionado)}}},[a._v(" ‚¨áÔ∏è Baixar Documento ")]),a.podeEditar?t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.editarDocumento(a.documentoSelecionado)}}},[a._v(" ‚úèÔ∏è Editar Informa√ß√µes ")]):a._e(),t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.compartilharDocumento(a.documentoSelecionado)}}},[a._v(" üîó Compartilhar ")])])]),t("div",{staticClass:"document-preview-panel"},[t("h4",[a._v("üëÅÔ∏è Visualiza√ß√£o do Documento")]),t("div",{staticClass:"preview-container"},["manual"===a.documentoSelecionado.categoria?t("div",{staticClass:"manual-preview"},[t("div",{staticClass:"manual-content"},[a._m(0),t("div",{staticClass:"manual-nav"},a._l(a.manuaisSections,(function(o,e){return t("button",{key:e,staticClass:"nav-btn",class:{active:a.secaoAtiva===e},on:{click:function(t){a.secaoAtiva=e}}},[a._v(" "+a._s(o.icone)+" "+a._s(o.titulo)+" ")])})),0),t("div",{staticClass:"manual-sections"},[0===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("üéØ O que √© o Sistema Comprar Bem")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üîç Objetivo Principal")]),a._m(1),t("h7",[a._v('üé° Conceito "Comprar Bem"')]),a._m(2),t("h7",[a._v("üéØ Como Funciona")]),t("p",[a._v("O sistema permite que os √≥rg√£os p√∫blicos:")]),a._m(3),t("h7",[a._v("üîÑ Processo Completo")]),a._m(4)],1)]):a._e(),1===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("üìä Dashboard CPM - Comiss√£o de Padroniza√ß√£o")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ O que faz a CPM")]),a._m(5),t("h7",[a._v("üìã Como Funciona a An√°lise")]),a._m(6),t("h7",[a._v("‚è∞ Prazos da CPM")]),a._m(7),t("h7",[a._v("üìã Como Usar o Painel CPM")]),a._m(8),t("h7",[a._v("‚úÖ Crit√©rios de Aprova√ß√£o")]),a._m(9)],1)]):a._e(),2===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("‚öñÔ∏è Dashboard CCL - Comiss√£o de Contrata√ß√£o")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ O que faz a CCL")]),a._m(10),t("h7",[a._v("üìã Como Funciona o Julgamento")]),a._m(11),t("h7",[a._v("‚è∞ Prazos da CCL")]),a._m(12),t("h7",[a._v("üìã Como Usar o Painel CCL")]),a._m(13),t("h7",[a._v("‚öñÔ∏è Decis√µes Poss√≠veis")]),a._m(14)],1)]):a._e(),3===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("üìù DCB - Declara√ß√£o de Conformidade de Bem")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ O que √© a DCB")]),a._m(15),t("h7",[a._v("üìù O que tem na DCB")]),a._m(16),t("h7",[a._v("‚è∞ Validade da DCB")]),a._m(17),t("h7",[a._v("üìã Como Usar a DCB")]),a._m(18),t("h7",[a._v("‚úÖ Vantagens da DCB")]),a._m(19)],1)]):a._e(),4===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("üìä RDM - Relat√≥rio de Desempenho de Material")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ Para que serve o RDM")]),a._m(20),t("h7",[a._v("üë• Quem faz a Avalia√ß√£o")]),a._m(21),t("h7",[a._v("üìä O que √© Avaliado")]),a._m(22),t("h7",[a._v("üìã Como Fazer uma Avalia√ß√£o RDM")]),a._m(23),t("h7",[a._v("‚ú® Import√¢ncia do RDM")]),a._m(24)],1)]):a._e(),5===a.secaoAtiva?t("div",{staticClass:"manual-section"},[t("h6",[a._v("üìö Cat√°logo - Produtos Pr√©-Qualificados")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ Para que serve o Cat√°logo")]),a._m(25),t("h7",[a._v("üîç Como Buscar Produtos")]),a._m(26),t("h7",[a._v("üìã Como Usar na Pr√°tica")]),a._m(27),t("h7",[a._v("‚úÖ Vantagens do Cat√°logo")]),a._m(28)],1)]):a._e()])])]):"normativa"===a.documentoSelecionado.categoria&&a.documentoSelecionado.titulo.includes("Lei 14.133")?t("div",{staticClass:"lei-preview"},[t("div",{staticClass:"lei-content"},[a._m(29),t("div",{staticClass:"lei-nav"},a._l(a.leiSections,(function(o,e){return t("button",{key:e,staticClass:"nav-btn",class:{active:a.secaoLeiAtiva===e},on:{click:function(t){a.secaoLeiAtiva=e}}},[a._v(" "+a._s(o.icone)+" "+a._s(o.titulo)+" ")])})),0),t("div",{staticClass:"lei-sections"},[0===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("üéØ O que Mudou com a Nova Lei")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üóìÔ∏è Quando Entrou em Vigor")]),a._m(30),t("h7",[a._v("üéØ Principais Objetivos")]),a._m(31),t("h7",[a._v("üîÑ Mudan√ßa de Mentalidade")]),t("div",{staticClass:"comparison"},[t("div",{staticClass:"before"},[t("h8",[a._v("‚ùå ANTES (Lei 8.666/93)")]),a._m(32)],1),t("div",{staticClass:"after"},[t("h8",[a._v("‚úÖ AGORA (Lei 14.133/21)")]),a._m(33)],1)])],1)]):a._e(),1===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("üìã Modalidades de Licita√ß√£o")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("‚ùå Modalidades Extintas")]),a._m(34),t("h7",[a._v("‚úÖ Modalidades Vigentes")]),a._m(35),t("h7",[a._v("‚ö° Mudan√ßa Fundamental")]),a._m(36)],1)]):a._e(),2===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("‚è∞ Prazos Essenciais")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üìÖ Prazos Para Apresenta√ß√£o de Propostas")]),a._m(37),t("h7",[a._v("‚öñÔ∏è Prazos Para Recursos")]),a._m(38)],1)]):a._e(),3===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("üéØ Pr√©-Qualifica√ß√£o na Nova Lei")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üìÑ Base Legal")]),a._m(39),t("h7",[a._v("üîÑ Como Funciona")]),a._m(40),t("h7",[a._v("‚úÖ Vantagens")]),a._m(41)],1)]):a._e(),4===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("üìä Crit√©rios de Julgamento")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üéØ Novos Crit√©rios Dispon√≠veis")]),a._m(42),t("h7",[a._v("üå± Sustentabilidade")]),a._m(43)],1)]):a._e(),5===a.secaoLeiAtiva?t("div",{staticClass:"lei-section"},[t("h6",[a._v("üîç Transpar√™ncia e Publicidade")]),t("div",{staticClass:"subsection"},[t("h7",[a._v("üåê Obriga√ß√µes de Divulga√ß√£o")]),a._m(44),t("h7",[a._v("üìö Cat√°logo Eletr√¥nico")]),a._m(45),t("h7",[a._v("‚ö° Benef√≠cios da Transpar√™ncia")]),a._m(46)],1)]):a._e()])])]):t("div",{staticClass:"document-placeholder"},[t("div",{staticClass:"placeholder-icon"},[a._v(a._s(a.getIconeCategoria(a.documentoSelecionado.categoria)))]),t("h5",[a._v(a._s(a.documentoSelecionado.titulo))]),t("p",[a._v("Visualiza√ß√£o completa dispon√≠vel ap√≥s o download")]),t("small",[a._v("Tipo: "+a._s(a.documentoSelecionado.tipo_mime||"Documento"))])])])])])])])]):a._e()])},ae=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"manual-header"},[t("h5",[a._v("üìñ Manual do Sistema Comprar Bem")]),t("p",{staticClass:"manual-subtitle"},[a._v("Compras P√∫blicas Inteligentes - Guia Completo")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("O sistema "),t("strong",[a._v("Comprar Bem")]),a._v(" foi criado para facilitar e otimizar os processos de compras p√∫blicas, implementando a pr√©-qualifica√ß√£o t√©cnica de produtos conforme a "),t("strong",[a._v("Lei Federal n¬∫ 14.133/2021")]),a._v(".")])},function(){var a=this,t=a._self._c;return t("p",[a._v("Significa conseguir adquirir os produtos "),t("strong",[a._v("certos")]),a._v(", t√©cnica e funcionalmente adequados para atender √†s necessidades do √≥rg√£o, com "),t("em",[a._v("qualidade, economicidade e conformidade legal")]),a._v(".")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Pr√©-qualifiquem produtos")]),a._v(" antes das compras")]),t("li",[t("strong",[a._v("Tenham seguran√ßa")]),a._v(" de que est√£o comprando produtos adequados")]),t("li",[t("strong",[a._v("Agilizem licita√ß√µes")]),a._v(" usando o cat√°logo pr√©-aprovado")]),t("li",[t("strong",[a._v("Avaliem fornecedores")]),a._v(" ap√≥s as compras")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"workflow"},[t("div",{staticClass:"step"},[a._v("Solicita√ß√£o de Pr√©-qualifica√ß√£o")]),t("div",{staticClass:"step"},[a._v("An√°lise t√©cnica pela CPM")]),t("div",{staticClass:"step"},[a._v("Julgamento pela CCL")]),t("div",{staticClass:"step"},[a._v("Emiss√£o da DCB")]),t("div",{staticClass:"step"},[a._v("Inclus√£o no Cat√°logo")]),t("div",{staticClass:"step"},[a._v("Uso em Licita√ß√µes")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("A CPM √© respons√°vel por "),t("strong",[a._v("analisar tecnicamente")]),a._v(" os produtos que ser√£o pr√©-qualificados. √â uma equipe de servidores especializados que garante que apenas produtos adequados entrem no cat√°logo.")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Recebe solicita√ß√µes")]),a._v(" de pr√©-qualifica√ß√£o")]),t("li",[t("strong",[a._v("Analisa documenta√ß√£o")]),a._v(" t√©cnica do produto")]),t("li",[t("strong",[a._v("Avalia amostras")]),a._v(" (quando necess√°rio)")]),t("li",[t("strong",[a._v("Emite parecer")]),a._v(" t√©cnico fundamentado")]),t("li",[t("strong",[a._v("Recomenda")]),a._v(" aprova√ß√£o ou reprova√ß√£o")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("An√°lise t√©cnica:")]),a._v(" At√© 10 dias √∫teis")]),t("li",[t("strong",[a._v("Parecer:")]),a._v(" Deve ser fundamentado e detalhado")]),t("li",[t("strong",[a._v("Envio para CCL:")]),a._v(" Ap√≥s conclus√£o da an√°lise")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Produtos Pendentes:")]),a._v(" Novos pedidos de pr√©-qualifica√ß√£o")]),t("li",[t("strong",[a._v("Em An√°lise:")]),a._v(" Produtos sendo avaliados pela equipe")]),t("li",[t("strong",[a._v("Pareceres Prontos:")]),a._v(" An√°lises conclu√≠das")]),t("li",[t("strong",[a._v("Alertas de Prazo:")]),a._v(" Produtos com prazo vencendo")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Conformidade t√©cnica")]),a._v(" com especifica√ß√µes")]),t("li",[t("strong",[a._v("Documenta√ß√£o completa")]),a._v(" e adequada")]),t("li",[t("strong",[a._v("Qualidade do produto")]),a._v(" compatvel com o uso")]),t("li",[t("strong",[a._v("Seguran√ßa")]),a._v(" e adequa√ß√£o √†s normas")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("A CCL √© respons√°vel pelo "),t("strong",[a._v("julgamento administrativo")]),a._v(" dos processos de pr√©-qualifica√ß√£o. Ela analisa os pareceres da CPM e toma a decis√£o final sobre aprovar ou reprovar produtos.")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Recebe pareceres")]),a._v(" t√©cnicos da CPM")]),t("li",[t("strong",[a._v("Analisa documenta√ß√£o")]),a._v(" administrativa")]),t("li",[t("strong",[a._v("Verifica conformidade")]),a._v(" legal do processo")]),t("li",[t("strong",[a._v("Emite ata")]),a._v(" de julgamento")]),t("li",[t("strong",[a._v("Abre prazo")]),a._v(" para recursos")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Julgamento:")]),a._v(" Ap√≥s receber parecer da CPM")]),t("li",[t("strong",[a._v("Prazo recursal:")]),a._v(" 3 dias √∫teis ap√≥s publica√ß√£o")]),t("li",[t("strong",[a._v("An√°lise de recursos:")]),a._v(" Conforme complexidade")]),t("li",[t("strong",[a._v("Encaminhamento:")]),a._v(" Para autoridade competente")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Aguardando Julgamento:")]),a._v(" Pareceres da CPM para analisar")]),t("li",[t("strong",[a._v("Atas Publicadas:")]),a._v(" Decis√µes aguardando prazo recursal")]),t("li",[t("strong",[a._v("Com Recursos:")]),a._v(" Processos com impugna√ß√µes")]),t("li",[t("strong",[a._v("Prontos para Homologa√ß√£o:")]),a._v(" Processos finalizados")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Aprovado:")]),a._v(" Produto atende aos requisitos")]),t("li",[t("strong",[a._v("Aprovado com ressalvas:")]),a._v(" Produto aprovado com restri√ß√µes")]),t("li",[t("strong",[a._v("Reprovado:")]),a._v(" Produto n√£o atende aos crit√©rios")]),t("li",[t("strong",[a._v("Dilig√™ncia:")]),a._v(" Solicita√ß√£o de informa√ß√µes adicionais")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("A DCB √© o "),t("strong",[a._v('"certificado de aprova√ß√£o"')]),a._v(" do produto. √â o documento que comprova que aquele produto espec√≠fico foi analisado, aprovado e pode ser comprado pelos √≥rg√£os p√∫blicos sem nova an√°lise t√©cnica.")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Nome completo do produto")]),a._v(" aprovado")]),t("li",[t("strong",[a._v("Marca e modelo")]),a._v(" espec√≠ficos")]),t("li",[t("strong",[a._v("Fabricante")]),a._v(" respons√°vel")]),t("li",[t("strong",[a._v("Especifica√ß√µes t√©cnicas")]),a._v(" detalhadas")]),t("li",[t("strong",[a._v("Data de validade")]),a._v(" da aprova√ß√£o")]),t("li",[t("strong",[a._v("Observa√ß√µes especiais")]),a._v(" (se houver)")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Prazo m√°ximo:")]),a._v(" 1 ano a partir da emiss√£o")]),t("li",[t("strong",[a._v("Renova√ß√£o:")]),a._v(" Poss√≠vel mediante nova solicita√ß√£o")]),t("li",[t("strong",[a._v("Cancelamento:")]),a._v(" Se o produto apresentar problemas")]),t("li",[t("strong",[a._v("Controle:")]),a._v(" Acompanhado via RDM")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Consulte no Cat√°logo")]),a._v(" se o produto tem DCB v√°lida")]),t("li",[t("strong",[a._v("Use diretamente na licita√ß√£o")]),a._v(" - n√£o precisa nova an√°lise")]),t("li",[t("strong",[a._v("Cite a DCB no edital")]),a._v(" como comprova√ß√£o t√©cnica")]),t("li",[t("strong",[a._v("Verifique sempre a validade")]),a._v(" antes de usar")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Seguran√ßa:")]),a._v(" Produto j√° foi analisado tecnicamente")]),t("li",[t("strong",[a._v("Agilidade:")]),a._v(" N√£o precisa nova an√°lise na licita√ß√£o")]),t("li",[t("strong",[a._v("Qualidade:")]),a._v(" Garantia de conformidade t√©cnica")]),t("li",[t("strong",[a._v("Legal:")]),a._v(" Atende exig√™ncias da Lei 14.133/2021")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("O RDM serve para "),t("strong",[a._v("avaliar se os produtos comprados realmente funcionaram bem")]),a._v('. √â como uma "avalia√ß√£o" que voc√™ faz do produto depois de us√°-lo, para ajudar outros √≥rg√£os a decidir se devem comprar o mesmo produto.')])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Quem usa o produto")]),a._v(" no dia a dia")]),t("li",[t("strong",[a._v("Respons√°veis pelo estoque")])]),t("li",[t("strong",[a._v("Gestores")]),a._v(" que acompanham o uso")]),t("li",[t("strong",[a._v("T√©cnicos")]),a._v(" quando necess√°rio")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"criterios"},[t("div",{staticClass:"criterio"},[t("strong",[a._v("‚úÖ Qualidade:")]),a._v(" O produto funcionou como esperado? ")]),t("div",{staticClass:"criterio"},[t("strong",[a._v("‚è±Ô∏è Durabilidade:")]),a._v(" Durou o tempo previsto? ")]),t("div",{staticClass:"criterio"},[t("strong",[a._v("‚ö° Efic√°cia:")]),a._v(" Resolveu o problema que deveria? ")]),t("div",{staticClass:"criterio"},[t("strong",[a._v("üí∞ Custo-benef√≠cio:")]),a._v(" Valeu o pre√ßo pago? ")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Acesse o menu RDM")]),a._v(" no sistema")]),t("li",[t("strong",[a._v("Procure o produto")]),a._v(" que voc√™ comprou")]),t("li",[t("strong",[a._v("Preencha o formul√°rio")]),a._v(" com sua experi√™ncia")]),t("li",[t("strong",[a._v("Seja honesto:")]),a._v(" Sua avalia√ß√£o ajuda outros √≥rg√£os")]),t("li",[t("strong",[a._v("Envie o relat√≥rio")]),a._v(" - a CPM vai analisar")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Produtos ruins")]),a._v(" s√£o removidos do cat√°logo")]),t("li",[t("strong",[a._v("Produtos bons")]),a._v(" continuam dispon√≠veis")]),t("li",[t("strong",[a._v("Outros √≥rg√£os")]),a._v(" se beneficiam da sua experi√™ncia")]),t("li",[t("strong",[a._v("Melhora continu")]),a._v(" da qualidade das compras")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("O Cat√°logo √© onde ficam listados todos os produtos que j√° foram "),t("strong",[a._v("pr√©-qualificados")]),a._v(" e est√£o aprovados para compra pelos √≥rg√£os p√∫blicos.")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Por categoria:")]),a._v(" Escolha entre Sa√∫de, Administrativa, TI, etc.")]),t("li",[t("strong",[a._v("Por nome:")]),a._v(" Digite o nome do produto que procura")]),t("li",[t("strong",[a._v("Por marca:")]),a._v(" Busque por fabricantes espec√≠ficos")]),t("li",[t("strong",[a._v("Por especifica√ß√£o:")]),a._v(" Encontre produtos com caracter√≠sticas t√©cnicas espec√≠ficas")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Acesse o Cat√°logo")]),a._v(" no menu principal")]),t("li",[t("strong",[a._v("Busque o produto")]),a._v(" que precisa comprar")]),t("li",[t("strong",[a._v("Verifique se est√° pr√©-qualificado")]),a._v(" (tem DCB v√°lida)")]),t("li",[t("strong",[a._v("Use diretamente na licita√ß√£o")]),a._v(" - sem need de nova an√°lise t√©cnica")]),t("li",[t("strong",[a._v("Exporte a lista")]),a._v(" de produtos para seu edital")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[a._v("Produtos j√° "),t("strong",[a._v("analisados tecnicamente")])]),t("li",[t("strong",[a._v("Licita√ß√µes mais r√°pidas")])]),t("li",[t("strong",[a._v("Menor risco")]),a._v(" de comprar produto inadequado")]),t("li",[t("strong",[a._v("Facilita compara√ß√£o")]),a._v(" entre op√ß√µes")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"lei-header"},[t("h5",[a._v("‚öñÔ∏è Lei 14.133/2021 - Nova Lei de Licita√ß√µes")]),t("p",{staticClass:"lei-subtitle"},[a._v("Guia Pr√°tico para Gestores de Compras P√∫blicas")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("A Lei 14.133/2021 est√° em "),t("strong",[a._v("plena vig√™ncia desde janeiro de 2024")]),a._v(", substituindo completamente a antiga Lei 8.666/93 que vigorou por mais de 30 anos.")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Qualidade acima do pre√ßo baixo:")]),a._v(' Buscar o "resultado mais vantajoso"')]),t("li",[t("strong",[a._v("Moderniza√ß√£o:")]),a._v(" Tecnologias digitais e processos eficientes")]),t("li",[t("strong",[a._v("Transpar√™ncia:")]),a._v(" Maior controle social e publicidade")]),t("li",[t("strong",[a._v("Sustentabilidade:")]),a._v(" Crit√©rios sociais e ambientais")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("Foco no "),t("strong",[a._v("menor pre√ßo")]),a._v(" como crit√©rio principal")])},function(){var a=this,t=a._self._c;return t("p",[a._v("Foco no "),t("strong",[a._v("resultado mais vantajoso")]),a._v(" considerando qualidade, durabilidade e custo-benef√≠cio")])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Tomada de Pre√ßos")]),a._v(" - N√£o existe mais")]),t("li",[t("strong",[a._v("Convite")]),a._v(" - N√£o existe mais")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"modalidades"},[t("div",{staticClass:"modalidade"},[t("strong",[a._v("üìù Preg√£o:")]),a._v(" OBRIGAT√ìRIO para bens e servi√ßos comuns ")]),t("div",{staticClass:"modalidade"},[t("strong",[a._v("üè¢ Concorr√™ncia:")]),a._v(" Para bens/servi√ßos especiais e obras ")]),t("div",{staticClass:"modalidade"},[t("strong",[a._v("üîÑ Di√°logo Competitivo:")]),a._v(" NOVA modalidade para solu√ß√µes inovadoras ")]),t("div",{staticClass:"modalidade"},[t("strong",[a._v("üèÜ Concurso:")]),a._v(" Para trabalhos t√©cnicos e art√≠sticos ")]),t("div",{staticClass:"modalidade"},[t("strong",[a._v("üí∞ Leil√£o:")]),a._v(" Para venda de bens p√∫blicos ")])])},function(){var a=this,t=a._self._c;return t("p",[a._v("A escolha da modalidade "),t("strong",[a._v("N√ÉO depende mais do valor")]),a._v(", mas da "),t("strong",[a._v("natureza do objeto")]),a._v(".")])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"prazos-tabela"},[t("div",{staticClass:"prazo-item"},[t("strong",[a._v("Aquisi√ß√£o de Bens (menor pre√ßo):")]),t("span",{staticClass:"prazo"},[a._v("8 dias √∫teis")])]),t("div",{staticClass:"prazo-item"},[t("strong",[a._v("Servi√ßos Comuns (menor pre√ßo):")]),t("span",{staticClass:"prazo"},[a._v("10 dias √∫teis")])]),t("div",{staticClass:"prazo-item"},[t("strong",[a._v("Servi√ßos Especiais:")]),t("span",{staticClass:"prazo"},[a._v("25 dias √∫teis")])]),t("div",{staticClass:"prazo-item"},[t("strong",[a._v("T√©cnica e Pre√ßo:")]),t("span",{staticClass:"prazo"},[a._v("35 dias √∫teis")])])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Manifesta√ß√£o de interesse:")]),a._v(" M√≠nimo 10 minutos na sess√£o")]),t("li",[t("strong",[a._v("Apresenta√ß√£o de raz√µes:")]),a._v(" 3 dias √∫teis")]),t("li",[t("strong",[a._v("Contrarraz√µes:")]),a._v(" 3 dias √∫teis")]),t("li",[t("strong",[a._v("Decis√£o da autoridade:")]),a._v(" 10 dias √∫teis")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Art. 78, inciso II:")]),a._v(" Pr√©-qualifica√ß√£o como procedimento auxiliar")]),t("li",[t("strong",[a._v("Art. 80:")]),a._v(" Regulamenta√ß√£o espec√≠fica da pr√©-qualifica√ß√£o permanente")]),t("li",[t("strong",[a._v("Art. 41, inciso II:")]),a._v(" Possibilidade de exigir marcas espec√≠ficas")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"workflow"},[t("div",{staticClass:"step"},[a._v("Publica√ß√£o do Edital")]),t("div",{staticClass:"step"},[a._v("An√°lise T√©cnica (10 dias)")]),t("div",{staticClass:"step"},[a._v("Julgamento CCL")]),t("div",{staticClass:"step"},[a._v("Emiss√£o da DCB")]),t("div",{staticClass:"step"},[a._v("Inclus√£o no Cat√°logo")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Licita√ß√µes mais r√°pidas:")]),a._v(" Sem nova an√°lise t√©cnica")]),t("li",[t("strong",[a._v("Maior seguran√ßa:")]),a._v(" Produtos j√° certificados")]),t("li",[t("strong",[a._v("Padroniza√ß√£o:")]),a._v(" Cat√°logo institucional")]),t("li",[t("strong",[a._v("Qualidade garantida:")]),a._v(" Testes pr√©vios realizados")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"criterios-lei"},[t("div",{staticClass:"criterio-lei"},[t("strong",[a._v("üí∞ Menor Pre√ßo:")]),a._v(" Crit√©rio tradicional mantido ")]),t("div",{staticClass:"criterio-lei"},[t("strong",[a._v("üìà Maior Desconto:")]),a._v(" Novo crit√©rio para negocia√ß√µes ")]),t("div",{staticClass:"criterio-lei"},[t("strong",[a._v("üéØ Melhor T√©cnica:")]),a._v(" Foco na qualidade t√©cnica ")]),t("div",{staticClass:"criterio-lei"},[t("strong",[a._v("‚öñÔ∏è T√©cnica e Pre√ßo:")]),a._v(" Combina√ß√£o equilibrada ")]),t("div",{staticClass:"criterio-lei"},[t("strong",[a._v("üìà Maior Retorno Econ√¥mico:")]),a._v(" Novo - para concess√µes ")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Dimens√£o ambiental:")]),a._v(" Produtos ecol√≥gicos, menor impacto")]),t("li",[t("strong",[a._v("Dimens√£o social:")]),a._v(" Inclus√£o de grupos vulner√°veis")]),t("li",[t("strong",[a._v("Ciclo de vida:")]),a._v(" Custos durante toda a vida √∫til")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Portal Nacional (PNCP):")]),a._v(" Todas as licita√ß√µes obrigatoriamente")]),t("li",[t("strong",[a._v("Site oficial:")]),a._v(" Editais, resultados e contratos")]),t("li",[t("strong",[a._v("Di√°rio Oficial:")]),a._v(" Avisos e extratos")]),t("li",[t("strong",[a._v("Audi√™ncias p√∫blicas:")]),a._v(" Para projetos relevantes")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[t("strong",[a._v("Publica√ß√£o permanente")]),a._v(" no site oficial")]),t("li",[t("strong",[a._v("Acesso livre")]),a._v(" para consulta")]),t("li",[t("strong",[a._v("Atualiza√ß√£o autom√°tica")]),a._v(" com inclus√µes/exclus√µes")]),t("li",[t("strong",[a._v("Filtros por categoria")]),a._v(" para facilitar busca")])])},function(){var a=this,t=a._self._c;return t("ul",[t("li",[a._v("Maior "),t("strong",[a._v("controle social")])]),t("li",[t("strong",[a._v("Redu√ß√£o de questionamentos")])]),t("li",[t("strong",[a._v("Seguran√ßa jur√≠dica")]),a._v(" para gestores")]),t("li",[t("strong",[a._v("Facilita fiscaliza√ß√£o")]),a._v(" pelos √≥rg√£os de controle")])])}];class te{static async listarDocumentos(a={}){try{const t=await(0,R.EO)();if(!t)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");let o=R.ND.from("documentos_administrativos").select("\n          id,\n          titulo,\n          descricao,\n          categoria,\n          nome_arquivo,\n          tamanho_arquivo,\n          tipo_mime,\n          url_arquivo,\n          visibilidade,\n          status,\n          tags,\n          criado_em,\n          atualizado_em,\n          usuario_id\n        ").or(`tenant_id.eq.${t},tenant_id.is.null`).eq("status","ativo").order("criado_em",{ascending:!1});a.categoria&&(o=o.eq("categoria",a.categoria)),a.busca&&(o=o.or(`titulo.ilike.%${a.busca}%,descricao.ilike.%${a.busca}%`)),a.tags&&a.tags.length>0&&(o=o.overlaps("tags",a.tags));const{data:e,error:i}=await o;if(i)throw console.error("Erro ao listar documentos:",i),i;return e||[]}catch(t){throw console.error("Erro no servi√ßo de documentos:",t),t}}static async obterDocumento(a){try{const t=await(0,R.EO)();if(!t)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const{data:o,error:e}=await R.ND.from("documentos_administrativos").select("*").eq("id",a).eq("tenant_id",t).single();if(e)throw console.error("Erro ao obter documento:",e),e;return o}catch(t){throw console.error("Erro no servi√ßo de documentos:",t),t}}static async criarDocumento(a){try{const t=await(0,R.EO)(),{data:o}=await R.ND.auth.getSession(),e=o?.session?.user;if(!t||!e)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const i={...a,tenant_id:t,usuario_id:e.id,status:"ativo"},{data:s,error:r}=await R.ND.from("documentos_administrativos").insert(i).select().single();if(r)throw console.error("Erro ao criar documento:",r),r;return s}catch(t){throw console.error("Erro no servi√ßo de documentos:",t),t}}static async atualizarDocumento(a,t){try{const o=await(0,R.EO)();if(!o)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const{data:e,error:i}=await R.ND.from("documentos_administrativos").update(t).eq("id",a).eq("tenant_id",o).select().single();if(i)throw console.error("Erro ao atualizar documento:",i),i;return e}catch(o){throw console.error("Erro no servi√ßo de documentos:",o),o}}static async excluirDocumento(a){try{const t=await(0,R.EO)();if(!t)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const{data:o,error:e}=await R.ND.from("documentos_administrativos").update({status:"arquivado"}).eq("id",a).eq("tenant_id",t).select().single();if(e)throw console.error("Erro ao excluir documento:",e),e;return o}catch(t){throw console.error("Erro no servi√ßo de documentos:",t),t}}static async uploadArquivo(a,t="documentos"){try{const o=await(0,R.EO)();if(!o)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const e=Date.now(),i=`${e}_${a.name}`,s=`${o}/${t}/${i}`,{data:r,error:n}=await R.ND.storage.from("documentos-administrativos").upload(s,a,{cacheControl:"3600",upsert:!1});if(n)throw console.error("Erro no upload:",n),n;const{data:l}=R.ND.storage.from("documentos-administrativos").getPublicUrl(s);return{path:r.path,url:l.publicUrl,nome_original:a.name,tamanho:a.size,tipo_mime:a.type}}catch(o){throw console.error("Erro no upload de arquivo:",o),o}}static async baixarArquivo(a){try{if(!a)throw new Error("URL do arquivo n√£o fornecida");if(a.includes("supabase")){const t=await fetch(a);if(!t.ok)throw new Error("Erro ao baixar arquivo");return t.blob()}const t=await fetch(a);if(!t.ok)throw new Error("Erro ao baixar arquivo");return t.blob()}catch(t){throw console.error("Erro ao baixar arquivo:",t),t}}static async buscarDocumentos(a,t={}){try{const o=await(0,R.EO)();if(!o)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");let e=R.ND.from("documentos_administrativos").select("*").or(`tenant_id.eq.${o},tenant_id.is.null`).eq("status","ativo");a&&(e=e.or(`titulo.ilike.%${a}%,descricao.ilike.%${a}%`)),t.categoria&&(e=e.eq("categoria",t.categoria)),t.visibilidade&&(e=e.eq("visibilidade",t.visibilidade)),t.dataInicio&&(e=e.gte("criado_em",t.dataInicio)),t.dataFim&&(e=e.lte("criado_em",t.dataFim)),e=e.order("criado_em",{ascending:!1});const{data:i,error:s}=await e;if(s)throw console.error("Erro na busca:",s),s;return i||[]}catch(o){throw console.error("Erro no servi√ßo de busca:",o),o}}static async obterEstatisticas(){try{const a=await(0,R.EO)();if(!a)throw new Error("Usu√°rio n√£o autenticado ou sem tenant");const{data:t,error:o}=await R.ND.from("documentos_administrativos").select("categoria").or(`tenant_id.eq.${a},tenant_id.is.null`).eq("status","ativo");if(o)throw o;const e=t.length,i=t.reduce(((a,t)=>(a[t.categoria]=(a[t.categoria]||0)+1,a)),{}),s=new Date;s.setDate(s.getDate()-7);const{data:r,error:n}=await R.ND.from("documentos_administrativos").select("id").or(`tenant_id.eq.${a},tenant_id.is.null`).eq("status","ativo").gte("criado_em",s.toISOString());if(n)throw n;return{total:e,categorias:i,recentes:r.length}}catch(a){throw console.error("Erro ao obter estat√≠sticas:",a),a}}static formatarTamanhoArquivo(a){if(0===a)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(a)/Math.log(t));return parseFloat((a/Math.pow(t,e)).toFixed(2))+" "+o[e]}static obterIconeCategoria(a){const t={manual:"üìñ",template:"üìÑ",instrucao:"üìã",normativa:"‚öñÔ∏è",formulario:"üìù"};return t[a]||"üìÑ"}static obterNomeCategoria(a){const t={manual:"Manual",template:"Template",instrucao:"Instru√ß√£o",normativa:"Normativa",formulario:"Formul√°rio"};return t[a]||a}static validarArquivo(a){const t=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"],o=10485760;if(!t.includes(a.type))throw new Error("Tipo de arquivo n√£o permitido. Use PDF, DOC, DOCX, XLS, XLSX ou TXT.");if(a.size>o)throw new Error("Arquivo muito grande. Tamanho m√°ximo: 10MB.");return!0}}const oe=te,ee={name:"ProcessosAdministrativosComponent",data(){return{documentos:[],documentosFiltrados:[],carregando:!0,filtroCategoria:"",termoBusca:"",filtroPeriodo:"",ordenacao:"data_desc",visualizacao:"grid",secaoAtiva:0,secaoLeiAtiva:0,leiSections:[{icone:"üéØ",titulo:"O que Mudou"},{icone:"üìã",titulo:"Modalidades"},{icone:"‚è∞",titulo:"Prazos"},{icone:"üéØ",titulo:"Pr√©-qualifica√ß√£o"},{icone:"üìä",titulo:"Crit√©rios"},{icone:"üîç",titulo:"Transpar√™ncia"}],manuaisSections:[{icone:"üéØ",titulo:"O que √© o Sistema"},{icone:"üìä",titulo:"Dashboard CPM"},{icone:"‚öñÔ∏è",titulo:"Dashboard CCL"},{icone:"üìù",titulo:"DCB"},{icone:"üìä",titulo:"RDM"},{icone:"üìö",titulo:"Cat√°logo"}],modalUploadAberto:!1,enviandoUpload:!1,documentoSelecionado:null,novoDocumento:{titulo:"",descricao:"",categoria:"",arquivo:null},podeUpload:!0,podeEditar:!0}},async mounted(){await this.carregarDocumentos()},methods:{async carregarDocumentos(){try{this.carregando=!0,this.documentos=await oe.listarDocumentos(),this.filtrarDocumentos()}catch(a){console.error("Erro ao carregar documentos:",a),this.documentos=[],alert("Erro ao carregar documentos. Tente novamente.")}finally{this.carregando=!1}},async filtrarDocumentos(){try{const a={};this.filtroCategoria&&(a.categoria=this.filtroCategoria),this.termoBusca&&(a.busca=this.termoBusca),this.documentosFiltrados=await oe.buscarDocumentos(this.termoBusca,a)}catch(a){console.error("Erro ao filtrar documentos:",a);let t=[...this.documentos];if(this.filtroCategoria&&(t=t.filter((a=>a.categoria===this.filtroCategoria))),this.termoBusca){const a=this.termoBusca.toLowerCase();t=t.filter((t=>t.titulo.toLowerCase().includes(a)||t.descricao&&t.descricao.toLowerCase().includes(a)))}this.documentosFiltrados=t}},getIconeCategoria(a){return oe.obterIconeCategoria(a)},getNomeCategoria(a){return oe.obterNomeCategoria(a)},formatarData(a){return new Date(a).toLocaleDateString("pt-BR")},abrirModalUpload(){this.modalUploadAberto=!0,this.novoDocumento={titulo:"",descricao:"",categoria:"",arquivo:null}},fecharModalUpload(){this.modalUploadAberto=!1},selecionarArquivo(a){const t=a.target.files[0];if(t)try{oe.validarArquivo(t),this.novoDocumento.arquivo=t}catch(o){alert(o.message),a.target.value=""}},async uploadDocumento(){if(this.novoDocumento.arquivo)try{this.enviandoUpload=!0,oe.validarArquivo(this.novoDocumento.arquivo);const a=await oe.uploadArquivo(this.novoDocumento.arquivo);await oe.criarDocumento({titulo:this.novoDocumento.titulo,descricao:this.novoDocumento.descricao,categoria:this.novoDocumento.categoria,nome_arquivo:a.nome_original,tamanho_arquivo:a.tamanho,tipo_mime:a.tipo_mime,url_arquivo:a.url}),await this.carregarDocumentos(),this.fecharModalUpload(),alert("Documento enviado com sucesso!")}catch(a){console.error("Erro no upload:",a),alert(`Erro ao fazer upload: ${a.message}`)}finally{this.enviandoUpload=!1}else alert("Selecione um arquivo para fazer upload")},visualizarDocumento(a){this.documentoSelecionado=a},fecharVisualizacao(){this.documentoSelecionado=null},async baixarDocumento(a){try{if(!a.url_arquivo)return void alert("URL do arquivo n√£o dispon√≠vel");const t=await oe.baixarArquivo(a.url_arquivo),o=window.URL.createObjectURL(t),e=document.createElement("a");e.style.display="none",e.href=o,e.download=a.nome_arquivo||"documento",document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(o),document.body.removeChild(e)}catch(t){console.error("Erro no download:",t),alert(`Erro ao baixar arquivo: ${t.message}`)}},async editarDocumento(a){const t=prompt("Novo t√≠tulo:",a.titulo);if(t&&t!==a.titulo)try{await oe.atualizarDocumento(a.id,{titulo:t}),await this.carregarDocumentos(),alert("Documento atualizado com sucesso!")}catch(o){console.error("Erro ao editar:",o),alert(`Erro ao editar documento: ${o.message}`)}},formatarTamanho(a){if(!a)return"N/A";const t=["Bytes","KB","MB","GB"];if(0===a)return"0 Bytes";const o=parseInt(Math.floor(Math.log(a)/Math.log(1024)));return Math.round(a/Math.pow(1024,o)*100)/100+" "+t[o]},compartilharDocumento(a){const t=`${window.location.origin}/processos-administrativos?doc=${a.id}`;navigator.clipboard.writeText(t).then((()=>{alert("Link copiado para a √°rea de transfer√™ncia!")})).catch((()=>{prompt("Link para compartilhar:",t)}))},visualizarDocumento(a){this.documentoSelecionado=a,this.secaoAtiva=0,this.secaoLeiAtiva=0}}},ie=ee;var se=(0,C.A)(ie,Zo,ae,!1,null,"4f004feb",null);const re=se.exports,ne={name:"ProcessosAdministrativos",components:{ProcessosAdministrativosComponent:re},data(){return{nomeUsuario:"",emailUsuario:"",dropdownOpen:!1}},async mounted(){await this.verificarAutenticacao(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async verificarAutenticacao(){try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;if(!t)return void this.$router.push("/");this.nomeUsuario=t.user_metadata?.nome||t.email?.split("@")[0]||"Usu√°rio",this.emailUsuario=t.email||""}catch(a){console.error("Erro na verifica√ß√£o de autentica√ß√£o:",a),this.$router.push("/")}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){const t=this.$el?.querySelector(".profile-dropdown");t&&!t.contains(a.target)&&(this.dropdownOpen=!1)},abrirConfiguracaoEmail(){alert("Configura√ß√£o de email em desenvolvimento"),this.dropdownOpen=!1},async logout(){try{await R.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.dropdownOpen=!1}}},le=ne;var ce=(0,C.A)(le,Wo,Xo,!1,null,"9b9978f0",null);const de=ce.exports;e.Ay.use(A.Ay);const ue=[{path:"/",name:"Home",component:q,meta:{requiresAuth:!1}},{path:"/dashboard",name:"Dashboard",component:Ba,meta:{requiresAuth:!0}},{path:"/ccl",name:"CCL",component:no,meta:{requiresAuth:!0}},{path:"/cadastro",name:"Cadastro",component:Za,meta:{requiresAuth:!0}},{path:"/analise/:id",name:"Analise",component:mt,meta:{requiresAuth:!0}},{path:"/catalogo",name:"Catalogo",component:xt,meta:{requiresAuth:!0}},{path:"/feedback",name:"Feedback",component:zt,meta:{requiresAuth:!0}},{path:"/dcb",name:"DCB",component:Yt,meta:{requiresAuth:!0}},{path:"/classificacao",name:"Classificacao",component:Io,meta:{requiresAuth:!0}},{path:"/produtos/:id",name:"DetalheProduto",component:()=>o.e(961).then(o.bind(o,9961)),props:!0,meta:{requiresAuth:!0}},{path:"/validar-dcb/:numero/:ano",name:"ValidarDCB",component:()=>o.e(796).then(o.bind(o,1796)),props:!0,meta:{requiresAuth:!1}},{path:"/rdm",name:"LoginRDM",component:Oo,meta:{requiresAuth:!1}},{path:"/dashboard-rdm",name:"DashboardRDM",component:jo,meta:{requiresAuth:!1}},{path:"/pesquisa-tecnica",name:"PesquisaTecnica",component:Ko,meta:{requiresAuth:!0}},{path:"/processos-administrativos",name:"ProcessosAdministrativos",component:de,meta:{requiresAuth:!0}},{path:"/catalogo-publico",name:"CatalogoPublico",component:()=>o.e(7).then(o.bind(o,1007)),meta:{requiresAuth:!1}}],me=new A.Ay({mode:"hash",base:"/ComprarBem/",routes:ue});me.beforeEach((async(a,t,o)=>{const e=a.matched.some((a=>a.meta.requiresAuth));if(e)try{const{data:a}=await R.ND.auth.getSession(),t=a?.session?.user;e&&!t?o("/"):o()}catch(i){console.error("Erro na verifica√ß√£o de autentica√ß√£o:",i),e?o("/"):o()}else o()}));const pe=me;var ve=o(3518);e.Ay.use(ve.Ay);const ge=new ve.Ay.Store({state:{user:null,tenant:null,isLoading:!1},mutations:{SET_USER(a,t){a.user=t},SET_TENANT(a,t){a.tenant=t},SET_LOADING(a,t){a.isLoading=t}},actions:{async fetchUser({commit:a}){const{data:t}=await R.ND.auth.getSession(),o=t?.session?.user;if(a("SET_USER",o),o){const{data:t,error:e}=await R.ND.from("tenants").select("*").eq("id",o.user_metadata?.tenant_id).single();!e&&t&&a("SET_TENANT",t)}},setLoading({commit:a},t){a("SET_LOADING",t)}},getters:{isAuthenticated:a=>!!a.user,currentUser:a=>a.user,currentTenant:a=>a.tenant,isLoading:a=>a.isLoading}});var _e=o(5329),fe=o(5170),he=o.n(fe);e.Ay.config.productionTip=!1,e.Ay.use(_e.A),e.Ay.use(he()),new e.Ay({router:pe,store:ge,render:a=>a(y),mounted(){console.log("üöÄ Sistema Comprar Bem carregado - Notifica√ß√µes autom√°ticas via GitHub Actions")}}).$mount("#app")}},t={};function o(e){var i=t[e];if(void 0!==i)return i.exports;var s=t[e]={exports:{}};return a[e].call(s.exports,s,s.exports,o),s.exports}o.m=a,(()=>{var a=[];o.O=(t,e,i,s)=>{if(!e){var r=1/0;for(d=0;d<a.length;d++){for(var[e,i,s]=a[d],n=!0,l=0;l<e.length;l++)(!1&s||r>=s)&&Object.keys(o.O).every((a=>o.O[a](e[l])))?e.splice(l--,1):(n=!1,s<r&&(r=s));if(n){a.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=a.length;d>0&&a[d-1][2]>s;d--)a[d]=a[d-1];a[d]=[e,i,s]}})(),(()=>{o.n=a=>{var t=a&&a.__esModule?()=>a["default"]:()=>a;return o.d(t,{a:t}),t}})(),(()=>{var a,t=Object.getPrototypeOf?a=>Object.getPrototypeOf(a):a=>a.__proto__;o.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"===typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"===typeof e.then)return e}var s=Object.create(null);o.r(s);var r={};a=a||[null,t({}),t([]),t(t)];for(var n=2&i&&e;"object"==typeof n&&!~a.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach((a=>r[a]=()=>e[a]));return r["default"]=()=>e,o.d(s,r),s}})(),(()=>{o.d=(a,t)=>{for(var e in t)o.o(t,e)&&!o.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:t[e]})}})(),(()=>{o.f={},o.e=a=>Promise.all(Object.keys(o.f).reduce(((t,e)=>(o.f[e](a,t),t)),[]))})(),(()=>{o.u=a=>"js/"+a+"."+{7:"0f9a787e",125:"68e8c682",130:"c618e48a",208:"cf96592d",236:"61137d7b",353:"7ac320c4",420:"79143310",796:"1a849ad2",828:"e23f50db",913:"df2f916f",961:"e469db0d",967:"4f017123"}[a]+".js"})(),(()=>{o.miniCssF=a=>"css/"+a+"."+{7:"028ee46d",796:"71a35ed3",961:"401b363e"}[a]+".css"})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()})(),(()=>{o.o=(a,t)=>Object.prototype.hasOwnProperty.call(a,t)})(),(()=>{var a={},t="comprar-bem:";o.l=(e,i,s,r)=>{if(a[e])a[e].push(i);else{var n,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==t+s){n=u;break}}n||(l=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,o.nc&&n.setAttribute("nonce",o.nc),n.setAttribute("data-webpack",t+s),n.src=e),a[e]=[i];var m=(t,o)=>{n.onerror=n.onload=null,clearTimeout(p);var i=a[e];if(delete a[e],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((a=>a(o))),t)return t(o)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=m.bind(null,n.onerror),n.onload=m.bind(null,n.onload),l&&document.head.appendChild(n)}}})(),(()=>{o.r=a=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}})(),(()=>{o.p="/ComprarBem/"})(),(()=>{if("undefined"!==typeof document){var a=(a,t,e,i,s)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",o.nc&&(r.nonce=o.nc);var n=o=>{if(r.onerror=r.onload=null,"load"===o.type)i();else{var e=o&&o.type,n=o&&o.target&&o.target.href||t,l=new Error("Loading CSS chunk "+a+" failed.\n("+e+": "+n+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=e,l.request=n,r.parentNode&&r.parentNode.removeChild(r),s(l)}};return r.onerror=r.onload=n,r.href=t,e?e.parentNode.insertBefore(r,e.nextSibling):document.head.appendChild(r),r},t=(a,t)=>{for(var o=document.getElementsByTagName("link"),e=0;e<o.length;e++){var i=o[e],s=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(s===a||s===t))return i}var r=document.getElementsByTagName("style");for(e=0;e<r.length;e++){i=r[e],s=i.getAttribute("data-href");if(s===a||s===t)return i}},e=e=>new Promise(((i,s)=>{var r=o.miniCssF(e),n=o.p+r;if(t(r,n))return i();a(e,n,null,i,s)})),i={524:0};o.f.miniCss=(a,t)=>{var o={7:1,796:1,961:1};i[a]?t.push(i[a]):0!==i[a]&&o[a]&&t.push(i[a]=e(a).then((()=>{i[a]=0}),(t=>{throw delete i[a],t})))}}})(),(()=>{var a={524:0};o.f.j=(t,e)=>{var i=o.o(a,t)?a[t]:void 0;if(0!==i)if(i)e.push(i[2]);else{var s=new Promise(((o,e)=>i=a[t]=[o,e]));e.push(i[2]=s);var r=o.p+o.u(t),n=new Error,l=e=>{if(o.o(a,t)&&(i=a[t],0!==i&&(a[t]=void 0),i)){var s=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;n.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",n.name="ChunkLoadError",n.type=s,n.request=r,i[1](n)}};o.l(r,l,"chunk-"+t,t)}},o.O.j=t=>0===a[t];var t=(t,e)=>{var i,s,[r,n,l]=e,c=0;if(r.some((t=>0!==a[t]))){for(i in n)o.o(n,i)&&(o.m[i]=n[i]);if(l)var d=l(o)}for(t&&t(e);c<r.length;c++)s=r[c],o.o(a,s)&&a[s]&&a[s][0](),a[s]=0;return o.O(d)},e=self["webpackChunkcomprar_bem"]=self["webpackChunkcomprar_bem"]||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))})();var e=o.O(void 0,[504],(()=>o(3608)));e=o.O(e)})();
//# sourceMappingURL=app.503f383a.js.map