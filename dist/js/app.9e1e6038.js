(()=>{"use strict";var a={452:(a,o,t)=>{t.d(o,{EO:()=>n,ND:()=>r});var e=t(9119);const s="https://ruagsbbczuwgfflgcaol.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1YWdzYmJjenV3Z2ZmbGdjYW9sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0Njg5MDQsImV4cCI6MjA2MDA0NDkwNH0.S2KD6-9DpBYAOsodjibI7LGa04CspZZ5OdRQagNjoK8",r=(0,e.UU)(s,i),n=async()=>{const{data:a}=await r.auth.getSession(),o=a?.session?.user;return o?.user_metadata?.tenant_id||null}},563:(a,o,t)=>{t.d(o,{A:()=>i});var e=t(452);class s{static PERFIS={CPM:"cpm",CCL:"ccl",ORGAO_ADMINISTRATIVO:"orgao_administrativo",ASSESSORIA_JURIDICA:"assessoria_juridica"};static PERFIS_INFO={[this.PERFIS.CPM]:{nome:"CPM - ComissÃ£o Permanente de PadronizaÃ§Ã£o",descricao:"Acesso completo exceto Painel CCL",cor:"blue",icone:"ğŸ”§"},[this.PERFIS.CCL]:{nome:"CCL - ComissÃ£o de ContrataÃ§Ã£o e LicitaÃ§Ã£o",descricao:"Acesso exclusivo ao Painel CCL",cor:"green",icone:"âš–ï¸"},[this.PERFIS.ORGAO_ADMINISTRATIVO]:{nome:"Ã“rgÃ£o Administrativo",descricao:"Processos para assinatura e homologaÃ§Ã£o",cor:"purple",icone:"ğŸ“‹"},[this.PERFIS.ASSESSORIA_JURIDICA]:{nome:"Assessoria JurÃ­dica",descricao:"AnÃ¡lise jurÃ­dica de processos",cor:"orange",icone:"âš–ï¸"}};static async obterPerfilUsuarioAtual(){try{const{data:a}=await e.ND.auth.getSession(),o=a?.session?.user;if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado");const{data:t,error:s}=await e.ND.from("vw_usuarios_perfis").select("*").eq("id",o.id).single();if(s)throw console.error("Erro ao obter perfil do usuÃ¡rio:",s),s;return console.log("ğŸ” DEBUG - Perfil do usuÃ¡rio atual retornado:",t),t}catch(a){throw console.error("Erro no serviÃ§o de perfil:",a),a}}static async verificarAcessoModulo(a,o=null){try{const{data:t}=await e.ND.auth.getSession(),s=t?.session?.user;if(!s)return!1;const{data:i,error:r}=await e.ND.rpc("verificar_permissao_usuario",{p_user_id:s.id,p_modulo:a,p_acao:o});return r?(console.error("Erro ao verificar permissÃ£o:",r),!1):i}catch(t){return console.error("Erro ao verificar acesso:",t),!1}}static async obterModulosPermitidos(){try{const{data:a}=await e.ND.auth.getSession(),o=a?.session?.user;if(!o)return[];const{data:t,error:s}=await e.ND.rpc("obter_modulos_usuario",{p_user_id:o.id});return s?(console.error("Erro ao obter mÃ³dulos:",s),[]):t||[]}catch(a){return console.error("Erro ao obter mÃ³dulos:",a),[]}}static async atualizarPerfilUsuario(a,o){try{const t=await(0,e.EO)();if(!t)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:s,error:i}=await e.ND.rpc("atualizar_perfil_usuario",{p_user_id:a,p_novo_perfil:o});if(i)throw console.error("Erro ao atualizar perfil:",i),i;return s}catch(t){throw console.error("Erro no serviÃ§o de perfil:",t),t}}static async listarUsuariosPerfis(a={}){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");let t=e.ND.from("vw_usuarios_perfis").select("*").eq("tenant_id",o).order("nome");a.perfil&&(t=t.eq("perfil_usuario",a.perfil)),a.busca&&(t=t.or(`nome.ilike.%${a.busca}%,email.ilike.%${a.busca}%`));const{data:s,error:i}=await t;if(i)throw console.error("Erro ao listar usuÃ¡rios:",i),i;return s||[]}catch(o){throw console.error("Erro no serviÃ§o de usuÃ¡rios:",o),o}}static async isCPM(){const a=await this.obterPerfilUsuarioAtual();return a?.perfil_usuario===this.PERFIS.CPM}static async isCCL(){const a=await this.obterPerfilUsuarioAtual();return a?.perfil_usuario===this.PERFIS.CCL}static async isOrgaoAdministrativo(){const a=await this.obterPerfilUsuarioAtual();return a?.perfil_usuario===this.PERFIS.ORGAO_ADMINISTRATIVO}static async isAssessoriaJuridica(){const a=await this.obterPerfilUsuarioAtual();return a?.perfil_usuario===this.PERFIS.ASSESSORIA_JURIDICA}static async podeAcessarPainelCCL(){return await this.verificarAcessoModulo("painel_ccl")}static async podeCriarProcessos(){return await this.verificarAcessoModulo("processos","criar")}static async podeAssinarDigitalmente(){return await this.verificarAcessoModulo("processos","assinar_digital")||await this.verificarAcessoModulo("processos","assinar")}static async podeJulgarProcessos(){return await this.verificarAcessoModulo("processos","julgar")}static async podeHomologar(){return await this.verificarAcessoModulo("processos","homologar")}static async podeEmitirParecerJuridico(){return await this.verificarAcessoModulo("processos","emitir_parecer")}static obterInfoPerfil(a){return this.PERFIS_INFO[a]||{nome:"Perfil Desconhecido",descricao:"",cor:"gray",icone:"â“"}}static obterTodosPerfis(){return Object.entries(this.PERFIS_INFO).map((([a,o])=>({codigo:a,...o})))}static formatarPerfil(a){const o=this.obterInfoPerfil(a);return`${o.icone} ${o.nome}`}static isPerfilCompleto(a){return a===this.PERFIS.CPM}static isPerfilRestrito(a){return[this.PERFIS.CCL,this.PERFIS.ORGAO_ADMINISTRATIVO,this.PERFIS.ASSESSORIA_JURIDICA].includes(a)}static async obterRotasPermitidas(){const a=await this.obterModulosPermitidos(),o={dashboard:["/dashboard"],cadastro_produtos:["/produtos","/produtos/novo","/produtos/editar"],catalogo_marcas:["/marcas","/marcas/novo"],classificacao:["/classificacao"],dcb:["/dcb","/dcb/novo"],rdm:["/rdm","/feedback"],processos_administrativos:["/processos","/processos/novo"],painel_ccl:["/ccl","/ccl/processos"],processos_administrativos_admin:["/processos/administrativo"],processos_administrativos_juridico:["/processos/juridico"]},t=[];return a.forEach((a=>{o[a]&&t.push(...o[a])})),t}}const i=s},2045:(a,o,t)=>{t.r(o),t.d(o,{default:()=>i});var e=t(452);class s{async obterProximoNumero(a){try{const{data:o,error:t}=await e.ND.from("documentos_processo").select("numero_sequencial").eq("processo_id",a).order("numero_sequencial",{ascending:!1}).limit(1);if(t)throw t;let s=1;return o&&o.length>0&&(s=o[0].numero_sequencial+1),{numero:s,folha:this.formatarNumeroFolha(s)}}catch(o){throw console.error("Erro ao obter prÃ³ximo nÃºmero sequencial:",o),new Error("Erro ao gerar numeraÃ§Ã£o sequencial: "+o.message)}}async registrarDocumento(a){try{const{numero:o,folha:t}=await this.obterProximoNumero(a.processo_id),s={...a,numero_sequencial:o,folha_numero:t,data_criacao:(new Date).toISOString(),status:"ativo"};console.log("ğŸ” DEBUG registrarDocumento - dados completos para inserÃ§Ã£o:",s);const{data:i,error:r}=await e.ND.from("documentos_processo").insert(s).select().single();if(console.log("ğŸ” DEBUG registrarDocumento - resultado da inserÃ§Ã£o:",{documentoCriado:i,error:r}),r)throw console.error("âŒ DEBUG registrarDocumento - erro detalhado:",{message:r.message,details:r.details,hint:r.hint,code:r.code}),r;return console.log(`Documento criado: ${t} - ${a.nome_documento}`),i}catch(o){throw console.error("Erro ao registrar documento:",o),new Error("Erro ao registrar documento: "+o.message)}}async listarDocumentosProcesso(a){try{const{data:o,error:t}=await e.ND.from("documentos_processo").select("*").eq("processo_id",a).eq("status","ativo").order("numero_sequencial",{ascending:!0});if(t)throw t;return o||[]}catch(o){throw console.error("Erro ao listar documentos do processo:",o),new Error("Erro ao listar documentos: "+o.message)}}async atualizarDocumento(a,o){try{const{data:t,error:s}=await e.ND.from("documentos_processo").update({...o,data_atualizacao:(new Date).toISOString()}).eq("id",a).select().single();if(s)throw s;return t}catch(t){throw console.error("Erro ao atualizar documento:",t),new Error("Erro ao atualizar documento: "+t.message)}}async removerDocumento(a){try{const{error:o}=await e.ND.from("documentos_processo").update({status:"inativo",data_remocao:(new Date).toISOString()}).eq("id",a);if(o)throw o;console.log("Documento removido com sucesso")}catch(o){throw console.error("Erro ao remover documento:",o),new Error("Erro ao remover documento: "+o.message)}}async reordenarDocumentos(a){try{const o=await this.listarDocumentosProcesso(a);for(let a=0;a<o.length;a++){const t=a+1,s=this.formatarNumeroFolha(t);await e.ND.from("documentos_processo").update({numero_sequencial:t,folha_numero:s}).eq("id",o[a].id)}console.log("Documentos reordenados com sucesso")}catch(o){throw console.error("Erro ao reordenar documentos:",o),new Error("Erro ao reordenar documentos: "+o.message)}}async gerarRelatorioDocumentos(a){try{const o=await this.listarDocumentosProcesso(a),t={total_documentos:o.length,ultimo_numero:o.length>0?Math.max(...o.map((a=>a.numero_sequencial))):0,proxima_folha:this.formatarNumeroFolha((o.length>0?Math.max(...o.map((a=>a.numero_sequencial))):0)+1),tipos_documento:{},documentos_por_data:{},sequencia_completa:!0};o.forEach((a=>{t.tipos_documento[a.tipo_documento]=(t.tipos_documento[a.tipo_documento]||0)+1}));for(let a=1;a<=t.ultimo_numero;a++){const e=o.some((o=>o.numero_sequencial===a));e||(t.sequencia_completa=!1,t.lacunas=t.lacunas||[],t.lacunas.push(a))}return t}catch(o){throw console.error("Erro ao gerar relatÃ³rio:",o),new Error("Erro ao gerar relatÃ³rio: "+o.message)}}formatarNumeroFolha(a){return`Fl. ${a.toString().padStart(3,"0")}`}extrairNumeroSequencial(a){const o=a.match(/Fl\.\s*(\d+)/);return o?parseInt(o[1],10):0}async validarNumeracao(a){try{const o=await this.listarDocumentosProcesso(a),t=[],e=o.map((a=>a.numero_sequencial)),s=[...new Set(e)];e.length!==s.length&&t.push("Existem nÃºmeros duplicados na sequÃªncia");const i=Math.max(...e);for(let a=1;a<=i;a++)e.includes(a)||t.push(`Lacuna na sequÃªncia: Fl. ${a.toString().padStart(3,"0")} nÃ£o encontrada`);for(let a=1;a<o.length;a++){const e=o[a-1],s=o[a];new Date(e.data_criacao)>new Date(s.data_criacao)&&t.push(`Ordem cronolÃ³gica incorreta entre ${e.folha_numero} e ${s.folha_numero}`)}return{valida:0===t.length,problemas:t}}catch(o){return console.error("Erro ao validar numeraÃ§Ã£o:",o),{valida:!1,problemas:["Erro ao validar numeraÃ§Ã£o: "+o.message]}}}}const i=new s},3112:(a,o,t)=>{t.d(o,{A:()=>n});var e=t(452),s=t(365);const i={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};s.Ay.init(i.publicKey);class r{static ultimosEnvios=new Map;static obterTemplateEmail(a){const o={processo_tramitado:{assunto:"COMPRAR BEM: Processo #{numeroProcesso} requer sua atenÃ§Ã£o",template:'PROCESSO ADMINISTRATIVO - AÃ‡ÃƒO NECESSÃRIA\n\nOlÃ¡,\n\nVocÃª tem um processo administrativo que requer sua anÃ¡lise no sistema Comprar Bem.\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ DETALHES DO PROCESSO:\nâ€¢ Processo: #{numeroProcesso}\nâ€¢ Tipo: #{tipoProcesso}\nâ€¢ Status Atual: #{statusAtual}\nâ€¢ Ã“rgÃ£o: #{nomeOrgao}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nâš¡ AÃ‡ÃƒO NECESSÃRIA:\n#{acaoNecessaria}\n\nğŸ“ OBSERVAÃ‡Ã•ES:\n#{observacoes}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ”— COMO PROCEDER:\n1. Acesse o sistema Comprar Bem\n2. VÃ¡ para "Processos Administrativos"\n3. Localize o processo #{numeroProcesso}\n4. Execute a aÃ§Ã£o necessÃ¡ria\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSistema Comprar Bem\nCompras PÃºblicas Inteligentes\nData: #{dataAtual}\n\nEste Ã© um email automÃ¡tico do sistema. NÃ£o responda a este email.'},processo_pendente:{assunto:"Lembrete: Processo #{numeroProcesso} aguarda sua anÃ¡lise",template:"\n          <h2>â° Lembrete de Processo Pendente</h2>\n          <p>O processo <strong>#{numeroProcesso}</strong> estÃ¡ aguardando sua anÃ¡lise hÃ¡ #{diasPendente} dias.</p>\n          <p><strong>Status:</strong> #{statusAtual}</p>\n          <p><strong>Ã“rgÃ£o:</strong> #{nomeOrgao}</p>\n          <hr>\n          <p>Por favor, acesse o sistema para dar andamento ao processo.</p>\n          <p><em>Sistema Comprar Bem - Processos Administrativos</em></p>\n        "},processo_aprovado:{assunto:"Processo #{numeroProcesso} foi aprovado/homologado",template:"\n          <h2>âœ… Processo Aprovado/Homologado</h2>\n          <p>O processo <strong>#{numeroProcesso}</strong> foi aprovado com sucesso!</p>\n          <p><strong>Status Final:</strong> #{statusAtual}</p>\n          <p><strong>ResponsÃ¡vel:</strong> #{responsavelAprovacao}</p>\n          <hr>\n          <p>O processo foi finalizado e pode ser consultado no sistema.</p>\n          <p><em>Sistema Comprar Bem - Processos Administrativos</em></p>\n        "},processo_rejeitado:{assunto:"Processo #{numeroProcesso} foi rejeitado",template:"\n          <h2>âŒ Processo Rejeitado</h2>\n          <p>O processo <strong>#{numeroProcesso}</strong> foi rejeitado.</p>\n          <p><strong>Status:</strong> #{statusAtual}</p>\n          <p><strong>Motivo:</strong> #{observacoes}</p>\n          <hr>\n          <p>O processo foi devolvido para correÃ§Ãµes. Acesse o sistema para mais detalhes.</p>\n          <p><em>Sistema Comprar Bem - Processos Administrativos</em></p>\n        "},processo_devolvido:{assunto:"COMPRAR BEM: Processo #{numeroProcesso} foi devolvido para correÃ§Ã£o",template:'PROCESSO ADMINISTRATIVO - DEVOLVIDO PARA CORREÃ‡ÃƒO\n\nOlÃ¡,\n\nO processo administrativo #{numeroProcesso} foi devolvido para correÃ§Ã£o no sistema Comprar Bem.\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ DETALHES DO PROCESSO:\nâ€¢ Processo: #{numeroProcesso}\nâ€¢ Tipo: #{tipoProcesso}\nâ€¢ Status Atual: #{statusAtual}\nâ€¢ Ã“rgÃ£o: #{nomeOrgao}\nâ€¢ Objeto: #{objeto}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nâ†©ï¸ MOTIVO DA DEVOLUÃ‡ÃƒO:\n#{observacoes}\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“ AÃ‡ÃƒO NECESSÃRIA:\nCorrija os pontos mencionados no motivo da devoluÃ§Ã£o e reenvie o processo.\n\nğŸ”— COMO PROCEDER:\n1. Acesse o sistema Comprar Bem\n2. VÃ¡ para "Processos Administrativos"\n3. Localize o processo #{numeroProcesso}\n4. FaÃ§a as correÃ§Ãµes necessÃ¡rias\n5. Reenvie o processo para anÃ¡lise\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSistema Comprar Bem\nCompras PÃºblicas Inteligentes\nData: #{dataAtual}\n\nEste Ã© um email automÃ¡tico do sistema. NÃ£o responda a este email.'}};return o[a]||o["processo_tramitado"]}static async obterDestinatariosPorStatus(a,o){try{const t={rascunho:["cpm"],aguardando_aprovacao:["cpm"],criado_cpm:["cpm"],aguardando_assinatura_orgao:["orgao_administrativo"],assinado_admin:["ccl"],julgamento_ccl:["ccl"],aprovado_ccl:["assessoria_juridica"],aprovado_juridico:["orgao_administrativo"],edital_publicado:["orgao_administrativo"],homologado:["orgao_administrativo"],criado_cpm_desp:["cpm"],aguardando_assinatura_orgao_desp:["orgao_administrativo"],abertura_autorizada_desp:["ccl"],aviso_publicado:["ccl"],com_recurso_desp:["assessoria_juridica"],homologado_desp:["orgao_administrativo"],excluindo_marcas:["cpm"],rejeitado_cpm:["cpm"],rejeitado_admin:["cpm"],rejeitado_ccl:["cpm"],rejeitado_juridico:["cpm"],devolvido_pelo_orgao:["cpm"],devolvido_pela_ccl:["cpm"],devolvido_pelo_juridico:["cpm"],em_criacao:["cpm"],submetido_autoridade:["orgao_administrativo"],abertura_autorizada:["cpm"],edital_chamamento:["assessoria_juridica"],analise_juridica:["assessoria_juridica"],com_impugnacao:["assessoria_juridica"],recebendo_amostras:["cpm"],avaliacao_cpm:["cpm"],ata_ccl:["ccl"],publicacao_ata:["orgao_administrativo"],com_recurso:["assessoria_juridica"],expedindo_dcbs:["cpm"],incluindo_marcas:["cpm"],em_criacao_desp:["cpm"],submetido_autoridade_desp:["orgao_administrativo"],aviso_publicado_desp:["cpm"]},s=t[a]||[];if(0===s.length)return[];const{data:i,error:r}=await e.ND.from("usuarios").select("id, nome, email, perfil_usuario").eq("tenant_id",o).in("perfil_usuario",s).not("email","is",null);return r?(console.error("Erro ao buscar destinatÃ¡rios:",r),[]):i||[]}catch(t){return console.error("Erro ao obter destinatÃ¡rios:",t),[]}}static async enviarNotificacaoTramitacao(a,o,t,s=""){try{console.log("ğŸ”„ INICIANDO enviarNotificacaoTramitacao:",{processoId:a,statusAnterior:o,statusNovo:t});const i=`${a}-${o}-${t}`,r=Date.now(),n=this.ultimosEnvios.get(i);if(n&&r-n<1e4)return console.log(`âš ï¸ DUPLICAÃ‡ÃƒO EVITADA: Email jÃ¡ enviado hÃ¡ ${r-n}ms`),!1;if(this.ultimosEnvios.set(i,r),this.ultimosEnvios.size>100)for(const[a,o]of this.ultimosEnvios.entries())r-o>6e4&&this.ultimosEnvios.delete(a);const c=await(0,e.EO)();if(!c)throw new Error("Tenant nÃ£o identificado");const{data:l,error:d}=await e.ND.from("processos_administrativos").select("*").eq("id",a).eq("tenant_id",c).single();if(d||!l)return console.error("Erro ao obter processo:",d),!1;const u=await this.obterDestinatariosPorStatus(t,c);if(0===u.length)return console.log("Nenhum destinatÃ¡rio encontrado para o status:",t),!1;let m="processo_tramitado";"homologado"===t?m="processo_aprovado":t.includes("rejeitado")?m="processo_rejeitado":t.includes("devolvido_")&&(m="processo_devolvido");const p=this.obterTemplateEmail(m),v={numeroProcesso:l.numero_processo||"Sem nÃºmero",tipoProcesso:"padronizacao"===l.tipo_processo?"PadronizaÃ§Ã£o":"DespadronizaÃ§Ã£o",statusAtual:this.obterLabelStatus(t),nomeOrgao:l.nome_orgao||"Ã“rgÃ£o PÃºblico",objeto:l.objeto||l.descricao||"Objeto nÃ£o informado",observacoes:s||"Nenhuma observaÃ§Ã£o",acaoNecessaria:this.obterAcaoNecessaria(t),dataAtual:(new Date).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},g=[];for(const o of u){const e=this.substituirVariaveisTemplate(p.template,v),s=this.substituirVariaveisTemplate(p.assunto,v);await this.registrarNotificacao({processo_id:a,destinatario_id:o.id,tipo_notificacao:m,assunto:s,conteudo:e,status_processo:t,tenant_id:c}),g.push({destinatario:o.email,nome:o.nome,assunto:s,conteudo:e})}return console.log("ğŸ“§ Enviando notificaÃ§Ãµes REAIS via EmailJS:",g.length,"destinatÃ¡rios"),await this.enviarEmailsReais(g),!0}catch(i){return console.error("Erro ao enviar notificaÃ§Ã£o de tramitaÃ§Ã£o:",i),!1}}static async registrarNotificacao(a){try{const{data:o,error:t}=await e.ND.from("notificacoes_processo").insert({...a,enviado_em:(new Date).toISOString(),status_envio:"enviado"});return t&&console.error("Erro ao registrar notificaÃ§Ã£o:",t),o}catch(o){return console.error("Erro ao registrar notificaÃ§Ã£o:",o),null}}static substituirVariaveisTemplate(a,o){let t=a;return Object.keys(o).forEach((a=>{const e=new RegExp(`#{${a}}`,"g");t=t.replace(e,o[a]||"")})),t}static obterLabelStatus(a){const o={em_criacao:"Em CriaÃ§Ã£o",criado_cpm:"Criado pela CPM",submetido_autoridade:"Submetido Ã  Autoridade Competente",abertura_autorizada:"Abertura Autorizada",edital_chamamento:"Edital de Chamamento PÃºblico",analise_juridica:"Em AnÃ¡lise JurÃ­dica",edital_publicado:"Com Edital Publicado",com_impugnacao:"Com ImpugnaÃ§Ã£o ao Edital",recebendo_amostras:"Recebendo Amostras e DocumentaÃ§Ã£o",avaliacao_cpm:"Com AvaliaÃ§Ã£o e RelatÃ³rio da CPM",julgamento_ccl:"Submetido ao Julgamento da CCL",ata_ccl:"Ata de Julgamento da CCL",publicacao_ata:"PublicaÃ§Ã£o da Ata e Prazo Recursal",com_recurso:"Com Recurso Administrativo",homologado:"Com HomologaÃ§Ã£o",expedindo_dcbs:"Expedindo as DCBs",incluindo_marcas:"Incluindo Marcas no CatÃ¡logo",em_criacao_desp:"Em CriaÃ§Ã£o",criado_cpm_desp:"Criado pela CPM",submetido_autoridade_desp:"Submetido Ã  Autoridade Competente",abertura_autorizada_desp:"Abertura Autorizada",aviso_publicado_desp:"Com Aviso Publicado",com_recurso_desp:"Com Recurso Administrativo",homologado_desp:"Com HomologaÃ§Ã£o",excluindo_marcas:"Excluindo Marcas do CatÃ¡logo",devolvido_pelo_orgao:"Devolvido pelo Ã“rgÃ£o Administrativo",devolvido_pela_ccl:"Devolvido pela CCL",devolvido_pelo_juridico:"Devolvido pela Assessoria JurÃ­dica",rascunho:"Em CriaÃ§Ã£o",aguardando_aprovacao:"Aguardando AprovaÃ§Ã£o da CPM",aguardando_assinatura_orgao:"Submetido Ã  Autoridade Competente",assinado_admin:"Abertura Autorizada",aprovado_ccl:"Ata de Julgamento da CCL",aprovado_juridico:"Em AnÃ¡lise JurÃ­dica",aguardando_assinatura_orgao_desp:"Submetido Ã  Autoridade Competente",aviso_publicado:"Com Aviso Publicado",rejeitado_cpm:"Rejeitado pela CPM",rejeitado_admin:"Rejeitado pelo Ã“rgÃ£o",rejeitado_ccl:"Rejeitado pela CCL",rejeitado_juridico:"Rejeitado pela Assessoria JurÃ­dica",rejeitado_final:"Rejeitado Final"};return o[a]||a}static obterAcaoNecessaria(a){const o={aguardando_aprovacao:"Analisar o processo e aprovar ou rejeitar",criado_cpm:"Analisar e aprovar ou rejeitar o processo",aguardando_assinatura_orgao:"ASSINAR o processo administrativo para dar continuidade",aguardando_assinatura_orgao_desp:"AUTORIZAR a abertura do processo de despadronizaÃ§Ã£o",aprovado_cpm:"ASSINAR o processo para envio Ã  CCL ou JurÃ­dico",assinado_admin:"Processo assinado - enviar para julgamento da CCL",julgamento_ccl:"JULGAR o processo tÃ©cnico (aprovar ou reprovar)",aprovado_ccl:"HOMOLOGAR o processo aprovado pela CCL",aprovado_juridico:"HOMOLOGAR o processo aprovado pelo JurÃ­dico",abertura_autorizada_desp:"Publicar aviso de despadronizaÃ§Ã£o",aviso_publicado:"Aguardar prazo recursal ou prosseguir",com_recurso_desp:"ANALISAR os recursos administrativos apresentados",homologado:"Processo concluÃ­do - verificar documentaÃ§Ã£o final",homologado_desp:"Executar exclusÃ£o das marcas do catÃ¡logo",excluindo_marcas:"Finalizar exclusÃ£o das marcas despadronizadas",rejeitado_cpm:"CORRIGIR os problemas apontados pela CPM e reenviar",rejeitado_admin:"CORRIGIR os problemas apontados pelo Ã“rgÃ£o e reenviar",rejeitado_ccl:"CORRIGIR os problemas apontados pela CCL e reenviar",rejeitado_juridico:"CORRIGIR os problemas jurÃ­dicos apontados e reenviar"};return o[a]||"Consultar detalhes no sistema e tomar aÃ§Ã£o necessÃ¡ria"}static async testarBuscaUsuariosPorPerfil(a="aprovado_cpm"){try{const o=await(0,e.EO)();console.log("ğŸ” TESTE: Buscando usuÃ¡rios para status:",a),console.log("ğŸ¢ Tenant ID:",o);const t=await this.obterDestinatariosPorStatus(a,o);return console.log("ğŸ‘¥ USUÃRIOS ENCONTRADOS:"),console.log("========================"),t.forEach((a=>{console.log(`ğŸ“§ ${a.nome} (${a.email}) - Perfil: ${a.perfil_usuario}`)})),0===t.length&&(console.log("âš ï¸ NENHUM USUÃRIO ENCONTRADO para o status:",a),console.log("Verifique se existem usuÃ¡rios com os perfis necessÃ¡rios no tenant.")),t}catch(o){return console.error("âŒ Erro no teste:",o),[]}}static async listarTodosUsuarios(){try{const a=await(0,e.EO)();console.log("ğŸ” LISTANDO TODOS OS USUÃRIOS DO TENANT:",a);const{data:o,error:t}=await e.ND.from("usuarios").select("*").eq("tenant_id",a).order("nome");return t?(console.error("Erro ao listar usuÃ¡rios:",t),[]):(console.log("ğŸ‘¥ USUÃRIOS NO SISTEMA:"),console.log("======================"),o.forEach((a=>{console.log(`ğŸ‘¤ ${a.nome} (${a.email||"SEM EMAIL"}) - Perfil: ${a.perfil_usuario}`)})),o||[])}catch(a){return console.error("Erro ao listar usuÃ¡rios:",a),[]}}static async testarSistemaCompleto(){try{console.log("ğŸš€ INICIANDO TESTE COMPLETO DO SISTEMA DE TRAMITAÃ‡ÃƒO"),console.log(NaN),console.log("\n1ï¸âƒ£ VERIFICANDO USUÃRIOS NO BANCO...");const a=await this.listarTodosUsuarios();if(0===a.length)return console.log("âŒ NENHUM USUÃRIO ENCONTRADO!"),console.log("ğŸ”§ Verifique se existe ao menos um usuÃ¡rio com perfil_usuario preenchido"),!1;console.log("\n2ï¸âƒ£ TESTANDO BUSCA POR PERFIL...");const o=await this.testarBuscaUsuariosPorPerfil("aprovado_cpm");if(0===o.length)return console.log('âŒ NENHUM USUÃRIO COM PERFIL "orgao_administrativo" ENCONTRADO!'),console.log('ğŸ”§ Precisa ter ao menos um usuÃ¡rio com perfil_usuario = "orgao_administrativo"'),!1;console.log("\n3ï¸âƒ£ TESTANDO GERAÃ‡ÃƒO DE TEMPLATE...");this.obterTemplateEmail("processo_tramitado");console.log("âœ… Template gerado com sucesso!"),console.log("\n4ï¸âƒ£ SIMULANDO TRAMITAÃ‡ÃƒO COMPLETA...");const t={id:"TESTE-001",numero_processo:"PROCESSO-TESTE-001",tipo_processo:"padronizacao",nome_orgao:"MinistÃ©rio da SaÃºde - TESTE"},e=await this.enviarNotificacaoTramitacao(t.id,"criado_cpm","aprovado_cpm","Teste automatizado do sistema de tramitaÃ§Ã£o");return e?(console.log("âœ… TESTE COMPLETO REALIZADO COM SUCESSO!"),console.log('ğŸ“§ Verifique os emails dos usuÃ¡rios com perfil "orgao_administrativo"'),console.log("ğŸ‰ O sistema de tramitaÃ§Ã£o estÃ¡ funcionando!")):console.log("âŒ FALHA NO TESTE DE ENVIO DE EMAIL"),console.log("\nğŸ TESTE COMPLETO FINALIZADO!"),e}catch(a){return console.error("âŒ ERRO NO TESTE COMPLETO:",a),!1}}static async enviarEmailsReais(a){console.log("ğŸ“§ ENVIANDO EMAILS REAIS VIA EMAILJS:"),console.log("=====================================");let o=0,t=0;for(let r=0;r<a.length;r++){const n=a[r];try{console.log(`ğŸ“§ Enviando email ${r+1}/${a.length}:`),console.log(`Para: ${n.destinatario} (${n.nome})`),console.log(`Assunto: ${n.assunto}`);const e={numero_edital:"TRAMITACAO-PROCESSO",email_empresa:n.destinatario,message:n.conteudo,name:n.nome,email:"comprarbemteste@gmail.com",subject:n.assunto,status_participante:"tramitacao_processo",motivo_rejeicao:""},c=await s.Ay.send(i.serviceId,i.templateId,e,i.publicKey);200===c.status?(o++,console.log(`âœ… Email enviado com sucesso para ${n.nome}!`)):(t++,console.log(`âŒ Falha no envio para ${n.nome}. Status: ${c.status}`))}catch(e){t++,console.error(`âŒ Erro ao enviar para ${n.nome}:`,e)}r<a.length-1&&(console.log("â³ Aguardando 2 segundos antes do prÃ³ximo envio..."),await new Promise((a=>setTimeout(a,2e3))))}return console.log("ğŸ“Š RESULTADO DO ENVIO:"),console.log(`âœ… Sucessos: ${o}`),console.log(`âŒ Erros: ${t}`),console.log(`ğŸ“§ Total: ${a.length}`),{sucessos:o,erros:t,total:a.length}}static async verificarProcessosPendentes(){try{const a=await(0,e.EO)();if(!a)return;const o=new Date;o.setDate(o.getDate()-7);const{data:t,error:s}=await e.ND.from("processos_administrativos").select("*").eq("tenant_id",a).lt("atualizado_em",o.toISOString()).not("status","in","(homologado,rejeitado_final)");if(s)return void console.error("Erro ao buscar processos pendentes:",s);for(const e of t||[])await this.enviarLembretePendencia(e)}catch(a){console.error("Erro ao verificar processos pendentes:",a)}}static async enviarLembretePendencia(a){try{const o=Math.floor((new Date-new Date(a.atualizado_em))/864e5),t=this.obterTemplateEmail("processo_pendente"),e=await this.obterDestinatariosPorStatus(a.status,a.tenant_id);if(0===e.length)return;const s={numeroProcesso:a.numero_processo||"Sem nÃºmero",statusAtual:this.obterLabelStatus(a.status),nomeOrgao:a.nome_orgao,diasPendente:o.toString()};for(const i of e){const o=this.substituirVariaveisTemplate(t.template,s),e=this.substituirVariaveisTemplate(t.assunto,s);await this.registrarNotificacao({processo_id:a.id,destinatario_id:i.id,tipo_notificacao:"processo_pendente",assunto:e,conteudo:o,status_processo:a.status,tenant_id:a.tenant_id})}}catch(o){console.error("Erro ao enviar lembrete de pendÃªncia:",o)}}}const n=r},3405:(a,o,t)=>{t.d(o,{enviarEmailParticipanteStatus:()=>n,lY:()=>c});var e=t(452),s=t(365);const i={from:{email:"cpm@suaorganizacao.com.br",name:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"},provider:{apiKey:{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_API_KEY,apiUrl:"https://api.sendgrid.v3/mail/send"}},r={diligencia:{subject:"DiligÃªncia Solicitada - Produto em AnÃ¡lise",template:a=>`\n      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">\n        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center;">\n          <h1>ğŸ“‹ DiligÃªncia Solicitada</h1>\n          <p>ComissÃ£o de PadronizaÃ§Ã£o de Materiais</p>\n        </div>\n        \n        <div style="padding: 30px; background: #f8f9fa;">\n          <h2 style="color: #333;">Prezado(a) Fornecedor,</h2>\n          \n          <p>Foi solicitada uma <strong>diligÃªncia</strong> para o produto em anÃ¡lise:</p>\n          \n          <div style="background: white; padding: 20px; border-left: 4px solid #667eea; margin: 20px 0;">\n            <h3 style="color: #667eea; margin-top: 0;">ğŸ“¦ Dados do Produto:</h3>\n            <p><strong>Nome:</strong> ${a.produto.nome}</p>\n            <p><strong>Marca:</strong> ${a.produto.marca}</p>\n            <p><strong>Modelo:</strong> ${a.produto.modelo}</p>\n            <p><strong>Fabricante:</strong> ${a.produto.fabricante}</p>\n          </div>\n          \n          <div style="background: #fff3cd; padding: 20px; border-left: 4px solid #ffc107; margin: 20px 0;">\n            <h3 style="color: #856404; margin-top: 0;">âš ï¸ Tipo de DiligÃªncia:</h3>\n            <p><strong>${a.diligencia.tipo}</strong></p>\n            <p>${a.diligencia.descricao}</p>\n          </div>\n          \n          <div style="background: #f8d7da; padding: 20px; border-left: 4px solid #dc3545; margin: 20px 0;">\n            <h3 style="color: #721c24; margin-top: 0;">â° Prazo para Resposta:</h3>\n            <p><strong>${a.diligencia.prazo_dias} dias Ãºteis</strong></p>\n            <p><strong>Data Limite:</strong> ${new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR")}</p>\n          </div>\n          \n          <div style="background: #d4edda; padding: 20px; border-left: 4px solid #28a745; margin: 20px 0;">\n            <h3 style="color: #155724; margin-top: 0;">ğŸ“ InstruÃ§Ãµes:</h3>\n            <ul>\n              <li>Responda a esta diligÃªncia dentro do prazo estabelecido</li>\n              <li>Envie todos os documentos solicitados em formato PDF</li>\n              <li>Em caso de dÃºvidas, entre em contato conosco</li>\n              <li>O nÃ£o atendimento da diligÃªncia pode resultar na reprovaÃ§Ã£o do produto</li>\n            </ul>\n          </div>\n          \n          <div style="text-align: center; margin: 30px 0;">\n            <p style="color: #666;">Para responder esta diligÃªncia, entre em contato atravÃ©s do nosso sistema ou envie os documentos por email.</p>\n          </div>\n          \n          <hr style="border: none; border-top: 1px solid #ddd; margin: 30px 0;">\n          \n          <div style="color: #666; font-size: 12px;">\n            <p><strong>CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais</strong></p>\n            <p>Este Ã© um email automÃ¡tico. NÃ£o responda diretamente a este email.</p>\n            <p>Data de envio: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}</p>\n          </div>\n        </div>\n      </div>\n    `},participanteStatus:{subject:"{{titulo status}}",template:a=>`\nSUBJECT: ${"aprovado"===a.status?"âœ… APROVADO":"âŒ REJEITADO"} - Sua empresa foi ${"aprovado"===a.status?"aprovada":"rejeitada"} no Edital ${a.numero_edital}\n\nPrezado(a) ${a.representante_legal},\n\n${"aprovado"===a.status?"Ã‰ com grande satisfaÃ§Ã£o que informamos que sua empresa foi APROVADA para participar do processo de prÃ©-qualificaÃ§Ã£o!":"Informamos que sua empresa foi REJEITADA no processo de prÃ©-qualificaÃ§Ã£o."}\n\n=== DADOS DA EMPRESA ===\nRazÃ£o Social: ${a.razao_social}\nCNPJ: ${a.cnpj}\nRepresentante Legal: ${a.representante_legal}\nEmail: ${a.email_empresa}\nTelefone: ${a.telefone}\n\n=== DADOS DO EDITAL ===\nNÃºmero: ${a.numero_edital}\nDescriÃ§Ã£o: ${a.descricao_edital}\nData da DecisÃ£o: ${a.data_decisao}\nStatus: ${a.status.toUpperCase()}\n\n${"aprovado"===a.status?`=== PRÃ“XIMOS PASSOS ===\n1. DocumentaÃ§Ã£o TÃ©cnica: Envie os documentos tÃ©cnicos dos produtos conforme especificado no edital\n2. Amostras (se aplicÃ¡vel): Providencie as amostras fÃ­sicas quando solicitado\n3. AnÃ¡lise CPM: Aguarde a anÃ¡lise tÃ©cnica da ComissÃ£o de PadronizaÃ§Ã£o de Materiais\n4. EmissÃ£o DCB: ApÃ³s aprovaÃ§Ã£o tÃ©cnica, serÃ¡ emitido o DCB (DeclaraÃ§Ã£o de Conformidade de Bem)\n5. CatÃ¡logo EletrÃ´nico: Produtos aprovados entrarÃ£o no catÃ¡logo para licitaÃ§Ãµes\n\n=== INFORMAÃ‡Ã•ES IMPORTANTES ===\n- Esta aprovaÃ§Ã£o Ã© para participaÃ§Ã£o no processo, nÃ£o garante aprovaÃ§Ã£o final dos produtos\n- Todos os produtos passarÃ£o por anÃ¡lise tÃ©cnica rigorosa pela CPM\n- DocumentaÃ§Ã£o incompleta ou inadequada pode resultar em reprovaÃ§Ã£o\n- Mantenha seus dados atualizados em nosso sistema\n- Acompanhe o status atravÃ©s do nosso portal\n\n=== PRAZOS ===\nEnvio de DocumentaÃ§Ã£o: ${a.prazo_documentacao}\nAnÃ¡lise TÃ©cnica: AtÃ© 30 dias Ãºteis apÃ³s recebimento completo\nResultado Final: SerÃ¡ comunicado por email e sistema`:`=== MOTIVO DA REJEIÃ‡ÃƒO ===\n${a.motivo_rejeicao||"DocumentaÃ§Ã£o nÃ£o atende aos requisitos do edital"}\n\n=== COMO PROCEDER ===\n- Revise a documentaÃ§Ã£o enviada\n- Corrija os problemas identificados\n- VocÃª pode se candidatar novamente em editais futuros\n- Em caso de dÃºvidas, entre em contato conosco`}\n\n=== CONTATO ===\nEmail: ${a.email_suporte}\nTelefone: ${a.telefone_suporte}\nHorÃ¡rio: Segunda a Sexta, 8h Ã s 17h\n\n=== SISTEMA COMPRARBEM ===\nAcesse: ${a.link_sistema}\n\n${a.nome_organizacao}\nEmail: ${a.email_organizacao}\nTelefone: ${a.telefone_organizacao}\nEndereÃ§o: ${a.endereco_organizacao}\n\n---\nEste Ã© um email automÃ¡tico. NÃ£o responda diretamente a este email.\nEmail enviado em ${a.data_envio} Ã s ${a.hora_envio}\n    `}};async function n(a,o,t="aprovado",e=null){try{console.log(`ğŸ“§ Iniciando envio de email de ${t} para participante...`,a.email);const i={representante_legal:a.representante_legal,razao_social:a.razao_social,cnpj:a.cnpj,email_empresa:a.email,telefone:a.telefone||"NÃ£o informado",status:t,motivo_rejeicao:e,numero_edital:o.numero||"N/A",descricao_edital:o.descricao||"Edital de PrÃ©-QualificaÃ§Ã£o",data_decisao:(new Date).toLocaleDateString("pt-BR"),prazo_documentacao:"30 dias Ãºteis a partir desta data",link_sistema:window.location.origin,email_suporte:"comprarbemteste@gmail.com",telefone_suporte:"(61) 3315-2425",nome_organizacao:"MinistÃ©rio da SaÃºde",email_organizacao:"cpm@saude.gov.br",telefone_organizacao:"(61) 3315-2425",endereco_organizacao:"BrasÃ­lia - DF",data_envio:(new Date).toLocaleDateString("pt-BR"),hora_envio:(new Date).toLocaleTimeString("pt-BR")},n=r.participanteStatus.template(i),c="aprovado"===t?`âœ… APROVADO - Sua empresa foi aprovada no Edital ${i.numero_edital}`:`âŒ REJEITADO - Sua empresa foi rejeitada no Edital ${i.numero_edital}`,d={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"},u={numero_edital:i.numero_edital,email_empresa:i.email_empresa,message:n,name:i.representante_legal,email:i.email_suporte,subject:c,status_participante:t,motivo_rejeicao:e||""};console.log(`ğŸ“§ Enviando email de ${t} via EmailJS...`),console.log("ğŸ“§ Para:",i.email_empresa),console.log("ğŸ“§ Edital:",i.numero_edital),console.log("ğŸ“§ Subject:",c),console.log("ğŸ“§ Status:",t),console.log("ğŸ“§ Motivo RejeiÃ§Ã£o:",e),console.log("ğŸ“§ ParÃ¢metros EmailJS:",u);const m=await s.Ay.send(d.serviceId,d.templateId,u,d.publicKey);return console.log(`ğŸ‰ EMAIL DE ${t.toUpperCase()} ENVIADO COM SUCESSO!`,m),await l({tipo:`participante_${t}`,destinatario:a.email,assunto:c,participante_id:a.id,edital_id:o.id,status:"enviado"}),{sucesso:!0,mensagem:`Email de ${t} enviado com sucesso!`,destinatario:a.email}}catch(i){throw console.error(`âŒ Erro ao enviar email de ${t}:`,i),await l({tipo:`participante_${t}`,destinatario:a.email,assunto:`${"aprovado"===t?"âœ… APROVADO":"âŒ REJEITADO"} - Edital ${o.numero}`,participante_id:a.id,edital_id:o.id,status:"erro",erro:i.message}),new Error(`Falha ao enviar email de ${t}: `+i.message)}}async function c(a){try{console.log("ğŸ“§ Iniciando envio de email de diligÃªncia...",a);try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);o.emailRemetente&&(i.from.email=o.emailRemetente),o.nomeRemetente&&(i.from.name=o.nomeRemetente)}}catch(o){console.error("Erro ao carregar configuraÃ§Ãµes do usuÃ¡rio:",o)}if(!a.produto||!a.diligencia||!a.destinatario)throw new Error("Dados incompletos para envio do email");const c={personalizations:[{to:[{email:a.destinatario,name:a.produto.fabricante}]}],from:{email:i.from.email,name:i.from.name},subject:r.diligencia.subject,content:[{type:"text/html",value:r.diligencia.template(a)}]},{data:l,error:d}=await e.ND.from("emails_enviados").insert({tipo:"diligencia",destinatario:a.destinatario,assunto:r.diligencia.subject,produto_id:a.produto.id,diligencia_id:a.diligencia.id,status:"enviando",tentativas:1}).select().single();if(d&&console.error("âŒ Erro ao registrar log de email:",d),"sendgrid"==={NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_PROVIDER&&{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_SENDGRID_API_KEY){console.log("ğŸ“§ Enviando email via EmailJS (usando SendGrid configurado)...");try{const o={to_email:a.destinatario,fabricante:a.produto.fabricante,produto_nome:a.produto.nome,produto_marca:a.produto.marca,produto_modelo:a.produto.modelo,cnpj:a.produto.cnpj||"NÃ£o informado",tipo_diligencia:a.diligencia.tipo,descricao_diligencia:a.diligencia.descricao,prazo_dias:"30",data_limite:new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR"),data_envio:(new Date).toLocaleDateString("pt-BR")+" Ã s "+(new Date).toLocaleTimeString("pt-BR"),nome_responsavel:"William Martins",cargo_responsavel:"Analista CPM",email_responsavel:"comprarbemteste@gmail.com"};console.log("ğŸ“§ Enviando email via EmailJS..."),console.log("ğŸ“§ Dados preparados:",o);const i={serviceId:"service_7sv1naw",templateId:"template_vbp986f",publicKey:"DqGKMNJ87ch3qVxGv"};try{console.log("ğŸ“§ Enviando email REAL via EmailJS..."),console.log("ğŸ“§ ConfiguraÃ§Ã£o:",i),console.log("ğŸ“§ Dados:",o);const a=await s.Ay.send(i.serviceId,i.templateId,o,i.publicKey);console.log("ğŸ‰ EMAIL ENVIADO COM SUCESSO!",a)}catch(t){throw console.error("âŒ Erro no EmailJS:",t),t}return l&&await e.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString(),corpo:o.message}).eq("id",l.id),console.log("âœ… EMAIL PREPARADO COM SUCESSO!"),console.log("ğŸ“§ Para:",o.to_email),console.log("ğŸ“§ Assunto:",o.subject),{success:!0,message:"Email preparado com sucesso! (SendGrid configurado)",emailId:l?.id}}catch(n){return console.error("âŒ Erro ao preparar email:",n),l&&await e.ND.from("emails_enviados").update({status:"desenvolvimento",data_envio:(new Date).toISOString(),erro_detalhes:"Erro na preparaÃ§Ã£o do email"}).eq("id",l.id),{success:!0,message:"DiligÃªncia criada (modo desenvolvimento)",emailId:l?.id,development:!0}}}return console.log("ğŸ”„ Modo desenvolvimento - Simulando envio de email"),console.log("ğŸ“§ Email Data:",c),await new Promise((a=>setTimeout(a,1e3))),l&&await e.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString()}).eq("id",l.id),{success:!0,message:"Email enviado com sucesso (simulado)",emailId:l?.id}}catch(o){return console.error("âŒ Erro ao enviar email de diligÃªncia:",o),{success:!1,message:o.message||"Erro interno no envio do email",error:o}}}async function l(a){try{const{error:o}=await e.ND.from("emails_enviados").insert({tipo:a.tipo,destinatario:a.destinatario,assunto:a.assunto,participante_id:a.participante_id||null,edital_id:a.edital_id||null,produto_id:a.produto_id||null,diligencia_id:a.diligencia_id||null,status:a.status,erro:a.erro||null,tentativas:1,criado_em:(new Date).toISOString()});o?console.warn("âš ï¸ Erro ao registrar email no banco:",o):console.log("âœ… Email registrado no banco com sucesso")}catch(o){console.warn("âš ï¸ Falha ao registrar email no banco:",o)}}const d={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};s.Ay.init(d.publicKey)},3722:(a,o,t)=>{t.r(o),t.d(o,{default:()=>j});var e=function(){var a=this,o=a._self._c;return o("div",{staticClass:"processos-container"},[o("div",{staticClass:"content-wrapper"},[o("aside",{staticClass:"sidebar"},[o("div",{staticClass:"iniciar-processo-section"},[o("h3",[a._v("ğŸ›ï¸ Processos Administrativos")]),a._m(0),o("div",{staticClass:"botoes-principais"},[o("button",{staticClass:"btn-processo padronizacao",on:{click:function(o){return a.abrirAssistente("padronizacao")}}},[o("span",{staticClass:"icone"},[a._v("âœ…")]),a._m(1)]),o("button",{staticClass:"btn-processo despadronizacao",on:{click:function(o){return a.abrirAssistente("despadronizacao")}}},[o("span",{staticClass:"icone"},[a._v("âŒ")]),a._m(2)])])]),o("div",{staticClass:"filter-section"},[o("h3",[a._v("ğŸ” Filtros")]),o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ“ Tipo de Processo")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroTipo,expression:"filtroTipo"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.filtroTipo=o.target.multiple?t:t[0]},a.filtrarProcessos]}},[o("option",{attrs:{value:""}},[a._v("Todos os tipos")]),o("option",{attrs:{value:"padronizacao"}},[a._v("âœ… PadronizaÃ§Ã£o")]),o("option",{attrs:{value:"despadronizacao"}},[a._v("âŒ DespadronizaÃ§Ã£o")])])]),o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ“Š Status")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroStatus,expression:"filtroStatus"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.filtroStatus=o.target.multiple?t:t[0]},a.filtrarProcessos]}},[o("option",{attrs:{value:""}},[a._v("Todos os status")]),a._m(3),a._m(4),a._m(5)])]),o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ” Buscar Processos")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.termoBusca,expression:"termoBusca"}],staticClass:"search-input",attrs:{type:"text",placeholder:"NÃºmero do processo ou objeto..."},domProps:{value:a.termoBusca},on:{input:[function(o){o.target.composing||(a.termoBusca=o.target.value)},a.filtrarProcessos]}})]),o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ“Š Ordenar por")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.ordenacao,expression:"ordenacao"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.ordenacao=o.target.multiple?t:t[0]},a.filtrarProcessos]}},[o("option",{attrs:{value:"data_desc"}},[a._v("Mais recentes")]),o("option",{attrs:{value:"data_asc"}},[a._v("Mais antigos")]),o("option",{attrs:{value:"numero_asc"}},[a._v("NÃºmero (crescente)")]),o("option",{attrs:{value:"numero_desc"}},[a._v("NÃºmero (decrescente)")]),o("option",{attrs:{value:"status"}},[a._v("Por status")])])]),o("div",{staticClass:"stats-section"},[o("h4",[a._v("ğŸ“ˆ EstatÃ­sticas")]),o("div",{staticClass:"stats-item"},[o("span",{staticClass:"stats-label"},[a._v("Total:")]),o("span",{staticClass:"stats-value"},[a._v(a._s(a.processos.length))])]),o("div",{staticClass:"stats-item"},[o("span",{staticClass:"stats-label"},[a._v("Filtrados:")]),o("span",{staticClass:"stats-value"},[a._v(a._s(a.processosFiltrados.length))])]),a.estatisticas?o("div",{staticClass:"stats-item"},[o("span",{staticClass:"stats-label"},[a._v("Em andamento:")]),o("span",{staticClass:"stats-value"},[a._v(a._s(a.estatisticas.por_status?.analise_cppm||0))])]):a._e()])])]),o("section",{staticClass:"processos-section"},[o("div",{staticClass:"processos-header"},[o("h3",[a._v("Processos Administrativos ("+a._s(a.processosFiltrados.length)+")")]),o("div",{staticClass:"view-options"},[o("button",{class:{active:"grid"===a.visualizacao},on:{click:function(o){a.visualizacao="grid"}}},[a._v(" âŠ Grade ")]),o("button",{class:{active:"list"===a.visualizacao},on:{click:function(o){a.visualizacao="list"}}},[a._v(" â˜° Lista ")])])]),a.carregando?o("div",{staticClass:"loading"},[o("div",{staticClass:"spinner"}),o("p",[a._v("Carregando processos...")])]):0===a.processosFiltrados.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ›ï¸")]),o("h4",[a._v("Nenhum processo encontrado")]),o("p",[a._v("Inicie um novo processo ou ajuste os filtros de busca")]),o("button",{staticClass:"btn-primary",on:{click:function(o){return a.abrirAssistente()}}},[a._v(" ğŸ†• Iniciar Primeiro Processo ")])]):o("div",{staticClass:"processos-container",class:a.visualizacao},a._l(a.processosFiltrados,(function(t){return o("div",{key:t.id,staticClass:"processo-card",on:{click:function(o){return a.visualizarProcesso(t)}}},[o("div",{staticClass:"processo-header"},[o("div",{staticClass:"processo-numero"},[o("span",{staticClass:"numero"},[a._v(a._s(t.numero_processo))]),o("span",{staticClass:"tipo",class:t.tipo_processo},[a._v(" "+a._s(a.obterTipoProcesso(t.tipo_processo).icone)+" "+a._s(a.obterTipoProcesso(t.tipo_processo).label)+" ")])]),o("div",{staticClass:"processo-status"},[o("span",{staticClass:"status-badge",class:a.obterStatusProcesso(t.status).cor},[a._v(" "+a._s(a.obterStatusProcesso(t.status).label)+" ")])])]),o("div",{staticClass:"processo-info"},[o("h4",[a._v(a._s(t.nome_orgao))]),o("p",{staticClass:"interessado"},[a._v("Interessado: "+a._s(t.unidade_interessada))]),o("p",{staticClass:"objeto"},[a._v(a._s(t.objeto.substring(0,150))+"...")])]),o("div",{staticClass:"processo-meta"},[o("div",{staticClass:"meta-item"},[o("span",{staticClass:"meta-label"},[a._v("ğŸ“„ Documentos:")]),o("span",{staticClass:"meta-value"},[a._v(a._s(t.total_documentos||0))])]),o("div",{staticClass:"meta-item"},[o("span",{staticClass:"meta-label"},[a._v("ğŸ“… AutuaÃ§Ã£o:")]),o("span",{staticClass:"meta-value"},[a._v(a._s(a.formatarData(t.data_autuacao)))])]),t.total_produtos?o("div",{staticClass:"meta-item"},[o("span",{staticClass:"meta-label"},[a._v("ğŸ“¦ Produtos:")]),o("span",{staticClass:"meta-value"},[a._v(a._s(t.total_produtos))])]):a._e()]),o("div",{staticClass:"processo-actions"},[o("button",{staticClass:"btn-action primary",on:{click:function(o){return o.stopPropagation(),a.abrirProcesso(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]),a.podeEditarProcesso(t)?o("button",{staticClass:"btn-action",on:{click:function(o){return o.stopPropagation(),a.editarProcesso(t)}}},[a._v(" âœï¸ Editar ")]):a._e(),o("button",{staticClass:"btn-action",on:{click:function(o){return o.stopPropagation(),a.gerarRelatorio(t)}}},[a._v(" ğŸ“„ PDF ")]),"assinado_admin"===t.status&&"orgao_administrativo"===a.perfilUsuario?.toLowerCase()?o("div",{staticClass:"tramitar-reminder"},[o("div",{staticClass:"reminder-icon"},[a._v("âš–ï¸")]),a._m(6,!0)]):a._e()])])})),0)])]),a.mostrarAssistente?o("div",{staticClass:"modal-overlay assistente-overlay",on:{click:a.fecharAssistente}},[o("div",{staticClass:"modal assistente-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"assistente-header-modal"},[o("h3",[a._v("ğŸ¯ Assistente de Processo Administrativo")]),o("button",{staticClass:"btn-close",on:{click:a.fecharAssistente}},[a._v("Ã—")])]),o("div",{staticClass:"assistente-content"},[o("AssistenteProcesso",{attrs:{"processo-edicao":a.processoParaEditar,"modo-edicao":a.modoEdicao,"tipo-processo-inicial":a.tipoProcessoInicial},on:{"processo-criado":a.processoCriado,cancelar:a.fecharAssistente}})],1)])]):a._e(),a.processoSelecionado?o("div",{staticClass:"modal-overlay",on:{click:a.fecharVisualizacaoProcesso}},[o("div",{staticClass:"modal modal-large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("div",{staticClass:"processo-title-section"},[o("div",{staticClass:"processo-icon-large"},[a._v(" "+a._s(a.obterTipoProcesso(a.processoSelecionado.tipo_processo).icone)+" ")]),o("div",[o("h3",[a._v("Processo "+a._s(a.processoSelecionado.numero_processo))]),o("span",{staticClass:"processo-tipo-badge",class:a.processoSelecionado.tipo_processo},[a._v(" "+a._s(a.obterTipoProcesso(a.processoSelecionado.tipo_processo).label)+" ")]),o("span",{staticClass:"processo-status-badge",class:a.obterStatusProcesso(a.processoSelecionado.status).cor},[a._v(" "+a._s(a.obterStatusProcesso(a.processoSelecionado.status).label)+" ")])])]),o("button",{staticClass:"btn-close",on:{click:a.fecharVisualizacaoProcesso}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"processo-viewer-container"},[o("div",{staticClass:"processo-details-panel"},[o("h4",[a._v("ğŸ“‹ InformaÃ§Ãµes do Processo")]),o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ›ï¸ Ã“rgÃ£o:")]),o("p",[a._v(a._s(a.processoSelecionado.nome_orgao))])]),o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ‘¥ Interessado:")]),o("p",[a._v(a._s(a.processoSelecionado.unidade_interessada))])]),o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ“… Data de AutuaÃ§Ã£o:")]),o("span",[a._v(a._s(a.formatarData(a.processoSelecionado.data_autuacao)))])]),a.processoSelecionado.data_finalizacao?o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ Data de FinalizaÃ§Ã£o:")]),o("span",[a._v(a._s(a.formatarData(a.processoSelecionado.data_finalizacao)))])]):a._e(),o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ“„ Documentos:")]),o("span",[a._v(a._s(a.processoSelecionado.total_documentos||0))])]),a.processoSelecionado.total_produtos?o("div",{staticClass:"detail-item"},[o("strong",[a._v("ğŸ“¦ Produtos:")]),o("span",[a._v(a._s(a.processoSelecionado.total_produtos))])]):a._e(),o("div",{staticClass:"processo-actions-panel"},[o("div",{staticClass:"actions-grid"},[o("button",{staticClass:"action-btn action-btn-primary",on:{click:function(o){return a.gerarRelatorio(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("ğŸ“„")]),o("span",{staticClass:"btn-text"},[a._v("Gerar RelatÃ³rio PDF")])]),a.podeEnviarParaAnalise(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-success",on:{click:function(o){return a.enviarParaAnaliseAdministrativa(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("ğŸš€")]),o("span",{staticClass:"btn-text"},[a._v("Enviar para AnÃ¡lise")])]):a._e(),a.podeOrgaoAssinarDocumento(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-success",on:{click:function(o){return a.assinarEEnviarProcesso(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("âœï¸")]),o("span",{staticClass:"btn-text"},[a._v("Assinar e Enviar para CCL")])]):a._e(),a.podeDevolverParaCPM(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-warning",on:{click:function(o){return a.abrirModalDevolucao(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("â†©ï¸")]),o("span",{staticClass:"btn-text"},[a._v("Devolver para CPM")])]):a._e(),a.podeTramitarParaCCL(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-success",on:{click:function(o){return a.tramitarProcessoParaCCL(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("âš–ï¸")]),o("span",{staticClass:"btn-text"},[a._v(a._s(a.obterTextoBotaoTramitacao(a.processoSelecionado)))])]):a._e(),a.temAcaoTramitacaoEnviar(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-success",on:{click:function(o){return a.enviarParaProximaEtapa(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("ğŸš€")]),o("span",{staticClass:"btn-text"},[a._v("Enviar para PrÃ³xima Etapa")])]):a._e(),a.temAcaoTramitacaoDevolver(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-warning",on:{click:function(o){return a.abrirModalDevolucaoGenerica(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("â†©ï¸")]),o("span",{staticClass:"btn-text"},[a._v("Devolver para CorreÃ§Ã£o")])]):a._e(),a.podeReenviarProcesso(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-success",on:{click:function(o){return a.reenviarProcessoDevolvido(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("ğŸ”„")]),o("span",{staticClass:"btn-text"},[a._v("Reenviar Processo")])]):a._e(),a.podeAdicionarDoc?o("button",{staticClass:"action-btn action-btn-secondary",on:{click:function(o){return a.adicionarDocumento(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("ğŸ“")]),o("span",{staticClass:"btn-text"},[a._v(a._s(a.obterTextoAdicionarDocumento()))])]):o("div",{staticClass:"action-info",staticStyle:{padding:"8px 12px",background:"#f5f5f5","border-radius":"6px",color:"#666","font-size":"0.9em",margin:"4px 0"}},[o("span",{staticClass:"btn-icon",staticStyle:{opacity:"0.5"}},[a._v("ğŸ“")]),o("span",[a._v(a._s(a.obterMensagemNaoPodeAdicionarDoc()))])]),a.podeEditarProcesso(a.processoSelecionado)?o("button",{staticClass:"action-btn action-btn-warning",on:{click:function(o){return a.editarProcesso(a.processoSelecionado)}}},[o("span",{staticClass:"btn-icon"},[a._v("âœï¸")]),o("span",{staticClass:"btn-text"},[a._v("Editar Processo")])]):a._e()])])]),o("div",{staticClass:"processo-content-panel"},[o("h4",[a._v("ğŸ¯ Objeto do Processo")]),o("div",{staticClass:"objeto-container"},[o("p",{staticClass:"objeto-texto"},[a._v(a._s(a.processoSelecionado.objeto))])]),a.processoFoiDevolvido(a.processoSelecionado)?o("div",{staticClass:"devolucao-info"},[o("h4",[a._v("âš ï¸ Motivo da DevoluÃ§Ã£o")]),o("div",{staticClass:"devolucao-container"},[o("div",{staticClass:"devolucao-header"},[o("span",{staticClass:"devolucao-status"},[a._v("ğŸ”´ "+a._s(a.obterNomeStatus(a.processoSelecionado.status)))]),o("span",{staticClass:"devolucao-data"},[a._v(a._s(new Date(a.processoSelecionado.data_devolucao).toLocaleDateString("pt-BR")))])]),o("div",{staticClass:"motivo-devolucao"},[o("h5",[a._v("ğŸ“ Motivo:")]),o("p",{staticClass:"motivo-texto"},[a._v(a._s(a.processoSelecionado.motivo_devolucao||"Motivo nÃ£o informado"))])]),a.processoSelecionado.observacoes_devolucao?o("div",{staticClass:"observacoes-devolucao"},[o("h5",[a._v("ğŸ“ ObservaÃ§Ãµes:")]),o("p",{staticClass:"observacoes-texto"},[a._v(a._s(a.processoSelecionado.observacoes_devolucao))])]):a._e(),a._m(7)])]):a._e(),o("h4",[a._v("ğŸ“„ Documentos do Processo")]),o("div",{staticClass:"documentos-container"},[0===a.documentosProcessoFiltrados.length?o("div",{staticClass:"empty-documentos"},[o("p",[a._v("âš ï¸ Nenhum documento encontrado")]),o("button",{staticClass:"btn-secondary",on:{click:function(o){return a.carregarDocumentosProcesso(a.processoSelecionado.id)}}},[a._v(" ğŸ”„ Recarregar ")])]):o("div",{staticClass:"lista-documentos"},a._l(a.documentosProcessoFiltrados,(function(t){return o("div",{key:t.id,staticClass:"documento-item"},[o("div",{staticClass:"doc-numero"},[a._v(a._s(t.folha_numero||`Fl. ${String(t.numero_sequencial||0).padStart(3,"0")}`))]),o("div",{staticClass:"doc-info"},[o("h5",[a._v(a._s(t.titulo))]),o("p",[a._v(a._s(t.descricao))]),o("small",[a._v(a._s(a.formatarData(t.data_autuacao)))])]),o("div",{staticClass:"doc-status"},[t.assinado?o("span",{staticClass:"status-assinado"},[a._v("âœ… Assinado")]):"disponivel"===t.status?o("span",{staticClass:"status-disponivel"},[a._v("ğŸ“„ DisponÃ­vel")]):o("span",{staticClass:"status-pendente"},[a._v("â³ Pendente")])]),o("div",{staticClass:"doc-actions"},[t.arquivo_url||t.url_arquivo?o("button",{staticClass:"btn-visualizar",on:{click:function(o){return a.visualizarDocumento(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]):"EDITAL"===t.tipo_documento?o("button",{staticClass:"btn-visualizar",on:{click:function(o){return a.buscarUrlEdital(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]):o("span",{staticClass:"no-file"},[a._v(" ğŸ“„ Sem arquivo ")])])])})),0)]),a._e(),a._e(),a._e()])])])])]):a._e(),o("ModalVincularEdital",{attrs:{visivel:a.mostrarModalEdital,processo:a.processoSelecionado||{}},on:{"edital-vinculado":a.onEditalVinculado,fechar:a.fecharModalEdital}}),a.mostrarDocumentacao&&a.processoSelecionado?o("div",{staticClass:"modal-overlay",on:{click:a.fecharDocumentacao}},[o("div",{staticClass:"modal-documentacao",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“‹ DocumentaÃ§Ã£o dos Produtos - "+a._s(a.processoSelecionado.numero_processo))]),o("button",{staticClass:"btn-close",on:{click:a.fecharDocumentacao}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("DocumentacaoProdutos",{attrs:{processoId:a.processoSelecionado.id}})],1)])]):a._e(),a.mostrarModalAdicionarDoc&&a.processoSelecionado?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalAdicionarDoc}},[o("div",{staticClass:"modal-adicionar-doc",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“ Adicionar Documento - "+a._s(a.processoSelecionado.numero_processo))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalAdicionarDoc}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"adicionar-documento-form"},[o("div",{staticClass:"info-processo"},[o("div",{staticClass:"info-item"},[o("strong",[a._v("Processo:")]),a._v(" "+a._s(a.processoSelecionado.numero_processo)+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Status:")]),a._v(" "),o("span",{class:`status-${a.obterStatusProcesso(a.processoSelecionado.status).cor}`},[a._v(a._s(a.obterStatusProcesso(a.processoSelecionado.status).label))])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Tipo:")]),a._v(" "+a._s(a.obterTipoProcesso(a.processoSelecionado.tipo_processo).label)+" ")])]),o("div",{staticClass:"upload-section"},[o("h4",[a._v("ğŸ“„ Selecionar Documento")]),o("div",{staticClass:"upload-area",on:{drop:function(o){return a.onDropDocumento(o)},dragover:function(a){a.preventDefault()},dragenter:function(a){a.preventDefault()}}},[o("input",{ref:"documentoInput",staticStyle:{display:"none"},attrs:{type:"file",multiple:"",accept:".pdf"},on:{change:function(o){return a.onSelectDocumento(o)}}}),o("div",{staticClass:"upload-content"},[o("div",{staticClass:"upload-icon"},[a._v("ğŸ“")]),o("p",[a._v("Clique para selecionar ou arraste arquivos aqui")]),o("small",[a._v("Formato aceito: Apenas arquivos PDF")]),o("button",{staticClass:"btn-upload-doc",attrs:{type:"button"},on:{click:function(o){return a.$refs.documentoInput.click()}}},[a._v(" Selecionar Arquivos ")])])]),a.documentosParaUpload.length>0?o("div",{staticClass:"documentos-selecionados"},[o("h5",[a._v("ğŸ“‹ Documentos Selecionados:")]),a._l(a.documentosParaUpload,(function(t,e){return o("div",{key:e,staticClass:"documento-item"},[o("div",{staticClass:"doc-info"},[o("span",{staticClass:"doc-nome"},[a._v(a._s(t.name))]),o("span",{staticClass:"doc-tamanho"},[a._v(a._s(a.formatarTamanho(t.size)))])]),o("button",{staticClass:"btn-remover",on:{click:function(o){return a.removerDocumento(e)}}},[a._v("âŒ")])])}))],2):a._e(),a.isOrgaoAdministrativo()?o("div",{staticClass:"info-orgao-admin"},[a._m(55),o("div",{staticClass:"gerar-assinatura-section"},[o("h5",[a._v("ğŸ“ Documento de Assinatura")]),o("p",[a._v("Precisa do modelo de documento para assinar? Gere o documento padrÃ£o:")]),o("button",{staticClass:"btn-gerar-assinatura",attrs:{type:"button"},on:{click:function(o){return a.gerarDocumentoAssinaturaParaDownload(a.processoSelecionado)}}},[a._v(" ğŸ–Šï¸ Gerar Documento de Assinatura ")]),o("small",[a._v("Este documento contÃ©m os campos obrigatÃ³rios para sua assinatura.")])])]):a._e(),a.isOrgaoAdministrativo()?a._e():o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"tipoDocumento"}},[a._v("Tipo do Documento:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.tipoDocumentoSelecionado,expression:"tipoDocumentoSelecionado"}],attrs:{id:"tipoDocumento"},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.tipoDocumentoSelecionado=o.target.multiple?t:t[0]}}},[o("option",{attrs:{value:""}},[a._v("Selecione o tipo")]),o("option",{attrs:{value:"COMPLEMENTAR"}},[a._v("Documento Complementar")]),o("option",{attrs:{value:"CORRECAO"}},[a._v("CorreÃ§Ã£o/RetificaÃ§Ã£o")]),o("option",{attrs:{value:"ADICIONAL"}},[a._v("Documento Adicional")]),o("option",{attrs:{value:"PARECER"}},[a._v("Parecer TÃ©cnico")]),o("option",{attrs:{value:"MANIFESTACAO"}},[a._v("ManifestaÃ§Ã£o")])])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"observacoesDoc"}},[a._v("ObservaÃ§Ãµes (opcional):")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.observacoesDocumento,expression:"observacoesDocumento"}],attrs:{id:"observacoesDoc",rows:"3",placeholder:"Descreva o conteÃºdo do documento ou justificativa para a inclusÃ£o"},domProps:{value:a.observacoesDocumento},on:{input:function(o){o.target.composing||(a.observacoesDocumento=o.target.value)}}})])]),o("div",{staticClass:"modal-actions"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalAdicionarDoc}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{disabled:0===a.documentosParaUpload.length||!a.isOrgaoAdministrativo()&&!a.tipoDocumentoSelecionado||a.processandoUpload},on:{click:a.uploadDocumentos}},[a._v(" "+a._s(a.processandoUpload?"Enviando...":`ğŸ“¤ Adicionar ${a.documentosParaUpload.length} Documento${a.documentosParaUpload.length>1?"s":""}`)+" ")])])])])])]):a._e(),a.mostrarModalConfirmacaoTramitacao?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalConfirmacaoTramitacao}},[o("div",{staticClass:"modal-confirmacao-tramitacao",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header-tramitacao"},[o("div",{staticClass:"header-icon"},[o("span",{staticClass:"tramitacao-icon"},[a._v(a._s(a.dadosConfirmacaoTramitacao.icone))])]),o("div",{staticClass:"header-content"},[o("h3",[a._v(a._s(a.dadosConfirmacaoTramitacao.titulo))]),o("p",{staticClass:"processo-numero"},[a._v("Processo: "+a._s(a.dadosConfirmacaoTramitacao.numeroProcesso))])]),o("button",{staticClass:"btn-close-tramitacao",on:{click:a.fecharModalConfirmacaoTramitacao}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body-tramitacao"},[o("div",{staticClass:"confirmacao-info"},[o("div",{staticClass:"status-flow"},[o("div",{staticClass:"status-atual"},[o("span",{staticClass:"status-label"},[a._v("Status Atual")]),o("span",{staticClass:"status-badge atual"},[a._v(a._s(a.dadosConfirmacaoTramitacao.statusAtual))])]),o("div",{staticClass:"flow-arrow"},[a._v("â†’")]),o("div",{staticClass:"status-proximo"},[o("span",{staticClass:"status-label"},[a._v("PrÃ³ximo Status")]),o("span",{staticClass:"status-badge proximo"},[a._v(a._s(a.dadosConfirmacaoTramitacao.proximoStatus))])])]),o("div",{staticClass:"observacoes-section"},[o("label",{staticClass:"obs-label",attrs:{for:"observacoesTramitacao"}},[a._v(" ğŸ’­ ObservaÃ§Ãµes (opcional) ")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.observacoesTramitacao,expression:"observacoesTramitacao"}],staticClass:"obs-textarea",attrs:{id:"observacoesTramitacao",placeholder:a.dadosConfirmacaoTramitacao.placeholderObservacoes,rows:"3"},domProps:{value:a.observacoesTramitacao},on:{input:function(o){o.target.composing||(a.observacoesTramitacao=o.target.value)}}})]),o("div",{staticClass:"tramitacao-aviso"},[o("div",{staticClass:"aviso-icon"},[a._v("â„¹ï¸")]),o("div",{staticClass:"aviso-texto"},[a._m(56),o("ul",[o("li",[a._v(a._s(a.dadosConfirmacaoTramitacao.consequencia1))]),o("li",[a._v(a._s(a.dadosConfirmacaoTramitacao.consequencia2))]),o("li",[a._v(a._s(a.dadosConfirmacaoTramitacao.consequencia3))])])])])])]),o("div",{staticClass:"modal-footer-tramitacao"},[o("button",{staticClass:"btn-cancelar",on:{click:a.fecharModalConfirmacaoTramitacao}},[a._v(" âŒ Cancelar ")]),o("button",{staticClass:"btn-confirmar",attrs:{disabled:a.processandoTramitacao},on:{click:a.confirmarTramitacao}},[a.processandoTramitacao?o("span",[a._v(" â³ Processando... ")]):o("span",[a._v(" "+a._s(a.dadosConfirmacaoTramitacao.icone)+" "+a._s(a.dadosConfirmacaoTramitacao.textoBotao)+" ")])])])])]):a._e(),a.mostrarModalDevolucao?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDevolucao}},[o("div",{staticClass:"modal-devolucao",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header-devolucao"},[a._m(57),o("div",{staticClass:"header-content"},[o("h3",[a._v("Devolver Processo para CPM")]),o("p",[a._v(a._s(a.processoParaDevolucao?.numero_processo))])]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalDevolucao}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body-devolucao"},[o("div",{staticClass:"status-flow"},[o("div",{staticClass:"status-item status-atual"},[o("span",{staticClass:"status-badge"},[a._v("ğŸ“‹ "+a._s(a.obterNomeStatus(a.processoParaDevolucao?.status)))]),o("span",{staticClass:"status-label"},[a._v("Status Atual")])]),o("div",{staticClass:"flow-arrow"},[a._v("â†’")]),a._m(58)]),o("div",{staticClass:"motivo-section"},[a._m(59),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.motivoDevolucao,expression:"motivoDevolucao"}],staticClass:"motivo-textarea",attrs:{id:"motivoDevolucao",placeholder:"Descreva o motivo da devoluÃ§Ã£o do processo...",rows:"4",required:""},domProps:{value:a.motivoDevolucao},on:{input:function(o){o.target.composing||(a.motivoDevolucao=o.target.value)}}})]),o("div",{staticClass:"observacoes-section"},[a._m(60),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.observacoesDevolucao,expression:"observacoesDevolucao"}],staticClass:"observacoes-textarea",attrs:{id:"observacoesDevolucao",placeholder:"ObservaÃ§Ãµes adicionais (opcional)...",rows:"3"},domProps:{value:a.observacoesDevolucao},on:{input:function(o){o.target.composing||(a.observacoesDevolucao=o.target.value)}}})])]),o("div",{staticClass:"modal-footer-devolucao"},[o("button",{staticClass:"btn-cancel",on:{click:a.fecharModalDevolucao}},[a._v(" âŒ Cancelar ")]),o("button",{staticClass:"btn-confirm-devolucao",attrs:{disabled:!a.motivoDevolucao.trim()||a.processandoDevolucao},on:{click:a.confirmarDevolucao}},[a.processandoDevolucao?o("span",[a._v(" â³ Devolvendo... ")]):o("span",[a._v(" â†©ï¸ Devolver para CPM ")])])])])]):a._e()],1)},s=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"sistema-titulo"},[o("p",{staticClass:"sistema-nome"},[a._v("Sistema Comprar Bem")]),o("p",{staticClass:"sistema-slogan"},[a._v("Compras PÃºblicas Inteligentes")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"texto"},[o("strong",[a._v("PadronizaÃ§Ã£o")]),o("small",[a._v("InclusÃ£o de marcas de produtos no CatÃ¡logo")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"texto"},[o("strong",[a._v("DespadronizaÃ§Ã£o")]),o("small",[a._v("ExclusÃ£o de marcas de produtos do CatÃ¡logo")])])},function(){var a=this,o=a._self._c;return o("optgroup",{attrs:{label:"ğŸŸ¢ PADRONIZAÃ‡ÃƒO"}},[o("option",{attrs:{value:"em_criacao"}},[a._v("ğŸ“ Em CriaÃ§Ã£o")]),o("option",{attrs:{value:"criado_cpm"}},[a._v("ğŸ¯ Criado pela CPM")]),o("option",{attrs:{value:"submetido_autoridade"}},[a._v("ğŸ“‹ Submetido Ã  Autoridade Competente")]),o("option",{attrs:{value:"abertura_autorizada"}},[a._v("âœ… Abertura Autorizada")]),o("option",{attrs:{value:"edital_chamamento"}},[a._v("ğŸ“¢ Edital de Chamamento PÃºblico")]),o("option",{attrs:{value:"analise_juridica"}},[a._v("âš–ï¸ Em AnÃ¡lise JurÃ­dica")]),o("option",{attrs:{value:"edital_publicado"}},[a._v("ğŸ“ƒ Com Edital Publicado")]),o("option",{attrs:{value:"com_impugnacao"}},[a._v("â“ Com ImpugnaÃ§Ã£o ao Edital")]),o("option",{attrs:{value:"recebendo_amostras"}},[a._v("ğŸ“¦ Recebendo Amostras e DocumentaÃ§Ã£o")]),o("option",{attrs:{value:"avaliacao_cpm"}},[a._v("ğŸ” Com AvaliaÃ§Ã£o e RelatÃ³rio da CPM")]),o("option",{attrs:{value:"julgamento_ccl"}},[a._v("âš–ï¸ Submetido ao Julgamento da CCL")]),o("option",{attrs:{value:"ata_ccl"}},[a._v("ğŸ“‹ Ata de Julgamento da CCL")]),o("option",{attrs:{value:"publicacao_ata"}},[a._v("ğŸ“° PublicaÃ§Ã£o da Ata e Prazo Recursal")]),o("option",{attrs:{value:"com_recurso"}},[a._v("ğŸ“ Com Recurso Administrativo")]),o("option",{attrs:{value:"homologado"}},[a._v("âœ… Com HomologaÃ§Ã£o")]),o("option",{attrs:{value:"expedindo_dcbs"}},[a._v("ğŸ“„ Expedindo as DCBs")]),o("option",{attrs:{value:"incluindo_marcas"}},[a._v("â• Incluindo Marcas no CatÃ¡logo")])])},function(){var a=this,o=a._self._c;return o("optgroup",{attrs:{label:"ğŸ”´ DESPADRONIZAÃ‡ÃƒO"}},[o("option",{attrs:{value:"em_criacao_desp"}},[a._v("ğŸ“ Em CriaÃ§Ã£o")]),o("option",{attrs:{value:"criado_cpm_desp"}},[a._v("ğŸ¯ Criado pela CPM")]),o("option",{attrs:{value:"submetido_autoridade_desp"}},[a._v("ğŸ“‹ Submetido Ã  Autoridade Competente")]),o("option",{attrs:{value:"abertura_autorizada_desp"}},[a._v("âœ… Abertura Autorizada")]),o("option",{attrs:{value:"aviso_publicado_desp"}},[a._v("ğŸ“¢ Com Aviso Publicado")]),o("option",{attrs:{value:"com_recurso_desp"}},[a._v("ğŸ“ Com Recurso Administrativo")]),o("option",{attrs:{value:"homologado_desp"}},[a._v("âœ… Com HomologaÃ§Ã£o")]),o("option",{attrs:{value:"excluindo_marcas"}},[a._v("âŒ Excluindo Marcas do CatÃ¡logo")])])},function(){var a=this,o=a._self._c;return o("optgroup",{attrs:{label:"ğŸ“ LEGADOS"}},[o("option",{attrs:{value:"rascunho"}},[a._v("ğŸ“ Rascunho")]),o("option",{attrs:{value:"iniciado"}},[a._v("ğŸ†• Iniciado")]),o("option",{attrs:{value:"analise_cppm"}},[a._v("ğŸ” AnÃ¡lise CPPM")]),o("option",{attrs:{value:"julgamento_ccl"}},[a._v("âš–ï¸ Julgamento CCL")]),o("option",{attrs:{value:"finalizado"}},[a._v("âœ… Finalizado")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"reminder-text"},[o("strong",[a._v("Pronto para CCL!")]),o("br"),o("small",[a._v('Clique em "Ver" â†’ "Tramitar para CCL"')])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"acao-requerida"},[o("p",[o("strong",[a._v("ğŸ“ AÃ§Ã£o Requerida:")]),a._v(" Corrija os pontos mencionados e reenvie o processo.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"manual-header"},[o("h5",[a._v("ğŸ“– Manual do Sistema Comprar Bem")]),o("p",{staticClass:"manual-subtitle"},[a._v("Compras PÃºblicas Inteligentes - Guia Completo")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("O sistema "),o("strong",[a._v("Comprar Bem")]),a._v(" foi criado para facilitar e otimizar os processos de compras pÃºblicas, implementando a prÃ©-qualificaÃ§Ã£o tÃ©cnica de produtos conforme a "),o("strong",[a._v("Lei Federal nÂº 14.133/2021")]),a._v(".")])},function(){var a=this,o=a._self._c;return o("p",[a._v("Significa conseguir adquirir os produtos "),o("strong",[a._v("certos")]),a._v(", tÃ©cnica e funcionalmente adequados para atender Ã s necessidades do Ã³rgÃ£o, com "),o("em",[a._v("qualidade, economicidade e conformidade legal")]),a._v(".")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("PrÃ©-qualifiquem produtos")]),a._v(" antes das compras")]),o("li",[o("strong",[a._v("Tenham seguranÃ§a")]),a._v(" de que estÃ£o comprando produtos adequados")]),o("li",[o("strong",[a._v("Agilizem licitaÃ§Ãµes")]),a._v(" usando o catÃ¡logo prÃ©-aprovado")]),o("li",[o("strong",[a._v("Avaliem fornecedores")]),a._v(" apÃ³s as compras")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"workflow"},[o("div",{staticClass:"step"},[a._v("SolicitaÃ§Ã£o de PrÃ©-qualificaÃ§Ã£o")]),o("div",{staticClass:"step"},[a._v("AnÃ¡lise tÃ©cnica pela CPM")]),o("div",{staticClass:"step"},[a._v("Julgamento pela CCL")]),o("div",{staticClass:"step"},[a._v("EmissÃ£o da DCB")]),o("div",{staticClass:"step"},[a._v("InclusÃ£o no CatÃ¡logo")]),o("div",{staticClass:"step"},[a._v("Uso em LicitaÃ§Ãµes")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("A CPM Ã© responsÃ¡vel por "),o("strong",[a._v("analisar tecnicamente")]),a._v(" os produtos que serÃ£o prÃ©-qualificados. Ã‰ uma equipe de servidores especializados que garante que apenas produtos adequados entrem no catÃ¡logo.")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Recebe solicitaÃ§Ãµes")]),a._v(" de prÃ©-qualificaÃ§Ã£o")]),o("li",[o("strong",[a._v("Analisa documentaÃ§Ã£o")]),a._v(" tÃ©cnica do produto")]),o("li",[o("strong",[a._v("Avalia amostras")]),a._v(" (quando necessÃ¡rio)")]),o("li",[o("strong",[a._v("Emite parecer")]),a._v(" tÃ©cnico fundamentado")]),o("li",[o("strong",[a._v("Recomenda")]),a._v(" aprovaÃ§Ã£o ou reprovaÃ§Ã£o")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("AnÃ¡lise tÃ©cnica:")]),a._v(" AtÃ© 10 dias Ãºteis")]),o("li",[o("strong",[a._v("Parecer:")]),a._v(" Deve ser fundamentado e detalhado")]),o("li",[o("strong",[a._v("Envio para CCL:")]),a._v(" ApÃ³s conclusÃ£o da anÃ¡lise")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Produtos Pendentes:")]),a._v(" Novos pedidos de prÃ©-qualificaÃ§Ã£o")]),o("li",[o("strong",[a._v("Em AnÃ¡lise:")]),a._v(" Produtos sendo avaliados pela equipe")]),o("li",[o("strong",[a._v("Pareceres Prontos:")]),a._v(" AnÃ¡lises concluÃ­das")]),o("li",[o("strong",[a._v("Alertas de Prazo:")]),a._v(" Produtos com prazo vencendo")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Conformidade tÃ©cnica")]),a._v(" com especificaÃ§Ãµes")]),o("li",[o("strong",[a._v("DocumentaÃ§Ã£o completa")]),a._v(" e adequada")]),o("li",[o("strong",[a._v("Qualidade do produto")]),a._v(" compatvel com o uso")]),o("li",[o("strong",[a._v("SeguranÃ§a")]),a._v(" e adequaÃ§Ã£o Ã s normas")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("A CCL Ã© responsÃ¡vel pelo "),o("strong",[a._v("julgamento administrativo")]),a._v(" dos processos de prÃ©-qualificaÃ§Ã£o. Ela analisa os pareceres da CPM e toma a decisÃ£o final sobre aprovar ou reprovar produtos.")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Recebe pareceres")]),a._v(" tÃ©cnicos da CPM")]),o("li",[o("strong",[a._v("Analisa documentaÃ§Ã£o")]),a._v(" administrativa")]),o("li",[o("strong",[a._v("Verifica conformidade")]),a._v(" legal do processo")]),o("li",[o("strong",[a._v("Emite ata")]),a._v(" de julgamento")]),o("li",[o("strong",[a._v("Abre prazo")]),a._v(" para recursos")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Julgamento:")]),a._v(" ApÃ³s receber parecer da CPM")]),o("li",[o("strong",[a._v("Prazo recursal:")]),a._v(" 3 dias Ãºteis apÃ³s publicaÃ§Ã£o")]),o("li",[o("strong",[a._v("AnÃ¡lise de recursos:")]),a._v(" Conforme complexidade")]),o("li",[o("strong",[a._v("Encaminhamento:")]),a._v(" Para autoridade competente")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Aguardando Julgamento:")]),a._v(" Pareceres da CPM para analisar")]),o("li",[o("strong",[a._v("Atas Publicadas:")]),a._v(" DecisÃµes aguardando prazo recursal")]),o("li",[o("strong",[a._v("Com Recursos:")]),a._v(" Processos com impugnaÃ§Ãµes")]),o("li",[o("strong",[a._v("Prontos para HomologaÃ§Ã£o:")]),a._v(" Processos finalizados")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Aprovado:")]),a._v(" Produto atende aos requisitos")]),o("li",[o("strong",[a._v("Aprovado com ressalvas:")]),a._v(" Produto aprovado com restriÃ§Ãµes")]),o("li",[o("strong",[a._v("Reprovado:")]),a._v(" Produto nÃ£o atende aos critÃ©rios")]),o("li",[o("strong",[a._v("DiligÃªncia:")]),a._v(" SolicitaÃ§Ã£o de informaÃ§Ãµes adicionais")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("A DCB Ã© o "),o("strong",[a._v('"certificado de aprovaÃ§Ã£o"')]),a._v(" do produto. Ã‰ o documento que comprova que aquele produto especÃ­fico foi analisado, aprovado e pode ser comprado pelos Ã³rgÃ£os pÃºblicos sem nova anÃ¡lise tÃ©cnica.")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Nome completo do produto")]),a._v(" aprovado")]),o("li",[o("strong",[a._v("Marca e modelo")]),a._v(" especÃ­ficos")]),o("li",[o("strong",[a._v("Fabricante")]),a._v(" responsÃ¡vel")]),o("li",[o("strong",[a._v("EspecificaÃ§Ãµes tÃ©cnicas")]),a._v(" detalhadas")]),o("li",[o("strong",[a._v("Data de validade")]),a._v(" da aprovaÃ§Ã£o")]),o("li",[o("strong",[a._v("ObservaÃ§Ãµes especiais")]),a._v(" (se houver)")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Prazo mÃ¡ximo:")]),a._v(" 1 ano a partir da emissÃ£o")]),o("li",[o("strong",[a._v("RenovaÃ§Ã£o:")]),a._v(" PossÃ­vel mediante nova solicitaÃ§Ã£o")]),o("li",[o("strong",[a._v("Cancelamento:")]),a._v(" Se o produto apresentar problemas")]),o("li",[o("strong",[a._v("Controle:")]),a._v(" Acompanhado via RDM")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Consulte no CatÃ¡logo")]),a._v(" se o produto tem DCB vÃ¡lida")]),o("li",[o("strong",[a._v("Use diretamente na licitaÃ§Ã£o")]),a._v(" - nÃ£o precisa nova anÃ¡lise")]),o("li",[o("strong",[a._v("Cite a DCB no edital")]),a._v(" como comprovaÃ§Ã£o tÃ©cnica")]),o("li",[o("strong",[a._v("Verifique sempre a validade")]),a._v(" antes de usar")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("SeguranÃ§a:")]),a._v(" Produto jÃ¡ foi analisado tecnicamente")]),o("li",[o("strong",[a._v("Agilidade:")]),a._v(" NÃ£o precisa nova anÃ¡lise na licitaÃ§Ã£o")]),o("li",[o("strong",[a._v("Qualidade:")]),a._v(" Garantia de conformidade tÃ©cnica")]),o("li",[o("strong",[a._v("Legal:")]),a._v(" Atende exigÃªncias da Lei 14.133/2021")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("O RDM serve para "),o("strong",[a._v("avaliar se os produtos comprados realmente funcionaram bem")]),a._v('. Ã‰ como uma "avaliaÃ§Ã£o" que vocÃª faz do produto depois de usÃ¡-lo, para ajudar outros Ã³rgÃ£os a decidir se devem comprar o mesmo produto.')])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Quem usa o produto")]),a._v(" no dia a dia")]),o("li",[o("strong",[a._v("ResponsÃ¡veis pelo estoque")])]),o("li",[o("strong",[a._v("Gestores")]),a._v(" que acompanham o uso")]),o("li",[o("strong",[a._v("TÃ©cnicos")]),a._v(" quando necessÃ¡rio")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"criterios"},[o("div",{staticClass:"criterio"},[o("strong",[a._v("âœ… Qualidade:")]),a._v(" O produto funcionou como esperado? ")]),o("div",{staticClass:"criterio"},[o("strong",[a._v("â±ï¸ Durabilidade:")]),a._v(" Durou o tempo previsto? ")]),o("div",{staticClass:"criterio"},[o("strong",[a._v("âš¡ EficÃ¡cia:")]),a._v(" Resolveu o problema que deveria? ")]),o("div",{staticClass:"criterio"},[o("strong",[a._v("ğŸ’° Custo-benefÃ­cio:")]),a._v(" Valeu o preÃ§o pago? ")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Acesse o menu RDM")]),a._v(" no sistema")]),o("li",[o("strong",[a._v("Procure o produto")]),a._v(" que vocÃª comprou")]),o("li",[o("strong",[a._v("Preencha o formulÃ¡rio")]),a._v(" com sua experiÃªncia")]),o("li",[o("strong",[a._v("Seja honesto:")]),a._v(" Sua avaliaÃ§Ã£o ajuda outros Ã³rgÃ£os")]),o("li",[o("strong",[a._v("Envie o relatÃ³rio")]),a._v(" - a CPM vai analisar")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Produtos ruins")]),a._v(" sÃ£o removidos do catÃ¡logo")]),o("li",[o("strong",[a._v("Produtos bons")]),a._v(" continuam disponÃ­veis")]),o("li",[o("strong",[a._v("Outros Ã³rgÃ£os")]),a._v(" se beneficiam da sua experiÃªncia")]),o("li",[o("strong",[a._v("Melhora continu")]),a._v(" da qualidade das compras")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("O CatÃ¡logo Ã© onde ficam listados todos os produtos que jÃ¡ foram "),o("strong",[a._v("prÃ©-qualificados")]),a._v(" e estÃ£o aprovados para compra pelos Ã³rgÃ£os pÃºblicos.")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Por categoria:")]),a._v(" Escolha entre SaÃºde, Administrativa, TI, etc.")]),o("li",[o("strong",[a._v("Por nome:")]),a._v(" Digite o nome do produto que procura")]),o("li",[o("strong",[a._v("Por marca:")]),a._v(" Busque por fabricantes especÃ­ficos")]),o("li",[o("strong",[a._v("Por especificaÃ§Ã£o:")]),a._v(" Encontre produtos com caracterÃ­sticas tÃ©cnicas especÃ­ficas")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Acesse o CatÃ¡logo")]),a._v(" no menu principal")]),o("li",[o("strong",[a._v("Busque o produto")]),a._v(" que precisa comprar")]),o("li",[o("strong",[a._v("Verifique se estÃ¡ prÃ©-qualificado")]),a._v(" (tem DCB vÃ¡lida)")]),o("li",[o("strong",[a._v("Use diretamente na licitaÃ§Ã£o")]),a._v(" - sem need de nova anÃ¡lise tÃ©cnica")]),o("li",[o("strong",[a._v("Exporte a lista")]),a._v(" de produtos para seu edital")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[a._v("Produtos jÃ¡ "),o("strong",[a._v("analisados tecnicamente")])]),o("li",[o("strong",[a._v("LicitaÃ§Ãµes mais rÃ¡pidas")])]),o("li",[o("strong",[a._v("Menor risco")]),a._v(" de comprar produto inadequado")]),o("li",[o("strong",[a._v("Facilita comparaÃ§Ã£o")]),a._v(" entre opÃ§Ãµes")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"lei-header"},[o("h5",[a._v("âš–ï¸ Lei 14.133/2021 - Nova Lei de LicitaÃ§Ãµes")]),o("p",{staticClass:"lei-subtitle"},[a._v("Guia PrÃ¡tico para Gestores de Compras PÃºblicas")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("A Lei 14.133/2021 estÃ¡ em "),o("strong",[a._v("plena vigÃªncia desde janeiro de 2024")]),a._v(", substituindo completamente a antiga Lei 8.666/93 que vigorou por mais de 30 anos.")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Qualidade acima do preÃ§o baixo:")]),a._v(' Buscar o "resultado mais vantajoso"')]),o("li",[o("strong",[a._v("ModernizaÃ§Ã£o:")]),a._v(" Tecnologias digitais e processos eficientes")]),o("li",[o("strong",[a._v("TransparÃªncia:")]),a._v(" Maior controle social e publicidade")]),o("li",[o("strong",[a._v("Sustentabilidade:")]),a._v(" CritÃ©rios sociais e ambientais")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("Foco no "),o("strong",[a._v("menor preÃ§o")]),a._v(" como critÃ©rio principal")])},function(){var a=this,o=a._self._c;return o("p",[a._v("Foco no "),o("strong",[a._v("resultado mais vantajoso")]),a._v(" considerando qualidade, durabilidade e custo-benefÃ­cio")])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Tomada de PreÃ§os")]),a._v(" - NÃ£o existe mais")]),o("li",[o("strong",[a._v("Convite")]),a._v(" - NÃ£o existe mais")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modalidades"},[o("div",{staticClass:"modalidade"},[o("strong",[a._v("ğŸ“ PregÃ£o:")]),a._v(" OBRIGATÃ“RIO para bens e serviÃ§os comuns ")]),o("div",{staticClass:"modalidade"},[o("strong",[a._v("ğŸ¢ ConcorrÃªncia:")]),a._v(" Para bens/serviÃ§os especiais e obras ")]),o("div",{staticClass:"modalidade"},[o("strong",[a._v("ğŸ”„ DiÃ¡logo Competitivo:")]),a._v(" NOVA modalidade para soluÃ§Ãµes inovadoras ")]),o("div",{staticClass:"modalidade"},[o("strong",[a._v("ğŸ† Concurso:")]),a._v(" Para trabalhos tÃ©cnicos e artÃ­sticos ")]),o("div",{staticClass:"modalidade"},[o("strong",[a._v("ğŸ’° LeilÃ£o:")]),a._v(" Para venda de bens pÃºblicos ")])])},function(){var a=this,o=a._self._c;return o("p",[a._v("A escolha da modalidade "),o("strong",[a._v("NÃƒO depende mais do valor")]),a._v(", mas da "),o("strong",[a._v("natureza do objeto")]),a._v(".")])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"prazos-tabela"},[o("div",{staticClass:"prazo-item"},[o("strong",[a._v("AquisiÃ§Ã£o de Bens (menor preÃ§o):")]),o("span",{staticClass:"prazo"},[a._v("8 dias Ãºteis")])]),o("div",{staticClass:"prazo-item"},[o("strong",[a._v("ServiÃ§os Comuns (menor preÃ§o):")]),o("span",{staticClass:"prazo"},[a._v("10 dias Ãºteis")])]),o("div",{staticClass:"prazo-item"},[o("strong",[a._v("ServiÃ§os Especiais:")]),o("span",{staticClass:"prazo"},[a._v("25 dias Ãºteis")])]),o("div",{staticClass:"prazo-item"},[o("strong",[a._v("TÃ©cnica e PreÃ§o:")]),o("span",{staticClass:"prazo"},[a._v("35 dias Ãºteis")])])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("ManifestaÃ§Ã£o de interesse:")]),a._v(" MÃ­nimo 10 minutos na sessÃ£o")]),o("li",[o("strong",[a._v("ApresentaÃ§Ã£o de razÃµes:")]),a._v(" 3 dias Ãºteis")]),o("li",[o("strong",[a._v("ContrarrazÃµes:")]),a._v(" 3 dias Ãºteis")]),o("li",[o("strong",[a._v("DecisÃ£o da autoridade:")]),a._v(" 10 dias Ãºteis")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Art. 78, inciso II:")]),a._v(" PrÃ©-qualificaÃ§Ã£o como procedimento auxiliar")]),o("li",[o("strong",[a._v("Art. 80:")]),a._v(" RegulamentaÃ§Ã£o especÃ­fica da prÃ©-qualificaÃ§Ã£o permanente")]),o("li",[o("strong",[a._v("Art. 41, inciso II:")]),a._v(" Possibilidade de exigir marcas especÃ­ficas")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"workflow"},[o("div",{staticClass:"step"},[a._v("PublicaÃ§Ã£o do Edital")]),o("div",{staticClass:"step"},[a._v("AnÃ¡lise TÃ©cnica (10 dias)")]),o("div",{staticClass:"step"},[a._v("Julgamento CCL")]),o("div",{staticClass:"step"},[a._v("EmissÃ£o da DCB")]),o("div",{staticClass:"step"},[a._v("InclusÃ£o no CatÃ¡logo")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("LicitaÃ§Ãµes mais rÃ¡pidas:")]),a._v(" Sem nova anÃ¡lise tÃ©cnica")]),o("li",[o("strong",[a._v("Maior seguranÃ§a:")]),a._v(" Produtos jÃ¡ certificados")]),o("li",[o("strong",[a._v("PadronizaÃ§Ã£o:")]),a._v(" CatÃ¡logo institucional")]),o("li",[o("strong",[a._v("Qualidade garantida:")]),a._v(" Testes prÃ©vios realizados")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"criterios-lei"},[o("div",{staticClass:"criterio-lei"},[o("strong",[a._v("ğŸ’° Menor PreÃ§o:")]),a._v(" CritÃ©rio tradicional mantido ")]),o("div",{staticClass:"criterio-lei"},[o("strong",[a._v("ğŸ“ˆ Maior Desconto:")]),a._v(" Novo critÃ©rio para negociaÃ§Ãµes ")]),o("div",{staticClass:"criterio-lei"},[o("strong",[a._v("ğŸ¯ Melhor TÃ©cnica:")]),a._v(" Foco na qualidade tÃ©cnica ")]),o("div",{staticClass:"criterio-lei"},[o("strong",[a._v("âš–ï¸ TÃ©cnica e PreÃ§o:")]),a._v(" CombinaÃ§Ã£o equilibrada ")]),o("div",{staticClass:"criterio-lei"},[o("strong",[a._v("ğŸ“ˆ Maior Retorno EconÃ´mico:")]),a._v(" Novo - para concessÃµes ")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("DimensÃ£o ambiental:")]),a._v(" Produtos ecolÃ³gicos, menor impacto")]),o("li",[o("strong",[a._v("DimensÃ£o social:")]),a._v(" InclusÃ£o de grupos vulnerÃ¡veis")]),o("li",[o("strong",[a._v("Ciclo de vida:")]),a._v(" Custos durante toda a vida Ãºtil")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("Portal Nacional (PNCP):")]),a._v(" Todas as licitaÃ§Ãµes obrigatoriamente")]),o("li",[o("strong",[a._v("Site oficial:")]),a._v(" Editais, resultados e contratos")]),o("li",[o("strong",[a._v("DiÃ¡rio Oficial:")]),a._v(" Avisos e extratos")]),o("li",[o("strong",[a._v("AudiÃªncias pÃºblicas:")]),a._v(" Para projetos relevantes")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[o("strong",[a._v("PublicaÃ§Ã£o permanente")]),a._v(" no site oficial")]),o("li",[o("strong",[a._v("Acesso livre")]),a._v(" para consulta")]),o("li",[o("strong",[a._v("AtualizaÃ§Ã£o automÃ¡tica")]),a._v(" com inclusÃµes/exclusÃµes")]),o("li",[o("strong",[a._v("Filtros por categoria")]),a._v(" para facilitar busca")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[a._v("Maior "),o("strong",[a._v("controle social")])]),o("li",[o("strong",[a._v("ReduÃ§Ã£o de questionamentos")])]),o("li",[o("strong",[a._v("SeguranÃ§a jurÃ­dica")]),a._v(" para gestores")]),o("li",[o("strong",[a._v("Facilita fiscalizaÃ§Ã£o")]),a._v(" pelos Ã³rgÃ£os de controle")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"alert alert-info"},[o("span",[a._v("â„¹ï¸")]),o("strong",[a._v("Documento Assinado:")]),a._v(' Este documento serÃ¡ automaticamente marcado como "Documento Assinado" pelo Ã³rgÃ£o administrativo. ')])},function(){var a=this,o=a._self._c;return o("p",[o("strong",[a._v("O que acontece apÃ³s a tramitaÃ§Ã£o:")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"header-icon"},[o("span",{staticClass:"devolucao-icon"},[a._v("â†©ï¸")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"status-item status-destino"},[o("span",{staticClass:"status-badge blue"},[a._v("âœ… Criado pela CPM")]),o("span",{staticClass:"status-label"},[a._v("ApÃ³s DevoluÃ§Ã£o")])])},function(){var a=this,o=a._self._c;return o("label",{staticClass:"field-label",attrs:{for:"motivoDevolucao"}},[o("span",{staticClass:"label-icon"},[a._v("ğŸ“")]),a._v(" Motivo da DevoluÃ§Ã£o * ")])},function(){var a=this,o=a._self._c;return o("label",{staticClass:"field-label",attrs:{for:"observacoesDevolucao"}},[o("span",{staticClass:"label-icon"},[a._v("ğŸ“")]),a._v(" ObservaÃ§Ãµes Adicionais ")])}],i=t(6507),r=t(452);var n=t(2045),c=t(5445),l=function(){var a=this,o=a._self._c;return o("div",{staticClass:"assistente-container"},[o("div",{staticClass:"assistente-header"},[o("h2",[a._v("ğŸ¯ Assistente de Processo Administrativo")]),o("div",{staticClass:"progresso"},[o("div",{staticClass:"etapas"},a._l(a.etapas,(function(t,e){return o("div",{key:e,staticClass:"etapa",class:{active:a.etapaAtual===e,completed:a.etapaAtual>e,disabled:a.etapaAtual<e}},[o("div",{staticClass:"etapa-numero"},[a._v(a._s(e+1))]),o("div",{staticClass:"etapa-info"},[o("div",{staticClass:"etapa-titulo"},[a._v(a._s(t.titulo))]),o("div",{staticClass:"etapa-desc"},[a._v(a._s(t.descricao))])])])})),0),o("div",{staticClass:"barra-progresso"},[o("div",{staticClass:"progresso-fill",style:{width:a.etapaAtual/(a.etapas.length-1)*100+"%"}})])])]),o("div",{staticClass:"assistente-conteudo"},[0===a.etapaAtual?o("div",{staticClass:"etapa-conteudo"},[a._m(0),o("div",{staticClass:"tipo-processo-container"},[o("div",{staticClass:"tipo-processo-escolha"},[o("h4",[a._v("Escolha o tipo de processo:")]),o("div",{staticClass:"tipos-opcoes"},[a.dadosProcesso.tipo_processo&&"padronizacao"!==a.dadosProcesso.tipo_processo?a._e():o("div",{staticClass:"tipo-opcao",class:{selected:"padronizacao"===a.dadosProcesso.tipo_processo},on:{click:function(o){return a.selecionarTipo("padronizacao")}}},[o("div",{staticClass:"tipo-icon"},[a._v("âœ…")]),a._m(1)]),a.dadosProcesso.tipo_processo&&"despadronizacao"!==a.dadosProcesso.tipo_processo?a._e():o("div",{staticClass:"tipo-opcao",class:{selected:"despadronizacao"===a.dadosProcesso.tipo_processo},on:{click:function(o){return a.selecionarTipo("despadronizacao")}}},[o("div",{staticClass:"tipo-icon"},[a._v("âŒ")]),a._m(2)])])]),a.dadosProcesso.tipo_processo?o("div",{staticClass:"folha-rosto-campos"},[o("h4",[a._v("ğŸ“‹ Dados da Folha de Rosto:")]),o("div",{staticClass:"form-group"},[o("label",[a._v("NÃºmero do Processo *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosProcesso.numero_processo,expression:"dadosProcesso.numero_processo"}],attrs:{type:"text",placeholder:"Ex: 001/2025",required:""},domProps:{value:a.dadosProcesso.numero_processo},on:{input:function(o){o.target.composing||a.$set(a.dadosProcesso,"numero_processo",o.target.value)}}}),o("small",{staticClass:"field-hint"},[a._v("Formato: [nÃºmero]/[ano] - Ex: 001/2025, 123/2024")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Ã“rgÃ£o *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosProcesso.nome_orgao,expression:"dadosProcesso.nome_orgao"}],attrs:{type:"text",placeholder:"Ex: Prefeitura Municipal de Nova Lima",required:""},domProps:{value:a.dadosProcesso.nome_orgao},on:{input:function(o){o.target.composing||a.$set(a.dadosProcesso,"nome_orgao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Unidade Interessada *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosProcesso.unidade_interessada,expression:"dadosProcesso.unidade_interessada"}],attrs:{type:"text",placeholder:"Ex: Secretaria de AdministraÃ§Ã£o",required:""},domProps:{value:a.dadosProcesso.unidade_interessada},on:{input:function(o){o.target.composing||a.$set(a.dadosProcesso,"unidade_interessada",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Data de AutuaÃ§Ã£o *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosProcesso.data_autuacao,expression:"dadosProcesso.data_autuacao"}],attrs:{type:"date",required:""},domProps:{value:a.dadosProcesso.data_autuacao},on:{input:function(o){o.target.composing||a.$set(a.dadosProcesso,"data_autuacao",o.target.value)}}})]),o("div",{staticClass:"folha-rosto-preview-mini"},[o("h4",[a._v("ğŸ” Preview da Folha de Rosto:")]),o("div",{staticClass:"preview-container"},[o("FolhaRosto",{attrs:{numeroProcesso:a.dadosProcesso.numero_processo,tipoProcesso:a.dadosProcesso.tipo_processo,dataInicio:a.formatarDataBrasileira(a.dadosProcesso.data_autuacao),dadosOrgao:{nome:a.dadosProcesso.nome_orgao,unidade_interessada:a.dadosProcesso.unidade_interessada}}})],1)])]):a._e()])]):a._e(),1===a.etapaAtual?o("div",{staticClass:"etapa-conteudo"},[a._m(3),o("div",{staticClass:"resumo-processo"},[o("h4",[a._v("ğŸ“„ Resumo dos Dados Informados:")]),o("div",{staticClass:"info-grid"},[o("div",{staticClass:"info-item"},[o("strong",[a._v("NÃºmero do Processo:")]),o("span",[a._v(a._s(a.dadosProcesso.numero_processo))])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Tipo de Processo:")]),o("span",[a._v(a._s("padronizacao"===a.dadosProcesso.tipo_processo?"PadronizaÃ§Ã£o":"DespadronizaÃ§Ã£o"))])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Nome do Ã“rgÃ£o:")]),o("span",[a._v(a._s(a.dadosProcesso.nome_orgao))])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Unidade Interessada:")]),o("span",[a._v(a._s(a.dadosProcesso.unidade_interessada))])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Data de AutuaÃ§Ã£o:")]),o("span",[a._v(a._s(a.formatarDataBrasileira(a.dadosProcesso.data_autuacao)))])])])])]):a._e(),2===a.etapaAtual?o("div",{staticClass:"etapa-conteudo"},[a._m(4),a.processoTemporario?o("FormularioDFD",{attrs:{"processo-id":a.processoTemporario.id,"numero-processo":a.dadosProcesso.numero_processo,"tipo-processo":a.dadosProcesso.tipo_processo},on:{"dfd-criado":a.dfdCriado,cancelar:a.voltarEtapa}}):a._e()],1):a._e(),3===a.etapaAtual&&"padronizacao"===a.dadosProcesso.tipo_processo?o("div",{staticClass:"etapa-conteudo"},[a._m(5),o("div",{staticClass:"produtos-configuracao"},[o("div",{staticClass:"produtos-header"},[o("h4",[a._v("Selecione os produtos jÃ¡ aprovados pela CPM:")]),o("button",{staticClass:"btn-adicionar",attrs:{disabled:a.carregandoProdutos},on:{click:a.abrirSeletorProdutos}},[a._v(" "+a._s(a.carregandoProdutos?"ğŸ”„ Carregando...":"â• Selecionar Produtos")+" ")])]),a.mostrarSeletorProdutos?o("div",{staticClass:"produtos-disponiveis"},[o("h4",[a._v("ğŸ” Produtos Aprovados DisponÃ­veis:")]),0===a.produtosAprovados.length?o("div",{staticClass:"produtos-vazio"},[o("div",{staticClass:"vazio-icon"},[a._v("âš ï¸")]),o("p",[a._v("Nenhum produto aprovado encontrado")]),o("small",[a._v("Produtos devem ser cadastrados e aprovados pela CPM primeiro")])]):o("div",{staticClass:"produtos-grid"},a._l(a.produtosAprovados,(function(t){return o("div",{key:t.id,staticClass:"produto-disponivel",class:{selecionado:a.produtosSelecionados.includes(t.id)},on:{click:function(o){return a.toggleProdutoSelecionado(t)}}},[o("div",{staticClass:"produto-info"},[o("h5",[a._v(a._s(t.nome))]),o("p",{staticClass:"produto-fabricante"},[a._v(a._s(t.fabricante))]),o("p",{staticClass:"produto-categoria"},[a._v(a._s(t.categoria))]),o("p",{staticClass:"produto-status"},[a._v("âœ… Aprovado pela CPM")])]),o("div",{staticClass:"produto-checkbox"},[o("input",{attrs:{type:"checkbox"},domProps:{checked:a.produtosSelecionados.includes(t.id)},on:{change:function(o){return a.toggleProdutoSelecionado(t)}}})])])})),0),o("div",{staticClass:"seletor-acoes"},[o("button",{staticClass:"btn-primary",attrs:{disabled:0===a.produtosSelecionados.length},on:{click:a.confirmarSelecaoProdutos}},[a._v(" âœ… Confirmar SeleÃ§Ã£o ("+a._s(a.produtosSelecionados.length)+" produtos) ")]),o("button",{staticClass:"btn-secondary",on:{click:a.cancelarSelecaoProdutos}},[a._v(" âŒ Cancelar ")])])]):a._e(),0!==a.produtos.length||a.mostrarSeletorProdutos?a.mostrarSeletorProdutos?a._e():o("div",{staticClass:"produtos-selecionados"},[o("h4",[a._v("ğŸ“‹ Produtos Selecionados para PrÃ©-qualificaÃ§Ã£o:")]),o("div",{staticClass:"produtos-lista"},a._l(a.produtos,(function(t,e){return o("div",{key:t.id||e,staticClass:"produto-item selecionado"},[o("div",{staticClass:"produto-header"},[o("div",{staticClass:"produto-info-header"},[o("h5",[a._v(a._s(t.nome_produto||t.nome))]),o("span",{staticClass:"produto-badge"},[a._v("âœ… Aprovado")])]),o("button",{staticClass:"btn-remover",attrs:{title:"Remover da seleÃ§Ã£o"},on:{click:function(o){return a.removerProdutoSelecionado(e)}}},[a._v("ğŸ—‘ï¸")])]),o("div",{staticClass:"produto-detalhes"},[o("div",{staticClass:"produto-info-grid"},[o("div",{staticClass:"info-item"},[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(t.fabricante||"N/A")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Categoria:")]),a._v(" "+a._s(t.categoria||t.categoria_produto||"N/A")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("EspecificaÃ§Ãµes:")]),o("div",{staticClass:"especificacoes-content"},[o("p",[a._v(a._s(t.especificacoes_tecnicas))]),"EspecificaÃ§Ãµes nÃ£o disponÃ­veis"===t.especificacoes_tecnicas?o("button",{staticClass:"btn-ver-cadastro",on:{click:function(o){return a.verCadastroCompleto(t)}}},[a._v(" ğŸ“‹ Ver Cadastro Completo ")]):a._e()])])]),t.documentos&&t.documentos.length>0?o("div",{staticClass:"produto-documentos"},[o("h6",[a._v("ğŸ“„ Documentos do Produto:")]),o("div",{staticClass:"documentos-produto-grid"},a._l(t.documentos,(function(s){return o("div",{key:s.id,staticClass:"documento-produto-item"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v(a._s(s.nome))]),o("small",[a._v(a._s(s.tipo))])]),o("div",{staticClass:"doc-actions"},[o("a",{staticClass:"btn-visualizar-doc",attrs:{href:s.arquivo_url,target:"_blank"}},[a._v(" ğŸ‘ï¸ Ver ")]),o("button",{staticClass:"btn-adicionar-doc",class:{adicionado:t.documentos_adicionados&&t.documentos_adicionados.includes(s.id)},on:{click:function(o){return a.adicionarDocumentoProcesso(s,e)}}},[a._v(" "+a._s(t.documentos_adicionados&&t.documentos_adicionados.includes(s.id)?"âœ… Adicionado":"â• Adicionar")+" ")])])])})),0)]):a._e(),o("div",{staticClass:"produto-processo-info"},[o("h6",[a._v("ğŸ“‹ InformaÃ§Ãµes EspecÃ­ficas do Processo:")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Quantidade de Amostras NecessÃ¡rias")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.quantidade_amostras,expression:"produto.quantidade_amostras",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 3",min:"0"},domProps:{value:t.quantidade_amostras},on:{input:function(o){o.target.composing||a.$set(t,"quantidade_amostras",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Valor Estimado para Amostras (R$)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:t.valor_estimado,expression:"produto.valor_estimado",modifiers:{number:!0}}],attrs:{type:"number",step:"0.01",placeholder:"0.00",min:"0"},domProps:{value:t.valor_estimado},on:{input:function(o){o.target.composing||a.$set(t,"valor_estimado",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ObservaÃ§Ãµes EspecÃ­ficas (opcional)")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.observacoes_processo,expression:"produto.observacoes_processo"}],attrs:{rows:"2",placeholder:"ObservaÃ§Ãµes especÃ­ficas para este processo..."},domProps:{value:t.observacoes_processo},on:{input:function(o){o.target.composing||a.$set(t,"observacoes_processo",o.target.value)}}})])])])])})),0)]):o("div",{staticClass:"produtos-vazio"},[o("div",{staticClass:"vazio-icon"},[a._v("ğŸ“¦")]),o("p",[a._v("Nenhum produto selecionado ainda")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirSeletorProdutos}},[a._v(" Selecionar Produtos Aprovados ")])])])]):a._e(),a.etapaAtual===("padronizacao"===a.dadosProcesso.tipo_processo?4:3)?o("div",{staticClass:"etapa-conteudo"},[o("div",{staticClass:"etapa-header-numeracao"},[o("span",{staticClass:"numero-pagina"},[a._v("PÃ¡gina "+a._s("padronizacao"===a.dadosProcesso.tipo_processo?"5+":"4+"))]),o("h3",[a._v("ğŸ“ DocumentaÃ§Ã£o do Processo")])]),o("div",{staticClass:"documentacao-container"},[a._m(6),"padronizacao"===a.dadosProcesso.tipo_processo?o("div",{staticClass:"edital-section"},[a._m(7),a.editalVinculado?o("div",{staticClass:"edital-vinculado"},[o("div",{staticClass:"vinculado-success"},[o("div",{staticClass:"success-icon"},[a._v("âœ…")]),o("div",{staticClass:"success-info"},[o("h5",[a._v("Edital Vinculado com Sucesso")]),o("p",[o("strong",[a._v("NÃºmero:")]),a._v(" "+a._s(a.dadosProcesso.numero_edital))]),a.dadosProcesso.data_vinculacao_edital?o("p",[o("strong",[a._v("Data:")]),a._v(" "+a._s(a.formatarData(a.dadosProcesso.data_vinculacao_edital))+" ")]):a._e()]),o("button",{staticClass:"btn-editar-edital",on:{click:a.editarEdital}},[a._v("âœï¸ Editar")])])]):o("div",{staticClass:"edital-form"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Editais DisponÃ­veis do Ã“rgÃ£o")]),o("button",{staticClass:"btn-carregar-editais",attrs:{disabled:a.carregandoEditais},on:{click:a.carregarEditaisDisponiveis}},[a._v(" "+a._s(a.carregandoEditais?"ğŸ”„ Carregando...":"ğŸ” Buscar Editais")+" ")])]),a.editaisDisponiveis.length>0?o("div",{staticClass:"editais-lista"},[o("h5",[a._v("ğŸ“‹ Editais Encontrados:")]),o("div",{staticClass:"editais-grid"},a._l(a.editaisDisponiveis,(function(t){return o("div",{key:t.id,staticClass:"edital-item",class:{selecionado:a.editalSelecionado&&a.editalSelecionado.id===t.id},on:{click:function(o){return a.selecionarEdital(t)}}},[o("div",{staticClass:"edital-info"},[o("h6",[a._v(a._s(t.numero_edital))]),o("p",{staticClass:"edital-data"},[a._v(a._s(a.formatarData(t.data_publicacao)))]),o("p",{staticClass:"edital-tipo"},[a._v(a._s(t.tipo_edital||"PrÃ©-QualificaÃ§Ã£o"))]),t.produtos_count?o("div",{staticClass:"edital-produtos"},[a._v(" ğŸ“¦ "+a._s(t.produtos_count)+" produtos ")]):a._e()]),o("div",{staticClass:"edital-status"},["ativo"===t.status?o("span",{staticClass:"status-ativo"},[a._v("âœ… Ativo")]):o("span",{staticClass:"status-inativo"},[a._v("â¸ï¸ "+a._s(t.status))])])])})),0)]):a.editaisCarregados&&0===a.editaisDisponiveis.length?o("div",{staticClass:"editais-vazio"},[o("div",{staticClass:"vazio-icon"},[a._v("ğŸ“„")]),o("p",[a._v("Nenhum edital encontrado para este Ã³rgÃ£o")]),o("small",[a._v("Verifique se hÃ¡ editais cadastrados no sistema")])]):a._e(),a.editalSelecionado?o("div",{staticClass:"edital-selecionado"},[o("h5",[a._v("ğŸ“ Edital Selecionado:")]),o("div",{staticClass:"edital-preview"},[o("div",{staticClass:"preview-info"},[o("strong",[a._v(a._s(a.editalSelecionado.numero_edital))]),o("p",[a._v("Data: "+a._s(a.formatarData(a.editalSelecionado.data_publicacao)))]),a.editalSelecionado.descricao?o("p",[a._v(a._s(a.editalSelecionado.descricao))]):a._e()]),o("div",{staticClass:"preview-acoes"},[a.editalSelecionado.arquivo_url?o("a",{staticClass:"btn-ver-edital",attrs:{href:a.editalSelecionado.arquivo_url,target:"_blank"}},[a._v(" ğŸ‘ï¸ Ver PDF ")]):o("div",{staticClass:"aviso-pdf"},[a._v(" ğŸ“„ PDF nÃ£o disponÃ­vel para visualizaÃ§Ã£o ")]),o("button",{staticClass:"btn-remover-selecao",on:{click:function(o){a.editalSelecionado=null}}},[a._v(" ğŸ—‘ï¸ Remover ")])])])]):a._e(),o("div",{staticClass:"edital-acao"},[o("button",{staticClass:"btn-vincular-edital",attrs:{disabled:!a.editalSelecionado||a.processando},on:{click:a.vincularEditalSelecionado}},[a._v(" "+a._s(a.processando?"ğŸ”„ Vinculando...":"ğŸ“ Vincular Edital Selecionado")+" ")])])])]):a._e(),o("div",{staticClass:"documentos-section"},[o("div",{staticClass:"documentos-header"},[o("h4",[a._v("ğŸ“„ Documentos do Processo")]),o("button",{staticClass:"btn-adicionar",on:{click:a.adicionarDocumento}},[a._v(" â• Adicionar Documento ")])]),0===a.documentos.length?o("div",{staticClass:"documentos-vazio"},[o("div",{staticClass:"vazio-icon"},[a._v("ğŸ“„")]),o("p",[a._v("Nenhum documento adicionado ainda")]),a._m(8)]):o("div",{staticClass:"documentos-lista"},a._l(a.documentos,(function(t,e){return o("div",{key:e,staticClass:"documento-item"},[o("div",{staticClass:"documento-info"},[o("div",{staticClass:"documento-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"documento-detalhes"},[o("h5",[a._v(a._s(t.nome))]),o("p",{staticClass:"documento-tipo"},[a._v(a._s(t.tipo))]),o("p",{staticClass:"documento-data"},[a._v("Adicionado em: "+a._s(a.formatarData(t.data_upload)))])])]),o("div",{staticClass:"documento-acoes"},[o("button",{staticClass:"btn-visualizar",on:{click:function(o){return a.visualizarDocumento(t)}}},[a._v("ğŸ‘ï¸ Ver")]),o("button",{staticClass:"btn-remover",on:{click:function(o){return a.removerDocumento(e)}}},[a._v("ğŸ—‘ï¸ Remover")])])])})),0),o("div",{staticClass:"numeracao-info"},[o("h4",[a._v("ğŸ“Š NumeraÃ§Ã£o AutomÃ¡tica - Caderno EletrÃ´nico")]),o("p",[a._v("O sistema numera automaticamente todas as pÃ¡ginas do processo:")]),o("div",{staticClass:"exemplo-numeracao"},[o("div",{staticClass:"paginas-fixas"},[o("strong",[a._v("PÃ¡ginas Fixas:")]),o("ul",[o("li",[a._v("PÃ¡gina 1: Folha de Rosto")]),o("li",[a._v("PÃ¡gina 2: InformaÃ§Ãµes BÃ¡sicas")]),o("li",[a._v("PÃ¡gina 3: DFD")]),"padronizacao"===a.dadosProcesso.tipo_processo?o("li",[a._v("PÃ¡gina 4: Produtos")]):a._e()])]),o("div",{staticClass:"paginas-documentos"},[o("strong",[a._v("Documentos Adicionais:")]),0===a.documentos.length?o("span",[a._v(" PÃ¡gina "+a._s("padronizacao"===a.dadosProcesso.tipo_processo?"5":"4")+"+ (conforme documentos adicionados) ")]):o("ul",a._l(a.documentos,(function(t,e){return o("li",{key:e},[a._v(" PÃ¡gina "+a._s(("padronizacao"===a.dadosProcesso.tipo_processo?5:4)+e)+": "+a._s(t.nome)+" ")])})),0)])])])])])]):a._e()]),o("div",{staticClass:"assistente-acoes"},[a.etapaAtual>0?o("button",{staticClass:"btn-secondary",attrs:{disabled:a.processando},on:{click:a.voltarEtapa}},[a._v(" â† Voltar ")]):a._e(),o("div",{staticClass:"acoes-direita"},[a.etapaAtual<a.etapas.length-1?o("button",{staticClass:"btn-primary",attrs:{disabled:!a.podeAvancar||a.processando},on:{click:a.proximaEtapa}},[a._v(" "+a._s(a.processando?"Processando...":"PrÃ³ximo â†’")+" ")]):a._e(),a.etapaAtual===a.etapas.length-1?o("button",{staticClass:"btn-primary",attrs:{disabled:a.processando},on:{click:a.finalizarProcesso}},[a._v(" "+a._s(a.processando?"Finalizando...":"ğŸ‰ Finalizar Processo")+" ")]):a._e()])])])},d=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"etapa-header-numeracao"},[o("span",{staticClass:"numero-pagina"},[a._v("PÃ¡gina 1")]),o("h3",[a._v("ğŸ“‹ Folha de Rosto do Processo")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"tipo-info"},[o("h5",[a._v("PadronizaÃ§Ã£o")]),o("p",[a._v("Incluir marcas de produtos no CatÃ¡logo EletrÃ´nico")]),o("div",{staticClass:"tipo-fluxo tipo-fluxo-verde"},[o("span",{staticClass:"fluxo-item"},[a._v("DFD")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("Edital")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("RelatÃ³rio CPM")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("Ata CCL")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("HomologaÃ§Ã£o")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("DCB")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("CatÃ¡logo")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"tipo-info"},[o("h5",[a._v("DespadronizaÃ§Ã£o")]),o("p",[a._v("Excluir marcas de produtos do CatÃ¡logo EletrÃ´nico")]),o("div",{staticClass:"tipo-fluxo tipo-fluxo-vermelho"},[o("span",{staticClass:"fluxo-item"},[a._v("DFD")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("RelatÃ³rio CPM")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("Ata CCL")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("HomologaÃ§Ã£o")]),o("span",{staticClass:"fluxo-arrow"},[a._v("â†’")]),o("span",{staticClass:"fluxo-item"},[a._v("CatÃ¡logo")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"etapa-header-numeracao"},[o("span",{staticClass:"numero-pagina"},[a._v("PÃ¡gina 2")]),o("h3",[a._v("ğŸ“‹ InformaÃ§Ãµes BÃ¡sicas do Processo")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"etapa-header-numeracao"},[o("span",{staticClass:"numero-pagina"},[a._v("PÃ¡gina 3")]),o("h3",[a._v("ğŸ“„ Documento de FormalizaÃ§Ã£o de Demanda")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"etapa-header-numeracao"},[o("span",{staticClass:"numero-pagina"},[a._v("PÃ¡gina 4")]),o("h3",[a._v("ğŸ“¦ Selecionar Produtos para PrÃ©-qualificaÃ§Ã£o")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"documentacao-info"},[o("p",[a._v("Upload dos documentos necessÃ¡rios para completar o processo administrativo.")]),o("p",[a._v("FaÃ§a o upload de todos os documentos que compÃµem este processo. Eles serÃ£o organizados em formato de caderno eletrÃ´nico.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"edital-header"},[o("h4",[a._v("ğŸ“ Edital de PrÃ©-QualificaÃ§Ã£o")]),o("p",[a._v("Selecione um edital existente do Ã³rgÃ£o para vincular ao processo")])])},function(){var a=this,o=a._self._c;return o("p",[o("small",[a._v('Clique em "Adicionar Documento" para fazer upload dos arquivos')])])}],u=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dfd-container"},[o("div",{staticClass:"dfd-header"},[o("h2",[a._v("ğŸ“‹ Documento de FormalizaÃ§Ã£o de Demanda (DFD)")]),o("p",{staticClass:"subtitle"},[a._v("Processo: "+a._s(a.numeroProcesso))])]),o("div",{staticClass:"modelo-selector"},[o("h3",[a._v("Escolha o Modelo de DFD")]),o("div",{staticClass:"modelos-opcoes"},[o("div",{staticClass:"modelo-opcao",class:{active:"modelo_1"===a.modeloSelecionado},on:{click:function(o){return a.selecionarModelo("modelo_1")}}},[o("div",{staticClass:"modelo-icon"},[a._v("ğŸ“„")]),a._m(0)]),o("div",{staticClass:"modelo-opcao",class:{active:"modelo_2"===a.modeloSelecionado},on:{click:function(o){return a.selecionarModelo("modelo_2")}}},[o("div",{staticClass:"modelo-icon"},[a._v("ğŸ“‹")]),a._m(1)]),o("div",{staticClass:"modelo-opcao",class:{active:"modelo_geral"===a.modeloSelecionado},on:{click:function(o){return a.selecionarModelo("modelo_geral")}}},[o("div",{staticClass:"modelo-icon"},[a._v("ğŸ“‘")]),a._m(2)])])]),a.modeloSelecionado?o("form",{staticClass:"dfd-form",on:{submit:function(o){return o.preventDefault(),a.salvarDFD.apply(null,arguments)}}},[o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ‘¨â€ğŸ’¼ Dados do Demandante")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Presidente da CPPM *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.nome_presidente,expression:"dadosDFD.nome_presidente"}],attrs:{type:"text",required:"",placeholder:"Nome completo do presidente..."},domProps:{value:a.dadosDFD.nome_presidente},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"nome_presidente",o.target.value)}}}),o("small",[a._v("Nome do presidente da ComissÃ£o Permanente de PadronizaÃ§Ã£o de Materiais")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("MatrÃ­cula *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.matricula_presidente,expression:"dadosDFD.matricula_presidente"}],attrs:{type:"text",required:"",placeholder:"Ex: 12345678"},domProps:{value:a.dadosDFD.matricula_presidente},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"matricula_presidente",o.target.value)}}}),o("small",[a._v("MatrÃ­cula funcional do presidente")])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("E-mail *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.email_presidente,expression:"dadosDFD.email_presidente"}],attrs:{type:"email",required:"",placeholder:"presidente@exemplo.gov.br"},domProps:{value:a.dadosDFD.email_presidente},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"email_presidente",o.target.value)}}}),o("small",[a._v("E-mail institucional do presidente")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Telefone")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.telefone_presidente,expression:"dadosDFD.telefone_presidente"}],attrs:{type:"tel",placeholder:"(xx) 9xxxx-xxxx"},domProps:{value:a.dadosDFD.telefone_presidente},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"telefone_presidente",o.target.value)}}}),o("small",[a._v("Telefone para contato")])])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ¯ Justificativa")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Justificativa da Demanda *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.justificativa,expression:"dadosDFD.justificativa"}],attrs:{rows:"4",required:"",placeholder:"Descreva a justificativa para esta demanda de prÃ©-qualificaÃ§Ã£o..."},domProps:{value:a.dadosDFD.justificativa},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"justificativa",o.target.value)}}}),o("small",[a._v("Explique a necessidade institucional que motiva este processo")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“ DescriÃ§Ã£o da Necessidade")]),o("div",{staticClass:"form-group"},[o("label",[a._v("DescriÃ§Ã£o Detalhada da Necessidade *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.necessidade_descricao,expression:"dadosDFD.necessidade_descricao"}],attrs:{rows:"5",required:"",placeholder:"Descreva detalhadamente a necessidade que serÃ¡ atendida..."},domProps:{value:a.dadosDFD.necessidade_descricao},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"necessidade_descricao",o.target.value)}}}),o("small",[a._v("Seja especÃ­fico sobre o que serÃ¡ adquirido e para que serÃ¡ usado")])])]),"modelo_1"===a.modeloSelecionado?o("div",{staticClass:"modelo-1-fields"},[o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“¦ Produtos a serem prÃ©-qualificados")]),o("div",{staticClass:"form-group"},[o("label",[a._v("EspecificaÃ§Ã£o dos Produtos/ServiÃ§os *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.produtos_especificacao,expression:"dadosDFD.produtos_especificacao"}],attrs:{rows:"4",required:"",placeholder:"Descreva detalhadamente os produtos ou serviÃ§os que serÃ£o prÃ©-qualificados..."},domProps:{value:a.dadosDFD.produtos_especificacao},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"produtos_especificacao",o.target.value)}}}),o("small",[a._v("Especifique marca, modelo, caracterÃ­sticas tÃ©cnicas, normas aplicÃ¡veis")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ”¢ Quantidades e Amostragem")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Quantidade de Amostras para AnÃ¡lise")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.quantidade_amostras,expression:"dadosDFD.quantidade_amostras",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 5 unidades"},domProps:{value:a.dadosDFD.quantidade_amostras},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"quantidade_amostras",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Quantidade de amostras necessÃ¡rias para avaliaÃ§Ã£o tÃ©cnica")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("AquisiÃ§Ãµes Previstas (12 meses)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.previsao_aquisicoes,expression:"dadosDFD.previsao_aquisicoes",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 1000"},domProps:{value:a.dadosDFD.previsao_aquisicoes},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"previsao_aquisicoes",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Quantidade estimada de aquisiÃ§Ãµes no prÃ³ximo ano")])])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“‹ EspecificaÃ§Ãµes TÃ©cnicas Detalhadas")]),o("div",{staticClass:"form-group"},[o("label",[a._v("EspecificaÃ§Ãµes TÃ©cnicas ObrigatÃ³rias")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.especificacoes_tecnicas,expression:"dadosDFD.especificacoes_tecnicas"}],attrs:{rows:"6",placeholder:"Liste todas as especificaÃ§Ãµes tÃ©cnicas obrigatÃ³rias que o produto deve atender..."},domProps:{value:a.dadosDFD.especificacoes_tecnicas},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"especificacoes_tecnicas",o.target.value)}}}),o("small",[a._v("Normas ABNT, certificaÃ§Ãµes, dimensÃµes, materiais, desempenho, etc.")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("âœ… CritÃ©rios de AceitaÃ§Ã£o e Ensaios")]),o("div",{staticClass:"form-group"},[o("label",[a._v("CritÃ©rios de AceitaÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.criterios_aceitacao,expression:"dadosDFD.criterios_aceitacao"}],attrs:{rows:"4",placeholder:"Defina os critÃ©rios que os produtos devem atender para serem aceitos..."},domProps:{value:a.dadosDFD.criterios_aceitacao},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"criterios_aceitacao",o.target.value)}}}),o("small",[a._v("PadrÃµes de qualidade, tolerÃ¢ncias, mÃ©todos de ensaio")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Ensaios e Testes Exigidos")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.ensaios_exigidos,expression:"dadosDFD.ensaios_exigidos"}],attrs:{rows:"3",placeholder:"Descreva os ensaios e testes que serÃ£o realizados..."},domProps:{value:a.dadosDFD.ensaios_exigidos},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"ensaios_exigidos",o.target.value)}}}),o("small",[a._v("Testes de laboratÃ³rio, certificaÃ§Ãµes de terceiros, etc.")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“ CondiÃ§Ãµes de Entrega")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Local de Entrega das Amostras")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.local_entrega_amostras,expression:"dadosDFD.local_entrega_amostras"}],attrs:{rows:"2",placeholder:"EndereÃ§o para entrega das amostras..."},domProps:{value:a.dadosDFD.local_entrega_amostras},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"local_entrega_amostras",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Prazo para Entrega das Amostras")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.prazo_entrega_amostras,expression:"dadosDFD.prazo_entrega_amostras"}],attrs:{type:"text",placeholder:"Ex: 15 dias corridos"},domProps:{value:a.dadosDFD.prazo_entrega_amostras},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"prazo_entrega_amostras",o.target.value)}}}),o("small",[a._v("Prazo mÃ¡ximo para entrega das amostras")])])])])]):a._e(),"modelo_2"===a.modeloSelecionado?o("div",{staticClass:"modelo-2-fields"},[o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸš« Produtos a serem despadronizados")]),o("div",{staticClass:"form-group"},[o("label",[a._v("IdentificaÃ§Ã£o dos Produtos/ServiÃ§os *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.produtos_despadronizar,expression:"dadosDFD.produtos_despadronizar"}],attrs:{rows:"4",required:"",placeholder:"Liste os produtos que devem ser despadronizados (marca, modelo, especificaÃ§Ãµes)..."},domProps:{value:a.dadosDFD.produtos_despadronizar},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"produtos_despadronizar",o.target.value)}}}),o("small",[a._v("Identifique claramente quais produtos serÃ£o removidos da padronizaÃ§Ã£o")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“Š Fonte das InformaÃ§Ãµes")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Origem das ReclamaÃ§Ãµes/Problemas")]),o("div",{staticClass:"checkbox-group"},[o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.fonte_rdm,expression:"dadosDFD.fonte_rdm"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.dadosDFD.fonte_rdm)?a._i(a.dadosDFD.fonte_rdm,null)>-1:a.dadosDFD.fonte_rdm},on:{change:function(o){var t=a.dadosDFD.fonte_rdm,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.dadosDFD,"fonte_rdm",t.concat([i])):r>-1&&a.$set(a.dadosDFD,"fonte_rdm",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.dadosDFD,"fonte_rdm",s)}}}),a._v(" RelatÃ³rios RDM (RelatÃ³rio de Desempenho de Material) ")]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.fonte_reclamacoes_usuarios,expression:"dadosDFD.fonte_reclamacoes_usuarios"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.dadosDFD.fonte_reclamacoes_usuarios)?a._i(a.dadosDFD.fonte_reclamacoes_usuarios,null)>-1:a.dadosDFD.fonte_reclamacoes_usuarios},on:{change:function(o){var t=a.dadosDFD.fonte_reclamacoes_usuarios,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.dadosDFD,"fonte_reclamacoes_usuarios",t.concat([i])):r>-1&&a.$set(a.dadosDFD,"fonte_reclamacoes_usuarios",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.dadosDFD,"fonte_reclamacoes_usuarios",s)}}}),a._v(" ReclamaÃ§Ãµes de usuÃ¡rios finais ")]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.fonte_sistema_comprar_bem,expression:"dadosDFD.fonte_sistema_comprar_bem"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.dadosDFD.fonte_sistema_comprar_bem)?a._i(a.dadosDFD.fonte_sistema_comprar_bem,null)>-1:a.dadosDFD.fonte_sistema_comprar_bem},on:{change:function(o){var t=a.dadosDFD.fonte_sistema_comprar_bem,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.dadosDFD,"fonte_sistema_comprar_bem",t.concat([i])):r>-1&&a.$set(a.dadosDFD,"fonte_sistema_comprar_bem",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.dadosDFD,"fonte_sistema_comprar_bem",s)}}}),a._v(' Sistema "Reclame Aqui" do Comprar Bem ')]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.fonte_analise_tecnica,expression:"dadosDFD.fonte_analise_tecnica"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.dadosDFD.fonte_analise_tecnica)?a._i(a.dadosDFD.fonte_analise_tecnica,null)>-1:a.dadosDFD.fonte_analise_tecnica},on:{change:function(o){var t=a.dadosDFD.fonte_analise_tecnica,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.dadosDFD,"fonte_analise_tecnica",t.concat([i])):r>-1&&a.$set(a.dadosDFD,"fonte_analise_tecnica",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.dadosDFD,"fonte_analise_tecnica",s)}}}),a._v(" AnÃ¡lise tÃ©cnica da CPPM ")]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.fonte_outros,expression:"dadosDFD.fonte_outros"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.dadosDFD.fonte_outros)?a._i(a.dadosDFD.fonte_outros,null)>-1:a.dadosDFD.fonte_outros},on:{change:function(o){var t=a.dadosDFD.fonte_outros,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.dadosDFD,"fonte_outros",t.concat([i])):r>-1&&a.$set(a.dadosDFD,"fonte_outros",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.dadosDFD,"fonte_outros",s)}}}),a._v(" Outros (especificar no campo abaixo) ")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Outras Fontes (se aplicÃ¡vel)")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.outras_fontes,expression:"dadosDFD.outras_fontes"}],attrs:{type:"text",placeholder:"Especifique outras fontes de informaÃ§Ã£o..."},domProps:{value:a.dadosDFD.outras_fontes},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"outras_fontes",o.target.value)}}})])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("âš ï¸ MotivaÃ§Ãµes para DespadronizaÃ§Ã£o")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Principais Problemas Identificados *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.problemas_identificados,expression:"dadosDFD.problemas_identificados"}],attrs:{rows:"5",required:"",placeholder:"Descreva detalhadamente os problemas que motivam a despadronizaÃ§Ã£o..."},domProps:{value:a.dadosDFD.problemas_identificados},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"problemas_identificados",o.target.value)}}}),o("small",[a._v("Problemas de qualidade, durabilidade, adequaÃ§Ã£o ao uso, seguranÃ§a, etc.")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("FrequÃªncia dos Problemas")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.frequencia_problemas,expression:"dadosDFD.frequencia_problemas"}],on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.dadosDFD,"frequencia_problemas",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione a frequÃªncia")]),o("option",{attrs:{value:"isolados"}},[a._v("Casos isolados (menos de 5%)")]),o("option",{attrs:{value:"esporadicos"}},[a._v("EsporÃ¡dicos (5% a 15%)")]),o("option",{attrs:{value:"recorrentes"}},[a._v("Recorrentes (15% a 30%)")]),o("option",{attrs:{value:"frequentes"}},[a._v("Frequentes (mais de 30%)")]),o("option",{attrs:{value:"sistematicos"}},[a._v("SistemÃ¡ticos (maioria dos casos)")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Impacto dos Problemas")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.impacto_problemas,expression:"dadosDFD.impacto_problemas"}],attrs:{rows:"3",placeholder:"Descreva o impacto dos problemas na operaÃ§Ã£o..."},domProps:{value:a.dadosDFD.impacto_problemas},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"impacto_problemas",o.target.value)}}}),o("small",[a._v("PrejuÃ­zos financeiros, operacionais, riscos Ã  seguranÃ§a, etc.")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“ˆ Dados Quantitativos")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Quantidade Adquirida (Ãºltimos 12 meses)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.quantidade_adquirida,expression:"dadosDFD.quantidade_adquirida",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 500"},domProps:{value:a.dadosDFD.quantidade_adquirida},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"quantidade_adquirida",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Total de unidades adquiridas no perÃ­odo")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Quantidade com Problemas")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.quantidade_problemas,expression:"dadosDFD.quantidade_problemas",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 150"},domProps:{value:a.dadosDFD.quantidade_problemas},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"quantidade_problemas",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Unidades que apresentaram problemas")])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("PrejuÃ­zo Estimado (R$)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.prejuizo_estimado,expression:"dadosDFD.prejuizo_estimado",modifiers:{number:!0}}],attrs:{type:"number",step:"0.01",placeholder:"Ex: 25000.00"},domProps:{value:a.dadosDFD.prejuizo_estimado},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"prejuizo_estimado",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Valor dos prejuÃ­zos causados pelos problemas")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("NÃºmero de RDMs Negativos")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.rdms_negativos,expression:"dadosDFD.rdms_negativos",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 12"},domProps:{value:a.dadosDFD.rdms_negativos},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"rdms_negativos",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Quantidade de RDMs com avaliaÃ§Ã£o negativa")])])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ” AnÃ¡lise TÃ©cnica")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Parecer TÃ©cnico da CPPM")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.parecer_tecnico,expression:"dadosDFD.parecer_tecnico"}],attrs:{rows:"4",placeholder:"AnÃ¡lise tÃ©cnica da comissÃ£o sobre os problemas reportados..."},domProps:{value:a.dadosDFD.parecer_tecnico},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"parecer_tecnico",o.target.value)}}}),o("small",[a._v("AvaliaÃ§Ã£o tÃ©cnica dos problemas e necessidade de despadronizaÃ§Ã£o")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Alternativas Avaliadas")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.alternativas_avaliadas,expression:"dadosDFD.alternativas_avaliadas"}],attrs:{rows:"3",placeholder:"Descreva as alternativas consideradas antes da despadronizaÃ§Ã£o..."},domProps:{value:a.dadosDFD.alternativas_avaliadas},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"alternativas_avaliadas",o.target.value)}}}),o("small",[a._v("Tentativas de correÃ§Ã£o, substituiÃ§Ã£o, renegociaÃ§Ã£o com fornecedores, etc.")])])])]):a._e(),"modelo_geral"===a.modeloSelecionado?o("div",{staticClass:"modelo-geral-fields"},[o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ¯ InformaÃ§Ãµes Complementares")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Base Legal")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.base_legal,expression:"dadosDFD.base_legal"}],attrs:{rows:"3",placeholder:"Cite a base legal que fundamenta esta demanda..."},domProps:{value:a.dadosDFD.base_legal},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"base_legal",o.target.value)}}}),o("small",[a._v("Lei 14.133/2021, regulamentos especÃ­ficos, etc.")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Impacto Esperado")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.impacto_esperado,expression:"dadosDFD.impacto_esperado"}],attrs:{rows:"3",placeholder:"Descreva o impacto esperado com esta aÃ§Ã£o..."},domProps:{value:a.dadosDFD.impacto_esperado},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"impacto_esperado",o.target.value)}}}),o("small",[a._v("BenefÃ­cios esperados, melhorias de qualidade, economia, etc.")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“Š AnÃ¡lise de Risco")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Riscos Identificados")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.riscos_identificados,expression:"dadosDFD.riscos_identificados"}],attrs:{rows:"3",placeholder:"Liste os principais riscos identificados..."},domProps:{value:a.dadosDFD.riscos_identificados},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"riscos_identificados",o.target.value)}}}),o("small",[a._v("Riscos tÃ©cnicos, de fornecimento, regulatÃ³rios, etc.")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Medidas Mitigadoras")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.medidas_mitigadoras,expression:"dadosDFD.medidas_mitigadoras"}],attrs:{rows:"3",placeholder:"Descreva as medidas para mitigar os riscos..."},domProps:{value:a.dadosDFD.medidas_mitigadoras},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"medidas_mitigadoras",o.target.value)}}}),o("small",[a._v("AÃ§Ãµes preventivas e corretivas para os riscos identificados")])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“ˆ InformaÃ§Ãµes Gerenciais")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Prazo de VigÃªncia (meses)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.dadosDFD.prazo_vigencia,expression:"dadosDFD.prazo_vigencia",modifiers:{number:!0}}],attrs:{type:"number",placeholder:"Ex: 12"},domProps:{value:a.dadosDFD.prazo_vigencia},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"prazo_vigencia",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("small",[a._v("Tempo estimado de validade da prÃ©-qualificaÃ§Ã£o")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Periodicidade de RevisÃ£o")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.periodicidade_revisao,expression:"dadosDFD.periodicidade_revisao"}],on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.dadosDFD,"periodicidade_revisao",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione")]),o("option",{attrs:{value:"semestral"}},[a._v("Semestral")]),o("option",{attrs:{value:"anual"}},[a._v("Anual")]),o("option",{attrs:{value:"bienal"}},[a._v("Bienal")]),o("option",{attrs:{value:"conforme_demanda"}},[a._v("Conforme demanda")])])])])])]):a._e(),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ’­ ObservaÃ§Ãµes Especiais")]),o("div",{staticClass:"form-group"},[o("label",[a._v("ObservaÃ§Ãµes Adicionais")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.dadosDFD.observacoes_especiais,expression:"dadosDFD.observacoes_especiais"}],attrs:{rows:"3",placeholder:"Inclua qualquer informaÃ§Ã£o adicional relevante..."},domProps:{value:a.dadosDFD.observacoes_especiais},on:{input:function(o){o.target.composing||a.$set(a.dadosDFD,"observacoes_especiais",o.target.value)}}}),o("small",[a._v("InformaÃ§Ãµes complementares, restriÃ§Ãµes especiais, etc.")])])]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:function(o){return a.$emit("cancelar")}}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-outline",attrs:{type:"button",disabled:a.salvando},on:{click:a.salvarRascunho}},[a._v(" ğŸ’¾ Salvar Rascunho ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"âœ… Criar DFD e Continuar")+" ")])])]):a._e(),a.mostrarPreview?o("div",{staticClass:"dfd-preview"},[o("div",{staticClass:"preview-header"},[o("h3",[a._v("ğŸ‘ï¸ VisualizaÃ§Ã£o do DFD")]),o("button",{staticClass:"btn-close",on:{click:function(o){a.mostrarPreview=!1}}},[a._v("Ã—")])]),o("div",{staticClass:"preview-content",domProps:{innerHTML:a._s(a.previewHTML)}})]):a._e()])},m=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"modelo-info"},[o("h4",[a._v("Modelo 1")]),o("p",[a._v("Para processos de padronizaÃ§Ã£o com produtos especÃ­ficos e quantidades definidas")]),o("ul",[o("li",[a._v("EspecificaÃ§Ãµes tÃ©cnicas detalhadas")]),o("li",[a._v("Quantidades estimadas")]),o("li",[a._v("CritÃ©rios de aceitaÃ§Ã£o")]),o("li",[a._v("Prazo e local de entrega")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modelo-info"},[o("h4",[a._v("Modelo 2")]),o("p",[a._v("Para processos de despadronizaÃ§Ã£o com base em reclamaÃ§Ãµes e RDM")]),o("ul",[o("li",[a._v("AnÃ¡lise de relatÃ³rios RDM")]),o("li",[a._v("Justificativas de despadronizaÃ§Ã£o")]),o("li",[a._v("HistÃ³rico de problemas")]),o("li",[a._v("MotivaÃ§Ãµes tÃ©cnicas")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modelo-info"},[o("h4",[a._v("Modelo Geral")]),o("p",[a._v("Modelo flexÃ­vel para situaÃ§Ãµes especiais e processos customizados")]),o("ul",[o("li",[a._v("Campos opcionais adaptÃ¡veis")]),o("li",[a._v("SeÃ§Ãµes configurÃ¡veis")]),o("li",[a._v("Adequado para casos especÃ­ficos")]),o("li",[a._v("Permite maior personalizaÃ§Ã£o")])])])}];const p={name:"FormularioDFD",props:{processoId:{type:String,required:!0},numeroProcesso:{type:String,required:!0},tipoProcesso:{type:String,required:!0}},data(){return{modeloSelecionado:null,salvando:!1,mostrarPreview:!1,autoSaveTimeout:null,dadosDFD:{nome_presidente:"",matricula_presidente:"",email_presidente:"",telefone_presidente:"",justificativa:"",necessidade_descricao:"",observacoes_especiais:"",produtos_especificacao:"",quantidade_amostras:null,previsao_aquisicoes:null,especificacoes_tecnicas:"",criterios_aceitacao:"",ensaios_exigidos:"",local_entrega_amostras:"",prazo_entrega_amostras:"",produtos_despadronizar:"",fonte_rdm:!1,fonte_reclamacoes_usuarios:!1,fonte_sistema_comprar_bem:!1,fonte_analise_tecnica:!1,fonte_outros:!1,outras_fontes:"",problemas_identificados:"",frequencia_problemas:"",impacto_problemas:"",quantidade_adquirida:null,quantidade_problemas:null,prejuizo_estimado:null,rdms_negativos:null,parecer_tecnico:"",alternativas_avaliadas:"",base_legal:"",impacto_esperado:"",riscos_identificados:"",medidas_mitigadoras:"",prazo_vigencia:null,periodicidade_revisao:""}}},computed:{previewHTML(){return this.gerarPreviewHTML()}},watch:{dadosDFD:{handler(){this.salvarRascunhoAutomatico()},deep:!0},modeloSelecionado:{handler(){this.salvarRascunhoAutomatico()}}},methods:{selecionarModelo(a){this.modeloSelecionado=a,"modelo_1"===a?(this.dadosDFD.produtos_despadronizar="",this.dadosDFD.fonte_rdm=!1,this.dadosDFD.fonte_reclamacoes_usuarios=!1,this.dadosDFD.fonte_sistema_comprar_bem=!1,this.dadosDFD.fonte_analise_tecnica=!1,this.dadosDFD.fonte_outros=!1,this.dadosDFD.outras_fontes="",this.dadosDFD.problemas_identificados="",this.dadosDFD.frequencia_problemas="",this.dadosDFD.impacto_problemas="",this.dadosDFD.quantidade_adquirida=null,this.dadosDFD.quantidade_problemas=null,this.dadosDFD.prejuizo_estimado=null,this.dadosDFD.rdms_negativos=null,this.dadosDFD.parecer_tecnico="",this.dadosDFD.alternativas_avaliadas="",this.dadosDFD.base_legal="",this.dadosDFD.impacto_esperado="",this.dadosDFD.riscos_identificados="",this.dadosDFD.medidas_mitigadoras="",this.dadosDFD.prazo_vigencia=null,this.dadosDFD.periodicidade_revisao=""):"modelo_2"===a?(this.dadosDFD.produtos_especificacao="",this.dadosDFD.quantidade_amostras=null,this.dadosDFD.previsao_aquisicoes=null,this.dadosDFD.especificacoes_tecnicas="",this.dadosDFD.criterios_aceitacao="",this.dadosDFD.ensaios_exigidos="",this.dadosDFD.local_entrega_amostras="",this.dadosDFD.prazo_entrega_amostras="",this.dadosDFD.base_legal="",this.dadosDFD.impacto_esperado="",this.dadosDFD.riscos_identificados="",this.dadosDFD.medidas_mitigadoras="",this.dadosDFD.prazo_vigencia=null,this.dadosDFD.periodicidade_revisao=""):"modelo_geral"===a&&(this.dadosDFD.produtos_especificacao="",this.dadosDFD.quantidade_amostras=null,this.dadosDFD.previsao_aquisicoes=null,this.dadosDFD.especificacoes_tecnicas="",this.dadosDFD.criterios_aceitacao="",this.dadosDFD.ensaios_exigidos="",this.dadosDFD.local_entrega_amostras="",this.dadosDFD.prazo_entrega_amostras="",this.dadosDFD.produtos_despadronizar="",this.dadosDFD.fonte_rdm=!1,this.dadosDFD.fonte_reclamacoes_usuarios=!1,this.dadosDFD.fonte_sistema_comprar_bem=!1,this.dadosDFD.fonte_analise_tecnica=!1,this.dadosDFD.fonte_outros=!1,this.dadosDFD.outras_fontes="",this.dadosDFD.problemas_identificados="",this.dadosDFD.frequencia_problemas="",this.dadosDFD.impacto_problemas="",this.dadosDFD.quantidade_adquirida=null,this.dadosDFD.quantidade_problemas=null,this.dadosDFD.prejuizo_estimado=null,this.dadosDFD.rdms_negativos=null,this.dadosDFD.parecer_tecnico="",this.dadosDFD.alternativas_avaliadas="")},async salvarDFD(){if(this.salvando)console.log("âš ï¸ JÃ¡ estÃ¡ salvando DFD, ignorando nova chamada");else try{this.salvando=!0;const a={...this.dadosDFD,modelo_usado:this.modeloSelecionado},o=await i["default"].criarDFD(this.processoId,a);this.$emit("dfd-criado",o)}catch(a){console.error("Erro ao salvar DFD:",a),alert(`Erro ao salvar DFD: ${a.message}`)}finally{this.salvando=!1}},async salvarRascunho(){try{this.salvando=!0;const a={processoId:this.processoId,modeloSelecionado:this.modeloSelecionado,dadosDFD:{...this.dadosDFD},dataSalvo:(new Date).toISOString()};localStorage.setItem(`dfd_rascunho_${this.processoId}`,JSON.stringify(a)),alert("Rascunho salvo com sucesso!")}catch(a){console.error("Erro ao salvar rascunho:",a),alert("Erro ao salvar rascunho")}finally{this.salvando=!1}},salvarRascunhoAutomatico(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout),this.autoSaveTimeout=setTimeout((()=>{try{if(this.modeloSelecionado&&(this.dadosDFD.nome_presidente.trim()||this.dadosDFD.justificativa.trim()||this.dadosDFD.necessidade_descricao.trim())){const a={processoId:this.processoId,modeloSelecionado:this.modeloSelecionado,dadosDFD:{...this.dadosDFD},dataSalvo:(new Date).toISOString(),autoSave:!0};localStorage.setItem(`dfd_rascunho_${this.processoId}`,JSON.stringify(a)),console.log("ğŸ“„ Rascunho DFD salvo automaticamente")}}catch(a){console.error("Erro ao salvar rascunho automaticamente:",a)}}),2e3)},carregarRascunho(){try{const a=localStorage.getItem(`dfd_rascunho_${this.processoId}`);if(a){const o=JSON.parse(a);return this.modeloSelecionado=o.modeloSelecionado,this.dadosDFD={...o.dadosDFD},!0}}catch(a){console.error("Erro ao carregar rascunho:",a)}return!1},gerarPreviewHTML(){return this.modeloSelecionado?`\n        <div class="documento-dfd">\n          <h1>DOCUMENTO DE FORMALIZAÃ‡ÃƒO DE DEMANDA - ${this.modeloSelecionado.toUpperCase()}</h1>\n          \n          <div class="secao">\n            <h2>PROCESSO</h2>\n            <p><strong>NÃºmero:</strong> ${this.numeroProcesso}</p>\n            <p><strong>Tipo:</strong> ${"padronizacao"===this.tipoProcesso?"PadronizaÃ§Ã£o":"DespadronizaÃ§Ã£o"}</p>\n          </div>\n\n          <div class="secao">\n            <h2>JUSTIFICATIVA</h2>\n            <p>${this.dadosDFD.justificativa||"[NÃ£o preenchido]"}</p>\n          </div>\n\n          <div class="secao">\n            <h2>DESCRIÃ‡ÃƒO DA NECESSIDADE</h2>\n            <p>${this.dadosDFD.necessidade_descricao||"[NÃ£o preenchido]"}</p>\n          </div>\n\n          ${"modelo_1"===this.modeloSelecionado?`\n            ${this.dadosDFD.quantidade_estimada?`\n            <div class="secao">\n              <h2>QUANTIDADE ESTIMADA</h2>\n              <p>${this.dadosDFD.quantidade_estimada}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.prazo_entrega?`\n            <div class="secao">\n              <h2>PRAZO DE ENTREGA</h2>\n              <p>${this.dadosDFD.prazo_entrega}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.local_entrega?`\n            <div class="secao">\n              <h2>LOCAL DE ENTREGA</h2>\n              <p>${this.dadosDFD.local_entrega}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.criterios_aceitacao?`\n            <div class="secao">\n              <h2>CRITÃ‰RIOS DE ACEITAÃ‡ÃƒO</h2>\n              <p>${this.dadosDFD.criterios_aceitacao}</p>\n            </div>\n            `:""}\n          `:""}\n\n          ${"modelo_2"===this.modeloSelecionado?`\n            ${this.dadosDFD.fonte_reclamacoes?`\n            <div class="secao">\n              <h2>FONTE DAS RECLAMAÃ‡Ã•ES</h2>\n              <p>${this.dadosDFD.fonte_reclamacoes}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.descricao_problemas?`\n            <div class="secao">\n              <h2>PROBLEMAS IDENTIFICADOS</h2>\n              <p>${this.dadosDFD.descricao_problemas}</p>\n            </div>\n            `:""}\n          `:""}\n\n          ${"modelo_geral"===this.modeloSelecionado?`\n            ${this.dadosDFD.base_legal?`\n            <div class="secao">\n              <h2>BASE LEGAL</h2>\n              <p>${this.dadosDFD.base_legal}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.impacto_esperado?`\n            <div class="secao">\n              <h2>IMPACTO ESPERADO</h2>\n              <p>${this.dadosDFD.impacto_esperado}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.riscos_identificados?`\n            <div class="secao">\n              <h2>RISCOS IDENTIFICADOS</h2>\n              <p>${this.dadosDFD.riscos_identificados}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.medidas_mitigadoras?`\n            <div class="secao">\n              <h2>MEDIDAS MITIGADORAS</h2>\n              <p>${this.dadosDFD.medidas_mitigadoras}</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.prazo_vigencia?`\n            <div class="secao">\n              <h2>PRAZO DE VIGÃŠNCIA</h2>\n              <p>${this.dadosDFD.prazo_vigencia} meses</p>\n            </div>\n            `:""}\n\n            ${this.dadosDFD.periodicidade_revisao?`\n            <div class="secao">\n              <h2>PERIODICIDADE DE REVISÃƒO</h2>\n              <p>${this.dadosDFD.periodicidade_revisao}</p>\n            </div>\n            `:""}\n          `:""}\n\n          ${this.dadosDFD.observacoes_especiais?`\n          <div class="secao">\n            <h2>OBSERVAÃ‡Ã•ES ESPECIAIS</h2>\n            <p>${this.dadosDFD.observacoes_especiais}</p>\n          </div>\n          `:""}\n\n          <div class="assinatura">\n            <p>Data: ${(new Date).toLocaleDateString("pt-BR")}</p>\n            <br>\n            <p>_________________________________________</p>\n            <p>Presidente da CPPM</p>\n          </div>\n        </div>\n      `:""}},mounted(){if("despadronizacao"===this.tipoProcesso&&(this.modeloSelecionado="modelo_2"),this.carregarRascunho()){const a=confirm("Foi encontrado um rascunho salvo. Deseja carregÃ¡-lo?");a||(this.modeloSelecionado=null,this.dadosDFD={justificativa:"",necessidade_descricao:"",quantidade_estimada:null,prazo_entrega:"",local_entrega:"",criterios_aceitacao:"",observacoes_especiais:"",fonte_reclamacoes:"",descricao_problemas:"",base_legal:"",impacto_esperado:"",riscos_identificados:"",medidas_mitigadoras:"",prazo_vigencia:null,periodicidade_revisao:""})}},beforeUnmount(){this.autoSaveTimeout&&clearTimeout(this.autoSaveTimeout)}},v=p;var g=t(1656),_=(0,g.A)(v,u,m,!1,null,"0fa63dcc",null);const h=_.exports;var f=function(){var a=this,o=a._self._c;return o("div",{staticClass:"folha-rosto"},[o("div",{staticClass:"folha-rosto-simples"},[o("div",{staticClass:"caixa-bordered"},[o("div",{staticClass:"numero-processo"},[o("strong",[a._v("PROCESSO ADMINISTRATIVO NÂº "+a._s(a.numeroProcesso||"[nÃ£o definido]"))])]),o("div",{staticClass:"campo"},[o("strong",[a._v("NOME DO Ã“RGÃƒO:")]),a._v(" "+a._s(a.dadosOrgao.nome)+" ")]),o("div",{staticClass:"campo"},[o("strong",[a._v("INTERESSADO(A):")]),a._v(" "+a._s(a.dadosOrgao.departamento||a.dadosOrgao.unidade_interessada)+" ")]),o("div",{staticClass:"campo"},[o("strong",[a._v("DATA DE AUTUAÃ‡ÃƒO:")]),a._v(" "+a._s(a.dataInicio)+" ")]),o("div",{staticClass:"campo objeto"},[o("strong",[a._v("OBJETO:")]),a._v(" "+a._s(a.objetoTexto)+" ")]),a.observacoes?o("div",{staticClass:"campo observacoes"},[o("strong",[a._v("OBSERVAÃ‡Ã•ES:")]),o("div",{staticClass:"observacoes-conteudo"},[a._v(a._s(a.observacoes))])]):a._e()]),a._m(0)])])},C=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"folha-numero"},[o("p",[a._v("Fl. 001")])])}];const b={name:"FolhaRosto",props:{numeroProcesso:{type:String,default:""},tipoProcesso:{type:String,required:!0,validator:a=>["padronizacao","despadronizacao"].includes(a)},dadosOrgao:{type:Object,default:()=>({nome:"",departamento:"",unidade_interessada:""})},dataInicio:{type:String,default:()=>(new Date).toLocaleDateString("pt-BR")},observacoes:{type:String,default:""}},computed:{objetoTexto(){return"padronizacao"===this.tipoProcesso?"CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.":"DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS."}}},D=b;var E=(0,g.A)(D,f,C,!1,null,"93992612",null);const A=E.exports,w={name:"AssistenteProcesso",components:{FormularioDFD:h,FolhaRosto:A},props:{processoEdicao:{type:Object,default:null},modoEdicao:{type:Boolean,default:!1},tipoProcessoInicial:{type:String,default:null}},data(){return{etapaAtual:0,processando:!1,processoTemporario:null,dfdCriada:null,dadosProcesso:{tipo_processo:"",numero_processo:"",nome_orgao:"",unidade_interessada:"",data_autuacao:(new Date).toISOString().split("T")[0]},produtos:[],produtosAprovados:[],produtosSelecionados:[],mostrarSeletorProdutos:!1,carregandoProdutos:!1,documentos:[],dadosEdital:{numero_edital:"",data_publicacao:"",arquivo:null},erroEdital:"",dragoverEdital:!1,editaisDisponiveis:[],editalSelecionado:null,carregandoEditais:!1,editaisCarregados:!1}},computed:{etapas(){const a=[{titulo:"Folha de Rosto",descricao:"Escolha do tipo e dados iniciais"},{titulo:"InformaÃ§Ãµes BÃ¡sicas",descricao:"Dados do Ã³rgÃ£o e unidade"},{titulo:"DFD",descricao:"Documento de FormalizaÃ§Ã£o de Demanda"}];return"padronizacao"===this.dadosProcesso.tipo_processo&&a.push({titulo:"Produtos",descricao:"ConfiguraÃ§Ã£o dos produtos"}),a.push({titulo:"DocumentaÃ§Ã£o",descricao:"Upload de documentos do processo"}),a},podeAvancar(){switch(this.etapaAtual){case 0:return this.dadosProcesso.tipo_processo&&this.dadosProcesso.numero_processo&&this.dadosProcesso.nome_orgao&&this.dadosProcesso.unidade_interessada&&this.dadosProcesso.data_autuacao;case 1:return!0;case 2:return this.dfdCriada;case 3:return"padronizacao"!==this.dadosProcesso.tipo_processo||this.produtos.length>0&&this.produtos.every((a=>a.nome_produto));case 4:return!0;default:return!0}},editalVinculado(){return this.dadosProcesso.edital_vinculado||!1}},async mounted(){if(!this.modoEdicao)return console.log("ğŸ†• CRIANDO NOVO PROCESSO - Iniciando assistente limpo"),this.etapaAtual=0,void this.limparDados();console.log("âœï¸ EDITANDO PROCESSO EXISTENTE - Carregando dados salvos");const a=await this.carregarProcessoSalvo();!a&&this.modoEdicao&&this.processoEdicao&&await this.carregarDadosProcesso(),a&&(this.processoTemporario?.id||this.processoEdicao?.id)&&(await this.carregarProdutosProcesso(),this.determinarEtapaAtual())},methods:{async carregarDadosProcesso(){try{console.log("Carregando dados do processo:",this.processoEdicao),this.processoTemporario=this.processoEdicao,this.dadosProcesso={tipo_processo:this.processoEdicao.tipo_processo||"",numero_processo:this.processoEdicao.numero_processo||"",nome_orgao:this.processoEdicao.nome_orgao||"",unidade_interessada:this.processoEdicao.unidade_interessada||"",data_autuacao:this.processoEdicao.data_autuacao?new Date(this.processoEdicao.data_autuacao).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],numero_edital:this.processoEdicao.numero_edital||"",edital_vinculado:this.processoEdicao.edital_vinculado||!1,data_vinculacao_edital:this.processoEdicao.data_vinculacao_edital||null},"padronizacao"===this.processoEdicao.tipo_processo&&await this.carregarProdutosProcesso(),await this.carregarDocumentosProcesso(),this.dfdCriada={id:"existing",processo_id:this.processoEdicao.id},this.determinarEtapaAtual(),console.log("Dados carregados com sucesso:",{dadosProcesso:this.dadosProcesso,produtos:this.produtos,documentos:this.documentos,etapaAtual:this.etapaAtual})}catch(a){console.error("Erro ao carregar dados do processo:",a),alert("Erro ao carregar dados do processo: "+a.message)}},async carregarProdutosProcesso(){try{const a=this.processoEdicao?.id||this.processoTemporario?.id;if(!a)return void console.warn("Nenhum processo ID disponÃ­vel para carregar produtos");const{data:o,error:t}=await r.ND.from("produtos_prequalificacao").select("*").eq("processo_id",a);if(t)throw t;this.produtos=o?.map((a=>({id:a.id,nome_produto:a.nome_produto,marca:a.marca,modelo:a.modelo,fabricante:a.fabricante,categoria_produto:a.categoria_produto,especificacoes_tecnicas:a.especificacoes_tecnicas,quantidade_amostras:a.quantidade_amostras||0,valor_estimado:a.valor_estimado||null,status_produto:a.status_produto,parecer_cppm:a.parecer_cppm,observacoes_tecnicas:a.observacoes_tecnicas})))||[],this.produtosSelecionados=this.produtos.map((a=>a.id))||[],console.log(`ğŸ“¦ ${this.produtos.length} produtos carregados e ${this.produtosSelecionados.length} marcados como selecionados`)}catch(a){console.error("Erro ao carregar produtos do processo:",a),this.produtos=[],this.produtosSelecionados=[]}},async carregarDocumentosProcesso(){try{const o=this.processoEdicao?.id||this.processoTemporario?.id;if(!o)return console.warn("Nenhum ID de processo disponÃ­vel para carregar documentos"),void(this.documentos=[]);console.log("ğŸ” Carregando documentos para processo ID:",o);const{data:t,error:e}=await r.ND.from("documentos_processo").select("*").eq("processo_id",o).order("numero_sequencial",{ascending:!0});if(e)return console.warn("Erro ao carregar documentos (normal se tabela nÃ£o existe):",e),void(this.documentos=[]);const s=t?.filter((a=>{const o=a.tipo_documento||"";return"DFD"!==o&&"FOLHA_ROSTO"!==o}))||[],i=s.map((a=>({nome:a.nome_documento||a.titulo||"Documento",tipo:a.tipo_documento||"Documento",data_upload:new Date(a.data_criacao||a.criado_em||new Date),pagina:a.numero_sequencial||0,url_arquivo:a.arquivo_url||a.url_arquivo,id:a.id,origem:"processo"})));try{const{data:a,error:t}=await r.ND.from("documentos_produtos_processo").select("*").eq("processo_id",o).order("created_at",{ascending:!0});if(!t&&a){const o=a.map((a=>({nome:`${a.nome_arquivo} (${a.nome_produto})`,tipo:"DOCUMENTO_PRODUTO",data_upload:new Date(a.created_at),pagina:0,url_arquivo:a.url_arquivo,id:a.id,origem:"produto",produto:a.nome_produto,marca:a.marca,fabricante:a.fabricante})));this.documentos=[...i,...o],console.log(`ğŸ“„ Carregados ${i.length} docs do processo + ${o.length} docs de produtos`)}else this.documentos=i,console.log(`ğŸ“„ Carregados apenas ${i.length} docs do processo (sem docs de produtos)`)}catch(a){console.warn("Erro ao carregar documentos dos produtos:",a),this.documentos=i}}catch(o){console.warn("Erro ao carregar documentos (pode ser normal):",o),this.documentos=[]}},determinarEtapaAtual(){if(this.dadosProcesso.tipo_processo&&this.dadosProcesso.numero_processo)if(this.dadosProcesso.nome_orgao&&this.dadosProcesso.unidade_interessada){if(this.dfdCriada)return"padronizacao"===this.dadosProcesso.tipo_processo?0===this.produtos.length||0===this.produtosSelecionados.length?void(this.etapaAtual=3):void(this.etapaAtual=4):void(this.etapaAtual=3);this.etapaAtual=2}else this.etapaAtual=1;else this.etapaAtual=0},selecionarTipo(a){this.dadosProcesso.tipo_processo=a},async proximaEtapa(){await this.salvarProgressoEtapaAtual(),1===this.etapaAtual&&await this.criarProcessoTemporario(),3===this.etapaAtual&&"padronizacao"===this.dadosProcesso.tipo_processo&&await this.salvarProdutos(),4===this.etapaAtual&&await this.salvarDocumentosProcesso(),this.etapaAtual++},async voltarEtapa(){await this.salvarProgressoEtapaAtual(),this.etapaAtual>0&&(this.etapaAtual--,await this.carregarProgressoEtapa(this.etapaAtual))},async salvarProgressoEtapaAtual(){try{let a=null;this.modoEdicao&&this.processoEdicao?.id?a=`processo_edicao_${this.processoEdicao.id}`:(a=localStorage.getItem("processo_atual_novo"),a||(a=`processo_novo_${Date.now()}`,localStorage.setItem("processo_atual_novo",a)));const o={etapaAtual:this.etapaAtual,dadosProcesso:{...this.dadosProcesso},dadosBasicos:{...this.dadosBasicos},dadosDFD:{...this.dadosDFD},produtosSelecionados:Array.isArray(this.produtosSelecionados)?[...this.produtosSelecionados]:[],documentosUpload:[...this.documentosUpload||[]],timestamp:(new Date).toISOString(),processoId:this.processoTemporario?.id||this.processoEdicao?.id,modoEdicao:this.modoEdicao};localStorage.setItem(a,JSON.stringify(o)),console.log(`ğŸ“„ Auto-save realizado - Etapa ${this.etapaAtual}`),console.log("ğŸ“„ DEBUG: Produtos selecionados salvos:",o.produtosSelecionados)}catch(a){console.error("Erro ao salvar progresso da etapa:",a)}},async carregarProgressoEtapa(a){try{const o=this.modoEdicao?`processo_edicao_${this.processoEdicao?.id}`:localStorage.getItem("processo_atual_novo");if(!o)return;const t=localStorage.getItem(o);if(t){const o=JSON.parse(t);this.dadosProcesso={...o.dadosProcesso},this.dadosBasicos={...o.dadosBasicos},this.dadosDFD={...o.dadosDFD},this.produtosSelecionados=[...o.produtosSelecionados||[]],console.log("ğŸ“„ DEBUG: Produtos selecionados carregados do auto-save:",this.produtosSelecionados),this.documentosUpload=[...o.documentosUpload||[]],console.log(`ğŸ“„ Dados carregados - Etapa ${a}`)}}catch(o){console.error("Erro ao carregar progresso da etapa:",o)}},async carregarProcessoSalvo(){try{let a=null;if(a=this.modoEdicao&&this.processoEdicao?.id?`processo_edicao_${this.processoEdicao.id}`:localStorage.getItem("processo_atual_novo"),!a)return!1;const o=localStorage.getItem(a);if(o){const a=JSON.parse(o);return this.etapaAtual=a.etapaAtual||0,this.dadosProcesso={...a.dadosProcesso},this.dadosBasicos={...a.dadosBasicos},this.dadosDFD={...a.dadosDFD},this.produtosSelecionados=[...a.produtosSelecionados||[]],console.log("ğŸ“„ DEBUG: Produtos selecionados carregados do auto-save:",this.produtosSelecionados),this.documentosUpload=[...a.documentosUpload||[]],a.processoId&&(this.processoTemporario={id:a.processoId}),console.log(`ğŸ“„ Processo carregado - Retornando para Etapa ${this.etapaAtual}`),!0}}catch(a){console.error("Erro ao carregar processo salvo:",a)}return!1},async criarProcessoTemporario(){try{if(this.processando=!0,this.processoTemporario||this.modoEdicao)return console.log("ğŸ”„ DEBUG: Processo jÃ¡ existe ou estÃ¡ em modo ediÃ§Ã£o, pulando criaÃ§Ã£o"),console.log("ğŸ”„ Processo existente:",this.processoTemporario||this.processoEdicao),this.processoTemporario||this.processoEdicao;console.log("ğŸš€ DEBUG: Criando novo processo com dados:",this.dadosProcesso),this.processoTemporario=await i["default"].criarProcesso(this.dadosProcesso),console.log("âœ… DEBUG: Processo criado com sucesso:",this.processoTemporario),await this.criarFolhaDeRosto()}catch(a){throw console.error("Erro ao criar processo:",a),alert("Erro ao criar processo: "+a.message),a}finally{this.processando=!1}},async criarFolhaDeRosto(){try{const a={processo_id:this.processoTemporario.id,tenant_id:this.processoTemporario.tenant_id,numero_folha:1,tipo_documento:"FOLHA_ROSTO",nome_documento:"Folha de Rosto do Processo Administrativo",titulo:"Folha de Rosto",descricao:"Folha de rosto do processo administrativo",data_autuacao:(new Date).toISOString(),assinado:!1,conteudo_html:null},{error:o}=await r.ND.from("documentos_processo").insert([a]);if(o)throw console.error("Erro ao criar folha de rosto:",o),o;console.log("Folha de rosto criada com sucesso")}catch(a){throw console.error("Erro ao criar folha de rosto:",a),a}},dfdCriado(a){this.dfdCriada=a,this.proximaEtapa()},async abrirSeletorProdutos(){this.mostrarSeletorProdutos=!0,await this.carregarProdutosAprovados()},async carregarProdutosAprovados(){try{this.carregandoProdutos=!0;const{data:a,error:o}=await r.ND.from("produtos").select("*").eq("tenant_id",await this.getTenantId()).eq("status","aprovado").order("nome",{ascending:!0});if(o)throw console.error("Erro ao carregar produtos aprovados:",o),o;this.produtosAprovados=a||[]}catch(a){console.error("Erro ao carregar produtos aprovados:",a),alert("Erro ao carregar produtos aprovados: "+a.message)}finally{this.carregandoProdutos=!1}},toggleProdutoSelecionado(a){console.log("ğŸ”„ DEBUG: Toggling produto:",a.nome_produto||a.nome,"ID:",a.id),console.log("ğŸ”„ DEBUG: produtosSelecionados ANTES:",this.produtosSelecionados);const o=this.produtosSelecionados.indexOf(a.id);o>-1?(this.produtosSelecionados.splice(o,1),console.log("âŒ DEBUG: Produto removido da seleÃ§Ã£o")):(this.produtosSelecionados.push(a.id),console.log("âœ… DEBUG: Produto adicionado Ã  seleÃ§Ã£o")),console.log("ğŸ”„ DEBUG: produtosSelecionados DEPOIS:",this.produtosSelecionados)},async confirmarSelecaoProdutos(){try{this.processando=!0;const a=this.produtosAprovados.filter((a=>this.produtosSelecionados.includes(a.id))),o=[];for(const t of a){const{data:a,error:e}=await r.ND.from("documentos").select("*").eq("produto_id",t.id);e&&console.warn("Erro ao carregar documentos do produto:",t.nome,e),console.log("Produto original:",t),console.log("Documentos carregados:",a),o.push({...t,nome_produto:t.nome||t.nome_produto,categoria_produto:t.categoria||t.categoria_produto||"Categoria nÃ£o informada",especificacoes_tecnicas:t.especificacoes||t.especificacoes_tecnicas||t.descricao||"EspecificaÃ§Ãµes nÃ£o disponÃ­veis",fabricante:t.fabricante||"Fabricante nÃ£o informado",quantidade_amostras:0,valor_estimado:null,observacoes_processo:"",documentos:a||[],documentos_adicionados:[]})}this.produtos=o,this.mostrarSeletorProdutos=!1,this.produtosSelecionados=[]}catch(a){console.error("Erro ao carregar documentos dos produtos:",a),alert("Erro ao carregar documentos dos produtos: "+a.message)}finally{this.processando=!1}},cancelarSelecaoProdutos(){this.mostrarSeletorProdutos=!1,this.produtosSelecionados=[]},removerProdutoSelecionado(a){this.produtos.splice(a,1)},adicionarDocumentoProcesso(a,o){const t=this.produtos[o];if(t.documentos_adicionados||(t.documentos_adicionados=[]),t.documentos_adicionados.includes(a.id))t.documentos_adicionados=t.documentos_adicionados.filter((o=>o!==a.id)),this.documentos=this.documentos.filter((o=>o.documento_produto_id!==a.id));else{t.documentos_adicionados.push(a.id);const o="padronizacao"===this.dadosProcesso.tipo_processo?5:4;this.documentos.push({nome:`${t.nome_produto} - ${a.nome}`,tipo:a.tipo||"Documento do Produto",data_upload:new Date,pagina:o+this.documentos.length,url_arquivo:a.arquivo_url,documento_produto_id:a.id,produto_id:t.id,documento_original:a})}const e="padronizacao"===this.dadosProcesso.tipo_processo?5:4;this.documentos.forEach(((a,o)=>{a.pagina=e+o}))},verCadastroCompleto(a){const o=`/analise/${a.id}`;window.open(o,"_blank")},async getTenantId(){const{data:a}=await r.ND.auth.getSession(),o=a?.session?.user;return o?.user_metadata?.tenant_id},async salvarProdutos(){try{this.processando=!0,console.log("ğŸ” DEBUG: Produtos disponÃ­veis:",this.produtos.length),console.log("ğŸ” DEBUG: Produtos selecionados IDs:",this.produtosSelecionados),console.log("ğŸ” DEBUG: Tipo de produtosSelecionados:",typeof this.produtosSelecionados,Array.isArray(this.produtosSelecionados)),console.log("ğŸ” DEBUG: ConteÃºdo real de produtosSelecionados:",JSON.stringify(this.produtosSelecionados));let o=[];Array.isArray(this.produtosSelecionados)&&(o=this.produtosSelecionados.filter((a=>"string"===typeof a&&a.length>0))),console.log("ğŸ”§ DEBUG: Array limpo de produtos selecionados:",o),0===o.length&&(console.log("âš ï¸ DEBUG: Array vazio! Tentando recuperar produtos da interface..."),o=this.produtos.map((a=>a.id)),console.log("ğŸ”„ DEBUG: Usando todos os produtos como selecionados:",o));const t=this.produtos.filter((a=>o.includes(a.id)&&!a.processo_id));console.log(`ğŸ’¾ DEBUG: Produtos para salvar (${t.length}):`,t),console.log("ğŸ“‹ DEBUG: ID do processo onde salvar:",this.processoTemporario.id);for(const e of t)try{console.log("ğŸ”„ DEBUG: Salvando produto:",e.nome_produto||e.nome),console.log("ğŸ”„ DEBUG: Estrutura completa do produto antes de salvar:",e),console.log("ğŸ”„ DEBUG: Documentos do produto (se existirem):",e.documentos_produto||"NENHUM");const a=await i["default"].adicionarProduto(this.processoTemporario.id,e);console.log("âœ… DEBUG: Produto salvo com sucesso:",a)}catch(a){if("PRODUTO_JA_USADO"!==a.code)throw a;{const a=confirm(`âš ï¸ PRODUTO JÃ UTILIZADO\n\nO produto "${e.nome_produto||e.nome}" jÃ¡ foi usado em outro processo de prÃ©-qualificaÃ§Ã£o.\n\nDeseja reutilizÃ¡-lo mesmo assim neste processo?\n\nClique OK para REUTILIZAR ou Cancelar para PARAR`);if(!a)throw new Error(`OperaÃ§Ã£o cancelada pelo usuÃ¡rio para o produto: ${e.nome_produto||e.nome}`);{const a={...e};delete a.id,await i["default"].adicionarProduto(this.processoTemporario.id,a,!0)}}}}catch(a){throw console.error("Erro ao salvar produtos:",a),alert("Erro ao salvar produtos: "+a.message),a}finally{this.processando=!1}},adicionarDocumento(){const a=document.createElement("input");a.type="file",a.multiple=!0,a.accept=".pdf,.doc,.docx,.jpg,.jpeg,.png",a.addEventListener("change",(a=>{const o=Array.from(a.target.files),t="padronizacao"===this.dadosProcesso.tipo_processo?5:4;o.forEach(((a,o)=>{this.documentos.push({nome:a.name,tipo:this.obterTipoDocumento(a.name),arquivo:a,data_upload:new Date,pagina:t+this.documentos.length+o})}))})),a.click()},obterTipoDocumento(a){const o=a.split(".").pop().toLowerCase(),t={pdf:"Documento PDF",doc:"Documento Word",docx:"Documento Word",jpg:"Imagem JPEG",jpeg:"Imagem JPEG",png:"Imagem PNG"};return t[o]||"Documento"},formatarData(a){return new Date(a).toLocaleString("pt-BR")},formatarDataBrasileira(a){if(!a)return"";const[o,t,e]=a.split("-"),s=new Date(o,t-1,e);return s.toLocaleDateString("pt-BR")},visualizarDocumento(a){console.log("Visualizar documento:",a);const o=a.url_arquivo||a.arquivo_url||a.arquivo;if(o&&"string"===typeof o)return console.log("Abrindo URL:",o),void window.open(o,"_blank");if(a.arquivo){const o=URL.createObjectURL(a.arquivo);window.open(o,"_blank")}else"FOLHA_ROSTO"!==a.tipo?"DFD"!==a.tipo?alert("âš ï¸ Documento nÃ£o disponÃ­vel para visualizaÃ§Ã£o.\n\nTipo: "+a.tipo):this.gerarPDFDFD():this.gerarPDFFolhaRosto()},async gerarPDFFolhaRosto(){try{const a=this.gerarConteudoFolhaRosto(),o=window.open("","_blank");o.document.write(a),o.document.close(),setTimeout((()=>{o.focus(),o.print()}),500)}catch(a){console.error("Erro ao gerar PDF da folha de rosto:",a),alert("Erro ao gerar PDF da folha de rosto: "+a.message)}},async gerarPDFDFD(){try{const a=this.processoTemporario?.id||this.processoEdicao?.id;console.log("ğŸ” Debug - Buscando DFD para processo ID:",a);const{data:o,error:t}=await r.ND.from("dfd_processo").select("*").eq("processo_id",a).single();if(t)return console.error("Erro ao buscar DFD:",t),void alert("Erro ao carregar dados do DFD: "+t.message);if(!o)return console.warn("âš ï¸ DFD nÃ£o encontrado para o processo ID:",a),void alert("DFD nÃ£o encontrado para este processo. Certifique-se de que o DFD foi criado corretamente.");console.log("âœ… DFD encontrado:",o);const e=this.gerarConteudoDFD(o),s=window.open("","_blank");s.document.write(e),s.document.close(),setTimeout((()=>{s.focus(),s.print()}),500)}catch(a){console.error("Erro ao gerar PDF do DFD:",a),alert("Erro ao gerar PDF do DFD: "+a.message)}},gerarConteudoFolhaRosto(){(new Date).toLocaleDateString("pt-BR");const a="padronizacao"===this.dadosProcesso.tipo_processo?"CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS":"DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS";return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Folha de Rosto - ${this.dadosProcesso.numero_processo}</title>\n          <meta charset="utf-8">\n          <style>\n            .folha-rosto {\n              width: 21cm;\n              min-height: 29.7cm;\n              margin: 0 auto;\n              padding: 2cm;\n              background: white;\n              font-family: 'Times New Roman', serif;\n              font-size: 12pt;\n              line-height: 1.6;\n              box-shadow: 0 0 10px rgba(0,0,0,0.1);\n            }\n            \n            .folha-rosto-simples {\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              align-items: center;\n              min-height: 25cm;\n            }\n            \n            .caixa-bordered {\n              border: 2px solid #000;\n              padding: 1.5cm;\n              max-width: 16cm;\n              width: 100%;\n            }\n            \n            .numero-processo {\n              font-weight: bold;\n              font-size: 14pt;\n              margin-bottom: 1cm;\n              text-align: center;\n            }\n            \n            .campo {\n              margin-bottom: 1cm;\n              text-align: left;\n            }\n            \n            .campo.objeto {\n              text-align: justify;\n              line-height: 1.4;\n            }\n            \n            \n            .campo strong {\n              font-weight: bold;\n            }\n            \n            .folha-numero {\n              margin-top: 4cm;\n              text-align: center;\n              font-size: 10pt;\n              color: #666;\n            }\n            \n            .folha-numero p {\n              margin: 0;\n            }\n            \n            @media print {\n              .folha-rosto {\n                box-shadow: none;\n                margin: 0;\n                padding: 1.5cm;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="folha-rosto">\n            <div class="folha-rosto-simples">\n              <div class="caixa-bordered">\n                \n                <div class="numero-processo">\n                  <strong>PROCESSO ADMINISTRATIVO NÂº ${this.dadosProcesso.numero_processo||"[nÃ£o definido]"}</strong>\n                </div>\n                \n                <div class="campo">\n                  <strong>NOME DO Ã“RGÃƒO:</strong> ${this.dadosProcesso.nome_orgao}\n                </div>\n                \n                <div class="campo">\n                  <strong>INTERESSADO(A):</strong> ${this.dadosProcesso.unidade_interessada}\n                </div>\n                \n                <div class="campo">\n                  <strong>DATA DE AUTUAÃ‡ÃƒO:</strong> ${this.formatarDataBrasileira(this.dadosProcesso.data_autuacao)}\n                </div>\n                \n                <div class="campo objeto">\n                  <strong>OBJETO:</strong> ${a}\n                </div>\n\n                \n              </div>\n              \n              \x3c!-- NÃºmero da folha --\x3e\n              <div class="folha-numero">\n                <p>Fl. 001</p>\n              </div>\n            </div>\n          </div>\n        </body>\n        </html>\n      `},gerarConteudoDFD(a){const o=(new Date).toLocaleDateString("pt-BR"),t="padronizacao"===this.dadosProcesso.tipo_processo?"MODELO 1":"MODELO 2",e="padronizacao"===this.dadosProcesso.tipo_processo?"padronizaÃ§Ã£o de marcas e modelos de produtos":"despadronizaÃ§Ã£o de marcas e modelos de produtos";return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>DFD - ${this.dadosProcesso.numero_processo}</title>\n          <meta charset="utf-8">\n          <style>\n            @page {\n              margin: 2cm;\n              @bottom-right {\n                content: "Fl. 002";\n              }\n            }\n            body {\n              font-family: 'Times New Roman', serif;\n              font-size: 12pt;\n              line-height: 1.6;\n              color: #000;\n            }\n            .header {\n              text-align: center;\n              margin-bottom: 30px;\n            }\n            .header h1 {\n              font-size: 14pt;\n              font-weight: bold;\n              margin: 10px 0;\n            }\n            .campo {\n              margin-bottom: 15px;\n            }\n            .label {\n              font-weight: bold;\n              margin-right: 10px;\n            }\n            .tabela {\n              width: 100%;\n              border-collapse: collapse;\n              margin: 20px 0;\n            }\n            .tabela th, .tabela td {\n              border: 1px solid #000;\n              padding: 8px;\n              text-align: left;\n            }\n            .tabela th {\n              background-color: #f0f0f0;\n              font-weight: bold;\n            }\n            .assinatura {\n              margin-top: 50px;\n              text-align: center;\n            }\n            .linha-assinatura {\n              border-top: 1px solid #000;\n              margin-top: 50px;\n              padding-top: 10px;\n              width: 300px;\n              margin-left: auto;\n              margin-right: auto;\n            }\n            @media print {\n              body { margin: 0; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="header">\n            <h1>(${t} â€“ ${e.toUpperCase()})</h1>\n            <h1>DOCUMENTO DE FORMALIZAÃ‡ÃƒO DA DEMANDA â€“ DFD</h1>\n          </div>\n          \n          <div class="campo">\n            <span class="label">Demandante:</span> ComissÃ£o Permanente de PadronizaÃ§Ã£o de Materiais - CPPM\n          </div>\n          \n          <div class="campo">\n            <span class="label">Presidente:</span> ${a.nome_presidente||"_________________________________"}\n            <span class="label">MatrÃ­cula:</span> ${a.matricula_presidente||"_________________"}\n          </div>\n          \n          <div class="campo">\n            <span class="label">E-mail:</span> ${a.email_presidente||"________________________"}\n            <span class="label">Telefone:</span> ${a.telefone_presidente||"_________________"}\n          </div>\n          \n          <h2>1. OBJETO DESTE DFD:</h2>\n          <p>${e.charAt(0).toUpperCase()+e.slice(1)} que ${"padronizacao"===this.dadosProcesso.tipo_processo?"possuam os padrÃµes mÃ­nimos de qualidade":"nÃ£o mais atendem aos padrÃµes mÃ­nimos de qualidade"}, estÃ©tica, rendimento, durabilidade e adequaÃ§Ã£o ao uso.</p>\n          \n          ${this.produtos&&this.produtos.length>0?`\n          <h3>1.1. RelaÃ§Ã£o de ${"padronizacao"===this.dadosProcesso.tipo_processo?"Bens":"Bens PassÃ­veis de DespadronizaÃ§Ã£o"}:</h3>\n          <table class="tabela">\n            <thead>\n              <tr>\n                <th>ITEM</th>\n                <th>CÃ“DIGO</th>\n                <th>DESCRIÃ‡ÃƒO</th>\n                <th>UNIDADE</th>\n                <th>${"padronizacao"===this.dadosProcesso.tipo_processo?"REQUISITOS MÃNIMOS":"MOTIVAÃ‡ÃƒO"}</th>\n                ${"padronizacao"===this.dadosProcesso.tipo_processo?"<th>PREÃ‡O ESTIMADO</th>":""}\n              </tr>\n            </thead>\n            <tbody>\n              ${this.produtos.map(((a,o)=>`\n                <tr>\n                  <td>${o+1}</td>\n                  <td>${a.codigo||"N/A"}</td>\n                  <td>${a.nome_produto}</td>\n                  <td>UN</td>\n                  <td>${a.especificacoes_tecnicas||"A definir"}</td>\n                  ${"padronizacao"===this.dadosProcesso.tipo_processo?`<td>R$ ${a.valor_estimado||"0,00"}</td>`:""}\n                </tr>\n              `)).join("")}\n            </tbody>\n          </table>\n          `:""}\n          \n          <p style="margin-top: 50px;">\n            Nestes termos, encaminha-se o presente DFD Ã  autoridade competente, para ciÃªncia da presente demanda e autorizaÃ§Ã£o para a abertura e instruÃ§Ã£o do pertinente processo administrativo.\n          </p>\n          \n          <p>Em ${o}.</p>\n          \n          <div class="assinatura">\n            <div class="linha-assinatura">\n              (Assinatura EletrÃ´nica)<br>\n              Presidente da CPPM\n            </div>\n          </div>\n          \n          <div style="margin-top: 50px;">\n            <p><strong>DESPACHO:</strong></p>\n            <p>De acordo. Autorizo, nos termos da solicitaÃ§Ã£o supra.</p>\n            \n            <div class="assinatura">\n              <div class="linha-assinatura">\n                (Assinatura EletrÃ´nica)<br>\n                Cargo da Autoridade Competente\n              </div>\n            </div>\n          </div>\n        </body>\n        </html>\n      `},removerDocumento(a){this.documentos.splice(a,1);const o="padronizacao"===this.dadosProcesso.tipo_processo?5:4;this.documentos.forEach(((a,t)=>{a.pagina=o+t}))},validarNumeroEdital(){const a=/^\d{1,3}\/\d{4}$/;this.dadosEdital.numero_edital?a.test(this.dadosEdital.numero_edital)?this.erroEdital="":this.erroEdital="Formato invÃ¡lido. Use XXX/YYYY (ex: 001/2024)":this.erroEdital=""},onEditalSelect(a){const o=a.target.files[0];o&&("application/pdf"===o.type?o.size>52428800?alert("Arquivo muito grande. O limite Ã© de 50MB."):this.dadosEdital.arquivo=o:alert("Apenas arquivos PDF sÃ£o aceitos para o edital."))},onEditalDrop(a){this.dragoverEdital=!1;const o=a.dataTransfer.files[0];o&&("application/pdf"===o.type?o.size>52428800?alert("Arquivo muito grande. O limite Ã© de 50MB."):this.dadosEdital.arquivo=o:alert("Apenas arquivos PDF sÃ£o aceitos para o edital."))},removerEdital(){this.dadosEdital.arquivo=null,this.$refs.editalFileInput&&(this.$refs.editalFileInput.value="")},editarEdital(){this.dadosProcesso.edital_vinculado=!1},formatarTamanhoArquivo(a){if(0===a)return"0 Bytes";const o=1024,t=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(a)/Math.log(o));return parseFloat((a/Math.pow(o,e)).toFixed(2))+" "+t[e]},async carregarEditaisDisponiveis(){if(this.carregandoEditais)console.log("âš ï¸ JÃ¡ estÃ¡ carregando editais, ignorando nova chamada");else try{this.carregandoEditais=!0,this.editaisDisponiveis=[],console.log("ğŸ”„ Limpando lista de editais e carregando novamente...");const a=await this.getTenantId();console.log("ğŸ” Debug - Tenant ID obtido:",a),console.log("ğŸ” Debug - Nome do Ã³rgÃ£o:",this.dadosProcesso.nome_orgao);const{data:o,error:t}=await r.ND.from("editais").select("\n            id,\n            numero,\n            data_publicacao,\n            descricao,\n            status,\n            pdf_convertido_url,\n            pdf_convertido_nome,\n            url_documento,\n            tenant_id\n          ").order("data_publicacao",{ascending:!1});console.log("ğŸ” Debug - TODOS os editais no sistema:",o),t&&console.error("Erro ao carregar TODOS os editais:",t);let e=[];if(a){const{data:o,error:t}=await r.ND.from("editais").select("\n              id,\n              numero,\n              data_publicacao,\n              descricao,\n              status,\n              pdf_convertido_url,\n              pdf_convertido_nome,\n              url_documento,\n              tenant_id\n            ").eq("tenant_id",a).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});console.log("ğŸ” Debug - Editais filtrados por tenant_id:",o),e=o||[],t&&console.error("Erro ao carregar editais filtrados:",t)}if(0===e.length){const{data:a,error:o}=await r.ND.from("editais").select("\n              id,\n              numero,\n              data_publicacao,\n              descricao,\n              status,\n              pdf_convertido_url,\n              pdf_convertido_nome,\n              url_documento,\n              tenant_id\n            ").eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});console.log("ğŸ” Debug - Editais apenas por status PUBLICADO:",a),e=a||[],o&&console.error("Erro ao carregar editais publicados:",o)}this.editaisDisponiveis=e.map((a=>({id:a.id,numero_edital:a.numero,data_publicacao:a.data_publicacao,tipo_edital:"PrÃ©-QualificaÃ§Ã£o",descricao:a.descricao||"Edital de PrÃ©-QualificaÃ§Ã£o",arquivo_url:a.pdf_convertido_url||a.url_documento,status:a.status?a.status.toLowerCase():"ativo",produtos_count:0}))),console.log("ğŸ¯ Editais finais disponÃ­veis:",this.editaisDisponiveis),console.log("ğŸ”— URLs dos PDFs encontrados:",this.editaisDisponiveis.map((a=>({numero:a.numero_edital,url:a.arquivo_url,status:a.status})))),this.editaisCarregados=!0}catch(a){console.error("Erro ao buscar editais:",a),alert("Erro ao buscar editais: "+a.message),this.editaisDisponiveis=[]}finally{this.carregandoEditais=!1}},selecionarEdital(a){console.log("ğŸ“ Edital selecionado:",a),console.log("ğŸ”— URL do PDF do edital selecionado:",a.arquivo_url),this.editalSelecionado=a},async vincularEditalSelecionado(){if(this.editalSelecionado)try{this.processando=!0;const a={numero_edital:this.editalSelecionado.numero_edital,data_publicacao:this.editalSelecionado.data_publicacao,edital_id:this.editalSelecionado.id,arquivo_url:this.editalSelecionado.arquivo_url,descricao:this.editalSelecionado.descricao};await i["default"].vincularEditalProcesso(this.processoTemporario.id,a),this.dadosProcesso.edital_vinculado=!0,this.dadosProcesso.numero_edital=this.editalSelecionado.numero_edital,this.dadosProcesso.data_vinculacao_edital=new Date;const o=this.editalSelecionado.numero_edital;this.editalSelecionado=null,await this.carregarDocumentosProcesso(),alert(`âœ… Edital ${o} vinculado com sucesso!`)}catch(a){console.error("Erro ao vincular edital:",a),alert("Erro ao vincular edital: "+a.message)}finally{this.processando=!1}else alert("Selecione um edital primeiro.")},async vincularEdital(){if(this.dadosEdital.numero_edital&&this.dadosEdital.arquivo&&!this.erroEdital)try{this.processando=!0,await i["default"].vincularEditalProcesso(this.processoTemporario.id,this.dadosEdital),this.dadosProcesso.edital_vinculado=!0,this.dadosProcesso.numero_edital=this.dadosEdital.numero_edital,this.dadosProcesso.data_vinculacao_edital=new Date,alert("âœ… Edital vinculado com sucesso!")}catch(a){console.error("Erro ao vincular edital:",a),alert("Erro ao vincular edital: "+a.message)}finally{this.processando=!1}else alert("Por favor, preencha o nÃºmero do edital e selecione um arquivo PDF vÃ¡lido.")},async salvarDocumentosProcesso(){try{console.log("Salvando documentos do processo..."),this.dfdCriada&&await this.salvarDocumentoDFD(),this.editalSelecionado&&"padronizacao"===this.dadosProcesso.tipo_processo&&await this.salvarDocumentoEdital(),console.log("Documentos do processo salvos com sucesso")}catch(a){throw console.error("Erro ao salvar documentos do processo:",a),a}},async salvarDocumentoDFD(){try{const a={processo_id:this.processoTemporario.id,tenant_id:this.processoTemporario.tenant_id,numero_folha:2,tipo_documento:"DFD",nome_documento:"Documento de FormalizaÃ§Ã£o de Demanda - "+("padronizacao"===this.dadosProcesso.tipo_processo?"MODELO_1":"MODELO_2"),titulo:"DFD - Documento de FormalizaÃ§Ã£o de Demanda",descricao:`Documento de FormalizaÃ§Ã£o de Demanda do processo de ${this.dadosProcesso.tipo_processo}`,data_autuacao:(new Date).toISOString(),assinado:!1,conteudo_html:null},{error:o}=await r.ND.from("documentos_processo").insert([a]);if(o)throw console.error("Erro ao salvar DFD:",o),o;console.log("DFD salvo com sucesso")}catch(a){throw console.error("Erro ao salvar documento DFD:",a),a}},async salvarDocumentoEdital(){try{const a={processo_id:this.processoTemporario.id,tenant_id:this.processoTemporario.tenant_id,numero_folha:3,tipo_documento:"EDITAL",nome_documento:`Edital de Chamamento PÃºblico - ${this.editalSelecionado.titulo}`,titulo:"Edital de Chamamento PÃºblico",descricao:"Edital de Chamamento PÃºblico para PrÃ©-qualificaÃ§Ã£o de Bens",data_autuacao:(new Date).toISOString(),arquivo_url:this.editalSelecionado.arquivo_url,assinado:!1,conteudo_html:null},{error:o}=await r.ND.from("documentos_processo").insert([a]);if(o)throw console.error("Erro ao salvar edital:",o),o;console.log("Edital salvo como documento do processo")}catch(a){throw console.error("Erro ao salvar documento edital:",a),a}},limparProgressoSalvo(){try{const a=this.modoEdicao?`processo_edicao_${this.processoEdicao?.id}`:localStorage.getItem("processo_atual_novo");a&&(localStorage.removeItem(a),this.modoEdicao||localStorage.removeItem("processo_atual_novo"),console.log("ğŸ“„ Progresso salvo limpo com sucesso"))}catch(a){console.error("Erro ao limpar progresso salvo:",a)}},async finalizarProcesso(){try{this.processando=!0,console.log("ğŸ DEBUG: Iniciando finalizaÃ§Ã£o do processo:",this.processoTemporario.id);const a=await i["default"].listarProdutosProcesso(this.processoTemporario.id);console.log(`ğŸ“‹ DEBUG: Produtos encontrados no processo antes da finalizaÃ§Ã£o (${a.length}):`,a),"despadronizacao"===this.dadosProcesso.tipo_processo&&this.documentos.length>0&&(console.log("ğŸ“„ DEBUG: Salvando documentos de upload para despadronizaÃ§Ã£o..."),await this.salvarDocumentosUpload());const o="despadronizacao"===this.dadosProcesso.tipo_processo?"criado_cpm_desp":"criado_cpm";console.log(`ğŸ”„ DEBUG: Atualizando status para ${o}`),await i["default"].atualizarProcesso(this.processoTemporario.id,{status:o}),this.limparProgressoSalvo(),this.$emit("processo-criado",this.processoTemporario)}catch(a){console.error("Erro ao finalizar processo:",a),alert("Erro ao finalizar processo: "+a.message)}finally{this.processando=!1}},limparDados(){this.dadosProcesso={tipo_processo:this.tipoProcessoInicial||"",numero_processo:"",nome_orgao:"",unidade_interessada:"",data_autuacao:(new Date).toISOString().split("T")[0],numero_edital:"",edital_vinculado:!1,data_vinculacao_edital:null},this.dadosBasicos={nome_contato:"",email_contato:"",telefone_contato:"",departamento_contato:""},this.dadosDFD={justificativa:"",descricao_necessidade:"",criterios_aceitacao:"",observacoes_especiais:""},this.produtosSelecionados=[],this.documentosUpload=[],this.processoTemporario=null,console.log("ğŸ§¹ Dados limpos para novo processo. Tipo prÃ©-selecionado:",this.tipoProcessoInicial)},async salvarDocumentosUpload(){try{console.log("ğŸ“„ DEBUG: Salvando documentos de upload no banco...");const a=this.documentos.filter((a=>a.arquivo&&!a.origem));console.log(`ğŸ“„ DEBUG: ${a.length} documentos de upload para salvar`);for(const o of a){console.log(`ğŸ“¤ Fazendo upload do arquivo: ${o.nome}`);const a=`doc_${this.processoTemporario.id}_${Date.now()}_${o.nome}`,{data:e,error:s}=await r.ND.storage.from("documentosprocessos").upload(a,o.arquivo,{cacheControl:"3600",upsert:!1});if(s)throw console.error("âŒ Erro no upload do arquivo:",s),s;const{data:{publicUrl:i}}=r.ND.storage.from("documentosprocessos").getPublicUrl(a);console.log(`âœ… Arquivo enviado com sucesso: ${e.path}`),console.log(`ğŸ”— URL gerada: ${i}`);const n=(await Promise.resolve().then(t.bind(t,2045))).default,{numero:c,folha:l}=await n.obterProximoNumero(this.processoTemporario.id);console.log(`ğŸ“‹ NumeraÃ§Ã£o gerada: ${l} (nÃºmero ${c})`);const d=(await Promise.resolve().then(t.bind(t,6507))).default,u={processo_id:this.processoTemporario.id,tenant_id:await d.getTenantId(),numero_sequencial:c,folha_numero:l,tipo_documento:"DOCUMENTO_ADICIONAL",nome_documento:o.nome,titulo:o.nome,descricao:`Documento adicional: ${o.tipo}`,arquivo_url:i,data_autuacao:(new Date).toISOString(),assinado:!1,status:"ativo"},{error:m}=await r.ND.from("documentos_processo").insert([u]);if(m)throw console.error("âŒ Erro ao salvar documento no banco:",m),m;console.log(`âœ… Documento de upload salvo: ${l}`)}console.log("âœ… Todos os documentos de upload foram salvos com sucesso")}catch(a){throw console.error("âŒ Erro ao salvar documentos de upload:",a),a}}}},x=w;var P=(0,g.A)(x,l,d,!1,null,"1c12f40a",null);const S=P.exports;var y=function(){var a=this,o=a._self._c;return a.visivel?o("div",{staticClass:"modal-overlay",on:{click:a.fechar}},[o("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“„ Vincular Edital de PrÃ©-QualificaÃ§Ã£o")]),o("button",{staticClass:"btn-close",on:{click:a.fechar}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"processo-info"},[o("h4",[a._v(a._s(a.processo.numero_processo||"Processo em criaÃ§Ã£o"))]),o("p",[a._v(a._s("padronizacao"===a.processo.tipo_processo?"âœ… PadronizaÃ§Ã£o":"âŒ DespadronizaÃ§Ã£o"))])]),o("form",{on:{submit:function(o){return o.preventDefault(),a.vincularEdital.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",[a._v("NÃºmero do Edital *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.numeroEdital,expression:"numeroEdital"}],class:{error:a.erroValidacao},attrs:{type:"text",placeholder:"001/2024",pattern:"^\\d{1,3}/\\d{4}$",title:"Formato: XXX/YYYY (ex: 001/2024)",required:""},domProps:{value:a.numeroEdital},on:{input:function(o){o.target.composing||(a.numeroEdital=o.target.value)}}}),a.erroValidacao?o("small",{staticClass:"error-msg"},[a._v(a._s(a.erroValidacao))]):o("small",{staticClass:"help-text"},[a._v("Formato: 001/2024")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Ano do Edital *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.anoEdital,expression:"anoEdital"}],attrs:{type:"number",min:2020,max:2030,required:""},domProps:{value:a.anoEdital},on:{input:function(o){o.target.composing||(a.anoEdital=o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Data de PublicaÃ§Ã£o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.dataPublicacao,expression:"dataPublicacao"}],attrs:{type:"date"},domProps:{value:a.dataPublicacao},on:{input:function(o){o.target.composing||(a.dataPublicacao=o.target.value)}}}),o("small",{staticClass:"help-text"},[a._v("Data em que o edital foi publicado no diÃ¡rio oficial (opcional)")])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Arquivo do Edital (PDF) *")]),o("div",{staticClass:"file-upload-area",class:{dragover:a.dragover,"has-file":a.arquivoSelecionado},on:{dragover:function(o){o.preventDefault(),a.dragover=!0},dragleave:function(o){a.dragover=!1},drop:function(o){return o.preventDefault(),a.onFileDrop.apply(null,arguments)}}},[o("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".pdf",required:""},on:{change:a.onFileSelect}}),a.arquivoSelecionado?a._e():o("div",{staticClass:"upload-placeholder"},[o("div",{staticClass:"upload-icon"},[a._v("ğŸ“„")]),o("p",[a._v("Arraste o arquivo PDF aqui ou "),o("button",{staticClass:"btn-link",attrs:{type:"button"},on:{click:function(o){return a.$refs.fileInput.click()}}},[a._v("clique para selecionar")])]),o("small",[a._v("Apenas arquivos PDF sÃ£o aceitos")])]),a.arquivoSelecionado?o("div",{staticClass:"selected-file"},[o("div",{staticClass:"file-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"file-info"},[o("strong",[a._v(a._s(a.arquivoSelecionado.name))]),o("small",[a._v(a._s(a.formatarTamanhoArquivo(a.arquivoSelecionado.size)))])]),o("button",{staticClass:"btn-remove",attrs:{type:"button"},on:{click:a.removerArquivo}},[a._v("ğŸ—‘ï¸")])]):a._e()])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Objeto do Edital")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.objeto,expression:"objeto"}],attrs:{rows:"3",placeholder:"DescriÃ§Ã£o do objeto do edital (opcional - serÃ¡ preenchido automaticamente se nÃ£o informado)"},domProps:{value:a.objeto},on:{input:function(o){o.target.composing||(a.objeto=o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("ObservaÃ§Ãµes")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.observacoes,expression:"observacoes"}],attrs:{rows:"2",placeholder:"ObservaÃ§Ãµes sobre o edital (opcional)"},domProps:{value:a.observacoes},on:{input:function(o){o.target.composing||(a.observacoes=o.target.value)}}})]),a.processo.produtos&&a.processo.produtos.length>0?o("div",{staticClass:"produtos-relacionados"},[o("h4",[a._v("ğŸ“¦ Produtos que serÃ£o incluÃ­dos no edital:")]),o("div",{staticClass:"produtos-lista"},a._l(a.processo.produtos,(function(t){return o("div",{key:t.id,staticClass:"produto-item"},[o("span",{staticClass:"produto-nome"},[a._v(a._s(t.nome_produto))]),o("span",{staticClass:"produto-marca"},[a._v(a._s(t.marca))])])})),0)]):a._e(),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fechar}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando||!!a.erroValidacao||!a.arquivoSelecionado}},[a._v(" "+a._s(a.salvando?"Vinculando...":"Vincular Edital")+" ")])])])])])]):a._e()},O=[];const $={name:"ModalVincularEdital",props:{visivel:{type:Boolean,default:!1},processo:{type:Object,required:!0}},data(){return{numeroEdital:"",anoEdital:(new Date).getFullYear(),dataPublicacao:"",objeto:"",observacoes:"",arquivoSelecionado:null,dragover:!1,salvando:!1,erroValidacao:""}},watch:{visivel(a){a&&this.inicializar()},numeroEdital(){this.validarNumero()}},methods:{inicializar(){this.numeroEdital="",this.anoEdital=(new Date).getFullYear(),this.dataPublicacao="",this.objeto="",this.observacoes="",this.arquivoSelecionado=null,this.erroValidacao="",this.processo.edital_vinculado&&(this.numeroEdital=this.processo.numero_edital||"",this.anoEdital=this.processo.ano_edital||(new Date).getFullYear())},validarNumero(){if(this.erroValidacao="",!this.numeroEdital)return;const a=/^\d{1,3}\/\d{4}$/;if(!a.test(this.numeroEdital))return void(this.erroValidacao="Formato invÃ¡lido. Use XXX/YYYY (ex: 001/2024)");const o=this.numeroEdital.split("/"),t=parseInt(o[1],10);t!==this.anoEdital&&(this.anoEdital=t)},onFileSelect(a){const o=a.target.files[0];this.processarArquivo(o)},onFileDrop(a){this.dragover=!1;const o=a.dataTransfer.files[0];this.processarArquivo(o)},processarArquivo(a){a&&("application/pdf"===a.type?a.size>52428800?this.$swal?.fire({title:"Arquivo muito grande",text:"O arquivo deve ter no mÃ¡ximo 50MB.",icon:"error"}):this.arquivoSelecionado=a:this.$swal?.fire({title:"Arquivo InvÃ¡lido",text:"Apenas arquivos PDF sÃ£o aceitos.",icon:"error"}))},removerArquivo(){this.arquivoSelecionado=null,this.$refs.fileInput&&(this.$refs.fileInput.value="")},formatarTamanhoArquivo(a){if(0===a)return"0 Bytes";const o=1024,t=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(a)/Math.log(o));return parseFloat((a/Math.pow(o,e)).toFixed(2))+" "+t[e]},async vincularEdital(){if(!this.salvando)try{this.salvando=!0;const a={numero_edital:this.numeroEdital,ano_edital:this.anoEdital,data_publicacao:this.dataPublicacao||null,objeto:this.objeto||this.gerarObjetoAutomatico(),observacoes:this.observacoes,arquivo:this.arquivoSelecionado},o=await i["default"].vincularEditalProcesso(this.processo.id,a);this.$emit("edital-vinculado",{processo:o,dadosEdital:a}),this.fechar(),this.$swal?.fire({title:"Sucesso!",text:`Edital ${this.numeroEdital} vinculado com sucesso ao processo!`,icon:"success",timer:3e3})}catch(a){console.error("Erro ao vincular edital:",a),this.$swal?.fire({title:"Erro",text:a.message||"Erro ao vincular edital",icon:"error"})}finally{this.salvando=!1}},gerarObjetoAutomatico(){return"padronizacao"===this.processo.tipo_processo?"CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.":"DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS."},fechar(){this.$emit("fechar")}}},N=$;var R=(0,g.A)(N,y,O,!1,null,"0d5148c8",null);const I=R.exports;var T=function(){var a=this,o=a._self._c;return o("div",{staticClass:"documentacao-produtos"},[o("div",{staticClass:"header"},[o("h3",[a._v("ğŸ“‹ DocumentaÃ§Ã£o dos Produtos Selecionados")]),a.carregando?a._e():o("button",{staticClass:"btn-refresh",on:{click:a.atualizarDocumentacao}},[a._v(" ğŸ”„ Atualizar ")])]),a.carregando?o("div",{staticClass:"loading"},[o("div",{staticClass:"spinner"}),o("p",[a._v("Carregando documentaÃ§Ã£o dos produtos...")])]):0===a.documentacao.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“¦")]),o("h4",[a._v("Nenhum produto selecionado")]),o("p",[a._v("Adicione produtos ao processo para visualizar sua documentaÃ§Ã£o tÃ©cnica.")])]):o("div",{staticClass:"produtos-documentacao"},a._l(a.documentacao,(function(t){return o("div",{key:t.produto_id,staticClass:"produto-card"},[o("div",{staticClass:"produto-header",on:{click:function(o){return a.toggleExpansao(t.produto_id)}}},[o("div",{staticClass:"produto-info"},[o("h4",[a._v(a._s(t.nome_produto))]),o("p",[a._v(a._s(t.marca)+" - "+a._s(t.modelo)+" | "+a._s(t.fabricante))])]),o("div",{staticClass:"status-docs"},[o("span",{staticClass:"docs-count"},[a._v(a._s(t.checklist_documentacao.length)+" docs")]),o("span",{staticClass:"toggle-icon",class:{expanded:a.produtosExpandidos[t.produto_id]}},[a._v(" â–¼ ")])])]),a.produtosExpandidos[t.produto_id]?o("div",{staticClass:"produto-content"},[o("div",{staticClass:"secao-documentacao"},[o("h5",[a._v("ğŸ”’ DocumentaÃ§Ã£o TÃ©cnica ObrigatÃ³ria")]),o("div",{staticClass:"docs-grid"},[t.documentacao_tecnica.numero_anvisa?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ¥")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("Registro ANVISA/MS")]),o("span",[a._v(a._s(t.documentacao_tecnica.numero_anvisa))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e(),t.documentacao_tecnica.certificado_inmetro?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("âš–ï¸")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("CertificaÃ§Ã£o INMETRO")]),o("span",[a._v(a._s(t.documentacao_tecnica.certificado_inmetro))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e(),t.documentacao_tecnica.cbpf?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ­")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("CBPF")]),o("span",[a._v(a._s(t.documentacao_tecnica.cbpf))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e(),t.documentacao_tecnica.norma_abnt?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ“")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("Norma ABNT")]),o("span",[a._v(a._s(t.documentacao_tecnica.norma_abnt))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e(),t.documentacao_tecnica.norma_regulamentadora?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ“‹")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("Norma Regulamentadora")]),o("span",[a._v(a._s(t.documentacao_tecnica.norma_regulamentadora))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e(),t.documentacao_tecnica.codigo_material?o("div",{staticClass:"doc-item valido"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ”¢")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v("CÃ³digo do Material")]),o("span",[a._v(a._s(t.documentacao_tecnica.codigo_material))])]),o("div",{staticClass:"doc-status"},[a._v("âœ…")])]):a._e()])]),t.documentacao_tecnica.especificacao_detalhada?o("div",{staticClass:"secao-documentacao"},[o("h5",[a._v("ğŸ“ EspecificaÃ§Ã£o TÃ©cnica Detalhada")]),o("div",{staticClass:"especificacao"},[o("p",[a._v(a._s(t.documentacao_tecnica.especificacao_detalhada))])])]):a._e(),t.documentos_anexados.length>0?o("div",{staticClass:"secao-documentacao"},[o("h5",[a._v("ğŸ“ Documentos PDF Anexados")]),o("div",{staticClass:"documentos-lista"},a._l(t.documentos_anexados,(function(t){return o("div",{key:t.id,staticClass:"documento-anexo"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"doc-info"},[o("strong",[a._v(a._s(t.nome_arquivo))]),o("small",[a._v(a._s(a.formatarTamanhoArquivo(t.tamanho))+" - "+a._s(a.formatarData(t.data_upload)))])]),o("div",{staticClass:"doc-actions"},[o("button",{staticClass:"btn-view",attrs:{title:"Visualizar documento"},on:{click:function(o){return a.abrirDocumento(t.url_arquivo)}}},[a._v(" ğŸ‘ï¸ ")]),o("button",{staticClass:"btn-download",attrs:{title:"Baixar documento"},on:{click:function(o){return a.baixarDocumento(t.url_arquivo,t.nome_arquivo)}}},[a._v(" â¬‡ï¸ ")])])])})),0)]):a._e(),o("div",{staticClass:"secao-documentacao"},[o("h5",[a._v("âœ… Checklist de DocumentaÃ§Ã£o - Anexo III")]),o("div",{staticClass:"checklist"},a._l(t.checklist_documentacao,(function(t,e){return o("div",{key:e,staticClass:"checklist-item",class:{obrigatorio:t.obrigatÃ³rio,presente:t.presente}},[o("div",{staticClass:"check-icon"},[a._v(" "+a._s(t.presente?"âœ…":t.obrigatÃ³rio?"âŒ":"â¸ï¸")+" ")]),o("div",{staticClass:"check-info"},[o("strong",[a._v(a._s(t.documento))]),t.valor?o("span",{staticClass:"doc-valor"},[a._v(a._s(t.valor))]):a._e(),t.observacao?o("small",{staticClass:"doc-obs"},[a._v(a._s(t.observacao))]):a._e(),t.obrigatÃ³rio?o("span",{staticClass:"obrigatorio-badge"},[a._v("OBRIGATÃ“RIO")]):a._e()]),o("div",{staticClass:"check-status"},[t.presente?o("span",{staticClass:"status-ok"},[a._v("Presente")]):t.obrigatÃ³rio?o("span",{staticClass:"status-faltando"},[a._v("Faltando")]):o("span",{staticClass:"status-opcional"},[a._v("Opcional")])])])})),0)]),o("div",{staticClass:"resumo-conformidade"},[o("div",{staticClass:"conformidade-stats"},[o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(a.contarDocumentosPresentes(t.checklist_documentacao)))]),o("span",{staticClass:"stat-label"},[a._v("Documentos Presentes")])]),o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(a.contarDocumentosObrigatorios(t.checklist_documentacao)))]),o("span",{staticClass:"stat-label"},[a._v("ObrigatÃ³rios")])]),o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(t.documentos_anexados.length))]),o("span",{staticClass:"stat-label"},[a._v("PDFs Anexados")])])]),o("div",{staticClass:"status-geral"},[a.verificarConformidadeTotal(t.checklist_documentacao)?o("div",{staticClass:"status-conforme"},[a._v(" âœ… DocumentaÃ§Ã£o Conforme ")]):o("div",{staticClass:"status-nao-conforme"},[a._v(" âš ï¸ DocumentaÃ§Ã£o Incompleta - "+a._s(a.contarDocumentosFaltando(t.checklist_documentacao))+" obrigatÃ³rio(s) faltando ")])])])]):a._e()])})),0),a.documentacao.length>0?o("div",{staticClass:"resumo-geral"},[o("h4",[a._v("ğŸ“Š Resumo Geral da DocumentaÃ§Ã£o")]),o("div",{staticClass:"resumo-stats"},[o("div",{staticClass:"stat-card"},[o("div",{staticClass:"stat-value"},[a._v(a._s(a.documentacao.length))]),o("div",{staticClass:"stat-label"},[a._v("Produtos Selecionados")])]),o("div",{staticClass:"stat-card"},[o("div",{staticClass:"stat-value"},[a._v(a._s(a.contarProdutosConformes()))]),o("div",{staticClass:"stat-label"},[a._v("Com Doc. Completa")])]),o("div",{staticClass:"stat-card"},[o("div",{staticClass:"stat-value"},[a._v(a._s(a.contarTotalDocumentosPDF()))]),o("div",{staticClass:"stat-label"},[a._v("PDFs Anexados")])]),o("div",{staticClass:"stat-card",class:{"stat-warning":a.contarProdutosNaoConformes()>0}},[o("div",{staticClass:"stat-value"},[a._v(a._s(a.contarProdutosNaoConformes()))]),o("div",{staticClass:"stat-label"},[a._v("Com Doc. Incompleta")])])])]):a._e()])},F=[];const M={name:"DocumentacaoProdutos",props:{processoId:{type:String,required:!0}},data(){return{documentacao:[],carregando:!1,produtosExpandidos:{}}},mounted(){this.carregarDocumentacao()},methods:{async carregarDocumentacao(){try{this.carregando=!0,this.documentacao=await i["default"].obterDocumentacaoProdutos(this.processoId),this.documentacao.length>0&&this.$set(this.produtosExpandidos,this.documentacao[0].produto_id,!0)}catch(a){console.error("Erro ao carregar documentaÃ§Ã£o:",a),this.$swal?.fire({title:"Erro",text:"Erro ao carregar documentaÃ§Ã£o dos produtos",icon:"error"})}finally{this.carregando=!1}},async atualizarDocumentacao(){await this.carregarDocumentacao()},toggleExpansao(a){this.$set(this.produtosExpandidos,a,!this.produtosExpandidos[a])},formatarTamanhoArquivo(a){if(!a)return"0 Bytes";const o=1024,t=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(a)/Math.log(o));return parseFloat((a/Math.pow(o,e)).toFixed(2))+" "+t[e]},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):"Data nÃ£o disponÃ­vel"},abrirDocumento(a){a&&window.open(a,"_blank")},baixarDocumento(a,o){if(a){const t=document.createElement("a");t.href=a,t.download=o||"documento.pdf",t.click()}},contarDocumentosPresentes(a){return a.filter((a=>a.presente)).length},contarDocumentosObrigatorios(a){return a.filter((a=>a.obrigatÃ³rio)).length},contarDocumentosFaltando(a){return a.filter((a=>a.obrigatÃ³rio&&!a.presente)).length},verificarConformidadeTotal(a){const o=a.filter((a=>a.obrigatÃ³rio));return o.every((a=>a.presente))},contarProdutosConformes(){return this.documentacao.filter((a=>this.verificarConformidadeTotal(a.checklist_documentacao))).length},contarProdutosNaoConformes(){return this.documentacao.filter((a=>!this.verificarConformidadeTotal(a.checklist_documentacao))).length},contarTotalDocumentosPDF(){return this.documentacao.reduce(((a,o)=>a+o.documentos_anexados.length),0)}}},z=M;var L=(0,g.A)(z,T,F,!1,null,"6ca7a894",null);const B=L.exports,q={name:"ProcessosAdministrativosComponent",components:{AssistenteProcesso:S,ModalVincularEdital:I,DocumentacaoProdutos:B},data(){return{processos:[],processosFiltrados:[],documentosProcesso:[],estatisticas:null,carregando:!0,filtroTipo:"",filtroStatus:"",termoBusca:"",ordenacao:"data_desc",visualizacao:"grid",perfilUsuario:"",acoesDisponiveis:{},podeAdicionarDoc:!1,mostrarAssistente:!1,mostrarModalEdital:!1,mostrarDocumentacao:!1,mostrarModalAdicionarDoc:!1,processoSelecionado:null,modoEdicao:!1,processoParaEditar:null,tipoProcessoInicial:null,produtosProcesso:[],documentosParaUpload:[],tipoDocumentoSelecionado:"",observacoesDocumento:"",processandoUpload:!1,mostrarModalConfirmacaoTramitacao:!1,dadosConfirmacaoTramitacao:{},observacoesTramitacao:"",processandoTramitacao:!1,callbackConfirmacao:null,mostrarModalDevolucao:!1,processoParaDevolucao:null,motivoDevolucao:"",observacoesDevolucao:"",processandoDevolucao:!1}},computed:{documentosProcessoFiltrados(){return console.log("ğŸ” DEBUG - Filtrando documentos. Total de documentos:",this.documentosProcesso.length),console.log("ğŸ” DEBUG - Documentos brutos:",this.documentosProcesso),this.documentosProcesso.filter((a=>(console.log(`ğŸ” DEBUG - Analisando documento: ${a.titulo||a.nome_documento} (tipo: ${a.tipo_documento})`),"FOLHA_ROSTO"===a.tipo_documento||"folha_rosto"===a.tipo_documento||a.nome_documento&&a.nome_documento.toLowerCase().includes("folha de rosto")||a.titulo&&a.titulo.toLowerCase().includes("folha de rosto")?(console.log("âŒ DEBUG - EXCLUINDO FOLHA DE ROSTO:",a.titulo||a.nome_documento),!1):"DFD"===a.tipo_documento||"dfd"===a.tipo_documento||a.nome_documento&&(a.nome_documento.toLowerCase().includes("formalizaÃ§Ã£o de demanda")||a.nome_documento.toLowerCase().includes("dfd"))||a.titulo&&(a.titulo.toLowerCase().includes("formalizaÃ§Ã£o de demanda")||a.titulo.toLowerCase().includes("dfd"))?(console.log("âŒ DEBUG - EXCLUINDO DFD:",a.titulo||a.nome_documento),!1):"DOCUMENTO_PRODUTO"===a.tipo_documento?(console.log("âœ… DEBUG - Incluindo documento de produto:",a.titulo||a.nome_documento),!0):"DOCUMENTO_ADICIONAL"===a.tipo_documento?(console.log("âœ… DEBUG - Incluindo documento adicional"),!0):"EDITAL"===a.tipo_documento?(console.log("âœ… DEBUG - Incluindo edital"),!0):["COMPLEMENTAR","CORRECAO","ADICIONAL","PARECER","MANIFESTACAO"].includes(a.tipo_documento)?(console.log("âœ… DEBUG - Incluindo documento adicionado:",a.tipo_documento,a.titulo||a.nome_documento),!0):a.titulo&&null!==a.titulo&&""!==a.titulo.trim()?"DOCUMENTO_PRODUTO"===a.tipo_documento||"DOCUMENTO_ADICIONAL"===a.tipo_documento||"EDITAL"===a.tipo_documento||a.descricao&&null!==a.descricao&&""!==a.descricao.trim()?(console.log("âœ… DEBUG - Incluindo documento"),!0):(console.log("âŒ DEBUG - Excluindo documento oficial por falta de descriÃ§Ã£o"),!1):(console.log("âŒ DEBUG - Excluindo por falta de tÃ­tulo"),!1)))).filter(((a,o,t)=>{const e=t.findIndex((o=>o.id===a.id))<o;return e&&console.log("ğŸ—‘ï¸ DEBUG - Removendo documento com ID duplicado:",a.titulo,"ID:",a.id),!e})).map((a=>({...a,visualizavel:!0,status:a.assinado?"assinado":"disponivel"})))}},async mounted(){await this.carregarPerfilUsuario(),await this.carregarProcessos(),await this.carregarEstatisticas()},beforeUnmount(){document.body.style.overflow="auto"},methods:{isOrgaoAdministrativo(){return"orgao_administrativo"===this.perfilUsuario?.toLowerCase()},async buscarUrlEdital(a){try{console.log("ğŸ” Buscando URL do edital:",a.titulo);const{data:o,error:t}=await r.ND.from("documentos_processo").select("*").eq("processo_id",this.processoSelecionado.id).eq("tipo_documento","EDITAL").single();console.log("ğŸ“„ Edital encontrado na tabela documentos_processo:",{editalDoc:o,error:t}),o&&o.arquivo_url?(a.url_arquivo=o.arquivo_url,console.log("âœ… URL do edital encontrada:",a.url_arquivo),this.visualizarDocumento(a)):alert("âŒ URL do PDF do edital nÃ£o encontrada na tabela documentos_processo.")}catch(o){console.error("âŒ Erro ao buscar URL do edital:",o),alert("Erro ao localizar o arquivo do edital: "+o.message)}},async carregarPerfilUsuario(){try{this.perfilUsuario=await i["default"].obterPerfilUsuario()}catch(a){console.error("Erro ao carregar perfil do usuÃ¡rio:",a),this.perfilUsuario=""}},async carregarProcessos(){try{this.carregando=!0;const a={tipo_processo:this.filtroTipo,status:this.filtroStatus,busca:this.termoBusca};this.processos=await i["default"].listarProcessos(a),await this.carregarAcoesDisponiveis(),this.filtrarProcessos()}catch(a){console.error("Erro ao carregar processos:",a),this.processos=[],alert("Erro ao carregar processos. Tente novamente.")}finally{this.carregando=!1}},async carregarEstatisticas(){try{this.estatisticas=await i["default"].obterEstatisticas()}catch(a){console.error("Erro ao carregar estatÃ­sticas:",a)}},async carregarDocumentosProcesso(a){try{console.log("ğŸ” DEBUG - Carregando documentos para processo:",a);let t=await i["default"].listarDocumentosProcesso(a);console.log("ğŸ” DEBUG - Documentos principais carregados (folha de rosto, DFD, edital):",t),console.log("ğŸ”„ DEBUG - Carregando documentos de produtos da nova tabela para TODOS os processos");const e=await i["default"].getTenantId(),{data:s,error:n}=await r.ND.from("documentos_produtos_processo").select("*").eq("processo_id",a).eq("tenant_id",e);if(console.log("ğŸ“‹ DEBUG - Documentos de produtos encontrados na nova tabela:",s),n&&console.warn("âš ï¸ Erro ao buscar documentos de produtos do processo:",n),s&&s.length>0){console.log(`âœ… DEBUG - Adicionando ${s.length} documentos de produtos Ã  lista`);for(const a of s){const o={id:`produto_${a.id}`,tipo_documento:"DOCUMENTO_PRODUTO",titulo:`${a.nome_produto} - ${a.nome_arquivo}`,descricao:`Documento tÃ©cnico do produto ${a.nome_produto} (${a.marca})`,data_autuacao:a.created_at,numero_folha:null,url_arquivo:a.url_arquivo,nome_arquivo:a.nome_arquivo,tipo_arquivo:a.tipo_arquivo,tamanho:a.tamanho,assinado:!1,produto_id:a.produto_id,nome_produto:a.nome_produto,marca:a.marca,fabricante:a.fabricante};t.push(o)}console.log(`âœ… ${s.length} documentos de produtos adicionados Ã  lista`)}else console.log("â„¹ï¸ Nenhum documento de produto encontrado para este processo");try{console.log(`ğŸ” Buscando documentos adicionais para processo ${a}`);const{data:o,error:e}=await r.ND.from("documentos_processo").select("*").eq("processo_id",a).in("tipo_documento",["DOCUMENTO_ADICIONAL","documento_adicional","ANEXO","anexo"]);if(console.log("ğŸ“ Documentos adicionais encontrados:",o),e&&console.warn("âš ï¸ Erro ao buscar documentos adicionais:",e),o&&o.length>0)for(const a of o){const o=t.find((o=>o.id===a.id));if(!o){const o={id:a.id,tipo_documento:"DOCUMENTO_ADICIONAL",titulo:a.titulo||a.nome_documento||"Documento Adicional",descricao:a.descricao||"Documento adicional anexado ao processo",data_autuacao:a.data_autuacao||a.created_at,numero_folha:a.numero_folha,url_arquivo:a.url_arquivo,nome_arquivo:a.nome_arquivo,tipo_arquivo:a.tipo_arquivo,tamanho:a.tamanho,assinado:a.assinado||!1};t.push(o)}}}catch(o){console.warn("Erro ao buscar documentos adicionais:",o)}console.log(`ğŸ“‹ Total de documentos carregados: ${t.length}`,t),this.documentosProcesso=t}catch(o){console.error("Erro ao carregar documentos do processo:",o),this.documentosProcesso=[]}},async carregarProdutosProcesso(a){try{this.produtosProcesso=await i["default"].listarProdutosProcesso(a)}catch(o){console.error("Erro ao carregar produtos do processo:",o),this.produtosProcesso=[]}},podeEditarProcesso(a){const o=a?.status?.toLowerCase()||"";return"em_criacao"===o||"rascunho"===o},async podeAdicionarDocumento(a){try{const o=["expedindo_dcbs","incluindo_marcas","finalizado","arquivado"];if(o.includes(a.status))return console.log(`ğŸš« NÃ£o Ã© possÃ­vel adicionar documentos no status "${a.status}" - processo jÃ¡ foi julgado`),!1;const t=await c.A.podeUsuarioTramitar(a);return t}catch(o){return console.error("Erro ao verificar permissÃ£o de adicionar documento:",o),!1}},podeEnviarParaAnalise(a){console.log("ğŸ” DEBUG - Verificando botÃ£o enviar:",{processo:a?.numero_processo||a?.id,status:a?.status,tipo:a?.tipo_processo,perfilUsuario:this.perfilUsuario,documentos:this.documentosProcesso?.length||0,produtos:this.produtosProcesso?.length||0});const o=a?.status?.toLowerCase()||"",t=this.perfilUsuario?.toLowerCase()||"";return"cpm"===t&&"criado_cpm"===o?(console.log("ğŸ¯ Resultado CPM:","âœ… MOSTRAR BOTÃƒO - CPM pode enviar criado_cpm"),!0):"cpm"===t&&["rascunho","aguardando_aprovacao","criado_cpm","criado_cpm_desp"].includes(o)?(console.log("ğŸ¯ Resultado CPM:","âœ… MOSTRAR BOTÃƒO - CPM pode enviar rascunho/criado"),!0):"orgao_administrativo"===t&&"criado_cpm"===o?(console.log("ğŸ¯ Resultado ORGAO:","âŒ OCULTAR BOTÃƒO - Ã“rgÃ£o nÃ£o pode enviar criado_cpm"),!1):(console.log("ğŸ¯ Resultado:","âŒ OCULTAR BOTÃƒO - Sem permissÃ£o"),!1)},podeOrgaoAssinarDocumento(a){const o=a?.status?.toLowerCase()||"",t=this.perfilUsuario?.toLowerCase()||"";return"orgao_administrativo"===t&&"aguardando_assinatura_orgao"===o},podeDevolverParaCPM(a){const o=a?.status?.toLowerCase()||"",t=this.perfilUsuario?.toLowerCase()||"";return"orgao_administrativo"===t&&"aguardando_assinatura_orgao"===o},obterTextoAdicionarDocumento(){const a=this.perfilUsuario?.toLowerCase()||"";return"orgao_administrativo"===a?"Adicionar Documento Assinado":"Adicionar Documento"},obterMensagemNaoPodeAdicionarDoc(){if(!this.processoSelecionado)return"Processo nÃ£o carregado";const a=this.processoSelecionado.status,o=["expedindo_dcbs","incluindo_marcas","finalizado","arquivado"];return o.includes(a)?"NÃ£o Ã© possÃ­vel adicionar documentos - processo jÃ¡ foi julgado":"Apenas o perfil responsÃ¡vel pelo status atual pode adicionar documentos"},temAcaoTramitacaoEnviar(a){if(!a?.id||!this.acoesDisponiveis[a.id])return console.log(`ğŸ” DEBUG - temAcaoTramitacaoEnviar: FALSO para ${a?.numero_processo} - sem aÃ§Ãµes disponÃ­veis`),!1;const o=this.acoesDisponiveis[a.id],t=o.some((a=>"ENVIAR"===a.tipo||"ENVIAR_FLEXIVEL"===a.tipo));return console.log(`ğŸ” DEBUG - temAcaoTramitacaoEnviar: ${t?"VERDADEIRO":"FALSO"} para ${a.numero_processo}`),console.log("ğŸ” DEBUG - AÃ§Ãµes disponÃ­veis:",o),console.log("ğŸ” DEBUG - Tipos de aÃ§Ãµes encontradas:",o.map((a=>a.tipo))),t},temAcaoTramitacaoDevolver(a){if(!a?.id||!this.acoesDisponiveis[a.id])return!1;const o=this.acoesDisponiveis[a.id];return o.some((a=>"DEVOLVER"===a.tipo))},async enviarParaProximaEtapa(a){if(!this.temAcaoTramitacaoEnviar(a))return;const o=this.acoesDisponiveis[a.id];let t=o.find((a=>"ENVIAR"===a.tipo));t||(t=o.find((a=>"ENVIAR_FLEXIVEL"===a.tipo))),console.log("ğŸš€ DEBUG - enviarParaProximaEtapa: aÃ§Ã£o encontrada:",t),t&&await this.executarAcaoTramitacao(a,t)},abrirModalDevolucaoGenerica(a){this.temAcaoTramitacaoDevolver(a)&&this.abrirModalDevolucao(a)},podeTramitarParaCCL(a){console.log("ğŸ” DEBUG - Verificando botÃ£o tramitar para CCL:",{processo:a?.numero_processo||a?.id,status:a?.status,tipo:a?.tipo_processo,perfilUsuario:this.perfilUsuario});const o=a?.status?.toLowerCase()||"",t=this.perfilUsuario?.toLowerCase()||"",e="assinado_admin"===o&&"orgao_administrativo"===t;return console.log("âš–ï¸ Resultado tramitaÃ§Ã£o CCL:",e?"âœ… MOSTRAR BOTÃƒO":"âŒ OCULTAR BOTÃƒO"),e},obterTextoBotaoTramitacao(a){return a?c.A.obterNomeBotaoTramitacao(a.status,a.tipo_processo):"Tramitar Processo"},async tramitarProcessoParaCCL(a){try{const o=confirm(`âš–ï¸ TRAMITAR PROCESSO PARA CCL\n\nProcesso: ${a.numero_processo}\nStatus atual: Assinado pelo Ã“rgÃ£o\nPrÃ³ximo status: Em Julgamento pela CCL\n\nConfirma a tramitaÃ§Ã£o?`);if(!o)return;console.log("âš–ï¸ Tramitando processo para CCL:",a.id),console.log("ğŸ“Š Status atual do processo:",a.status),console.log("ğŸ“Š Tipo do processo:",a.tipo_processo);const t=await c.A.enviarProcesso(a.id,"Processo tramitado para julgamento da CCL");if(console.log("ğŸ“Š Resultado da tramitaÃ§Ã£o:",t),!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o do processo");{this.$swal({title:"âœ… Processo Tramitado!",text:`O processo ${a.numero_processo} foi tramitado para julgamento da CCL com sucesso.`,icon:"success"}),await this.carregarProcessos();const o=this.processos.findIndex((o=>o.id===a.id));-1!==o&&(this.processos[o].status=t.statusNovo)}}catch(o){console.error("Erro ao tramitar processo:",o),this.$swal({title:"âŒ Erro na TramitaÃ§Ã£o",text:`Erro ao tramitar processo: ${o.message}`,icon:"error"})}},gerarHTMLRelatorio(a,o,t,e=null){const s=(new Date).toLocaleDateString("pt-BR");return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="utf-8">\n          <title>Caderno do Processo ${a.numero_processo||a.id}</title>\n          <style>\n            @page {\n              margin: 2cm;\n              @bottom-center {\n                content: "PÃ¡gina " counter(page) " - Processo ${a.numero_processo||a.id}";\n                font-size: 10pt;\n                color: #666;\n              }\n            }\n            \n            body { \n              font-family: 'Times New Roman', serif; \n              font-size: 12pt;\n              line-height: 1.6;\n              color: #000;\n              margin: 0;\n              padding: 0;\n              background: white;\n            }\n            \n            .page-break {\n              page-break-before: always;\n            }\n            \n            .documento-pagina {\n              width: 21cm;\n              min-height: 29.7cm;\n              margin: 0 auto 2cm auto;\n              padding: 2cm;\n              background: white;\n              box-shadow: 0 0 10px rgba(0,0,0,0.1);\n              position: relative;\n              overflow: visible;\n              word-wrap: break-word;\n            }\n            \n            /* === ESTILOS PADRONIZADOS PARA TODOS OS DOCUMENTOS === */\n            \n            .folha-numero {\n              position: absolute;\n              top: 0.5cm;\n              right: 1cm;\n              font-size: 11pt;\n              color: #333;\n              font-weight: bold;\n              background: white;\n              padding: 5px 10px;\n              border: 1px solid #ddd;\n              border-radius: 3px;\n            }\n            \n            .documento-header {\n              text-align: center;\n              margin-bottom: 2.5cm;\n              border-bottom: 2px solid #000;\n              padding-bottom: 1.5cm;\n            }\n            \n            .documento-header h1 {\n              font-family: 'Times New Roman', serif;\n              font-size: 16pt;\n              font-weight: bold;\n              margin: 1cm 0 0.8cm 0;\n              color: #000;\n              line-height: 1.4;\n            }\n            \n            .documento-header h2 {\n              font-family: 'Times New Roman', serif;\n              font-size: 14pt;\n              font-weight: bold;\n              margin: 0.8cm 0 0.5cm 0;\n              color: #000;\n              line-height: 1.3;\n            }\n            \n            .documento-conteudo {\n              font-family: 'Times New Roman', serif;\n              font-size: 12pt;\n              line-height: 1.7;\n              text-align: justify;\n              color: #000;\n            }\n            \n            .documento-conteudo h1,\n            .documento-conteudo h2,\n            .documento-conteudo h3 {\n              font-family: 'Times New Roman', serif;\n              font-weight: bold;\n              color: #000;\n              margin: 1.5cm 0 0.8cm 0;\n              line-height: 1.4;\n            }\n            \n            .documento-conteudo h1 { font-size: 16pt; }\n            .documento-conteudo h2 { font-size: 14pt; }\n            .documento-conteudo h3 { font-size: 12pt; }\n            \n            .documento-conteudo p {\n              font-family: 'Times New Roman', serif;\n              font-size: 12pt;\n              line-height: 1.7;\n              margin-bottom: 1.2cm;\n              text-align: justify;\n            }\n            \n            .documento-conteudo strong {\n              font-weight: bold;\n            }\n            \n            .caixa-bordered {\n              border: 2px solid #000;\n              padding: 1.5cm;\n              margin: 2cm auto;\n              max-width: 16cm;\n            }\n            \n            .campo {\n              margin-bottom: 1cm;\n              text-align: left;\n            }\n            \n            .campo.objeto {\n              text-align: justify;\n              line-height: 1.4;\n            }\n            \n            \n            .campo strong {\n              font-weight: bold;\n            }\n            \n            .numero-processo {\n              font-weight: bold;\n              font-size: 14pt;\n              margin-bottom: 1cm;\n              text-align: center;\n            }\n            \n            .tabela {\n              width: 100%;\n              border-collapse: collapse;\n              margin: 1cm 0;\n              font-size: 11pt;\n              table-layout: fixed;\n            }\n            \n            .tabela th, .tabela td {\n              border: 1px solid #333;\n              padding: 8px;\n              text-align: left;\n              vertical-align: top;\n              word-wrap: break-word;\n              overflow-wrap: break-word;\n              hyphens: auto;\n            }\n            \n            .tabela th {\n              background-color: #f5f5f5;\n              font-weight: bold;\n              text-align: center;\n            }\n            \n            .assinatura {\n              margin-top: 4cm;\n              text-align: center;\n              page-break-inside: avoid;\n            }\n            \n            .linha-assinatura {\n              border-top: 1px solid #000;\n              width: 300px;\n              margin: 2.5cm auto 1cm auto;\n            }\n            \n            @media print {\n              .documento-pagina {\n                box-shadow: none;\n                margin: 0;\n                padding: 2cm 2cm 3cm 2cm; /* Margem inferior extra */\n                page-break-inside: avoid;\n              }\n              \n              .page-break {\n                page-break-before: always;\n              }\n              \n              .tabela {\n                page-break-inside: auto;\n              }\n              \n              .tabela tr {\n                page-break-inside: avoid;\n              }\n              \n              .documento-conteudo {\n                orphans: 3;\n                widows: 3;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          \x3c!-- DOCUMENTOS DO PROCESSO --\x3e\n          ${o.map(((o,t)=>`\n            ${t>0?'<div class="page-break"></div>':""}\n            <div class="documento-pagina">\n              <div class="folha-numero">Fl. ${String(o.numero_sequencial||t+1).padStart(3,"0")}</div>\n              \n              ${o.conteudo_html?o.conteudo_html:`\n                <div class="documento-header">\n                  <h1>${a.nome_orgao}</h1>\n                  <h2>${o.nome_documento||o.tipo_documento}</h2>\n                  <p>Processo nÂº ${a.numero_processo}</p>\n                </div>\n                \n                <div class="documento-conteudo">\n                  <h3>INFORMAÃ‡Ã•ES DO DOCUMENTO</h3>\n                  <p><strong>Tipo:</strong> ${o.tipo_documento}</p>\n                  <p><strong>TÃ­tulo:</strong> ${o.titulo||o.nome_documento||"Sem tÃ­tulo"}</p>\n                  <p><strong>DescriÃ§Ã£o:</strong> ${o.descricao||"Documento do processo administrativo"}</p>\n                  <p><strong>Data de AutuaÃ§Ã£o:</strong> ${this.formatarData(o.data_autuacao)}</p>\n                  \n                  ${o.arquivo_url?`\n                  <h3>ARQUIVO ANEXO</h3>\n                  <p><strong>ObservaÃ§Ã£o:</strong> Este documento possui arquivo anexo com informaÃ§Ãµes complementares.</p>\n                  \n                  <p style="margin-top: 1cm;"><strong>Arquivo:</strong> \n                    <a href="${o.arquivo_url}" target="_blank" style="color: #1976d2; text-decoration: underline; font-weight: bold;">\n                      ${o.arquivo_url}\n                    </a>\n                  </p>\n                  `:""}\n                  \n                  \n                  <div style="margin-top: 3cm; text-align: center; border-top: 1px solid #ccc; padding-top: 1cm; color: #666;">\n                    <p>Sistema Comprar Bem - Processo nÂº ${a.numero_processo}</p>\n                  </div>\n                </div>\n              `}\n            </div>\n          `)).join("")}\n          \n          ${t.length>0?`\n            <div class="page-break"></div>\n            <div class="documento-pagina">\n              <div class="folha-numero">Anexo - Produtos</div>\n              \n              <div class="documento-header">\n                <h1>${a.nome_orgao}</h1>\n                <h2>RELAÃ‡ÃƒO DE PRODUTOS</h2>\n                <p>Processo nÂº ${a.numero_processo}</p>\n              </div>\n              \n              <div class="documento-conteudo">\n                <table class="tabela">\n                  <thead>\n                    <tr>\n                      <th>ITEM</th>\n                      <th>CÃ“DIGO</th>\n                      <th>PRODUTO</th>\n                      <th>ESPECIFICAÃ‡Ã•ES</th>\n                      ${"padronizacao"===a.tipo_processo?"<th>VALOR ESTIMADO</th>":"<th>MOTIVO</th>"}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    ${t.map(((o,t)=>`\n                      <tr>\n                        <td>${t+1}</td>\n                        <td>${o.codigo||"N/A"}</td>\n                        <td>${o.nome_produto||o.nome}</td>\n                        <td>${o.especificacoes_tecnicas||"A definir"}</td>\n                        <td>${"padronizacao"===a.tipo_processo?o.valor_estimado?`R$ ${o.valor_estimado}`:"A definir":o.observacoes_processo||"Conforme avaliaÃ§Ã£o tÃ©cnica"}</td>\n                      </tr>\n                    `)).join("")}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          `:""}\n          \n          \x3c!-- ÃNDICE DE DOCUMENTOS --\x3e\n          <div class="page-break"></div>\n          <div class="documento-pagina">\n            <div class="folha-numero">Ãndice</div>\n            \n            <div class="documento-header">\n              <h1>${a.nome_orgao}</h1>\n              <h2>ÃNDICE DE DOCUMENTOS</h2>\n              <p>Processo nÂº ${a.numero_processo}</p>\n            </div>\n            \n            <div class="documento-conteudo">\n              <h3>ğŸ“‹ DADOS GERAIS DO PROCESSO</h3>\n              <p><strong>NÃºmero:</strong> ${a.numero_processo||"NÃ£o definido"}</p>\n              <p><strong>Tipo:</strong> ${"padronizacao"===a.tipo_processo?"PadronizaÃ§Ã£o de Produtos":"DespadronizaÃ§Ã£o de Produtos"}</p>\n              <p><strong>Status:</strong> ${this.formatarStatus(a.status)}</p>\n              <p><strong>Ã“rgÃ£o:</strong> ${a.nome_orgao}</p>\n              <p><strong>Unidade:</strong> ${a.unidade_interessada}</p>\n              <p><strong>Data:</strong> ${this.formatarData(a.data_autuacao)}</p>\n              \n              \n              <h3 style="margin-top: 2cm;">RELAÃ‡ÃƒO DE DOCUMENTOS</h3>\n              \n              <table class="tabela" style="margin-top: 1cm;">\n                <thead>\n                  <tr>\n                    <th style="width: 12%;">FOLHA</th>\n                    <th style="width: 50%;">DOCUMENTO</th>\n                    <th style="width: 18%;">DATA</th>\n                    <th style="width: 20%;">ARQUIVO</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ${o.filter((a=>"FOLHA_ROSTO"!==a.tipo_documento&&"DFD"!==a.tipo_documento&&a.arquivo_url&&"undefined"!==a.arquivo_url)).map((a=>`\n                    <tr>\n                      <td style="text-align: center; font-weight: bold;">Fl. ${String(a.numero_sequencial||1).padStart(3,"0")}</td>\n                      <td>\n                        <strong>${a.nome_documento||a.tipo_documento}</strong>\n                        ${a.tipo_documento!==(a.nome_documento||a.tipo_documento)?`<br><small style="color: #666;">(${a.tipo_documento})</small>`:""}\n                      </td>\n                      <td style="text-align: center;">${this.formatarData(a.data_autuacao)}</td>\n                      <td style="text-align: center;">\n                        ${a.arquivo_url?`\n                          <a href="${a.arquivo_url}" target="_blank" style="color: #1976d2; text-decoration: underline; font-weight: bold;">\n                            Abrir PDF\n                          </a>\n                        `:"-"}\n                      </td>\n                    </tr>\n                  `)).join("")}\n                </tbody>\n              </table>\n              \n              <div style="margin-top: 2cm; text-align: center; border-top: 1px solid #ccc; padding-top: 1cm;">\n                <p><strong>Total de documentos:</strong> ${o.filter((a=>"FOLHA_ROSTO"!==a.tipo_documento&&"DFD"!==a.tipo_documento&&a.arquivo_url&&"undefined"!==a.arquivo_url)).length}</p>\n                ${t.length>0?`<p><strong>Total de produtos:</strong> ${t.length}</p>`:""}\n                <p style="color: #666; margin-top: 1cm;">Gerado em ${s} - Sistema Comprar Bem</p>\n              </div>\n              \n            </div>\n          </div>\n          \n          ${t.length>0?`\n          \x3c!-- RESUMO DOS PRODUTOS --\x3e\n          <div class="page-break"></div>\n          <div class="documento-pagina">\n            <div class="folha-numero">Produtos</div>\n            \n            <div class="documento-header">\n              <h1>${a.nome_orgao}</h1>\n              <h2>PRODUTOS ${"padronizacao"===a.tipo_processo?"PARA PRÃ‰-QUALIFICAÃ‡ÃƒO":"PARA DESPADRONIZAÃ‡ÃƒO"}</h2>\n              <p>Processo nÂº ${a.numero_processo}</p>\n            </div>\n            \n            <div class="documento-conteudo">\n              <table class="tabela">\n                <thead>\n                  <tr>\n                    <th style="width: 8%;">ITEM</th>\n                    <th style="width: 15%;">CÃ“DIGO</th>\n                    <th style="width: 35%;">PRODUTO</th>\n                    <th style="width: 25%;">ESPECIFICAÃ‡Ã•ES</th>\n                    <th style="width: 17%;">STATUS</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  ${t.map(((a,o)=>`\n                    <tr>\n                      <td style="text-align: center; font-weight: bold;">${o+1}</td>\n                      <td style="text-align: center;">${a.codigo||"N/A"}</td>\n                      <td><strong>${a.nome_produto||a.nome}</strong><br>\n                          <small>Marca: ${a.marca||"N/A"} | Modelo: ${a.modelo||"N/A"}</small></td>\n                      <td style="font-size: 10pt;">${a.especificacoes_tecnicas||a.especificacoes||"A definir"}</td>\n                      <td style="text-align: center;">${a.status_avaliacao||"Pendente"}</td>\n                    </tr>\n                  `)).join("")}\n                </tbody>\n              </table>\n              \n              <div style="margin-top: 2cm; text-align: center; border-top: 1px solid #ccc; padding-top: 1cm; color: #666;">\n                <p><strong>RelatÃ³rio gerado automaticamente pelo Sistema Comprar Bem</strong></p>\n                <p>Processo nÂº ${a.numero_processo} - ${(new Date).toLocaleDateString("pt-BR")}</p>\n              </div>\n            </div>\n          </div>\n          `:""}\n          \n          \x3c!-- SEÃ‡ÃƒO DA ATA DE JULGAMENTO CCL - FORMATO OFICIAL IDÃŠNTICO AO PAINEL CCL --\x3e\n          ${e?`\n          <div class="page-break"></div>\n          <div class="documento-pagina">\n            <div class="folha-numero">Ata CCL</div>\n            \n            \x3c!-- CABEÃ‡ALHO OFICIAL EXATO DO PAINEL CCL --\x3e\n            <div style="text-align: center; margin-bottom: 25px;">\n              <h1 style="font-size: 16pt; font-weight: bold; margin-bottom: 8px; font-family: 'Times New Roman', serif;">\n                COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)\n              </h1>\n              <p style="font-size: 12pt; font-weight: normal; margin: 8px 0; font-family: 'Times New Roman', serif;">\n                Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021\n              </p>\n              \n              \x3c!-- Linha decorativa --\x3e\n              <div style="border-top: 1px solid #000; margin: 15px auto; width: 60%;"></div>\n              \n              <h1 style="font-size: 18pt; font-weight: bold; margin-top: 15px; font-family: 'Times New Roman', serif;">\n                ATA DE JULGAMENTO\n              </h1>\n            </div>\n\n            \x3c!-- DADOS DA ATA - FORMATO OFICIAL --\x3e\n            <div style="margin: 20px 0; font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.6;">\n              <p><strong>NÃºmero:</strong> ${e.numero||"NÃ£o informado"}</p>\n              ${e.periodo&&"NÃ£o informado"!==e.periodo?`\n              <p><strong>PerÃ­odo:</strong> ${e.periodo}</p>\n              `:""}\n              <p><strong>Data de PublicaÃ§Ã£o:</strong> ${e.data_publicacao?new Date(e.data_publicacao).toLocaleDateString("pt-BR"):"NÃ£o informada"}</p>\n              ${e.status_ata&&"HOMOLOGACAO_DIRETA"!==e.status_ata?`\n              <p><strong>Status:</strong> ${e.status_ata}</p>\n              `:""}\n            </div>\n\n            \x3c!-- RESUMO DOS JULGAMENTOS --\x3e\n            <div style="margin: 25px 0;">\n              <h3 style="font-size: 14pt; font-weight: bold; font-family: 'Times New Roman', serif; margin-bottom: 15px;">\n                RESUMO DOS JULGAMENTOS\n              </h3>\n              <div style="margin-left: 15px; font-size: 11pt; line-height: 1.4;">\n                <p>Total de processos julgados: 1</p>\n                <p>Processo analisado: ${a.numero_processo||"NÃ£o informado"}</p>\n                <p>Status da anÃ¡lise: APROVADO</p>\n              </div>\n            </div>\n\n            \x3c!-- CONTEÃšDO COMPLETO DA ATA - FORMATO OFICIAL --\x3e\n            <div style="margin: 25px 0;">\n              <h3 style="font-size: 14pt; font-weight: bold; font-family: 'Times New Roman', serif; margin-bottom: 15px;">\n                CONTEÃšDO COMPLETO DA ATA\n              </h3>\n              \n              <div style="\n                border: 1px solid #000; \n                padding: 20px; \n                margin: 10px 0;\n                font-family: 'Times New Roman', serif;\n                font-size: 10pt;\n                line-height: 1.5;\n                text-align: justify;\n                background: #fafafa;\n              ">\n                ${e.conteudo_ata?e.conteudo_ata.replace(/\n/g,"<br>"):`\n                  <strong>PROCESSO NÂº:</strong> ${a.numero_processo||"NÃ£o informado"}<br><br>\n                  \n                  <strong>OBJETO:</strong> PrÃ©-qualificaÃ§Ã£o de bens conforme Lei 14.133/2021<br><br>\n                  \n                  <strong>DECISÃƒO DA CCL:</strong> APROVADO<br><br>\n                  \n                  <strong>FUNDAMENTAÃ‡ÃƒO:</strong> A ComissÃ£o Central de LicitaÃ§Ã£o, apÃ³s anÃ¡lise tÃ©cnica detalhada dos produtos apresentados, considerando os aspectos tÃ©cnicos, normativos e de conformidade com as especificaÃ§Ãµes estabelecidas, deliberou pela APROVAÃ‡ÃƒO dos produtos relacionados neste processo.<br><br>\n                  \n                  Os produtos aprovados atendem aos requisitos tÃ©cnicos e normativos aplicÃ¡veis, estando aptos para inclusÃ£o no catÃ¡logo eletrÃ´nico de bens padronizados.<br><br>\n                  \n                  <strong>PRÃ“XIMOS PASSOS:</strong> Processo encaminhado Ã  Assessoria JurÃ­dica para anÃ¡lise da conformidade legal.<br><br>\n                  \n                  <strong>Data do julgamento:</strong> ${e.data_publicacao?new Date(e.data_publicacao).toLocaleDateString("pt-BR"):(new Date).toLocaleDateString("pt-BR")}\n                  `}\n              </div>\n            </div>\n\n            \n            \x3c!-- RODAPÃ‰ OFICIAL --\x3e\n            <div style="\n              text-align: center; \n              margin-top: 40px; \n              padding-top: 20px;\n              border-top: 1px solid #333;\n              font-size: 10pt;\n              font-style: italic;\n              color: #666;\n            ">\n              <p><strong>Sistema Comprar Bem - Ata de Julgamento CCL</strong></p>\n              <p>Documento oficial gerado automaticamente pelo sistema</p>\n              <p>Lei 14.133/2021 - Sistema de PrÃ©-QualificaÃ§Ã£o de Bens</p>\n            </div>\n          </div>\n          `:""}\n        </body>\n        </html>\n      `},gerarDocumentoAssinatura(a){const o=(new Date).toLocaleDateString("pt-BR");(new Date).toLocaleTimeString("pt-BR");return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="utf-8">\n          <title>DeclaraÃ§Ã£o de Conformidade - Processo ${a.numero_processo}</title>\n          <style>\n            @page {\n              margin: 3cm 2cm;\n              size: A4;\n            }\n            \n            body { \n              font-family: 'Times New Roman', serif; \n              font-size: 12pt;\n              line-height: 1.6;\n              color: #000;\n              margin: 0;\n              padding: 0;\n              background: white;\n            }\n            \n            .folha-declaracao {\n              width: 100%;\n              height: 29.7cm;\n              padding: 2cm;\n              background: white;\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              align-items: center;\n            }\n            \n            .cabecalho {\n              text-align: center;\n              margin-bottom: 3cm;\n            }\n            \n            .cabecalho h1 {\n              font-size: 16pt;\n              font-weight: bold;\n              margin-bottom: 0.5cm;\n              text-transform: uppercase;\n            }\n            \n            .cabecalho h2 {\n              font-size: 14pt;\n              font-weight: bold;\n              margin-bottom: 0.3cm;\n              text-transform: uppercase;\n            }\n            \n            .numero-processo {\n              font-size: 12pt;\n              font-weight: bold;\n              color: #333;\n              margin-top: 0.5cm;\n            }\n            \n            .quadro-declaracao {\n              border: 2px solid #000;\n              padding: 2.5cm;\n              margin: 1cm auto;\n              width: 15cm;\n              min-height: 10cm;\n              background: white;\n            }\n            \n            .titulo-declaracao {\n              text-align: center;\n              font-size: 16pt;\n              font-weight: bold;\n              margin-bottom: 2cm;\n              text-transform: uppercase;\n            }\n            \n            .texto-declaracao {\n              text-align: justify;\n              line-height: 1.8;\n              margin-bottom: 3cm;\n              font-size: 12pt;\n            }\n            \n            .area-assinatura {\n              margin-top: 3cm;\n              text-align: center;\n            }\n            \n            .data-local {\n              margin-bottom: 2cm;\n              text-align: right;\n            }\n            \n            .linha-assinatura {\n              border-top: 1px solid #000;\n              width: 8cm;\n              margin: 2cm auto 0.5cm auto;\n            }\n            \n            .texto-responsavel {\n              font-size: 12pt;\n              font-weight: bold;\n              text-transform: uppercase;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="folha-declaracao">\n            <div class="cabecalho">\n              <h1>${a.nome_orgao}</h1>\n              <h2>DeclaraÃ§Ã£o de Conformidade</h2>\n              <p class="numero-processo">Processo nÂº ${a.numero_processo}</p>\n            </div>\n            \n            <div class="quadro-declaracao">\n              <div class="titulo-declaracao">DECLARAÃ‡ÃƒO DE CONFORMIDADE</div>\n              \n              <div class="texto-declaracao">\n                <p>Declaro que o produto acima especificado atende aos requisitos tÃ©cnicos estabelecidos no Edital de PrÃ©-qualificaÃ§Ã£o, estando em conformidade com as normas aplicÃ¡veis e possuindo os padrÃµes mÃ­nimos de qualidade exigidos para inclusÃ£o no CatÃ¡logo EletrÃ´nico de Bens Padronizados.</p>\n              </div>\n              \n              <div class="area-assinatura">\n                <div class="data-local">\n                  _________________, ${o}\n                </div>\n                \n                <div class="linha-assinatura"></div>\n                \n                <div class="texto-responsavel">\n                  <p>ResponsÃ¡vel TÃ©cnico</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </body>\n        </html>\n      `},async gerarDocumentoAssinaturaParaDownload(a){try{console.log("ğŸ–Šï¸ Gerando documento de assinatura para processo:",a.numero_processo);const o=this.gerarDocumentoAssinatura(a),t=`Declaracao_Conformidade_${a.numero_processo}_${(new Date).toISOString().split("T")[0]}.pdf`,e=window.open("","_blank");e.document.write(o),e.document.close(),setTimeout((()=>{if(e&&!e.closed){const a=e.document.createElement("div");a.style.cssText="\n              position: fixed; \n              top: 10px; \n              right: 10px; \n              background: #fff; \n              border: 2px solid #28a745; \n              border-radius: 8px; \n              padding: 15px; \n              box-shadow: 0 4px 8px rgba(0,0,0,0.2); \n              z-index: 9999;\n              font-family: Arial, sans-serif;\n            ";const o=e.document.createElement("button");o.innerHTML="ğŸ“‹ Baixar DeclaraÃ§Ã£o de Conformidade",o.style.cssText="\n              background: #28a745; \n              color: white; \n              border: none; \n              padding: 10px 20px; \n              border-radius: 5px; \n              cursor: pointer;\n              font-weight: bold;\n              font-size: 14px;\n            ",o.onclick=()=>{a.style.display="none",setTimeout((()=>{e.print(),a.style.display="block"}),500)},a.appendChild(o),e.document.body.appendChild(a),e.focus()}}),1e3),this.$swal({title:"ğŸ“‹ DeclaraÃ§Ã£o de Conformidade Gerada",html:`\n            <p><strong>DeclaraÃ§Ã£o de Conformidade criada com sucesso!</strong></p>\n            <p>ğŸ“„ Arquivo: <code>${t}</code></p>\n            <br>\n            <p>ğŸ“ <strong>InstruÃ§Ãµes:</strong></p>\n            <ul style="text-align: left; margin: 0 auto; display: inline-block;">\n              <li>Baixe o documento usando o botÃ£o verde</li>\n              <li>Imprima, assine como ResponsÃ¡vel TÃ©cnico</li>\n              <li>Digitalize o documento assinado</li>\n              <li>Use "Adicionar Documento Assinado" para anexar</li>\n            </ul>\n          `,icon:"success",confirmButtonText:"âœ… Entendi",confirmButtonColor:"#28a745"})}catch(o){console.error("âŒ Erro ao gerar documento de assinatura:",o),this.$swal({title:"âŒ Erro na GeraÃ§Ã£o",text:`Erro ao gerar documento de assinatura: ${o.message}`,icon:"error"})}},async completarDocumentosProcesso(a,o,t,e){let s=[...o];s.forEach((a=>{"FOLHA_ROSTO"!==a.tipo_documento&&"DFD"!==a.tipo_documento&&delete a.numero_folha}));const i=o.filter((a=>"FOLHA_ROSTO"===a.tipo_documento));console.log("ğŸ” DEBUG - Folhas de rosto encontradas:",i.length),i.forEach(((a,o)=>{console.log(`ğŸ“„ Folha ${o+1}:`,{nome:a.nome_documento,titulo:a.titulo,temConteudoHTML:!!a.conteudo_html,tipoConteudo:a.conteudo_html?"Com HTML":"Sem HTML",primeirosPedacos:a.conteudo_html?a.conteudo_html.substring(0,200)+"...":"N/A"})}));const n=o.find((a=>"DFD"===a.tipo_documento||"dfd"===a.tipo_documento));if(console.log("Tem DFD existente?",!!n),console.log("Dados DFD passados:",e),n){console.log("DFD existente encontrado");const o=s.find((a=>"DFD"===a.tipo_documento||"dfd"===a.tipo_documento));if(o){o.numero_folha=2;const s="padronizacao"===a.tipo_processo?"MODELO_1":"MODELO_2";o.nome_documento=`Documento de FormalizaÃ§Ã£o de Demanda - ${s}`,o.titulo=`DFD - Documento de FormalizaÃ§Ã£o de Demanda (${s})`,o.conteudo_html||(console.log("Gerando HTML para DFD existente"),o.conteudo_html=this.gerarHTMLDFD(a,e||{},t))}}else{if(!e){console.log("Buscando DFD no banco...");try{const{data:o}=await r.ND.from("dfd_processo").select("*").eq("processo_id",a.id).single();e=o,console.log("DFD encontrado no banco:",e)}catch(f){console.log("DFD nÃ£o encontrado no banco, criando com dados padrÃ£o"),e={justificativa:"Justificativa da necessidade conforme demanda apresentada",descricao_necessidade:"DescriÃ§Ã£o detalhada da necessidade identificada",criterios_aceitacao:"CritÃ©rios de aceitaÃ§Ã£o e ensaios estabelecidos",observacoes_especiais:"ObservaÃ§Ãµes especiais e condiÃ§Ãµes do processo"}}}const o="padronizacao"===a.tipo_processo?"MODELO_1":"MODELO_2",i={numero_folha:2,tipo_documento:"DFD",nome_documento:`Documento de FormalizaÃ§Ã£o de Demanda - ${o}`,titulo:`DFD - Documento de FormalizaÃ§Ã£o de Demanda (${o})`,descricao:`Documento de FormalizaÃ§Ã£o de Demanda do processo de ${a.tipo_processo}`,data_autuacao:e?.created_at||a.created_at,conteudo_html:this.gerarHTMLDFD(a,e,t)};console.log("Criando DFD:",i);const n=s.findIndex((a=>"FOLHA_ROSTO"===a.tipo_documento));n>=0?s.splice(n+1,0,i):s.push(i),console.log("DFD adicionado aos documentos")}if(a.edital_id&&"padronizacao"===a.tipo_processo)try{const o=s.find((a=>"EDITAL"===a.tipo_documento));if(!o){const{data:o}=await r.ND.from("editais").select("*").eq("id",a.edital_id).single();if(o&&o.arquivo_url){const a={numero_folha:null,tipo_documento:"EDITAL_REFERENCIA",nome_documento:`Edital - ${o.titulo}`,titulo:o.titulo,descricao:"Edital de Chamamento PÃºblico (arquivo externo)",data_autuacao:o.created_at,arquivo_url:o.arquivo_url,conteudo_html:null};s.push(a),console.log("Edital adicionado apenas para referÃªncia no Ã­ndice")}}}catch(f){console.log("Erro ao buscar edital:",f)}let c=[];if(t&&t.length>0)for(const C of t)try{const{data:a}=await r.ND.from("produtos_prequalificacao").select("documentos_adicionados").eq("id",C.id).single();if(a?.documentos_adicionados&&a.documentos_adicionados.length>0)for(const o of a.documentos_adicionados)o&&o.nome&&"undefined"!==o.nome&&o.url&&"undefined"!==o.url&&c.push({produto:C,documento:o})}catch(f){console.log("Erro ao buscar documentos do produto:",C.id,f)}const l=s.filter((a=>"DOCUMENTO_PRODUTO"===a.tipo_documento));l.forEach((a=>{a.arquivo_url&&"undefined"!==a.arquivo_url&&a.nome_arquivo&&"undefined"!==a.nome_arquivo&&c.push({documento:{nome:a.nome_arquivo,url:a.arquivo_url},produto:{nome:a.nome_produto||a.titulo?.split(" - ")[0]||"Produto",marca:a.marca||"N/A",modelo:a.modelo||"N/A",categoria:a.categoria||"N/A",fabricante:a.fabricante||"N/A",created_at:a.data_autuacao}})}));const d=s.find((a=>"EDITAL"===a.tipo_documento));if(d&&!d.conteudo_html){console.log("ğŸ”§ Gerando conteÃºdo HTML para edital existente");const o=d.titulo&&d.titulo.match(/\d+\/\d+/)?d.titulo.match(/\d+\/\d+/)[0]:"001/2025";d.conteudo_html=`\n          <div class="documento-header">\n            <h1>${a.nome_orgao}</h1>\n            <h2>EDITAL DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS</h2>\n            <h3>NÂº ${o}</h3>\n          </div>\n          \n          <div class="documento-conteudo">\n            <h3>IDENTIFICAÃ‡ÃƒO</h3>\n            <p><strong>NÃºmero do Edital:</strong> ${o}</p>\n            <p><strong>Ano:</strong> ${(new Date).getFullYear()}</p>\n            <p><strong>Data de VinculaÃ§Ã£o ao Processo:</strong> ${d.data_autuacao?new Date(d.data_autuacao).toLocaleDateString("pt-BR"):(new Date).toLocaleDateString("pt-BR")}</p>\n            <p><strong>Data de PublicaÃ§Ã£o:</strong> ${d.data_publicacao?new Date(d.data_publicacao).toLocaleDateString("pt-BR"):(new Date).toLocaleDateString("pt-BR")}</p>\n            \n            <h3>DOCUMENTO ANEXADO</h3>\n            <p>O edital completo com todos os anexos obrigatÃ³rios estÃ¡ disponÃ­vel em formato PDF.</p>\n            ${d.arquivo_url?`\n            <p><strong>Link do documento:</strong> \n              <a href="${d.arquivo_url}" target="_blank" style="color: #1976d2; text-decoration: underline; font-weight: bold;">\n                ğŸ“„ Abrir Edital Completo (PDF)\n              </a>\n            </p>`:""}\n            \n            <div style="margin-top: 3cm;">\n              <p>Data: ${(new Date).toLocaleDateString("pt-BR")}</p>\n              <div style="margin-top: 2cm; text-align: center;">\n                <div style="border-top: 1px solid #000; width: 300px; margin: 0 auto;">\n                  ResponsÃ¡vel pela vinculaÃ§Ã£o do edital\n                </div>\n              </div>\n            </div>\n          </div>\n        `,console.log("âœ… ConteÃºdo HTML do edital gerado com link para download")}if(t&&t.length>0)for(const[r,C]of t.entries()){c.filter((a=>a.produto.nome===C.nome_produto||a.produto.nome===C.nome));const o={numero_folha:null,tipo_documento:"DOCUMENTACAO_PRODUTO",nome_documento:"DocumentaÃ§Ã£o de Produto",titulo:"DOCUMENTAÃ‡ÃƒO DE PRODUTO",descricao:`DocumentaÃ§Ã£o tÃ©cnica detalhada do produto ${C.nome_produto||C.nome}`,data_autuacao:new Date,ordem_especial:800+r,conteudo_html:`\n              <div class="documento-header">\n                <h1>${a.nome_orgao}</h1>\n                <h2>DOCUMENTAÃ‡ÃƒO DE PRODUTO</h2>\n                <p>Processo nÂº ${a.numero_processo}</p>\n              </div>\n              \n              <div class="documento-conteudo">\n                <h3>DADOS DO PRODUTO</h3>\n                <p><strong>Nome do Produto:</strong> ${C.nome_produto||C.nome}</p>\n                <p><strong>Marca:</strong> ${C.marca||"N/A"}</p>\n                <p><strong>Modelo:</strong> ${C.modelo||"N/A"}</p>\n                <p><strong>Categoria:</strong> ${C.categoria||"N/A"}</p>\n                <p><strong>Fabricante:</strong> ${C.fabricante||C.marca||"N/A"}</p>\n                \n                <h3>ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS</h3>\n                <p><em>${C.especificacoes_tecnicas||"EspecificaÃ§Ãµes nÃ£o informadas"}</em></p>\n                \n                \n                <h3>AVALIAÃ‡ÃƒO TÃ‰CNICA</h3>\n                <p><strong>Status:</strong> ${C.status||"Pendente de avaliaÃ§Ã£o"}</p>\n                <p><strong>Data de InclusÃ£o:</strong> ${C.created_at?new Date(C.created_at).toLocaleDateString("pt-BR"):(new Date).toLocaleDateString("pt-BR")}</p>\n                \n              </div>\n            `};s.push(o),console.log(`âœ… Criada pÃ¡gina individual para produto: ${C.nome_produto||C.nome}`)}if(c=c.filter((a=>a.documento&&a.documento.nome&&"undefined"!==a.documento.nome&&a.documento.url&&"undefined"!==a.documento.url)),c.length>0){s=s.filter((a=>"DOCUMENTO_PRODUTO"!==a.tipo_documento));const o={numero_folha:null,tipo_documento:"DOCUMENTACAO_PRODUTOS",nome_documento:"DocumentaÃ§Ã£o de Produtos",titulo:"DocumentaÃ§Ã£o de Produtos",descricao:"Documentos tÃ©cnicos dos produtos do processo",data_autuacao:new Date,ordem_especial:999,conteudo_html:`\n            <div class="documento-header">\n              <h1>${a.nome_orgao}</h1>\n              <h2>DOCUMENTAÃ‡ÃƒO DE PRODUTOS</h2>\n              <p>Processo nÂº ${a.numero_processo}</p>\n            </div>\n            \n            <div class="documento-conteudo">\n              <h3>RELAÃ‡ÃƒO DE DOCUMENTOS DE PRODUTOS</h3>\n              <p>Os seguintes documentos tÃ©cnicos estÃ£o anexados aos produtos deste processo:</p>\n              \n              ${c.filter((a=>a.documento&&a.documento.nome&&"undefined"!==a.documento.nome&&a.documento.url&&"undefined"!==a.documento.url)).map(((a,o)=>`\n                <div style="margin: 1cm 0; padding: 0.5cm; border-left: 3px solid #1976d2;">\n                  <p><strong>${o+1}. ${a.produto.nome||"Produto"}</strong></p>\n                  <p><strong>Documento:</strong> ${a.documento.nome}</p>\n                  <p><strong>Link:</strong> \n                    <a href="${a.documento.url}" target="_blank" style="color: #1976d2; text-decoration: underline; font-weight: bold;">\n                      Abrir documento\n                    </a>\n                  </p>\n                </div>\n              `)).join("")}\n            </div>\n          `};s.push(o),console.log(`âœ… Criada pÃ¡gina consolidada com ${c.length} documentos de produtos`)}const u=s.filter((a=>"FOLHA_ROSTO"===a.tipo_documento)),m=s.filter((a=>"FOLHA_ROSTO"!==a.tipo_documento));let p=null;u.length>0&&(u.sort(((a,o)=>{const t=(a.conteudo_html||"").length+((a.conteudo_html||"").includes("NOME DO Ã“RGÃƒO")?1e3:0)+((a.conteudo_html||"").includes("INTERESSADO")?1e3:0)+((a.conteudo_html||"").includes("DATA DE AUTUAÃ‡ÃƒO")?1e3:0)+((a.conteudo_html||"").includes("OBJETO:")?1e3:0),e=(o.conteudo_html||"").length+((o.conteudo_html||"").includes("NOME DO Ã“RGÃƒO")?1e3:0)+((o.conteudo_html||"").includes("INTERESSADO")?1e3:0)+((o.conteudo_html||"").includes("DATA DE AUTUAÃ‡ÃƒO")?1e3:0)+((o.conteudo_html||"").includes("OBJETO:")?1e3:0);return e-t})),p=u[0],console.log(`âœ… Escolhida melhor folha de rosto: ${p.nome_documento}`),console.log(`ğŸ“Š Score: ${(p.conteudo_html||"").length}`),u.length>1&&console.log(`âŒ Removidas ${u.length-1} folhas de rosto duplicadas`));const v=m.filter((a=>"DFD"===a.tipo_documento)),g=m.filter((a=>"DFD"!==a.tipo_documento)),_=v.length>0?v[0]:null;v.length>1&&console.log(`âŒ Removidos ${v.length-1} DFDs duplicados`),s=[],p&&s.push(p),_&&s.push(_),s.push(...g);let h=1;return s.forEach(((o,t)=>{"ASSINADO"!==o.tipo_documento||o.conteudo_html||(console.log("ğŸ–Šï¸ Gerando conteÃºdo HTML para documento ASSINADO:",o.nome_documento),o.conteudo_html=this.gerarHTMLDocumentoAssinado(a,o)),o.numero_sequencial=h++,o.numero_folha=o.numero_sequencial})),s.sort(((a,o)=>"FOLHA_ROSTO"===a.tipo_documento?-1:"FOLHA_ROSTO"===o.tipo_documento?1:"DFD"===a.tipo_documento?"FOLHA_ROSTO"===o.tipo_documento?1:-1:"DFD"===o.tipo_documento?"FOLHA_ROSTO"===a.tipo_documento?-1:1:"ASSINADO"===a.tipo_documento&&"ASSINADO"!==o.tipo_documento?1:"ASSINADO"===o.tipo_documento&&"ASSINADO"!==a.tipo_documento?-1:"ASSINADO"===a.tipo_documento&&"ASSINADO"===o.tipo_documento?new Date(a.data_autuacao||0)-new Date(o.data_autuacao||0):(a.numero_folha||999)-(o.numero_folha||999)))},gerarHTMLDocumentoAssinado(a,o){const t=new Date(o.data_autuacao).toLocaleDateString("pt-BR");return`\n        <div class="documento-header">\n          <h1>${a.nome_orgao}</h1>\n          <h2>DOCUMENTO ASSINADO PELA AUTORIDADE COMPETENTE</h2>\n          <p>Processo nÂº ${a.numero_processo}</p>\n        </div>\n        \n        <div class="documento-conteudo">\n          <div class="caixa-bordered" style="margin: 2cm auto; padding: 1.5cm; border: 2px solid #000;">\n            <h3 style="text-align: center; margin-bottom: 1.5cm; font-size: 14pt;">DECLARAÃ‡ÃƒO DE RESPONSABILIDADE</h3>\n            \n            <div class="campo" style="margin-bottom: 1cm;">\n              <p><strong>Tipo de Processo:</strong> ${"padronizacao"===a.tipo_processo?"PadronizaÃ§Ã£o de Produtos":"DespadronizaÃ§Ã£o de Produtos"}</p>\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1cm;">\n              <p><strong>Status do Processo:</strong> ${this.formatarStatus(a.status)}</p>\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1cm;">\n              <p><strong>Unidade Interessada:</strong> ${a.unidade_interessada||"NÃ£o informado"}</p>\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1.5cm;">\n              <p><strong>Data de AutuaÃ§Ã£o:</strong> ${this.formatarData(a.data_autuacao)}</p>\n            </div>\n            \n            <p style="text-align: justify; margin-bottom: 1.5cm; line-height: 1.8;">Eu, na qualidade de <strong>AUTORIDADE COMPETENTE</strong> do Ã³rgÃ£o acima identificado, declaro que:</p>\n            \n            <ul style="margin: 1.5cm 0; line-height: 1.8; text-align: justify;">\n              <li>Analisei toda a documentaÃ§Ã£o que compÃµe o presente processo administrativo;</li>\n              <li>Verifico que o processo estÃ¡ devidamente instruÃ­do e em conformidade com as normas aplicÃ¡veis;</li>\n              <li>As informaÃ§Ãµes e documentos apresentados sÃ£o verdadeiros e estÃ£o em conformidade com a legislaÃ§Ã£o vigente;</li>\n              <li>Assumo a responsabilidade pelos atos administrativos decorrentes desta assinatura.</li>\n            </ul>\n            \n            <div style="margin-top: 2cm; text-align: center;">\n              <p style="margin-bottom: 1cm;"><strong>PROCESSO DEVIDAMENTE ASSINADO</strong></p>\n              <p style="margin-bottom: 0.5cm;"><strong>Data da Assinatura:</strong> ${t}</p>\n              \n              <div style="border-top: 2px solid #000; width: 10cm; margin: 2cm auto 0.5cm auto;"></div>\n              <p><strong>AUTORIDADE COMPETENTE</strong></p>\n              <p>${a.nome_orgao}</p>\n            </div>\n          </div>\n          \n          <div style="margin-top: 1.5cm; padding: 1cm; background: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">\n            <h4 style="margin: 0 0 0.5cm 0; color: #495057;">InformaÃ§Ãµes do Documento Assinado</h4>\n            <p style="margin: 0.3cm 0;"><strong>Nome do Arquivo:</strong> ${o.nome_documento}</p>\n            <p style="margin: 0.3cm 0;"><strong>Data de AnexaÃ§Ã£o:</strong> ${t}</p>\n            <p style="margin: 0.3cm 0;"><strong>ObservaÃ§Ãµes:</strong> ${o.descricao||"Documento assinado pela autoridade competente"}</p>\n          </div>\n          \n          <div style="margin-top: 2cm; text-align: center; border-top: 1px solid #ccc; padding-top: 1cm; color: #666;">\n            <p><strong>Sistema Comprar Bem</strong> - PÃ¡gina Final do Processo</p>\n            <p>Documento integrado automaticamente - Processo nÂº ${a.numero_processo}</p>\n          </div>\n        </div>\n      `},gerarHTMLFolhaRosto(a){const o="padronizacao"===a.tipo_processo?"CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.":"DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS.";return`\n        <div class="folha-rosto-simples" style="display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 25cm;">\n          <div class="caixa-bordered" style="border: 2px solid #000; padding: 1.5cm; max-width: 16cm; width: 100%;">\n            \n            <div class="numero-processo" style="font-weight: bold; font-size: 14pt; margin-bottom: 1cm; text-align: center;">\n              <strong>PROCESSO ADMINISTRATIVO NÂº ${a.numero_processo||"[nÃ£o definido]"}</strong>\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1cm; text-align: left;">\n              <strong>NOME DO Ã“RGÃƒO:</strong> ${a.nome_orgao}\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1cm; text-align: left;">\n              <strong>INTERESSADO(A):</strong> ${a.unidade_interessada||"DEPARTAMENTO DE COMPRAS E LICITAÃ‡Ã•ES"}\n            </div>\n            \n            <div class="campo" style="margin-bottom: 1cm; text-align: left;">\n              <strong>DATA DE AUTUAÃ‡ÃƒO:</strong> ${this.formatarData(a.data_autuacao)}\n            </div>\n            \n            <div class="campo objeto" style="margin-bottom: 1cm; text-align: justify; line-height: 1.4;">\n              <strong>OBJETO:</strong> ${o}\n            </div>\n\n            \n          </div>\n        </div>\n      `},gerarHTMLDFD(a,o,t){const e="padronizacao"===a.tipo_processo?"MODELO_1":"MODELO_2",s=(a.tipo_processo,`DOCUMENTO DE FORMALIZAÃ‡ÃƒO DE DEMANDA - ${e}`);let i=`\n        <div class="documento-header" style="text-align: center; margin-bottom: 1cm;">\n          <h1 style="font-size: 16pt; font-weight: bold; margin: 0.5cm 0; page-break-inside: avoid;">${a.nome_orgao}</h1>\n          <h2 style="font-size: 14pt; font-weight: bold; margin: 0.3cm 0; page-break-inside: avoid;">${s}</h2>\n          <p style="font-size: 12pt; margin: 0.3cm 0;">Processo nÂº ${a.numero_processo}</p>\n        </div>\n        \n        <div class="documento-conteudo" style="text-align: justify; line-height: 1.7; font-size: 12pt; word-wrap: break-word; overflow-wrap: break-word; page-break-inside: avoid;">\n          \n          <h3 style="margin: 0.8cm 0 0.4cm 0; font-size: 13pt; text-transform: uppercase; page-break-after: avoid;">1. JUSTIFICATIVA</h3>\n          <p style="text-indent: 1.5cm; margin-bottom: 0.6cm; page-break-inside: avoid;">${o?.justificativa||"Justificativa da necessidade conforme processo administrativo de "+("padronizacao"===a.tipo_processo?"padronizaÃ§Ã£o":"despadronizaÃ§Ã£o")+" de produtos."}</p>\n          \n          <h3 style="margin: 0.8cm 0 0.4cm 0; font-size: 13pt; text-transform: uppercase; page-break-after: avoid;">2. DESCRIÃ‡ÃƒO DA NECESSIDADE</h3>\n          <p style="text-indent: 1.5cm; margin-bottom: 0.6cm; page-break-inside: avoid;">${o?.descricao_necessidade||"DescriÃ§Ã£o detalhada da necessidade identificada para o processo de "+("padronizacao"===a.tipo_processo?"padronizaÃ§Ã£o":"despadronizaÃ§Ã£o")+" dos produtos especificados."}</p>\n          \n          <h3 style="margin: 0.8cm 0 0.4cm 0; font-size: 13pt; text-transform: uppercase; page-break-after: avoid;">3. CRITÃ‰RIOS DE ACEITAÃ‡ÃƒO</h3>\n          <p style="text-indent: 1.5cm; margin-bottom: 0.6cm; page-break-inside: avoid;">${o?.criterios_aceitacao||"CritÃ©rios de aceitaÃ§Ã£o conforme normas tÃ©cnicas aplicÃ¡veis e especificaÃ§Ãµes definidas para o processo."}</p>\n          \n          <h2 style="margin: 1cm 0 0.5cm 0; font-size: 14pt; text-transform: uppercase;">OBSERVAÃ‡Ã•ES ESPECIAIS</h2>\n          <p style="text-indent: 1.5cm; margin-bottom: 0.8cm;">${o?.observacoes_especiais||"ObservaÃ§Ãµes especiais do processo."}</p>`;if(t&&t.length>0&&(i+=`\n          <h3 style="font-size: 13pt; margin-top: 1.5cm;">1.1. RelaÃ§Ã£o de ${"padronizacao"===a.tipo_processo?"Bens":"Bens PassÃ­veis de DespadronizaÃ§Ã£o"}:</h3>\n          <table class="tabela" style="width: 100%; border-collapse: collapse; margin: 1cm 0; font-size: 11pt;">\n            <thead>\n              <tr style="background-color: #f0f0f0;">\n                <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">ITEM</th>\n                <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">CÃ“DIGO</th>\n                <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">DESCRIÃ‡ÃƒO</th>\n                <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">UNIDADE</th>\n                <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">${"padronizacao"===a.tipo_processo?"REQUISITOS MÃNIMOS":"MOTIVAÃ‡ÃƒO"}</th>\n                ${"padronizacao"===a.tipo_processo?'<th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold;">PREÃ‡O ESTIMADO</th>':""}\n              </tr>\n            </thead>\n            <tbody>\n              ${t.map(((o,t)=>`\n                <tr>\n                  <td style="border: 1px solid #000; padding: 8px; text-align: center;">${t+1}</td>\n                  <td style="border: 1px solid #000; padding: 8px;">${o.codigo||"N/A"}</td>\n                  <td style="border: 1px solid #000; padding: 8px;">${o.nome_produto}</td>\n                  <td style="border: 1px solid #000; padding: 8px; text-align: center;">UN</td>\n                  <td style="border: 1px solid #000; padding: 8px;">${o.especificacoes_tecnicas||"A definir"}</td>\n                  ${"padronizacao"===a.tipo_processo?`<td style="border: 1px solid #000; padding: 8px; text-align: right;">R$ ${o.valor_estimado||"0,00"}</td>`:""}\n                </tr>\n              `)).join("")}\n            </tbody>\n          </table>`),"padronizacao"===a.tipo_processo&&(o?.produtos_especificacao&&(i+=`\n            <h3 style="margin-top: 1cm; font-size: 13pt; page-break-after: avoid;">4. ESPECIFICAÃ‡ÃƒO DOS PRODUTOS</h3>\n            <p style="text-indent: 1.5cm; margin-bottom: 0.6cm; page-break-inside: avoid;">${o.produtos_especificacao}</p>`),o?.quantidade_amostras&&(i+=`\n            <h4 style="margin-top: 0.8cm; font-size: 12pt; page-break-after: avoid;">4.1. Quantidades de Amostras</h4>\n            <p style="text-indent: 1.5cm; margin-bottom: 0.4cm;">${o.quantidade_amostras} unidades</p>`),o?.previsao_aquisicoes&&(i+=`\n            <h4 style="margin-top: 0.8cm; font-size: 12pt; page-break-after: avoid;">4.2. PrevisÃ£o de AquisiÃ§Ãµes</h4>\n            <p style="text-indent: 1.5cm; margin-bottom: 0.4cm;">${o.previsao_aquisicoes} unidades</p>`),o?.especificacoes_tecnicas&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">3. ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS:</h2>\n            <p style="text-indent: 1.5cm;">${o.especificacoes_tecnicas}</p>`),o?.ensaios_exigidos&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">4. ENSAIOS EXIGIDOS:</h2>\n            <p style="text-indent: 1.5cm;">${o.ensaios_exigidos}</p>`),o?.local_entrega_amostras&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">5. LOCAL DE ENTREGA DAS AMOSTRAS:</h2>\n            <p style="text-indent: 1.5cm;">${o.local_entrega_amostras}</p>`),o?.prazo_entrega_amostras&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">6. PRAZO PARA ENTREGA DAS AMOSTRAS:</h2>\n            <p style="text-indent: 1.5cm;">${o.prazo_entrega_amostras}</p>`)),"despadronizacao"===a.tipo_processo){o?.produtos_despadronizar&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">2. PRODUTOS A SEREM DESPADRONIZADOS:</h2>\n            <p style="text-indent: 1.5cm;">${o.produtos_despadronizar}</p>`),i+='\n          <h2 style="margin-top: 2cm; font-size: 14pt;">3. FONTES DA DEMANDA:</h2>';const a=[];o?.fonte_rdm&&a.push("RelatÃ³rios de Desempenho de Material (RDM)"),o?.fonte_reclamacoes_usuarios&&a.push("ReclamaÃ§Ãµes de usuÃ¡rios"),o?.fonte_sistema_comprar_bem&&a.push("Sistema Comprar Bem"),o?.fonte_analise_tecnica&&a.push("AnÃ¡lise tÃ©cnica"),o?.fonte_outros&&a.push("Outros"),a.length>0&&(i+='<ul style="margin-left: 2cm;">',a.forEach((a=>{i+=`<li>${a}</li>`})),i+="</ul>"),o?.outras_fontes&&(i+=`\n            <h3 style="margin-top: 1cm; font-size: 13pt;">3.1. Outras Fontes:</h3>\n            <p style="text-indent: 1.5cm;">${o.outras_fontes}</p>`),o?.problemas_identificados&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">4. PROBLEMAS IDENTIFICADOS:</h2>\n            <p style="text-indent: 1.5cm;">${o.problemas_identificados}</p>`),o?.frequencia_problemas&&(i+=`\n            <h3 style="margin-top: 1cm; font-size: 13pt;">4.1. FrequÃªncia dos Problemas:</h3>\n            <p style="text-indent: 1.5cm;">${o.frequencia_problemas}</p>`),o?.impacto_problemas&&(i+=`\n            <h3 style="margin-top: 1cm; font-size: 13pt;">4.2. Impacto dos Problemas:</h3>\n            <p style="text-indent: 1.5cm;">${o.impacto_problemas}</p>`),o?.quantidade_adquirida&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">5. QUANTIDADES:</h2>\n            <p style="text-indent: 1.5cm;"><strong>Quantidade adquirida:</strong> ${o.quantidade_adquirida} unidades</p>`),o?.quantidade_problemas&&(i+=`\n            <p style="text-indent: 1.5cm;"><strong>Quantidade com problemas:</strong> ${o.quantidade_problemas} unidades</p>`),o?.prejuizo_estimado&&(i+=`\n            <p style="text-indent: 1.5cm;"><strong>PrejuÃ­zo estimado:</strong> R$ ${o.prejuizo_estimado}</p>`),o?.rdms_negativos&&(i+=`\n            <p style="text-indent: 1.5cm;"><strong>RDMs negativos:</strong> ${o.rdms_negativos}</p>`),o?.parecer_tecnico&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">6. PARECER TÃ‰CNICO:</h2>\n            <p style="text-indent: 1.5cm;">${o.parecer_tecnico}</p>`),o?.alternativas_avaliadas&&(i+=`\n            <h2 style="margin-top: 2cm; font-size: 14pt;">7. ALTERNATIVAS AVALIADAS:</h2>\n            <p style="text-indent: 1.5cm;">${o.alternativas_avaliadas}</p>`)}return o?.base_legal&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">BASE LEGAL:</h2>\n          <p style="text-indent: 1.5cm;">${o.base_legal}</p>`),o?.impacto_esperado&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">IMPACTO ESPERADO:</h2>\n          <p style="text-indent: 1.5cm;">${o.impacto_esperado}</p>`),o?.riscos_identificados&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">RISCOS IDENTIFICADOS:</h2>\n          <p style="text-indent: 1.5cm;">${o.riscos_identificados}</p>`),o?.medidas_mitigadoras&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">MEDIDAS MITIGADORAS:</h2>\n          <p style="text-indent: 1.5cm;">${o.medidas_mitigadoras}</p>`),o?.prazo_vigencia&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">PRAZO DE VIGÃŠNCIA:</h2>\n          <p style="text-indent: 1.5cm;">${o.prazo_vigencia} meses</p>`),o?.periodicidade_revisao&&(i+=`\n          <h2 style="margin-top: 2cm; font-size: 14pt;">PERIODICIDADE DE REVISÃƒO:</h2>\n          <p style="text-indent: 1.5cm;">${o.periodicidade_revisao}</p>`),i+=`\n          <div style="margin-top: 1.5cm; page-break-inside: avoid;">\n            <p style="text-align: justify; margin-bottom: 1cm;">Nestes termos, encaminha-se o presente DFD Ã  autoridade competente, para ciÃªncia da presente demanda e autorizaÃ§Ã£o para a abertura e instruÃ§Ã£o do pertinente processo administrativo.</p>\n            \n            <p style="margin-bottom: 1.5cm;">Em ${(new Date).toLocaleDateString("pt-BR")}.</p>\n            \n            <div style="text-align: center; margin-top: 2cm;">\n              <p style="margin-bottom: 0.5cm;"><strong>Data:</strong> ${(new Date).toLocaleDateString("pt-BR")}</p>\n              <div style="border-top: 1px solid #000; width: 8cm; margin: 1cm auto 0.3cm auto;"></div>\n              <p><strong>Equipe TÃ©cnica ResponsÃ¡vel</strong></p>\n              <p>${a.nome_orgao}</p>\n            </div>\n          </div>\n        </div>\n      `,i},async filtrarProcessos(){try{let a=[...this.processos];if(this.filtroTipo&&(a=a.filter((a=>a.tipo_processo===this.filtroTipo))),this.filtroStatus&&(a=a.filter((a=>a.status===this.filtroStatus))),this.termoBusca){const o=this.termoBusca.toLowerCase();a=a.filter((a=>a.numero_processo.toLowerCase().includes(o)||a.objeto.toLowerCase().includes(o)||a.nome_orgao.toLowerCase().includes(o)))}this.aplicarOrdenacao(a),this.processosFiltrados=a}catch(a){console.error("Erro ao filtrar processos:",a),this.processosFiltrados=[...this.processos]}},aplicarOrdenacao(a){switch(this.ordenacao){case"data_desc":a.sort(((a,o)=>new Date(o.data_autuacao)-new Date(a.data_autuacao)));break;case"data_asc":a.sort(((a,o)=>new Date(a.data_autuacao)-new Date(o.data_autuacao)));break;case"numero_asc":a.sort(((a,o)=>a.numero_processo.localeCompare(o.numero_processo)));break;case"numero_desc":a.sort(((a,o)=>o.numero_processo.localeCompare(a.numero_processo)));break;case"status":a.sort(((a,o)=>a.status.localeCompare(o.status)));break}},abrirAssistente(a=null){this.modoEdicao=!1,this.processoParaEditar=null,this.tipoProcessoInicial=a,this.mostrarAssistente=!0,document.body.style.overflow="hidden",console.log("ğŸ†• Abrindo assistente para criar NOVO processo. Tipo prÃ©-selecionado:",a)},processoCriado(a){this.fecharAssistente(),this.carregarProcessos(),alert(`Processo ${a.numero_processo} criado com sucesso!`),this.abrirProcesso(a)},async abrirProcesso(a){try{if(console.log("Carregando processo:",a.id),this.processoSelecionado=await i["default"].obterProcesso(a.id),!this.processoSelecionado)throw new Error("Processo nÃ£o encontrado");await this.carregarDocumentosProcesso(a.id),"padronizacao"===this.processoSelecionado.tipo_processo&&await this.carregarProdutosProcesso(a.id),this.podeAdicionarDoc=await this.podeAdicionarDocumento(this.processoSelecionado),console.log("Processo carregado com sucesso:",this.processoSelecionado)}catch(o){console.error("Erro ao abrir processo:",o),alert(`Erro ao carregar detalhes do processo: ${o.message}`)}},visualizarProcesso(a){console.log("ğŸ” DEBUG - Visualizando processo:",a.numero_processo,"Status:",`"${a.status}"`),console.log("ğŸ” DEBUG - Processo completo:",a),console.log("ğŸ” DEBUG - ComparaÃ§Ã£o:","em_criacao"===a.status,a.status,typeof a.status),a.status&&a.status.includes("submetido")&&console.log('ğŸš¨ DEBUG ESPECÃFICO - Status contÃ©m "submetido":',{statusOriginal:a.status,statusTrimmed:a.status.trim(),statusLength:a.status.length,statusBytes:Array.from(a.status).map((a=>a.charCodeAt(0))),isExactMatch:"submetido_autoridade"===a.status}),"rascunho"===a.status||"em_criacao"===a.status?(console.log("ğŸ”§ Processo EM CRIAÃ‡ÃƒO/RASCUNHO - Abrindo Assistente para ediÃ§Ã£o"),this.editarProcesso(a)):(console.log("ğŸ‘ï¸ Processo FINALIZADO - Abrindo visualizaÃ§Ã£o normal, status:",a.status),this.abrirProcesso(a))},fecharAssistente(){this.mostrarAssistente=!1,this.modoEdicao=!1,this.processoParaEditar=null,this.tipoProcessoInicial=null,document.body.style.overflow="auto"},fecharVisualizacaoProcesso(){this.processoSelecionado=null,this.documentosProcesso=[],this.podeAdicionarDoc=!1},editarProcesso(a){console.log("âœï¸ EDITAR processo existente:",a.numero_processo,"Status:",a.status),this.podeEditarProcesso(a)?(this.modoEdicao=!0,this.processoParaEditar=a,this.mostrarAssistente=!0,document.body.style.overflow="hidden",console.log("âœï¸ Assistente aberto em modo EDIÃ‡ÃƒO para processo:",a.numero_processo)):alert("Apenas processos em criaÃ§Ã£o podem ser editados. Depois de criados, Ã© possÃ­vel apenas adicionar documentos.")},async gerarRelatorio(a){try{console.log("Gerando relatÃ³rio PDF para processo:",a.id);const t=await i["default"].obterProcesso(a.id);let e=await i["default"].listarDocumentosProcesso(a.id),s=[];if("padronizacao"===t.tipo_processo){s=await i["default"].listarProdutosProcesso(a.id);const o=await i["default"].getTenantId(),{data:t}=await r.ND.from("documentos_produtos_processo").select("*").eq("processo_id",a.id).eq("tenant_id",o);if(t&&t.length>0)for(const a of t)e.push({id:`produto_${a.id}`,tipo_documento:"DOCUMENTO_PRODUTO",nome_documento:`${a.nome_produto} - ${a.nome_arquivo}`,titulo:`${a.nome_produto} - ${a.nome_arquivo}`,descricao:`Documento tÃ©cnico do produto ${a.nome_produto}`,data_autuacao:a.created_at,arquivo_url:a.url_arquivo,nome_arquivo:a.nome_arquivo})}let n=null;try{const{data:o}=await r.ND.from("dfd_processo").select("*").eq("processo_id",a.id).single();n=o,console.log("âœ… DFD carregado do banco:",n)}catch(o){console.log("âš ï¸ DFD nÃ£o encontrado no banco, usando dados padrÃ£o"),n={justificativa:"Justificativa da necessidade conforme processo administrativo e demanda apresentada pelos setores solicitantes.",descricao_necessidade:"DescriÃ§Ã£o detalhada da necessidade identificada para padronizaÃ§Ã£o/despadronizaÃ§Ã£o dos produtos especificados.",criterios_aceitacao:"CritÃ©rios de aceitaÃ§Ã£o e ensaios estabelecidos conforme normas tÃ©cnicas aplicÃ¡veis.",observacoes_especiais:"ObservaÃ§Ãµes especiais e condiÃ§Ãµes especÃ­ficas do processo de avaliaÃ§Ã£o.",modelo_usado:"MODELO_1"}}let c=null;try{if(console.log("ğŸ” [DEBUG] Verificando se processo possui ata de julgamento CCL..."),console.log("ğŸ” [DEBUG] Status do processo:",t.status),console.log("ğŸ” [DEBUG] Possui ata_julgamento_ccl?",!!t.ata_julgamento_ccl),t.status&&["ata_ccl","ata_julgamento_emitida_ccl","em_prazo_recursal","finalizado"].includes(t.status)){console.log("ğŸ” [DEBUG] CENÃRIO 1: Processo passou por ata formal, buscando ata na tabela...");const{data:o,error:t}=await r.ND.from("atas_julgamento").select("*").eq("processo_id",a.id).eq("tenant_id",await i["default"].getTenantId()).order("created_at",{ascending:!1}).limit(1).single();!t&&o?(c=o,console.log("âœ… [DEBUG] Ata formal encontrada:",o.numero)):console.log("âš ï¸ [DEBUG] Ata formal nÃ£o encontrada na tabela, usando dados do processo")}!c&&t.ata_julgamento_ccl&&(console.log("ğŸ” [DEBUG] CENÃRIO 2: HomologaÃ§Ã£o direta - usando fundamentaÃ§Ã£o CCL do processo"),c={numero:`ATA-CCL-DIRETA-${a.id}`,tipo:"homologacao_direta",conteudo_ata:t.ata_julgamento_ccl,descricao:"DecisÃ£o direta da CCL - HomologaÃ§Ã£o sem ata formal",data_publicacao:t.ata_emitida_ccl_em,status_ata:"HOMOLOGACAO_DIRETA"},console.log("âœ… [DEBUG] Ata de homologaÃ§Ã£o direta criada virtualmente")),c||console.log("â„¹ï¸ [DEBUG] CENÃRIO 3: Processo ainda nÃ£o possui julgamento CCL")}catch(o){console.warn("âš ï¸ [DEBUG] Erro ao buscar ata CCL:",o)}console.log("Documentos encontrados:",e),console.log("Produtos encontrados:",s),console.log("DFD encontrado:",n),console.log("Ata CCL encontrada:",c?`${c.numero} (${c.tipo||"formal"})`:"Nenhuma");const l=await this.completarDocumentosProcesso(t,e,s,n);console.log("Documentos completos apÃ³s processamento:",l);const d=this.gerarHTMLRelatorio(t,l,s,c),u=new Blob([d],{type:"text/html"}),m=URL.createObjectURL(u),p=(t.numero_processo||t.id,(new Date).toISOString().split("T")[0],window.open("","_blank"));p.document.write(d),p.document.close(),setTimeout((()=>{if(p&&!p.closed){const a=p.document.createElement("div");a.id="download-controls",a.style.cssText="\n              position: fixed; \n              top: 10px; \n              right: 10px; \n              background: #fff; \n              border: 2px solid #dc3545; \n              border-radius: 8px; \n              padding: 15px; \n              box-shadow: 0 4px 8px rgba(0,0,0,0.2); \n              z-index: 9999;\n              display: flex;\n              gap: 10px;\n              font-family: Arial, sans-serif;\n            ";const o=p.document.createElement("button");o.innerHTML="ğŸ“„ Baixar PDF",o.style.cssText="\n              background: #dc3545; \n              color: white; \n              border: none; \n              padding: 8px 15px; \n              border-radius: 5px; \n              cursor: pointer;\n              font-weight: bold;\n            ",o.onclick=()=>{a.style.display="none",setTimeout((()=>{p.print(),setTimeout((()=>{p.closed||(a.style.display="flex")}),2e3)}),100)};const t=p.document.createElement("button");t.innerHTML="âœ•",t.style.cssText="\n              background: #6c757d; \n              color: white; \n              border: none; \n              padding: 8px 12px; \n              border-radius: 5px; \n              cursor: pointer;\n              font-weight: bold;\n            ",t.onclick=()=>{a.style.display="none"},a.appendChild(o),a.appendChild(t),p.document.body.insertBefore(a,p.document.body.firstChild),p.console.log('ğŸ’¡ DICA: Clique em "Baixar PDF" e escolha "Salvar como PDF" no destino da impressÃ£o.');const e=p.document.createElement("style");e.textContent="\n              @media print {\n                #download-controls {\n                  display: none !important;\n                }\n              }\n            ",p.document.head.appendChild(e)}}),1e3),setTimeout((()=>{URL.revokeObjectURL(m)}),1e4)}catch(o){console.error("Erro ao gerar relatÃ³rio:",o),alert(`Erro ao gerar relatÃ³rio: ${o.message}`)}},async enviarParaAnaliseAdministrativa(a){this.dadosConfirmacaoTramitacao={icone:"ğŸš€",titulo:"Enviar para AnÃ¡lise Administrativa",numeroProcesso:a.numero_processo,statusAtual:"Criado pela CPM",proximoStatus:"Aguardando Assinatura",placeholderObservacoes:"Ex: Processo revisado e aprovado pela equipe tÃ©cnica...",consequencia1:"O processo serÃ¡ encaminhado para o Ã³rgÃ£o administrativo",consequencia2:"VocÃª receberÃ¡ uma notificaÃ§Ã£o por email sobre o andamento",consequencia3:'O status serÃ¡ alterado para "Aguardando Assinatura"',textoBotao:"Enviar para AnÃ¡lise"},this.callbackConfirmacao=async()=>{try{console.log("Enviando processo para anÃ¡lise administrativa:",a.id);const o=this.observacoesTramitacao||"Processo enviado para anÃ¡lise administrativa",t=await c.A.enviarProcesso(a.id,o);if(!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o do processo");{console.log("âœ… Processo enviado com sucesso:",t);const o=this.processos.findIndex((o=>o.id===a.id));-1!==o&&(this.processos[o].status=t.statusNovo),this.processoSelecionado&&this.processoSelecionado.id===a.id&&(this.processoSelecionado.status=t.statusNovo),await this.carregarAcoesDisponiveis(),this.$toast?.success(`âœ… Processo enviado com sucesso!\n\nStatus: ${t.statusAnterior} â†’ ${t.statusNovo}`),await this.carregarProcessos()}}catch(o){console.error("Erro ao enviar processo para anÃ¡lise:",o),this.$toast?.error(`âŒ Erro ao enviar processo: ${o.message}`)||alert(`âŒ Erro: ${o.message}`)}},this.observacoesTramitacao="",this.mostrarModalConfirmacaoTramitacao=!0},adicionarDocumento(a){console.log("ğŸ“ Abrindo modal para adicionar documento ao processo:",a.numero_processo),this.processoSelecionado=a,this.mostrarModalAdicionarDoc=!0},abrirRelatorios(){alert("Funcionalidade de relatÃ³rios em desenvolvimento")},abrirConfiguracoes(){alert("Funcionalidade de configuraÃ§Ãµes em desenvolvimento")},abrirModalEdital(a){this.processoSelecionado=a,this.mostrarModalEdital=!0},fecharModalEdital(){this.mostrarModalEdital=!1,this.processoSelecionado=null},async onEditalVinculado(a){try{console.log("ğŸ”— DEBUG - Edital vinculado, evento recebido:",a);const o=this.processos.findIndex((o=>o.id===a.processo.id));-1!==o&&(this.processos[o]={...this.processos[o],...a.processo}),this.processoSelecionado&&this.processoSelecionado.id===a.processo.id&&(this.processoSelecionado={...this.processoSelecionado,...a.processo},console.log("âœ… DEBUG - Processo selecionado atualizado")),this.processoSelecionado&&this.processoSelecionado.id===a.processo.id&&(console.log("ğŸ”„ DEBUG - Recarregando documentos do processo apÃ³s vincular edital"),await this.carregarDocumentosProcesso(this.processoSelecionado.id)),console.log("âœ… Edital vinculado com sucesso:",a.dadosEdital)}catch(o){console.error("âŒ Erro ao processar vinculaÃ§Ã£o de edital:",o)}},visualizarDocumentacao(a){this.processoSelecionado=a,this.mostrarDocumentacao=!0},fecharDocumentacao(){this.mostrarDocumentacao=!1,this.processoSelecionado=null},fecharModalAdicionarDoc(){this.mostrarModalAdicionarDoc=!1,this.processoSelecionado=null},async carregarAcoesDisponiveis(){try{console.log("ğŸ”„ DEBUG - Carregando aÃ§Ãµes disponÃ­veis para",this.processos.length,"processos");const a={};for(const o of this.processos){const t=await c.A.obterAcoesDisponiveis(o);a[o.id]=t,console.log(`ğŸ” DEBUG - Processo ${o.numero_processo} (${o.status}):`,t),"submetido_autoridade"===o.status&&(console.log(`ğŸš¨ ATENÃ‡ÃƒO - Processo ${o.numero_processo} com status "submetido_autoridade" tem ${t.length} aÃ§Ãµes`),t.forEach(((a,o)=>{console.log(`  AÃ§Ã£o ${o+1}:`,a)})))}this.acoesDisponiveis=a,console.log("ğŸ”„ DEBUG - AÃ§Ãµes disponÃ­veis carregadas:",a),this.$forceUpdate()}catch(a){console.error("Erro ao carregar aÃ§Ãµes disponÃ­veis:",a),this.acoesDisponiveis={}}},async executarAcaoTramitacao(a,o){try{let t="",e="";if("ENVIAR"===o.tipo)t=prompt("ObservaÃ§Ãµes para envio:")||"";else if("ENVIAR_FLEXIVEL"===o.tipo)t=prompt(`ObservaÃ§Ãµes para ${o.descricao}:`)||"";else if("DEVOLVER"===o.tipo){if(e=prompt("Motivo da devoluÃ§Ã£o (obrigatÃ³rio):"),!e||""===e.trim())return void alert("Motivo Ã© obrigatÃ³rio para devolver um processo.");t=prompt("ObservaÃ§Ãµes adicionais:")||""}else if("REJEITAR"===o.tipo){if(e=prompt("Motivo da rejeiÃ§Ã£o (obrigatÃ³rio):"),!e||""===e.trim())return void alert("Motivo Ã© obrigatÃ³rio para rejeitar um processo.");t=prompt("ObservaÃ§Ãµes adicionais:")||""}const s=confirm(`Confirma ${o.label.toLowerCase()}?\n\n${o.descricao}`);if(!s)return;let i;switch(o.tipo){case"ENVIAR":i=await c.A.enviarProcesso(a.id,t);break;case"ENVIAR_FLEXIVEL":i=await c.A.enviarProcessoFlexivel(a.id,o.statusDestino,o.tipoFlexivel,t);break;case"DEVOLVER":i=await c.A.devolverProcesso(a.id,e,t);break;case"REJEITAR":i=await c.A.rejeitarProcesso(a.id,e,t);break;default:throw new Error(`AÃ§Ã£o nÃ£o implementada: ${o.tipo}`)}if(i&&i.sucesso){this.obterInfoStatus(i.statusNovo);if(alert(`âœ… AÃ§Ã£o executada com sucesso!\n\nStatus anterior: ${i.statusAnterior}\nNovo status: ${i.statusNovo}`),await this.carregarProcessos(),this.processoSelecionado&&this.processoSelecionado.id===a.id){const o=this.processos.find((o=>o.id===a.id));o&&(this.processoSelecionado=o,await this.carregarAcoesDisponiveis())}}}catch(t){console.error("Erro ao executar aÃ§Ã£o:",t),alert(`Erro ao executar aÃ§Ã£o: ${t.message}`)}},obterInfoStatus(a){const o={criado_cpm:"ğŸ¯ Criado pela CPM",aprovado_cpm:"ğŸ“‹ Aprovado pela CPM",assinado_admin:"âœ… Assinado pelo Ã“rgÃ£o",julgamento_ccl:"âš–ï¸ Julgamento CCL",aprovado_ccl:"ğŸ’œ Aprovado pela CCL",aprovado_juridico:"âš–ï¸ Aprovado Juridicamente",homologado:"âœ… Com HomologaÃ§Ã£o",finalizado:"ğŸ† Finalizado",criado_cpm_desp:"ğŸ¯ Criado pela CPM",submetido_autoridade_desp:"ğŸ“‹ Submetido Ã  Autoridade",abertura_autorizada_desp:"âœ… Abertura Autorizada",homologado_desp:"âœ… Com HomologaÃ§Ã£o",rejeitado_cpm:"âŒ Rejeitado pela CPM",rejeitado_admin:"âŒ Rejeitado pelo Ã“rgÃ£o",rejeitado_ccl:"âŒ Rejeitado pela CCL",rejeitado_juridico:"âŒ Rejeitado Juridicamente"};return o[a]||a},obterLabelAcao(a){const o={submeter_analise:"ğŸ¯ Submeter para AnÃ¡lise",aprovar_cpm:"âœ… Aprovar (CPM)",rejeitar_cpm:"âŒ Rejeitar (CPM)",assinar_admin:"âœï¸ Assinar (Ã“rgÃ£o)",rejeitar_admin:"âŒ Rejeitar (Ã“rgÃ£o)",enviar_ccl:"ğŸ“¤ Enviar para CCL",aprovar_ccl:"âš–ï¸ Aprovar (CCL)",rejeitar_ccl:"âŒ Rejeitar (CCL)",aprovar_juridico:"âš–ï¸ Aprovar (JurÃ­dico)",rejeitar_juridico:"âŒ Rejeitar (JurÃ­dico)",homologar:"ğŸ† Homologar",rejeitar_final:"âŒ Rejeitar Final"};return o[a]||a},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):"N/A"},visualizarDocumento(a){const o=a.arquivo_url||a.url_arquivo;o?(console.log("ğŸ“„ Abrindo documento:",a.nome_documento,"URL:",o),window.open(o,"_blank")):(console.warn("âš ï¸ Documento sem URL:",a),alert("Este documento nÃ£o possui arquivo anexo para visualizaÃ§Ã£o."))},obterTipoProcesso(a){return i["default"].obterTipoProcesso(a)},obterStatusProcesso(a){return i["default"].obterStatusProcesso(a)},formatarStatus(a){return i["default"].obterStatusProcesso(a).label},onSelectDocumento(a){const o=Array.from(a.target.files);this.adicionarArquivos(o)},onDropDocumento(a){a.preventDefault();const o=Array.from(a.dataTransfer.files);this.adicionarArquivos(o)},adicionarArquivos(a){const o=[".pdf"],t=52428800;a.forEach((a=>{const e="."+a.name.split(".").pop().toLowerCase();if(!o.includes(e))return void alert(`Formato nÃ£o permitido: ${a.name}. Use apenas arquivos PDF`);if(a.size>t)return void alert(`Arquivo muito grande: ${a.name}. MÃ¡ximo: 50MB`);const s=this.documentosParaUpload.some((o=>o.name===a.name&&o.size===a.size));s||this.documentosParaUpload.push(a)}))},removerDocumento(a){this.documentosParaUpload.splice(a,1)},formatarTamanho(a){if(0===a)return"0 Bytes";const o=1024,t=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(a)/Math.log(o));return parseFloat((a/Math.pow(o,e)).toFixed(2))+" "+t[e]},async uploadDocumentos(){if(0!==this.documentosParaUpload.length)if(this.isOrgaoAdministrativo()||this.tipoDocumentoSelecionado)try{this.processandoUpload=!0;let t=0,e=[];for(let o=0;o<this.documentosParaUpload.length;o++){const s=this.documentosParaUpload[o];try{console.log(`ğŸ“¤ Enviando arquivo ${o+1}/${this.documentosParaUpload.length}: ${s.name}`);const a=`${Date.now()}_${s.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`;let e,c,l=0,d=!1;while(l<3&&!d){l++,console.log(`ğŸ”„ Tentativa ${l} de upload para: ${s.name}`);const o=await r.ND.storage.from("documentosprocessos").upload(a,s);e=o.data,c=o.error,c?(console.warn(`âš ï¸ Tentativa ${l} falhou:`,c),l<3&&await new Promise((a=>setTimeout(a,2e3)))):(d=!0,console.log(`âœ… Upload realizado com sucesso: ${s.name}`))}if(!d)throw new Error(`Falha no upload apÃ³s 3 tentativas: ${c?.message||"Erro desconhecido"}`);const{data:{publicUrl:u}}=r.ND.storage.from("documentosprocessos").getPublicUrl(a);console.log(`ğŸ”— URL gerada: ${u}`);const m=this.isOrgaoAdministrativo()?"ASSINADO":this.tipoDocumentoSelecionado;let p,v;if("ASSINADO"===m){const a=Date.now();p=9e3+a%1e3,v=`AS-${String(a%100).padStart(2,"0")}`,console.log(`ğŸ–Šï¸ Documento ASSINADO - NumeraÃ§Ã£o especial: ${v} (nÃºmero ${p})`)}else{const a=await n["default"].obterProximoNumero(this.processoSelecionado.id);p=a.numero,v=a.folha,console.log(`ğŸ“‹ NumeraÃ§Ã£o normal gerada: ${v} (nÃºmero ${p})`)}const g={processo_id:this.processoSelecionado.id,tenant_id:await i["default"].getTenantId(),numero_sequencial:p,folha_numero:v,tipo_documento:m,nome_documento:s.name,titulo:s.name,descricao:this.observacoesDocumento||`Documento ${m.toLowerCase()} adicionado pelo Ã³rgÃ£o administrativo`,arquivo_url:u,data_autuacao:(new Date).toISOString(),assinado:!1,status:"ativo"};let _,h=0,f=!1;while(h<3&&!f){h++,console.log(`ğŸ”„ Tentativa ${h} de registro no banco para: ${s.name}`);const a=await r.ND.from("documentos_processo").insert([g]);_=a.error,_?(console.warn(`âš ï¸ Tentativa ${h} do banco falhou:`,_),h<3&&await new Promise((a=>setTimeout(a,1e3)))):(f=!0,console.log(`âœ… Registro no banco realizado com sucesso: ${s.name}`))}if(!f)throw new Error(`Falha no registro no banco apÃ³s 3 tentativas: ${_?.message||"Erro desconhecido"}`);t++,console.log(`âœ… Arquivo processado com sucesso: ${s.name}`)}catch(a){console.error(`âŒ Erro ao processar ${s.name}:`,a),e.push(`${s.name}: ${a.message}`)}}if(t>0){let a=`âœ… ${t} documento(s) adicionado(s) com sucesso!`;e.length>0&&(a+=`\n\nâŒ ${e.length} falha(s):\n${e.join("\n")}`),alert(a),this.documentosParaUpload=[],this.tipoDocumentoSelecionado="",this.observacoesDocumento="";try{await this.carregarDocumentosProcesso(this.processoSelecionado.id)}catch(o){console.warn("Erro ao recarregar documentos:",o)}this.fecharModalAdicionarDoc()}else alert(`âŒ Nenhum documento foi adicionado.\n\nErros:\n${e.join("\n")}`)}catch(t){console.error("Erro geral no upload de documentos:",t),alert("âŒ Erro inesperado no upload: "+t.message)}finally{this.processandoUpload=!1}else alert("Selecione o tipo do documento");else alert("Selecione pelo menos um documento")},formatarDataHora(a){return a?new Date(a).toLocaleString("pt-BR"):"N/A"},fecharModalConfirmacaoTramitacao(){this.mostrarModalConfirmacaoTramitacao=!1,this.dadosConfirmacaoTramitacao={},this.observacoesTramitacao="",this.processandoTramitacao=!1,this.callbackConfirmacao=null},async confirmarTramitacao(){if(this.callbackConfirmacao){this.processandoTramitacao=!0;try{await this.callbackConfirmacao(),this.fecharModalConfirmacaoTramitacao()}catch(a){console.error("Erro na tramitaÃ§Ã£o:",a),this.processandoTramitacao=!1}}},abrirModalDevolucao(a){console.log("ğŸ“ Abrindo modal de devoluÃ§Ã£o para processo:",a.numero_processo),this.processoParaDevolucao=a,this.motivoDevolucao="",this.observacoesDevolucao="",this.processandoDevolucao=!1,this.mostrarModalDevolucao=!0},fecharModalDevolucao(){this.mostrarModalDevolucao=!1,this.processoParaDevolucao=null,this.motivoDevolucao="",this.observacoesDevolucao="",this.processandoDevolucao=!1},async confirmarDevolucao(){if(this.motivoDevolucao.trim()){this.processandoDevolucao=!0;try{console.log("ğŸ”„ Devolvendo processo:",this.processoParaDevolucao.numero_processo);const a=await c.A.devolverProcesso(this.processoParaDevolucao.id,this.motivoDevolucao,this.observacoesDevolucao);a.sucesso&&(console.log("âœ… Processo devolvido com sucesso"),alert(`âœ… PROCESSO DEVOLVIDO COM SUCESSO\n\nProcesso: ${this.processoParaDevolucao.numero_processo}\nStatus anterior: ${this.obterNomeStatus(a.statusAnterior)}\nStatus atual: ${this.obterNomeStatus(a.statusNovo)}\n\nO processo foi devolvido para a CPM com o motivo informado.`),await this.carregarProcessos(),this.fecharModalDevolucao(),this.fecharVisualizacaoProcesso())}catch(a){console.error("âŒ Erro ao devolver processo:",a),alert(`âŒ Erro ao devolver processo: ${a.message}`)}finally{this.processandoDevolucao=!1}}else alert("âš ï¸ Por favor, informe o motivo da devoluÃ§Ã£o.")},async assinarEEnviarProcesso(a){try{console.log("âœï¸ Assinando e enviando processo para CCL:",a.numero_processo);const o=confirm(`âœï¸ ASSINAR E ENVIAR PROCESSO\n\nProcesso: ${a.numero_processo}\nStatus atual: Aguardando Assinatura do Ã“rgÃ£o\nPrÃ³ximo status: Assinado pelo Ã“rgÃ£o Administrativo\n\nConfirma a assinatura e envio para a CCL?`);if(!o)return;const t=await c.A.enviarProcesso(a.id,"Documento assinado pelo Ã“rgÃ£o Administrativo");t.sucesso&&(console.log("âœ… Processo assinado e enviado com sucesso"),alert(`âœ… PROCESSO ASSINADO E ENVIADO\n\nProcesso: ${a.numero_processo}\nStatus anterior: ${this.obterNomeStatus(t.statusAnterior)}\nStatus atual: ${this.obterNomeStatus(t.statusNovo)}\n\nO processo foi assinado e enviado para julgamento da CCL.`),await this.carregarProcessos(),this.fecharVisualizacaoProcesso())}catch(o){console.error("âŒ Erro ao assinar e enviar processo:",o),alert(`âŒ Erro ao processar assinatura: ${o.message}`)}},obterNomeStatus(a){const o={rascunho:"Rascunho",aguardando_aprovacao:"Aguardando AprovaÃ§Ã£o",criado_cpm:"Criado pela CPM",criado_cpm_desp:"Criado pela CPM",aguardando_assinatura_orgao:"Aguardando Assinatura do Ã“rgÃ£o",aguardando_assinatura_orgao_desp:"Aguardando Assinatura do Ã“rgÃ£o",assinado_admin:"Assinado pelo Ã“rgÃ£o Administrativo",julgamento_ccl:"Em Julgamento pela CCL",aprovado_ccl:"Aprovado pela CCL",aprovado_juridico:"Aprovado pela Assessoria JurÃ­dica",edital_publicado:"Edital Publicado",homologado:"Processo Homologado",homologado_desp:"Processo Homologado",finalizado:"Processo Finalizado",abertura_autorizada_desp:"Abertura Autorizada",aviso_publicado:"Aviso Publicado",com_recurso_desp:"Com Recurso Administrativo",excluindo_marcas:"Excluindo Marcas",devolvido_pelo_orgao:"Devolvido pelo Ã“rgÃ£o Administrativo",devolvido_pela_ccl:"Devolvido pela CCL",devolvido_pelo_juridico:"Devolvido pela Assessoria JurÃ­dica"};return o[a?.toLowerCase()]||a||"Status Desconhecido"},processoFoiDevolvido(a){const o=["devolvido_pelo_orgao","devolvido_pela_ccl","devolvido_pelo_juridico"];return o.includes(a?.status?.toLowerCase())},podeReenviarProcesso(a){const o=this.perfilUsuario?.toLowerCase()||"";return"cpm"===o&&this.processoFoiDevolvido(a)},async reenviarProcessoDevolvido(a){try{const o=prompt(`ğŸ”„ REENVIAR PROCESSO APÃ“S CORREÃ‡Ã•ES\n\nProcesso: ${a.numero_processo}\nStatus atual: ${this.obterNomeStatus(a.status)}\n\nInforme observaÃ§Ãµes sobre as correÃ§Ãµes realizadas (opcional):`);if(null===o)return;console.log("ğŸ”„ Reenviando processo devolvido:",a.numero_processo);const t=await c.A.reenviarProcessoDevolvido(a.id,o||"Processo reenviado apÃ³s correÃ§Ãµes");t.sucesso&&(alert(`âœ… PROCESSO REENVIADO COM SUCESSO\n\nProcesso: ${a.numero_processo}\nStatus anterior: ${this.obterNomeStatus(t.statusAnterior)}\nStatus atual: ${this.obterNomeStatus(t.statusNovo)}\nDestinatÃ¡rio: ${t.destinatario}\n\nO processo foi reenviado apÃ³s as correÃ§Ãµes.`),await this.carregarProcessos(),this.fecharVisualizacaoProcesso())}catch(o){console.error("âŒ Erro ao reenviar processo:",o),alert(`âŒ Erro ao reenviar processo: ${o.message}`)}}}},k=q;var U=(0,g.A)(k,e,s,!1,null,"5925625a",null);const j=U.exports},5445:(a,o,t)=>{t.d(o,{A:()=>n});var e=t(452),s=t(563),i=t(3112);class r{static FLUXO_PADRONIZACAO=["em_criacao","criado_cpm","submetido_autoridade","abertura_autorizada","edital_chamamento","analise_juridica","edital_publicado","com_impugnacao","recebendo_amostras","avaliacao_cpm","julgamento_ccl","ata_ccl","publicacao_ata","com_recurso","homologado","expedindo_dcbs","incluindo_marcas","devolvido_pelo_orgao","devolvido_pela_ccl","devolvido_pelo_juridico"];static FLUXO_DESPADRONIZACAO=["em_criacao_desp","criado_cpm_desp","submetido_autoridade_desp","abertura_autorizada_desp","aviso_publicado_desp","com_recurso_desp","homologado_desp","excluindo_marcas"];static RESPONSAVEL_POR_STATUS={em_criacao:s.A.PERFIS.CPM,criado_cpm:s.A.PERFIS.CPM,submetido_autoridade:s.A.PERFIS.ORGAO_ADMINISTRATIVO,abertura_autorizada:s.A.PERFIS.CPM,edital_chamamento:s.A.PERFIS.CPM,analise_juridica:s.A.PERFIS.ASSESSORIA_JURIDICA,edital_publicado:s.A.PERFIS.CPM,com_impugnacao:s.A.PERFIS.ORGAO_ADMINISTRATIVO,recebendo_amostras:s.A.PERFIS.CPM,avaliacao_cpm:s.A.PERFIS.CPM,julgamento_ccl:s.A.PERFIS.CCL,ata_ccl:s.A.PERFIS.CCL,publicacao_ata:s.A.PERFIS.CCL,com_recurso:s.A.PERFIS.ASSESSORIA_JURIDICA,homologado:s.A.PERFIS.ORGAO_ADMINISTRATIVO,expedindo_dcbs:s.A.PERFIS.CPM,incluindo_marcas:s.A.PERFIS.CPM,devolvido_pelo_orgao:s.A.PERFIS.CPM,devolvido_pela_ccl:s.A.PERFIS.CPM,devolvido_pelo_juridico:s.A.PERFIS.CPM,assinado_admin:s.A.PERFIS.ORGAO_ADMINISTRATIVO,aguardando_assinatura_orgao:s.A.PERFIS.ORGAO_ADMINISTRATIVO,em_criacao_desp:s.A.PERFIS.CPM,criado_cpm_desp:s.A.PERFIS.CPM,submetido_autoridade_desp:s.A.PERFIS.ORGAO_ADMINISTRATIVO,abertura_autorizada_desp:s.A.PERFIS.CPM,aviso_publicado_desp:s.A.PERFIS.CPM,com_recurso_desp:s.A.PERFIS.ASSESSORIA_JURIDICA,homologado_desp:s.A.PERFIS.ORGAO_ADMINISTRATIVO,excluindo_marcas:s.A.PERFIS.CPM};static async enviarProcesso(a,o=""){try{console.log("ğŸš€ Enviando processo para prÃ³xima etapa:",a);const{data:t,error:s}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(s)throw s;const r=this.obterProximoStatus(t.status,t.tipo_processo);if(!r)throw new Error(`NÃ£o hÃ¡ prÃ³xima etapa disponÃ­vel para este processo. Status atual: ${t.status}`);const{error:n}=await e.ND.from("processos_administrativos").update({status:r}).eq("id",a);if(n)throw n;return"incluindo_marcas"===r&&(console.log('ğŸ¯ Status "incluindo_marcas" detectado - incluindo produtos no catÃ¡logo automaticamente'),await this.incluirProdutosNoCatalogo(a)),await this.registrarTramitacao(a,t.status,r,"ENVIADO",o),await i.A.enviarNotificacaoTramitacao(a,t.status,r,o),console.log(`âœ… Processo ${a} enviado: ${t.status} â†’ ${r}`),{sucesso:!0,statusAnterior:t.status,statusNovo:r,proximoResponsavel:this.RESPONSAVEL_POR_STATUS[r]}}catch(t){throw console.error("âŒ Erro ao enviar processo:",t),t}}static async enviarProcessoFlexivel(a,o,t,s=""){try{console.log("ğŸ”„ Enviando processo flexÃ­vel:",a,o,t);const{data:r,error:n}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(n)throw n;const{error:c}=await e.ND.from("processos_administrativos").update({status:o}).eq("id",a);if(c)throw c;return"incluindo_marcas"===o&&(console.log('ğŸ¯ Status "incluindo_marcas" detectado no envio flexÃ­vel - incluindo produtos no catÃ¡logo automaticamente'),await this.incluirProdutosNoCatalogo(a)),await this.registrarTramitacao(a,r.status,o,`FLEXÃVEL_${t}`,s),await i.A.enviarNotificacaoTramitacao(a,r.status,o,s),console.log(`âœ… Processo ${a} tramitado flexÃ­vel: ${r.status} â†’ ${o} (${t})`),{sucesso:!0,statusAnterior:r.status,statusNovo:o,tipoFlexivel:t,proximoResponsavel:this.RESPONSAVEL_POR_STATUS[o]}}catch(r){throw console.error("âŒ Erro ao enviar processo flexÃ­vel:",r),r}}static async devolverProcesso(a,o,t=""){try{console.log("â†©ï¸ Devolvendo processo:",a);const{data:r,error:n}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(n)throw n;const c=await s.A.obterPerfilUsuarioAtual();let l,d=o;switch(c.perfil_usuario){case s.A.PERFIS.ORGAO_ADMINISTRATIVO:l="devolvido_pelo_orgao",d=`DEVOLVIDO PELO Ã“RGÃƒO ADMINISTRATIVO: ${o}`;break;case s.A.PERFIS.CCL:l="devolvido_pela_ccl",d=`DEVOLVIDO PELA CCL: ${o}`;break;case s.A.PERFIS.ASSESSORIA_JURIDICA:l="devolvido_pelo_juridico",d=`DEVOLVIDO PELA ASSESSORIA JURÃDICA: ${o}`;break;default:l="padronizacao"===r.tipo_processo?"criado_cpm":"criado_cpm_desp",d=`DEVOLVIDO: ${o}`}const{error:u}=await e.ND.from("processos_administrativos").update({status:l,motivo_devolucao:d,observacoes_devolucao:t,devolvido_por:c.perfil_usuario,data_devolucao:(new Date).toISOString()}).eq("id",a);if(u)throw u;return await this.registrarTramitacao(a,r.status,l,"DEVOLVIDO",`${d}. ${t}`),await i.A.enviarNotificacaoTramitacao(a,r.status,l,`${d}. ${t}`),console.log(`â†©ï¸ Processo ${a} devolvido: ${r.status} â†’ ${l}`),{sucesso:!0,statusAnterior:r.status,statusNovo:l,motivo:d,devolvido_por:c.perfil_usuario}}catch(r){throw console.error("âŒ Erro ao devolver processo:",r),r}}static async reenviarProcessoDevolvido(a,o=""){try{console.log("ğŸ”„ Reenviando processo devolvido:",a);const{data:t,error:s}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(s)throw s;let r,n;switch(t.status){case"devolvido_pelo_orgao":r="submetido_autoridade",n="Ã“rgÃ£o Administrativo";break;case"devolvido_pela_ccl":r="julgamento_ccl",n="CCL";break;case"devolvido_pelo_juridico":r="analise_juridica",n="Assessoria JurÃ­dica";break;default:throw new Error(`Status de devoluÃ§Ã£o nÃ£o reconhecido: ${t.status}`)}const{error:c}=await e.ND.from("processos_administrativos").update({status:r,motivo_devolucao:null,observacoes_devolucao:null,devolvido_por:null,data_devolucao:null}).eq("id",a);if(c)throw c;return await this.registrarTramitacao(a,t.status,r,"REENVIADO",`Processo reenviado apÃ³s correÃ§Ãµes. ${o}`),await i.A.enviarNotificacaoTramitacao(a,t.status,r,`Processo reenviado apÃ³s correÃ§Ãµes para ${n}. ${o}`),console.log(`ğŸ”„ Processo ${a} reenviado: ${t.status} â†’ ${r}`),{sucesso:!0,statusAnterior:t.status,statusNovo:r,destinatario:n}}catch(t){throw console.error("âŒ Erro ao reenviar processo:",t),t}}static async rejeitarProcesso(a,o,t=""){try{console.log("âŒ Rejeitando processo:",a);const{data:r,error:n}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(n)throw n;const c=await s.A.obterPerfilUsuarioAtual();let l;switch(c.perfil_usuario){case s.A.PERFIS.CPM:l="rejeitado_cpm";break;case s.A.PERFIS.ORGAO_ADMINISTRATIVO:l="rejeitado_admin";break;case s.A.PERFIS.CCL:l="rejeitado_ccl";break;case s.A.PERFIS.ASSESSORIA_JURIDICA:l="rejeitado_juridico";break;default:l="rejeitado_final"}const{error:d}=await e.ND.from("processos_administrativos").update({status:l}).eq("id",a);if(d)throw d;return await this.registrarTramitacao(a,r.status,l,"REJEITADO",`${o}. ${t}`),await i.A.enviarNotificacaoTramitacao(a,r.status,l,`${o}. ${t}`),console.log(`âŒ Processo ${a} rejeitado: ${r.status} â†’ ${l}`),{sucesso:!0,statusAnterior:r.status,statusNovo:l,motivo:o}}catch(r){throw console.error("âŒ Erro ao rejeitar processo:",r),r}}static obterProximoStatus(a,o){const t=this.converterStatusAntigo(a),e="padronizacao"===o?this.FLUXO_PADRONIZACAO:this.FLUXO_DESPADRONIZACAO,s=e.indexOf(t);return-1===s||s===e.length-1?null:e[s+1]}static converterStatusAntigo(a){const o={assinado_admin:"abertura_autorizada",aguardando_assinatura_orgao:"submetido_autoridade"};return o[a]||a}static obterOpcoesFlexiveis(a,o){const t=[],e=this.obterProximoStatus(a,o);switch(e&&t.push({status:e,tipo:"NORMAL",descricao:this.obterNomeProximaEtapa(e)}),a){case"edital_publicado":t.push({status:"com_impugnacao",tipo:"IMPUGNACAO",descricao:"Processar ImpugnaÃ§Ã£o ao Edital"}),t.push({status:"recebendo_amostras",tipo:"SEM_IMPUGNACAO",descricao:"Prosseguir para Recebimento de Amostras"});break;case"com_impugnacao":t.push({status:"analise_juridica",tipo:"CORRIGIR_EDITAL",descricao:"Voltar para CorreÃ§Ã£o do Edital"}),t.push({status:"recebendo_amostras",tipo:"IMPUGNACAO_NEGADA",descricao:"ImpugnaÃ§Ã£o Negada - Prosseguir"});break;case"ata_ccl":t.push({status:"publicacao_ata",tipo:"PUBLICAR_DIRETA",descricao:"CCL Publica Ata Diretamente"}),t.push({status:"homologado",tipo:"HOMOLOGACAO_DIRETA",descricao:"Enviar para HomologaÃ§Ã£o do Ã“rgÃ£o"});break;case"publicacao_ata":t.push({status:"com_recurso",tipo:"COM_RECURSO",descricao:"Processar Recurso Administrativo"}),t.push({status:"homologado",tipo:"SEM_RECURSO",descricao:"Homologar (sem recursos)"});break}return t}static async podeUsuarioTramitar(a){try{const o=await s.A.obterPerfilUsuarioAtual(),t=this.RESPONSAVEL_POR_STATUS[a.status];return"submetido_autoridade"===a.status&&console.log('ğŸš¨ DEBUG ESPECÃFICO - Status "submetido_autoridade":',{statusProcesso:a.status,perfilUsuario:o.perfil_usuario,perfilResponsavel:t,perfilEsperado:s.A.PERFIS.ORGAO_ADMINISTRATIVO,podeTrampitar:o.perfil_usuario===t,statusExisteNoMapeamento:!!this.RESPONSAVEL_POR_STATUS[a.status],tipoPerfilUsuario:typeof o.perfil_usuario,tipoPerfilResponsavel:typeof t,constante_ORGAO:s.A.PERFIS.ORGAO_ADMINISTRATIVO,mapeamentoCompleto:this.RESPONSAVEL_POR_STATUS}),console.log(`ğŸ” DEBUG - podeUsuarioTramitar para processo ${a.numero_processo}:`,{statusProcesso:a.status,perfilUsuario:o.perfil_usuario,perfilResponsavel:t,podeTrampitar:o.perfil_usuario===t}),o.perfil_usuario===t}catch(o){return console.error("Erro ao verificar permissÃ£o de tramitaÃ§Ã£o:",o),!1}}static async obterAcoesDisponiveis(a){console.log(`ğŸ” DEBUG - obterAcoesDisponiveis iniciado para processo ${a.numero_processo}`);const o=await this.podeUsuarioTramitar(a);if(!o)return console.log(`ğŸ” DEBUG - UsuÃ¡rio NÃƒO pode tramitar processo ${a.numero_processo} - retornando array vazio`),[];console.log(`ğŸ” DEBUG - UsuÃ¡rio PODE tramitar processo ${a.numero_processo} - continuando...`);const t=[],e=await s.A.obterPerfilUsuarioAtual(),i=this.obterOpcoesFlexiveis(a.status,a.tipo_processo);if(console.log(`ğŸ” DEBUG - OpÃ§Ãµes flexÃ­veis para ${a.status}:`,i),i.length>0)console.log(`ğŸ” DEBUG - Criando ${i.length} aÃ§Ãµes flexÃ­veis`),i.forEach((a=>{let o="ğŸš€ ",e="primary";switch(a.tipo){case"IMPUGNACAO":o="âš ï¸ ",e="warning";break;case"PUBLICAR_DIRETA":o="ğŸ“¢ ",e="success";break;case"COM_RECURSO":o="ğŸ“‹ ",e="info";break;case"CORRIGIR_EDITAL":o="ğŸ”§ ",e="warning";break}t.push({tipo:"ENVIAR_FLEXIVEL",statusDestino:a.status,tipoFlexivel:a.tipo,label:o+a.descricao,descricao:a.descricao,cor:e})}));else{const o=this.obterProximoStatus(a.status,a.tipo_processo);console.log(`ğŸ” DEBUG - PrÃ³ximo status para ${a.status}:`,o),o?(console.log("ğŸ” DEBUG - Criando aÃ§Ã£o ENVIAR normal"),t.push({tipo:"ENVIAR",label:"ğŸš€ Enviar para AnÃ¡lise",descricao:`Enviar para ${this.obterNomeProximaEtapa(o)}`,cor:"success"})):console.log("ğŸ” DEBUG - NÃƒO hÃ¡ prÃ³ximo status - nÃ£o criando aÃ§Ã£o de envio")}return e.perfil_usuario!==s.A.PERFIS.CPM?(console.log("ğŸ” DEBUG - Adicionando aÃ§Ã£o DEVOLVER (perfil nÃ£o Ã© CPM)"),t.push({tipo:"DEVOLVER",label:"â†©ï¸ Devolver para CPM",descricao:"Devolver processo para correÃ§Ãµes",cor:"warning"})):console.log("ğŸ” DEBUG - NÃƒO adicionando aÃ§Ã£o DEVOLVER (perfil Ã© CPM)"),console.log("ğŸ” DEBUG - Adicionando aÃ§Ã£o REJEITAR"),t.push({tipo:"REJEITAR",label:"âŒ Rejeitar Processo",descricao:"Rejeitar processo definitivamente",cor:"danger"}),console.log(`ğŸ” DEBUG - obterAcoesDisponiveis finalizando para processo ${a.numero_processo} com ${t.length} aÃ§Ãµes:`,t),t}static obterNomeProximaEtapa(a){const o={em_criacao:"CPM - CriaÃ§Ã£o",criado_cpm:"Autoridade Competente",submetido_autoridade:"AutorizaÃ§Ã£o de Abertura",abertura_autorizada:"Edital de Chamamento",edital_chamamento:"AnÃ¡lise JurÃ­dica",analise_juridica:"PublicaÃ§Ã£o do Edital",edital_publicado:"Recebimento de ImpugnaÃ§Ãµes",com_impugnacao:"Recebimento de Amostras",recebendo_amostras:"AvaliaÃ§Ã£o CPM",avaliacao_cpm:"Julgamento CCL",julgamento_ccl:"Ata de Julgamento",ata_ccl:"PublicaÃ§Ã£o da Ata",publicacao_ata:"Prazo Recursal",com_recurso:"HomologaÃ§Ã£o",homologado:"ExpediÃ§Ã£o DCBs",expedindo_dcbs:"InclusÃ£o no CatÃ¡logo",em_criacao_desp:"CPM - CriaÃ§Ã£o",criado_cpm_desp:"Autoridade Competente",submetido_autoridade_desp:"AutorizaÃ§Ã£o de Abertura",abertura_autorizada_desp:"PublicaÃ§Ã£o de Aviso",aviso_publicado_desp:"Prazo Recursal",com_recurso_desp:"HomologaÃ§Ã£o",homologado_desp:"ExclusÃ£o de Marcas",devolvido_pelo_orgao:"Reenviar para Ã“rgÃ£o",devolvido_pela_ccl:"Reenviar para CCL",devolvido_pelo_juridico:"Reenviar para JurÃ­dico"};return o[a]||"PrÃ³xima Etapa"}static obterNomeBotaoTramitacao(a,o){const t=this.obterProximoStatus(a,o);if(!t)return"Tramitar Processo";const e=this.obterNomeProximaEtapa(t);return`Tramitar para ${e}`}static async registrarTramitacao(a,o,t,s,i=""){try{const{data:r}=await e.ND.auth.getSession(),n=r?.session?.user,c=await(0,e.EO)(),{error:l}=await e.ND.from("historico_tramitacao").insert([{processo_id:a,tenant_id:c,status_anterior:o,status_novo:t,acao:s,observacoes:i,usuario_id:n?.id,data_tramitacao:(new Date).toISOString()}]);l&&console.warn("Erro ao registrar histÃ³rico (tabela pode nÃ£o existir):",l)}catch(r){console.warn("Erro ao registrar histÃ³rico:",r)}}static async incluirProdutosNoCatalogo(a){try{console.log("ğŸ¯ Iniciando inclusÃ£o de produtos no catÃ¡logo para processo:",a);const t=await(0,e.EO)(),{data:s,error:i}=await e.ND.from("produtos_prequalificacao").select("*").eq("processo_id",a).eq("tenant_id",t);if(i)throw i;if(!s||0===s.length)return void console.log("âš ï¸ Nenhum produto encontrado no processo");const r=s.filter((a=>(a.aprovado_em,!0)));console.log(`ğŸ“¦ Encontrados ${r.length} produtos para inclusÃ£o no catÃ¡logo`);let n=0;for(const a of r){const s=a.produto_id||a.id;if(s)try{if(a.produto_id){const{data:o,error:s}=await e.ND.from("produtos").select("id, nome, tenant_id").eq("id",a.produto_id).eq("tenant_id",t).single();if(s||!o)console.warn(`âš ï¸ Produto ${a.produto_id} nÃ£o encontrado na tabela produtos`);else{const{error:a}=await e.ND.from("produtos").update({status:"homologado"}).eq("id",o.id).eq("tenant_id",t);a?console.error(`âŒ Erro ao homologar produto ${o.id}:`,a):(n++,console.log(`âœ… Produto homologado: ${o.nome}`))}}else{const o=a.nome_produto||"Produto sem nome",s=a.marca||"",i=a.modelo||"",r=a.fabricante||"",{data:c,error:l}=await e.ND.from("produtos").select("id, nome, status").eq("tenant_id",t).eq("nome",o).eq("marca",s).eq("modelo",i).eq("fabricante",r).maybeSingle();if(l&&"PGRST116"!==l.code)console.error("âŒ Erro ao verificar produto existente:",l);else if(c)if(console.log(`âš ï¸ Produto jÃ¡ existe no catÃ¡logo: ${c.nome}`),"homologado"!==c.status){const{error:a}=await e.ND.from("produtos").update({status:"homologado"}).eq("id",c.id);a||(n++,console.log(`âœ… Status do produto atualizado para homologado: ${c.nome}`))}else console.log(`â„¹ï¸ Produto jÃ¡ estÃ¡ homologado: ${c.nome}`);else{const{data:c,error:l}=await e.ND.from("produtos").select("numero_dcb, validade_dcb").eq("tenant_id",t).eq("nome",o).eq("marca",s).eq("modelo",i).eq("fabricante",r).eq("status","aprovado").not("numero_dcb","is",null).maybeSingle(),d={nome:o,marca:s,modelo:i,fabricante:r,cnpj:a.cnpj_fornecedor||a.cnpj||"00.000.000/0000-00",status:"homologado",tenant_id:t};c&&(d.numero_dcb=c.numero_dcb,d.validade_dcb=c.validade_dcb,console.log(`ğŸ“‹ DCB copiado para produto homologado: ${c.numero_dcb}`));const{error:u}=await e.ND.from("produtos").insert([d]);if(u)console.error("âŒ Erro ao criar produto no catÃ¡logo:",u);else{n++;const a=d.numero_dcb?` (com DCB ${d.numero_dcb})`:"";console.log(`âœ… Novo produto criado no catÃ¡logo: ${d.nome}${a}`)}}}}catch(o){console.error("âŒ Erro ao processar produto:",o)}else console.warn(`âš ï¸ ID do produto nÃ£o encontrado na prÃ©-qualificaÃ§Ã£o ${a.id}`),console.log("Dados da prÃ©-qualificaÃ§Ã£o:",a)}console.log("ğŸ‰ InclusÃ£o no catÃ¡logo concluÃ­da:"),console.log(`   ğŸ“¦ Produtos homologados: ${n}`),await this.registrarTramitacao(a,"expedindo_dcbs","incluindo_marcas","INCLUSAO_CATALOGO",`${n} produtos homologados e incluÃ­dos automaticamente no catÃ¡logo`)}catch(o){throw console.error("âŒ Erro ao incluir produtos no catÃ¡logo:",o),new Error(`Falha na inclusÃ£o automÃ¡tica no catÃ¡logo: ${o.message}`)}}static async processarInclusaoManual(a){try{console.log("ğŸ”§ PROCESSAMENTO MANUAL - Incluindo produtos no catÃ¡logo para processo:",a);const{data:o,error:t}=await e.ND.from("processos_administrativos").select("*").eq("id",a).single();if(t)throw t;if("incluindo_marcas"!==o.status)throw new Error(`Processo deve estar em "incluindo_marcas". Status atual: ${o.status}`);console.log(`âœ… Processo ${o.numero_processo} confirmado em status "incluindo_marcas"`),await this.incluirProdutosNoCatalogo(a),console.log("ğŸ‰ Processamento manual concluÃ­do com sucesso!")}catch(o){throw console.error("âŒ Erro no processamento manual:",o),o}}}const n=r},5860:(a,o,t)=>{var e=t(6848),s=function(){var a=this,o=a._self._c;return o("div",{attrs:{id:"app"}},[o("router-view"),o("AIChat")],1)},i=[],r=function(){var a=this,o=a._self._c;return o("div",{staticClass:"ai-chat",class:{"ai-chat--expanded":a.isExpanded}},[a.isExpanded?o("div",{staticClass:"ai-chat__window"},[o("div",{staticClass:"ai-chat__header"},[a._m(1),o("button",{staticClass:"ai-chat__close",on:{click:a.toggleChat}},[o("i",{staticClass:"fas fa-times"})])]),o("div",{ref:"messagesContainer",staticClass:"ai-chat__messages"},[a._l(a.messages,(function(t,e){return o("div",{key:e,class:["ai-chat__message",`ai-chat__message--${t.type}`,{"ai-chat__message--status":t.isStatus}]},["assistant"===t.type?o("div",{staticClass:"ai-chat__message-avatar"},[o("i",{staticClass:"fas fa-robot"}),o("i",{staticClass:"fas fa-bolt ai-chat__bolt-small"})]):a._e(),o("div",{staticClass:"ai-chat__message-content"},[t.isStatus?o("span",{staticClass:"ai-chat__status-text"},[o("i",{staticClass:"fas fa-spinner fa-spin"}),a._v(" "+a._s(t.text)+" ")]):o("span",[a._v(a._s(t.text))])])])})),a.isLoading?o("div",{staticClass:"ai-chat__message ai-chat__message--assistant"},[a._m(2),a._m(3)]):a._e()],2),o("div",{staticClass:"ai-chat__input"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.currentMessage,expression:"currentMessage"}],attrs:{placeholder:"Digite sua dÃºvida sobre licitaÃ§Ãµes...",rows:"2"},domProps:{value:a.currentMessage},on:{keydown:function(o){return!o.type.indexOf("key")&&a._k(o.keyCode,"enter",13,o.key,"Enter")?null:(o.preventDefault(),a.sendMessage.apply(null,arguments))},input:function(o){o.target.composing||(a.currentMessage=o.target.value)}}}),o("button",{staticClass:"ai-chat__send",attrs:{disabled:a.isLoading||!a.currentMessage.trim()},on:{click:a.sendMessage}},[o("i",{staticClass:"fas fa-paper-plane"})])])]):o("button",{staticClass:"ai-chat__button",attrs:{title:"QualiBot 2.0 - Seu Assistente de LicitaÃ§Ãµes"},on:{click:a.toggleChat}},[a._m(0),a.hasInteracted?a._e():o("div",{staticClass:"ai-chat__notification"},[o("i",{staticClass:"fas fa-bolt"}),a._v(" Como posso ajudar? ")])])])},n=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"ai-chat__button-content"},[o("i",{staticClass:"fas fa-robot"}),o("span",{staticClass:"ai-chat__button-label"},[a._v("QualiBot 2.0")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"ai-chat__header-info"},[o("div",{staticClass:"ai-chat__logo"},[o("i",{staticClass:"fas fa-robot"}),o("i",{staticClass:"fas fa-bolt ai-chat__bolt"})]),o("div",[o("h3",[a._v("QualiBot 2.0")]),o("span",{staticClass:"ai-chat__status"},[o("span",{staticClass:"ai-chat__status-dot"}),a._v(" Online e Pronto ")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"ai-chat__message-avatar"},[o("i",{staticClass:"fas fa-robot"}),o("i",{staticClass:"fas fa-bolt ai-chat__bolt-small"})])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"ai-chat__typing"},[o("span"),o("span"),o("span")])}];const c="AIzaSyAf-Oe56q4Rao0OodEOtnEjtI_FpOmDg6I",l=[{name:"gemini-2.0-flash-exp",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent",description:"Gemini 2.0 Flash (Mais Novo e RÃ¡pido - Experimental)"},{name:"gemini-1.5-flash",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent",description:"Gemini 1.5 Flash (RÃ¡pido e Eficiente)"},{name:"gemini-1.5-pro",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent",description:"Gemini 1.5 Pro (Mais AvanÃ§ado)"},{name:"gemini-1.0-pro",url:"https://generativelanguage.googleapis.com/v1beta/models/gemini-1.0-pro:generateContent",description:"Gemini 1.0 Pro (VersÃ£o EstÃ¡vel)"}],d={maxRetries:3,baseDelay:800,maxDelay:12e3,backoffFactor:1.8},u=a=>new Promise((o=>setTimeout(o,a))),m=a=>{const o=d.baseDelay*Math.pow(d.backoffFactor,a);return Math.min(o,d.maxDelay)},p=(a,o)=>{if(a&&a.message&&a.message.includes("Failed to fetch"))return!0;if(o){const a=o.status;return 429===a||503===a||502===a||504===a}return!1},v=a=>{try{return JSON.parse(a)}catch(o){return console.error("Erro ao fazer parse do JSON:",o),console.error("Texto que causou erro:",a),null}},g=async(a,o,t=0)=>{try{const e=`${a.url}?key=${c}`;console.log(`Tentando modelo ${a.name} (tentativa ${t+1}/${d.maxRetries+1})`);const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({contents:[{parts:[{text:`VocÃª Ã© o QualiBot 2.0, um assistente especializado em licitaÃ§Ãµes e compras pÃºblicas, com foco em ajudar os usuÃ¡rios de forma rÃ¡pida e eficiente. Responda a seguinte pergunta de forma clara e objetiva, usando sua expertise em licitaÃ§Ãµes: ${o}`}]}]})});console.log(`Resposta do modelo ${a.name}:`,{status:s.status,statusText:s.statusText,ok:s.ok});const i=await s.text();if(!s.ok){const e=p(null,s);if(e&&t<d.maxRetries){const e=m(t);return console.log(`Erro temporÃ¡rio (${s.status}) no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,o,t+1)}let r=v(i);r||(r={error:{message:`Erro HTTP ${s.status}: ${s.statusText||"Erro desconhecido"}`}}),console.error(`Erro no modelo ${a.name}:`,r);let n=`Modelo ${a.name} falhou`;throw r.error&&r.error.message?n+=`: ${r.error.message}`:n+=`: ${s.status} ${s.statusText||"Erro desconhecido"}`,new Error(n)}const r=v(i);if(!r){if(t<d.maxRetries){const e=m(t);return console.log(`Erro de parse no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,o,t+1)}throw new Error(`Modelo ${a.name} retornou resposta invÃ¡lida`)}if(!r.candidates||!r.candidates[0]?.content?.parts?.[0]?.text){if(console.error(`Formato invÃ¡lido no modelo ${a.name}:`,r),t<d.maxRetries){const e=m(t);return console.log(`Formato invÃ¡lido no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,o,t+1)}throw new Error(`Modelo ${a.name} retornou formato invÃ¡lido`)}return console.log(`âœ… Sucesso com modelo ${a.name}!`),{text:r.candidates[0].content.parts[0].text,modelUsed:a.name}}catch(e){if(console.error(`Erro na tentativa ${t+1} do modelo ${a.name}:`,e),p(e,null)&&t<d.maxRetries){const e=m(t);return console.log(`Erro de rede no modelo ${a.name}. Aguardando ${e}ms...`),await u(e),g(a,o,t+1)}throw e}},_={async chat(a){let o=null,t=[];for(let s=0;s<l.length;s++){const i=l[s];t.push(i.name);try{console.log(`ğŸš€ Tentando modelo ${s+1}/${l.length}: ${i.name}`);const o=await g(i,a);return console.log(`âœ… Resposta obtida com sucesso usando: ${o.modelUsed}`),o.text}catch(e){if(o=e,console.error(`âŒ Modelo ${i.name} falhou:`,e.message),s<l.length-1){console.log(`ğŸ”„ Tentando prÃ³ximo modelo: ${l[s+1].name}`);continue}}}if(console.error("âŒ Todos os modelos falharam. Modelos tentados:",t),console.error("Ãšltimo erro:",o),o&&o.message&&o.message.includes("Failed to fetch"))throw new Error("NÃ£o foi possÃ­vel conectar aos serviÃ§os de IA. Verifique sua conexÃ£o com a internet.");if(o&&o.message&&(o.message.includes("503")||o.message.includes("sobrecarregado")))throw new Error("Todos os serviÃ§os de IA estÃ£o temporariamente sobrecarregados. Tente novamente em alguns minutos.");if(o&&o.message&&o.message.includes("429"))throw new Error("Limite de requisiÃ§Ãµes atingido. Aguarde alguns minutos antes de tentar novamente.");throw new Error("Todos os serviÃ§os de IA estÃ£o temporariamente indisponÃ­veis. Tente novamente mais tarde.")}},h={name:"AIChat",data(){return{isExpanded:!1,hasInteracted:!1,messages:[{type:"assistant",text:"OlÃ¡! Sou o QualiBot 2.0, seu assistente virtual especializado em licitaÃ§Ãµes e compras pÃºblicas. Como posso ajudar hoje?"}],currentMessage:"",isLoading:!1}},methods:{toggleChat(){this.isExpanded=!this.isExpanded,this.hasInteracted=!0,this.isExpanded&&this.$nextTick((()=>{this.scrollToBottom()}))},async sendMessage(){if(!this.currentMessage.trim()||this.isLoading)return;const a=this.currentMessage.trim();this.messages.push({type:"user",text:a}),this.currentMessage="",this.isLoading=!0;const o={type:"assistant",text:"Processando sua solicitaÃ§Ã£o...",isStatus:!0};this.messages.push(o);const t=a=>{const o=this.messages.findIndex((a=>a.isStatus));-1!==o&&(this.messages[o].text=a)},e=console.log;console.log=(...a)=>{const o=a.join(" ");if(o.includes("ğŸš€ Tentando modelo")){const a=o.match(/ğŸš€ Tentando modelo \d+\/\d+: (.+)/);a&&t(`Tentando modelo ${a[1]}...`)}else if(o.includes("Erro temporÃ¡rio"))t("Erro temporÃ¡rio detectado, tentando novamente...");else if(o.includes("ğŸ”„ Tentando prÃ³ximo modelo")){const a=o.match(/ğŸ”„ Tentando prÃ³ximo modelo: (.+)/);if(a){let o=a[1];o.includes("gemini-2.0-flash-exp")?o="Gemini 2.0 Flash (Experimental)":o.includes("gemini-1.5-flash")?o="Gemini 1.5 Flash":o.includes("gemini-1.5-pro")?o="Gemini 1.5 Pro":o.includes("gemini-1.0-pro")&&(o="Gemini 1.0 Pro"),t(`Tentando modelo alternativo: ${o}...`)}}e.apply(console,a)};try{const o=await _.chat(a);console.log=e;const t=this.messages.findIndex((a=>a.isStatus));-1!==t&&this.messages.splice(t,1),this.messages.push({type:"assistant",text:o})}catch(s){console.error("Erro no chat:",s),console.log=e;const a=this.messages.findIndex((a=>a.isStatus));-1!==a&&this.messages.splice(a,1);let o="Desculpe, estou enfrentando algumas dificuldades tÃ©cnicas no momento.";s.message.includes("sobrecarregado")||s.message.includes("overloaded")?o="O serviÃ§o estÃ¡ temporariamente sobrecarregado devido ao alto volume de usuÃ¡rios. JÃ¡ tentei vÃ¡rias vezes automaticamente. Por favor, aguarde alguns minutos e tente novamente.":s.message.includes("conexÃ£o")||s.message.includes("network")?o="Problema de conexÃ£o detectado. Verifique sua internet e tente novamente.":(s.message.includes("indisponÃ­vel")||s.message.includes("unavailable"))&&(o="O serviÃ§o estÃ¡ temporariamente indisponÃ­vel. Nossa equipe jÃ¡ estÃ¡ trabalhando nisso. Tente novamente em alguns minutos."),this.messages.push({type:"assistant",text:o+"\n\nğŸ’¡ **Dica**: Se o problema persistir, vocÃª pode tentar reformular sua pergunta ou contactar o suporte atravÃ©s do menu principal."})}finally{this.isLoading=!1,this.$nextTick((()=>{this.scrollToBottom()}))}},scrollToBottom(){const a=this.$refs.messagesContainer;a.scrollTop=a.scrollHeight}}},f=h;var C=t(1656),b=(0,C.A)(f,r,n,!1,null,"26facc0e",null);const D=b.exports,E={name:"App",components:{AIChat:D}},A=E;var w=(0,C.A)(A,s,i,!1,null,null,null);const x=w.exports;var P=t(6178),S=function(){var a=this,o=a._self._c;return o("div",{staticClass:"home"},[o("Login")],1)},y=[],O=function(){var a=this,o=a._self._c;return o("div",{staticClass:"login-container"},[o("div",{staticClass:"login-card"},[o("h2",[a._v("COMPRAR BEM")]),o("p",[a._v("COMPRAS PÃšBLICAS INTELIGENTES")]),o("div",{staticClass:"tabs"},[o("button",{class:{active:"login"===a.activeTab},on:{click:function(o){a.activeTab="login"}}},[a._v("Login")]),o("button",{class:{active:"register"===a.activeTab},on:{click:function(o){a.activeTab="register"}}},[a._v("Registrar")])]),"login"===a.activeTab?o("div",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"email"}},[a._v("E-mail")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.email,expression:"email"}],attrs:{id:"email",type:"email",placeholder:"Seu e-mail",required:""},domProps:{value:a.email},on:{input:function(o){o.target.composing||(a.email=o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"password"}},[a._v("Senha")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.password,expression:"password"}],attrs:{id:"password",type:"password",placeholder:"Sua senha",required:""},domProps:{value:a.password},on:{input:function(o){o.target.composing||(a.password=o.target.value)}}})]),o("button",{staticClass:"btn-primary",attrs:{disabled:a.loading},on:{click:a.login}},[a._v(" "+a._s(a.loading?"Entrando...":"Entrar")+" ")])]):a._e(),"register"===a.activeTab?o("div",[o("div",{staticClass:"registro-orgao-link-simple"},[o("p",{staticClass:"info-text-center"},[a._v(" Ã‰ um Ã³rgÃ£o pÃºblico novo no sistema? ")]),o("router-link",{staticClass:"btn-registro-orgao",attrs:{to:"/registro-orgao"}},[a._v(" ğŸ“ Cadastrar Ã“rgÃ£o ")]),o("small",{staticClass:"help-text-center"},[a._v(" Cria automaticamente os 4 perfis de acesso necessÃ¡rios ")])],1)]):a._e(),a.errorMsg?o("p",{staticClass:"error-message"},[a._v(a._s(a.errorMsg))]):a._e(),o("div",{staticClass:"public-access-section"},[o("div",{staticClass:"public-options"},[o("div",{staticClass:"options-row"},[o("div",{staticClass:"public-option",on:{click:function(o){return a.acessarRDMOnline()}}},[o("div",{staticClass:"option-icon"},[a._v("ğŸ¥")]),a._m(0)]),o("div",{staticClass:"public-option",on:{click:function(o){return a.acessarCatalogo()}}},[o("div",{staticClass:"option-icon"},[a._v("ğŸ“¦")]),a._m(1)])]),o("div",{staticClass:"options-row centered"},[o("div",{staticClass:"public-option wide",on:{click:function(o){return a.acessarReclameAqui()}}},[o("div",{staticClass:"option-icon"},[a._v("ğŸ“¢")]),a._m(2)])])])])])])},$=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"option-content"},[o("h4",[a._v("Sistema RDM On-line")]),o("p",[a._v("ğŸ“ Dashboard RDM")]),o("small",[a._v("UsuÃ¡rios cadastrados para emitir RDMs")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"option-content"},[o("h4",[a._v("CatÃ¡logo de Produtos")]),o("p",[a._v("ğŸ“‹ Consulta de produtos")]),o("small",[a._v("Consultar marcas e modelos padronizados")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"option-content"},[o("h4",[a._v("Sistema de ReclamaÃ§Ãµes")]),o("p",[a._v("ğŸ—£ï¸ Registrar reclamaÃ§Ãµes sobre produtos")]),o("small",[a._v("Sistema para reclamaÃ§Ãµes sobre marcas e modelos de produtos")])])}],N=t(452);const R={name:"Login",data(){return{activeTab:"login",email:"",password:"",loading:!1,errorMsg:""}},methods:{async login(){try{this.loading=!0,this.errorMsg="";const{error:o}=await N.ND.auth.signInWithPassword({email:this.email,password:this.password});if(o)throw o;try{await new Promise((a=>setTimeout(a,500)));const{data:{user:a}}=await N.ND.auth.getUser();if(a){const{data:o}=await N.ND.from("usuarios").select("perfil_usuario").eq("id",a.id).single();switch(o?.perfil_usuario){case"ccl":this.$router.push("/ccl");break;case"cpm":this.$router.push("/dashboard");break;case"orgao_administrativo":case"assessoria_juridica":this.$router.push("/processos-administrativos");break;default:this.$router.push("/dashboard")}}else this.$router.push("/dashboard")}catch(a){console.warn("Erro ao obter perfil para redirecionamento:",a),this.$router.push("/dashboard")}}catch(o){this.errorMsg=o.message||"Erro ao fazer login"}finally{this.loading=!1}},acessarRDMOnline(){this.$router.push("/rdm")},acessarCatalogo(){this.$router.push("/catalogo-publico?modo=consulta")},acessarReclameAqui(){this.$router.push("/catalogo-publico?modo=reclamacao")}}},I=R;var T=(0,C.A)(I,O,$,!1,null,"5c78a248",null);const F=T.exports,M={name:"Home",components:{Login:F}},z=M;var L=(0,C.A)(z,S,y,!1,null,null,null);const B=L.exports;var q=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dashboard-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")]),a.processosPendentes>0?o("span",{staticClass:"notification-badge"},[a._v(" "+a._s(a.processosPendentes)+" ")]):a._e()])],1),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("â–¼")])]),a.showDropdown?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.usuarioNome))]),o("small",[a._v(a._s(a.usuarioEmail))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("button",{staticClass:"dropdown-item",on:{click:a.testarEmailJS}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ§ª")]),o("span",[a._v("Testar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("DashboardCPM")],1)])},k=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])}],U=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dashboard"},[o("h2",[a._v("Painel CPM")]),o("div",{staticClass:"tabs"},[o("div",{staticClass:"tab",class:{active:"dashboard"===a.activeTab},on:{click:function(o){a.activeTab="dashboard"}}},[a._v(" Dashboard ")]),o("div",{staticClass:"tab",class:{active:"editais"===a.activeTab},on:{click:function(o){a.activeTab="editais"}}},[a._v(" Editais de PrÃ©-QualificaÃ§Ã£o ")]),o("div",{staticClass:"tab",class:{active:"pesquisa"===a.activeTab},on:{click:function(o){a.activeTab="pesquisa"}}},[a._v(" Pesquisa de Mercado ")]),o("div",{staticClass:"tab",class:{active:"despadronizadas"===a.activeTab},on:{click:function(o){a.activeTab="despadronizadas"}}},[a._v(" Marcas Despadronizadas ")]),o("div",{staticClass:"tab",class:{active:"certificados"===a.activeTab},on:{click:function(o){a.activeTab="certificados"}}},[a._v(" EmissÃ£o de Certificados (DCB) ")]),o("div",{staticClass:"tab",class:{active:"usuarios"===a.activeTab},on:{click:function(o){a.activeTab="usuarios"}}},[a._v(" Cadastro de UsuÃ¡rios ")]),o("div",{staticClass:"tab",class:{active:"reclamacoes"===a.activeTab},on:{click:function(o){a.activeTab="reclamacoes"}}},[a._v(" Registros de ReclamaÃ§Ãµes "),a.reclamacoesNaoRespondidas>0?o("span",{staticClass:"notification-badge"},[a._v(" "+a._s(a.reclamacoesNaoRespondidas)+" ")]):a._e()])]),"dashboard"===a.activeTab?o("div",[o("div",{staticClass:"stats-container"},[o("div",{staticClass:"stat-card status-pendente-card"},[o("h3",[a._v("Produtos em AvaliaÃ§Ã£o")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))])]),o("div",{staticClass:"stat-card status-aprovado-card"},[o("h3",[a._v("Produtos Aprovados")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))])]),o("div",{staticClass:"stat-card status-reprovado-card"},[o("h3",[a._v("Produtos Reprovados")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.reprovados))])])]),o("div",{staticClass:"recent-products"},[o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“‹ Requerimentos Recentes")]),o("div",{staticClass:"pagination-controls"},[o("label",[a._v("Itens por pÃ¡gina:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPagina,expression:"itensPorPagina"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.itensPorPagina=o.target.multiple?t:t[0]},a.aplicarPaginacao]}},[o("option",{attrs:{value:"5"}},[a._v("5")]),o("option",{attrs:{value:"10"}},[a._v("10")]),o("option",{attrs:{value:"20"}},[a._v("20")]),o("option",{attrs:{value:"50"}},[a._v("50")])])])]),o("div",{staticClass:"filtros-inline"},[o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ”¤ Nome:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.nome,expression:"filtros.nome"}],attrs:{type:"text",placeholder:"Filtrar por nome..."},domProps:{value:a.filtros.nome},on:{input:[function(o){o.target.composing||a.$set(a.filtros,"nome",o.target.value)},a.aplicarFiltros]}})]),o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ·ï¸ Marca:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.marca,expression:"filtros.marca"}],attrs:{type:"text",placeholder:"Filtrar por marca..."},domProps:{value:a.filtros.marca},on:{input:[function(o){o.target.composing||a.$set(a.filtros,"marca",o.target.value)},a.aplicarFiltros]}})]),o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ“Š Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"pendente"}},[a._v("Em AvaliaÃ§Ã£o")]),o("option",{attrs:{value:"aprovado"}},[a._v("Aprovado")]),o("option",{attrs:{value:"reprovado"}},[a._v("Reprovado")]),o("option",{attrs:{value:"em_analise"}},[a._v("Em AnÃ¡lise")])])]),o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ“… Data:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.data,expression:"filtros.data"}],attrs:{type:"date"},domProps:{value:a.filtros.data},on:{change:a.aplicarFiltros,input:function(o){o.target.composing||a.$set(a.filtros,"data",o.target.value)}}})]),o("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar ")])]),a.produtosPaginados.length>0?o("table",[a._m(0),o("tbody",a._l(a.produtosPaginados,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.nome))]),o("td",[a._v(a._s(t.marca))]),o("td",[a._v(a._s(a.formatarEdital(t)))]),o("td",["aprovado"===t.status||"julgado_aprovado"===t.status||"homologado"===t.status?o("span",{staticStyle:{"background-color":"#2ecc71",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")]):"reprovado"===t.status||"julgado_reprovado"===t.status?o("span",{staticStyle:{"background-color":"#e74c3c",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")]):"pendente"===t.status?o("span",{staticStyle:{"background-color":"#f39c12",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")]):"em_analise"===t.status?o("span",{staticStyle:{"background-color":"#3498db",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")]):"diligencia"===t.status?o("span",{staticStyle:{"background-color":"#9b59b6",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")]):o("span",{staticStyle:{"background-color":"#6c757d",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")])]),o("td",[a._v(a._s(a.formatDate(t.criado_em)))]),o("td",[o("button",{staticClass:"btn-small",on:{click:function(o){return a.verProduto(t.id)}}},[a._v("Visualizar")])])])})),0)]):a._e(),a.totalPaginas>1?o("div",{staticClass:"paginacao"},[o("div",{staticClass:"paginacao-info"},[a._v(" PÃ¡gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),o("div",{staticClass:"paginacao-botoes"},[o("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtual},on:{click:function(o){return a.irParaPagina(a.paginaAtual-1)}}},[a._v(" â—€ï¸ Anterior ")]),o("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveis,(function(t){return o("button",{key:t,class:["btn-numero",{active:t===a.paginaAtual}],on:{click:function(o){return a.irParaPagina(t)}}},[a._v(" "+a._s(t)+" ")])})),0),o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual===a.totalPaginas},on:{click:function(o){return a.irParaPagina(a.paginaAtual+1)}}},[a._v(" â–¶ï¸ PrÃ³xima ")])])]):0===a.produtos.length?o("p",[a._v("Nenhum requerimento cadastrado.")]):a.temFiltrosAplicados?o("p",[a._v("Nenhum produto encontrado com os filtros aplicados.")]):a._e()]),o("div",{staticClass:"diligencia-section"},[o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ” Requerimentos com DiligÃªncias")]),o("div",{staticClass:"pagination-controls"},[o("label",[a._v("Itens por pÃ¡gina:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPaginaDiligencia,expression:"itensPorPaginaDiligencia"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.itensPorPaginaDiligencia=o.target.multiple?t:t[0]},a.aplicarPaginacaoDiligencia]}},[o("option",{attrs:{value:"5"}},[a._v("5")]),o("option",{attrs:{value:"10"}},[a._v("10")]),o("option",{attrs:{value:"20"}},[a._v("20")])])])]),o("div",{staticClass:"filtros-inline"},[o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.busca,expression:"filtrosDiligencia.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDiligencia.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtrosDiligencia,"busca",o.target.value)},a.aplicarFiltrosDiligencia]}})]),o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ·ï¸ Marca:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.marca,expression:"filtrosDiligencia.marca"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtrosDiligencia,"marca",o.target.multiple?t:t[0])},a.aplicarFiltrosDiligencia]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),a._l(a.marcasUnicas,(function(t){return o("option",{key:t,domProps:{value:t}},[a._v(" "+a._s(t)+" ")])}))],2)]),o("div",{staticClass:"filtro-inline"},[o("label",[a._v("ğŸ“… Data:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.data,expression:"filtrosDiligencia.data"}],attrs:{type:"date"},domProps:{value:a.filtrosDiligencia.data},on:{change:a.aplicarFiltrosDiligencia,input:function(o){o.target.composing||a.$set(a.filtrosDiligencia,"data",o.target.value)}}})]),o("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltrosDiligencia}},[a._v(" ğŸ—‘ï¸ Limpar ")])]),a.diligenciasPaginadas.length>0?o("table",[a._m(1),o("tbody",a._l(a.diligenciasPaginadas,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.nome))]),o("td",[a._v(a._s(t.marca))]),o("td",[a._v(a._s(a.formatarEdital(t)))]),a._m(2,!0),o("td",[a._v(a._s(a.formatDate(t.criado_em)))]),o("td",[o("button",{staticClass:"btn-small",on:{click:function(o){return a.verProduto(t.id)}}},[a._v("Visualizar")]),o("button",{staticClass:"btn-small btn-diligencia",on:{click:function(o){return a.visualizarDiligencias(t.id)}}},[a._v("Ver DiligÃªncias")])])])})),0)]):a._e(),a.totalPaginasDiligencia>1?o("div",{staticClass:"paginacao"},[o("div",{staticClass:"paginacao-info"},[a._v(" PÃ¡gina "+a._s(a.paginaAtualDiligencia)+" de "+a._s(a.totalPaginasDiligencia)+" ")]),o("div",{staticClass:"paginacao-botoes"},[o("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtualDiligencia},on:{click:function(o){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia-1)}}},[a._v(" â—€ï¸ Anterior ")]),o("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveisDiligencia,(function(t){return o("button",{key:t,class:["btn-numero",{active:t===a.paginaAtualDiligencia}],on:{click:function(o){return a.irParaPaginaDiligencia(t)}}},[a._v(" "+a._s(t)+" ")])})),0),o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtualDiligencia===a.totalPaginasDiligencia},on:{click:function(o){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia+1)}}},[a._v(" â–¶ï¸ PrÃ³xima ")])])]):0===a.produtosComDiligencia.length?o("p",[a._v("Nenhum requerimento com diligÃªncia encontrado.")]):a.temFiltrosDiligenciaAplicados?o("p",[a._v("Nenhuma diligÃªncia encontrada com os filtros aplicados.")]):a._e()])]):a._e(),"pesquisa"===a.activeTab?o("div",{staticClass:"pesquisa-mercado"},[o("div",{staticClass:"pesquisa-mercado-container"},[o("div",{staticClass:"sub-tabs"},[o("div",{staticClass:"sub-tab",class:{active:"pesquisa-tecnica"===a.activeSubTab},on:{click:function(o){a.activeSubTab="pesquisa-tecnica"}}},[a._v(" ğŸ¤– PesquisaBot ")]),o("div",{staticClass:"sub-tab",class:{active:"cotacoes"===a.activeSubTab},on:{click:function(o){a.activeSubTab="cotacoes"}}},[a._v(" ğŸ’° CotaÃ§Ãµes ")]),o("div",{staticClass:"sub-tab",class:{active:"comparativo"===a.activeSubTab},on:{click:function(o){a.activeSubTab="comparativo"}}},[a._v(" ğŸ“Š Comparativo ")]),o("div",{staticClass:"sub-tab",class:{active:"analise-precos"===a.activeSubTab},on:{click:function(o){a.activeSubTab="analise-precos"}}},[a._v(" ğŸ“ˆ AnÃ¡lise de PreÃ§os ")]),o("div",{staticClass:"sub-tab",class:{active:"relatorios"===a.activeSubTab},on:{click:function(o){a.activeSubTab="relatorios"}}},[a._v(" ğŸ“‹ RelatÃ³rios ")]),o("div",{staticClass:"sub-tab",class:{active:"bancos-precos"===a.activeSubTab},on:{click:function(o){a.activeSubTab="bancos-precos"}}},[a._v(" ğŸ¦ Bancos de PreÃ§os ")])]),"pesquisa-tecnica"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("div",{staticClass:"pesquisa-bot-section"},[a._m(3),o("PesquisaBot")],1)]):a._e(),"cotacoes"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("GerenciadorCotacoes")],1):a._e(),"comparativo"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("GerenciadorComparativo")],1):a._e(),"analise-precos"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("GerenciadorAnalisePrecos")],1):a._e(),"relatorios"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("GerenciadorRelatorios")],1):a._e(),"bancos-precos"===a.activeSubTab?o("div",{staticClass:"sub-content"},[o("div",{staticClass:"bancos-precos-section"},[a._m(4),o("div",{staticClass:"bancos-grid"},[a._m(5),o("div",{staticClass:"banco-card"},[o("div",{staticClass:"banco-icon"},[a._v("ğŸ¥")]),o("h5",[a._v("Banco de PreÃ§os em SaÃºde")]),o("p",[a._v("PreÃ§os de medicamentos e materiais mÃ©dicos")]),o("button",{staticClass:"btn-primary",on:{click:function(o){return a.$swal({title:"ğŸ¥ Banco de SaÃºde",text:"Funcionalidade em desenvolvimento - PreÃ§os de medicamentos e materiais",icon:"info"})}}},[a._v("Consultar")])]),a._m(6)])])]):a._e()])]):a._e(),"editais"===a.activeTab?o("div",{staticClass:"editais"},[o("div",{staticClass:"editais-container"},[o("div",{staticClass:"editais-stats"},[o("div",{staticClass:"stat-card editais-ativos"},[o("h4",[a._v("ğŸ“‹ Publicados")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisAtivos.length))]),o("small",[a._v("Recebendo documentaÃ§Ã£o")])]),o("div",{staticClass:"stat-card editais-rascunho"},[o("h4",[a._v("âœï¸ Em ElaboraÃ§Ã£o")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisRascunho.length))]),o("small",[a._v("Aguardando publicaÃ§Ã£o")])]),o("div",{staticClass:"stat-card editais-finalizados"},[o("h4",[a._v("âœ… Finalizados")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisFinalizados.length))]),o("small",[a._v("Processos concluÃ­dos")])])]),o("div",{staticClass:"editais-actions"},[o("div",{staticClass:"actions-left"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" â• Novo Edital ")]),o("button",{staticClass:"btn-secondary",attrs:{disabled:a.loadingEditais},on:{click:a.carregarEditais}},[a._v(" ğŸ”„ Atualizar ")])]),o("div",{staticClass:"actions-right"},[o("div",{staticClass:"filtro-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.busca,expression:"filtroEditais.busca"}],attrs:{type:"text",placeholder:"ğŸ” Buscar edital..."},domProps:{value:a.filtroEditais.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtroEditais,"busca",o.target.value)},a.debouncedFiltrarEditais],keyup:function(o){return!o.type.indexOf("key")&&a._k(o.keyCode,"enter",13,o.key,"Enter")?null:a.aplicarFiltrosEditais.apply(null,arguments)}}}),a.filtroEditais.busca||a.filtroEditais.status?o("button",{staticClass:"btn-clear-filter",attrs:{title:"Limpar filtros"},on:{click:a.limparFiltrosEditais}},[a._v(" âœ• ")]):a._e()]),o("div",{staticClass:"filtro-group"},[o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.status,expression:"filtroEditais.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtroEditais,"status",o.target.multiple?t:t[0])},a.aplicarFiltrosEditais]}},[o("option",{attrs:{value:""}},[a._v("Todos os Status")]),o("option",{attrs:{value:"RASCUNHO"}},[a._v("ğŸ“ Em ElaboraÃ§Ã£o")]),o("option",{attrs:{value:"PUBLICADO"}},[a._v("ğŸ“‹ Publicado")]),o("option",{attrs:{value:"CANCELADO"}},[a._v("âŒ Cancelado")])])])])]),a.loadingEditais?o("div",{staticClass:"loading-state"},[o("div",{staticClass:"loading-spinner"}),o("p",[a._v("Carregando editais...")])]):a.editaisFiltrados.length>0?o("div",{staticClass:"editais-grid"},a._l(a.editaisFiltrados,(function(t){return o("div",{key:t.id,staticClass:"edital-card",class:{"status-ativo":"PUBLICADO"===t.status,"status-rascunho":"RASCUNHO"===t.status,"status-cancelado":"CANCELADO"===t.status}},[o("div",{staticClass:"edital-header"},[o("div",{staticClass:"edital-numero"},[a._v(a._s(t.numero))]),o("div",{staticClass:"edital-status"},["PUBLICADO"===t.status?o("span",{staticClass:"badge status-publicado"},[a._v("ğŸ“‹ Publicado")]):"RASCUNHO"===t.status?o("span",{staticClass:"badge status-rascunho"},[a._v("âœï¸ Em ElaboraÃ§Ã£o")]):"CANCELADO"===t.status?o("span",{staticClass:"badge status-cancelado"},[a._v("âŒ Cancelado")]):a._e()])]),o("div",{staticClass:"edital-content"},[o("h4",[a._v(a._s(t.descricao))]),o("div",{staticClass:"edital-info"},["PUBLICADO"===t.status?[o("p",[o("strong",[a._v("ğŸ“… PublicaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(t.data_publicacao)))]),t.data_limite_impugnacao?o("p",[o("strong",[a._v("â° Prazo ImpugnaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(t.data_limite_impugnacao))+" ")]):a._e()]:a._e()],2)]),o("div",{staticClass:"edital-actions"},[o("button",{staticClass:"btn-secondary btn-small",on:{click:function(o){return a.visualizarEdital(t)}}},[a._v(" ğŸ‘ï¸ Visualizar ")]),"RASCUNHO"===t.status?o("button",{staticClass:"btn-primary btn-small",on:{click:function(o){return a.editarEdital(t)}}},[a._v(" âœï¸ Editar ")]):a._e(),o("div",{staticClass:"dropdown"},[o("button",{staticClass:"btn-secondary btn-small dropdown-toggle"},[a._v("â‹®")]),o("div",{staticClass:"dropdown-menu"},[t.url_documento?o("a",{on:{click:function(o){return a.baixarDocumento(t)}}},[a._v("ğŸ“¥ Baixar PDF")]):a._e(),o("a",{on:{click:function(o){return a.duplicarEdital(t)}}},[a._v("ğŸ“‹ Duplicar")]),"RASCUNHO"===t.status?o("a",{staticClass:"text-danger",on:{click:function(o){return a.cancelarEdital(t)}}},[a._v("âŒ Cancelar")]):a._e()])])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“‹")]),o("h3",[a._v("Nenhum edital encontrado")]),a.filtroEditais.busca||a.filtroEditais.status?o("p",[a._v(" Nenhum edital corresponde aos filtros aplicados. ")]):o("p",[a._v(' Ainda nÃ£o hÃ¡ editais cadastrados. Clique em "Novo Edital" para comeÃ§ar. ')]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" â• Criar Primeiro Edital ")])])]),a.modalNovoEdital?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoEdital}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“‹ Selecionar Minuta-PadrÃ£o")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoEdital}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"minuta-selecao"},[a._m(7),o("div",{staticClass:"minutas-actions"},[o("button",{staticClass:"btn-secondary",on:{click:a.abrirModalAddMinuta}},[a._v(" â• Adicionar Nova Minuta-PadrÃ£o ")])]),o("div",{staticClass:"minutas-grid"},a._l(a.minutasDisponiveis,(function(t){return o("div",{key:t.id,staticClass:"minuta-card",class:{selected:a.minutaSelecionada===t.id},on:{click:function(o){return a.selecionarMinuta(t)}}},[o("div",{staticClass:"minuta-header"},[o("div",{staticClass:"minuta-icon"},[t.eh_padrao_sistema?o("span",[a._v("ğŸ›ï¸")]):o("span",[a._v("ğŸ“„")])]),o("div",{staticClass:"minuta-info"},[o("h5",[a._v(a._s(t.nome))]),o("p",{staticClass:"minuta-categoria"},[a._v(a._s(t.categoria||"Geral"))])])]),o("div",{staticClass:"minuta-description"},[o("p",[a._v(a._s(t.descricao||"Sem descriÃ§Ã£o"))])]),o("div",{staticClass:"minuta-meta"},[o("small",[t.eh_padrao_sistema?o("span",{staticClass:"badge badge-system"},[a._v("Sistema")]):o("span",{staticClass:"badge badge-custom"},[a._v("Personalizada")])])])])})),0),0===a.minutasDisponiveis.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“‹")]),o("h3",[a._v("Nenhuma minuta-padrÃ£o disponÃ­vel")]),o("p",[a._v("Adicione uma minuta-padrÃ£o para comeÃ§ar a criar editais.")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalAddMinuta}},[a._v(" â• Adicionar Primeira Minuta ")])]):a._e()]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoEdital}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{disabled:!a.minutaSelecionada||a.criandoEdital},on:{click:a.processarCriacaoEdital}},[a._v(" "+a._s(a.criandoEdital?"Criando...":"Criar Edital com Minuta Selecionada")+" ")])])])])]):a._e(),a.modalAddMinuta?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalAddMinuta}},[o("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("â• Adicionar Nova Minuta-PadrÃ£o")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalAddMinuta}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarNovaMinuta.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"minuta-nome"}},[a._v("Nome da Minuta*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.nome,expression:"novaMinuta.nome"}],attrs:{id:"minuta-nome",type:"text",placeholder:"Ex: Minuta para Material de EscritÃ³rio",required:""},domProps:{value:a.novaMinuta.nome},on:{input:function(o){o.target.composing||a.$set(a.novaMinuta,"nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"minuta-categoria"}},[a._v("Categoria")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.categoria,expression:"novaMinuta.categoria"}],attrs:{id:"minuta-categoria"},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.novaMinuta,"categoria",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"geral"}},[a._v("Geral")]),o("option",{attrs:{value:"medicamentos"}},[a._v("Medicamentos")]),o("option",{attrs:{value:"material_escritorio"}},[a._v("Material de EscritÃ³rio")]),o("option",{attrs:{value:"material_odontologico"}},[a._v("Material OdontolÃ³gico")]),o("option",{attrs:{value:"material_medico_hospitalar"}},[a._v("Material MÃ©dico-Hospitalar")]),o("option",{attrs:{value:"equipamentos"}},[a._v("Equipamentos")]),o("option",{attrs:{value:"outros_materiais"}},[a._v("Outros Materiais")])])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"minuta-descricao"}},[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaMinuta.descricao,expression:"novaMinuta.descricao"}],attrs:{id:"minuta-descricao",rows:"3",placeholder:"DescriÃ§Ã£o opcional da minuta..."},domProps:{value:a.novaMinuta.descricao},on:{input:function(o){o.target.composing||a.$set(a.novaMinuta,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"minuta-arquivo"}},[a._v("Arquivo da Minuta (Word)*")]),o("input",{attrs:{id:"minuta-arquivo",type:"file",accept:".docx,.doc",required:""},on:{change:a.handleMinutaUpload}}),o("small",[a._v("Arquivo Word (.docx ou .doc) com a minuta-padrÃ£o (mÃ¡ximo 10MB)")])]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalAddMinuta}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvandoMinuta}},[a._v(" "+a._s(a.salvandoMinuta?"Salvando...":"Salvar Minuta")+" ")])])])])])]):a._e(),a.modalVisualizarEdital?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVisualizarEdital}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ‘ï¸ "+a._s(a.editalSelecionado.numero)+" - "+a._s(a.editalSelecionado.descricao))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalVisualizarEdital}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"edital-detalhes"},[o("div",{staticClass:"info-section"},[o("h4",[a._v("ğŸ“‹ InformaÃ§Ãµes Gerais")]),o("div",{staticClass:"info-grid"},[o("div",[o("strong",[a._v("NÃºmero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),o("div",[o("strong",[a._v("Status:")]),o("span",{class:"badge status-"+a.editalSelecionado.status.toLowerCase()},[a._v(" "+a._s(a.editalSelecionado.status)+" ")])]),"PUBLICADO"===a.editalSelecionado.status?[o("div",[o("strong",[a._v("Data PublicaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_publicacao)))]),a.editalSelecionado.data_limite_impugnacao?o("div",[o("strong",[a._v("Prazo ImpugnaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_limite_impugnacao))+" ")]):a._e()]:a._e()],2)]),"RASCUNHO"===a.editalSelecionado.status?o("div",{staticClass:"info-section"},[o("h4",[a._v("ğŸ“„ Minuta-PadrÃ£o")]),o("div",{staticClass:"minuta-workflow"},[o("div",{staticClass:"workflow-step",class:{active:!0}},[o("div",{staticClass:"step-number"},[a._v("1")]),o("div",{staticClass:"step-content"},[o("h5",[a._v("Baixar Minuta")]),o("p",[a._v("Baixe a minuta-padrÃ£o selecionada")]),o("button",{staticClass:"btn-primary btn-small",on:{click:function(o){return a.baixarMinutaPadrao(a.editalSelecionado)}}},[a._v(" ğŸ“¥ Baixar Minuta-PadrÃ£o ")])])]),o("div",{staticClass:"workflow-step",class:{active:a.editalSelecionado.minuta_preenchida_url}},[o("div",{staticClass:"step-number"},[a._v("2")]),o("div",{staticClass:"step-content"},[o("h5",[a._v("Enviar Minuta Preenchida")]),o("p",[a._v("ApÃ³s preencher, envie a minuta")]),a.editalSelecionado.minuta_preenchida_url?o("div",[o("p",{staticClass:"success-text"},[a._v("âœ… Minuta preenchida enviada")]),o("button",{staticClass:"btn-secondary btn-small",on:{click:function(o){return a.visualizarMinutaPreenchida(a.editalSelecionado)}}},[a._v(" ğŸ‘ï¸ Visualizar ")])]):o("div",[o("input",{ref:"minutaPreenchidaInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".docx,.doc"},on:{change:a.handleMinutaPreenchidaUpload}}),o("button",{staticClass:"btn-primary btn-small",on:{click:function(o){return a.$refs.minutaPreenchidaInput.click()}}},[a._v(" ğŸ“¤ Enviar Minuta Preenchida ")])])])]),o("div",{staticClass:"workflow-step",class:{active:a.editalSelecionado.pdf_convertido_url}},[o("div",{staticClass:"step-number"},[a._v("3")]),o("div",{staticClass:"step-content"},[o("h5",[a._v("Converter para PDF")]),o("p",[a._v("Finalizar e publicar edital")]),a.editalSelecionado.minuta_preenchida_url&&!a.editalSelecionado.pdf_convertido_url?o("div",[o("button",{staticClass:"btn-primary btn-small",on:{click:function(o){return a.processarConversaoPDF(a.editalSelecionado)}}},[a._v(" ğŸ“‹ Converter para PDF e Publicar ")])]):a.editalSelecionado.pdf_convertido_url?o("div",[o("p",{staticClass:"success-text"},[a._v("âœ… PDF gerado e publicado")])]):a._e()])])])]):a._e(),a.editalSelecionado.conteudo?o("div",{staticClass:"info-section"},[o("h4",[a._v("ğŸ“„ ConteÃºdo")]),o("div",{staticClass:"conteudo-texto"},[a._v(a._s(a.editalSelecionado.conteudo))])]):a._e(),o("div",{staticClass:"info-section"},[o("h4",[a._v("ğŸ“Š EstatÃ­sticas")]),o("div",{staticClass:"stats-grid"},[o("div",{staticClass:"mini-stat"}),o("div",{staticClass:"mini-stat"},[o("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.produtos_submetidos||0))]),o("span",{staticClass:"mini-stat-label"},[a._v("Produtos Submetidos")])]),o("div",{staticClass:"mini-stat"},[o("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.impugnacoes_count||0))]),o("span",{staticClass:"mini-stat-label"},[a._v("ImpugnaÃ§Ãµes")])])])])]),o("div",{staticClass:"modal-actions"},[a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url?o("button",{staticClass:"btn-primary",on:{click:function(o){return a.abrirDocumento(a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url)}}},[a._v(" ğŸ“„ Abrir PDF ")]):a._e(),a.editalSelecionado.url_documento||a.editalSelecionado.pdf_convertido_url?o("button",{staticClass:"btn-secondary",on:{click:function(o){return a.baixarDocumento(a.editalSelecionado)}}},[a._v(" ğŸ“¥ Baixar PDF ")]):a._e(),o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalVisualizarEdital}},[a._v(" Fechar ")])])])])]):a._e(),o("div",{staticClass:"impugnacoes-section"},[o("div",{staticClass:"section-header"},[o("h3",[a._v("ImpugnaÃ§Ãµes ao Edital")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaImpugnacao}},[a._v(" â• Nova ImpugnaÃ§Ã£o ")])]),a.impugnacoes.length>0?o("table",[a._m(8),o("tbody",a._l(a.impugnacoes,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.impugnante))]),o("td",[a._v(a._s(t.produto_nome))]),o("td",[a._v(a._s(a.formatDate(t.data_impugnacao)))]),o("td",[a._v(a._s(a.formatDate(t.prazo_final)))]),o("td",["DEFERIDA"===t.status?o("span",{staticClass:"status-badge status-aprovado"},[a._v(" DEFERIDA ")]):"INDEFERIDA"===t.status?o("span",{staticClass:"status-badge status-reprovado"},[a._v(" INDEFERIDA ")]):o("span",{staticClass:"status-badge status-pendente"},[a._v(" "+a._s(t.status)+" ")])]),o("td",["EM_ANALISE"!==t.status&&t.data_decisao?a._e():o("button",{staticClass:"btn-small",on:{click:function(o){return a.analisarImpugnacao(t.id)}}},[a._v(" Visualizar ")]),"EM_ANALISE"!==t.status&&t.data_decisao?o("button",{staticClass:"btn-small btn-info",on:{click:function(o){return a.verDecisaoImpugnacao(t.id)}}},[a._v(" Ver DecisÃ£o ")]):a._e()])])})),0)]):o("p",[a._v("NÃ£o hÃ¡ impugnaÃ§Ãµes apresentadas.")])]),a.modalNovaImpugnacao?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovaImpugnacao}},[o("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("â• Nova ImpugnaÃ§Ã£o ao Edital")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalNovaImpugnacao}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarNovaImpugnacao.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"editalImpugnacao"}},[a._v("Edital *")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.edital_id,expression:"novaImpugnacao.edital_id"}],attrs:{id:"editalImpugnacao",required:"",disabled:a.carregandoEditais},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.novaImpugnacao,"edital_id",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v(a._s(a.carregandoEditais?"Carregando editais...":"Selecione um edital..."))]),a._l(a.editaisParaImpugnacao,(function(t){return o("option",{key:t.id,attrs:{disabled:!a.editalDentroDoPrazo(t)},domProps:{value:t.id}},[a._v(" "+a._s(t.numero)+" - "+a._s(t.descricao)+" "),a.editalDentroDoPrazo(t)?a._e():o("span",[a._v(" (Prazo vencido)")])])}))],2),a.editalSelecionadoInfo?o("small",{staticClass:"help-text"},[a._v(" Prazo para impugnaÃ§Ã£o: "+a._s(a.formatDate(a.editalSelecionadoInfo.data_limite_impugnacao))+" ")]):a._e()]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"impugnante"}},[a._v("Nome do Impugnante *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.impugnante,expression:"novaImpugnacao.impugnante"}],attrs:{id:"impugnante",type:"text",placeholder:"Ex: JoÃ£o Silva",required:""},domProps:{value:a.novaImpugnacao.impugnante},on:{input:function(o){o.target.composing||a.$set(a.novaImpugnacao,"impugnante",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"emailImpugnante"}},[a._v("Email *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.email,expression:"novaImpugnacao.email"}],attrs:{id:"emailImpugnante",type:"email",placeholder:"Ex: joao@empresa.com",required:""},domProps:{value:a.novaImpugnacao.email},on:{input:function(o){o.target.composing||a.$set(a.novaImpugnacao,"email",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"empresaImpugnante"}},[a._v("Empresa")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.empresa,expression:"novaImpugnacao.empresa"}],attrs:{id:"empresaImpugnante",type:"text",placeholder:"Ex: Empresa XYZ Ltda"},domProps:{value:a.novaImpugnacao.empresa},on:{input:function(o){o.target.composing||a.$set(a.novaImpugnacao,"empresa",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"motivoImpugnacao"}},[a._v("Motivo da ImpugnaÃ§Ã£o *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaImpugnacao.motivo,expression:"novaImpugnacao.motivo"}],attrs:{id:"motivoImpugnacao",rows:"4",placeholder:"Descreva o motivo da impugnaÃ§Ã£o...",required:""},domProps:{value:a.novaImpugnacao.motivo},on:{input:function(o){o.target.composing||a.$set(a.novaImpugnacao,"motivo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"documentosImpugnacao"}},[a._v("Documentos de Apoio")]),o("input",{attrs:{id:"documentosImpugnacao",type:"file",multiple:"",accept:".pdf,.doc,.docx,.jpg,.png"},on:{change:a.handleDocumentosUpload}}),o("small",[a._v("Arquivos suportados: PDF, DOC, DOCX, JPG, PNG (mÃ¡ximo 5MB cada)")])]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovaImpugnacao}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvandoImpugnacao}},[a.salvandoImpugnacao?o("span",[a._v("Salvando...")]):o("span",[a._v("Registrar ImpugnaÃ§Ã£o")])])])])])])]):a._e()]):a._e(),"despadronizadas"===a.activeTab?o("div",{staticClass:"marcas-despadronizadas"},[o("GerenciadorMarcasDespadronizadas",{ref:"gerenciadorMarcas"})],1):a._e(),"certificados"===a.activeTab?o("div",{staticClass:"certificados-dcb"},[o("div",{staticClass:"dcb-container"},[o("div",{staticClass:"dcb-stats"},[o("div",{staticClass:"stat-card dcb-pendentes"},[o("h4",[a._v("ğŸŸ¡ Prontos para DCB")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.produtosProntosDCB.length))]),o("small",[a._v("Produtos aprovados sem DCB")])]),o("div",{staticClass:"stat-card dcb-emitidos"},[o("h4",[a._v("âœ… DCBs Emitidas")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsEmitidos.length))]),o("small",[a._v("Certificados vÃ¡lidos")])]),o("div",{staticClass:"stat-card dcb-vencendo"},[o("h4",[a._v("âš ï¸ DCBs Vencendo")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencendo.length))]),o("small",[a._v("PrÃ³ximos 30 dias")])]),o("div",{staticClass:"stat-card dcb-vencidos"},[o("h4",[a._v("ğŸ”´ DCBs Vencidas")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencidos.length))]),o("small",[a._v("Precisam renovaÃ§Ã£o")])])]),o("div",{staticClass:"dcb-tabs"},[o("div",{staticClass:"dcb-tab",class:{active:"emitir"===a.activeTabDCB},on:{click:function(o){a.activeTabDCB="emitir"}}},[a._v(" ğŸ“ Emitir DCB ")]),o("div",{staticClass:"dcb-tab",class:{active:"historico"===a.activeTabDCB},on:{click:function(o){a.activeTabDCB="historico"}}},[a._v(" ğŸ“‹ HistÃ³rico DCBs ")]),o("div",{staticClass:"dcb-tab",class:{active:"vencimentos"===a.activeTabDCB},on:{click:function(o){a.activeTabDCB="vencimentos"}}},[a._v(" â° Controle Vencimentos ")])]),"emitir"===a.activeTabDCB?o("div",{staticClass:"dcb-content"},[a._m(9),o("div",{staticClass:"filtros-dcb"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.busca,expression:"filtrosDCB.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDCB.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtrosDCB,"busca",o.target.value)},a.aplicarFiltrosDCB]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“‚ Categoria:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.categoria,expression:"filtrosDCB.categoria"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtrosDCB,"categoria",o.target.multiple?t:t[0])},a.aplicarFiltrosDCB]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"medicamentos"}},[a._v("Medicamentos")]),o("option",{attrs:{value:"materiais_medicos"}},[a._v("Materiais MÃ©dicos")]),o("option",{attrs:{value:"equipamentos"}},[a._v("Equipamentos")]),o("option",{attrs:{value:"administrativo"}},[a._v("Administrativo")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“… Data AprovaÃ§Ã£o:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.dataAprovacao,expression:"filtrosDCB.dataAprovacao"}],attrs:{type:"date"},domProps:{value:a.filtrosDCB.dataAprovacao},on:{change:a.aplicarFiltrosDCB,input:function(o){o.target.composing||a.$set(a.filtrosDCB,"dataAprovacao",o.target.value)}}})]),o("button",{staticClass:"btn-limpar",on:{click:a.limparFiltrosDCB}},[a._v("ğŸ—‘ï¸ Limpar")])]),a.produtosProntosDCBFiltrados.length>0?o("div",{staticClass:"produtos-dcb-lista"},a._l(a.produtosProntosDCBFiltrados,(function(t){return o("div",{key:t.id,staticClass:"produto-dcb-card"},[o("div",{staticClass:"produto-info"},[o("div",{staticClass:"produto-header"},[o("h4",[a._v(a._s(t.nome))]),o("span",{staticClass:"status-badge status-aprovado"},[a._v("âœ… Aprovado")])]),o("div",{staticClass:"produto-details"},[o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(t.marca))]),o("p",[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(t.modelo||"N/A"))]),o("p",[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(t.fabricante))]),o("p",[o("strong",[a._v("Data AprovaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(t.data_aprovacao||t.aprovado_em||t.criado_em)))])])]),o("div",{staticClass:"produto-actions"},[o("button",{staticClass:"btn-secondary",on:{click:function(o){return a.visualizarProdutoDetalhes(t)}}},[a._v(" ğŸ‘ï¸ Detalhes ")]),o("button",{staticClass:"btn-primary",attrs:{disabled:a.emitindoDCB===t.id},on:{click:function(o){return a.emitirDCB(t)}}},[a.emitindoDCB===t.id?o("span",[a._v("â³ Emitindo...")]):o("span",[a._v("ğŸ“œ Emitir DCB")])])])])})),0):0===a.produtosProntosDCB.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“")]),o("h3",[a._v("Nenhum produto pronto para DCB")]),o("p",[a._v("Todos os produtos aprovados jÃ¡ possuem DCB emitido ou nÃ£o hÃ¡ produtos aprovados.")])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ”")]),o("h3",[a._v("Nenhum produto encontrado")]),o("p",[a._v("Nenhum produto corresponde aos filtros aplicados.")])])]):a._e(),"historico"===a.activeTabDCB?o("div",{staticClass:"dcb-content"},[a._m(10),o("div",{staticClass:"filtros-dcb"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ”¢ NÃºmero DCB:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.numeroDCB,expression:"filtrosHistorico.numeroDCB"}],attrs:{type:"text",placeholder:"Ex: 001/2024"},domProps:{value:a.filtrosHistorico.numeroDCB},on:{input:[function(o){o.target.composing||a.$set(a.filtrosHistorico,"numeroDCB",o.target.value)},a.aplicarFiltrosHistorico]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“Š Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.status,expression:"filtrosHistorico.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtrosHistorico,"status",o.target.multiple?t:t[0])},a.aplicarFiltrosHistorico]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"ativo"}},[a._v("Ativo")]),o("option",{attrs:{value:"vencido"}},[a._v("Vencido")]),o("option",{attrs:{value:"revogado"}},[a._v("Revogado")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“… PerÃ­odo:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataInicio,expression:"filtrosHistorico.dataInicio"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataInicio},on:{change:a.aplicarFiltrosHistorico,input:function(o){o.target.composing||a.$set(a.filtrosHistorico,"dataInicio",o.target.value)}}}),o("span",[a._v("atÃ©")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataFim,expression:"filtrosHistorico.dataFim"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataFim},on:{change:a.aplicarFiltrosHistorico,input:function(o){o.target.composing||a.$set(a.filtrosHistorico,"dataFim",o.target.value)}}})])]),a.dcbsHistoricoFiltrados.length>0?o("div",{staticClass:"dcb-historico-tabela"},[o("table",[a._m(11),o("tbody",a._l(a.dcbsHistoricoFiltrados,(function(t){return o("tr",{key:t.id},[o("td",{staticClass:"dcb-numero"},[a._v(a._s(t.numero_dcb))]),o("td",[a._v(a._s(t.produto_nome))]),o("td",[a._v(a._s(t.produto_marca))]),o("td",[a._v(a._s(a.formatDate(t.data_emissao)))]),o("td",[a._v(a._s(a.formatDate(t.data_validade)))]),o("td",[o("span",{staticClass:"status-badge",class:a.getStatusDCBClass(t.status)},[a._v(" "+a._s(a.formatStatusDCB(t.status))+" ")])]),o("td",[o("div",{staticClass:"acoes-dcb"},[o("button",{staticClass:"btn-small",on:{click:function(o){return a.visualizarDCB(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.downloadDCB(t)}}},[a._v(" ğŸ“¥ PDF ")]),"ativo"===t.status?o("button",{staticClass:"btn-small btn-danger",on:{click:function(o){return a.revogarDCB(t)}}},[a._v(" ğŸš« Revogar ")]):a._e()])])])})),0)])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“‹")]),o("h3",[a._v("Nenhum DCB encontrado")]),o("p",[a._v("Nenhum certificado corresponde aos filtros aplicados.")])])]):a._e(),"vencimentos"===a.activeTabDCB?o("div",{staticClass:"dcb-content"},[a._m(12),o("div",{staticClass:"alertas-vencimento"},[a.dcbsVencendo.length>0?o("div",{staticClass:"alerta-warning"},[o("div",{staticClass:"alerta-icon"},[a._v("âš ï¸")]),o("div",{staticClass:"alerta-content"},[o("h4",[a._v(a._s(a.dcbsVencendo.length)+" DCB(s) vencendo nos prÃ³ximos 30 dias")]),o("p",[a._v("Ã‰ recomendado iniciar o processo de renovaÃ§Ã£o.")])])]):a._e(),a.dcbsVencidos.length>0?o("div",{staticClass:"alerta-danger"},[o("div",{staticClass:"alerta-icon"},[a._v("ğŸ”´")]),o("div",{staticClass:"alerta-content"},[o("h4",[a._v(a._s(a.dcbsVencidos.length)+" DCB(s) vencido(s)")]),o("p",[a._v("Produtos nÃ£o podem ser utilizados em licitaÃ§Ãµes atÃ© renovaÃ§Ã£o.")])])]):a._e()]),a.dcbsVencendo.length>0?o("div",{staticClass:"dcb-vencimento-section"},[o("h4",[a._v("âš ï¸ DCBs Vencendo (PrÃ³ximos 30 dias)")]),o("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencendo,(function(t){return o("div",{key:t.id,staticClass:"dcb-vencimento-card warning"},[o("div",{staticClass:"dcb-info"},[o("h5",[a._v(a._s(t.numero_dcb)+" - "+a._s(t.produto_nome))]),o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(t.produto_marca))]),o("p",[o("strong",[a._v("Vence em:")]),a._v(" "+a._s(a.formatDate(t.data_validade)))]),o("p",[o("strong",[a._v("Dias restantes:")]),a._v(" "+a._s(a.calcularDiasRestantes(t.data_validade)))])]),o("div",{staticClass:"dcb-actions"},[o("button",{staticClass:"btn-warning",on:{click:function(o){return a.iniciarRenovacao(t)}}},[a._v(" ğŸ”„ Renovar ")]),o("button",{staticClass:"btn-secondary",on:{click:function(o){return a.visualizarDCB(t)}}},[a._v(" ğŸ‘ï¸ Ver DCB ")])])])})),0)]):a._e(),a.dcbsVencidos.length>0?o("div",{staticClass:"dcb-vencimento-section"},[o("h4",[a._v("ğŸ”´ DCBs Vencidos")]),o("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencidos,(function(t){return o("div",{key:t.id,staticClass:"dcb-vencimento-card danger"},[o("div",{staticClass:"dcb-info"},[o("h5",[a._v(a._s(t.numero_dcb)+" - "+a._s(t.produto_nome))]),o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(t.produto_marca))]),o("p",[o("strong",[a._v("Venceu em:")]),a._v(" "+a._s(a.formatDate(t.data_validade)))]),o("p",[o("strong",[a._v("Vencido hÃ¡:")]),a._v(" "+a._s(a.calcularDiasVencidos(t.data_validade))+" dias")])]),o("div",{staticClass:"dcb-actions"},[o("button",{staticClass:"btn-danger",on:{click:function(o){return a.renovarDCBVencido(t)}}},[a._v(" ğŸ”„ Renovar Urgente ")]),o("button",{staticClass:"btn-secondary",on:{click:function(o){return a.visualizarDCB(t)}}},[a._v(" ğŸ‘ï¸ Ver DCB ")])])])})),0)]):a._e(),0===a.dcbsVencendo.length&&0===a.dcbsVencidos.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("âœ…")]),o("h3",[a._v("Todos os DCBs estÃ£o em dia!")]),o("p",[a._v("NÃ£o hÃ¡ certificados vencidos ou prÃ³ximos ao vencimento.")])]):a._e()]):a._e()]),a.modalProdutoDetalhes?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDetalhes}},[o("div",{staticClass:"modal-content produto-detalhes-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“‹ Detalhes do Produto")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalDetalhes}},[a._v("âœ•")])]),a.produtoSelecionado?o("div",{staticClass:"modal-body"},[o("div",{staticClass:"produto-detalhes-grid"},[o("div",{staticClass:"detalhes-section"},[o("h4",[a._v("ğŸ“¦ InformaÃ§Ãµes BÃ¡sicas")]),o("p",[o("strong",[a._v("Nome:")]),a._v(" "+a._s(a.produtoSelecionado.nome))]),o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),o("p",[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo||"N/A"))]),o("p",[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),o("p",[o("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj_fabricante||a.produtoSelecionado.cnpj||"NÃ£o informado"))])]),o("div",{staticClass:"detalhes-section"},[o("h4",[a._v("âœ… Status da AprovaÃ§Ã£o")]),o("p",[o("strong",[a._v("Status:")]),o("span",{staticClass:"status-badge status-aprovado"},[a._v(a._s(a.formatarStatus(a.produtoSelecionado.status)))])]),o("p",[o("strong",[a._v("Data AprovaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(a.produtoSelecionado.data_aprovacao||a.produtoSelecionado.aprovado_em||a.produtoSelecionado.criado_em)))]),o("p",[o("strong",[a._v("Aprovado por:")]),a._v(" "+a._s(a.produtoSelecionado.aprovado_por_nome||"Sistema"))])])]),a.produtoSelecionado.especificacoes_tecnicas?o("div",{staticClass:"detalhes-section"},[o("h4",[a._v("ğŸ”§ EspecificaÃ§Ãµes TÃ©cnicas")]),o("pre",[a._v(a._s(a.formatarEspecificacoes(a.produtoSelecionado.especificacoes_tecnicas)))])]):a._e(),a.produtoSelecionado.observacoes_internas?o("div",{staticClass:"detalhes-section"},[o("h4",[a._v("ğŸ“ ObservaÃ§Ãµes")]),o("p",[a._v(a._s(a.produtoSelecionado.observacoes_internas))])]):a._e()]):a._e(),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDetalhes}},[a._v("Fechar")]),o("button",{staticClass:"btn-primary",on:{click:function(o){return a.emitirDCB(a.produtoSelecionado)}}},[a._v(" ğŸ“œ Emitir DCB ")])])])]):a._e(),a.modalVisualizarDCB?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDCB}},[o("div",{staticClass:"modal-content dcb-visualizar-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“œ Visualizar DCB")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalDCB}},[a._v("âœ•")])]),a.dcbSelecionado?o("div",{staticClass:"modal-body"},[o("div",{staticClass:"dcb-preview"},[o("div",{staticClass:"dcb-header"},[o("h2",[a._v("DECLARAÃ‡ÃƒO DE CONFORMIDADE DE BEM")]),o("h3",[a._v("DCB NÂº "+a._s(a.dcbSelecionado.numero_dcb))])]),o("div",{staticClass:"dcb-content-preview"},[o("div",{staticClass:"dcb-section"},[o("h4",[a._v("PRODUTO CERTIFICADO")]),o("p",[o("strong",[a._v("Nome:")]),a._v(" "+a._s(a.dcbSelecionado.produto_nome))]),o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(a.dcbSelecionado.produto_marca))]),o("p",[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.dcbSelecionado.produto_modelo||"N/A"))]),o("p",[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.dcbSelecionado.produto_fabricante))])]),o("div",{staticClass:"dcb-section"},[o("h4",[a._v("DADOS DO CERTIFICADO")]),o("p",[o("strong",[a._v("Data de EmissÃ£o:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_emissao)))]),o("p",[o("strong",[a._v("Validade:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_validade)))]),o("p",[o("strong",[a._v("Status:")]),o("span",{staticClass:"status-badge",class:a.getStatusDCBClass(a.dcbSelecionado.status)},[a._v(" "+a._s(a.formatStatusDCB(a.dcbSelecionado.status))+" ")])])])])])]):a._e(),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDCB}},[a._v("Fechar")]),o("button",{staticClass:"btn-primary",on:{click:function(o){return a.downloadDCB(a.dcbSelecionado)}}},[a._v(" ğŸ“¥ Download PDF ")])])])]):a._e(),o("div",{directives:[{name:"show",rawName:"v-show",value:a.modalParticipantes,expression:"modalParticipantes"}],staticClass:"modal-participantes-overlay"},[o("div",{staticClass:"modal-participantes-content"},[o("div",{staticClass:"modal-participantes-header"},[o("h3",[a._v("ğŸ‘¥ Participantes - "+a._s(a.editalSelecionado.numero))]),o("button",{staticClass:"btn-close-participantes",on:{click:a.fecharModalParticipantes}},[a._v("Ã—")])]),o("div",{staticClass:"modal-participantes-body"},[o("div",{staticClass:"participantes-header"},[o("div",{staticClass:"filtros-participantes"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.busca,expression:"filtroParticipantes.busca"}],attrs:{type:"text",placeholder:"Nome, CNPJ, representante..."},domProps:{value:a.filtroParticipantes.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtroParticipantes,"busca",o.target.value)},a.aplicarFiltrosParticipantes]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“Š Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.status,expression:"filtroParticipantes.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtroParticipantes,"status",o.target.multiple?t:t[0])},a.aplicarFiltrosParticipantes]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),o("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("DocumentaÃ§Ã£o Enviada")]),o("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em AvaliaÃ§Ã£o")]),o("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),o("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),o("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoParticipante}},[a._v(" â• Adicionar Participante ")])]),a.loadingParticipantes?o("div",{staticClass:"loading-state"},[o("div",{staticClass:"spinner"}),o("p",[a._v("Carregando participantes...")])]):a.participantesFiltrados.length>0?o("div",{staticClass:"participantes-lista"},a._l(a.participantesFiltrados,(function(t){return o("div",{key:t.id,staticClass:"participante-card"},[o("div",{staticClass:"participante-info"},[o("div",{staticClass:"participante-header"},[o("h4",[a._v(a._s(t.razao_social))]),o("span",{staticClass:"status-badge",class:a.getStatusClass(t.status)},[a._v(" "+a._s(a.formatarStatus(t.status))+" ")])]),o("div",{staticClass:"participante-details"},[o("p",[o("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.formatarCNPJ(t.cnpj)))]),o("p",[o("strong",[a._v("Representante:")]),a._v(" "+a._s(t.representante_legal))]),o("p",[o("strong",[a._v("Email:")]),a._v(" "+a._s(t.email))]),t.telefone?o("p",[o("strong",[a._v("Telefone:")]),a._v(" "+a._s(t.telefone))]):a._e(),o("p",[o("strong",[a._v("Data ParticipaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(t.data_participacao)))]),t.data_envio_documentacao?o("p",[o("strong",[a._v("DocumentaÃ§Ã£o Enviada:")]),a._v(" "+a._s(a.formatDate(t.data_envio_documentacao))+" ")]):a._e(),t.observacoes?o("p",[o("strong",[a._v("ObservaÃ§Ãµes:")]),a._v(" "+a._s(t.observacoes)+" ")]):a._e()])]),o("div",{staticClass:"participante-actions"},[o("button",{staticClass:"btn-secondary btn-small",on:{click:function(o){return a.editarParticipante(t)}}},[a._v(" âœï¸ Editar ")]),o("button",{staticClass:"btn-danger btn-small",on:{click:function(o){return a.removerParticipante(t)}}},[a._v(" ğŸ—‘ï¸ Remover ")])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ‘¥")]),o("h3",[a._v("Nenhum participante encontrado")]),a.filtroParticipantes.busca||a.filtroParticipantes.status?o("p",[a._v(" Nenhum participante corresponde aos filtros aplicados. ")]):o("p",[a._v(' Ainda nÃ£o hÃ¡ participantes neste edital. Clique em "Adicionar Participante" para comeÃ§ar. ')])])]),o("div",{staticClass:"modal-participantes-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalParticipantes}},[a._v("Fechar")])])])]),a.modalNovoParticipante?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoParticipante}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.participanteAtual.id?"âœï¸ Editar Participante":"â• Novo Participante"))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoParticipante}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarParticipante.apply(null,arguments)}}},[o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"razao_social"}},[a._v("RazÃ£o Social*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.razao_social,expression:"participanteAtual.razao_social"}],attrs:{id:"razao_social",type:"text",placeholder:"Nome da empresa",required:""},domProps:{value:a.participanteAtual.razao_social},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"razao_social",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"cnpj"}},[a._v("CNPJ*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.cnpj,expression:"participanteAtual.cnpj"}],attrs:{id:"cnpj",type:"text",placeholder:"00.000.000/0000-00",required:""},domProps:{value:a.participanteAtual.cnpj},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"cnpj",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"representante_legal"}},[a._v("Representante Legal*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.representante_legal,expression:"participanteAtual.representante_legal"}],attrs:{id:"representante_legal",type:"text",placeholder:"Nome do representante",required:""},domProps:{value:a.participanteAtual.representante_legal},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"representante_legal",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"email"}},[a._v("Email*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.email,expression:"participanteAtual.email"}],attrs:{id:"email",type:"email",placeholder:"contato@empresa.com",required:""},domProps:{value:a.participanteAtual.email},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"email",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"telefone"}},[a._v("Telefone")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.telefone,expression:"participanteAtual.telefone"}],attrs:{id:"telefone",type:"text",placeholder:"(11) 99999-9999"},domProps:{value:a.participanteAtual.telefone},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"telefone",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"status"}},[a._v("Status")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.status,expression:"participanteAtual.status"}],attrs:{id:"status"},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.participanteAtual,"status",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),o("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("DocumentaÃ§Ã£o Enviada")]),o("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em AvaliaÃ§Ã£o")]),o("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),o("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),o("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"endereco"}},[a._v("EndereÃ§o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.endereco,expression:"participanteAtual.endereco"}],attrs:{id:"endereco",type:"text",placeholder:"EndereÃ§o completo da empresa"},domProps:{value:a.participanteAtual.endereco},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"endereco",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"observacoes"}},[a._v("ObservaÃ§Ãµes")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.observacoes,expression:"participanteAtual.observacoes"}],attrs:{id:"observacoes",rows:"3",placeholder:"ObservaÃ§Ãµes sobre a participaÃ§Ã£o..."},domProps:{value:a.participanteAtual.observacoes},on:{input:function(o){o.target.composing||a.$set(a.participanteAtual,"observacoes",o.target.value)}}})]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoParticipante}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[a._v(" "+a._s(a.participanteAtual.id?"Atualizar":"Adicionar")+" Participante ")])])])])])]):a._e()]):a._e(),"usuarios"===a.activeTab?o("div",{staticClass:"usuarios-section"},[a._m(13),o("div",{staticClass:"section-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoUsuario}},[a._v(" â• Cadastrar Novo UsuÃ¡rio ")])]),o("div",{staticClass:"usuarios-container"},[o("div",{staticClass:"filtros-usuarios"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroUsuarios.busca,expression:"filtroUsuarios.busca"}],attrs:{type:"text",placeholder:"Nome, unidade, coordenador..."},domProps:{value:a.filtroUsuarios.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtroUsuarios,"busca",o.target.value)},a.aplicarFiltrosUsuarios]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ¢ Unidade:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroUsuarios.unidade,expression:"filtroUsuarios.unidade"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtroUsuarios,"unidade",o.target.multiple?t:t[0])},a.aplicarFiltrosUsuarios]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),a._l(a.unidadesUnicas,(function(t){return o("option",{key:t,domProps:{value:t}},[a._v(" "+a._s(t)+" ")])}))],2)])]),a.usuariosFiltrados.length>0?o("div",{staticClass:"usuarios-grid"},a._l(a.usuariosFiltrados,(function(t){return o("div",{key:t.id,staticClass:"usuario-card"},[o("div",{staticClass:"usuario-header"},[o("h4",[a._v(a._s(t.nome_usuario))]),o("div",{staticClass:"status-badges"},[o("span",{staticClass:"status-badge status-ativo"},[a._v("Ativo")]),t.user_id?o("span",{class:["status-convite",t.convite_aceito?"aceito":t.convite_enviado?"enviado":"pendente"]},[a._v(" "+a._s(t.convite_aceito?"ğŸŸ¢ Conectado":t.convite_enviado?"ğŸ“§ Convite Enviado":"â³ Convite Pendente")+" ")]):a._e()])]),o("div",{staticClass:"usuario-details"},[o("p",[o("strong",[a._v("Unidade/Setor:")]),a._v(" "+a._s(t.unidade_setor))]),o("p",[o("strong",[a._v("Coordenador:")]),a._v(" "+a._s(t.nome_coordenador))]),o("p",[o("strong",[a._v("Telefone:")]),a._v(" "+a._s(t.telefone))]),o("p",[o("strong",[a._v("Email:")]),a._v(" "+a._s(t.email))]),o("p",[o("strong",[a._v("Materiais:")]),a._v(" "+a._s(t.materiais?.length||0)+" cadastrados")]),o("p",[o("strong",[a._v("PrÃ³ximo RDM:")]),o("span",{staticClass:"data-rdm"},[a._v(a._s(a.calcularProximoRDM(t)))])])]),o("div",{staticClass:"usuario-actions"},[o("button",{staticClass:"btn-secondary btn-small",on:{click:function(o){return a.editarUsuario(t)}}},[a._v(" âœï¸ Editar ")]),o("button",{staticClass:"btn-info btn-small",on:{click:function(o){return a.verMateriaisUsuario(t)}}},[a._v(" ğŸ“¦ Materiais ")]),t.user_id&&!t.convite_aceito?o("button",{staticClass:"btn-reenviar btn-small",on:{click:function(o){return a.reenviarConvite(t)}}},[a._v(" ğŸ“§ Reenviar Convite ")]):a._e(),o("button",{staticClass:"btn-danger btn-small",on:{click:function(o){return a.removerUsuario(t)}}},[a._v(" ğŸ—‘ï¸ Remover ")])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ‘¥")]),o("h3",[a._v("Nenhum usuÃ¡rio cadastrado")]),o("p",[a._v('Clique em "Cadastrar Novo UsuÃ¡rio" para comeÃ§ar.')])])]),a.modalNovoUsuario?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoUsuario}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.usuarioAtual.id?"âœï¸ Editar UsuÃ¡rio":"ğŸ‘¥ Novo UsuÃ¡rio"))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoUsuario}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarUsuario.apply(null,arguments)}}},[o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"unidade_setor"}},[a._v("Unidade/Setor*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.unidade_setor,expression:"usuarioAtual.unidade_setor"}],attrs:{id:"unidade_setor",type:"text",placeholder:"Ex: Secretaria da SaÃºde",required:""},domProps:{value:a.usuarioAtual.unidade_setor},on:{input:function(o){o.target.composing||a.$set(a.usuarioAtual,"unidade_setor",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nome_coordenador"}},[a._v("Nome do Coordenador*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.nome_coordenador,expression:"usuarioAtual.nome_coordenador"}],attrs:{id:"nome_coordenador",type:"text",placeholder:"Nome completo do responsÃ¡vel",required:""},domProps:{value:a.usuarioAtual.nome_coordenador},on:{input:function(o){o.target.composing||a.$set(a.usuarioAtual,"nome_coordenador",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"telefone_usuario"}},[a._v("Telefone*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.telefone,expression:"usuarioAtual.telefone"}],attrs:{id:"telefone_usuario",type:"tel",placeholder:"(00) 00000-0000",required:""},domProps:{value:a.usuarioAtual.telefone},on:{input:function(o){o.target.composing||a.$set(a.usuarioAtual,"telefone",o.target.value)}}})])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"email_usuario"}},[a._v("Email*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.email,expression:"usuarioAtual.email"}],attrs:{id:"email_usuario",type:"email",placeholder:"email@exemplo.com",required:""},domProps:{value:a.usuarioAtual.email},on:{input:function(o){o.target.composing||a.$set(a.usuarioAtual,"email",o.target.value)}}})]),o("div",{staticClass:"login-system-section"},[o("h4",[a._v("ğŸ” Sistema de Login")]),o("div",{staticClass:"form-group checkbox-group"},[o("label",{staticClass:"checkbox-label"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.usuarioAtual.criar_login,expression:"usuarioAtual.criar_login"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.usuarioAtual.criar_login)?a._i(a.usuarioAtual.criar_login,null)>-1:a.usuarioAtual.criar_login},on:{change:[function(o){var t=a.usuarioAtual.criar_login,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.usuarioAtual,"criar_login",t.concat([i])):r>-1&&a.$set(a.usuarioAtual,"criar_login",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.usuarioAtual,"criar_login",s)},a.toggleLoginSystem]}}),o("span",{staticClass:"checkmark"},[a._v("âœ“")]),a._v(" Permitir login no sistema (Dashboard RDM On-line) ")]),o("p",{staticClass:"help-text"},[a._v(" Ao marcar esta opÃ§Ã£o, o usuÃ¡rio receberÃ¡ um e-mail da CPM, com senha de acesso, para preencher o formulÃ¡rio RDM. ")])]),a.usuarioAtual.criar_login?o("div",{staticClass:"convite-info"},[o("div",{staticClass:"info-card"},[o("h5",[a._v("ğŸ“§ Convite AutomÃ¡tico")]),o("p",[a._v("SerÃ¡ enviado automaticamente um email para "),o("strong",[a._v(a._s(a.usuarioAtual.email))]),a._v(" com:")]),a._m(14)])]):a._e()]),o("div",{staticClass:"materiais-section"},[o("h4",[a._v("ğŸ“¦ Materiais sob Responsabilidade da Unidade")]),o("div",{staticClass:"materiais-lista"},[a._l(a.usuarioAtual.materiais,(function(t,e){return o("div",{key:e,staticClass:"material-item"},[o("div",{staticClass:"material-fields-novo"},[o("div",{staticClass:"material-select"},[o("label",[a._v("ğŸ“¦ Material/Produto:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.produto_id,expression:"material.produto_id"}],attrs:{disabled:a.loadingProdutos,required:""},on:{change:[function(o){var e=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(t,"produto_id",o.target.multiple?e:e[0])},function(o){return a.selecionarProduto(e,o)}]}},[a.loadingProdutos?o("option",{attrs:{value:""}},[a._v("â³ Carregando produtos...")]):0===a.produtosDisponiveis.length?o("option",{attrs:{value:""}},[a._v("Nenhum produto encontrado")]):o("option",{attrs:{value:""}},[a._v("Selecione um produto...")]),a._l(a.produtosDisponiveis,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" - "+a._s(t.marca||"S/Marca")+" ("+a._s(t.codigo_material||t.modelo||"S/CÃ³digo")+") ")])})),o("option",{attrs:{value:"NOVO"}},[a._v("â• Cadastrar Novo Material")])],2)]),"NOVO"===t.produto_id?o("div",{staticClass:"novo-material"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.nome,expression:"material.nome"}],attrs:{type:"text",placeholder:"Nome do novo material",required:""},domProps:{value:t.nome},on:{input:function(o){o.target.composing||a.$set(t,"nome",o.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.codigo,expression:"material.codigo"}],attrs:{type:"text",placeholder:"CÃ³digo do material",required:""},domProps:{value:t.codigo},on:{input:function(o){o.target.composing||a.$set(t,"codigo",o.target.value)}}})]):a._e(),o("div",{staticClass:"material-periodo"},[o("label",[a._v("ğŸ“… Periodicidade RDM:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.periodicidade_rdm,expression:"material.periodicidade_rdm"}],attrs:{required:""},on:{change:function(o){var e=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(t,"periodicidade_rdm",o.target.multiple?e:e[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecionar...")]),o("option",{attrs:{value:"mensal"}},[a._v("Mensal")]),o("option",{attrs:{value:"bimestral"}},[a._v("Bimestral")]),o("option",{attrs:{value:"trimestral"}},[a._v("Trimestral")]),o("option",{attrs:{value:"semestral"}},[a._v("Semestral")]),o("option",{attrs:{value:"anual"}},[a._v("Anual")])])]),o("button",{staticClass:"btn-danger btn-small",attrs:{type:"button",title:"Remover material"},on:{click:function(o){return a.removerMaterial(e)}}},[a._v(" ğŸ—‘ï¸ ")])])])})),o("div",{staticClass:"material-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button",disabled:a.loadingProdutos},on:{click:a.adicionarMaterial}},[a.loadingProdutos?o("span",[a._v("â³")]):o("span",[a._v("â•")]),a._v(" Adicionar Material ")]),o("button",{staticClass:"btn-info btn-small",attrs:{type:"button",disabled:a.loadingProdutos},on:{click:a.carregarProdutos}},[a.loadingProdutos?o("span",[a._v("â³")]):o("span",[a._v("ğŸ”„")]),a._v(" Atualizar Lista ")])]),a.loadingProdutos?a._e():o("div",{staticClass:"debug-info"},[o("small",[a._v(" ğŸ“Š Debug: "+a._s(a.produtosDisponiveis.length)+" produtos disponÃ­veis "),a.currentTenantId?o("span",[a._v("(Tenant: "+a._s(a.currentTenantId.substring(0,8))+"...)")]):a._e(),o("br"),a._v(" ğŸ“‹ Materiais do usuÃ¡rio: "+a._s(a.usuarioAtual.materiais?.length||0)+" "),a.usuarioAtual.materiais?.length>0?o("span",[a._v(" ("+a._s(a.usuarioAtual.materiais.map((a=>a.nome||"Sem nome")).join(", "))+") ")]):a._e()])])],2)]),o("div",{staticClass:"modal-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoUsuario}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[a._v(" "+a._s(a.usuarioAtual.id?"Atualizar":"Cadastrar")+" UsuÃ¡rio ")])])])])])]):a._e()]):a._e(),"reclamacoes"===a.activeTab?o("div",{staticClass:"reclamacoes-section"},[a._m(15),o("div",{staticClass:"section-actions"},[o("div",{staticClass:"stats-reclamacoes"},[o("span",{staticClass:"stat-item"},[a._v("ğŸ“Š Total: "+a._s(a.reclamacoes.length))]),o("span",{staticClass:"stat-item"},[a._v("ğŸ” Filtradas: "+a._s(a.reclamacoesFiltradas.length))]),o("span",{staticClass:"stat-item pendentes"},[a._v("â³ Pendentes: "+a._s(a.reclamacoesPendentes))]),o("span",{staticClass:"stat-item respondidas"},[a._v("âœ… Respondidas: "+a._s(a.reclamacoesRespondidas))])])]),o("div",{staticClass:"filtros-reclamacoes"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroReclamacoes.busca,expression:"filtroReclamacoes.busca"}],attrs:{type:"text",placeholder:"TÃ­tulo, nome, descriÃ§Ã£o..."},domProps:{value:a.filtroReclamacoes.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtroReclamacoes,"busca",o.target.value)},a.aplicarFiltrosReclamacoes]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“Š Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroReclamacoes.status,expression:"filtroReclamacoes.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtroReclamacoes,"status",o.target.multiple?t:t[0])},a.aplicarFiltrosReclamacoes]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"pendente"}},[a._v("â³ Pendente")]),o("option",{attrs:{value:"em_analise"}},[a._v("ğŸ” Em AnÃ¡lise")]),o("option",{attrs:{value:"respondida"}},[a._v("âœ… Respondida")]),o("option",{attrs:{value:"resolvida"}},[a._v("ğŸ¯ Resolvida")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("âš¡ Prioridade:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroReclamacoes.prioridade,expression:"filtroReclamacoes.prioridade"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtroReclamacoes,"prioridade",o.target.multiple?t:t[0])},a.aplicarFiltrosReclamacoes]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"baixa"}},[a._v("ğŸŸ¢ Baixa")]),o("option",{attrs:{value:"normal"}},[a._v("ğŸ”µ Normal")]),o("option",{attrs:{value:"alta"}},[a._v("ğŸŸ¡ Alta")]),o("option",{attrs:{value:"critica"}},[a._v("ğŸ”´ CrÃ­tica")])])])]),a.reclamacoesFiltradas.length>0?o("div",{staticClass:"reclamacoes-lista"},a._l(a.reclamacoesFiltradas,(function(t){return o("div",{key:t.id,staticClass:"reclamacao-card"},[o("div",{staticClass:"reclamacao-header"},[o("div",{staticClass:"reclamacao-info"},[o("div",{staticClass:"reclamacao-meta"},[o("span",{staticClass:"reclamante"},[a._v("ğŸ‘¤ "+a._s(t.nome_reclamante))]),t.setor_reclamante?o("span",{staticClass:"setor"},[a._v("ğŸ¢ "+a._s(t.setor_reclamante))]):a._e(),o("span",{staticClass:"data"},[a._v("ğŸ“… "+a._s(a.formatDate(t.criado_em)))])])]),o("div",{staticClass:"reclamacao-badges"},[o("span",{staticClass:"status-badge",class:a.getStatusClass(t.status)},[a._v(" "+a._s(a.getStatusText(t.status))+" ")]),o("span",{staticClass:"prioridade-badge",class:a.getPrioridadeClass(t.prioridade)},[a._v(" "+a._s(a.getPrioridadeText(t.prioridade))+" ")])])]),o("div",{staticClass:"reclamacao-content"},[o("div",{staticClass:"reclamacao-detalhes"},[o("div",{staticClass:"descricao-reclamacao"},[o("h5",[a._v("ğŸ“ DescriÃ§Ã£o da ReclamaÃ§Ã£o:")]),o("p",[a._v(a._s(t.descricao_reclamacao))])]),o("div",{staticClass:"cpm-acoes"},[o("div",{staticClass:"acao-group"},[o("label",[a._v("ğŸ“Š Alterar Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.novo_status,expression:"reclamacao.novo_status"}],attrs:{disabled:a.salvandoStatus},on:{change:[function(o){var e=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(t,"novo_status",o.target.multiple?e:e[0])},function(o){return a.alterarStatusReclamacao(t)}]}},[o("option",{domProps:{value:t.status}},[a._v(a._s(a.getStatusText(t.status))+" (atual)")]),o("option",{attrs:{value:"pendente"}},[a._v("â³ Pendente")]),o("option",{attrs:{value:"em_analise"}},[a._v("ğŸ” Em AnÃ¡lise")]),o("option",{attrs:{value:"respondida"}},[a._v("âœ… Respondida")]),o("option",{attrs:{value:"resolvida"}},[a._v("ğŸ¯ Resolvida")])])]),o("div",{staticClass:"acao-group"},[o("label",[a._v("âš¡ Alterar Prioridade:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.nova_prioridade,expression:"reclamacao.nova_prioridade"}],attrs:{disabled:a.salvandoPrioridade},on:{change:[function(o){var e=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(t,"nova_prioridade",o.target.multiple?e:e[0])},function(o){return a.alterarPrioridadeReclamacao(t)}]}},[o("option",{domProps:{value:t.prioridade}},[a._v(a._s(a.getPrioridadeText(t.prioridade))+" (atual)")]),o("option",{attrs:{value:"baixa"}},[a._v("ğŸŸ¢ Baixa")]),o("option",{attrs:{value:"normal"}},[a._v("ğŸ”µ Normal")]),o("option",{attrs:{value:"alta"}},[a._v("ğŸŸ¡ Alta")]),o("option",{attrs:{value:"critica"}},[a._v("ğŸ”´ CrÃ­tica")])])])]),o("div",{staticClass:"cpm-resposta"},[o("h5",[a._v("ğŸ’¬ Resposta da CPM:")]),t.resposta_cpm?o("div",{staticClass:"resposta-existente"},[o("p",[a._v(a._s(t.resposta_cpm))]),o("small",{staticClass:"data-resposta"},[a._v("âœ… Respondido em: "+a._s(a.formatDate(t.respondido_em)))]),o("button",{staticClass:"btn-secondary btn-small",on:{click:function(o){return a.editarResposta(t)}}},[a._v(" âœï¸ Editar Resposta ")])]):o("div",{staticClass:"sem-resposta"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.nova_resposta,expression:"reclamacao.nova_resposta"}],staticClass:"textarea-resposta",attrs:{rows:"4",placeholder:"Digite a resposta da CPM para esta reclamaÃ§Ã£o. Seja detalhado e explicativo sobre as aÃ§Ãµes tomadas ou que serÃ£o tomadas..."},domProps:{value:t.nova_resposta},on:{input:function(o){o.target.composing||a.$set(t,"nova_resposta",o.target.value)}}}),o("div",{staticClass:"resposta-acoes"},[o("button",{staticClass:"btn-primary btn-small",attrs:{disabled:!t.nova_resposta||a.salvandoResposta},on:{click:function(o){return a.salvarRespostaReclamacao(t)}}},[a.salvandoResposta?o("span",{staticClass:"spinner-small"}):a._e(),a._v(" "+a._s(a.salvandoResposta?"Salvando...":"ğŸ’¾ Salvar Resposta")+" ")])])])])])])])})),0):a._e(),0===a.reclamacoesFiltradas.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“¢")]),o("h3",[a._v("Nenhuma reclamaÃ§Ã£o encontrada")]),o("p",[a._v("Quando houver reclamaÃ§Ãµes dos usuÃ¡rios, elas aparecerÃ£o aqui para gerenciamento.")])]):a._e()]):a._e(),a.modalEditarEdital?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEditarEdital}},[o("div",{staticClass:"modal-content medium",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("âœï¸ Editar Edital")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalEditarEdital}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarEdicaoEdital.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"numeroEdital"}},[a._v("NÃºmero do Edital *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.numero,expression:"editalEditando.numero"}],attrs:{id:"numeroEdital",type:"text",required:"",placeholder:"Ex: 001/2024",disabled:"RASCUNHO"!==a.editalEditando.status},domProps:{value:a.editalEditando.numero},on:{input:function(o){o.target.composing||a.$set(a.editalEditando,"numero",o.target.value)}}}),"RASCUNHO"!==a.editalEditando.status?o("small",{staticClass:"help-text"},[a._v(" O nÃºmero nÃ£o pode ser alterado apÃ³s a publicaÃ§Ã£o ")]):a._e()]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"descricaoEdital"}},[a._v("DescriÃ§Ã£o/Nome do Edital *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.descricao,expression:"editalEditando.descricao"}],attrs:{id:"descricaoEdital",type:"text",required:"",placeholder:"Ex: PrÃ©-qualificaÃ§Ã£o de Equipamentos MÃ©dicos"},domProps:{value:a.editalEditando.descricao},on:{input:function(o){o.target.composing||a.$set(a.editalEditando,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"conteudoEdital"}},[a._v("ConteÃºdo Adicional")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.conteudo,expression:"editalEditando.conteudo"}],attrs:{id:"conteudoEdital",rows:"4",placeholder:"InformaÃ§Ãµes adicionais sobre o edital..."},domProps:{value:a.editalEditando.conteudo},on:{input:function(o){o.target.composing||a.$set(a.editalEditando,"conteudo",o.target.value)}}})]),"PUBLICADO"===a.editalEditando.status?o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"dataPublicacao"}},[a._v("Data de PublicaÃ§Ã£o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.data_publicacao,expression:"editalEditando.data_publicacao"}],attrs:{id:"dataPublicacao",type:"datetime-local",disabled:!0},domProps:{value:a.editalEditando.data_publicacao},on:{input:function(o){o.target.composing||a.$set(a.editalEditando,"data_publicacao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"dataLimiteImpugnacao"}},[a._v("Prazo para ImpugnaÃ§Ãµes")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.editalEditando.data_limite_impugnacao,expression:"editalEditando.data_limite_impugnacao"}],attrs:{id:"dataLimiteImpugnacao",type:"datetime-local",disabled:!0},domProps:{value:a.editalEditando.data_limite_impugnacao},on:{input:function(o){o.target.composing||a.$set(a.editalEditando,"data_limite_impugnacao",o.target.value)}}})])]):a._e(),o("div",{staticClass:"form-group"},[o("label",[a._v("Status Atual")]),o("div",{staticClass:"status-display"},[o("span",{class:"badge status-"+a.editalEditando.status.toLowerCase()},[a._v(" "+a._s(a.getStatusText(a.editalEditando.status))+" ")])])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalEditarEdital}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"button",disabled:a.salvandoEdicaoEdital},on:{click:a.salvarEdicaoEdital}},[a.salvandoEdicaoEdital?o("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoEdicaoEdital?"Salvando...":"Salvar AlteraÃ§Ãµes")+" ")])])])]):a._e()])},j=[function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Nome")]),o("th",[a._v("Marca")]),o("th",[a._v("Edital")]),o("th",[a._v("Status")]),o("th",[a._v("Data")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Nome")]),o("th",[a._v("Marca")]),o("th",[a._v("Edital")]),o("th",[a._v("Status")]),o("th",[a._v("Data")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("td",[o("span",{staticClass:"status-badge status-diligencia"},[a._v(" DiligÃªncia ")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-intro"},[o("h4",[a._v("ğŸ¤– PesquisaBot - Assistente de Pesquisa TÃ©cnica")]),o("p",[a._v("Ferramenta especializada para buscar informaÃ§Ãµes tÃ©cnicas sobre produtos e marcas, incluindo manuais, laudos, normas, certificaÃ§Ãµes e informaÃ§Ãµes regulatÃ³rias.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-intro"},[o("h4",[a._v("ğŸ¦ IntegraÃ§Ã£o com Bancos de PreÃ§os PÃºblicos")]),o("p",[a._v("Consulte e integre dados de bancos de preÃ§os pÃºblicos para referÃªncia de mercado.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"banco-card"},[o("div",{staticClass:"banco-icon"},[a._v("ğŸ›ï¸")]),o("h5",[a._v("Banco de PreÃ§os do Governo Federal")]),o("p",[a._v("Consulta ao Painel de PreÃ§os")]),o("a",{staticClass:"btn-primary",staticStyle:{"text-decoration":"none",display:"inline-block","text-align":"center"},attrs:{href:"https://paineldeprecos.planejamento.gov.br/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Consultar")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"banco-card"},[o("div",{staticClass:"banco-icon"},[a._v("ğŸ¢")]),o("h5",[a._v("Banco de PreÃ§os do TCE/MG")]),o("p",[a._v("Tribunal de Contas do Estado de Minas Gerais")]),o("a",{staticClass:"btn-primary",staticStyle:{"text-decoration":"none",display:"inline-block","text-align":"center"},attrs:{href:"https://bancodepreco.tce.mg.gov.br/#/login/ex",target:"_blank",rel:"noopener noreferrer"}},[a._v("Consultar")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-intro"},[o("h4",[a._v("Escolha uma minuta-padrÃ£o para criar o edital:")]),o("p",[a._v('Selecione uma das minutas-padrÃ£o disponÃ­veis. ApÃ³s a seleÃ§Ã£o, o novo edital ficarÃ¡ com o status "Em ElaboraÃ§Ã£o".')])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Impugnante")]),o("th",[a._v("Produto")]),o("th",[a._v("Data da ImpugnaÃ§Ã£o")]),o("th",[a._v("Prazo Final")]),o("th",[a._v("Status")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“ Produtos Prontos para CertificaÃ§Ã£o DCB")]),o("p",[a._v("Produtos aprovados pela CPM que ainda nÃ£o possuem DCB emitida.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“‹ HistÃ³rico de DCBs Emitidas")]),o("p",[a._v("Todos os certificados DCB emitidos pelo sistema.")])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("NÃºmero DCB")]),o("th",[a._v("Produto")]),o("th",[a._v("Marca")]),o("th",[a._v("Data EmissÃ£o")]),o("th",[a._v("Validade")]),o("th",[a._v("Status")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h3",[a._v("â° Controle de Vencimentos DCB")]),o("p",[a._v("Monitoramento de DCBs prestes a vencer ou jÃ¡ vencidas.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h2",[a._v("ğŸ‘¥ Cadastro de UsuÃ¡rios")]),o("p",[a._v("GestÃ£o de usuÃ¡rios autorizados a emitir RDMs no sistema")])])},function(){var a=this,o=a._self._c;return o("ul",[o("li",[a._v("Senha de acesso definitiva")]),o("li",[a._v("Link direto para o sistema")]),o("li",[a._v("InstruÃ§Ãµes de uso do Dashboard RDM")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h2",[a._v("ğŸ“¢ Registros de ReclamaÃ§Ãµes")]),o("p",[a._v("Gerenciamento de reclamaÃ§Ãµes pÃºblicas dos usuÃ¡rios")])])}],V=t(365);var G=function(){var a=this,o=a._self._c;return o("div",{staticClass:"pesquisa-bot"},[a._m(0),o("div",{staticClass:"search-form"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"produto"}},[a._v("Produto *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.produto,expression:"formData.produto"}],attrs:{id:"produto",type:"text",placeholder:"Ex: Luvas de procedimento, MÃ¡scara N95, etc.",required:""},domProps:{value:a.formData.produto},on:{input:function(o){o.target.composing||a.$set(a.formData,"produto",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"marca"}},[a._v("Marca *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.formData.marca,expression:"formData.marca"}],attrs:{id:"marca",type:"text",placeholder:"Ex: 3M, Medline, etc.",required:""},domProps:{value:a.formData.marca},on:{input:function(o){o.target.composing||a.$set(a.formData,"marca",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"especificacoes"}},[a._v("EspecificaÃ§Ãµes TÃ©cnicas (opcional)")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.formData.especificacoes,expression:"formData.especificacoes"}],attrs:{id:"especificacoes",placeholder:"Descreva especificaÃ§Ãµes tÃ©cnicas especÃ­ficas que deseja pesquisar...",rows:"3"},domProps:{value:a.formData.especificacoes},on:{input:function(o){o.target.composing||a.$set(a.formData,"especificacoes",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Categorias de Busca")]),o("div",{staticClass:"categories-grid"},a._l(a.categorias,(function(t){return o("div",{key:t.id,staticClass:"category-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.categoriasEscolhidas,expression:"categoriasEscolhidas"}],attrs:{id:t.id,type:"checkbox"},domProps:{value:t.id,checked:Array.isArray(a.categoriasEscolhidas)?a._i(a.categoriasEscolhidas,t.id)>-1:a.categoriasEscolhidas},on:{change:function(o){var e=a.categoriasEscolhidas,s=o.target,i=!!s.checked;if(Array.isArray(e)){var r=t.id,n=a._i(e,r);s.checked?n<0&&(a.categoriasEscolhidas=e.concat([r])):n>-1&&(a.categoriasEscolhidas=e.slice(0,n).concat(e.slice(n+1)))}else a.categoriasEscolhidas=i}}}),o("label",{attrs:{for:t.id}},[o("strong",[a._v(a._s(t.nome))]),o("span",[a._v(a._s(t.descricao))])])])})),0)]),o("div",{staticClass:"action-buttons"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.selecionarTodas}},[a._v(" Selecionar Todas ")]),o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.limparSelecao}},[a._v(" Limpar SeleÃ§Ã£o ")]),o("button",{staticClass:"btn-primary",attrs:{disabled:!a.podeRealizar||a.carregando},on:{click:a.buscarInformacoes}},[a.carregando?o("i",{staticClass:"fas fa-spinner fa-spin"}):o("i",{staticClass:"fas fa-search"}),a._v(" "+a._s(a.carregando?"Pesquisando...":"Pesquisar")+" ")])])]),a.carregando?o("div",{staticClass:"loading-status"},[o("div",{staticClass:"progress-info"},[o("p",[a._v(a._s(a.statusAtual))]),o("div",{staticClass:"progress-bar"},[o("div",{staticClass:"progress-fill",style:{width:a.progresso+"%"}})])])]):a._e(),a.resultados.length>0?o("div",{staticClass:"results-section"},[o("h3",[a._v("Resultados da Pesquisa")]),o("div",{staticClass:"consolidation-section"},[o("button",{staticClass:"btn-consolidate",attrs:{disabled:a.gerandoRelatorio},on:{click:a.gerarRelatorioConsolidado}},[a.gerandoRelatorio?o("i",{staticClass:"fas fa-spinner fa-spin"}):o("i",{staticClass:"fas fa-file-alt"}),a._v(" "+a._s(a.gerandoRelatorio?"Gerando RelatÃ³rio...":"Gerar RelatÃ³rio Consolidado")+" ")])]),a.relatorioConsolidado?o("div",{staticClass:"consolidated-report"},[o("h4",[a._v("RelatÃ³rio Consolidado")]),o("div",{staticClass:"report-content",domProps:{innerHTML:a._s(a.formatarTexto(a.relatorioConsolidado.relatorio))}}),o("div",{staticClass:"report-meta"},[o("small",[a._v("Gerado em: "+a._s(a.formatarData(a.relatorioConsolidado.timestamp)))])])]):a._e(),o("div",{staticClass:"results-grid"},a._l(a.resultados,(function(t){return o("div",{key:t.categoria,staticClass:"result-card"},[o("div",{staticClass:"result-header"},[o("h4",[a._v(a._s(a.getCategoriaInfo(t.categoria).nome))]),o("span",{staticClass:"result-timestamp"},[a._v(a._s(a.formatarData(t.timestamp)))])]),o("div",{staticClass:"result-content"},[o("div",{domProps:{innerHTML:a._s(a.formatarTexto(t.resultado))}})]),o("div",{staticClass:"result-sources"},[o("strong",[a._v("Fontes consultadas:")]),o("ul",a._l(a.getCategoriaInfo(t.categoria).fontes,(function(t){return o("li",{key:t},[a._v(" "+a._s(t)+" ")])})),0)])])})),0)]):a._e(),a.historico.length>0?o("div",{staticClass:"history-section"},[o("h3",[a._v("HistÃ³rico de Pesquisas")]),o("div",{staticClass:"history-list"},a._l(a.historico.slice(0,5),(function(t,e){return o("div",{key:e,staticClass:"history-item",on:{click:function(o){return a.carregarPesquisa(t)}}},[o("div",{staticClass:"history-info"},[o("strong",[a._v(a._s(t.produto)+" - "+a._s(t.marca))]),o("span",[a._v(a._s(a.formatarData(t.timestamp)))])]),o("div",{staticClass:"history-categories"},[a._v(" "+a._s(t.categorias.length)+" categoria(s) pesquisada(s) ")])])})),0)]):a._e()])},J=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"header"},[o("div",{staticClass:"icon"},[o("i",{staticClass:"fas fa-search"})]),o("div",{staticClass:"title"},[o("h2",[a._v("PesquisaBot")]),o("p",[a._v("Assistente especializado em pesquisas tÃ©cnicas de produtos")])])])}],H=t(6288);const Q="AIzaSyAf-Oe56q4Rao0OodEOtnEjtI_FpOmDg6I";class Z{constructor(){this.genAI=new H.ij(Q),this.model=this.genAI.getGenerativeModel({model:"gemini-1.5-flash"})}getCategoriasBusca(){return[{id:"manuais",nome:"Manuais do Fabricante",descricao:"Manuais tÃ©cnicos e de instruÃ§Ãµes do fabricante",fontes:["Sites oficiais dos fabricantes","Portais tÃ©cnicos","DocumentaÃ§Ã£o oficial"]},{id:"laudos",nome:"Laudos e Testes",descricao:"Laudos tÃ©cnicos e resultados de testes de funcionalidade",fontes:["LaboratÃ³rios certificados","Institutos de pesquisa","Ã“rgÃ£os reguladores"]},{id:"normas",nome:"Normas TÃ©cnicas",descricao:"Normas ABNT, NR e outras regulamentaÃ§Ãµes tÃ©cnicas",fontes:["ABNT","MinistÃ©rio do Trabalho","Ã“rgÃ£os reguladores setoriais"]},{id:"anvisa",nome:"InformaÃ§Ãµes ANVISA",descricao:"Registros, alertas e informaÃ§Ãµes da ANVISA",fontes:["Portal ANVISA","Sistema de notificaÃ§Ãµes","Boletins tÃ©cnicos"]},{id:"vigilancia",nome:"VigilÃ¢ncia SanitÃ¡ria",descricao:"InformaÃ§Ãµes de vigilÃ¢ncias sanitÃ¡rias estaduais e municipais",fontes:["Ã“rgÃ£os estaduais","VigilÃ¢ncias municipais","Sistemas de notificaÃ§Ã£o"]},{id:"reclamacoes",nome:"ReclamaÃ§Ãµes de UsuÃ¡rios",descricao:"ReclamaÃ§Ãµes e avaliaÃ§Ãµes de usuÃ¡rios sobre produtos",fontes:["Reclame Aqui","Procon","FÃ³runs especializados"]},{id:"recalls",nome:"Recalls e Alertas",descricao:"Recalls de produtos e alertas de seguranÃ§a",fontes:["Portal do Consumidor","INMETRO","Fabricantes"]},{id:"certificacoes",nome:"CertificaÃ§Ãµes",descricao:"CertificaÃ§Ãµes de qualidade e conformidade",fontes:["INMETRO","Organismos certificadores","ISO"]}]}gerarPromptEspecializado(a,o,t,e){const s={manuais:`\n        VocÃª Ã© um especialista em pesquisa tÃ©cnica de produtos. Preciso encontrar informaÃ§Ãµes sobre manuais do fabricante para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, forneÃ§a informaÃ§Ãµes detalhadas sobre:\n        1. Onde encontrar o manual oficial do fabricante\n        2. EspecificaÃ§Ãµes tÃ©cnicas principais\n        3. InstruÃ§Ãµes de uso e instalaÃ§Ã£o\n        4. Requisitos de manutenÃ§Ã£o\n        5. Garantias e condiÃ§Ãµes de uso\n        \n        Seja especÃ­fico e cite fontes confiÃ¡veis quando possÃ­vel.\n      `,laudos:`\n        VocÃª Ã© um especialista em anÃ¡lise tÃ©cnica de produtos. Preciso encontrar informaÃ§Ãµes sobre laudos e testes para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, forneÃ§a informaÃ§Ãµes sobre:\n        1. Laudos tÃ©cnicos disponÃ­veis\n        2. Testes de funcionalidade realizados\n        3. CertificaÃ§Ãµes de qualidade\n        4. Resultados de desempenho\n        5. LaboratÃ³rios que realizaram os testes\n        \n        Priorize informaÃ§Ãµes de fontes oficiais e laboratÃ³rios certificados.\n      `,normas:`\n        VocÃª Ã© um especialista em normas tÃ©cnicas. Preciso encontrar informaÃ§Ãµes sobre regulamentaÃ§Ãµes para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, identifique:\n        1. Normas ABNT aplicÃ¡veis\n        2. Normas Regulamentadoras (NR) relevantes\n        3. Outras regulamentaÃ§Ãµes tÃ©cnicas\n        4. Requisitos de conformidade\n        5. CertificaÃ§Ãµes obrigatÃ³rias\n        \n        Cite os nÃºmeros das normas e Ã³rgÃ£os responsÃ¡veis.\n      `,anvisa:`\n        VocÃª Ã© um especialista em regulamentaÃ§Ãµes sanitÃ¡rias. Preciso encontrar informaÃ§Ãµes da ANVISA sobre:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, pesquise:\n        1. Registro na ANVISA (se aplicÃ¡vel)\n        2. Alertas ou notificaÃ§Ãµes\n        3. RestriÃ§Ãµes de uso\n        4. ClassificaÃ§Ã£o de risco\n        5. HistÃ³rico de irregularidades\n        \n        Foque em informaÃ§Ãµes oficiais do portal da ANVISA.\n      `,vigilancia:`\n        VocÃª Ã© um especialista em vigilÃ¢ncia sanitÃ¡ria. Preciso encontrar informaÃ§Ãµes sobre:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, pesquise em vigilÃ¢ncias sanitÃ¡rias:\n        1. NotificaÃ§Ãµes estaduais\n        2. Alertas municipais\n        3. InterdiÃ§Ãµes ou apreensÃµes\n        4. Irregularidades encontradas\n        5. Medidas cautelares\n        \n        Inclua informaÃ§Ãµes de diferentes estados quando relevante.\n      `,reclamacoes:`\n        VocÃª Ã© um especialista em anÃ¡lise de satisfaÃ§Ã£o do consumidor. Preciso encontrar informaÃ§Ãµes sobre reclamaÃ§Ãµes para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, analise:\n        1. Principais reclamaÃ§Ãµes dos usuÃ¡rios\n        2. Problemas mais frequentes\n        3. AvaliaÃ§Ãµes e notas\n        4. ResoluÃ§Ãµes de problemas\n        5. TendÃªncias de satisfaÃ§Ã£o\n        \n        Use fontes como Reclame Aqui, Procon e fÃ³runs especializados.\n      `,recalls:`\n        VocÃª Ã© um especialista em seguranÃ§a de produtos. Preciso encontrar informaÃ§Ãµes sobre recalls para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, pesquise:\n        1. Recalls oficiais\n        2. Alertas de seguranÃ§a\n        3. Defeitos identificados\n        4. Medidas corretivas\n        5. Cronograma de correÃ§Ãµes\n        \n        Priorize informaÃ§Ãµes do Portal do Consumidor e INMETRO.\n      `,certificacoes:`\n        VocÃª Ã© um especialista em certificaÃ§Ãµes de qualidade. Preciso encontrar informaÃ§Ãµes sobre certificaÃ§Ãµes para:\n        \n        Produto: ${o}\n        Marca: ${t}\n        EspecificaÃ§Ãµes: ${e}\n        \n        Por favor, identifique:\n        1. CertificaÃ§Ãµes de qualidade\n        2. Selos de conformidade\n        3. Organismos certificadores\n        4. Validade das certificaÃ§Ãµes\n        5. Processos de certificaÃ§Ã£o\n        \n        Foque em certificaÃ§Ãµes oficiais e reconhecidas.\n      `};return s[a]||s.manuais}async buscarInformacoesTecnicas(a,o,t,e=""){try{console.log(`ğŸ” PesquisaService: Iniciando busca para categoria ${a}`);const s=this.gerarPromptEspecializado(a,o,t,e);console.log(`ğŸ“ PesquisaService: Prompt gerado para ${a}:`,s.substring(0,200)+"..."),console.log("ğŸ¤– PesquisaService: Enviando para Gemini API...");const i=await this.model.generateContent(s),r=await i.response,n=r.text();return console.log(`âœ… PesquisaService: Resposta recebida para ${a}:`,n.substring(0,200)+"..."),{success:!0,categoria:a,produto:o,marca:t,resultado:n,timestamp:(new Date).toISOString()}}catch(s){return console.error(`âŒ PesquisaService: Erro na busca tÃ©cnica para ${a}:`,s),{success:!1,error:s.message,categoria:a,produto:o,marca:t}}}async buscarMultiplasCategorias(a,o,t,e=""){const s=a.map((a=>this.buscarInformacoesTecnicas(a,o,t,e)));try{const a=await Promise.all(s);return{success:!0,produto:o,marca:t,resultados:a.filter((a=>a.success)),erros:a.filter((a=>!a.success))}}catch(i){return console.error("Erro na busca mÃºltipla:",i),{success:!1,error:i.message,produto:o,marca:t}}}async gerarRelatorioConsolidado(a,o,t=""){const e=this.getCategoriasBusca().map((a=>a.id)),s=await this.buscarMultiplasCategorias(e,a,o,t);if(s.success){const t=`\n        VocÃª Ã© um especialista em anÃ¡lise tÃ©cnica de produtos. Com base nas informaÃ§Ãµes coletadas sobre o produto "${a}" da marca "${o}", gere um relatÃ³rio consolidado que inclua:\n        \n        1. RESUMO EXECUTIVO\n        2. ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS\n        3. CONFORMIDADE REGULATÃ“RIA\n        4. QUALIDADE E CERTIFICAÃ‡Ã•ES\n        5. HISTÃ“RICO DE PROBLEMAS\n        6. RECOMENDAÃ‡Ã•ES\n        \n        InformaÃ§Ãµes coletadas:\n        ${s.resultados.map((a=>`\n=== ${a.categoria.toUpperCase()} ===\n${a.resultado}`)).join("\n")}\n        \n        Organize as informaÃ§Ãµes de forma clara e profissional, destacando pontos importantes para a prÃ©-qualificaÃ§Ã£o de bens.\n      `;try{const e=await this.model.generateContent(t),i=await e.response,r=i.text();return{success:!0,produto:a,marca:o,relatorio:r,detalhes:s.resultados,timestamp:(new Date).toISOString()}}catch(i){return{success:!0,produto:a,marca:o,relatorio:"Erro ao gerar relatÃ³rio consolidado",detalhes:s.resultados,timestamp:(new Date).toISOString()}}}return s}}const Y=new Z,X={name:"PesquisaBot",data(){return{formData:{produto:"",marca:"",especificacoes:""},categorias:[],categoriasEscolhidas:[],resultados:[],relatorioConsolidado:null,historico:[],carregando:!1,gerandoRelatorio:!1,statusAtual:"",progresso:0}},computed:{podeRealizar(){return this.formData.produto.trim()&&this.formData.marca.trim()&&this.categoriasEscolhidas.length>0}},mounted(){this.carregarCategorias(),this.carregarHistorico()},methods:{carregarCategorias(){this.categorias=Y.getCategoriasBusca(),this.categoriasEscolhidas=["manuais","laudos","normas"]},carregarHistorico(){const a=localStorage.getItem("pesquisa-historico");a&&(this.historico=JSON.parse(a))},salvarHistorico(){localStorage.setItem("pesquisa-historico",JSON.stringify(this.historico))},selecionarTodas(){this.categoriasEscolhidas=this.categorias.map((a=>a.id))},limparSelecao(){this.categoriasEscolhidas=[]},async buscarInformacoes(){if(this.podeRealizar){this.carregando=!0,this.resultados=[],this.relatorioConsolidado=null,this.progresso=0,console.log("ğŸ” Iniciando pesquisa:",{produto:this.formData.produto,marca:this.formData.marca,categorias:this.categoriasEscolhidas});try{const a=this.categoriasEscolhidas.length;let o=0;this.statusAtual="Iniciando pesquisa...";const t=this.categoriasEscolhidas.map((async t=>{this.statusAtual=`Pesquisando ${this.getCategoriaInfo(t).nome}...`,console.log(`ğŸ” Pesquisando categoria: ${t}`);const e=await Y.buscarInformacoesTecnicas(t,this.formData.produto,this.formData.marca,this.formData.especificacoes);return console.log(`ğŸ“Š Resultado da categoria ${t}:`,e),o++,this.progresso=o/a*100,e})),e=await Promise.all(t);console.log("ğŸ“‹ Todos os resultados:",e),this.resultados=e.filter((a=>a.success)),console.log("âœ… Resultados filtrados (success):",this.resultados),this.historico.unshift({produto:this.formData.produto,marca:this.formData.marca,especificacoes:this.formData.especificacoes,categorias:this.categoriasEscolhidas,timestamp:(new Date).toISOString(),resultados:this.resultados.length}),this.historico=this.historico.slice(0,10),this.salvarHistorico(),this.statusAtual="Pesquisa concluÃ­da!",0===this.resultados.length&&(console.warn("âš ï¸ Nenhum resultado encontrado"),this.$swal({title:"âš ï¸ Aviso",text:"Nenhum resultado encontrado. Verifique sua conexÃ£o com a internet ou tente novamente.",icon:"warning"}))}catch(a){console.error("âŒ Erro na pesquisa:",a),this.statusAtual="Erro na pesquisa. Tente novamente.",this.$swal({title:"âŒ Erro",text:"Erro na pesquisa: "+a.message,icon:"error"})}finally{this.carregando=!1,setTimeout((()=>{this.statusAtual="",this.progresso=0}),2e3)}}},async gerarRelatorioConsolidado(){if(0!==this.resultados.length){this.gerandoRelatorio=!0;try{const a=await Y.gerarRelatorioConsolidado(this.formData.produto,this.formData.marca,this.formData.especificacoes);a.success&&(this.relatorioConsolidado=a)}catch(a){console.error("Erro ao gerar relatÃ³rio:",a)}finally{this.gerandoRelatorio=!1}}},getCategoriaInfo(a){return this.categorias.find((o=>o.id===a))||{}},formatarTexto(a){return a?a.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/(\d+\.)/g,"<br><strong>$1</strong>"):""},formatarData(a){return new Date(a).toLocaleString("pt-BR")},carregarPesquisa(a){this.formData.produto=a.produto,this.formData.marca=a.marca,this.formData.especificacoes=a.especificacoes,this.categoriasEscolhidas=[...a.categorias]},limparFormulario(){this.formData={produto:"",marca:"",especificacoes:""},this.categoriasEscolhidas=["manuais","laudos","normas"],this.resultados=[],this.relatorioConsolidado=null}}},K=X;var W=(0,C.A)(K,G,J,!1,null,"0a824c4e",null);const aa=W.exports;var oa=function(){var a=this,o=a._self._c;return o("div",{staticClass:"gerenciador-cotacoes"},[o("div",{staticClass:"cotacoes-header"},[a._m(0),o("div",{staticClass:"header-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaCotacao}},[a._v(" â• Nova CotaÃ§Ã£o ")]),o("button",{staticClass:"btn-secondary",on:{click:a.exportarCotacoes}},[a._v(" ğŸ“¤ Exportar ")])])]),o("div",{staticClass:"cotacoes-filtros"},[o("div",{staticClass:"filtros-row"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Produto, fornecedor ou CNPJ..."},domProps:{value:a.filtros.busca},on:{input:function(o){o.target.composing||a.$set(a.filtros,"busca",o.target.value)}}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"ativa"}},[a._v("Ativa")]),o("option",{attrs:{value:"vencida"}},[a._v("Vencida")]),o("option",{attrs:{value:"aceita"}},[a._v("Aceita")]),o("option",{attrs:{value:"cancelada"}},[a._v("Cancelada")])])]),o("div",{staticClass:"filtro-group-periodo"},[o("label",[a._v("PerÃ­odo:")]),o("div",{staticClass:"periodo-inputs"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataInicio",o.target.value)}}}),o("span",{staticClass:"periodo-separador"},[a._v("atÃ©")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataFim",o.target.value)}}})])]),o("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar ")])])]),a.loading?o("div",{staticClass:"loading-container"},[o("div",{staticClass:"loading-spinner"}),o("p",[a._v("Carregando cotaÃ§Ãµes...")])]):o("div",{staticClass:"cotacoes-container"},[0!==a.cotacoesFiltradas.length||a.temFiltrosAplicados?0===a.cotacoesFiltradas.length&&a.temFiltrosAplicados?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ”")]),o("h3",[a._v("Nenhuma cotaÃ§Ã£o encontrada")]),o("p",[a._v("Nenhuma cotaÃ§Ã£o corresponde aos filtros aplicados.")]),o("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar Filtros ")])]):o("div",{staticClass:"cotacoes-grid"},a._l(a.cotacoesFiltradas,(function(t){return o("div",{key:t.id,staticClass:"cotacao-card",class:{vencida:a.isCotacaoVencida(t),aceita:"aceita"===t.status}},[o("div",{staticClass:"cotacao-header"},[o("div",{staticClass:"cotacao-info"},[o("h5",[a._v(a._s(t.produto_nome))]),o("div",{staticClass:"cotacao-meta"},[o("span",{staticClass:"data"},[a._v(a._s(a.formatDate(t.data_cotacao)))]),o("span",{staticClass:"status",class:t.status},[a._v(a._s(a.getStatusLabel(t.status)))])])]),o("div",{staticClass:"cotacao-preco"},[o("div",{staticClass:"preco-unitario"},[a._v(a._s(a.formatCurrency(t.preco_unitario)))]),t.preco_total?o("div",{staticClass:"preco-total"},[a._v(" Total: "+a._s(a.formatCurrency(t.preco_total))+" ")]):a._e()])]),o("div",{staticClass:"cotacao-body"},[o("div",{staticClass:"fornecedor-info"},[o("p",[o("strong",[a._v("Fornecedor:")]),a._v(" "+a._s(t.fornecedor_nome))]),t.fornecedor_cnpj?o("p",[o("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.formatCNPJ(t.fornecedor_cnpj)))]):a._e(),t.quantidade?o("p",[o("strong",[a._v("Quantidade:")]),a._v(" "+a._s(t.quantidade)+" "+a._s(t.unidade_medida))]):a._e()]),o("div",{staticClass:"condicoes-info"},[t.prazo_entrega?o("p",[o("strong",[a._v("Prazo:")]),a._v(" "+a._s(t.prazo_entrega)+" dias")]):a._e(),t.data_validade?o("p",[o("strong",[a._v("VÃ¡lida atÃ©:")]),a._v(" "+a._s(a.formatDate(t.data_validade)))]):a._e(),t.condicoes_pagamento?o("p",[o("strong",[a._v("AssistÃªncia TÃ©cnica:")]),a._v(" "+a._s(t.condicoes_pagamento))]):a._e()])]),o("div",{staticClass:"cotacao-actions"},[o("button",{staticClass:"btn-small",on:{click:function(o){return a.visualizarCotacao(t)}}},[a._v("ğŸ‘ï¸ Ver")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.editarCotacao(t)}}},[a._v("âœï¸ Editar")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.duplicarCotacao(t)}}},[a._v("ğŸ“‹ Duplicar")]),"ativa"===t.status?o("button",{staticClass:"btn-small btn-success",on:{click:function(o){return a.aceitarCotacao(t)}}},[a._v(" âœ… Aceitar ")]):a._e(),o("button",{staticClass:"btn-small btn-danger",on:{click:function(o){return a.removerCotacao(t)}}},[a._v("ğŸ—‘ï¸ Remover")])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ’°")]),o("h3",[a._v("Nenhuma cotaÃ§Ã£o registrada")]),o("p",[a._v("Comece registrando cotaÃ§Ãµes de fornecedores para anÃ¡lise tÃ©cnica e padronizaÃ§Ã£o de produtos.")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaCotacao}},[a._v(" â• Registrar CotaÃ§Ã£o ")])])]),a.modalCotacao.show?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalCotacao}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.modalCotacao.editando?"âœï¸ Editar CotaÃ§Ã£o":"â• Nova CotaÃ§Ã£o"))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalCotacao}},[a._v("âœ•")])]),o("div",{staticClass:"modal-body"},[o("form",{staticClass:"form-cotacao",on:{submit:function(o){return o.preventDefault(),a.salvarCotacao.apply(null,arguments)}}},[o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ“¦ Dados do Produto")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Produto*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_nome,expression:"cotacaoForm.produto_nome"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Notebook Dell Inspiron 15"},domProps:{value:a.cotacaoForm.produto_nome},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"produto_nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Unidade")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.unidade_medida,expression:"cotacaoForm.unidade_medida"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.cotacaoForm,"unidade_medida",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"UN"}},[a._v("Unidade")]),o("option",{attrs:{value:"CX"}},[a._v("Caixa")]),o("option",{attrs:{value:"KG"}},[a._v("Quilograma")]),o("option",{attrs:{value:"LT"}},[a._v("Litro")]),o("option",{attrs:{value:"MT"}},[a._v("Metro")]),o("option",{attrs:{value:"M2"}},[a._v("MetroÂ²")]),o("option",{attrs:{value:"M3"}},[a._v("MetroÂ³")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Quantidade")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.quantidade,expression:"cotacaoForm.quantidade",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",step:"0.01"},domProps:{value:a.cotacaoForm.quantidade},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"quantidade",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_descricao,expression:"cotacaoForm.produto_descricao"}],staticClass:"textarea-field",attrs:{rows:"2",placeholder:"DescriÃ§Ã£o detalhada do produto..."},domProps:{value:a.cotacaoForm.produto_descricao},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"produto_descricao",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("EspecificaÃ§Ã£o TÃ©cnica")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.produto_especificacao,expression:"cotacaoForm.produto_especificacao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"EspecificaÃ§Ãµes tÃ©cnicas detalhadas..."},domProps:{value:a.cotacaoForm.produto_especificacao},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"produto_especificacao",o.target.value)}}})])])]),o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ¢ Dados do Fornecedor")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Fornecedor*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_nome,expression:"cotacaoForm.fornecedor_nome"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Dell Computadores do Brasil Ltda"},domProps:{value:a.cotacaoForm.fornecedor_nome},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"fornecedor_nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("CNPJ")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_cnpj,expression:"cotacaoForm.fornecedor_cnpj"}],staticClass:"input-field",attrs:{type:"text",placeholder:"00.000.000/0000-00"},domProps:{value:a.cotacaoForm.fornecedor_cnpj},on:{input:[function(o){o.target.composing||a.$set(a.cotacaoForm,"fornecedor_cnpj",o.target.value)},a.formatarCNPJ]}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Contato")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_contato,expression:"cotacaoForm.fornecedor_contato"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Nome do contato"},domProps:{value:a.cotacaoForm.fornecedor_contato},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"fornecedor_contato",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Telefone")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_telefone,expression:"cotacaoForm.fornecedor_telefone"}],staticClass:"input-field",attrs:{type:"text",placeholder:"(00) 0000-0000"},domProps:{value:a.cotacaoForm.fornecedor_telefone},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"fornecedor_telefone",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("E-mail")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.fornecedor_email,expression:"cotacaoForm.fornecedor_email"}],staticClass:"input-field",attrs:{type:"email",placeholder:"contato@fornecedor.com"},domProps:{value:a.cotacaoForm.fornecedor_email},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"fornecedor_email",o.target.value)}}})])])]),o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ’° Dados Comerciais")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("PreÃ§o UnitÃ¡rio*")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.preco_unitario,expression:"cotacaoForm.preco_unitario",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",step:"0.01",required:"",placeholder:"0,00"},domProps:{value:a.cotacaoForm.preco_unitario},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"preco_unitario",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Prazo Entrega (dias)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.prazo_entrega,expression:"cotacaoForm.prazo_entrega",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"0",placeholder:"Ex: 15"},domProps:{value:a.cotacaoForm.prazo_entrega},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"prazo_entrega",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Validade (dias)")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.cotacaoForm.validade_cotacao,expression:"cotacaoForm.validade_cotacao",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",min:"1",placeholder:"30"},domProps:{value:a.cotacaoForm.validade_cotacao},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"validade_cotacao",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("AssistÃªncia TÃ©cnica (Prestador e EndereÃ§o)")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.condicoes_pagamento,expression:"cotacaoForm.condicoes_pagamento"}],staticClass:"textarea-field",attrs:{rows:"2",placeholder:"Ex: Autorizada Brand Tech - Rua das Flores, 123, SÃ£o Paulo/SP | Especializada MultiServ - Av. Central, 456, Rio de Janeiro/RJ..."},domProps:{value:a.cotacaoForm.condicoes_pagamento},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"condicoes_pagamento",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("ObservaÃ§Ãµes")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.cotacaoForm.observacoes,expression:"cotacaoForm.observacoes"}],staticClass:"textarea-field",attrs:{rows:"4",placeholder:"InformaÃ§Ãµes tÃ©cnicas, assistÃªncia tÃ©cnica, garantias, condiÃ§Ãµes especiais, qualidade, aspectos estÃ©ticos... (Foco em anÃ¡lise tÃ©cnica para padronizaÃ§Ã£o, nÃ£o apenas preÃ§o)"},domProps:{value:a.cotacaoForm.observacoes},on:{input:function(o){o.target.composing||a.$set(a.cotacaoForm,"observacoes",o.target.value)}}})])])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalCotacao}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoCotacao},on:{click:a.salvarCotacao}},[a._v(" "+a._s(a.salvandoCotacao?"Salvando...":"Salvar CotaÃ§Ã£o")+" ")])])])]):a._e()])},ta=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"header-info"},[o("h4",[a._v("ğŸ’° Gerenciamento de CotaÃ§Ãµes")]),o("p",[a._v("Registre e gerencie cotaÃ§Ãµes de fornecedores para anÃ¡lise tÃ©cnica e padronizaÃ§Ã£o de marcas e modelos. Foco em informaÃ§Ãµes tÃ©cnicas, qualidade e assistÃªncia tÃ©cnica para seleÃ§Ã£o rigorosa de produtos.")])])}];const ea={name:"GerenciadorCotacoes",data(){return{cotacoes:[],loading:!1,salvandoCotacao:!1,filtros:{busca:"",status:"",dataInicio:"",dataFim:""},modalCotacao:{show:!1,editando:!1},cotacaoForm:{id:null,produto_nome:"",produto_descricao:"",produto_especificacao:"",unidade_medida:"UN",quantidade:null,fornecedor_nome:"",fornecedor_cnpj:"",fornecedor_contato:"",fornecedor_telefone:"",fornecedor_email:"",preco_unitario:null,prazo_entrega:null,validade_cotacao:30,condicoes_pagamento:"",observacoes:""}}},computed:{cotacoesFiltradas(){let a=[...this.cotacoes];if(this.filtros.busca){const o=this.filtros.busca.toLowerCase();a=a.filter((a=>a.produto_nome.toLowerCase().includes(o)||a.fornecedor_nome.toLowerCase().includes(o)||a.fornecedor_cnpj&&a.fornecedor_cnpj.includes(o)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.dataInicio&&(a=a.filter((a=>a.data_cotacao>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.data_cotacao<=this.filtros.dataFim))),a.sort(((a,o)=>new Date(o.data_cotacao)-new Date(a.data_cotacao)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.dataInicio||this.filtros.dataFim}},async mounted(){await this.carregarCotacoes()},methods:{async carregarCotacoes(){this.loading=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const{data:o,error:t}=await N.ND.from("cotacoes").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(t)throw t;this.cotacoes=o||[]}catch(a){console.error("Erro ao carregar cotaÃ§Ãµes:",a),this.$swal({title:"Erro",text:"Erro ao carregar cotaÃ§Ãµes: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovaCotacao(){this.modalCotacao.show=!0,this.modalCotacao.editando=!1,this.resetarFormulario()},fecharModalCotacao(){this.modalCotacao.show=!1,this.resetarFormulario()},resetarFormulario(){this.cotacaoForm={id:null,produto_nome:"",produto_descricao:"",produto_especificacao:"",unidade_medida:"UN",quantidade:null,fornecedor_nome:"",fornecedor_cnpj:"",fornecedor_contato:"",fornecedor_telefone:"",fornecedor_email:"",preco_unitario:null,prazo_entrega:null,validade_cotacao:30,condicoes_pagamento:"",observacoes:""}},async salvarCotacao(){this.salvandoCotacao=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const o={...this.cotacaoForm,tenant_id:a};if(this.modalCotacao.editando){const{error:a}=await N.ND.from("cotacoes").update(o).eq("id",this.cotacaoForm.id);if(a)throw a}else{delete o.id;const{error:a}=await N.ND.from("cotacoes").insert([o]);if(a)throw a}this.$swal({title:"Sucesso!",text:`CotaÃ§Ã£o ${this.modalCotacao.editando?"atualizada":"registrada"} com sucesso`,icon:"success",timer:2e3}),await this.carregarCotacoes(),this.fecharModalCotacao()}catch(a){console.error("Erro ao salvar cotaÃ§Ã£o:",a),this.$swal({title:"Erro",text:"Erro ao salvar cotaÃ§Ã£o: "+a.message,icon:"error"})}finally{this.salvandoCotacao=!1}},editarCotacao(a){this.cotacaoForm={...a},this.modalCotacao.show=!0,this.modalCotacao.editando=!0},async removerCotacao(a){const o=await this.$swal({title:"Confirmar exclusÃ£o",text:`Deseja realmente remover a cotaÃ§Ã£o de "${a.produto_nome}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("cotacoes").delete().eq("id",a.id);if(o)throw o;this.$swal({title:"Removida!",text:"CotaÃ§Ã£o removida com sucesso",icon:"success",timer:2e3}),await this.carregarCotacoes()}catch(t){console.error("Erro ao remover cotaÃ§Ã£o:",t),this.$swal({title:"Erro",text:"Erro ao remover cotaÃ§Ã£o: "+t.message,icon:"error"})}},visualizarCotacao(a){this.$swal({title:`CotaÃ§Ã£o: ${a.produto_nome}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>ğŸ“¦ Produto</h4>\n            <p><strong>Nome:</strong> ${a.produto_nome}</p>\n            ${a.produto_descricao?`<p><strong>DescriÃ§Ã£o:</strong> ${a.produto_descricao}</p>`:""}\n            ${a.quantidade?`<p><strong>Quantidade:</strong> ${a.quantidade} ${a.unidade_medida}</p>`:""}\n            \n            <h4>ğŸ¢ Fornecedor</h4>\n            <p><strong>Nome:</strong> ${a.fornecedor_nome}</p>\n            ${a.fornecedor_cnpj?`<p><strong>CNPJ:</strong> ${this.formatCNPJ(a.fornecedor_cnpj)}</p>`:""}\n            ${a.fornecedor_contato?`<p><strong>Contato:</strong> ${a.fornecedor_contato}</p>`:""}\n            \n            <h4>ğŸ’° Comercial</h4>\n            <p><strong>PreÃ§o UnitÃ¡rio:</strong> ${this.formatCurrency(a.preco_unitario)}</p>\n            ${a.preco_total?`<p><strong>PreÃ§o Total:</strong> ${this.formatCurrency(a.preco_total)}</p>`:""}\n            ${a.prazo_entrega?`<p><strong>Prazo:</strong> ${a.prazo_entrega} dias</p>`:""}\n            ${a.data_validade?`<p><strong>VÃ¡lida atÃ©:</strong> ${this.formatDate(a.data_validade)}</p>`:""}\n            ${a.condicoes_pagamento?`<p><strong>AssistÃªncia TÃ©cnica:</strong> ${a.condicoes_pagamento}</p>`:""}\n            ${a.observacoes?`<p><strong>ObservaÃ§Ãµes:</strong> ${a.observacoes}</p>`:""}\n          </div>\n        `,width:"600px",confirmButtonText:"Fechar"})},duplicarCotacao(a){this.cotacaoForm={...a,id:null,produto_nome:a.produto_nome+" (CÃ³pia)"},this.modalCotacao.show=!0,this.modalCotacao.editando=!1},async aceitarCotacao(a){const o=await this.$swal({title:"Aceitar CotaÃ§Ã£o",text:`Deseja aceitar a cotaÃ§Ã£o de "${a.produto_nome}" de ${a.fornecedor_nome}?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, aceitar",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("cotacoes").update({status:"aceita"}).eq("id",a.id);if(o)throw o;this.$swal({title:"Aceita!",text:"CotaÃ§Ã£o aceita com sucesso",icon:"success",timer:2e3}),await this.carregarCotacoes()}catch(t){console.error("Erro ao aceitar cotaÃ§Ã£o:",t),this.$swal({title:"Erro",text:"Erro ao aceitar cotaÃ§Ã£o: "+t.message,icon:"error"})}},limparFiltros(){this.filtros={busca:"",status:"",dataInicio:"",dataFim:""}},async exportarCotacoes(){try{if(0===this.cotacoesFiltradas.length)return void this.$swal({title:"AtenÃ§Ã£o",text:"NÃ£o hÃ¡ cotaÃ§Ãµes para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"ğŸ“¤ Exportar CotaÃ§Ãµes",text:`Exportar ${this.cotacoesFiltradas.length} cotaÃ§Ã£o(Ãµes). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ“Š Excel (.xlsx)",cancelButtonText:"ğŸ“„ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportCotacoes:o}=await t.e(913).then(t.bind(t,1913)),e=a?"excel":"csv";await o(this.cotacoesFiltradas,e),this.$swal({title:"Sucesso!",text:`${this.cotacoesFiltradas.length} cotaÃ§Ã£o(Ãµes) exportada(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar cotaÃ§Ãµes:",a),this.$swal({title:"Erro",text:"Erro ao exportar cotaÃ§Ãµes: "+a.message,icon:"error"})}},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},formatCNPJ(a){return a?a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatarCNPJ(a){let o=a.target.value.replace(/\D/g,"");o=o.replace(/^(\d{2})(\d)/,"$1.$2"),o=o.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),o=o.replace(/\.(\d{3})(\d)/,".$1/$2"),o=o.replace(/(\d{4})(\d)/,"$1-$2"),a.target.value=o,this.cotacaoForm.fornecedor_cnpj=o},getStatusLabel(a){const o={ativa:"Ativa",vencida:"Vencida",aceita:"Aceita",cancelada:"Cancelada"};return o[a]||a},isCotacaoVencida(a){return!!a.data_validade&&new Date(a.data_validade)<new Date}}},sa=ea;var ia=(0,C.A)(sa,oa,ta,!1,null,"3480e4c7",null);const ra=ia.exports;var na=function(){var a=this,o=a._self._c;return o("div",{staticClass:"gerenciador-comparativo"},[o("div",{staticClass:"comparativo-header"},[a._m(0),o("div",{staticClass:"header-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoComparativo}},[a._v(" â• Novo Comparativo ")]),o("button",{staticClass:"btn-secondary",on:{click:a.exportarComparativos}},[a._v(" ğŸ“¤ Exportar ")])])]),o("div",{staticClass:"comparativo-filtros"},[o("div",{staticClass:"filtros-row"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"TÃ­tulo, categoria ou descriÃ§Ã£o..."},domProps:{value:a.filtros.busca},on:{input:function(o){o.target.composing||a.$set(a.filtros,"busca",o.target.value)}}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"em_andamento"}},[a._v("Em Andamento")]),o("option",{attrs:{value:"finalizado"}},[a._v("Finalizado")]),o("option",{attrs:{value:"cancelado"}},[a._v("Cancelado")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("Tipo:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"tipo",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"tecnico"}},[a._v("TÃ©cnico")]),o("option",{attrs:{value:"preco"}},[a._v("PreÃ§o")]),o("option",{attrs:{value:"completo"}},[a._v("Completo")])])]),o("div",{staticClass:"filtro-group-periodo"},[o("label",[a._v("PerÃ­odo:")]),o("div",{staticClass:"periodo-inputs"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataInicio",o.target.value)}}}),o("span",{staticClass:"periodo-separador"},[a._v("atÃ©")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataFim",o.target.value)}}})])]),o("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar ")])])]),a.loading?o("div",{staticClass:"loading-container"},[o("div",{staticClass:"loading-spinner"}),o("p",[a._v("Carregando comparativos...")])]):o("div",{staticClass:"comparativos-container"},[0!==a.comparativosFiltrados.length||a.temFiltrosAplicados?0===a.comparativosFiltrados.length&&a.temFiltrosAplicados?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ”")]),o("h3",[a._v("Nenhum comparativo encontrado")]),o("p",[a._v("Nenhum comparativo corresponde aos filtros aplicados.")]),o("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar Filtros ")])]):o("div",{staticClass:"comparativos-grid"},a._l(a.comparativosFiltrados,(function(t){return o("div",{key:t.id,staticClass:"comparativo-card",class:{finalizado:"finalizado"===t.status,cancelado:"cancelado"===t.status,vencido:a.isComparativoVencido(t)}},[o("div",{staticClass:"comparativo-header-card"},[o("div",{staticClass:"comparativo-info"},[o("h5",[a._v(a._s(t.titulo))]),o("div",{staticClass:"comparativo-meta"},[o("span",{staticClass:"categoria"},[a._v(a._s(t.categoria||"Sem categoria"))]),o("span",{staticClass:"data"},[a._v(a._s(a.formatDate(t.data_inicio)))]),o("span",{staticClass:"status",class:t.status},[a._v(a._s(a.getStatusLabel(t.status)))])])]),o("div",{staticClass:"comparativo-stats"},[o("div",{staticClass:"stat"},[o("span",{staticClass:"number"},[a._v(a._s(a.getItensCount(t.id)))]),o("span",{staticClass:"label"},[a._v("Itens")])])])]),o("div",{staticClass:"comparativo-body"},[o("div",{staticClass:"comparativo-desc"},[t.descricao?o("p",[a._v(a._s(a.truncateText(t.descricao,100)))]):o("p",{staticClass:"sem-descricao"},[a._v("Sem descriÃ§Ã£o")])]),o("div",{staticClass:"comparativo-detalhes"},[o("div",{staticClass:"detalhe"},[o("strong",[a._v("Tipo:")]),a._v(" "+a._s(a.getTipoLabel(t.tipo_comparativo))+" ")]),t.prazo_resposta?o("div",{staticClass:"detalhe"},[o("strong",[a._v("Prazo:")]),a._v(" "+a._s(a.formatDate(t.prazo_resposta))+" ")]):a._e(),t.metodologia?o("div",{staticClass:"detalhe"},[o("strong",[a._v("Metodologia:")]),a._v(" "+a._s(a.getMetodologiaLabel(t.metodologia))+" ")]):a._e()])]),o("div",{staticClass:"comparativo-actions"},[o("button",{staticClass:"btn-small",on:{click:function(o){return a.visualizarComparativo(t)}}},[a._v("ğŸ‘ï¸ Ver")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.editarComparativo(t)}}},[a._v("âœï¸ Editar")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.gerenciarItens(t)}}},[a._v("ğŸ“‹ Itens")]),"em_andamento"===t.status?o("button",{staticClass:"btn-small btn-success",on:{click:function(o){return a.finalizarComparativo(t)}}},[a._v(" âœ… Finalizar ")]):a._e(),o("button",{staticClass:"btn-small",on:{click:function(o){return a.duplicarComparativo(t)}}},[a._v("ğŸ“‹ Duplicar")]),o("button",{staticClass:"btn-small btn-danger",on:{click:function(o){return a.removerComparativo(t)}}},[a._v("ğŸ—‘ï¸ Remover")])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“Š")]),o("h3",[a._v("Nenhum comparativo registrado")]),o("p",[a._v("Comece criando comparativos tÃ©cnicos para anÃ¡lise detalhada de produtos e fornecedores.")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoComparativo}},[a._v(" â• Criar Primeiro Comparativo ")])])]),a.modalComparativo.show?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalComparativo}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.modalComparativo.editando?"âœï¸ Editar Comparativo":"â• Novo Comparativo"))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalComparativo}},[a._v("âœ•")])]),o("div",{staticClass:"modal-body"},[o("form",{staticClass:"form-comparativo",on:{submit:function(o){return o.preventDefault(),a.salvarComparativo.apply(null,arguments)}}},[o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ“‹ Dados BÃ¡sicos")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("TÃ­tulo do Comparativo*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.titulo,expression:"comparativoForm.titulo"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: Comparativo Notebooks Dell vs HP"},domProps:{value:a.comparativoForm.titulo},on:{input:function(o){o.target.composing||a.$set(a.comparativoForm,"titulo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Categoria")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.categoria,expression:"comparativoForm.categoria"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Ex: InformÃ¡tica, MÃ³veis, VeÃ­culos"},domProps:{value:a.comparativoForm.categoria},on:{input:function(o){o.target.composing||a.$set(a.comparativoForm,"categoria",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.descricao,expression:"comparativoForm.descricao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"Descreva o objetivo e escopo do comparativo..."},domProps:{value:a.comparativoForm.descricao},on:{input:function(o){o.target.composing||a.$set(a.comparativoForm,"descricao",o.target.value)}}})])])]),o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("âš™ï¸ ConfiguraÃ§Ãµes")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Tipo de Comparativo*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.tipo_comparativo,expression:"comparativoForm.tipo_comparativo"}],staticClass:"select-field",attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.comparativoForm,"tipo_comparativo",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"tecnico"}},[a._v("TÃ©cnico")]),o("option",{attrs:{value:"preco"}},[a._v("PreÃ§o")]),o("option",{attrs:{value:"completo"}},[a._v("Completo")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Metodologia")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.metodologia,expression:"comparativoForm.metodologia"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.comparativoForm,"metodologia",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"matriz_decisao"}},[a._v("Matriz de DecisÃ£o")]),o("option",{attrs:{value:"ranking"}},[a._v("Ranking Ponderado")]),o("option",{attrs:{value:"pontuacao"}},[a._v("Sistema de PontuaÃ§Ã£o")])])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Data de InÃ­cio")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.data_inicio,expression:"comparativoForm.data_inicio"}],staticClass:"input-field",attrs:{type:"date"},domProps:{value:a.comparativoForm.data_inicio},on:{input:function(o){o.target.composing||a.$set(a.comparativoForm,"data_inicio",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Prazo para Respostas")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.comparativoForm.prazo_resposta,expression:"comparativoForm.prazo_resposta"}],staticClass:"input-field",attrs:{type:"date"},domProps:{value:a.comparativoForm.prazo_resposta},on:{input:function(o){o.target.composing||a.$set(a.comparativoForm,"prazo_resposta",o.target.value)}}})])])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalComparativo}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoComparativo},on:{click:a.salvarComparativo}},[a._v(" "+a._s(a.salvandoComparativo?"Salvando...":"Salvar Comparativo")+" ")])])])]):a._e(),a.modalItens.show?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalItens}},[o("div",{staticClass:"modal-content extra-large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“‹ Gerenciar Itens - "+a._s(a.modalItens.comparativo?.titulo))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalItens}},[a._v("âœ•")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"itens-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.adicionarItem}},[a._v(" â• Adicionar Item ")]),o("button",{staticClass:"btn-secondary",on:{click:a.importarDeCotacoes}},[a._v(" ğŸ“¥ Importar de CotaÃ§Ãµes ")])]),o("div",{staticClass:"itens-lista"},[0===a.itensComparativo.length?o("div",{staticClass:"empty-state-small"},[o("p",[a._v("Nenhum item adicionado ao comparativo")])]):o("div",{staticClass:"itens-grid"},a._l(a.itensComparativo,(function(t){return o("div",{key:t.id,staticClass:"item-card"},[o("div",{staticClass:"item-header"},[o("h6",[a._v(a._s(t.produto_nome))]),o("span",{staticClass:"fornecedor"},[a._v(a._s(t.fornecedor_nome))])]),o("div",{staticClass:"item-body"},[t.preco_unitario?o("div",{staticClass:"item-preco"},[a._v(" "+a._s(a.formatCurrency(t.preco_unitario))+" ")]):a._e(),t.pontuacao_final?o("div",{staticClass:"item-pontuacao"},[o("span",{staticClass:"pontuacao"},[a._v(a._s(t.pontuacao_final)+"pts")]),t.posicao_ranking?o("span",{staticClass:"ranking"},[a._v("#"+a._s(t.posicao_ranking))]):a._e()]):a._e()]),o("div",{staticClass:"item-actions"},[o("button",{staticClass:"btn-mini",on:{click:function(o){return a.editarItem(t)}}},[a._v("âœï¸")]),o("button",{staticClass:"btn-mini btn-danger",on:{click:function(o){return a.removerItem(t)}}},[a._v("ğŸ—‘ï¸")])])])})),0)])])])]):a._e()])},ca=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"header-info"},[o("h4",[a._v("ğŸ“Š Gerenciamento de Comparativos TÃ©cnicos")]),o("p",[a._v("Compare especificaÃ§Ãµes tÃ©cnicas, preÃ§os e condiÃ§Ãµes de produtos similares para tomada de decisÃ£o fundamentada.")])])}];const la={name:"GerenciadorComparativo",data(){return{comparativos:[],itensComparativo:[],loading:!1,salvandoComparativo:!1,filtros:{busca:"",status:"",tipo:"",dataInicio:"",dataFim:""},modalComparativo:{show:!1,editando:!1},modalItens:{show:!1,comparativo:null},comparativoForm:{id:null,titulo:"",descricao:"",categoria:"",tipo_comparativo:"tecnico",metodologia:"matriz_decisao",data_inicio:"",prazo_resposta:""}}},computed:{comparativosFiltrados(){let a=[...this.comparativos];if(this.filtros.busca){const o=this.filtros.busca.toLowerCase();a=a.filter((a=>a.titulo.toLowerCase().includes(o)||a.categoria&&a.categoria.toLowerCase().includes(o)||a.descricao&&a.descricao.toLowerCase().includes(o)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_comparativo===this.filtros.tipo))),this.filtros.dataInicio&&(a=a.filter((a=>a.data_inicio>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.data_inicio<=this.filtros.dataFim))),a.sort(((a,o)=>new Date(o.created_at)-new Date(a.created_at)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.tipo||this.filtros.dataInicio||this.filtros.dataFim}},async mounted(){await this.carregarComparativos()},methods:{async carregarComparativos(){this.loading=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const{data:o,error:t}=await N.ND.from("comparativos").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(t)throw t;this.comparativos=o||[]}catch(a){console.error("Erro ao carregar comparativos:",a),this.$swal({title:"Erro",text:"Erro ao carregar comparativos: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovoComparativo(){this.modalComparativo.show=!0,this.modalComparativo.editando=!1,this.resetarFormulario()},fecharModalComparativo(){this.modalComparativo.show=!1,this.resetarFormulario()},fecharModalItens(){this.modalItens.show=!1,this.modalItens.comparativo=null,this.itensComparativo=[]},resetarFormulario(){this.comparativoForm={id:null,titulo:"",descricao:"",categoria:"",tipo_comparativo:"tecnico",metodologia:"matriz_decisao",data_inicio:(new Date).toISOString().split("T")[0],prazo_resposta:""}},async salvarComparativo(){this.salvandoComparativo=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const o={...this.comparativoForm,tenant_id:a};if(this.modalComparativo.editando){const{error:a}=await N.ND.from("comparativos").update(o).eq("id",this.comparativoForm.id);if(a)throw a}else{delete o.id;const{error:a}=await N.ND.from("comparativos").insert([o]);if(a)throw a}this.$swal({title:"Sucesso!",text:`Comparativo ${this.modalComparativo.editando?"atualizado":"criado"} com sucesso`,icon:"success",timer:2e3}),await this.carregarComparativos(),this.fecharModalComparativo()}catch(a){console.error("Erro ao salvar comparativo:",a),this.$swal({title:"Erro",text:"Erro ao salvar comparativo: "+a.message,icon:"error"})}finally{this.salvandoComparativo=!1}},editarComparativo(a){this.comparativoForm={...a},this.modalComparativo.show=!0,this.modalComparativo.editando=!0},async removerComparativo(a){const o=await this.$swal({title:"Confirmar exclusÃ£o",text:`Deseja realmente remover o comparativo "${a.titulo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("comparativos").delete().eq("id",a.id);if(o)throw o;this.$swal({title:"Removido!",text:"Comparativo removido com sucesso",icon:"success",timer:2e3}),await this.carregarComparativos()}catch(t){console.error("Erro ao remover comparativo:",t),this.$swal({title:"Erro",text:"Erro ao remover comparativo: "+t.message,icon:"error"})}},visualizarComparativo(a){this.$swal({title:`ğŸ“Š ${a.titulo}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>ğŸ“‹ InformaÃ§Ãµes BÃ¡sicas</h4>\n            <p><strong>Categoria:</strong> ${a.categoria||"NÃ£o informada"}</p>\n            <p><strong>Tipo:</strong> ${this.getTipoLabel(a.tipo_comparativo)}</p>\n            <p><strong>Status:</strong> ${this.getStatusLabel(a.status)}</p>\n            <p><strong>Metodologia:</strong> ${this.getMetodologiaLabel(a.metodologia)}</p>\n            \n            ${a.descricao?`<h4>ğŸ“ DescriÃ§Ã£o</h4><p>${a.descricao}</p>`:""}\n            \n            <h4>ğŸ“… Datas</h4>\n            <p><strong>InÃ­cio:</strong> ${this.formatDate(a.data_inicio)}</p>\n            ${a.prazo_resposta?`<p><strong>Prazo:</strong> ${this.formatDate(a.prazo_resposta)}</p>`:""}\n            ${a.data_conclusao?`<p><strong>ConclusÃ£o:</strong> ${this.formatDate(a.data_conclusao)}</p>`:""}\n          </div>\n        `,width:"600px",confirmButtonText:"Fechar"})},duplicarComparativo(a){this.comparativoForm={...a,id:null,titulo:a.titulo+" (CÃ³pia)",status:"em_andamento"},this.modalComparativo.show=!0,this.modalComparativo.editando=!1},async finalizarComparativo(a){const o=await this.$swal({title:"Finalizar Comparativo",text:`Deseja finalizar o comparativo "${a.titulo}"?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, finalizar",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("comparativos").update({status:"finalizado",data_conclusao:(new Date).toISOString().split("T")[0]}).eq("id",a.id);if(o)throw o;this.$swal({title:"Finalizado!",text:"Comparativo finalizado com sucesso",icon:"success",timer:2e3}),await this.carregarComparativos()}catch(t){console.error("Erro ao finalizar comparativo:",t),this.$swal({title:"Erro",text:"Erro ao finalizar comparativo: "+t.message,icon:"error"})}},async gerenciarItens(a){this.modalItens.show=!0,this.modalItens.comparativo=a,await this.carregarItensComparativo(a.id)},async carregarItensComparativo(a){try{const{data:o,error:t}=await N.ND.from("comparativos_itens").select("*").eq("comparativo_id",a).order("posicao_ranking",{ascending:!0});if(t)throw t;this.itensComparativo=o||[]}catch(o){console.error("Erro ao carregar itens:",o)}},adicionarItem(){this.$swal({title:"â• Adicionar Item",text:"Funcionalidade em desenvolvimento - Adicionar item ao comparativo",icon:"info"})},editarItem(a){this.$swal({title:"âœï¸ Editar Item",text:"Funcionalidade em desenvolvimento - Editar item do comparativo",icon:"info"})},async removerItem(a){const o=await this.$swal({title:"Confirmar exclusÃ£o",text:`Deseja remover "${a.produto_nome}" do comparativo?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("comparativos_itens").delete().eq("id",a.id);if(o)throw o;await this.carregarItensComparativo(this.modalItens.comparativo.id),this.$swal({title:"Removido!",text:"Item removido do comparativo",icon:"success",timer:2e3})}catch(t){console.error("Erro ao remover item:",t),this.$swal({title:"Erro",text:"Erro ao remover item: "+t.message,icon:"error"})}},limparFiltros(){this.filtros={busca:"",status:"",tipo:"",dataInicio:"",dataFim:""}},importarDeCotacoes(){this.$swal({title:"ğŸ“¥ Importar de CotaÃ§Ãµes",text:"Funcionalidade em desenvolvimento - Importar cotaÃ§Ãµes para este comparativo",icon:"info"})},async exportarComparativos(){try{if(0===this.comparativosFiltrados.length)return void this.$swal({title:"AtenÃ§Ã£o",text:"NÃ£o hÃ¡ comparativos para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"ğŸ“¤ Exportar Comparativos",text:`Exportar ${this.comparativosFiltrados.length} comparativo(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ“Š Excel (.xlsx)",cancelButtonText:"ğŸ“„ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportComparativos:o}=await t.e(913).then(t.bind(t,1913)),e=a?"excel":"csv";await o(this.comparativosFiltrados,e),this.$swal({title:"Sucesso!",text:`${this.comparativosFiltrados.length} comparativo(s) exportado(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar comparativos:",a),this.$swal({title:"Erro",text:"Erro ao exportar comparativos: "+a.message,icon:"error"})}},getItensCount(a){return Math.floor(5*Math.random())+1},isComparativoVencido(a){return!!a.prazo_resposta&&new Date(a.prazo_resposta)<new Date},truncateText(a,o){return a?a.length>o?a.substring(0,o)+"...":a:""},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},getStatusLabel(a){const o={em_andamento:"Em Andamento",finalizado:"Finalizado",cancelado:"Cancelado"};return o[a]||a},getTipoLabel(a){const o={tecnico:"TÃ©cnico",preco:"PreÃ§o",completo:"Completo"};return o[a]||a},getMetodologiaLabel(a){const o={matriz_decisao:"Matriz de DecisÃ£o",ranking:"Ranking Ponderado",pontuacao:"Sistema de PontuaÃ§Ã£o"};return o[a]||a}}},da=la;var ua=(0,C.A)(da,na,ca,!1,null,"2bbe8de0",null);const ma=ua.exports;var pa=function(){var a=this,o=a._self._c;return o("div",{staticClass:"gerenciador-analise-precos"},[o("div",{staticClass:"analise-header"},[a._m(0),o("div",{staticClass:"header-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaAnalise}},[a._v(" â• Nova AnÃ¡lise ")]),o("button",{staticClass:"btn-secondary",on:{click:a.gerarRelatorioConsolidado}},[a._v(" ğŸ“Š RelatÃ³rio Consolidado ")]),o("button",{staticClass:"btn-secondary",on:{click:a.exportarDados}},[a._v(" ğŸ“¤ Exportar Dados ")])])]),o("div",{staticClass:"analise-filtros"},[o("div",{staticClass:"filtros-row"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],staticClass:"input-field",attrs:{type:"text",placeholder:"TÃ­tulo, categoria ou produto..."},domProps:{value:a.filtros.busca},on:{input:function(o){o.target.composing||a.$set(a.filtros,"busca",o.target.value)}}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"processando"}},[a._v("Processando")]),o("option",{attrs:{value:"concluida"}},[a._v("ConcluÃ­da")]),o("option",{attrs:{value:"erro"}},[a._v("Erro")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("Tipo:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"tipo",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"temporal"}},[a._v("Temporal")]),o("option",{attrs:{value:"comparativa"}},[a._v("Comparativa")]),o("option",{attrs:{value:"estatistica"}},[a._v("EstatÃ­stica")]),o("option",{attrs:{value:"tendencia"}},[a._v("TendÃªncia")])])]),o("div",{staticClass:"filtro-group-periodo"},[o("label",[a._v("PerÃ­odo:")]),o("div",{staticClass:"periodo-inputs"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataInicio,expression:"filtros.dataInicio"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data inicial"},domProps:{value:a.filtros.dataInicio},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataInicio",o.target.value)}}}),o("span",{staticClass:"periodo-separador"},[a._v("atÃ©")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataFim,expression:"filtros.dataFim"}],staticClass:"input-field",attrs:{type:"date",placeholder:"Data final"},domProps:{value:a.filtros.dataFim},on:{input:function(o){o.target.composing||a.$set(a.filtros,"dataFim",o.target.value)}}})])]),o("button",{staticClass:"btn-ghost",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar ")])])]),!a.loading&&a.analises.length>0?o("div",{staticClass:"metricas-destaque"},[o("div",{staticClass:"metrica-card"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ“Š")]),o("div",{staticClass:"metrica-content"},[o("h4",[a._v(a._s(a.analises.length))]),o("p",[a._v("AnÃ¡lises Realizadas")])])]),o("div",{staticClass:"metrica-card"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ“ˆ")]),o("div",{staticClass:"metrica-content"},[o("h4",[a._v(a._s(a.analisesComTendencia))]),o("p",[a._v("Com TendÃªncias")])])]),o("div",{staticClass:"metrica-card"},[o("div",{staticClass:"metrica-icon"},[a._v("âš ï¸")]),o("div",{staticClass:"metrica-content"},[o("h4",[a._v(a._s(a.alertasAtivos))]),o("p",[a._v("Alertas Ativos")])])]),o("div",{staticClass:"metrica-card"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ’°")]),o("div",{staticClass:"metrica-content"},[o("h4",[a._v(a._s(a.mediaVariacao)+"%")]),o("p",[a._v("VariaÃ§Ã£o MÃ©dia")])])])]):a._e(),a.loading?o("div",{staticClass:"loading-container"},[o("div",{staticClass:"loading-spinner"}),o("p",[a._v("Carregando anÃ¡lises...")])]):o("div",{staticClass:"analises-container"},[0!==a.analisesFiltradas.length||a.temFiltrosAplicados?0===a.analisesFiltradas.length&&a.temFiltrosAplicados?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ”")]),o("h3",[a._v("Nenhuma anÃ¡lise encontrada")]),o("p",[a._v("Nenhuma anÃ¡lise corresponde aos filtros aplicados.")]),o("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v(" ğŸ—‘ï¸ Limpar Filtros ")])]):o("div",{staticClass:"analises-grid"},a._l(a.analisesFiltradas,(function(t){return o("div",{key:t.id,staticClass:"analise-card",class:{concluida:"concluida"===t.status,erro:"erro"===t.status,processando:"processando"===t.status}},[o("div",{staticClass:"analise-header-card"},[o("div",{staticClass:"analise-info"},[o("h5",[a._v(a._s(t.titulo))]),o("div",{staticClass:"analise-meta"},[o("span",{staticClass:"categoria"},[a._v(a._s(t.categoria||"Sem categoria"))]),o("span",{staticClass:"tipo"},[a._v(a._s(a.getTipoLabel(t.tipo_analise)))]),o("span",{staticClass:"status",class:t.status},[a._v(a._s(a.getStatusLabel(t.status)))])])]),"processando"===t.status?o("div",{staticClass:"analise-progresso"},[o("div",{staticClass:"progress-bar"},[o("div",{staticClass:"progress-fill",style:{width:t.progresso+"%"}})]),o("span",{staticClass:"progress-text"},[a._v(a._s(t.progresso)+"%")])]):a._e()]),"concluida"===t.status?o("div",{staticClass:"analise-metricas"},[o("div",{staticClass:"metrica-item"},[o("span",{staticClass:"label"},[a._v("PerÃ­odo:")]),o("span",{staticClass:"value"},[a._v(a._s(a.formatPeriodo(t.periodo_inicio,t.periodo_fim)))])]),t.preco_medio?o("div",{staticClass:"metrica-item"},[o("span",{staticClass:"label"},[a._v("PreÃ§o MÃ©dio:")]),o("span",{staticClass:"value"},[a._v(a._s(a.formatCurrency(t.preco_medio)))])]):a._e(),t.variacao_percentual?o("div",{staticClass:"metrica-item"},[o("span",{staticClass:"label"},[a._v("VariaÃ§Ã£o:")]),o("span",{staticClass:"value",class:a.getVariacaoClass(t.variacao_percentual)},[a._v(" "+a._s(a.formatPercentual(t.variacao_percentual))+" ")])]):a._e(),t.desvio_padrao?o("div",{staticClass:"metrica-item"},[o("span",{staticClass:"label"},[a._v("Volatilidade:")]),o("span",{staticClass:"value"},[a._v(a._s(a.formatCurrency(t.desvio_padrao)))])]):a._e()]):a._e(),o("div",{staticClass:"analise-body"},[o("div",{staticClass:"analise-desc"},[t.descricao?o("p",[a._v(a._s(a.truncateText(t.descricao,120)))]):o("p",{staticClass:"sem-descricao"},[a._v("Sem descriÃ§Ã£o")])]),"concluida"===t.status?o("div",{staticClass:"analise-detalhes"},[o("div",{staticClass:"detalhe-badges"},[t.preco_minimo&&t.preco_maximo?o("span",{staticClass:"badge"},[a._v(" ğŸ’° "+a._s(a.formatCurrency(t.preco_minimo))+" - "+a._s(a.formatCurrency(t.preco_maximo))+" ")]):a._e(),t.granularidade?o("span",{staticClass:"badge"},[a._v(" ğŸ“… "+a._s(a.getGranularidadeLabel(t.granularidade))+" ")]):a._e(),a.temTendencias(t.id)?o("span",{staticClass:"badge"},[a._v(" ğŸ“ˆ Com TendÃªncias ")]):a._e(),a.temAlertas(t.id)?o("span",{staticClass:"badge warning"},[a._v(" âš ï¸ Alertas ")]):a._e()])]):a._e()]),o("div",{staticClass:"analise-actions"},[o("button",{staticClass:"btn-small",on:{click:function(o){return a.visualizarAnalise(t)}}},[a._v("ğŸ‘ï¸ Ver")]),"concluida"===t.status?o("button",{staticClass:"btn-small",on:{click:function(o){return a.verGraficos(t)}}},[a._v(" ğŸ“Š GrÃ¡ficos ")]):a._e(),"concluida"===t.status?o("button",{staticClass:"btn-small",on:{click:function(o){return a.verTendencias(t)}}},[a._v(" ğŸ“ˆ TendÃªncias ")]):a._e(),o("button",{staticClass:"btn-small",on:{click:function(o){return a.editarAnalise(t)}}},[a._v("âœï¸ Editar")]),o("button",{staticClass:"btn-small",on:{click:function(o){return a.duplicarAnalise(t)}}},[a._v("ğŸ“‹ Duplicar")]),"processando"===t.status?o("button",{staticClass:"btn-small btn-warning",on:{click:function(o){return a.cancelarAnalise(t)}}},[a._v(" âŒ Cancelar ")]):a._e(),o("button",{staticClass:"btn-small btn-danger",on:{click:function(o){return a.removerAnalise(t)}}},[a._v("ğŸ—‘ï¸ Remover")])])])})),0):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“ˆ")]),o("h3",[a._v("Nenhuma anÃ¡lise registrada")]),o("p",[a._v("Comece criando anÃ¡lises de preÃ§os para identificar tendÃªncias e oportunidades de economia.")]),o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaAnalise}},[a._v(" â• Criar AnÃ¡lise ")])])]),a.modalAnalise.show?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalAnalise}},[o("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.modalAnalise.editando?"âœï¸ Editar AnÃ¡lise":"â• Nova AnÃ¡lise de PreÃ§os"))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalAnalise}},[a._v("âœ•")])]),o("div",{staticClass:"modal-body"},[o("form",{staticClass:"form-analise",on:{submit:function(o){return o.preventDefault(),a.salvarAnalise.apply(null,arguments)}}},[o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ“‹ Dados BÃ¡sicos")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("TÃ­tulo da AnÃ¡lise*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.titulo,expression:"analiseForm.titulo"}],staticClass:"input-field",attrs:{type:"text",required:"",placeholder:"Ex: AnÃ¡lise de Notebooks - Q1 2024"},domProps:{value:a.analiseForm.titulo},on:{input:function(o){o.target.composing||a.$set(a.analiseForm,"titulo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Categoria")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.categoria,expression:"analiseForm.categoria"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Ex: InformÃ¡tica, MÃ³veis, VeÃ­culos"},domProps:{value:a.analiseForm.categoria},on:{input:function(o){o.target.composing||a.$set(a.analiseForm,"categoria",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group full-width"},[o("label",[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.descricao,expression:"analiseForm.descricao"}],staticClass:"textarea-field",attrs:{rows:"3",placeholder:"Descreva o objetivo e escopo da anÃ¡lise..."},domProps:{value:a.analiseForm.descricao},on:{input:function(o){o.target.composing||a.$set(a.analiseForm,"descricao",o.target.value)}}})])])]),o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("âš™ï¸ ConfiguraÃ§Ãµes da AnÃ¡lise")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Tipo de AnÃ¡lise*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.tipo_analise,expression:"analiseForm.tipo_analise"}],staticClass:"select-field",attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.analiseForm,"tipo_analise",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"temporal"}},[a._v("Temporal (evoluÃ§Ã£o no tempo)")]),o("option",{attrs:{value:"comparativa"}},[a._v("Comparativa (entre produtos)")]),o("option",{attrs:{value:"estatistica"}},[a._v("EstatÃ­stica (distribuiÃ§Ãµes)")]),o("option",{attrs:{value:"tendencia"}},[a._v("TendÃªncia (previsÃµes)")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Granularidade")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.granularidade,expression:"analiseForm.granularidade"}],staticClass:"select-field",on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.analiseForm,"granularidade",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"diaria"}},[a._v("DiÃ¡ria")]),o("option",{attrs:{value:"semanal"}},[a._v("Semanal")]),o("option",{attrs:{value:"mensal"}},[a._v("Mensal")]),o("option",{attrs:{value:"trimestral"}},[a._v("Trimestral")]),o("option",{attrs:{value:"anual"}},[a._v("Anual")])])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Data InÃ­cio*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.periodo_inicio,expression:"analiseForm.periodo_inicio"}],staticClass:"input-field",attrs:{type:"date",required:""},domProps:{value:a.analiseForm.periodo_inicio},on:{input:function(o){o.target.composing||a.$set(a.analiseForm,"periodo_inicio",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Data Fim*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.analiseForm.periodo_fim,expression:"analiseForm.periodo_fim"}],staticClass:"input-field",attrs:{type:"date",required:""},domProps:{value:a.analiseForm.periodo_fim},on:{input:function(o){o.target.composing||a.$set(a.analiseForm,"periodo_fim",o.target.value)}}})])])]),o("fieldset",{staticClass:"form-section"},[o("legend",[a._v("ğŸ” Filtros de Dados")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Produtos EspecÃ­ficos")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosProdutos,expression:"filtrosProdutos"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Digite nomes de produtos separados por vÃ­rgula"},domProps:{value:a.filtrosProdutos},on:{input:function(o){o.target.composing||(a.filtrosProdutos=o.target.value)}}}),o("small",{staticClass:"form-help"},[a._v("Deixe vazio para incluir todos os produtos")])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Fornecedores EspecÃ­ficos")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosFornecedores,expression:"filtrosFornecedores"}],staticClass:"input-field",attrs:{type:"text",placeholder:"Digite nomes de fornecedores separados por vÃ­rgula"},domProps:{value:a.filtrosFornecedores},on:{input:function(o){o.target.composing||(a.filtrosFornecedores=o.target.value)}}}),o("small",{staticClass:"form-help"},[a._v("Deixe vazio para incluir todos os fornecedores")])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Faixa de PreÃ§os")]),o("div",{staticClass:"price-range"},[o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.faixaPrecos.min,expression:"faixaPrecos.min",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",step:"0.01",placeholder:"PreÃ§o mÃ­nimo"},domProps:{value:a.faixaPrecos.min},on:{input:function(o){o.target.composing||a.$set(a.faixaPrecos,"min",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}}),o("span",[a._v("atÃ©")]),o("input",{directives:[{name:"model",rawName:"v-model.number",value:a.faixaPrecos.max,expression:"faixaPrecos.max",modifiers:{number:!0}}],staticClass:"input-field",attrs:{type:"number",step:"0.01",placeholder:"PreÃ§o mÃ¡ximo"},domProps:{value:a.faixaPrecos.max},on:{input:function(o){o.target.composing||a.$set(a.faixaPrecos,"max",a._n(o.target.value))},blur:function(o){return a.$forceUpdate()}}})])])])])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalAnalise}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{disabled:a.salvandoAnalise},on:{click:a.salvarAnalise}},[a._v(" "+a._s(a.salvandoAnalise?"Processando...":"Iniciar AnÃ¡lise")+" ")])])])]):a._e(),a.modalVisualizacao.show?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVisualizacao}},[o("div",{staticClass:"modal-content extra-large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“Š "+a._s(a.modalVisualizacao.analise?.titulo))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalVisualizacao}},[a._v("âœ•")])]),o("div",{staticClass:"modal-body"},[a.modalVisualizacao.analise?o("div",{staticClass:"analise-detalhada"},[o("div",{staticClass:"resumo-executivo"},[o("h4",[a._v("ğŸ“ˆ Resumo Executivo")]),o("div",{staticClass:"resumo-grid"},[o("div",{staticClass:"resumo-item"},[o("span",{staticClass:"label"},[a._v("PerÃ­odo Analisado:")]),o("span",{staticClass:"value"},[a._v(a._s(a.formatPeriodo(a.modalVisualizacao.analise.periodo_inicio,a.modalVisualizacao.analise.periodo_fim)))])]),o("div",{staticClass:"resumo-item"},[o("span",{staticClass:"label"},[a._v("Tipo de AnÃ¡lise:")]),o("span",{staticClass:"value"},[a._v(a._s(a.getTipoLabel(a.modalVisualizacao.analise.tipo_analise)))])]),o("div",{staticClass:"resumo-item"},[o("span",{staticClass:"label"},[a._v("Granularidade:")]),o("span",{staticClass:"value"},[a._v(a._s(a.getGranularidadeLabel(a.modalVisualizacao.analise.granularidade)))])]),o("div",{staticClass:"resumo-item"},[o("span",{staticClass:"label"},[a._v("Status:")]),o("span",{staticClass:"value"},[a._v(a._s(a.getStatusLabel(a.modalVisualizacao.analise.status)))])])])]),"concluida"===a.modalVisualizacao.analise.status?o("div",{staticClass:"metricas-principais"},[o("h4",[a._v("ğŸ“Š MÃ©tricas Principais")]),o("div",{staticClass:"metricas-grid"},[o("div",{staticClass:"metrica-detalhada"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ’°")]),o("div",{staticClass:"metrica-content"},[o("h5",[a._v(a._s(a.formatCurrency(a.modalVisualizacao.analise.preco_medio||0)))]),o("p",[a._v("PreÃ§o MÃ©dio")])])]),o("div",{staticClass:"metrica-detalhada"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ“ˆ")]),o("div",{staticClass:"metrica-content"},[o("h5",{class:a.getVariacaoClass(a.modalVisualizacao.analise.variacao_percentual)},[a._v(" "+a._s(a.formatPercentual(a.modalVisualizacao.analise.variacao_percentual||0))+" ")]),o("p",[a._v("VariaÃ§Ã£o Total")])])]),o("div",{staticClass:"metrica-detalhada"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ“Š")]),o("div",{staticClass:"metrica-content"},[o("h5",[a._v(a._s(a.formatCurrency(a.modalVisualizacao.analise.desvio_padrao||0)))]),o("p",[a._v("Desvio PadrÃ£o")])])]),o("div",{staticClass:"metrica-detalhada"},[o("div",{staticClass:"metrica-icon"},[a._v("ğŸ¯")]),o("div",{staticClass:"metrica-content"},[o("h5",[a._v(a._s(a.formatPercentual(a.modalVisualizacao.analise.coeficiente_variacao||0)))]),o("p",[a._v("Coef. VariaÃ§Ã£o")])])])])]):a._e(),"concluida"===a.modalVisualizacao.analise.status?o("div",{staticClass:"graficos-section"},[o("h4",[a._v("ğŸ“ˆ VisualizaÃ§Ãµes")]),a._m(1)]):a._e()]):a._e()])])]):a._e()])},va=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"header-info"},[o("h4",[a._v("ğŸ“ˆ Gerenciamento de AnÃ¡lise de PreÃ§os")]),o("p",[a._v("Analise variaÃ§Ãµes de preÃ§os ao longo do tempo, identifique tendÃªncias e tome decisÃµes baseadas em dados estatÃ­sticos.")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"graficos-placeholder"},[o("div",{staticClass:"placeholder-box"},[o("div",{staticClass:"placeholder-icon"},[a._v("ğŸ“Š")]),o("h5",[a._v("GrÃ¡ficos em desenvolvimento")]),o("p",[a._v("Em breve: grÃ¡ficos interativos de evoluÃ§Ã£o de preÃ§os, histogramas e box plots")])])])}];const ga={name:"GerenciadorAnalisePrecos",data(){return{analises:[],loading:!1,salvandoAnalise:!1,filtros:{busca:"",status:"",tipo:"",dataInicio:"",dataFim:""},modalAnalise:{show:!1,editando:!1},modalVisualizacao:{show:!1,analise:null},analiseForm:{id:null,titulo:"",descricao:"",categoria:"",tipo_analise:"temporal",granularidade:"mensal",periodo_inicio:"",periodo_fim:""},filtrosProdutos:"",filtrosFornecedores:"",faixaPrecos:{min:null,max:null}}},computed:{analisesFiltradas(){let a=[...this.analises];if(this.filtros.busca){const o=this.filtros.busca.toLowerCase();a=a.filter((a=>a.titulo.toLowerCase().includes(o)||a.categoria&&a.categoria.toLowerCase().includes(o)||a.descricao&&a.descricao.toLowerCase().includes(o)))}return this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_analise===this.filtros.tipo))),this.filtros.dataInicio&&(a=a.filter((a=>a.periodo_inicio>=this.filtros.dataInicio))),this.filtros.dataFim&&(a=a.filter((a=>a.periodo_fim<=this.filtros.dataFim))),a.sort(((a,o)=>new Date(o.created_at)-new Date(a.created_at)))},temFiltrosAplicados(){return this.filtros.busca||this.filtros.status||this.filtros.tipo||this.filtros.dataInicio||this.filtros.dataFim},analisesComTendencia(){return this.analises.filter((a=>"concluida"===a.status)).length},alertasAtivos(){return Math.floor(5*Math.random())},mediaVariacao(){const a=this.analises.filter((a=>"concluida"===a.status&&a.variacao_percentual));if(0===a.length)return 0;const o=a.reduce(((a,o)=>a+(o.variacao_percentual||0)),0);return(o/a.length).toFixed(1)}},async mounted(){await this.carregarAnalises(),this.definirDatasPadrao()},methods:{async carregarAnalises(){this.loading=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const{data:o,error:t}=await N.ND.from("analises_precos").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(t)throw t;this.analises=o||[]}catch(a){console.error("Erro ao carregar anÃ¡lises:",a),this.$swal({title:"Erro",text:"Erro ao carregar anÃ¡lises: "+a.message,icon:"error"})}finally{this.loading=!1}},abrirModalNovaAnalise(){this.modalAnalise.show=!0,this.modalAnalise.editando=!1,this.resetarFormulario()},fecharModalAnalise(){this.modalAnalise.show=!1,this.resetarFormulario()},fecharModalVisualizacao(){this.modalVisualizacao.show=!1,this.modalVisualizacao.analise=null},resetarFormulario(){this.analiseForm={id:null,titulo:"",descricao:"",categoria:"",tipo_analise:"temporal",granularidade:"mensal",periodo_inicio:"",periodo_fim:""},this.filtrosProdutos="",this.filtrosFornecedores="",this.faixaPrecos={min:null,max:null}},definirDatasPadrao(){const a=new Date,o=new Date(a.getFullYear(),0,1);this.analiseForm.periodo_fim=a.toISOString().split("T")[0],this.analiseForm.periodo_inicio=o.toISOString().split("T")[0]},async salvarAnalise(){this.salvandoAnalise=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const o={};this.filtrosProdutos&&(o.produtos=this.filtrosProdutos.split(",").map((a=>a.trim()))),this.filtrosFornecedores&&(o.fornecedores=this.filtrosFornecedores.split(",").map((a=>a.trim()))),(this.faixaPrecos.min||this.faixaPrecos.max)&&(o.faixa_precos=this.faixaPrecos);const t={...this.analiseForm,tenant_id:a,filtros_aplicados:Object.keys(o).length>0?o:null,status:"processando",progresso:0};if(this.modalAnalise.editando){const{error:a}=await N.ND.from("analises_precos").update(t).eq("id",this.analiseForm.id);if(a)throw a}else{delete t.id;const{error:a}=await N.ND.from("analises_precos").insert([t]);if(a)throw a}this.$swal({title:"Sucesso!",text:`AnÃ¡lise ${this.modalAnalise.editando?"atualizada":"iniciada"} com sucesso`,icon:"success",timer:2e3}),await this.carregarAnalises(),this.fecharModalAnalise()}catch(a){console.error("Erro ao salvar anÃ¡lise:",a),this.$swal({title:"Erro",text:"Erro ao salvar anÃ¡lise: "+a.message,icon:"error"})}finally{this.salvandoAnalise=!1}},editarAnalise(a){this.analiseForm={...a},this.modalAnalise.show=!0,this.modalAnalise.editando=!0},async removerAnalise(a){const o=await this.$swal({title:"Confirmar exclusÃ£o",text:`Deseja realmente remover a anÃ¡lise "${a.titulo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("analises_precos").delete().eq("id",a.id);if(o)throw o;this.$swal({title:"Removida!",text:"AnÃ¡lise removida com sucesso",icon:"success",timer:2e3}),await this.carregarAnalises()}catch(t){console.error("Erro ao remover anÃ¡lise:",t),this.$swal({title:"Erro",text:"Erro ao remover anÃ¡lise: "+t.message,icon:"error"})}},visualizarAnalise(a){this.modalVisualizacao.show=!0,this.modalVisualizacao.analise=a},duplicarAnalise(a){this.analiseForm={...a,id:null,titulo:a.titulo+" (CÃ³pia)",status:"processando"},this.modalAnalise.show=!0,this.modalAnalise.editando=!1},async cancelarAnalise(a){const o=await this.$swal({title:"Cancelar AnÃ¡lise",text:`Deseja cancelar o processamento da anÃ¡lise "${a.titulo}"?`,icon:"question",showCancelButton:!0,confirmButtonText:"Sim, cancelar",cancelButtonText:"Continuar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("analises_precos").update({status:"erro",progresso:0}).eq("id",a.id);if(o)throw o;await this.carregarAnalises()}catch(t){console.error("Erro ao cancelar anÃ¡lise:",t)}},verGraficos(a){this.$swal({title:"ğŸ“Š GrÃ¡ficos da AnÃ¡lise",text:"Funcionalidade em desenvolvimento - VisualizaÃ§Ãµes grÃ¡ficas interativas",icon:"info"})},verTendencias(a){this.$swal({title:"ğŸ“ˆ AnÃ¡lise de TendÃªncias",text:"Funcionalidade em desenvolvimento - DetecÃ§Ã£o automÃ¡tica de tendÃªncias",icon:"info"})},limparFiltros(){this.filtros={busca:"",status:"",tipo:"",dataInicio:"",dataFim:""}},async gerarRelatorioConsolidado(){try{if(0===this.analisesFiltradas.length)return void this.$swal({title:"AtenÃ§Ã£o",text:"NÃ£o hÃ¡ anÃ¡lises para incluir no relatÃ³rio com os filtros aplicados.",icon:"warning"});const a=await this.$swal({title:"ğŸ“Š Gerar RelatÃ³rio Consolidado",html:`\n            <div style="text-align: left; margin: 20px 0;">\n              <p><strong>AnÃ¡lises a serem incluÃ­das:</strong> ${this.analisesFiltradas.length}</p>\n              <p><strong>AnÃ¡lises concluÃ­das:</strong> ${this.analisesFiltradas.filter((a=>"concluida"===a.status)).length}</p>\n              <br>\n              <p>O relatÃ³rio serÃ¡ aberto em uma nova janela e poderÃ¡ ser impresso ou salvo como PDF.</p>\n            </div>\n          `,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ“Š Gerar RelatÃ³rio",cancelButtonText:"Cancelar"});if(!a.isConfirmed)return;const{gerarRelatorioAnalisePrecos:o}=await t.e(236).then(t.bind(t,5236));await o(this.analisesFiltradas,"RelatÃ³rio Consolidado de AnÃ¡lise de PreÃ§os"),this.$swal({title:"Sucesso!",text:"RelatÃ³rio consolidado gerado com sucesso!",icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao gerar relatÃ³rio:",a),this.$swal({title:"Erro",text:"Erro ao gerar relatÃ³rio: "+a.message,icon:"error"})}},async exportarDados(){try{if(0===this.analisesFiltradas.length)return void this.$swal({title:"AtenÃ§Ã£o",text:"NÃ£o hÃ¡ dados para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"ğŸ“¤ Exportar Dados de AnÃ¡lise",text:`Exportar dados de ${this.analisesFiltradas.length} anÃ¡lise(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ“Š Excel (.xlsx)",cancelButtonText:"ğŸ“„ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;const{exportAnalises:o}=await t.e(913).then(t.bind(t,1913)),e=a?"excel":"csv";await o(this.analisesFiltradas,e),this.$swal({title:"Sucesso!",text:`Dados de ${this.analisesFiltradas.length} anÃ¡lise(s) exportados com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar dados:",a),this.$swal({title:"Erro",text:"Erro ao exportar dados: "+a.message,icon:"error"})}},temTendencias(a){return Math.random()>.5},temAlertas(a){return Math.random()>.7},truncateText(a,o){return a?a.length>o?a.substring(0,o)+"...":a:""},getVariacaoClass(a){return a?a>5?"positiva":a<-5?"negativa":"neutra":""},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},formatPeriodo(a,o){return`${this.formatDate(a)} - ${this.formatDate(o)}`},formatCurrency(a){return a?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a):"R$ 0,00"},formatPercentual(a){return a?(a>0?"+":"")+a.toFixed(1)+"%":"0%"},getStatusLabel(a){const o={processando:"Processando",concluida:"ConcluÃ­da",erro:"Erro"};return o[a]||a},getTipoLabel(a){const o={temporal:"Temporal",comparativa:"Comparativa",estatistica:"EstatÃ­stica",tendencia:"TendÃªncia"};return o[a]||a},getGranularidadeLabel(a){const o={diaria:"DiÃ¡ria",semanal:"Semanal",mensal:"Mensal",trimestral:"Trimestral",anual:"Anual"};return o[a]||a}}},_a=ga;var ha=(0,C.A)(_a,pa,va,!1,null,"2a96a6d5",null);const fa=ha.exports;var Ca=function(){var a=this,o=a._self._c;return o("div",{staticClass:"gerenciador-relatorios"},[o("div",{staticClass:"header-section"},[o("div",{staticClass:"title-and-stats"},[o("h2",[a._v("ğŸ“‹ Gerenciador de RelatÃ³rios")]),o("div",{staticClass:"stats-mini"},[o("span",{staticClass:"stat-item"},[o("strong",[a._v(a._s(a.totalRelatorios))]),a._v(" RelatÃ³rios ")]),o("span",{staticClass:"stat-item pendentes"},[o("strong",[a._v(a._s(a.relatoriosPendentes))]),a._v(" Pendentes ")]),o("span",{staticClass:"stat-item concluidos"},[o("strong",[a._v(a._s(a.relatoriosConcluidos))]),a._v(" ConcluÃ­dos ")])])]),o("div",{staticClass:"actions-header"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoRelatorio}},[a._v(" + Novo RelatÃ³rio ")]),o("button",{staticClass:"btn-secondary",on:{click:a.carregarRelatorios}},[a._v(" ğŸ”„ Atualizar ")])])]),o("div",{staticClass:"filtros-section"},[o("div",{staticClass:"filtros-linha"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“ TÃ­tulo:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.titulo,expression:"filtros.titulo"}],attrs:{type:"text",placeholder:"Filtrar por tÃ­tulo..."},domProps:{value:a.filtros.titulo},on:{input:[function(o){o.target.composing||a.$set(a.filtros,"titulo",o.target.value)},a.aplicarFiltros]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“Š Categoria:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.categoria,expression:"filtros.categoria"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"categoria",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"pesquisa_mercado"}},[a._v("Pesquisa de Mercado")]),o("option",{attrs:{value:"cotacoes"}},[a._v("CotaÃ§Ãµes")]),o("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),o("option",{attrs:{value:"analise_precos"}},[a._v("AnÃ¡lise de PreÃ§os")]),o("option",{attrs:{value:"executivo"}},[a._v("Executivo")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“ˆ Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"pendente"}},[a._v("Pendente")]),o("option",{attrs:{value:"gerando"}},[a._v("Gerando")]),o("option",{attrs:{value:"concluido"}},[a._v("ConcluÃ­do")]),o("option",{attrs:{value:"erro"}},[a._v("Com Erro")]),o("option",{attrs:{value:"cancelado"}},[a._v("Cancelado")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“‹ Tipo:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo_relatorio,expression:"filtros.tipo_relatorio"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"tipo_relatorio",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"consolidado"}},[a._v("Consolidado")]),o("option",{attrs:{value:"analise_tecnica"}},[a._v("AnÃ¡lise TÃ©cnica")]),o("option",{attrs:{value:"comparativo_precos"}},[a._v("Comparativo de PreÃ§os")]),o("option",{attrs:{value:"executivo"}},[a._v("Executivo")]),o("option",{attrs:{value:"custom"}},[a._v("Personalizado")])])])])]),o("div",{staticClass:"relatorios-lista"},[a.loading?o("div",{staticClass:"loading-state"},[o("div",{staticClass:"spinner"}),o("p",[a._v("Carregando relatÃ³rios...")])]):0===a.relatoriosFiltrados.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“Š")]),o("h3",[a._v("Nenhum relatÃ³rio encontrado")]),o("p",[a._v("NÃ£o hÃ¡ relatÃ³rios que correspondam aos filtros aplicados.")]),o("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v("Limpar Filtros")])]):o("div",{staticClass:"relatorios-grid"},a._l(a.relatoriosPaginados,(function(t){return o("div",{key:t.id,staticClass:"relatorio-card",class:"status-"+t.status},[o("div",{staticClass:"card-header"},[o("div",{staticClass:"titulo-e-categoria"},[o("h4",[a._v(a._s(t.titulo))]),o("span",{staticClass:"categoria-badge",class:"categoria-"+t.categoria},[a._v(" "+a._s(a.getCategoriaLabel(t.categoria))+" ")])]),o("div",{staticClass:"status-badge",class:"status-"+t.status},[a._v(" "+a._s(a.getStatusLabel(t.status))+" ")])]),o("div",{staticClass:"card-content"},[o("div",{staticClass:"info-linha"},[o("strong",[a._v("Tipo:")]),a._v(" "+a._s(a.getTipoLabel(t.tipo_relatorio))+" ")]),t.descricao?o("div",{staticClass:"descricao"},[a._v(" "+a._s(t.descricao)+" ")]):a._e(),"gerando"===t.status?o("div",{staticClass:"progress-section"},[o("div",{staticClass:"progress-bar"},[o("div",{staticClass:"progress-fill",style:{width:t.progresso+"%"}})]),o("span",{staticClass:"progress-text"},[a._v(a._s(t.progresso)+"%")])]):a._e(),o("div",{staticClass:"metadados"},[o("span",[o("strong",[a._v("Criado:")]),a._v(" "+a._s(a.formatarData(t.created_at)))]),t.gerado_em?o("span",[o("strong",[a._v("Gerado:")]),a._v(" "+a._s(a.formatarData(t.gerado_em))+" ")]):a._e(),t.visualizacoes>0?o("span",[o("strong",[a._v("VisualizaÃ§Ãµes:")]),a._v(" "+a._s(t.visualizacoes)+" ")]):a._e()])]),o("div",{staticClass:"card-actions"},["concluido"===t.status&&t.url_arquivo_principal?o("button",{staticClass:"btn-action download",attrs:{title:"Baixar RelatÃ³rio"},on:{click:function(o){return a.baixarRelatorio(t)}}},[a._v(" ğŸ“¥ Baixar ")]):a._e(),"concluido"===t.status?o("button",{staticClass:"btn-action view",attrs:{title:"Visualizar"},on:{click:function(o){return a.visualizarRelatorio(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]):a._e(),o("button",{staticClass:"btn-action edit",attrs:{title:"Editar",disabled:"gerando"===t.status},on:{click:function(o){return a.editarRelatorio(t)}}},[a._v(" âœï¸ Editar ")]),"pendente"===t.status||"erro"===t.status?o("button",{staticClass:"btn-action generate",attrs:{title:"Gerar RelatÃ³rio"},on:{click:function(o){return a.gerarRelatorio(t)}}},[a._v(" âš¡ Gerar ")]):a._e(),o("button",{staticClass:"btn-action delete",attrs:{title:"Excluir",disabled:"gerando"===t.status},on:{click:function(o){return a.excluirRelatorio(t)}}},[a._v(" ğŸ—‘ï¸ Excluir ")])])])})),0)]),a.totalPaginas>1?o("div",{staticClass:"paginacao"},[o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual<=1},on:{click:function(o){a.paginaAtual--}}},[a._v(" â€¹ Anterior ")]),o("span",{staticClass:"pagina-info"},[a._v(" PÃ¡gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual>=a.totalPaginas},on:{click:function(o){a.paginaAtual++}}},[a._v(" PrÃ³xima â€º ")])]):a._e(),a.showModal?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModal}},[o("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.relatorioEditando.id?"Editar RelatÃ³rio":"Novo RelatÃ³rio"))]),o("button",{staticClass:"modal-close",on:{click:a.fecharModal}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarRelatorio.apply(null,arguments)}}},[o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“ TÃ­tulo*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.titulo,expression:"relatorioEditando.titulo"}],attrs:{type:"text",required:"",placeholder:"Digite o tÃ­tulo do relatÃ³rio"},domProps:{value:a.relatorioEditando.titulo},on:{input:function(o){o.target.composing||a.$set(a.relatorioEditando,"titulo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“Š Categoria*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.categoria,expression:"relatorioEditando.categoria"}],attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.relatorioEditando,"categoria",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),o("option",{attrs:{value:"pesquisa_mercado"}},[a._v("Pesquisa de Mercado")]),o("option",{attrs:{value:"cotacoes"}},[a._v("CotaÃ§Ãµes")]),o("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),o("option",{attrs:{value:"analise_precos"}},[a._v("AnÃ¡lise de PreÃ§os")]),o("option",{attrs:{value:"executivo"}},[a._v("Executivo")])])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“‹ Tipo de RelatÃ³rio*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.tipo_relatorio,expression:"relatorioEditando.tipo_relatorio"}],attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.relatorioEditando,"tipo_relatorio",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),o("option",{attrs:{value:"consolidado"}},[a._v("Consolidado")]),o("option",{attrs:{value:"analise_tecnica"}},[a._v("AnÃ¡lise TÃ©cnica")]),o("option",{attrs:{value:"comparativo_precos"}},[a._v("Comparativo de PreÃ§os")]),o("option",{attrs:{value:"executivo"}},[a._v("Executivo")]),o("option",{attrs:{value:"custom"}},[a._v("Personalizado")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“„ Formato de SaÃ­da")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.formato_saida,expression:"relatorioEditando.formato_saida"}],on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.relatorioEditando,"formato_saida",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:"pdf"}},[a._v("PDF")]),o("option",{attrs:{value:"xlsx"}},[a._v("Excel (XLSX)")]),o("option",{attrs:{value:"docx"}},[a._v("Word (DOCX)")]),o("option",{attrs:{value:"csv"}},[a._v("CSV")]),o("option",{attrs:{value:"html"}},[a._v("HTML")])])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“ DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.descricao,expression:"relatorioEditando.descricao"}],attrs:{rows:"3",placeholder:"Descreva o objetivo e conteÃºdo do relatÃ³rio"},domProps:{value:a.relatorioEditando.descricao},on:{input:function(o){o.target.composing||a.$set(a.relatorioEditando,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“… PerÃ­odo - InÃ­cio")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.periodo_dados_inicio,expression:"relatorioEditando.periodo_dados_inicio"}],attrs:{type:"date"},domProps:{value:a.relatorioEditando.periodo_dados_inicio},on:{input:function(o){o.target.composing||a.$set(a.relatorioEditando,"periodo_dados_inicio",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“… PerÃ­odo - Fim")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.periodo_dados_fim,expression:"relatorioEditando.periodo_dados_fim"}],attrs:{type:"date"},domProps:{value:a.relatorioEditando.periodo_dados_fim},on:{input:function(o){o.target.composing||a.$set(a.relatorioEditando,"periodo_dados_fim",o.target.value)}}})])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ¯ Fonte Principal dos Dados")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.fonte_principal,expression:"relatorioEditando.fonte_principal"}],on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.relatorioEditando,"fonte_principal",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),o("option",{attrs:{value:"cotacoes"}},[a._v("CotaÃ§Ãµes")]),o("option",{attrs:{value:"comparativos"}},[a._v("Comparativos")]),o("option",{attrs:{value:"analises"}},[a._v("AnÃ¡lises de PreÃ§os")]),o("option",{attrs:{value:"manual"}},[a._v("Entrada Manual")]),o("option",{attrs:{value:"multiplas"}},[a._v("MÃºltiplas Fontes")])])]),o("div",{staticClass:"configuracoes-section"},[o("h4",[a._v("âš™ï¸ ConfiguraÃ§Ãµes de GeraÃ§Ã£o")]),o("div",{staticClass:"checkbox-group"},[o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_graficos,expression:"relatorioEditando.incluir_graficos"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_graficos)?a._i(a.relatorioEditando.incluir_graficos,null)>-1:a.relatorioEditando.incluir_graficos},on:{change:function(o){var t=a.relatorioEditando.incluir_graficos,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_graficos",t.concat([i])):r>-1&&a.$set(a.relatorioEditando,"incluir_graficos",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_graficos",s)}}}),o("span",[a._v("ğŸ“Š Incluir GrÃ¡ficos")])]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_tabelas,expression:"relatorioEditando.incluir_tabelas"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_tabelas)?a._i(a.relatorioEditando.incluir_tabelas,null)>-1:a.relatorioEditando.incluir_tabelas},on:{change:function(o){var t=a.relatorioEditando.incluir_tabelas,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_tabelas",t.concat([i])):r>-1&&a.$set(a.relatorioEditando,"incluir_tabelas",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_tabelas",s)}}}),o("span",[a._v("ğŸ“‹ Incluir Tabelas")])]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_anexos,expression:"relatorioEditando.incluir_anexos"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_anexos)?a._i(a.relatorioEditando.incluir_anexos,null)>-1:a.relatorioEditando.incluir_anexos},on:{change:function(o){var t=a.relatorioEditando.incluir_anexos,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_anexos",t.concat([i])):r>-1&&a.$set(a.relatorioEditando,"incluir_anexos",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_anexos",s)}}}),o("span",[a._v("ğŸ“ Incluir Anexos")])]),o("label",{staticClass:"checkbox-item"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.relatorioEditando.incluir_assinaturas,expression:"relatorioEditando.incluir_assinaturas"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.relatorioEditando.incluir_assinaturas)?a._i(a.relatorioEditando.incluir_assinaturas,null)>-1:a.relatorioEditando.incluir_assinaturas},on:{change:function(o){var t=a.relatorioEditando.incluir_assinaturas,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.relatorioEditando,"incluir_assinaturas",t.concat([i])):r>-1&&a.$set(a.relatorioEditando,"incluir_assinaturas",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.relatorioEditando,"incluir_assinaturas",s)}}}),o("span",[a._v("âœï¸ Incluir Assinaturas")])])])]),o("div",{staticClass:"modal-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModal}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar RelatÃ³rio")+" ")])])])])])]):a._e()])},ba=[];const Da={name:"GerenciadorRelatorios",data(){return{relatorios:[],loading:!1,salvando:!1,showModal:!1,filtros:{titulo:"",categoria:"",status:"",tipo_relatorio:""},paginaAtual:1,itensPorPagina:12,relatorioEditando:this.getRelatorioVazio(),erro:null}},computed:{totalRelatorios(){return this.relatorios.length},relatoriosPendentes(){return this.relatorios.filter((a=>["pendente","gerando"].includes(a.status))).length},relatoriosConcluidos(){return this.relatorios.filter((a=>"concluido"===a.status)).length},relatoriosFiltrados(){let a=this.relatorios;return this.filtros.titulo&&(a=a.filter((a=>a.titulo.toLowerCase().includes(this.filtros.titulo.toLowerCase())))),this.filtros.categoria&&(a=a.filter((a=>a.categoria===this.filtros.categoria))),this.filtros.status&&(a=a.filter((a=>a.status===this.filtros.status))),this.filtros.tipo_relatorio&&(a=a.filter((a=>a.tipo_relatorio===this.filtros.tipo_relatorio))),a.sort(((a,o)=>new Date(o.created_at)-new Date(a.created_at)))},totalPaginas(){return Math.ceil(this.relatoriosFiltrados.length/this.itensPorPagina)},relatoriosPaginados(){const a=(this.paginaAtual-1)*this.itensPorPagina,o=a+this.itensPorPagina;return this.relatoriosFiltrados.slice(a,o)}},async mounted(){await this.carregarRelatorios()},methods:{async carregarRelatorios(){this.loading=!0,this.erro=null;try{const a=(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const{data:o,error:t}=await N.ND.from("relatorios").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(t)throw t;this.relatorios=o||[]}catch(a){console.error("Erro ao carregar relatÃ³rios:",a),this.erro="Erro ao carregar relatÃ³rios: "+a.message}finally{this.loading=!1}},aplicarFiltros(){this.paginaAtual=1},limparFiltros(){this.filtros={titulo:"",categoria:"",status:"",tipo_relatorio:""},this.paginaAtual=1},abrirModalNovoRelatorio(){this.relatorioEditando=this.getRelatorioVazio(),this.showModal=!0},editarRelatorio(a){this.relatorioEditando={...a},this.showModal=!0},fecharModal(){this.showModal=!1,this.relatorioEditando=this.getRelatorioVazio()},async salvarRelatorio(){this.salvando=!0;try{const a=(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const o={...this.relatorioEditando,tenant_id:a,updated_at:(new Date).toISOString()};if(this.relatorioEditando.id){const{error:a}=await N.ND.from("relatorios").update(o).eq("id",this.relatorioEditando.id);if(a)throw a}else{o.created_at=(new Date).toISOString();const{error:a}=await N.ND.from("relatorios").insert([o]);if(a)throw a}await this.carregarRelatorios(),this.fecharModal()}catch(a){console.error("Erro ao salvar relatÃ³rio:",a),alert("Erro ao salvar relatÃ³rio: "+a.message)}finally{this.salvando=!1}},async excluirRelatorio(a){if(confirm(`Tem certeza que deseja excluir o relatÃ³rio "${a.titulo}"?`))try{const{error:o}=await N.ND.from("relatorios").delete().eq("id",a.id);if(o)throw o;await this.carregarRelatorios()}catch(o){console.error("Erro ao excluir relatÃ³rio:",o),alert("Erro ao excluir relatÃ³rio: "+o.message)}},async gerarRelatorio(a){try{const{error:o}=await N.ND.from("relatorios").update({status:"gerando",progresso:0,updated_at:(new Date).toISOString()}).eq("id",a.id);if(o)throw o;this.simularGeracaoRelatorio(a.id),await this.carregarRelatorios()}catch(o){console.error("Erro ao iniciar geraÃ§Ã£o:",o),alert("Erro ao iniciar geraÃ§Ã£o: "+o.message)}},async simularGeracaoRelatorio(a){for(let o=10;o<=100;o+=10)await new Promise((a=>setTimeout(a,500))),await N.ND.from("relatorios").update({progresso:o,...100===o&&{status:"concluido",gerado_em:(new Date).toISOString(),url_arquivo_principal:`#relatorio-${a}.pdf`}}).eq("id",a),o%20===0&&await this.carregarRelatorios()},baixarRelatorio(a){alert(`Download do relatÃ³rio "${a.titulo}" iniciado!`)},visualizarRelatorio(a){alert(`Visualizando relatÃ³rio "${a.titulo}"`)},getRelatorioVazio(){return{titulo:"",descricao:"",categoria:"",tipo_relatorio:"",subtipo:"detalhado",formato_saida:"pdf",fonte_principal:"",periodo_dados_inicio:"",periodo_dados_fim:"",incluir_graficos:!0,incluir_tabelas:!0,incluir_anexos:!1,incluir_assinaturas:!0,status:"pendente",progresso:0}},getCategoriaLabel(a){const o={pesquisa_mercado:"Pesquisa de Mercado",cotacoes:"CotaÃ§Ãµes",comparativos:"Comparativos",analise_precos:"AnÃ¡lise de PreÃ§os",executivo:"Executivo"};return o[a]||a},getStatusLabel(a){const o={pendente:"Pendente",gerando:"Gerando",concluido:"ConcluÃ­do",erro:"Erro",cancelado:"Cancelado"};return o[a]||a},getTipoLabel(a){const o={consolidado:"Consolidado",analise_tecnica:"AnÃ¡lise TÃ©cnica",comparativo_precos:"Comparativo de PreÃ§os",executivo:"Executivo",custom:"Personalizado"};return o[a]||a},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):""}}},Ea=Da;var Aa=(0,C.A)(Ea,Ca,ba,!1,null,"27009c66",null);const wa=Aa.exports;var xa=function(){var a=this,o=a._self._c;return o("div",{staticClass:"gerenciador-marcas-despadronizadas"},[o("div",{staticClass:"header-section"},[o("div",{staticClass:"title-and-stats"},[o("h2",[a._v("ğŸš« Gerenciador de Marcas Despadronizadas")]),o("div",{staticClass:"stats-mini"},[o("span",{staticClass:"stat-item"},[o("strong",[a._v(a._s(a.totalMarcas))]),a._v(" Total ")]),o("span",{staticClass:"stat-item ativas"},[o("strong",[a._v(a._s(a.marcasAtivas))]),a._v(" Ativas ")]),o("span",{staticClass:"stat-item revisao"},[o("strong",[a._v(a._s(a.marcasPendenteRevisao))]),a._v(" Pendente RevisÃ£o ")]),o("span",{staticClass:"stat-item criticas"},[o("strong",[a._v(a._s(a.marcasCriticas))]),a._v(" CrÃ­ticas ")])])]),o("div",{staticClass:"actions-header"},[o("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovaMarca}},[a._v(" + Nova DespadronizaÃ§Ã£o ")]),o("button",{staticClass:"btn-secondary",on:{click:a.carregarMarcas}},[a._v(" ğŸ”„ Atualizar ")]),o("button",{staticClass:"btn-secondary",on:{click:a.exportarMarcas}},[a._v(" ğŸ“¤ Exportar ")])])]),o("div",{staticClass:"filtros-section"},[o("div",{staticClass:"filtros-linha"},[o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ·ï¸ Marca:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.marca,expression:"filtros.marca"}],attrs:{type:"text",placeholder:"Filtrar por marca..."},domProps:{value:a.filtros.marca},on:{input:[function(o){o.target.composing||a.$set(a.filtros,"marca",o.target.value)},a.aplicarFiltros]}})]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ“‹ Categoria:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.categoria,expression:"filtros.categoria"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"categoria",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"Impressoras"}},[a._v("Impressoras")]),o("option",{attrs:{value:"Computadores"}},[a._v("Computadores")]),o("option",{attrs:{value:"Tablets"}},[a._v("Tablets")]),o("option",{attrs:{value:"Telefones"}},[a._v("Telefones")]),o("option",{attrs:{value:"MobiliÃ¡rio"}},[a._v("MobiliÃ¡rio")]),o("option",{attrs:{value:"VeÃ­culos"}},[a._v("VeÃ­culos")]),o("option",{attrs:{value:"Outros"}},[a._v("Outros")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ¯ Status:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"status",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"ativa"}},[a._v("Ativa")]),o("option",{attrs:{value:"revogada"}},[a._v("DCB Cancelada")]),o("option",{attrs:{value:"expirada"}},[a._v("Expirada")]),o("option",{attrs:{value:"suspensa"}},[a._v("Suspensa")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("ğŸ”§ Tipo:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.tipo,expression:"filtros.tipo"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"tipo",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"total"}},[a._v("Total")]),o("option",{attrs:{value:"parcial"}},[a._v("Parcial")]),o("option",{attrs:{value:"temporaria"}},[a._v("TemporÃ¡ria")]),o("option",{attrs:{value:"definitiva"}},[a._v("Definitiva")])])]),o("div",{staticClass:"filtro-group"},[o("label",[a._v("âš ï¸ Criticidade:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.criticidade,expression:"filtros.criticidade"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"criticidade",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"baixo"}},[a._v("Baixa")]),o("option",{attrs:{value:"medio"}},[a._v("MÃ©dia")]),o("option",{attrs:{value:"alto"}},[a._v("Alta")])])])])]),a.marcasComRevisaoVencida.length>0?o("div",{staticClass:"alertas-section"},[o("div",{staticClass:"alerta-card alerta-warning"},[o("h4",[a._v("âš ï¸ RevisÃµes Pendentes")]),o("p",[a._v(a._s(a.marcasComRevisaoVencida.length)+" marca(s) com revisÃ£o vencida.")]),o("button",{staticClass:"btn-warning btn-small",on:{click:a.mostrarRevisoesVencidas}},[a._v(" Ver Detalhes ")])])]):a._e(),o("div",{staticClass:"marcas-lista"},[a.loading?o("div",{staticClass:"loading-state"},[o("div",{staticClass:"spinner"}),o("p",[a._v("Carregando marcas despadronizadas...")])]):0===a.marcasFiltradas.length?o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸš«")]),o("h3",[a._v("Nenhuma marca encontrada")]),o("p",[a._v("NÃ£o hÃ¡ marcas despadronizadas que correspondam aos filtros aplicados.")]),o("button",{staticClass:"btn-secondary",on:{click:a.limparFiltros}},[a._v("Limpar Filtros")])]):o("div",{staticClass:"marcas-grid"},a._l(a.marcasPaginadas,(function(t){return o("div",{key:t.id,staticClass:"marca-card",class:["status-"+t.status_atual,"criticidade-"+t.nivel_criticidade]},[o("div",{staticClass:"card-header"},[o("div",{staticClass:"marca-info"},[o("h4",[a._v(a._s(t.marca)+" "+a._s(t.modelo))]),o("span",{staticClass:"categoria-badge"},[a._v(a._s(t.categoria))])]),o("div",{staticClass:"status-badges"},[o("span",{staticClass:"status-badge",class:"status-"+t.status_atual},[a._v(" "+a._s(a.getStatusLabel(t.status_atual))+" ")]),o("span",{staticClass:"tipo-badge",class:"tipo-"+t.tipo_despadronizacao},[a._v(" "+a._s(a.getTipoLabel(t.tipo_despadronizacao))+" ")])])]),o("div",{staticClass:"card-content"},[o("div",{staticClass:"info-row"},[o("strong",[a._v("Processo:")]),a._v(" "+a._s(t.numero_processo)+" ")]),o("div",{staticClass:"info-row"},[o("strong",[a._v("Motivo:")]),a._v(" "+a._s(a.getMotivoLabel(t.motivo_principal))+" ")]),o("div",{staticClass:"info-row"},[o("strong",[a._v("Despadronizada em:")]),a._v(" "+a._s(a.formatarData(t.data_despadronizacao))+" ")]),t.data_fim_vigencia?o("div",{staticClass:"info-row"},[o("strong",[a._v("VigÃªncia atÃ©:")]),a._v(" "+a._s(a.formatarData(t.data_fim_vigencia))+" ")]):a._e(),o("div",{staticClass:"info-row criticidade"},[o("strong",[a._v("Criticidade:")]),o("span",{class:"nivel-"+t.nivel_criticidade},[a._v(" "+a._s(a.getCriticidadeLabel(t.nivel_criticidade))+" ")])]),t.proxima_revisao?o("div",{staticClass:"info-row revisao"},[o("strong",[a._v("PrÃ³xima RevisÃ£o:")]),o("span",{class:{vencida:a.isRevisaoVencida(t.proxima_revisao)}},[a._v(" "+a._s(a.formatarData(t.proxima_revisao))+" "),a.isRevisaoVencida(t.proxima_revisao)?o("span",{staticClass:"vencida-label"},[a._v(" ("+a._s(a.diasAtraso(t.proxima_revisao))+" dias atraso) ")]):a._e()])]):a._e()]),o("div",{staticClass:"card-actions"},[o("button",{staticClass:"btn-action view",attrs:{title:"Visualizar Detalhes"},on:{click:function(o){return a.visualizarMarca(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]),o("button",{staticClass:"btn-action edit",attrs:{title:"Editar"},on:{click:function(o){return a.editarMarca(t)}}},[a._v(" âœï¸ Editar ")]),"ativa"===t.status_atual?o("button",{staticClass:"btn-action review",attrs:{title:"Programar RevisÃ£o"},on:{click:function(o){return a.programarRevisao(t)}}},[a._v(" ğŸ“… RevisÃ£o ")]):a._e(),o("button",{staticClass:"btn-action notify",attrs:{title:"NotificaÃ§Ãµes"},on:{click:function(o){return a.gerenciarNotificacoes(t)}}},[a._v(" ğŸ“§ Notificar ")]),o("button",{staticClass:"btn-action history",attrs:{title:"Ver HistÃ³rico"},on:{click:function(o){return a.verHistorico(t)}}},[a._v(" ğŸ“‹ HistÃ³rico ")]),"ativa"===t.status_atual?o("button",{staticClass:"btn-action revoke",attrs:{title:"DCB Cancelada"},on:{click:function(o){return a.revogarMarca(t)}}},[a._v(" âŒ DCB Cancelada ")]):a._e()])])})),0)]),a.totalPaginas>1?o("div",{staticClass:"paginacao"},[o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual<=1},on:{click:function(o){a.paginaAtual--}}},[a._v(" â€¹ Anterior ")]),o("span",{staticClass:"pagina-info"},[a._v(" PÃ¡gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),o("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual>=a.totalPaginas},on:{click:function(o){a.paginaAtual++}}},[a._v(" PrÃ³xima â€º ")])]):a._e(),a.showModal?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModal}},[o("div",{staticClass:"modal-content modal-large",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.marcaEditando.id?"Editar DespadronizaÃ§Ã£o":"Nova DespadronizaÃ§Ã£o"))]),o("button",{staticClass:"modal-close",on:{click:a.fecharModal}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarMarca.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ” Produto do CatÃ¡logo*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.produto_id,expression:"marcaEditando.produto_id"}],staticClass:"produto-select",attrs:{required:""},on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.marcaEditando,"produto_id",o.target.multiple?t:t[0])},a.preencherDadosProduto]}},[o("option",{attrs:{value:""}},[a._v("Selecione o produto a ser despadronizado...")]),a._l(a.produtosAtivos,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" - "+a._s(t.marca||"S/Marca")+" "+a._s(t.modelo||"")+" ")])}))],2),o("small",[a._v(a._s(a.produtosAtivos.length)+" produto(s) aprovado(s) disponÃ­vel(is) para despadronizaÃ§Ã£o")])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ·ï¸ Marca")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.marca,expression:"marcaEditando.marca"}],attrs:{type:"text",readonly:"",placeholder:"SerÃ¡ preenchido automaticamente"},domProps:{value:a.marcaEditando.marca},on:{input:function(o){o.target.composing||a.$set(a.marcaEditando,"marca",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“± Modelo")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.modelo,expression:"marcaEditando.modelo"}],attrs:{type:"text",readonly:"",placeholder:"SerÃ¡ preenchido automaticamente"},domProps:{value:a.marcaEditando.modelo},on:{input:function(o){o.target.composing||a.$set(a.marcaEditando,"modelo",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“„ NÃºmero do Processo*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.numero_processo,expression:"marcaEditando.numero_processo"}],attrs:{type:"text",required:"",placeholder:"Ex: PROC-2024-001"},domProps:{value:a.marcaEditando.numero_processo},on:{input:function(o){o.target.composing||a.$set(a.marcaEditando,"numero_processo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“… Data de DespadronizaÃ§Ã£o*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.data_despadronizacao,expression:"marcaEditando.data_despadronizacao"}],attrs:{type:"date",required:""},domProps:{value:a.marcaEditando.data_despadronizacao},on:{input:function(o){o.target.composing||a.$set(a.marcaEditando,"data_despadronizacao",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ¯ Motivo Principal*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.motivo_principal,expression:"marcaEditando.motivo_principal"}],attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.marcaEditando,"motivo_principal",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),o("option",{attrs:{value:"qualidade"}},[a._v("Problemas de Qualidade")]),o("option",{attrs:{value:"custo"}},[a._v("Custo Elevado")]),o("option",{attrs:{value:"descontinuacao"}},[a._v("DescontinuaÃ§Ã£o")]),o("option",{attrs:{value:"seguranca"}},[a._v("Problemas de SeguranÃ§a")]),o("option",{attrs:{value:"fornecimento"}},[a._v("Problemas de Fornecimento")]),o("option",{attrs:{value:"tecnico"}},[a._v("ObsolescÃªncia TÃ©cnica")]),o("option",{attrs:{value:"outros"}},[a._v("Outros")])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ”§ Tipo*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.tipo_despadronizacao,expression:"marcaEditando.tipo_despadronizacao"}],attrs:{required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.marcaEditando,"tipo_despadronizacao",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),o("option",{attrs:{value:"total"}},[a._v("Total")]),o("option",{attrs:{value:"temporaria"}},[a._v("TemporÃ¡ria")]),o("option",{attrs:{value:"definitiva"}},[a._v("Definitiva")])])])]),o("div",{staticClass:"form-group"},[o("label",[a._v("ğŸ“ Justificativa*")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.marcaEditando.justificativa,expression:"marcaEditando.justificativa"}],attrs:{rows:"4",required:"",placeholder:"Descreva os motivos que levaram Ã  despadronizaÃ§Ã£o..."},domProps:{value:a.marcaEditando.justificativa},on:{input:function(o){o.target.composing||a.$set(a.marcaEditando,"justificativa",o.target.value)}}})]),o("div",{staticClass:"modal-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModal}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar DespadronizaÃ§Ã£o")+" ")])])])])])]):a._e()])},Pa=[];const Sa={name:"GerenciadorMarcasDespadronizadas",data(){return{marcas:[],produtos:[],loading:!1,salvando:!1,showModal:!1,activeModalTab:"basicos",filtros:{marca:"",categoria:"",status:"",tipo:"",criticidade:""},paginaAtual:1,itensPorPagina:12,marcaEditando:this.getMarcaVazia(),erro:null}},computed:{totalMarcas(){return this.marcas.length},marcasAtivas(){return this.marcas.filter((a=>"ativa"===a.status_atual)).length},marcasPendenteRevisao(){return this.marcas.filter((a=>a.proxima_revisao&&new Date(a.proxima_revisao)<=new Date)).length},marcasCriticas(){return this.marcas.filter((a=>"critico"===a.nivel_criticidade)).length},marcasComRevisaoVencida(){return this.marcas.filter((a=>a.proxima_revisao&&new Date(a.proxima_revisao)<new Date&&"ativa"===a.status_atual))},marcasFiltradas(){let a=this.marcas;return this.filtros.marca&&(a=a.filter((a=>a.marca.toLowerCase().includes(this.filtros.marca.toLowerCase())||a.modelo&&a.modelo.toLowerCase().includes(this.filtros.marca.toLowerCase())))),this.filtros.categoria&&(a=a.filter((a=>a.categoria===this.filtros.categoria))),this.filtros.status&&(a=a.filter((a=>a.status_atual===this.filtros.status))),this.filtros.tipo&&(a=a.filter((a=>a.tipo_despadronizacao===this.filtros.tipo))),this.filtros.criticidade&&(a=a.filter((a=>a.nivel_criticidade===this.filtros.criticidade))),a.sort(((a,o)=>new Date(o.created_at)-new Date(a.created_at)))},totalPaginas(){return Math.ceil(this.marcasFiltradas.length/this.itensPorPagina)},marcasPaginadas(){const a=(this.paginaAtual-1)*this.itensPorPagina,o=a+this.itensPorPagina;return this.marcasFiltradas.slice(a,o)},produtosAtivos(){const a=this.marcas.filter((a=>"ativa"===a.status_atual&&a.produto_id)).map((a=>a.produto_id));return this.produtos.filter((o=>!a.includes(o.id)))}},async mounted(){await this.carregarMarcas(),await this.carregarProdutos()},methods:{async carregarMarcas(){this.loading=!0,this.erro=null;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const{data:o,error:t}=await N.ND.from("marcas_despadronizadas").select("*").eq("tenant_id",a).order("created_at",{ascending:!1});if(t)throw t;this.marcas=o||[],console.log("Marcas carregadas:",this.marcas.length)}catch(a){console.error("Erro ao carregar marcas:",a),this.erro="Erro ao carregar marcas: "+a.message}finally{this.loading=!1}},async carregarProdutos(){try{const a=await(0,N.EO)();if(console.log("ğŸ”‘ Carregando produtos para tenant:",a),!a)return;const{data:o,error:t}=await N.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status").eq("tenant_id",a).in("status",["aprovado","julgado_aprovado","homologado"]).order("nome",{ascending:!0});if(t)throw console.error("âŒ Erro na query Supabase:",t),t;this.produtos=o||[],console.log("âœ… Produtos carregados no marcas-despadronizadas:",this.produtos.length),console.log("ğŸ“‹ Primeiros produtos:",this.produtos.slice(0,3));const e=this.produtos.filter((a=>["julgado_aprovado","homologado"].includes(a.status)));console.log("ğŸ›ï¸ Produtos julgados encontrados:",e.length),e.length>0&&console.log("ğŸ“‹ Produtos julgados:",e.map((a=>`${a.nome} (${a.status})`)));const s={};this.produtos.forEach((a=>{s[a.status]=(s[a.status]||0)+1})),console.log("ğŸ“Š Status dos produtos:",s),0===this.produtos.length&&console.warn("âš ï¸ Nenhum produto APROVADO ou JULGADO_APROVADO encontrado")}catch(a){console.error("ğŸ’¥ Erro ao carregar produtos:",a)}},preencherDadosProduto(){if(!this.marcaEditando.produto_id)return this.marcaEditando.marca="",void(this.marcaEditando.modelo="");const a=this.produtos.find((a=>a.id===this.marcaEditando.produto_id));a?(this.marcaEditando.marca=a.marca||"",this.marcaEditando.modelo=a.modelo||"",console.log("âœ… Dados do produto preenchidos:",{nome:a.nome,marca:a.marca,modelo:a.modelo})):console.error("âŒ Produto nÃ£o encontrado no array:",this.marcaEditando.produto_id)},aplicarFiltros(){this.paginaAtual=1},limparFiltros(){this.filtros={marca:"",categoria:"",status:"",tipo:"",criticidade:""},this.paginaAtual=1},abrirModalNovaMarca(){this.marcaEditando=this.getMarcaVazia(),this.showModal=!0},editarMarca(a){this.marcaEditando={...a},this.showModal=!0},fecharModal(){this.showModal=!1,this.marcaEditando=this.getMarcaVazia()},async salvarMarca(){this.salvando=!0;try{const a=await(0,N.EO)();if(!a)throw new Error("Tenant ID nÃ£o encontrado");const o={...this.marcaEditando,tenant_id:a,status_atual:"ativa",nivel_criticidade:"medio",updated_at:(new Date).toISOString()};if(this.marcaEditando.id){const{error:a}=await N.ND.from("marcas_despadronizadas").update(o).eq("id",this.marcaEditando.id);if(a)throw a}else{o.created_at=(new Date).toISOString();const{error:a}=await N.ND.from("marcas_despadronizadas").insert([o]);if(a)throw a;this.marcaEditando.produto_id&&"MANUAL"!==this.marcaEditando.produto_id&&await this.atualizarStatusProduto(this.marcaEditando.produto_id,"despadronizada")}await this.carregarMarcas(),this.fecharModal(),this.$swal({title:"Sucesso!",text:"Marca despadronizada salva com sucesso!",icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao salvar marca:",a),this.$swal({title:"Erro",text:"Erro ao salvar marca: "+a.message,icon:"error"})}finally{this.salvando=!1}},async revogarMarca(a){const o=await this.$swal({title:"DCB Cancelada?",text:`Tem certeza que deseja cancelar a DCB da marca "${a.marca} ${a.modelo}"?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, Cancelar DCB",cancelButtonText:"Cancelar"});if(o.isConfirmed)try{const{error:o}=await N.ND.from("marcas_despadronizadas").update({status_atual:"revogada",updated_at:(new Date).toISOString()}).eq("id",a.id);if(o)throw o;a.produto_id&&await this.atualizarStatusProduto(a.produto_id,"ativa"),await this.carregarMarcas(),this.$swal({title:"DCB Cancelada!",text:"DCB cancelada com sucesso.",icon:"success",timer:2e3,showConfirmButton:!1})}catch(t){console.error("Erro ao cancelar DCB:",t),this.$swal({title:"Erro",text:"Erro ao cancelar DCB: "+t.message,icon:"error"})}},async atualizarStatusProduto(a,o){try{await this.carregarProdutos(),console.log("âœ… Lista de produtos atualizada apÃ³s "+("despadronizada"===o?"despadronizaÃ§Ã£o":"revogaÃ§Ã£o")),console.log("â„¹ï¸ O status serÃ¡ sincronizado automaticamente no CatÃ¡logo de Marcas")}catch(t){console.error("âŒ Erro ao atualizar lista de produtos:",t)}},async exportarMarcas(){try{if(0===this.marcasFiltradas.length)return void this.$swal({title:"AtenÃ§Ã£o",text:"NÃ£o hÃ¡ marcas para exportar com os filtros aplicados.",icon:"warning"});const{value:a}=await this.$swal({title:"ğŸ“¤ Exportar Marcas Despadronizadas",text:`Exportar ${this.marcasFiltradas.length} marca(s). Escolha o formato:`,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ“Š Excel (.xlsx)",cancelButtonText:"ğŸ“„ CSV (.csv)",showDenyButton:!0,denyButtonText:"Cancelar",reverseButtons:!0});if(void 0===a)return;this.$swal({title:"Sucesso!",text:`${this.marcasFiltradas.length} marca(s) exportada(s) com sucesso!`,icon:"success",timer:2e3,showConfirmButton:!1})}catch(a){console.error("Erro ao exportar marcas:",a),this.$swal({title:"Erro",text:"Erro ao exportar marcas: "+a.message,icon:"error"})}},visualizarMarca(a){this.$swal({title:`${a.marca} ${a.modelo}`,html:`\n          <div style="text-align: left; margin: 20px 0;">\n            <h4>ğŸ“¦ Dados do Produto</h4>\n            <p><strong>Categoria:</strong> ${a.categoria}</p>\n            <p><strong>Fabricante:</strong> ${a.fabricante||"N/A"}</p>\n            <p><strong>CÃ³digo:</strong> ${a.codigo_produto||"N/A"}</p>\n            \n            <h4>ğŸ“‹ DespadronizaÃ§Ã£o</h4>\n            <p><strong>Processo:</strong> ${a.numero_processo}</p>\n            <p><strong>Tipo:</strong> ${this.getTipoLabel(a.tipo_despadronizacao)}</p>\n            <p><strong>Motivo:</strong> ${this.getMotivoLabel(a.motivo_principal)}</p>\n            <p><strong>Status:</strong> ${this.getStatusLabel(a.status_atual)}</p>\n            <p><strong>Criticidade:</strong> ${this.getCriticidadeLabel(a.nivel_criticidade)}</p>\n            \n            <h4>ğŸ“ Justificativa</h4>\n            <p>${a.justificativa||"N/A"}</p>\n          </div>\n        `,icon:"info",customClass:{popup:"swal-wide"}})},programarRevisao(a){this.$swal({title:"ğŸ“… Programar RevisÃ£o",text:`Funcionalidade em desenvolvimento - Programar revisÃ£o para ${a.marca}`,icon:"info"})},gerenciarNotificacoes(a){this.$swal({title:"ğŸ“§ Gerenciar NotificaÃ§Ãµes",text:`Funcionalidade em desenvolvimento - NotificaÃ§Ãµes para ${a.marca}`,icon:"info"})},verHistorico(a){this.$swal({title:"ğŸ“‹ HistÃ³rico",text:`Funcionalidade em desenvolvimento - HistÃ³rico de ${a.marca}`,icon:"info"})},mostrarRevisoesVencidas(){const a=this.marcasComRevisaoVencida.map((a=>`â€¢ ${a.marca} ${a.modelo} - Vencida hÃ¡ ${this.diasAtraso(a.proxima_revisao)} dias`)).join("<br>");this.$swal({title:"âš ï¸ RevisÃµes Vencidas",html:`<div style="text-align: left;">${a}</div>`,icon:"warning"})},getMarcaVazia(){return{produto_id:"",marca:"",modelo:"",numero_processo:"",data_despadronizacao:"",tipo_despadronizacao:"",motivo_principal:"",justificativa:""}},getStatusLabel(a){const o={ativa:"Ativa",revogada:"DCB Cancelada",expirada:"Expirada",suspensa:"Suspensa"};return o[a]||a},getTipoLabel(a){const o={total:"Total",parcial:"Parcial",temporaria:"TemporÃ¡ria",definitiva:"Definitiva"};return o[a]||a},getMotivoLabel(a){const o={qualidade:"Problemas de Qualidade",custo:"Custo Elevado",descontinuacao:"DescontinuaÃ§Ã£o",seguranca:"Problemas de SeguranÃ§a",fornecimento:"Problemas de Fornecimento",tecnico:"ObsolescÃªncia TÃ©cnica",manutencao:"Dificuldade de ManutenÃ§Ã£o",outros:"Outros"};return o[a]||a},getCriticidadeLabel(a){const o={baixo:"Baixa",medio:"MÃ©dia",alto:"Alta",critico:"CrÃ­tica"};return o[a]||a},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):""},isRevisaoVencida(a){return!!a&&new Date(a)<new Date},diasAtraso(a){if(!a)return 0;const o=new Date,t=new Date(a),e=o-t,s=Math.ceil(e/864e5);return Math.max(0,s)}}},ya=Sa;var Oa=(0,C.A)(ya,xa,Pa,!1,null,"00ed113b",null);const $a=Oa.exports,Na={name:"DashboardCPM",components:{PesquisaBot:aa,GerenciadorCotacoes:ra,GerenciadorComparativo:ma,GerenciadorAnalisePrecos:fa,GerenciadorRelatorios:wa,GerenciadorMarcasDespadronizadas:$a},data(){return{activeTab:"dashboard",activeSubTab:"pesquisa-tecnica",cotacoes:[],produtos:[],produtosComDiligencia:[],pendentes:0,aprovados:0,reprovados:0,currentTenantId:null,loading:!1,editais:[],editaisFiltrados:[],loadingEditais:!1,modalNovoEdital:!1,modalVisualizarEdital:!1,modalEditarEdital:!1,modalParticipantes:!1,modalNovoParticipante:!1,modoEdicaoEdital:!1,salvandoEdital:!1,salvandoEdicaoEdital:!1,editalEditando:{id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:""},modalAddMinuta:!1,minutasDisponiveis:[],minutaSelecionada:null,criandoEdital:!1,novaMinuta:{nome:"",categoria:"geral",descricao:"",arquivo:null},salvandoMinuta:!1,editalAtual:{id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:"",url_documento:"",nome_arquivo:""},editalSelecionado:{},filtroEditais:{busca:"",status:""},debounceTimer:null,participantes:[],participantesFiltrados:[],loadingParticipantes:!1,participanteAtual:{id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},filtroParticipantes:{busca:"",status:""},impugnacoes:[],modalNovaImpugnacao:!1,salvandoImpugnacao:!1,editaisParaImpugnacao:[],carregandoEditais:!1,novaImpugnacao:{edital_id:"",impugnante:"",email:"",empresa:"",motivo:"",documentos:[]},certificados:[],activeTabDCB:"emitir",produtosProntosDCB:[],produtosProntosDCBFiltrados:[],dcbsEmitidos:[],dcbsHistoricoFiltrados:[],dcbsVencendo:[],dcbsVencidos:[],emitindoDCB:null,modalProdutoDetalhes:!1,modalVisualizarDCB:!1,produtoSelecionado:null,dcbSelecionado:null,filtrosDCB:{busca:"",categoria:"",dataAprovacao:""},filtrosHistorico:{numeroDCB:"",status:"",dataInicio:"",dataFim:""},itensPorPagina:5,paginaAtual:1,totalPaginas:1,paginasVisiveis:[],filtros:{nome:"",marca:"",status:"",data:""},produtosPaginados:[],produtosFiltrados:[],itensPorPaginaDiligencia:5,paginaAtualDiligencia:1,totalPaginasDiligencia:1,paginasVisiveisDiligencia:[],filtrosDiligencia:{busca:"",marca:"",data:""},diligenciasFiltradas:[],diligenciasPaginadas:[],usuarios:[],usuariosFiltrados:[],modalNovoUsuario:!1,usuarioAtual:{id:null,nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[],criar_login:!1,user_id:null,senha_temporaria:null,convite_enviado:!1,convite_aceito:!1},filtroUsuarios:{busca:"",unidade:""},statusConvites:{},notificacoes:[],produtosDisponiveis:[],loadingProdutos:!1,reclamacoes:[],reclamacoesFiltradas:[],salvandoResposta:!1,salvandoStatus:!1,salvandoPrioridade:!1,filtroReclamacoes:{busca:"",status:"",prioridade:""}}},created(){this.obterTenantId().then((()=>{this.carregarDados()}))},async mounted(){await this.carregarDados(),this.inicializarFiltros(),await this.carregarProdutos(),"lembretes"===this.activeTab&&(await this.carregarEstatisticasLembretes(),await this.carregarRdmsPendentes())},beforeUnmount(){this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null)},watch:{activeTab(a){"lembretes"===a?this.$nextTick((()=>{this.carregarEstatisticasLembretes&&this.carregarEstatisticasLembretes(),this.carregarRdmsPendentes&&this.carregarRdmsPendentes()})):"despadronizadas"===a?this.$nextTick((()=>{this.$refs.gerenciadorMarcas&&this.$refs.gerenciadorMarcas.carregarProdutos&&(console.log("ğŸ”„ Recarregando produtos no gerenciador de marcas..."),this.$refs.gerenciadorMarcas.carregarProdutos())})):"reclamacoes"===a&&this.$nextTick((()=>{this.carregarReclamacoes()}))}},computed:{marcasUnicas(){const a=[...new Set(this.produtosComDiligencia.map((a=>a.marca)))];return a.filter((a=>a)).sort()},editalSelecionadoInfo(){return this.novaImpugnacao.edital_id?this.editaisParaImpugnacao.find((a=>a.id===this.novaImpugnacao.edital_id)):null},temFiltrosAplicados(){return this.filtros.nome||this.filtros.marca||this.filtros.status||this.filtros.data},temFiltrosDiligenciaAplicados(){return this.filtrosDiligencia.busca||this.filtrosDiligencia.marca||this.filtrosDiligencia.data},editaisAtivos(){return this.editais.filter((a=>"PUBLICADO"===a.status))},editaisRascunho(){return this.editais.filter((a=>"RASCUNHO"===a.status))},reclamacoesPendentes(){return this.reclamacoes.filter((a=>"pendente"===a.status||"em_analise"===a.status)).length},reclamacoesRespondidas(){return this.reclamacoes.filter((a=>"respondida"===a.status||"resolvida"===a.status)).length},reclamacoesNaoRespondidas(){return this.reclamacoes.filter((a=>"pendente"===a.status||"em_analise"===a.status)).length},editaisFinalizados(){return this.editais.filter((a=>"CANCELADO"===a.status))},totalParticipantes(){return this.editais.reduce(((a,o)=>a+(o.participantes_count||0)),0)},unidadesUnicas(){const a=[...new Set(this.usuarios.map((a=>a.unidade_setor)))];return a.filter((a=>a)).sort()}},methods:{async obterTenantId(){try{const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)return void console.error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");if(o.user_metadata?.tenant_id)return this.currentTenantId=o.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:t,error:e}=await N.ND.from("usuarios").select("tenant_id").eq("email",o.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);t?.tenant_id?(this.currentTenantId=t.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID nÃ£o encontrado para o usuÃ¡rio")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){try{if(this.loading=!0,!this.currentTenantId&&(console.error("Tenant ID nÃ£o disponÃ­vel. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return void console.error("NÃ£o foi possÃ­vel obter o tenant_id, impossÃ­vel carregar dados");console.log("Carregando produtos para tenant_id:",this.currentTenantId);const{data:a,error:o}=await N.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(o)throw o;const t=a||[];this.produtos=t.filter((a=>["pendente","aprovado","reprovado","em_analise","julgado_aprovado","julgado_reprovado"].includes(a.status))),console.log(`${this.produtos.length} requerimentos recentes carregados (sem diligÃªncias)`),this.produtosComDiligencia=t.filter((a=>"diligencia"===a.status)),console.log(`${this.produtosComDiligencia.length} produtos com diligÃªncia carregados`),await this.carregarImpugnacoes(),await this.carregarDadosDCB(),await this.carregarEditais(),await this.carregarMinutasDisponiveis(),await this.carregarUsuarios(),await this.carregarReclamacoes();const e=await Promise.all([this.contarPorStatus("pendente"),this.contarPorStatus("aprovado"),this.contarPorStatus("reprovado")]);this.pendentes=e[0],this.aprovados=e[1],this.reprovados=e[2]}catch(a){console.error("Erro ao carregar dados:",a)}finally{this.loading=!1,this.$nextTick((()=>{this.inicializarFiltros()}))}},async contarPorStatus(a){if(!this.currentTenantId)return 0;let o=N.ND.from("produtos").select("id",{count:"exact"}).eq("tenant_id",this.currentTenantId);o="aprovado"===a?o.in("status",["aprovado","julgado_aprovado","homologado"]):"reprovado"===a?o.in("status",["reprovado","julgado_reprovado"]):o.eq("status",a);const{count:t,error:e}=await o;return e?(console.error(`Erro ao contar produtos ${a}:`,e),0):t||0},verProduto(a){this.$router.push(`/analise/${a}`)},getImpugnacaoStatusClass(a){switch(a){case"EM ANÃLISE":return"status-pendente";case"DEFERIDA":return"status-aprovado";case"INDEFERIDA":return"status-reprovado";default:return""}},async analisarImpugnacao(a){try{const{data:o,error:t}=await N.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("id",a).single();if(t)throw t;const{value:e}=await this.$swal({title:"AnÃ¡lise de ImpugnaÃ§Ã£o",html:`\n            <div style="text-align: left;">\n              <h4>ImpugnaÃ§Ã£o de: ${o.impugnante}</h4>\n              <p><strong>Edital:</strong> ${o.editais?.numero} - ${o.editais?.descricao}</p>\n              <p><strong>Data:</strong> ${this.formatDate(o.data_impugnacao)}</p>\n              <p><strong>Prazo Final:</strong> ${this.formatDate(o.prazo_final)}</p>\n              <p><strong>Motivo:</strong> ${o.motivo}</p>\n              <p><strong>Status Atual:</strong> ${o.status}</p>\n            </div>\n            <hr>\n            <label for="decisao"><strong>DecisÃ£o:</strong></label>\n            <select id="decisao" class="swal2-input">\n              <option value="">Selecione uma decisÃ£o</option>\n              <option value="DEFERIDA">DEFERIDA (Procedente)</option>\n              <option value="INDEFERIDA">INDEFERIDA (Improcedente)</option>\n              <option value="PARCIALMENTE_DEFERIDA">PARCIALMENTE DEFERIDA</option>\n            </select>\n            <label for="justificativa"><strong>Justificativa da DecisÃ£o:</strong></label>\n            <textarea id="justificativa" class="swal2-textarea" placeholder="Fundamente a decisÃ£o tomada..."></textarea>\n          `,focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("decisao").value,o=document.getElementById("justificativa").value;return a?!o||o.trim().length<10?(this.$swal.showValidationMessage("A justificativa deve ter pelo menos 10 caracteres"),!1):{decisao:a,justificativa:o}:(this.$swal.showValidationMessage("Selecione uma decisÃ£o"),!1)}});e&&await this.salvarDecisaoImpugnacao(a,e.decisao,e.justificativa)}catch(o){console.error("Erro ao analisar impugnaÃ§Ã£o:",o),this.$swal({title:"Erro",text:"Erro ao carregar dados da impugnaÃ§Ã£o",icon:"error"})}},async carregarImpugnacoes(){try{const{data:a,error:o}=await N.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("tenant_id",this.currentTenantId).order("data_impugnacao",{ascending:!1}).limit(10);if(o)throw o;this.impugnacoes=a?.map((a=>({...a,produto_nome:`Edital ${a.editais?.numero||"N/A"}`})))||[],console.log(`${this.impugnacoes.length} impugnaÃ§Ãµes carregadas`)}catch(a){console.error("Erro ao carregar impugnaÃ§Ãµes:",a),this.impugnacoes=[]}},async salvarDecisaoImpugnacao(a,o,t){try{const{error:e}=await N.ND.from("impugnacoes").update({status:o,justificativa_decisao:t,data_decisao:(new Date).toISOString(),analisado_por:"CPM"}).eq("id",a);if(e)throw e;this.$swal({title:"Sucesso!",text:"DecisÃ£o da impugnaÃ§Ã£o salva com sucesso",icon:"success"}),await this.carregarImpugnacoes()}catch(e){console.error("Erro ao salvar decisÃ£o:",e),this.$swal({title:"Erro",text:"Erro ao salvar decisÃ£o da impugnaÃ§Ã£o",icon:"error"})}},async verDecisaoImpugnacao(a){try{const{data:o,error:t}=await N.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("id",a).single();if(t)throw t;const e=o,s="DEFERIDA"===e.status?"Deferida":"INDEFERIDA"===e.status?"Indeferida":"Pendente de anÃ¡lise";this.$swal({title:"DecisÃ£o da ImpugnaÃ§Ã£o",html:`\n            <div style="text-align: left;">\n              <h4>ImpugnaÃ§Ã£o de: ${e.impugnante}</h4>\n              <p><strong>Edital:</strong> ${e.editais?.numero} - ${e.editais?.descricao}</p>\n              <p><strong>Data da ImpugnaÃ§Ã£o:</strong> ${this.formatDate(e.data_impugnacao)}</p>\n              <p><strong>Motivo:</strong> ${e.motivo}</p>\n              <hr>\n              <h4>DecisÃ£o:</h4>\n              <p><strong>Status:</strong> <span style="color: ${"DEFERIDA"===e.status?"#27ae60":"INDEFERIDA"===e.status?"#e74c3c":"#f39c12"}">${s}</span></p>\n              ${e.justificativa_decisao?`<p><strong>Justificativa:</strong> ${e.justificativa_decisao}</p>`:""}\n              ${e.data_decisao?`<p><strong>Data da DecisÃ£o:</strong> ${this.formatDate(e.data_decisao)}</p>`:""}\n              ${e.analisado_por?`<p><strong>Analisado por:</strong> ${e.analisado_por}</p>`:""}\n              ${e.data_decisao?"":"<p><em>Esta impugnaÃ§Ã£o ainda nÃ£o foi analisada.</em></p>"}\n            </div>\n          `,width:"600px",confirmButtonText:"Fechar"})}catch(o){console.error("Erro ao carregar decisÃ£o:",o),this.$swal({title:"Erro",text:"Erro ao carregar decisÃ£o da impugnaÃ§Ã£o",icon:"error"})}},async abrirModalNovaImpugnacao(){this.modalNovaImpugnacao=!0,this.limparFormularioImpugnacao(),await this.carregarEditaisParaImpugnacao()},fecharModalNovaImpugnacao(){this.modalNovaImpugnacao=!1,this.limparFormularioImpugnacao()},async carregarEditaisParaImpugnacao(){try{this.carregandoEditais=!0;const{data:a,error:o}=await N.ND.from("editais").select("id, numero, descricao, status, data_publicacao, data_limite_impugnacao").eq("tenant_id",this.currentTenantId).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(o)throw o;this.editaisParaImpugnacao=a||[],0===this.editaisParaImpugnacao.length&&this.$swal({title:"Nenhum Edital DisponÃ­vel",text:"NÃ£o hÃ¡ editais publicados disponÃ­veis para impugnaÃ§Ã£o no momento.",icon:"info"})}catch(a){console.error("Erro ao carregar editais:",a),this.$swal({title:"Erro",text:"Erro ao carregar editais disponÃ­veis.",icon:"error"})}finally{this.carregandoEditais=!1}},limparFormularioImpugnacao(){this.novaImpugnacao={edital_id:"",impugnante:"",email:"",empresa:"",motivo:"",documentos:[]}},editalDentroDoPrazo(a){if(!a.data_limite_impugnacao)return!1;const o=new Date,t=new Date(a.data_limite_impugnacao);return o<=t},handleDocumentosUpload(a){const o=a.target.files;this.novaImpugnacao.documentos=Array.from(o)},async salvarNovaImpugnacao(){if(!this.salvandoImpugnacao)try{this.salvandoImpugnacao=!0;const a=this.editaisParaImpugnacao.find((a=>a.id===this.novaImpugnacao.edital_id));if(!this.editalDentroDoPrazo(a))return void this.$swal({title:"Prazo Vencido",text:"O prazo para impugnaÃ§Ã£o deste edital jÃ¡ expirou.",icon:"error"});const o=new Date,t=new Date(o);t.setDate(t.getDate()+7);const e={edital_id:this.novaImpugnacao.edital_id,impugnante:this.novaImpugnacao.impugnante,email_impugnante:this.novaImpugnacao.email,documento_impugnante:this.novaImpugnacao.documento||"00000000000",motivo:this.novaImpugnacao.motivo,data_impugnacao:o.toISOString(),prazo_final:t.toISOString(),status:"EM_ANALISE",tenant_id:this.currentTenantId,criado_em:(new Date).toISOString()},{data:s,error:i}=await N.ND.from("impugnacoes").insert(e).select().single();if(i)throw i;this.novaImpugnacao.documentos.length>0&&console.log("Documentos a serem enviados:",this.novaImpugnacao.documentos),this.$swal({title:"Sucesso!",text:"ImpugnaÃ§Ã£o registrada com sucesso. VocÃª receberÃ¡ atualizaÃ§Ãµes por email.",icon:"success",timer:4e3}),await this.carregarImpugnacoes(),this.fecharModalNovaImpugnacao()}catch(a){console.error("Erro ao salvar impugnaÃ§Ã£o:",a),this.$swal({title:"Erro",text:a.message||"Erro ao registrar impugnaÃ§Ã£o. Tente novamente.",icon:"error"})}finally{this.salvandoImpugnacao=!1}},async solicitarDiligencia(a){try{const{value:o}=await this.$swal({title:"Solicitar DiligÃªncia",html:'\n             <label for="tipo_diligencia"><strong>Tipo de DiligÃªncia:</strong></label>\n             <select id="tipo_diligencia" class="swal2-input">\n               <option value="">Selecione o tipo</option>\n               <option value="DOCUMENTACAO_FALTANTE">DocumentaÃ§Ã£o Faltante</option>\n               <option value="AMOSTRA_INADEQUADA">Amostra Inadequada</option>\n               <option value="ESPECIFICACAO_INCOMPLETA">EspecificaÃ§Ã£o Incompleta</option>\n               <option value="CERTIFICACAO_PENDENTE">CertificaÃ§Ã£o Pendente</option>\n               <option value="ESCLARECIMENTO_TECNICO">Esclarecimento TÃ©cnico</option>\n             </select>\n             <label for="descricao_diligencia"><strong>DescriÃ§Ã£o da DiligÃªncia:</strong></label>\n             <textarea id="descricao_diligencia" class="swal2-textarea" placeholder="Descreva detalhadamente o que precisa ser providenciado..."></textarea>\n             <label for="prazo_dias"><strong>Prazo (dias Ãºteis):</strong></label>\n             <input type="number" id="prazo_dias" class="swal2-input" value="5" min="1" max="30">\n           ',focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,o=document.getElementById("descricao_diligencia").value,t=parseInt(document.getElementById("prazo_dias").value);return a?!o||o.trim().length<10?(this.$swal.showValidationMessage("A descriÃ§Ã£o deve ter pelo menos 10 caracteres"),!1):!t||t<1||t>30?(this.$swal.showValidationMessage("O prazo deve ser entre 1 e 30 dias"),!1):{tipo:a,descricao:o,prazo:t}:(this.$swal.showValidationMessage("Selecione o tipo de diligÃªncia"),!1)}});o&&await this.salvarDiligencia(a,o)}catch(o){console.error("Erro ao solicitar diligÃªncia:",o)}},async salvarDiligencia(a,o){try{const t=this.calcularDataUtil(new Date,o.prazo),{error:e}=await N.ND.from("diligencias").insert({produto_id:a,tenant_id:this.currentTenantId,tipo:o.tipo,descricao:o.descricao,prazo_dias:o.prazo,data_limite:t.toISOString(),status:"PENDENTE",solicitado_por:"CPM"});if(e)throw e;const{error:s}=await N.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(s)throw s;this.$swal({title:"Sucesso!",text:"DiligÃªncia solicitada com sucesso",icon:"success"}),await this.carregarDados()}catch(t){console.error("Erro ao salvar diligÃªncia:",t),this.$swal({title:"Erro",text:"Erro ao solicitar diligÃªncia",icon:"error"})}},async visualizarDiligencias(a){try{const{data:o,error:t}=await N.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(t)throw t;let e='<div style="text-align: left;">';o&&o.length>0?(e+="<h4>DiligÃªncias do Produto:</h4>",o.forEach(((a,o)=>{const t="PENDENTE"===a.status?"color: #f39c12":"color: #27ae60";e+=`\n               <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">\n                 <strong>DiligÃªncia ${o+1}</strong><br>\n                 <strong>Tipo:</strong> ${a.tipo.replace(/_/g," ")}<br>\n                 <strong>Status:</strong> <span style="${t}">${a.status}</span><br>\n                 <strong>DescriÃ§Ã£o:</strong> ${a.descricao}<br>\n                 <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}<br>\n                 <strong>Solicitado em:</strong> ${this.formatDate(a.criado_em)}\n               </div>\n             `}))):e+="<p>Nenhuma diligÃªncia encontrada para este produto.</p>",e+="</div>",this.$swal({title:"DiligÃªncias",html:e,width:"600px"})}catch(o){console.error("Erro ao carregar diligÃªncias:",o),this.$swal({title:"Erro",text:"Erro ao carregar diligÃªncias do produto",icon:"error"})}},calcularDataUtil(a,o){const t=new Date(a);let e=0;while(e<o)t.setDate(t.getDate()+1),0!==t.getDay()&&6!==t.getDay()&&e++;return t},inicializarFiltros(){this.produtosFiltrados=[...this.produtos],this.diligenciasFiltradas=[...this.produtosComDiligencia],this.editaisFiltrados=[...this.editais],this.aplicarFiltros(),this.aplicarFiltrosDiligencia(),this.aplicarFiltrosEditais()},aplicarFiltros(){this.produtosFiltrados=this.produtos.filter((a=>{const o=a.nome.toLowerCase().includes(this.filtros.nome.toLowerCase()),t=a.marca.toLowerCase().includes(this.filtros.marca.toLowerCase()),e=""===this.filtros.status||a.status===this.filtros.status;let s=!0;if(this.filtros.data){const o=new Date(a.criado_em).toDateString(),t=new Date(this.filtros.data).toDateString();s=o===t}return o&&t&&e&&s})),this.calcularPaginacao()},calcularPaginacao(){this.totalPaginas=Math.ceil(this.produtosFiltrados.length/this.itensPorPagina),this.paginaAtual>this.totalPaginas&&(this.paginaAtual=Math.max(1,this.totalPaginas)),this.paginasVisiveis=[];const a=5;if(this.totalPaginas<=a)for(let e=1;e<=this.totalPaginas;e++)this.paginasVisiveis.push(e);else{const o=Math.max(1,this.paginaAtual-2),t=Math.min(this.totalPaginas,o+a-1);for(let a=o;a<=t;a++)this.paginasVisiveis.push(a)}const o=(this.paginaAtual-1)*this.itensPorPagina,t=o+this.itensPorPagina;this.produtosPaginados=this.produtosFiltrados.slice(o,t)},aplicarPaginacao(){this.paginaAtual=1,this.calcularPaginacao()},irParaPagina(a){this.paginaAtual=a,this.calcularPaginacao()},limparFiltros(){this.filtros={nome:"",marca:"",status:"",data:""},this.paginaAtual=1,this.aplicarFiltros()},aplicarFiltrosDiligencia(){this.diligenciasFiltradas=this.produtosComDiligencia.filter((a=>{const o=!this.filtrosDiligencia.busca||a.nome.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.marca.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.fabricante&&a.fabricante.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase()),t=!this.filtrosDiligencia.marca||a.marca===this.filtrosDiligencia.marca;let e=!0;if(this.filtrosDiligencia.data){const o=new Date(a.criado_em).toDateString(),t=new Date(this.filtrosDiligencia.data).toDateString();e=o===t}return o&&t&&e})),this.calcularPaginacaoDiligencia()},calcularPaginacaoDiligencia(){this.totalPaginasDiligencia=Math.ceil(this.diligenciasFiltradas.length/this.itensPorPaginaDiligencia),this.paginaAtualDiligencia>this.totalPaginasDiligencia&&(this.paginaAtualDiligencia=Math.max(1,this.totalPaginasDiligencia)),this.paginasVisiveisDiligencia=[];const a=5;if(this.totalPaginasDiligencia<=a)for(let e=1;e<=this.totalPaginasDiligencia;e++)this.paginasVisiveisDiligencia.push(e);else{const o=Math.max(1,this.paginaAtualDiligencia-2),t=Math.min(this.totalPaginasDiligencia,o+a-1);for(let a=o;a<=t;a++)this.paginasVisiveisDiligencia.push(a)}const o=(this.paginaAtualDiligencia-1)*this.itensPorPaginaDiligencia,t=o+this.itensPorPaginaDiligencia;this.diligenciasPaginadas=this.diligenciasFiltradas.slice(o,t)},aplicarPaginacaoDiligencia(){this.paginaAtualDiligencia=1,this.calcularPaginacaoDiligencia()},irParaPaginaDiligencia(a){this.paginaAtualDiligencia=a,this.calcularPaginacaoDiligencia()},limparFiltrosDiligencia(){this.filtrosDiligencia={busca:"",marca:"",data:""},this.paginaAtualDiligencia=1,this.aplicarFiltrosDiligencia()},formatarStatus(a){const o={pendente:"Em AvaliaÃ§Ã£o",aprovado:"Aprovado",julgado_aprovado:"Julgado Aprovado",julgado_reprovado:"Julgado Reprovado",homologado:"Homologado",reprovado:"Reprovado",diligencia:"DiligÃªncia",em_analise:"Em AnÃ¡lise",INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"DocumentaÃ§Ã£o Enviada",EM_AVALIACAO:"Em AvaliaÃ§Ã£o",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return o[a]||a},getStatusClass(a){const o={aprovado:"status-aprovado",julgado_aprovado:"status-aprovado",julgado_reprovado:"status-reprovado",homologado:"status-aprovado",pendente:"status-pendente",reprovado:"status-reprovado",diligencia:"status-diligencia",em_analise:"status-em_analise",INTERESSADO:"status-interessado",DOCUMENTACAO_ENVIADA:"status-documentacao",EM_AVALIACAO:"status-avaliacao",APROVADO:"status-aprovado",REPROVADO:"status-reprovado",DESISTENTE:"status-desistente"};return o[a]||`status-${a}`},formatDate(a){if(!a)return"NÃ£o informado";try{const o=new Date(a);return isNaN(o.getTime())?"Data invÃ¡lida":o.toLocaleDateString("pt-BR")}catch(o){return"Data invÃ¡lida"}},formatarEdital(a){if(a.edital_prequalificacao){const o=a.edital_prequalificacao.match(/nÂº\s*(\d{3}\/\d{4})/i);return o?`nÂº ${o[1]}`:a.edital_prequalificacao}return a.numero_edital&&a.ano_edital?`nÂº ${a.numero_edital}`:"Sem edital vinculado"},async carregarDadosDCB(){try{if(!this.currentTenantId)return;console.log("Carregando dados DCB para tenant:",this.currentTenantId);const{data:a,error:o}=await N.ND.from("produtos").select("\n              *,\n              categorias(nome)\n            ").eq("tenant_id",this.currentTenantId).eq("status","aprovado").is("numero_dcb",null).order("data_aprovacao",{ascending:!1});if(o)throw o;this.produtosProntosDCB=a||[],this.produtosProntosDCBFiltrados=[...this.produtosProntosDCB];const{data:t,error:e}=await N.ND.from("dcb_certificados").select("\n              *,\n              produtos(nome, marca, modelo, fabricante)\n            ").eq("tenant_id",this.currentTenantId).order("data_emissao",{ascending:!1});if(e)throw e;const s=t||[];this.dcbsEmitidos=s.map((a=>({...a,produto_nome:a.produtos?.nome||"N/A",produto_marca:a.produtos?.marca||"N/A",produto_modelo:a.produtos?.modelo||"N/A",produto_fabricante:a.produtos?.fabricante||"N/A"}))),this.dcbsHistoricoFiltrados=[...this.dcbsEmitidos],this.calcularVencimentos(),console.log(`DCB dados carregados: ${this.produtosProntosDCB.length} prontos, ${this.dcbsEmitidos.length} emitidos`)}catch(a){console.error("Erro ao carregar dados DCB:",a),this.$swal.fire("Erro","Erro ao carregar dados DCB","error")}},calcularVencimentos(){const a=new Date,o=new Date;o.setDate(a.getDate()+30),this.dcbsVencendo=this.dcbsEmitidos.filter((t=>{if("ativo"!==t.status)return!1;const e=new Date(t.data_validade);return e>a&&e<=o})),this.dcbsVencidos=this.dcbsEmitidos.filter((o=>{if("ativo"!==o.status)return!1;const t=new Date(o.data_validade);return t<=a}))},aplicarFiltrosDCB(){let a=[...this.produtosProntosDCB];if(this.filtrosDCB.busca){const o=this.filtrosDCB.busca.toLowerCase();a=a.filter((a=>a.nome.toLowerCase().includes(o)||a.marca.toLowerCase().includes(o)||a.fabricante.toLowerCase().includes(o)))}if(this.filtrosDCB.categoria&&(a=a.filter((a=>a.categorias?.nome?.toLowerCase()===this.filtrosDCB.categoria))),this.filtrosDCB.dataAprovacao){const o=new Date(this.filtrosDCB.dataAprovacao);a=a.filter((a=>{if(!a.data_aprovacao)return!1;const t=new Date(a.data_aprovacao);return t.toDateString()===o.toDateString()}))}this.produtosProntosDCBFiltrados=a},limparFiltrosDCB(){this.filtrosDCB={busca:"",categoria:"",dataAprovacao:""},this.aplicarFiltrosDCB()},aplicarFiltrosHistorico(){let a=[...this.dcbsEmitidos];if(this.filtrosHistorico.numeroDCB){const o=this.filtrosHistorico.numeroDCB.toLowerCase();a=a.filter((a=>a.numero_dcb.toLowerCase().includes(o)))}if(this.filtrosHistorico.status&&(a=a.filter((a=>a.status===this.filtrosHistorico.status))),this.filtrosHistorico.dataInicio){const o=new Date(this.filtrosHistorico.dataInicio);a=a.filter((a=>{const t=new Date(a.data_emissao);return t>=o}))}if(this.filtrosHistorico.dataFim){const o=new Date(this.filtrosHistorico.dataFim);a=a.filter((a=>{const t=new Date(a.data_emissao);return t<=o}))}this.dcbsHistoricoFiltrados=a},async emitirDCB(a){try{this.emitindoDCB=a.id,console.log("Emitindo DCB para produto:",a.nome);const o=await this.gerarNumeroDCB(),t=new Date,e=new Date;e.setFullYear(e.getFullYear()+1);const s=e.toISOString().split("T")[0],{data:i,error:r}=await N.ND.from("dcb_certificados").insert({tenant_id:this.currentTenantId,produto_id:a.id,numero_dcb:o,data_emissao:t.toISOString(),data_validade:s,status:"ativo"}).select().single();if(r)throw r;const{error:n}=await N.ND.from("produtos").update({numero_dcb:o,validade_dcb:s}).eq("id",a.id);if(n)throw n;await this.registrarHistoricoDCB(a.id,"dcb_emitido",`DCB ${o} emitido`),await this.carregarDadosDCB(),await this.gerarPDFDCBAutomatico(i,a),this.$swal.fire({icon:"success",title:"ğŸ‰ DCB Emitido com Sucesso!",html:`\n              <div style="text-align: left; padding: 10px;">\n                <p><strong>ğŸ“œ DCB:</strong> ${o}</p>\n                <p><strong>ğŸ“¦ Produto:</strong> ${a.nome}</p>\n                <p><strong>ğŸ­ Marca:</strong> ${a.marca}</p>\n                <p><strong>ğŸ“… Validade:</strong> ${this.formatDate(s)}</p>\n                <hr style="margin: 15px 0;">\n                <p style="color: #28a745; font-weight: bold;">\n                  âœ… PDF oficial gerado automaticamente<br>\n                  ğŸ“¥ Use o botÃ£o "PDF" para baixar\n                </p>\n              </div>\n            `,showConfirmButton:!0,confirmButtonText:"ğŸ“¥ Baixar PDF Agora",showCancelButton:!0,cancelButtonText:"Fechar",confirmButtonColor:"#dc3545"}).then((a=>{a.isConfirmed&&this.downloadDCB(i)})),console.log("DCB emitido com sucesso:",o)}catch(o){console.error("Erro ao emitir DCB:",o),this.$swal.fire("Erro","Erro ao emitir DCB: "+o.message,"error")}finally{this.emitindoDCB=null}},async gerarNumeroDCB(){try{const{data:a,error:o}=await N.ND.from("dcb_certificados").select("numero_dcb").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1}).limit(1);if(o)throw o;const t=(new Date).getFullYear();if(!a||0===a.length)return`001/${t}`;const e=a[0].numero_dcb,[s,i]=e.split("/");if(parseInt(i)===t){const a=parseInt(s)+1;return`${a.toString().padStart(3,"0")}/${t}`}return`001/${t}`}catch(a){throw console.error("Erro ao gerar nÃºmero DCB:",a),a}},async registrarHistoricoDCB(a,o,t){try{const{data:e}=await N.ND.auth.getSession(),s=e?.session?.user;await N.ND.from("workflow_historico").insert({tenant_id:this.currentTenantId,produto_id:a,usuario_id:s?.id,acao:o,observacoes:t})}catch(e){console.error("Erro ao registrar histÃ³rico:",e)}},visualizarProdutoDetalhes(a){this.produtoSelecionado=a,this.modalProdutoDetalhes=!0},fecharModalDetalhes(){this.modalProdutoDetalhes=!1,this.produtoSelecionado=null},visualizarDCB(a){this.dcbSelecionado=a,this.modalVisualizarDCB=!0},fecharModalDCB(){this.modalVisualizarDCB=!1,this.dcbSelecionado=null},async downloadDCB(a){try{console.log("Iniciando download DCB:",a.numero_dcb),this.$swal.fire({title:"Gerando PDF...",text:"Aguarde enquanto geramos seu DCB",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}}),await this.gerarPDFDCB(a),this.$swal.close()}catch(o){console.error("Erro ao fazer download:",o),this.$swal.fire("Erro","Erro ao gerar PDF do DCB: "+o.message,"error")}},async gerarPDFDCB(a){try{const e=(await Promise.resolve().then(t.bind(t,1749))).default,s=(await t.e(420).then(t.t.bind(t,8420,19))).default,{data:i,error:r}=await N.ND.from("produtos").select("*").eq("id",a.produto_id).single();if(r)throw r;const n=new e("portrait","mm","a4"),c=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight(),d=20;let u=d;n.setFontSize(16),n.setFont("helvetica","bold"),n.text("REPÃšBLICA FEDERATIVA DO BRASIL",c/2,u,{align:"center"}),u+=8,n.setFontSize(14),n.text("MINISTÃ‰RIO DA SAÃšDE",c/2,u,{align:"center"}),u+=6,n.setFontSize(12),n.setFont("helvetica","normal"),n.text("ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM",c/2,u,{align:"center"}),u+=15,n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,c-d,u),u+=15,n.setFontSize(18),n.setFont("helvetica","bold"),n.text("DECLARAÃ‡ÃƒO DE CONFORMIDADE DE BEM",c/2,u,{align:"center"}),u+=8,n.setFontSize(16),n.setTextColor(0,100,200),n.text(`DCB NÂº ${a.numero_dcb}`,c/2,u,{align:"center"}),n.setTextColor(0,0,0),u+=20,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("PRODUTO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal");const m=50;n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,c-2*d,m,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Nome do Produto:",d+5,u),n.setFont("helvetica","normal"),n.text(i.nome||"N/A",d+45,u),u+=7,n.setFont("helvetica","bold"),n.text("Marca:",d+5,u),n.setFont("helvetica","normal"),n.text(i.marca||"N/A",d+20,u),u+=7,n.setFont("helvetica","bold"),n.text("Modelo:",d+5,u),n.setFont("helvetica","normal"),n.text(i.modelo||"N/A",d+22,u),u+=7,n.setFont("helvetica","bold"),n.text("Fabricante:",d+5,u),n.setFont("helvetica","normal"),n.text(i.fabricante||"N/A",d+30,u),u+=7,n.setFont("helvetica","bold"),n.text("CNPJ:",d+5,u),n.setFont("helvetica","normal"),n.text(i.cnpj_fabricante||i.cnpj||"N/A",d+20,u),u+=25,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("DADOS DO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal"),n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,c-2*d,40,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Data de EmissÃ£o:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_emissao),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Data de Validade:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_validade),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Status:",d+5,u),n.setFont("helvetica","normal"),n.setTextColor(0,150,0),n.text(this.formatStatusDCB(a.status),d+20,u),n.setTextColor(0,0,0),u+=25,n.setFontSize(12),n.setFont("helvetica","bold"),n.text("DECLARAÃ‡ÃƒO",d,u),u+=10,n.setFontSize(10),n.setFont("helvetica","normal");const p=`Declaramos que o produto acima identificado foi submetido a anÃ¡lise tÃ©cnica pela ComissÃ£o de PadronizaÃ§Ã£o de Materiais (CPM) deste Ã³rgÃ£o, tendo sido APROVADO para utilizaÃ§Ã£o em processos licitatÃ³rios, conforme previsto na Lei Federal nÂº 14.133/2021 (Lei de LicitaÃ§Ãµes e Contratos).\n\nO presente Documento de ComprovaÃ§Ã£o de Bem (DCB) atesta que o produto atende aos requisitos tÃ©cnicos mÃ­nimos exigidos e estÃ¡ apto para fornecimento no Ã¢mbito da AdministraÃ§Ã£o PÃºblica.\n\nEsta declaraÃ§Ã£o possui validade atÃ© ${this.formatDate(a.data_validade)}, podendo ser renovada mediante nova anÃ¡lise tÃ©cnica.`,v=n.splitTextToSize(p,c-2*d),g=4*v.length+80;u+g>l-30&&(n.addPage(),u=d),n.text(v,d,u),u+=4*v.length+25;try{const o=window.location.origin,t=o.includes("github.io"),e=t?`${o}/ComprarBem/#/validar-dcb/${a.numero_dcb}`:`${o}/validar-dcb/${a.numero_dcb}`,i=await s.toDataURL(e,{width:80,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),r=Math.max(u,l-120);n.addImage(i,"PNG",c-d-30,r,25,25),n.setFontSize(8),n.text("Validar DCB:",c-d-30,r+30),n.text(a.numero_dcb,c-d-30,r+33)}catch(o){console.warn("Erro ao gerar QR Code:",o)}u=l-90,n.setFontSize(10),n.setFont("helvetica","normal");const _=new Date;n.text(`BrasÃ­lia, ${_.getDate().toString().padStart(2,"0")} de ${_.toLocaleDateString("pt-BR",{month:"long"})} de ${_.getFullYear()}`,d,u),u+=20,u=Math.max(u,l-85),n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,c/2-10,u),u+=8,n.setFontSize(9),n.setTextColor(0,0,0),n.text("Presidente da ComissÃ£o de PadronizaÃ§Ã£o de Materiais",d,u),u+=4,n.text("CPM - MinistÃ©rio da SaÃºde",d,u),n.setFontSize(8),n.setTextColor(100,100,100);const h=`Este documento foi gerado eletronicamente pelo Sistema ComprarBem em ${_.toLocaleString("pt-BR")}`;n.text(h,c/2,l-10,{align:"center"});const f=`DCB_${a.numero_dcb.replace("/","_")}_${i.nome.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;n.save(f),console.log("PDF gerado com sucesso:",f),await this.salvarURLPDFNoBanco(a.id,f)}catch(e){throw console.error("Erro ao gerar PDF:",e),e}},async salvarURLPDFNoBanco(a,o){try{const{error:t}=await N.ND.from("dcb_certificados").update({arquivo_pdf_url:o}).eq("id",a);t&&console.warn("Erro ao salvar URL do PDF:",t)}catch(t){console.warn("Erro ao atualizar banco com PDF:",t)}},async gerarPDFDCBAutomatico(a,o){try{console.log("Gerando PDF automaticamente para DCB:",a.numero_dcb);const t={...a,produto_id:o.id};await this.gerarPDFDCB(t)}catch(t){console.warn("Erro ao gerar PDF automaticamente:",t)}},async revogarDCB(a){try{const o=await this.$swal.fire({title:"Revogar DCB?",text:`Tem certeza que deseja revogar o DCB ${a.numero_dcb}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, revogar",cancelButtonText:"Cancelar",input:"textarea",inputPlaceholder:"Digite o motivo da revogaÃ§Ã£o...",inputValidator:a=>{if(!a)return"VocÃª precisa inserir um motivo!"}});if(o.isConfirmed){const t=o.value,{error:e}=await N.ND.from("dcb_certificados").update({status:"revogado",revogado_em:(new Date).toISOString(),motivo_revogacao:t}).eq("id",a.id);if(e)throw e;await this.carregarDadosDCB(),this.$swal.fire("Sucesso!","DCB revogado com sucesso.","success")}}catch(o){console.error("Erro ao revogar DCB:",o),this.$swal.fire("Erro","Erro ao revogar DCB","error")}},async iniciarRenovacao(a){this.$swal.fire({icon:"info",title:"RenovaÃ§Ã£o de DCB",text:`Processo de renovaÃ§Ã£o do DCB ${a.numero_dcb} serÃ¡ implementado em breve.`,timer:2e3})},async renovarDCBVencido(a){this.$swal.fire({icon:"info",title:"RenovaÃ§Ã£o Urgente",text:`RenovaÃ§Ã£o urgente do DCB ${a.numero_dcb} serÃ¡ implementada em breve.`,timer:2e3})},getStatusDCBClass(a){switch(a){case"ativo":return"status-ativo";case"vencido":return"status-vencido";case"revogado":return"status-revogado";default:return"status-indefinido"}},formatStatusDCB(a){switch(a){case"ativo":return"Ativo";case"vencido":return"Vencido";case"revogado":return"Revogado";default:return a}},calcularDiasRestantes(a){const o=new Date,t=new Date(a),e=t-o,s=Math.ceil(e/864e5);return Math.max(0,s)},calcularDiasVencidos(a){const o=new Date,t=new Date(a),e=o-t,s=Math.ceil(e/864e5);return Math.max(0,s)},formatarEspecificacoes(a){return"string"===typeof a?a:"object"===typeof a?JSON.stringify(a,null,2):"N/A"},async carregarEditais(){try{if(this.loadingEditais=!0,!this.currentTenantId)return void console.error("Tenant ID nÃ£o disponÃ­vel para carregar editais");const{data:a,error:o}=await N.ND.from("editais").select("\n              *,\n              participantes_count:participantes_editais(count)\n            ").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(o)throw o;this.editais=(a||[]).map((a=>({...a,participantes_count:a.participantes_count?.[0]?.count||0}))),this.aplicarFiltrosEditais(),console.log(`${this.editais.length} editais carregados`),console.log("Editais com participantes:",this.editais.map((a=>({numero:a.numero,participantes:a.participantes_count}))))}catch(a){console.error("Erro ao carregar editais:",a),this.$swal.fire("Erro","Erro ao carregar editais","error")}finally{this.loadingEditais=!1}},aplicarFiltrosEditais(){try{let a=[...this.editais];if(this.filtroEditais.busca&&this.filtroEditais.busca.trim()){const o=this.filtroEditais.busca.toLowerCase().trim();a=a.filter((a=>{try{const t=a.numero?a.numero.toString().toLowerCase():"",e=a.descricao?a.descricao.toString().toLowerCase():"";return t.includes(o)||e.includes(o)}catch(t){return console.warn("Erro ao filtrar edital:",a,t),!1}}))}this.filtroEditais.status&&this.filtroEditais.status.trim()&&(a=a.filter((a=>a.status===this.filtroEditais.status))),this.editaisFiltrados=a}catch(a){console.error("Erro ao aplicar filtros aos editais:",a),this.editaisFiltrados=[...this.editais],this.$swal.fire({icon:"warning",title:"Aviso",text:"Houve um problema ao aplicar os filtros. Mostrando todos os editais.",timer:3e3,showConfirmButton:!1})}},debouncedFiltrarEditais(){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.aplicarFiltrosEditais()}),300)},limparFiltrosEditais(){this.filtroEditais.busca="",this.filtroEditais.status="",this.aplicarFiltrosEditais()},async abrirModalNovoEdital(){await this.carregarMinutasDisponiveis(),this.minutaSelecionada=null,this.modalNovoEdital=!0},fecharModalNovoEdital(){this.modalNovoEdital=!1,this.minutaSelecionada=null},limparEstadoModal(){this.minutaSelecionada=null,this.criandoEdital=!1},async processarCriacaoEdital(){const a=this.minutaSelecionada;a?await this.criarEditalComMinuta(a):this.$swal.fire("AtenÃ§Ã£o","Selecione uma minuta padrÃ£o para continuar","warning")},async carregarMinutasDisponiveis(){try{await this.verificarMinutaPadraoSistema();const{data:a,error:o}=await N.ND.from("minutas_padrao").select("*").eq("ativa",!0).order("eh_padrao_sistema",{ascending:!1}).order("nome",{ascending:!0});if(o)throw o;this.minutasDisponiveis=a||[]}catch(a){console.error("Erro ao carregar minutas:",a),this.$swal.fire("Erro","Erro ao carregar minutas padrÃ£o: "+a.message,"error")}},async verificarMinutaPadraoSistema(){try{const{data:a}=await N.ND.from("minutas_padrao").select("id, arquivo_url").eq("eh_padrao_sistema",!0).single();if(a){const{data:a}=await N.ND.storage.from("minutas-padrao").list("sistema/"),o=a?.some((a=>"MINUTA_PADRAO.docx"===a.name));o||await this.criarMinutaPadraoSistema()}else await this.criarMinutaPadraoSistema()}catch(a){console.warn("Aviso: NÃ£o foi possÃ­vel verificar minuta padrÃ£o do sistema:",a)}},async criarMinutaPadraoSistema(){try{const a=await fetch("/MINUTA_PADRAO.docx");if(!a.ok)return void console.warn("Arquivo MINUTA_PADRAO.docx nÃ£o encontrado localmente");const o=await a.blob(),t="MINUTA_PADRAO.docx",e=`sistema/${t}`,{data:s,error:i}=await N.ND.storage.from("minutas-padrao").upload(e,o,{cacheControl:"3600",upsert:!0});if(i)throw i;const{data:r}=N.ND.storage.from("minutas-padrao").getPublicUrl(e),{error:n}=await N.ND.from("minutas_padrao").upsert({nome:"Minuta-PadrÃ£o do Sistema",descricao:"Minuta-padrÃ£o oficial instituÃ­da com o auxÃ­lio dos Ã³rgÃ£os de assessoramento jurÃ­dico e de controle interno",arquivo_nome:t,arquivo_url:r.publicUrl,categoria:"SISTEMA",eh_padrao_sistema:!0,ativa:!0,criado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()});if(n)throw n;console.log("Minuta padrÃ£o do sistema configurada com sucesso")}catch(a){console.error("Erro ao criar minuta padrÃ£o do sistema:",a)}},selecionarMinuta(a){this.minutaSelecionada=a.id},async criarEditalComMinuta(a=null){try{this.criandoEdital=!0;const o=a||this.minutaSelecionada;if(!o)return void this.$swal.fire("AtenÃ§Ã£o","Selecione uma minuta padrÃ£o para continuar","warning");if(!this.currentTenantId)throw new Error("Tenant ID nÃ£o disponÃ­vel");this.fecharModalNovoEdital(),await new Promise((a=>setTimeout(a,100)));const{value:t}=await this.$swal.fire({title:"NÃºmero do Edital",html:`\n              <label for="numero-edital"><strong>NÃºmero do Edital:</strong></label>\n              <input \n                id="numero-edital" \n                class="swal2-input" \n                placeholder="Ex: 001/2024"\n                value="${await this.gerarProximoNumeroEdital()}"\n              >\n              <small style="color: #666; font-size: 12px;">\n                Formato sugerido: 001/2024, 002/2024...\n              </small>\n            `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Criar Edital",cancelButtonText:"Cancelar",customClass:{popup:"swal2-popup-edital"},preConfirm:()=>{const a=document.getElementById("numero-edital").value;return a&&""!==a.trim()?a.trim():(this.$swal.showValidationMessage("NÃºmero do edital Ã© obrigatÃ³rio"),!1)}});if(!t)return void(this.modalNovoEdital=!0);const{data:e}=await N.ND.from("editais").select("id").eq("tenant_id",this.currentTenantId).eq("numero",t).single();if(e)return this.$swal.fire("Erro",`JÃ¡ existe um edital com o nÃºmero "${t}". Por favor, escolha outro nÃºmero.`,"error"),void(this.modalNovoEdital=!0);const s={tenant_id:this.currentTenantId,numero:t,descricao:"Edital em elaboraÃ§Ã£o",status:"RASCUNHO",minuta_usada_id:o,criado_em:(new Date).toISOString()},{data:i,error:r}=await N.ND.from("editais").insert(s).select().single();if(r)throw r;await N.ND.from("minuta_uso_historico").insert({minuta_id:o,edital_id:i.id,usuario_id:this.currentTenantId,observacoes:"Edital criado com minuta padrÃ£o"}),await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Edital Criado!",text:`Edital ${t} criado com sucesso em elaboraÃ§Ã£o.`,timer:2e3})}catch(o){console.error("Erro ao criar edital:",o),this.$swal.fire("Erro","Erro ao criar edital: "+o.message,"error")}finally{this.criandoEdital=!1}},async gerarProximoNumeroEdital(){try{const a=(new Date).getFullYear(),{data:o,error:t}=await N.ND.from("editais").select("numero").eq("tenant_id",this.currentTenantId).like("numero",`%/${a}`).order("numero",{ascending:!1}).limit(1);if(t)throw t;let e=1;if(o&&o.length>0){const a=o[0].numero,t=parseInt(a.split("/")[0]);e=t+1}return String(e).padStart(3,"0")+"/"+a}catch(a){return console.error("Erro ao gerar nÃºmero:",a),"001/"+(new Date).getFullYear()}},abrirModalAddMinuta(){this.novaMinuta={nome:"",categoria:"geral",descricao:"",arquivo:null},this.modalAddMinuta=!0},fecharModalAddMinuta(){this.modalAddMinuta=!1,this.novaMinuta={nome:"",categoria:"geral",descricao:"",arquivo:null}},handleMinutaUpload(a){const o=a.target.files[0];if(o){const t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];if(!t.includes(o.type))return this.$swal.fire("Erro","Por favor, selecione um arquivo Word (.docx ou .doc)","error"),void(a.target.value="");if(o.size>10485760)return this.$swal.fire("Erro","O arquivo deve ter no mÃ¡ximo 10MB","error"),void(a.target.value="");this.novaMinuta.arquivo=o}},async salvarNovaMinuta(){try{if(this.salvandoMinuta=!0,!this.novaMinuta.arquivo)return void this.$swal.fire("AtenÃ§Ã£o","Selecione um arquivo Word para a minuta","warning");const a=`minutas/${Date.now()}-${this.novaMinuta.arquivo.name}`,{data:o,error:t}=await N.ND.storage.from("documentos").upload(a,this.novaMinuta.arquivo);if(t)throw t;const{data:e}=N.ND.storage.from("documentos").getPublicUrl(a),{data:s,error:i}=await N.ND.from("minutas_padrao").insert({nome:this.novaMinuta.nome,categoria:this.novaMinuta.categoria,descricao:this.novaMinuta.descricao,arquivo_nome:this.novaMinuta.arquivo.name,arquivo_url:e.publicUrl,tipo_arquivo:this.novaMinuta.arquivo.name.split(".").pop(),criado_por:this.currentTenantId,eh_padrao_sistema:!1});if(i)throw i;await this.carregarMinutasDisponiveis(),this.fecharModalAddMinuta(),this.$swal.fire({icon:"success",title:"Minuta Adicionada!",text:`Minuta "${this.novaMinuta.nome}" adicionada com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar minuta:",a),this.$swal.fire("Erro","Erro ao salvar minuta: "+a.message,"error")}finally{this.salvandoMinuta=!1}},async baixarMinutaPadrao(a){try{const{data:o,error:t}=await N.ND.from("minutas_padrao").select("*").eq("id",a.minuta_usada_id).single();if(t)throw t;if(o.arquivo_url){const a=await fetch(o.arquivo_url),t=await a.blob(),e=window.URL.createObjectURL(t),s=document.createElement("a");s.href=e,s.download=o.arquivo_nome||"minuta_padrao.docx",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(e),document.body.removeChild(s)}else{const a=document.createElement("a");a.href="/DOCUMENTOS ESCRITOS/MINUTA PADRAO.docx",a.download="MINUTA PADRAO.docx",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}catch(o){console.error("Erro ao baixar minuta:",o),this.$swal.fire("Erro","Erro ao baixar minuta padrÃ£o","error")}},async handleMinutaPreenchidaUpload(a){try{const o=a.target.files[0];if(!o)return;const t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword"];if(!t.includes(o.type))return void this.$swal.fire("Erro","Por favor, selecione um arquivo Word (.docx ou .doc)","error");if(o.size>15728640)return void this.$swal.fire("Erro","O arquivo deve ter no mÃ¡ximo 15MB","error");const e=`editais/preenchidas/${Date.now()}-${o.name}`,{data:s,error:i}=await N.ND.storage.from("documentos").upload(e,o);if(i)throw i;const{data:r}=N.ND.storage.from("documentos").getPublicUrl(e),{error:n}=await N.ND.from("editais").update({minuta_preenchida_url:r.publicUrl,minuta_preenchida_nome:o.name}).eq("id",this.editalSelecionado.id);if(n)throw n;this.editalSelecionado.minuta_preenchida_url=r.publicUrl,this.editalSelecionado.minuta_preenchida_nome=o.name,await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Minuta Enviada!",text:"Minuta preenchida enviada com sucesso.",timer:2e3})}catch(o){console.error("Erro ao enviar minuta:",o),this.$swal.fire("Erro","Erro ao enviar minuta preenchida: "+o.message,"error")}},visualizarMinutaPreenchida(a){a.minuta_preenchida_url&&window.open(a.minuta_preenchida_url,"_blank")},async processarConversaoPDF(a){const o={...a};await this.converterParaPDF(o)},async gerarPDFEdital(a){try{console.log("ğŸ“„ Gerando PDF do edital:",a.numero);const o=(await Promise.resolve().then(t.bind(t,1749))).jsPDF||(await Promise.resolve().then(t.bind(t,1749))).default,{data:e}=await N.ND.from("minutas_padrao").select("*").eq("id",a.minuta_usada_id).single(),s=new o("portrait","mm","a4"),i=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight(),n=20;let c=n;s.setFontSize(16),s.setFont("helvetica","bold"),s.text("REPÃšBLICA FEDERATIVA DO BRASIL",i/2,c,{align:"center"}),c+=8,s.setFontSize(14),s.text("MINISTÃ‰RIO DA SAÃšDE",i/2,c,{align:"center"}),c+=6,s.setFontSize(12),s.setFont("helvetica","normal"),s.text("ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM",i/2,c,{align:"center"}),c+=15,s.setDrawColor(0,0,0),s.setLineWidth(.5),s.line(n,c,i-n,c),c+=15,s.setFontSize(18),s.setFont("helvetica","bold");const l=`EDITAL DE PREGÃƒO ELETRÃ”NICO NÂº ${a.numero}`;s.text(l,i/2,c,{align:"center"}),c+=15,s.setFontSize(14),s.setFont("helvetica","normal"),s.text(a.descricao||"Edital de PrÃ©-qualificaÃ§Ã£o de Materiais",i/2,c,{align:"center"}),c+=25,s.setFontSize(12),s.setFont("helvetica","bold"),s.text("DADOS DO PROCEDIMENTO",n,c),c+=10,s.setDrawColor(200,200,200),s.setFillColor(250,250,250),s.rect(n,c,i-2*n,35,"FD"),c+=10,s.setFontSize(11),s.setFont("helvetica","normal"),s.text(`NÃºmero do Edital: ${a.numero}`,n+5,c),c+=6,s.text(`Status: ${a.status}`,n+5,c),c+=6,s.text(`Data de PublicaÃ§Ã£o: ${this.formatDate(a.data_publicacao||new Date)}`,n+5,c),c+=6,s.text(`Prazo para ImpugnaÃ§Ãµes: ${this.formatDate(a.data_limite_impugnacao||new Date)}`,n+5,c),c+=25,s.setFontSize(12),s.setFont("helvetica","bold"),s.text("OBJETO",n,c),c+=10,s.setFontSize(11),s.setFont("helvetica","normal");const d="Processo de prÃ©-qualificaÃ§Ã£o de materiais para aquisiÃ§Ã£o futura, conforme especificaÃ§Ãµes tÃ©cnicas definidas pela ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM.",u=s.splitTextToSize(d,i-2*n);if(s.text(u,n,c),c+=6*u.length+15,e){if(s.setFontSize(12),s.setFont("helvetica","bold"),s.text("MINUTA PADRÃƒO UTILIZADA",n,c),c+=10,s.setFontSize(11),s.setFont("helvetica","normal"),s.text(`Nome: ${e.nome}`,n,c),c+=6,s.text(`Categoria: ${e.categoria||"Geral"}`,n,c),c+=6,e.descricao){const a=s.splitTextToSize(`DescriÃ§Ã£o: ${e.descricao}`,i-2*n);s.text(a,n,c),c+=6*a.length}c+=15}s.setFontSize(12),s.setFont("helvetica","bold"),s.text("CONDIÃ‡Ã•ES GERAIS",n,c),c+=10,s.setFontSize(11),s.setFont("helvetica","normal");const m=["1. Este edital visa a prÃ©-qualificaÃ§Ã£o de materiais conforme normas vigentes.","2. Os fornecedores interessados deverÃ£o apresentar documentaÃ§Ã£o completa.","3. A avaliaÃ§Ã£o serÃ¡ realizada pela ComissÃ£o de PadronizaÃ§Ã£o de Materiais.","4. Os materiais aprovados receberÃ£o DeclaraÃ§Ã£o de Conformidade de Bem (DCB).","5. O processo poderÃ¡ ser impugnado no prazo estabelecido.","6. Maiores informaÃ§Ãµes no Sistema ComprarBem."];m.forEach((a=>{const o=s.splitTextToSize(a,i-2*n-5);s.text(o,n,c),c+=6*o.length+3})),c=Math.max(c+30,r-120);const p=new Date;s.text(`BrasÃ­lia, ${p.getDate().toString().padStart(2,"0")} de ${p.toLocaleDateString("pt-BR",{month:"long"})} de ${p.getFullYear()}`,n,c),c+=20,s.setDrawColor(0,0,0),s.setLineWidth(.5),s.line(n,c,i/2-10,c),c+=8,s.setFontSize(10),s.text("Presidente da ComissÃ£o de PadronizaÃ§Ã£o de Materiais",n,c),c+=4,s.text("CPM - MinistÃ©rio da SaÃºde",n,c),s.setFontSize(8),s.setTextColor(100,100,100);const v=`Este documento foi gerado eletronicamente pelo Sistema ComprarBem em ${p.toLocaleString("pt-BR")}`;s.text(v,i/2,r-10,{align:"center"});const g=`Edital_${a.numero.replace("/","_")}_${p.getFullYear()}.pdf`,_=s.output("blob");console.log("ğŸ“¤ Fazendo upload do PDF para Supabase...");const h=`editais-pdf/${this.currentTenantId}/${g}`,{data:f,error:C}=await N.ND.storage.from("documentos").upload(h,_,{cacheControl:"3600",upsert:!0,contentType:"application/pdf"});if(C)throw C;const{data:b}=N.ND.storage.from("documentos").getPublicUrl(h);return console.log("âœ… PDF gerado e enviado com sucesso:",b.publicUrl),{url:b.publicUrl,nome:g,caminho:h}}catch(o){console.error("âŒ Erro ao gerar PDF do edital:",o),this.$swal&&this.$swal.close&&this.$swal.close();let a="NÃ£o foi possÃ­vel gerar o PDF do edital.";throw o.message.includes("storage")?a="Erro no armazenamento do arquivo. Verifique as permissÃµes.":o.message.includes("network")||o.message.includes("fetch")?a="Erro de conexÃ£o. Verifique sua internet e tente novamente.":o.message.includes("jsPDF")&&(a="Erro na geraÃ§Ã£o do PDF. Tente novamente."),new Error(a+" Detalhes: "+o.message)}},async converterWordParaPDF(a){try{console.log("ğŸ“„ Convertendo minuta Word para PDF (MODO VISUAL):",a.minuta_preenchida_url);const{convertWordToPdf:o}=await t.e(130).then(t.bind(t,4130)),e=a.minuta_preenchida_nome?.replace(/\.(docx?|doc)$/i,"")||"Minuta";console.log("ğŸ”„ Iniciando conversÃ£o visual...");const s=await o(a.minuta_preenchida_url,e);console.log("âœ… ConversÃ£o concluÃ­da:",s.fileName),console.log("ğŸ“¤ Fazendo upload do PDF convertido para Supabase...");const i=`editais-pdf/${this.currentTenantId}/${s.fileName}`,{data:r,error:n}=await N.ND.storage.from("documentos").upload(i,s.blob,{cacheControl:"3600",upsert:!0,contentType:"application/pdf"});if(n)throw n;const{data:c}=N.ND.storage.from("documentos").getPublicUrl(i);return console.log("ğŸ‰ PDF CONVERTIDO COM SUCESSO (MODO VISUAL)!"),console.log("ğŸ“„ URL:",c.publicUrl),{url:c.publicUrl,nome:s.fileName,caminho:i}}catch(o){throw console.error("âŒ Erro ao converter Word para PDF:",o),o}},async converterParaPDF(a){try{this.fecharModalVisualizarEdital(),await new Promise((a=>setTimeout(a,100)));const o=a.minuta_preenchida_url&&""!==a.minuta_preenchida_url.trim(),t=await this.$swal.fire({title:"Confirmar ConversÃ£o",html:`\n              <div style="text-align: left;">\n                <p><strong>AtenÃ§Ã£o:</strong> Esta aÃ§Ã£o irÃ¡:</p>\n                <ul>\n                  ${o?`<li>Converter sua minuta Word preenchida para PDF</li>\n                       <li>Arquivo: ${a.minuta_preenchida_nome||"Minuta preenchida"}</li>`:"<li>Gerar PDF oficial com base nos dados do edital</li>"}\n                  <li>Marcar o edital como PUBLICADO</li>\n                  <li>Tornar o edital disponÃ­vel para consulta</li>\n                </ul>\n                <p><strong>${o?"Tem certeza que a minuta preenchida estÃ¡ pronta para publicaÃ§Ã£o?":"Tem certeza que o edital estÃ¡ pronto para publicaÃ§Ã£o?"}</strong></p>\n              </div>\n            `,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, Converter e Publicar",cancelButtonText:"Cancelar",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",customClass:{popup:"swal2-popup-converter-pdf"}});if(!t.isConfirmed)return void(this.modalVisualizarEdital=!0);let e;console.log("ğŸ”„ Iniciando conversÃ£o real para PDF..."),this.$swal.fire({title:"Convertendo para PDF...",text:o?"Aguarde enquanto convertemos sua minuta Word para PDF":"Aguarde enquanto geramos o PDF do edital",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}}),o?(console.log("ğŸ“„ Convertendo minuta Word carregada pelo usuÃ¡rio..."),e=await this.converterWordParaPDF(a)):(console.log("ğŸ“„ Gerando PDF com dados do edital..."),e=await this.gerarPDFEdital(a));const s=new Date,i=s.toISOString(),r=new Date(s.getTime()+2592e6).toISOString(),{error:n}=await N.ND.from("editais").update({status:"PUBLICADO",data_publicacao:i,data_limite_impugnacao:r,pdf_convertido_url:e.url,pdf_convertido_nome:e.nome}).eq("id",a.id);if(n)throw n;this.$swal.close(),this.editalSelecionado.status="PUBLICADO",this.editalSelecionado.data_publicacao=i,this.editalSelecionado.data_limite_impugnacao=r,this.editalSelecionado.pdf_convertido_url=e.url,this.editalSelecionado.pdf_convertido_nome=e.nome,await this.carregarEditais(),this.$swal.fire({icon:"success",title:"Edital Publicado!",html:`\n              <div style="text-align: left; padding: 10px;">\n                <p><strong>ğŸ“‹ Edital:</strong> ${a.numero}</p>\n                <p><strong>ğŸ“„ PDF:</strong> ${e.nome}</p>\n                <p><strong>ğŸ“… Publicado em:</strong> ${this.formatDate(i)}</p>\n                <hr style="margin: 15px 0;">\n                <p style="color: #28a745; font-weight: bold;">\n                  ${o?"âœ… Minuta Word convertida para PDF oficial<br>ğŸ“ ConteÃºdo baseado na minuta preenchida enviada":"âœ… PDF oficial gerado automaticamente<br>ğŸ“„ ConteÃºdo baseado nos dados do edital"}<br>\n                  ğŸ“¥ Use o botÃ£o "Abrir PDF" para visualizar\n                </p>\n              </div>\n            `,showConfirmButton:!0,confirmButtonText:"ğŸ“¥ Abrir PDF Agora",showCancelButton:!0,cancelButtonText:"Fechar",confirmButtonColor:"#28a745"}).then((a=>{a.isConfirmed&&window.open(e.url,"_blank")}))}catch(o){console.error("âŒ Erro ao converter para PDF:",o),this.$swal&&this.$swal.close&&this.$swal.close(),this.$swal.fire({icon:"error",title:"Erro na ConversÃ£o para PDF",html:`\n              <div style="text-align: left;">\n                <p><strong>NÃ£o foi possÃ­vel converter o edital para PDF.</strong></p>\n                <p><strong>Erro:</strong> ${o.message}</p>\n                <hr>\n                <p><strong>O que fazer:</strong></p>\n                <ul>\n                  <li>Verifique sua conexÃ£o com a internet</li>\n                  <li>Tente novamente em alguns minutos</li>\n                  <li>Se o problema persistir, contate o suporte</li>\n                </ul>\n                <p style="color: #666; font-size: 12px; margin-top: 15px;">\n                  ğŸ’¡ <strong>Dica:</strong> O edital continuarÃ¡ como "RASCUNHO" atÃ© a conversÃ£o ser bem-sucedida.\n                </p>\n              </div>\n            `,confirmButtonText:"Entendi",confirmButtonColor:"#dc3545"}),setTimeout((()=>{this.modalVisualizarEdital=!0}),500)}},validarDatas(){if(!this.editalAtual.data_publicacao)return this.$swal.fire("Erro","Data de publicaÃ§Ã£o Ã© obrigatÃ³ria","error"),!1;if(!this.editalAtual.data_limite_impugnacao)return this.$swal.fire("Erro","Prazo para impugnaÃ§Ãµes Ã© obrigatÃ³rio","error"),!1;const a=new Date(this.editalAtual.data_publicacao),o=new Date(this.editalAtual.data_limite_impugnacao);if(o<=a)return this.$swal.fire({icon:"error",title:"Erro de Data",html:`\n              <p><strong>O prazo para impugnaÃ§Ãµes deve ser posterior Ã  data de publicaÃ§Ã£o!</strong></p>\n              <br>\n              <p><strong>Data de PublicaÃ§Ã£o:</strong> ${this.formatDate(a)}</p>\n              <p><strong>Prazo para ImpugnaÃ§Ãµes:</strong> ${this.formatDate(o)}</p>\n              <br>\n              <p>Por favor, ajuste as datas e tente novamente.</p>\n            `,confirmButtonText:"Entendi"}),!1;const t=new Date(a);if(t.setFullYear(t.getFullYear()+1),o>t){const a=this.$swal.fire({icon:"warning",title:"Prazo muito distante",text:"O prazo para impugnaÃ§Ãµes estÃ¡ mais de 1 ano apÃ³s a publicaÃ§Ã£o. Tem certeza?",showCancelButton:!0,confirmButtonText:"Sim, continuar",cancelButtonText:"Cancelar"});if(!a.isConfirmed)return!1}return!0},validarDataLimite(){if(!this.editalAtual.data_publicacao||!this.editalAtual.data_limite_impugnacao)return;const a=new Date(this.editalAtual.data_publicacao),o=new Date(this.editalAtual.data_limite_impugnacao);o<=a&&(this.$swal.fire({icon:"warning",title:"AtenÃ§Ã£o!",text:"O prazo para impugnaÃ§Ãµes deve ser posterior Ã  data de publicaÃ§Ã£o.",timer:3e3,toast:!0,position:"top-end",showConfirmButton:!1}),this.editalAtual.data_limite_impugnacao="")},async salvarEdital(){try{if(this.salvandoEdital=!0,!this.currentTenantId)throw new Error("Tenant ID nÃ£o disponÃ­vel");if(!this.validarDatas())return;const a={tenant_id:this.currentTenantId,numero:this.editalAtual.numero,descricao:this.editalAtual.descricao,conteudo:this.editalAtual.conteudo,status:this.editalAtual.status,data_publicacao:this.editalAtual.data_publicacao||(new Date).toISOString(),data_limite_impugnacao:this.editalAtual.data_limite_impugnacao,url_documento:this.editalAtual.url_documento,nome_arquivo:this.editalAtual.nome_arquivo};let o;if(this.modoEdicaoEdital){const{data:t,error:e}=await N.ND.from("editais").update(a).eq("id",this.editalAtual.id).select().single();o={data:t,error:e}}else{const{data:t,error:e}=await N.ND.from("editais").insert(a).select().single();o={data:t,error:e}}if(o.error)throw o.error;await this.carregarEditais(),this.fecharModalNovoEdital(),this.$swal.fire({icon:"success",title:this.modoEdicaoEdital?"Edital Atualizado!":"Edital Criado!",text:`Edital ${this.editalAtual.numero} ${this.modoEdicaoEdital?"atualizado":"criado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar edital:",a),this.$swal.fire("Erro","Erro ao salvar edital: "+a.message,"error")}finally{this.salvandoEdital=!1}},visualizarEdital(a){this.editalSelecionado={...a},this.modalVisualizarEdital=!0},fecharModalVisualizarEdital(){this.modalVisualizarEdital=!1,this.editalSelecionado={}},editarEdital(a){this.editalEditando={id:a.id,numero:a.numero,descricao:a.descricao,conteudo:a.conteudo||"",status:a.status,data_publicacao:a.data_publicacao?new Date(a.data_publicacao).toISOString().slice(0,16):"",data_limite_impugnacao:a.data_limite_impugnacao?new Date(a.data_limite_impugnacao).toISOString().slice(0,16):""},this.modalEditarEdital=!0},editarEditalSelecionado(){this.fecharModalVisualizarEdital(),this.editarEdital(this.editalSelecionado)},fecharModalEditarEdital(){this.modalEditarEdital=!1,this.editalEditando={id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:""}},async salvarEdicaoEdital(){if(this.editalEditando.numero&&this.editalEditando.numero.trim())if(this.editalEditando.descricao&&this.editalEditando.descricao.trim())if(this.editalEditando.numero.trim().length<3)this.$swal.fire("Erro","NÃºmero do edital deve ter pelo menos 3 caracteres","error");else{console.log("ğŸ” Iniciando ediÃ§Ã£o do edital:",{id:this.editalEditando.id,numero:this.editalEditando.numero,descricao:this.editalEditando.descricao,tenant_id:this.currentTenantId}),this.salvandoEdicaoEdital=!0;try{const{data:a,error:o}=await N.ND.from("editais").select("id").eq("numero",this.editalEditando.numero).eq("tenant_id",this.currentTenantId).neq("id",this.editalEditando.id);if(o)return console.error("Erro ao verificar duplicata:",o),void this.$swal.fire("Erro","Erro ao verificar duplicata de edital. Tente novamente.","error");if(a&&a.length>0)return void this.$swal.fire("Erro",`JÃ¡ existe outro edital com o nÃºmero "${this.editalEditando.numero}". Por favor, escolha outro nÃºmero.`,"error");const t={numero:this.editalEditando.numero.trim(),descricao:this.editalEditando.descricao.trim(),atualizado_em:(new Date).toISOString()};this.editalEditando.conteudo&&this.editalEditando.conteudo.trim()&&(t.conteudo=this.editalEditando.conteudo.trim()),this.editalEditando.data_publicacao&&this.editalEditando.data_publicacao.trim()&&(t.data_publicacao=this.editalEditando.data_publicacao),this.editalEditando.data_limite_impugnacao&&this.editalEditando.data_limite_impugnacao.trim()&&(t.data_limite_impugnacao=this.editalEditando.data_limite_impugnacao),console.log("ğŸ”„ Atualizando edital:",{id:this.editalEditando.id,tenant_id:this.currentTenantId,dados:t});const{data:e,error:s}=await N.ND.from("editais").update(t).eq("id",this.editalEditando.id).eq("tenant_id",this.currentTenantId).select();if(s)throw console.error("âŒ Erro detalhado na atualizaÃ§Ã£o do edital:",s),s;console.log("âœ… Edital atualizado com sucesso:",e),this.$swal.fire({icon:"success",title:"Edital Atualizado!",text:`Edital "${this.editalEditando.numero}" atualizado com sucesso.`,timer:2e3,showConfirmButton:!1}),await this.carregarEditais(),this.fecharModalEditarEdital()}catch(a){console.error("âŒ Erro ao salvar edital:",a);let o="NÃ£o foi possÃ­vel salvar as alteraÃ§Ãµes. Tente novamente.";"23505"===a.code?o="JÃ¡ existe um edital com este nÃºmero. Por favor, escolha outro nÃºmero.":"23514"===a.code?o="Dados invÃ¡lidos fornecidos. Verifique se todos os campos estÃ£o corretos.":"PGRST116"===a.code?o="Nenhum edital foi encontrado para atualizar. O edital pode ter sido removido.":"PGRST204"===a.code?(o="Erro no esquema do banco de dados. Contacte o administrador do sistema.",console.error("âŒ Erro PGRST204 - Coluna nÃ£o encontrada:",a)):a.message&&(a.message.includes("duplicate key")?o="JÃ¡ existe um edital com este nÃºmero.":a.message.includes("violates check constraint")?o="Os dados fornecidos nÃ£o atendem aos requisitos do sistema.":a.message.includes("permission denied")&&(o="VocÃª nÃ£o tem permissÃ£o para editar este edital.")),this.$swal.fire("Erro",o,"error")}finally{this.salvandoEdicaoEdital=!1}}else this.$swal.fire("Erro","DescriÃ§Ã£o do edital Ã© obrigatÃ³ria","error");else this.$swal.fire("Erro","NÃºmero do edital Ã© obrigatÃ³rio","error")},getStatusText(a){const o={RASCUNHO:"Em ElaboraÃ§Ã£o",PUBLICADO:"Publicado",CANCELADO:"Cancelado",INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"DocumentaÃ§Ã£o Enviada",EM_AVALIACAO:"Em AvaliaÃ§Ã£o",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return o[a]||a},async duplicarEdital(a){try{const o=await this.$swal.fire({title:"Duplicar Edital",text:"Digite o nÃºmero do novo edital:",input:"text",inputValue:"",inputPlaceholder:"Ex: 002/2024",showCancelButton:!0,confirmButtonText:"Duplicar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"VocÃª precisa inserir um nÃºmero!"}});if(o.isConfirmed){const t=o.value,e={tenant_id:this.currentTenantId,numero:t,descricao:a.descricao+" (CÃ³pia)",conteudo:a.conteudo,status:"RASCUNHO",data_publicacao:(new Date).toISOString(),data_limite_impugnacao:a.data_limite_impugnacao},{error:s}=await N.ND.from("editais").insert(e);if(s)throw s;await this.carregarEditais(),this.$swal.fire("Sucesso!",`Edital ${t} criado com sucesso.`,"success")}}catch(o){console.error("Erro ao duplicar edital:",o),this.$swal.fire("Erro","Erro ao duplicar edital","error")}},async cancelarEdital(a){try{const o=await this.$swal.fire({title:"Cancelar Edital",text:`Tem certeza que deseja cancelar o edital ${a.numero}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, cancelar",cancelButtonText:"NÃ£o",confirmButtonColor:"#d33"});if(o.isConfirmed){const{error:o}=await N.ND.from("editais").update({status:"CANCELADO"}).eq("id",a.id);if(o)throw o;await this.carregarEditais(),this.$swal.fire("Cancelado!",`Edital ${a.numero} foi cancelado.`,"success")}}catch(o){console.error("Erro ao cancelar edital:",o),this.$swal.fire("Erro","Erro ao cancelar edital","error")}},gerenciarParticipantes(a){console.log("Abrindo modal de participantes para:",a.numero),this.criarModalParticipantes(a)},async criarModalParticipantes(a){const{data:o,error:e}=await N.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a.id).order("data_participacao",{ascending:!1});if(e)return console.error("Erro ao carregar participantes:",e),void this.$swal.fire("Erro","Erro ao carregar participantes","error");console.log("Participantes carregados:",o);const s=`\n          <div id="modal-participantes-custom" style="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            background: rgba(0,0,0,0.8);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 999999;\n          ">\n            <div style="\n              background: white;\n              border-radius: 12px;\n              width: 90%;\n              max-width: 1000px;\n              max-height: 80vh;\n              overflow-y: auto;\n              box-shadow: 0 10px 30px rgba(0,0,0,0.5);\n            ">\n              <div style="\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 20px 25px;\n                border-bottom: 1px solid #eee;\n                background: #f8f9fa;\n                border-radius: 12px 12px 0 0;\n              ">\n                <h3 style="margin: 0; color: #2c3e50;">ğŸ‘¥ Participantes - ${a.numero}</h3>\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  background: none;\n                  border: none;\n                  font-size: 24px;\n                  cursor: pointer;\n                  color: #6c757d;\n                  width: 30px;\n                  height: 30px;\n                  border-radius: 50%;\n                ">&times;</button>\n              </div>\n              \n              <div style="padding: 25px;">\n                <div style="margin-bottom: 20px;">\n                  <h4>ğŸ“Š Total de Participantes: ${o.length}</h4>\n                </div>\n                \n                ${o.length>0?`\n                  <div style="display: grid; gap: 15px;">\n                    ${o.map((a=>`\n                      <div style="\n                        border: 1px solid #ddd;\n                        border-radius: 8px;\n                        padding: 20px;\n                        background: #f9f9f9;\n                      ">\n                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">\n                          <h4 style="margin: 0; color: #2c3e50;">${a.razao_social}</h4>\n                          <span style="\n                            padding: 4px 12px;\n                            border-radius: 20px;\n                            font-size: 12px;\n                            font-weight: 600;\n                            background: ${this.getStatusColor(a.status)};\n                            color: white;\n                          ">${this.getStatusText(a.status)}</span>\n                        </div>\n                        \n                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 15px;">\n                          <p style="margin: 5px 0;"><strong>CNPJ:</strong> ${this.formatarCNPJSimples(a.cnpj)}</p>\n                          <p style="margin: 5px 0;"><strong>Representante:</strong> ${a.representante_legal}</p>\n                          <p style="margin: 5px 0;"><strong>Email:</strong> ${a.email}</p>\n                          <p style="margin: 5px 0;"><strong>Telefone:</strong> ${a.telefone||"N/A"}</p>\n                          <p style="margin: 5px 0;"><strong>Data InscriÃ§Ã£o:</strong> ${this.formatDateSimples(a.data_participacao)}</p>\n                          ${a.data_envio_documentacao?`<p style="margin: 5px 0;"><strong>Data DocumentaÃ§Ã£o:</strong> ${this.formatDateSimples(a.data_envio_documentacao)}</p>`:""}\n                        </div>\n                        \n                        ${a.endereco?`\n                          <div style="margin-bottom: 15px;">\n                            <p style="margin: 5px 0;"><strong>ğŸ“ EndereÃ§o:</strong> ${a.endereco}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.observacoes?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #fff3cd;\n                            border: 1px solid #ffeaa7;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #856404;">ğŸ’¬ ObservaÃ§Ãµes da Empresa:</p>\n                            <p style="margin: 8px 0 0 0; color: #856404;">${a.observacoes}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.produtos_submetidos&&a.produtos_submetidos.length>0?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #d1ecf1;\n                            border: 1px solid #bee5eb;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #0c5460;">ğŸ“¦ Produtos Submetidos:</p>\n                            <ul style="margin: 8px 0 0 20px; color: #0c5460;">\n                              ${a.produtos_submetidos.map((a=>`<li>${a.nome||a}</li>`)).join("")}\n                            </ul>\n                          </div>\n                        `:""}\n                        \n                        <div style="margin-top: 15px;">\n                          <div style="display: flex; gap: 10px; margin-bottom: 10px;">\n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'APROVADO')" style="\n                              padding: 8px 16px;\n                              background: #28a745;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">âœ… Aprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'REPROVADO')" style="\n                              padding: 8px 16px;\n                              background: #dc3545;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">âŒ Reprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'EM_AVALIACAO')" style="\n                              padding: 8px 16px;\n                              background: #ffc107;\n                              color: #212529;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">ğŸ”„ Em AvaliaÃ§Ã£o</button>\n                            \n                            <button onclick="window.adicionarObservacaoInterna('${a.id}')" style="\n                              padding: 8px 16px;\n                              background: #6f42c1;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">ğŸ“ Adicionar ObservaÃ§Ã£o</button>\n                          </div>\n                          \n                          ${a.observacoes_internas?`\n                            <div style="\n                              padding: 12px;\n                              background: #e9ecef;\n                              border: 1px solid #ced4da;\n                              border-radius: 6px;\n                              margin-top: 10px;\n                            ">\n                              <p style="margin: 0; font-weight: 600; color: #495057;">ğŸ”’ ObservaÃ§Ãµes Internas da CPM:</p>\n                              <p style="margin: 8px 0 0 0; color: #495057; font-style: italic;">${a.observacoes_internas}</p>\n                            </div>\n                          `:""}\n                        </div>\n                      </div>\n                    `)).join("")}\n                  </div>\n                `:'\n                  <div style="text-align: center; padding: 40px; color: #6c757d;">\n                    <div style="font-size: 48px; margin-bottom: 20px;">ğŸ‘¥</div>\n                    <h3>Nenhum participante encontrado</h3>\n                    <p>Ainda nÃ£o hÃ¡ empresas inscritas neste edital.</p>\n                  </div>\n                '}\n              </div>\n              \n              <div style="\n                padding: 20px 25px;\n                border-top: 1px solid #eee;\n                display: flex;\n                justify-content: flex-end;\n              ">\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  padding: 10px 20px;\n                  background: #6c757d;\n                  color: white;\n                  border: none;\n                  border-radius: 6px;\n                  cursor: pointer;\n                ">Fechar</button>\n              </div>\n            </div>\n          </div>\n        `;document.body.insertAdjacentHTML("beforeend",s),window.alterarStatusParticipante=async(o,s)=>{try{const{data:e,error:r}=await N.ND.from("participantes_editais").select("*").eq("id",o).single();if(r)throw r;const{error:n}=await N.ND.from("participantes_editais").update({status:s}).eq("id",o);if(n)throw n;let c=null;if("APROVADO"===s||"REPROVADO"===s)try{const{enviarEmailParticipanteStatus:o}=await Promise.resolve().then(t.bind(t,3405));if("REPROVADO"===s){document.getElementById("modal-participantes-custom").remove(),await new Promise((a=>setTimeout(a,100)));const a=await this.$swal.fire({title:"âŒ Motivo da ReprovaÃ§Ã£o",text:"Informe o motivo da reprovaÃ§Ã£o (serÃ¡ enviado por email):",input:"textarea",inputPlaceholder:"Ex: DocumentaÃ§Ã£o incompleta, dados inconsistentes, etc.",showCancelButton:!0,confirmButtonText:"Enviar Email",cancelButtonText:"Pular Email",inputValidator:a=>{if(!a)return"Por favor, informe o motivo da reprovaÃ§Ã£o!"},heightAuto:!1,backdrop:!0,allowOutsideClick:!1});a.isConfirmed?c=a.value:(console.log("ğŸ“§ UsuÃ¡rio cancelou envio de email de reprovaÃ§Ã£o"),c=null)}if("APROVADO"===s||"REPROVADO"===s&&c){const t="APROVADO"===s?"aprovado":"rejeitado";console.log(`ğŸ“§ Enviando email de ${t} para:`,e.email),await o(e,a,t,c),console.log(`âœ… Email de ${t} enviado com sucesso!`)}else"REPROVADO"!==s||c||console.log("ğŸ“§ Email de reprovaÃ§Ã£o nÃ£o enviado (usuÃ¡rio cancelou)")}catch(i){console.warn(`âš ï¸ Erro ao enviar email de ${s.toLowerCase()}:`,i)}const l=document.getElementById("modal-participantes-custom");l&&l.remove();let d=`Status alterado para ${this.getStatusText(s)}`;if("APROVADO"===s)d+="\nğŸ“§ Email de aprovaÃ§Ã£o enviado automaticamente!";else if("REPROVADO"===s){const a=null!==c;d+=a?"\nğŸ“§ Email de reprovaÃ§Ã£o enviado automaticamente!":"\nğŸ“§ Email de reprovaÃ§Ã£o nÃ£o foi enviado"}this.$swal.fire({icon:"success",title:"Sucesso!",text:d,timer:"APROVADO"===s||"REPROVADO"===s?4e3:2e3}),await this.carregarEditais(),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}catch(e){console.error("Erro ao alterar status:",e);const t=document.getElementById("modal-participantes-custom");t&&t.remove(),this.$swal.fire({icon:"error",title:"Erro",text:"Erro ao alterar status do participante"}),setTimeout((()=>{this.criarModalParticipantes(a)}),2e3)}},window.adicionarObservacaoInterna=async o=>{try{document.getElementById("modal-participantes-custom").remove(),await new Promise((a=>setTimeout(a,100)));const t=await this.$swal.fire({title:"ObservaÃ§Ã£o Interna da CPM",text:"Esta observaÃ§Ã£o serÃ¡ visÃ­vel apenas para a equipe da CPM",input:"textarea",inputPlaceholder:"Digite suas observaÃ§Ãµes sobre a anÃ¡lise deste participante...",showCancelButton:!0,confirmButtonText:"Salvar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"VocÃª precisa inserir uma observaÃ§Ã£o!"}});if(t.isConfirmed){const e=t.value,{error:s}=await N.ND.from("participantes_editais").update({observacoes_internas:e}).eq("id",o);if(s)throw s;this.$swal.fire({icon:"success",title:"Sucesso!",text:"ObservaÃ§Ã£o interna adicionada com sucesso"}),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}}catch(e){console.error("Erro ao adicionar observaÃ§Ã£o:",e),this.$swal.fire({icon:"error",title:"Erro",text:"Erro ao adicionar observaÃ§Ã£o interna"}),setTimeout((()=>{this.criarModalParticipantes(a)}),2e3)}}},getStatusColor(a){const o={INTERESSADO:"#17a2b8",DOCUMENTACAO_ENVIADA:"#ffc107",EM_AVALIACAO:"#fd7e14",APROVADO:"#28a745",REPROVADO:"#dc3545",DESISTENTE:"#6c757d"};return o[a]||"#6c757d"},formatarCNPJSimples(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatDateSimples(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},abrirDocumento(a){console.log("ğŸ“„ Abrindo documento:",a),a&&"uploads/documento-exemplo.pdf"!==a?a.includes("editais-pdf/")||a.includes(".pdf")?window.open(a,"_blank"):this.$swal.fire({icon:"warning",title:"Documento ainda nÃ£o convertido",html:'\n                <p>Este edital ainda contÃ©m a minuta Word original.</p>\n                <p><strong>Para obter o PDF oficial:</strong></p>\n                <ol style="text-align: left; margin: 15px 0;">\n                  <li>Clique em "Converter para PDF e Publicar"</li>\n                  <li>Confirme a conversÃ£o</li>\n                  <li>O sistema gerarÃ¡ o PDF oficial automaticamente</li>\n                </ol>\n                <p style="color: #28a745;">ApÃ³s a conversÃ£o, o botÃ£o "Abrir PDF" mostrarÃ¡ o documento oficial.</p>\n              ',confirmButtonText:"Entendi",confirmButtonColor:"#3085d6"}):this.$swal.fire("Aviso","Documento nÃ£o disponÃ­vel","warning")},async baixarDocumento(a){if(a.url_documento&&"uploads/documento-exemplo.pdf"!==a.url_documento)try{this.$swal.fire({title:"Preparando download...",text:"Aguarde um momento",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const o=document.createElement("a");o.href=a.url_documento,o.download=a.nome_arquivo||`edital_${a.numero}.pdf`,o.target="_blank",document.body.appendChild(o),o.click(),document.body.removeChild(o),this.$swal.close()}catch(o){console.error("Erro no download:",o),this.$swal.fire({icon:"error",title:"Erro no download",text:"NÃ£o foi possÃ­vel baixar o arquivo. Tente novamente."})}else this.$swal.fire("Aviso","Documento nÃ£o disponÃ­vel para download","warning")},async handleFileUpload(a){const o=a.target.files[0];if(o){if("application/pdf"!==o.type)return this.$swal.fire("Erro","Apenas arquivos PDF sÃ£o permitidos","error"),void(a.target.value="");if(o.size>10485760)return this.$swal.fire("Erro","Arquivo muito grande. MÃ¡ximo 10MB","error"),void(a.target.value="");try{this.$swal.fire({title:"Fazendo upload...",text:"Aguarde enquanto o arquivo Ã© enviado",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const a=Date.now(),t=localStorage.getItem("tenant_id")||"default",e=`edital_${a}_${o.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,s=`${t}/editais/${e}`,{data:i,error:r}=await N.ND.storage.from("editais").upload(s,o,{cacheControl:"3600",upsert:!1});if(r)throw console.error("Erro no upload:",r),r;const{data:n}=N.ND.storage.from("editais").getPublicUrl(s);if(!n?.publicUrl)throw new Error("NÃ£o foi possÃ­vel obter URL do arquivo");this.editalAtual.url_documento=n.publicUrl,this.editalAtual.nome_arquivo=o.name,this.$swal.fire({icon:"success",title:"Upload realizado!",text:"Arquivo PDF enviado com sucesso",timer:2e3})}catch(t){if(console.error("Erro no upload:",t),t.message?.includes("Bucket not found")||404===t.statusCode)try{return await this.criarBucketEditais(),void await this.handleFileUpload(a)}catch(e){console.error("Erro ao criar bucket:",e)}this.$swal.fire({icon:"error",title:"Erro no upload",text:"NÃ£o foi possÃ­vel enviar o arquivo. Tente novamente.",footer:t.message||"Erro desconhecido"}),a.target.value=""}}},async criarBucketEditais(){try{const{data:a,error:o}=await N.ND.storage.createBucket("editais",{public:!0,fileSizeLimit:10485760,allowedMimeTypes:["application/pdf"]});if(o&&!o.message.includes("already exists"))throw o;console.log("Bucket editais criado/verificado com sucesso")}catch(a){throw console.error("Erro ao criar bucket editais:",a),a}},async carregarParticipantes(a){try{console.log("Carregando participantes para edital ID:",a),console.log("Tenant ID:",this.currentTenantId),this.loadingParticipantes=!0;const{data:o,error:t}=await N.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a).order("data_participacao",{ascending:!1});if(t)throw t;console.log("Participantes carregados:",o),this.participantes=o||[],this.aplicarFiltrosParticipantes()}catch(o){console.error("Erro ao carregar participantes:",o),this.$swal.fire("Erro","Erro ao carregar participantes: "+o.message,"error")}finally{this.loadingParticipantes=!1}},aplicarFiltrosParticipantes(){let a=[...this.participantes];if(this.filtroParticipantes.busca){const o=this.filtroParticipantes.busca.toLowerCase();a=a.filter((a=>a.razao_social.toLowerCase().includes(o)||a.cnpj.includes(o)||a.representante_legal.toLowerCase().includes(o)||a.email.toLowerCase().includes(o)))}this.filtroParticipantes.status&&(a=a.filter((a=>a.status===this.filtroParticipantes.status))),this.participantesFiltrados=a},formatarCNPJ(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},abrirModalNovoParticipante(){this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},this.modalNovoParticipante=!0},fecharModalParticipantes(){this.modalParticipantes=!1,this.editalSelecionado={},this.participantes=[],this.participantesFiltrados=[],this.filtroParticipantes={busca:"",status:""}},fecharModalNovoParticipante(){this.modalNovoParticipante=!1,this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]}},async salvarParticipante(){try{if(!this.participanteAtual.razao_social||!this.participanteAtual.cnpj||!this.participanteAtual.representante_legal||!this.participanteAtual.email)return void this.$swal.fire("Erro","Preencha todos os campos obrigatÃ³rios","error");const a={tenant_id:this.currentTenantId,edital_id:this.editalSelecionado.id,razao_social:this.participanteAtual.razao_social,cnpj:this.participanteAtual.cnpj,representante_legal:this.participanteAtual.representante_legal,email:this.participanteAtual.email,telefone:this.participanteAtual.telefone,endereco:this.participanteAtual.endereco,status:this.participanteAtual.status,observacoes:this.participanteAtual.observacoes,produtos_submetidos:this.participanteAtual.produtos_submetidos};let o;if(this.participanteAtual.id){const{data:t,error:e}=await N.ND.from("participantes_editais").update(a).eq("id",this.participanteAtual.id).select().single();o={data:t,error:e}}else{const{data:t,error:e}=await N.ND.from("participantes_editais").insert(a).select().single();o={data:t,error:e}}if(o.error)throw o.error;await this.carregarParticipantes(this.editalSelecionado.id),this.fecharModalNovoParticipante(),this.$swal.fire({icon:"success",title:"Participante salvo!",text:`${this.participanteAtual.razao_social} foi ${this.participanteAtual.id?"atualizado":"adicionado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar participante:",a),this.$swal.fire("Erro","Erro ao salvar participante: "+a.message,"error")}},editarParticipante(a){this.participanteAtual={...a},this.modalNovoParticipante=!0},async removerParticipante(a){try{const o=await this.$swal.fire({title:"Remover Participante",text:`Tem certeza que deseja remover ${a.razao_social}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar",confirmButtonColor:"#d33"});if(o.isConfirmed){const{error:o}=await N.ND.from("participantes_editais").delete().eq("id",a.id);if(o)throw o;await this.carregarParticipantes(this.editalSelecionado.id),await this.carregarEditais(),this.$swal.fire("Removido!","Participante removido com sucesso.","success")}}catch(o){console.error("Erro ao remover participante:",o),this.$swal.fire("Erro","Erro ao remover participante: "+o.message,"error")}},async carregarUsuarios(){try{const{data:a,error:o}=await N.ND.from("usuarios_rdm").select("*").eq("tenant_id",this.currentTenantId).order("nome_usuario",{ascending:!0});if(o)throw o;this.usuarios=a||[],this.aplicarFiltrosUsuarios()}catch(a){console.error("Erro ao carregar usuÃ¡rios:",a)}},aplicarFiltrosUsuarios(){let a=[...this.usuarios];if(this.filtroUsuarios.busca){const o=this.filtroUsuarios.busca.toLowerCase();a=a.filter((a=>a.nome_usuario?.toLowerCase().includes(o)||a.unidade_setor?.toLowerCase().includes(o)||a.nome_coordenador?.toLowerCase().includes(o)||a.email?.toLowerCase().includes(o)))}this.filtroUsuarios.unidade&&(a=a.filter((a=>a.unidade_setor===this.filtroUsuarios.unidade))),this.usuariosFiltrados=a},async abrirModalNovoUsuario(){console.log("â• Abrindo modal de novo usuÃ¡rio..."),await this.carregarProdutos(),this.usuarioAtual={nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[{produto_id:"",nome:"",codigo:"",periodicidade_rdm:""}],criar_login:!1},console.log("âœ… Modal novo usuÃ¡rio preparado"),console.log("ğŸ“¦ Produtos disponÃ­veis:",this.produtosDisponiveis.length),this.modalNovoUsuario=!0},fecharModalNovoUsuario(){this.modalNovoUsuario=!1,this.usuarioAtual={nome_usuario:"",unidade_setor:"",nome_coordenador:"",telefone:"",email:"",materiais:[],criar_login:!1}},adicionarMaterial(){this.usuarioAtual.materiais.push({produto_id:"",nome:"",codigo:"",periodicidade_rdm:""})},removerMaterial(a){this.usuarioAtual.materiais.splice(a,1)},async salvarUsuario(){console.log("ğŸš€ INICIANDO salvarUsuario..."),console.log("ğŸ“Š Estado inicial:",{usuarioAtual:this.usuarioAtual,temCriarLogin:this.usuarioAtual?.criar_login,temId:!!this.usuarioAtual?.id});try{let t=null,e=null;if(console.log("âœ… VariÃ¡veis inicializadas com sucesso"),console.log("ğŸ” Verificando necessidade de criar login..."),this.usuarioAtual.criar_login&&!this.usuarioAtual.id){console.log("ğŸ” Criando login automÃ¡tico para:",this.usuarioAtual.email),console.log("ğŸ¯ Gerando senha temporÃ¡ria..."),t=this.gerarSenhaTemporaria(),console.log("âœ… Senha temporÃ¡ria gerada:",t?"SIM":"NÃƒO");try{console.log("ğŸ” SIMULAÃ‡ÃƒO - Criando usuÃ¡rio:",{email:this.usuarioAtual.email,senha:t,tipo:"rdm"});const a=crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const o=16*Math.random()|0,t="x"==a?o:3&o|8;return t.toString(16)})),o={user:{id:a}},s=null;if(s)throw console.error("Erro ao criar usuÃ¡rio no Supabase Auth:",s),new Error("NÃ£o foi possÃ­vel criar o login. Verifique se o email jÃ¡ estÃ¡ cadastrado.");e=o.user.id,console.log("âœ… UsuÃ¡rio criado no Supabase Auth:",e)}catch(a){console.error("Erro na criaÃ§Ã£o do login:",a),alert("Erro ao criar login do usuÃ¡rio. UsuÃ¡rio serÃ¡ cadastrado sem acesso ao sistema.")}}console.log("ğŸ“ Preparando dados do usuÃ¡rio..."),console.log("ğŸ”‘ Dados de entrada:",{currentTenantId:this.currentTenantId,usuarioSupabaseId:e,senhaTemporaria:t?"EXISTE":"NULL"});const s={...this.usuarioAtual,tenant_id:this.currentTenantId,user_id:e,senha_temporaria:t,convite_enviado:!1,convite_aceito:!1,ativo:!0,criado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()};if(console.log("âœ… Dados do usuÃ¡rio preparados com sucesso"),delete s.criar_login,this.usuarioAtual.id||(delete s.id,console.log("ğŸ†” Campo ID removido para permitir geraÃ§Ã£o automÃ¡tica de UUID")),console.log("ğŸ“ Dados preparados para inserÃ§Ã£o:",{temId:!!s.id,tenant_id:s.tenant_id,nome_usuario:s.nome_usuario,email:s.email,materiais:s.materiais?.length||0}),console.log("ğŸ” DIAGNÃ“STICO TENANT_ID:",{currentTenantId:this.currentTenantId,userDataTenantId:s.tenant_id,tenantIdType:typeof s.tenant_id,tenantIdLength:s.tenant_id?.length,isValidUUID:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s.tenant_id)}),this.usuarioAtual.id){const a={...s};this.usuarioAtual.criar_login||(delete a.user_id,delete a.senha_temporaria,delete a.convite_enviado,delete a.convite_aceito,console.log("ğŸ” Campos de login preservados (nÃ£o serÃ£o sobrescritos)"));const{error:o}=await N.ND.from("usuarios_rdm").update(a).eq("id",this.usuarioAtual.id).eq("tenant_id",this.currentTenantId);if(o)throw o;console.log("âœ… UsuÃ¡rio atualizado com sucesso")}else{const{data:a,error:o}=await N.ND.from("usuarios_rdm").insert([s]).select();if(o)throw o;s.id=a[0].id,console.log("âœ… UsuÃ¡rio criado com sucesso:",s.id)}console.log("ğŸ“§ Verificando envio de email...");let i=null;if(e&&t){console.log("ğŸ“§ CondiÃ§Ãµes atendidas, enviando email..."),console.log("ğŸ“§ Dados para envio:",{usuarioSupabaseId:e?"EXISTE":"NULL",senhaTemporaria:t?"EXISTE":"NULL",email:s.email});try{i=await this.enviarEmailConvite(s,t),console.log("ğŸ“§ Resultado do email:",i)}catch(o){console.error("âŒ ERRO ESPECÃFICO NO EMAIL:",o),i={success:!1,message:o.message}}}else console.log("â© Pulando envio de email (condiÃ§Ãµes nÃ£o atendidas)");this.fecharModalNovoUsuario(),await this.carregarUsuarios(),e?i&&i.success?alert(`ğŸ‰ USUÃRIO CADASTRADO COM SUCESSO!\n\nâœ… UsuÃ¡rio: ${this.usuarioAtual.nome_usuario}\nâœ… Login criado no sistema\nâœ… Email enviado para: ${this.usuarioAtual.email}\n\nğŸ“§ O usuÃ¡rio receberÃ¡:\nâ€¢ Link de acesso: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\nâ€¢ Senha temporÃ¡ria para primeiro acesso\nâ€¢ InstruÃ§Ãµes completas de uso\n\nO usuÃ¡rio jÃ¡ pode fazer login no sistema!`):alert(`âš ï¸ USUÃRIO CADASTRADO (Email com problema)\n\nâœ… UsuÃ¡rio: ${this.usuarioAtual.nome_usuario}\nâœ… Login criado no sistema\nâš ï¸ Email NÃƒO foi enviado automaticamente\n\nğŸ”§ AÃ‡ÃƒO NECESSÃRIA:\nEnvie manualmente os dados de acesso:\nğŸ“§ Email: ${this.usuarioAtual.email}\nğŸ”‘ Senha: ${t}\nğŸ”— Link: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\n\nO sistema funciona normalmente, apenas o email automÃ¡tico falhou.`):alert("âœ… UsuÃ¡rio cadastrado com sucesso!"),this.programarAlertasRDM(s)}catch(t){console.error("âŒ ERRO PRINCIPAL em salvarUsuario:",t),console.error("ğŸ“Š INFORMAÃ‡Ã•ES DO ERRO PRINCIPAL:",{tipo:typeof t,nome:t?.name,mensagem:t?.message,stack:t?.stack});let a="Erro desconhecido. Tente novamente.";try{t&&t.message?a=t.message:t&&"function"===typeof t.toString&&(a=t.toString())}catch(e){console.error("Erro ao extrair mensagem:",e)}alert(`âŒ Erro ao salvar usuÃ¡rio: ${a}`)}},async editarUsuario(a){console.log("ğŸ”§ Editando usuÃ¡rio:",a.nome_usuario),console.log("ğŸ“‹ Materiais do usuÃ¡rio:",a.materiais),await this.carregarProdutos(),this.usuarioAtual={...a},this.usuarioAtual.materiais&&Array.isArray(this.usuarioAtual.materiais)||(console.log("âš ï¸ Materiais nÃ£o encontrados, inicializando array vazio"),this.usuarioAtual.materiais=[]),this.usuarioAtual.materiais=this.usuarioAtual.materiais.map(((a,o)=>{console.log(`ğŸ“¦ Processando material ${o+1}:`,a);const t={produto_id:a.produto_id||"",nome:a.nome||"",codigo:a.codigo||"",periodicidade_rdm:a.periodicidade_rdm||"mensal",marca:a.marca||"",categoria:a.categoria||"",...a};return console.log(`âœ… Material ${o+1} processado:`,t),t})),console.log("âœ… UsuÃ¡rio preparado para ediÃ§Ã£o:",this.usuarioAtual),console.log("ğŸ“¦ Produtos disponÃ­veis:",this.produtosDisponiveis.length),this.modalNovoUsuario=!0},async removerUsuario(a){if(confirm(`Tem certeza que deseja remover o usuÃ¡rio "${a.nome_usuario}"?`))try{const{error:o}=await N.ND.from("usuarios_rdm").delete().eq("id",a.id).eq("tenant_id",this.currentTenantId);if(o)throw o;await this.carregarUsuarios()}catch(o){console.error("Erro ao remover usuÃ¡rio:",o),alert("Erro ao remover usuÃ¡rio. Tente novamente.")}},verMateriaisUsuario(a){alert(`Materiais de ${a.nome_usuario}:\n\n${a.materiais?.map((a=>`â€¢ ${a.nome} (${a.codigo}) - RDM ${a.periodicidade_rdm}`)).join("\n")||"Nenhum material cadastrado"}`)},calcularProximoRDM(a){if(!a.materiais||0===a.materiais.length)return"N/A";const o=new Date,t=new Date(o.getFullYear(),o.getMonth()+1,1);return t.toLocaleDateString("pt-BR")},programarAlertasRDM(a){console.log("Alertas RDM programados para:",a.nome_usuario)},async testarEmailJS(){if(confirm("ğŸ§ª Testar configuraÃ§Ã£o do EmailJS?\n\nIsso enviarÃ¡ um email de teste para comprarbemteste@gmail.com"))try{if(console.log("ğŸ§ª Iniciando teste do EmailJS..."),"undefined"===typeof V.Ay||!V.Ay)throw new Error("âŒ EmailJS nÃ£o estÃ¡ carregado");if("function"!==typeof V.Ay.init||"function"!==typeof V.Ay.send)throw new Error("âŒ MÃ©todos EmailJS nÃ£o estÃ£o disponÃ­veis");const o={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};console.log("ğŸ§ª ConfiguraÃ§Ã£o:",o);try{console.log("ğŸ§ª Inicializando EmailJS para teste..."),V.Ay.init(o.publicKey),console.log("âœ… EmailJS inicializado com sucesso para teste")}catch(a){throw console.error("âŒ Erro crÃ­tico na inicializaÃ§Ã£o:",a),new Error("Falha na inicializaÃ§Ã£o do EmailJS para teste: "+a.message)}const t={numero_edital:"TESTE-EMAILJS",email_empresa:"comprarbemteste@gmail.com",message:`\nğŸ§ª TESTE DE CONFIGURAÃ‡ÃƒO EMAILJS\n\nEste Ã© um email de teste para verificar se o EmailJS estÃ¡ funcionando corretamente.\n\n=== INFORMAÃ‡Ã•ES DO TESTE ===\nData do teste: ${(new Date).toLocaleString("pt-BR")}\nSistema: ${window.location.origin}\nTemplate: template_nyiw2ua\nService: service_7sv1naw\n\n=== RESULTADO ===\nSe vocÃª recebeu este email, a configuraÃ§Ã£o estÃ¡ funcionando perfeitamente!\n\n=== PRÃ“XIMO PASSO ===\nAgora vocÃª pode cadastrar usuÃ¡rios RDM com confianÃ§a que os emails serÃ£o enviados.\n\n---\nSistema Comprar Bem - Compras PÃºblicas Inteligentes\nTeste automÃ¡tico de configuraÃ§Ã£o EmailJS\n          `,name:"Teste do Sistema",email:"comprarbemteste@gmail.com",subject:"ğŸ§ª Teste de ConfiguraÃ§Ã£o EmailJS - Sistema Comprar Bem",status_participante:"aprovado",motivo_rejeicao:""};console.log("ğŸ§ª Enviando email de teste..."),console.log("ğŸ§ª ParÃ¢metros:",t);const e=await V.Ay.send(o.serviceId,o.templateId,t,o.publicKey);if(console.log("âœ… Teste bem-sucedido:",e),!e||200!==e.status)throw new Error(`Status de resposta inesperado: ${e?.status}`);alert("âœ… TESTE REALIZADO COM SUCESSO!\n\nğŸ“§ Email de teste enviado para comprarbemteste@gmail.com\n\nâœ… EmailJS estÃ¡ configurado corretamente")}catch(o){console.error("âŒ Falha no teste:",o),alert(`âŒ FALHA NO TESTE DO EMAILJS\n\nErro: ${o.message}\n\nPossÃ­veis causas:\nâ€¢ ConfiguraÃ§Ã£o incorreta do EmailJS\nâ€¢ Problemas de conectividade\nâ€¢ Service ID ou Template ID invÃ¡lidos\nâ€¢ Public Key incorreta\n\nVerifique:\n1. ConfiguraÃ§Ã£o no EmailJS Dashboard\n2. ConexÃ£o com a internet\n3. Console do navegador para mais detalhes`)}},async carregarReclamacoes(){try{console.log("ğŸ” [RECLAMAÃ‡Ã•ES CPM] Carregando reclamaÃ§Ãµes para tenant:",this.currentTenantId);const{data:a,error:o}=await N.ND.from("reclame_aqui").select("*").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});o?(console.error("âŒ [RECLAMAÃ‡Ã•ES CPM] Erro ao carregar reclamaÃ§Ãµes:",o),this.reclamacoes=[]):(console.log("âœ… [RECLAMAÃ‡Ã•ES CPM] ReclamaÃ§Ãµes carregadas:",a?.length||0),this.reclamacoes=a||[],this.reclamacoes.forEach((a=>{a.nova_resposta||this.$set(a,"nova_resposta",""),a.novo_status||this.$set(a,"novo_status",a.status),a.nova_prioridade||this.$set(a,"nova_prioridade",a.prioridade)}))),this.aplicarFiltrosReclamacoes()}catch(a){console.error("âŒ [RECLAMAÃ‡Ã•ES CPM] Erro geral ao carregar reclamaÃ§Ãµes:",a),this.reclamacoes=[],this.aplicarFiltrosReclamacoes()}},aplicarFiltrosReclamacoes(){this.reclamacoesFiltradas=this.reclamacoes.filter((a=>{const o=!this.filtroReclamacoes.busca||a.nome_reclamante.toLowerCase().includes(this.filtroReclamacoes.busca.toLowerCase())||a.descricao_reclamacao.toLowerCase().includes(this.filtroReclamacoes.busca.toLowerCase()),t=!this.filtroReclamacoes.status||a.status===this.filtroReclamacoes.status,e=!this.filtroReclamacoes.prioridade||a.prioridade===this.filtroReclamacoes.prioridade;return o&&t&&e}))},async salvarRespostaReclamacao(a){if(a.nova_resposta?.trim()){this.salvandoResposta=!0;try{const{error:o}=await N.ND.from("reclame_aqui").update({resposta_cpm:a.nova_resposta,respondido_por:this.currentUserId,respondido_em:(new Date).toISOString(),status:"respondida"}).eq("id",a.id);if(o)throw o;a.resposta_cpm=a.nova_resposta,a.respondido_em=(new Date).toISOString(),a.status="respondida",a.nova_resposta="",alert("âœ… Resposta salva com sucesso!"),this.aplicarFiltrosReclamacoes()}catch(o){console.error("âŒ Erro ao salvar resposta:",o),alert("âŒ Erro ao salvar resposta. Tente novamente.")}finally{this.salvandoResposta=!1}}else alert("Por favor, digite uma resposta antes de salvar.")},async alterarStatusReclamacao(a){if(a.novo_status&&a.novo_status!==a.status){this.salvandoStatus=!0;try{const{error:o}=await N.ND.from("reclame_aqui").update({status:a.novo_status}).eq("id",a.id);if(o)throw o;a.status=a.novo_status,this.aplicarFiltrosReclamacoes()}catch(o){console.error("âŒ Erro ao alterar status:",o),alert("âŒ Erro ao alterar status. Tente novamente."),a.novo_status=a.status}finally{this.salvandoStatus=!1}}},async alterarPrioridadeReclamacao(a){if(a.nova_prioridade&&a.nova_prioridade!==a.prioridade){this.salvandoPrioridade=!0;try{const{error:o}=await N.ND.from("reclame_aqui").update({prioridade:a.nova_prioridade}).eq("id",a.id);if(o)throw o;a.prioridade=a.nova_prioridade,this.aplicarFiltrosReclamacoes()}catch(o){console.error("âŒ Erro ao alterar prioridade:",o),alert("âŒ Erro ao alterar prioridade. Tente novamente."),a.nova_prioridade=a.prioridade}finally{this.salvandoPrioridade=!1}}},editarResposta(a){a.nova_resposta=a.resposta_cpm,a.resposta_cpm=null},getPrioridadeClass(a){const o={baixa:"prioridade-baixa",normal:"prioridade-normal",alta:"prioridade-alta",critica:"prioridade-critica"};return o[a]||"prioridade-normal"},getPrioridadeText(a){const o={baixa:"Baixa",normal:"Normal",alta:"Alta",critica:"CrÃ­tica"};return o[a]||a},async enriquecerAvaliacoesComUsuarios(a){try{const o=[];for(const t of a)if(t.usuario_rdm_id){const{data:a,error:e}=await N.ND.from("usuarios_rdm").select("nome_usuario, unidade_setor, email, telefone").eq("id",t.usuario_rdm_id).eq("tenant_id",this.currentTenantId).single();o.push({...t,usuario_rdm:a||null})}else o.push({...t,usuario_rdm:null});return o}catch(o){return console.error("âŒ [AVALIAÃ‡Ã•ES CPM] Erro ao enriquecer com usuÃ¡rios:",o),a.map((a=>({...a,usuario_rdm:null})))}},aplicarFiltrosAvaliacoes(){let a=[...this.avaliacoes];if(this.filtroAvaliacoes.busca){const o=this.filtroAvaliacoes.busca.toLowerCase();a=a.filter((a=>a.material_nome?.toLowerCase().includes(o)||a.material_codigo?.toLowerCase().includes(o)||a.usuario_rdm?.nome_usuario?.toLowerCase().includes(o)||a.usuario_rdm?.unidade_setor?.toLowerCase().includes(o)||a.comentario?.toLowerCase().includes(o)))}this.filtroAvaliacoes.rating&&(a=a.filter((a=>a.rating==this.filtroAvaliacoes.rating))),this.filtroAvaliacoes.usuario&&(a=a.filter((a=>a.usuario_rdm?.nome_usuario?.toLowerCase().includes(this.filtroAvaliacoes.usuario.toLowerCase())))),this.avaliacoesFiltradas=a},async salvarRespostaCPM(a){if(a.nova_resposta&&a.nova_resposta.trim()){this.salvandoResposta=!0;try{const{error:o}=await N.ND.from("material_feedbacks").update({resposta_cpm:a.nova_resposta.trim(),data_resposta_cpm:(new Date).toISOString()}).eq("id",a.id);if(o)throw o;a.resposta_cpm=a.nova_resposta.trim(),a.data_resposta_cpm=(new Date).toISOString(),a.nova_resposta="",this.$swal({title:"Sucesso!",text:"ComentÃ¡rio/DecisÃ£o da CPM salvo com sucesso",icon:"success",timer:2e3,showConfirmButton:!1})}catch(o){console.error("Erro ao salvar resposta da CPM:",o),this.$swal({title:"Erro",text:"Erro ao salvar resposta: "+o.message,icon:"error"})}finally{this.salvandoResposta=!1}}else this.$swal({title:"AtenÃ§Ã£o",text:"Por favor, digite um comentÃ¡rio ou decisÃ£o.",icon:"warning"})},toggleLoginSystem(){this.usuarioAtual.criar_login||(this.usuarioAtual.senha_temporaria=null,this.usuarioAtual.user_id=null)},gerarSenhaTemporaria(){const a=(new Date).getFullYear(),o=Math.floor(1e4*Math.random()).toString().padStart(4,"0");return`CB${a}${o}`},async enviarEmailConvite(a,o){try{if(console.log("ğŸ“§ Enviando email REAL de convite para:",a.email),"undefined"===typeof V.Ay||!V.Ay)throw new Error("EmailJS nÃ£o estÃ¡ carregado. Verifique a importaÃ§Ã£o.");if("function"!==typeof V.Ay.init||"function"!==typeof V.Ay.send)throw new Error("MÃ©todos EmailJS nÃ£o estÃ£o disponÃ­veis. Verifique a versÃ£o.");const e={serviceId:"service_7sv1naw",templateId:"template_nyiw2ua",publicKey:"DqGKMNJ87ch3qVxGv"};console.log("ğŸ“§ EmailJS disponÃ­vel:",typeof V.Ay),console.log("ğŸ“§ ConfiguraÃ§Ã£o:",e);const s={numero_edital:"RDM-CONVITE",email_empresa:a.email,message:`\nğŸ” BEM-VINDO AO SISTEMA COMPRAR BEM\n\nOlÃ¡ ${a.nome_usuario}!\n\nVocÃª foi cadastrado(a) para acessar o Sistema Comprar Bem - Dashboard RDM Online.\n\n=== SEUS DADOS DE ACESSO ===\nEmail: ${a.email}\nSenha de Acesso: ${o}\nUnidade/Setor: ${a.unidade_setor}\nCoordenador: ${a.nome_coordenador}\n\n=== COMO ACESSAR ===\n1. Acesse: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\n2. FaÃ§a login com seu email e senha\n3. Comece a emitir suas RDMs online!\n\n=== FUNCIONALIDADES DISPONÃVEIS ===\nâœ… EmissÃ£o de RDMs online\nâœ… HistÃ³rico de solicitaÃ§Ãµes\nâœ… Acompanhamento de status\nâœ… NotificaÃ§Ãµes automÃ¡ticas\n\n=== IMPORTANTE ===\nğŸ”‘ Use sempre a mesma senha para acessar o sistema\nğŸ“ Guarde seus dados de acesso em local seguro\nğŸ“ Em caso de dÃºvidas, entre em contato conosco\n\n=== SUPORTE ===\nEmail: comprarbemteste@gmail.com\nSistema: ${window.location.origin}\n\nData do cadastro: ${(new Date).toLocaleDateString("pt-BR")}\n\n---\nSistema Comprar Bem - Compras PÃºblicas Inteligentes\nEste Ã© um email automÃ¡tico. NÃ£o responda diretamente.\n          `,name:a.nome_usuario,email:"comprarbemteste@gmail.com",subject:"ğŸ” Bem-vindo ao Sistema Comprar Bem - Acesso RDM Online",status_participante:"aprovado",motivo_rejeicao:""};console.log("ğŸ“§ Enviando email REAL via EmailJS..."),console.log("ğŸ“§ Para:",a.email),console.log("ğŸ“§ Config EmailJS:",e),console.log("ğŸ“§ ParÃ¢metros do email:",s);try{console.log("ğŸ“§ Inicializando EmailJS com public key..."),V.Ay.init(e.publicKey),console.log("âœ… EmailJS inicializado com sucesso")}catch(t){throw console.error("âŒ Erro na inicializaÃ§Ã£o do EmailJS:",t),new Error("Falha na inicializaÃ§Ã£o do EmailJS: "+t.message)}console.log("ğŸ“§ Chamando emailjs.send...");const i=await V.Ay.send(e.serviceId,e.templateId,s,e.publicKey);if(console.log("ğŸ‰ EMAIL REAL ENVIADO COM SUCESSO!",i),!i||200!==i.status)throw new Error(`Falha no envio do email. Status: ${i?.status||"desconhecido"}`);return await N.ND.from("usuarios_rdm").update({convite_enviado:!0,data_convite:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId),console.log("âœ… Status do convite atualizado no banco"),await this.criarNotificacao(this.currentTenantId,this.currentTenantId,"SISTEMA","Convite RDM Enviado",`âœ… Email de convite enviado com SUCESSO!\n          \nğŸ“§ DestinatÃ¡rio: ${a.nome_usuario} (${a.email})\nğŸ”‘ Senha de acesso: ${o}\nğŸ”— Link de acesso: ${window.location.origin.includes("localhost")?window.location.origin+"/rdm":window.location.origin+"/ComprarBem/#/rdm"}\nğŸ“… Data: ${(new Date).toLocaleString("pt-BR")}\n\nO usuÃ¡rio pode fazer login imediatamente no sistema RDM.`,null),console.log("ğŸ‰ PROCESSO COMPLETO - Email enviado e notificaÃ§Ã£o criada!"),{success:!0,message:"Email enviado com sucesso!"}}catch(e){console.error("âŒ ERRO DETALHADO ao enviar email de convite:",e),console.error("ğŸ“Š INFORMAÃ‡Ã•ES DO ERRO:",{tipo:typeof e,nome:e?.name||"SemNome",mensagem:e?.message||"SemMensagem",stack:e?.stack||"SemStack",usuario:a?.email||"SemEmail",emailjsDisponivel:typeof V.Ay,errorString:e?.toString()||"NÃ£oConvertÃ­vel"});let o="Erro desconhecido";try{let a="Erro sem descriÃ§Ã£o";e&&"object"===typeof e?"string"===typeof e.message?a=e.message:"function"===typeof e.toString&&(a=e.toString()):"string"===typeof e&&(a=e),console.log("ğŸ” Mensagem de erro extraÃ­da:",a),o="string"===typeof a&&a.length>0?-1!==a.indexOf("emailjs")?"EmailJS nÃ£o estÃ¡ carregado ou configurado corretamente":-1!==a.indexOf("network")||-1!==a.indexOf("fetch")?"Erro de conectividade. Verifique sua conexÃ£o com a internet":-1!==a.indexOf("service")||-1!==a.indexOf("template")?"ConfiguraÃ§Ã£o invÃ¡lida do EmailJS (service/template ID)":-1!==a.indexOf("422")?"ParÃ¢metros incorretos do template EmailJS (erro 422)":-1!==a.indexOf("includes")?"Erro interno do JavaScript (propriedade undefined)":a:"Erro sem mensagem vÃ¡lida"}catch(s){console.error("âŒ Erro na anÃ¡lise do erro:",s),o="Erro complexo nÃ£o analisÃ¡vel"}return{success:!1,message:o}}},async criarNotificacao(a,o,t,e,s,i=null){try{const{error:r}=await N.ND.from("notificacoes").insert([{tenant_id:a,usuario_destino:o,tipo:t,titulo:e,mensagem:s,link_acao:i,criado_em:(new Date).toISOString()}]);if(r)throw r}catch(r){console.error("Erro ao criar notificaÃ§Ã£o:",r)}},async verificarStatusConvites(){try{const{data:a,error:o}=await N.ND.from("usuarios_rdm").select("id, nome_usuario, email, convite_enviado, convite_aceito, data_convite").eq("tenant_id",this.currentTenantId).eq("ativo",!0).not("user_id","is",null);if(o)throw o;this.statusConvites=a.reduce(((a,o)=>(a[o.id]={enviado:o.convite_enviado,aceito:o.convite_aceito,dataConvite:o.data_convite},a)),{})}catch(a){console.error("Erro ao verificar status dos convites:",a)}},async reenviarConvite(a){if(confirm(`Reenviar convite de acesso para ${a.nome_usuario}?`))try{const o=this.gerarSenhaTemporaria();await N.ND.from("usuarios_rdm").update({senha_temporaria:o,convite_enviado:!1}).eq("id",a.id).eq("tenant_id",this.currentTenantId),a.user_id&&console.log("ğŸ” SIMULAÃ‡ÃƒO - Atualizando senha para:",a.email,o),await this.enviarEmailConvite({...a,senha_temporaria:o},o),alert("âœ… Convite reenviado com sucesso!"),await this.carregarUsuarios()}catch(o){console.error("Erro ao reenviar convite:",o),alert("âŒ Erro ao reenviar convite. Tente novamente.")}},async carregarProdutos(){try{this.loadingProdutos=!0,console.log("ğŸ“¦ Carregando produtos disponÃ­veis..."),console.log("ğŸ”‘ Tenant ID atual:",this.currentTenantId);const{data:a,error:o}=await N.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status, tenant_id").order("nome");console.log("ğŸ“Š Todos os produtos encontrados:",a?.length||0),console.log("ğŸ“‹ Primeiros 3 produtos:",a?.slice(0,3)),a?.length>0&&console.log("ğŸ” Estrutura do primeiro produto:",{id:a[0].id,nome:a[0].nome,marca:a[0].marca,modelo:a[0].modelo,codigo_material:a[0].codigo_material,categoria_id:a[0].categoria_id,status:a[0].status,tenant_id:a[0].tenant_id});const{data:t,error:e}=await N.ND.from("produtos").select("id, nome, marca, modelo, codigo_material, categoria_id, status, tenant_id").eq("tenant_id",this.currentTenantId).order("nome");if(console.log("ğŸ¯ Produtos do tenant atual:",t?.length||0),console.log("ğŸ“‹ Status dos produtos:",t?.map((a=>a.status))),e)throw console.error("âŒ Erro na query:",e),e;let s=t?.filter((a=>"aprovado"===a.status))||[];0===s.length&&(console.log('âš ï¸ Nenhum produto "aprovado" encontrado, carregando todos os produtos do tenant...'),s=t||[]),this.produtosDisponiveis=s,console.log(`âœ… ${this.produtosDisponiveis.length} produtos carregados para seleÃ§Ã£o`),console.log("ğŸ“¦ Produtos disponÃ­veis:",this.produtosDisponiveis.map((a=>`${a.nome} (${a.status})`)))}catch(a){console.error("âŒ Erro ao carregar produtos:",a),this.produtosDisponiveis=[],alert(`âŒ Erro ao carregar produtos:\n${a.message}\n\nVerifique o console para mais detalhes.`)}finally{this.loadingProdutos=!1}},selecionarProduto(a,o){const t=o.target.value,e=this.usuarioAtual.materiais[a];if(console.log("ğŸ” Selecionando produto:",t,"para material index:",a),"NOVO"===t)e.produto_id="NOVO",e.nome="",e.codigo="",console.log("ğŸ“ Modo novo material ativado");else if(t){const a=this.produtosDisponiveis.find((a=>a.id===t));console.log("ğŸ” Produto encontrado:",a),a&&(e.produto_id=t,e.nome=a.nome,e.codigo=a.codigo_material||a.modelo||"",e.marca=a.marca||"",e.categoria=a.categoria_id||"",console.log("âœ… Dados do produto aplicados:",{nome:e.nome,codigo:e.codigo,marca:e.marca,categoria_id:e.categoria}))}else e.produto_id="",e.nome="",e.codigo="",console.log("ğŸ—‘ï¸ SeleÃ§Ã£o limpa");console.log("ğŸ“‹ Material atualizado:",e)}},formatarData(a){if(!a)return"";const o=new Date(a);return o.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},formatCurrency(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a)}},Ra=Na;var Ia=(0,C.A)(Ra,U,j,!1,null,"a4197398",null);const Ta=Ia.exports;var Fa=t(563),Ma=t(3112);const za={name:"Dashboard",components:{DashboardCPM:Ta},data(){return{showDropdown:!1,usuarioNome:"UsuÃ¡rio",usuarioEmail:"",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais",processosPendentes:0,intervalNotificacao:null}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes(),await this.verificarProcessosPendentes(),this.iniciarMonitoramentoNotificacoes()},beforeUnmount(){this.intervalNotificacao&&clearInterval(this.intervalNotificacao)},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await N.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuÃ¡rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()},async verificarProcessosPendentes(){try{const a=await(0,N.EO)(),o=await Fa.A.obterPerfilUsuarioAtual();if(!a||!o)return;const t={cpm:["aguardando_aprovacao","criado_cpm","rejeitado_admin","rejeitado_ccl","rejeitado_juridico"],orgao_administrativo:["aguardando_assinatura_orgao","aguardando_assinatura_orgao_desp","aprovado_cpm","aprovado_ccl","aprovado_juridico"],ccl:["assinado_admin","julgamento_ccl","abertura_autorizada_desp"],assessoria_juridica:["assinado_admin","aprovado_ccl","com_recurso_desp"]},e=t[o.perfil_usuario]||[];if(0===e.length)return;const{data:s,error:i}=await N.ND.from("processos_administrativos").select("id, status, numero_processo, tipo_processo").eq("tenant_id",a).in("status",e);if(i)return void console.error("Erro ao verificar processos pendentes:",i);this.processosPendentes=s?.length||0,console.log(`ğŸ”” ${this.processosPendentes} processos pendentes para o perfil ${o.perfil_usuario}`)}catch(a){console.error("Erro ao verificar processos pendentes:",a)}},iniciarMonitoramentoNotificacoes(){this.intervalNotificacao=setInterval((()=>{this.verificarProcessosPendentes()}),3e4)},async testarEmailJS(){this.closeDropdown();try{this.$swal({title:"ğŸ§ª Testando EmailJS",text:"Enviando email de teste...",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const a={numero_edital:"TESTE-EMAIL",email_empresa:this.usuarioEmail,message:`\n            <h2>ğŸ§ª Email de Teste - Sistema Comprar Bem</h2>\n            <p>Este Ã© um email de teste enviado em ${(new Date).toLocaleString("pt-BR")}</p>\n            <p><strong>UsuÃ¡rio:</strong> ${this.usuarioNome}</p>\n            <p><strong>Email:</strong> ${this.usuarioEmail}</p>\n            <hr>\n            <p>Se vocÃª recebeu este email, o sistema de notificaÃ§Ãµes estÃ¡ funcionando corretamente!</p>\n            <p><em>Sistema Comprar Bem - NotificaÃ§Ãµes de TramitaÃ§Ã£o</em></p>\n          `,name:this.usuarioNome,email:"comprarbemteste@gmail.com",subject:"ğŸ§ª TESTE: Sistema de Email Funcionando - Comprar Bem",status_participante:"teste_sistema",motivo_rejeicao:""};await Ma.A.enviarEmailsReais([{destinatario:this.usuarioEmail,nome:this.usuarioNome,assunto:a.subject,conteudo:a.message}]),this.$swal({title:"âœ… Email Enviado!",html:`\n            <p>Email de teste enviado com sucesso para:</p>\n            <p><strong>${this.usuarioEmail}</strong></p>\n            <br>\n            <p>Verifique sua caixa de entrada (e spam/lixo eletrÃ´nico)</p>\n          `,icon:"success",confirmButtonText:"OK"})}catch(a){console.error("Erro ao testar email:",a),this.$swal({title:"âŒ Erro no Teste",text:"Falha ao enviar email de teste: "+a.message,icon:"error",confirmButtonText:"OK"})}}}},La=za;var Ba=(0,C.A)(La,q,k,!1,null,"72a3eb78",null);const qa=Ba.exports;var ka=function(){var a=this,o=a._self._c;return o("div",{staticClass:"cadastro-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("â–¼")])]),a.showDropdown?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.usuarioNome))]),o("small",[a._v(a._s(a.usuarioEmail))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("CadastroProduto")],1)])},Ua=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])}],ja=function(){var a=this,o=a._self._c;return o("div",{staticClass:"cadastro-produto"},[o("h2",[a._v("Cadastro de Produto")]),o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarProduto.apply(null,arguments)}}},[o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nome"}},[a._v("Nome do Produto*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.nome,expression:"produto.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.produto.nome},on:{input:function(o){o.target.composing||a.$set(a.produto,"nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.grupo_id,expression:"produto.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.produto,"grupo_id",o.target.multiple?t:t[0])},a.onGrupoChange]}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" ")])}))],2)])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"classe"}},[a._v("Classe*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.classe_id,expression:"produto.classe_id"}],attrs:{id:"classe",required:"",disabled:!a.produto.grupo_id||0===a.classes.length},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.produto,"classe_id",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.filteredClasses,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" ")])}))],2),a.produto.grupo_id&&0===a.filteredClasses.length?o("div",{staticClass:"info-text"},[a._v(" NÃ£o hÃ¡ classes disponÃ­veis para este grupo. Por favor, cadastre uma classe primeiro. ")]):a._e()]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"marca"}},[a._v("Marca*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.marca,expression:"produto.marca"}],attrs:{id:"marca",type:"text",required:""},domProps:{value:a.produto.marca},on:{input:function(o){o.target.composing||a.$set(a.produto,"marca",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"modelo"}},[a._v("Modelo*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.modelo,expression:"produto.modelo"}],attrs:{id:"modelo",type:"text",required:""},domProps:{value:a.produto.modelo},on:{input:function(o){o.target.composing||a.$set(a.produto,"modelo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"fabricante"}},[a._v("Fabricante*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.fabricante,expression:"produto.fabricante"}],attrs:{id:"fabricante",type:"text",required:""},domProps:{value:a.produto.fabricante},on:{input:function(o){o.target.composing||a.$set(a.produto,"fabricante",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"cnpj"}},[a._v("CNPJ do Requerente*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.cnpjFormatado,expression:"cnpjFormatado"}],class:{"input-error":a.cnpjInvalido,"input-success":a.cnpjValidado&&!a.cnpjInvalido},attrs:{id:"cnpj",type:"text",required:"",maxlength:"18",placeholder:"00.000.000/0000-00"},domProps:{value:a.cnpjFormatado},on:{input:[function(o){o.target.composing||(a.cnpjFormatado=o.target.value)},a.formatarCNPJ]}}),a.cnpjMensagem?o("div",{class:["mensagem",{"error-text":a.cnpjInvalido,"success-text":!a.cnpjInvalido}]},[a._v(" "+a._s(a.cnpjMensagem)+" ")]):a._e(),a.dadosEmpresa?o("div",{staticClass:"dados-empresa"},[o("p",[o("strong",[a._v("RazÃ£o Social:")]),a._v(" "+a._s(a.dadosEmpresa.razaoSocial))]),a.dadosEmpresa.nomeFantasia?o("p",[o("strong",[a._v("Nome Fantasia:")]),a._v(" "+a._s(a.dadosEmpresa.nomeFantasia))]):a._e(),o("p",[o("strong",[a._v("SituaÃ§Ã£o:")]),a._v(" "+a._s(a.dadosEmpresa.situacao))])]):a._e()]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"email_fornecedor"}},[a._v("E-mail do Requerente*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.email_fornecedor,expression:"produto.email_fornecedor"}],attrs:{id:"email_fornecedor",type:"email",required:"",placeholder:"contato@empresa.com"},domProps:{value:a.produto.email_fornecedor},on:{input:function(o){o.target.composing||a.$set(a.produto,"email_fornecedor",o.target.value)}}}),o("small",{staticClass:"info-text"},[a._v("Email para comunicaÃ§Ãµes sobre diligÃªncias")])])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"origem"}},[a._v("Origem")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.origem,expression:"produto.origem"}],attrs:{id:"origem",type:"text",placeholder:"Nacional ou Importado"},domProps:{value:a.produto.origem},on:{input:function(o){o.target.composing||a.$set(a.produto,"origem",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"registro_anvisa"}},[a._v("Registro na Anvisa/MS")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.registro_anvisa,expression:"produto.registro_anvisa"}],attrs:{id:"registro_anvisa",type:"text",placeholder:"NÃºmero do registro"},domProps:{value:a.produto.registro_anvisa},on:{input:function(o){o.target.composing||a.$set(a.produto,"registro_anvisa",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"registro_inmetro"}},[a._v("Registro/CertificaÃ§Ã£o INMETRO")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.registro_inmetro,expression:"produto.registro_inmetro"}],attrs:{id:"registro_inmetro",type:"text",placeholder:"NÃºmero do registro ou certificaÃ§Ã£o INMETRO"},domProps:{value:a.produto.registro_inmetro},on:{input:function(o){o.target.composing||a.$set(a.produto,"registro_inmetro",o.target.value)}}}),o("small",{staticClass:"info-text"},[a._v("Certificado de conformidade ou registro no INMETRO, quando aplicÃ¡vel")])]),o("div",{staticClass:"form-group"})]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"cbpf"}},[a._v("CBPF")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.cbpf,expression:"produto.cbpf"}],attrs:{id:"cbpf",type:"text",placeholder:"Certificado de Boas PrÃ¡ticas de FabricaÃ§Ã£o"},domProps:{value:a.produto.cbpf},on:{input:function(o){o.target.composing||a.$set(a.produto,"cbpf",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"codigo_material"}},[a._v("CÃ³digo do Material")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.codigo_material,expression:"produto.codigo_material"}],attrs:{id:"codigo_material",type:"text",placeholder:"CÃ³digo interno do material"},domProps:{value:a.produto.codigo_material},on:{input:function(o){o.target.composing||a.$set(a.produto,"codigo_material",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"norma_abnt"}},[a._v("Norma ABNT")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.norma_abnt,expression:"produto.norma_abnt"}],attrs:{id:"norma_abnt",type:"text",placeholder:"NÃºmero da norma ABNT"},domProps:{value:a.produto.norma_abnt},on:{input:function(o){o.target.composing||a.$set(a.produto,"norma_abnt",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"norma_regulamentadora"}},[a._v("Norma Regulamentadora")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.norma_regulamentadora,expression:"produto.norma_regulamentadora"}],attrs:{id:"norma_regulamentadora",type:"text",placeholder:"NÃºmero da norma regulamentadora"},domProps:{value:a.produto.norma_regulamentadora},on:{input:function(o){o.target.composing||a.$set(a.produto,"norma_regulamentadora",o.target.value)}}})])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"descricao"}},[a._v("EspecificaÃ§Ã£o Detalhada")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.produto.descricao,expression:"produto.descricao"}],attrs:{id:"descricao",rows:"4"},domProps:{value:a.produto.descricao},on:{input:function(o){o.target.composing||a.$set(a.produto,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("DocumentaÃ§Ã£o do Produto (apenas PDF)")]),o("div",{staticClass:"file-upload"},[o("input",{attrs:{type:"file",multiple:"",accept:".pdf"},on:{change:a.onFileSelect}})]),o("small",{staticClass:"info-text"},[a._v("Apenas arquivos PDF sÃ£o aceitos (mÃ¡x. 10MB por arquivo)")]),a.selectedFiles.length>0?o("div",{staticClass:"selected-files"},[o("p",[a._v("Arquivos selecionados:")]),o("ul",a._l(a.selectedFiles,(function(t,e){return o("li",{key:e,class:{"arquivo-invalido":!a.validarArquivoPDF(t)}},[a._v(" "+a._s(t.name)+" "),a.validarArquivoPDF(t)?a._e():o("span",{staticClass:"error-text"},[a._v("(Formato invÃ¡lido - apenas PDF permitido)")])])})),0)]):a._e(),a.arquivosInvalidos.length>0?o("div",{staticClass:"error-text"},[o("p",[a._v("Os seguintes arquivos nÃ£o serÃ£o enviados (apenas PDF permitido):")]),o("ul",a._l(a.arquivosInvalidos,(function(t,e){return o("li",{key:e},[a._v(" "+a._s(t.name)+" ")])})),0)]):a._e()]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},Va=[];const Ga="https://publica.cnpj.ws/cnpj";async function Ja(a){try{const o=a.replace(/[^\d]/g,"");if(14!==o.length)return{valido:!1,mensagem:"CNPJ deve ter 14 dÃ­gitos"};const t=await fetch(`${Ga}/${o}`);if(!t.ok){if(404===t.status)return{valido:!1,mensagem:"CNPJ nÃ£o encontrado na base de dados"};throw new Error("Erro ao consultar CNPJ")}const e=await t.json();return{valido:!0,mensagem:"CNPJ vÃ¡lido",dados:{razaoSocial:e.razao_social,nomeFantasia:e.estabelecimento?.nome_fantasia||"",situacao:e.estabelecimento?.situacao_cadastral||""}}}catch(o){return console.error("Erro ao validar CNPJ:",o),{valido:!1,mensagem:"Erro ao validar CNPJ. Tente novamente mais tarde."}}}var Ha=t(4963);const Qa={name:"CadastroProduto",data(){return{produto:{nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",email_fornecedor:"",origem:"",registro_anvisa:"",registro_inmetro:"",cbpf:"",codigo_material:"",norma_abnt:"",norma_regulamentadora:"",descricao:""},cnpjFormatado:"",cnpjInvalido:!1,cnpjMensagem:"",cnpjValidado:!1,dadosEmpresa:null,loading:!1,grupos:[],classes:[],selectedFiles:[],arquivosInvalidos:[],currentTenantId:null}},computed:{filteredClasses(){return this.produto.grupo_id?this.classes.filter((a=>a.grupo_id===this.produto.grupo_id)):[]}},async created(){this.carregarGrupos(),await this.obterTenantId()},methods:{async obterTenantId(){try{const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado");if(o?.user_metadata?.tenant_id)return console.log("Obteve tenant_id dos metadados:",o.user_metadata.tenant_id),void(this.currentTenantId=o.user_metadata.tenant_id);const{data:t,error:e}=await N.ND.from("usuarios").select("tenant_id").eq("email",o.email).single();if(console.log("Busca de tenant_id na tabela usuarios:",{userData:t,userError:e}),t&&t.tenant_id){console.log("Obteve tenant_id da tabela usuarios:",t.tenant_id),this.currentTenantId=t.tenant_id;const{error:a}=await N.ND.auth.updateUser({data:{tenant_id:t.tenant_id}});return void(a?console.error("Erro ao atualizar metadados do usuÃ¡rio:",a):console.log("Metadados do usuÃ¡rio atualizados com sucesso"))}const s=(0,Ha.A)();console.log("Gerando novo tenant_id:",s);const{error:i}=await N.ND.from("usuarios").insert({id:(0,Ha.A)(),email:o.email,tenant_id:s,ativo:!0});i&&console.error("Erro ao inserir novo tenant_id na tabela usuarios:",i);const{error:r}=await N.ND.auth.updateUser({data:{tenant_id:s}});r?console.error("Erro ao atualizar metadados do usuÃ¡rio:",r):console.log("Metadados do usuÃ¡rio atualizados com novo tenant_id"),this.currentTenantId=s}catch(a){console.error("Erro ao obter tenant_id:",a),alert("Erro ao obter identificaÃ§Ã£o do tenant. Por favor, faÃ§a login novamente."),this.$router.push("/")}},async carregarGrupos(){try{const{data:a,error:o}=await N.ND.from("grupos").select("*").order("nome");if(o)throw o;a&&a.length>0?this.grupos=a:this.grupos=[{id:1,nome:"Equipamentos MÃ©dicos"},{id:2,nome:"Equipamentos OdontolÃ³gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de EscritÃ³rio"},{id:5,nome:"Equipamentos de InformÃ¡tica"},{id:6,nome:"MobiliÃ¡rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de LaboratÃ³rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar grupos:",a),this.grupos=[{id:1,nome:"Equipamentos MÃ©dicos"},{id:2,nome:"Equipamentos OdontolÃ³gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de EscritÃ³rio"},{id:5,nome:"Equipamentos de InformÃ¡tica"},{id:6,nome:"MobiliÃ¡rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de LaboratÃ³rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},onGrupoChange(){this.carregarClasses()},async carregarClasses(){try{const{data:a,error:o}=await N.ND.from("classes").select("*").eq("grupo_id",this.produto.grupo_id).order("nome");if(o)throw o;a&&a.length>0?this.classes=a:this.classes=[{id:1,nome:"Equipamentos MÃ©dicos"},{id:2,nome:"Equipamentos OdontolÃ³gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de EscritÃ³rio"},{id:5,nome:"Equipamentos de InformÃ¡tica"},{id:6,nome:"MobiliÃ¡rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de LaboratÃ³rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar classes:",a),this.classes=[{id:1,nome:"Equipamentos MÃ©dicos"},{id:2,nome:"Equipamentos OdontolÃ³gicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de EscritÃ³rio"},{id:5,nome:"Equipamentos de InformÃ¡tica"},{id:6,nome:"MobiliÃ¡rio"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de LaboratÃ³rio"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},async formatarCNPJ(a){let o=a.target.value.replace(/\D/g,"");o.length<=14&&(o=o.replace(/^(\d{2})(\d)/,"$1.$2"),o=o.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),o=o.replace(/\.(\d{3})(\d)/,".$1/$2"),o=o.replace(/(\d{4})(\d)/,"$1-$2"),this.cnpjFormatado=o,this.produto.cnpj=o,this.cnpjValidado&&(this.cnpjValidado=!1,this.cnpjInvalido=!1,this.cnpjMensagem="",this.dadosEmpresa=null),14===o.replace(/\D/g,"").length&&await this.validarCNPJOnline())},async validarCNPJOnline(){try{const a=await Ja(this.cnpjFormatado);this.cnpjValidado=!0,this.cnpjInvalido=!a.valido,this.cnpjMensagem=a.mensagem,a.valido?this.dadosEmpresa=a.dados:this.dadosEmpresa=null}catch(a){console.error("Erro ao validar CNPJ:",a),this.cnpjInvalido=!0,this.cnpjMensagem="Erro ao validar CNPJ. Tente novamente mais tarde."}},onFileSelect(a){const o=Array.from(a.target.files);this.arquivosInvalidos=[],this.selectedFiles=o.filter((a=>{const o=this.validarArquivoPDF(a);return o||this.arquivosInvalidos.push(a),o}))},validarArquivoPDF(a){const o=a.name.split(".").pop().toLowerCase(),t=a.type.toLowerCase();return"pdf"===o&&"application/pdf"===t},sanitizarNomeArquivo(a){let o=a.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(o=o.replace(/[^a-zA-Z0-9_.]/g,"_"),o.length>100){const a=o.split(".").pop();o=o.substring(0,90)+"."+a}return o},async salvarProduto(){if(this.validarFormulario())try{if(this.loading=!0,this.currentTenantId||await this.obterTenantId(),console.log("Salvando produto com tenant_id:",this.currentTenantId),!this.cnpjValidado||this.cnpjInvalido)return this.$swal({icon:"error",title:"CNPJ InvÃ¡lido",text:"Por favor, informe um CNPJ vÃ¡lido no formato 00.000.000/0000-00"}),void(this.loading=!1);const a={nome:this.produto.nome,descricao:this.produto.descricao,grupo_id:this.produto.grupo_id,classe_id:this.produto.classe_id,marca:this.produto.marca,modelo:this.produto.modelo,fabricante:this.produto.fabricante,cnpj:this.produto.cnpj,email_fornecedor:this.produto.email_fornecedor,origem:this.produto.origem,registro_anvisa:this.produto.registro_anvisa,cbpf:this.produto.cbpf,norma_abnt:this.produto.norma_abnt,norma_regulamentadora:this.produto.norma_regulamentadora,codigo_material:this.produto.codigo_material,status:"pendente",tenant_id:this.currentTenantId};console.log("Objeto produto a ser inserido:",a);const{data:o,error:t}=await N.ND.from("produtos").insert(a).select().single();if(t)throw console.error("Erro detalhado ao salvar produto:",t),new Error(`Erro ao salvar produto: ${t.message}`);console.log("Produto inserido com sucesso:",o);const e=this.selectedFiles.filter((a=>this.validarArquivoPDF(a)));if(e.length>0){const a=o.id;for(const o of e){const t=o.name,e=this.sanitizarNomeArquivo(o.name),s=`${Date.now()}-${e}`;console.log(`Upload de arquivo: Original "${t}" -> Sanitizado "${e}"`);const{data:i,error:r}=await N.ND.storage.from("documentos").upload(s,o);if(r){console.error("Erro ao fazer upload do arquivo:",r);continue}const{data:n}=N.ND.storage.from("documentos").getPublicUrl(s),c=n?.publicUrl||"",l={tenant_id:this.currentTenantId,produto_id:a,nome:t,tipo:o.type,arquivo_url:c},{error:d}=await N.ND.from("documentos").insert(l);d&&console.error("Erro ao registrar documento:",d)}}this.arquivosInvalidos.length>0?this.$swal({icon:"warning",title:"Produto salvo com ressalvas",text:`O produto foi salvo, mas ${this.arquivosInvalidos.length} arquivo(s) nÃ£o foi(ram) enviado(s) por nÃ£o serem PDFs vÃ¡lidos.`}):this.$swal({icon:"success",title:"Produto salvo com sucesso!",text:"O produto foi cadastrado e estÃ¡ aguardando aprovaÃ§Ã£o."}),this.limparFormulario()}catch(a){console.error("Erro no processo de salvamento:",a),this.$swal({icon:"error",title:"Erro ao salvar produto",text:a.message||"Ocorreu um erro ao tentar salvar o produto."})}finally{this.loading=!1}},limparFormulario(){this.produto={nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",origem:"",registro_anvisa:"",cbpf:"",norma_abnt:"",norma_regulamentadora:"",codigo_material:"",descricao:"",status:"pendente"},this.cnpjFormatado="",this.cnpjInvalido=!1,this.selectedFiles=[],this.arquivosInvalidos=[]},validarFormulario(){return this.produto.nome&&""!==this.produto.nome.trim()?this.produto.grupo_id?this.produto.classe_id?this.produto.descricao&&""!==this.produto.descricao.trim()?!this.cnpjValidado||this.cnpjInvalido?(this.$swal({icon:"error",title:"Erro de validaÃ§Ã£o",text:"O CNPJ informado Ã© invÃ¡lido"}),!1):(this.arquivosInvalidos.length>0&&this.$swal({icon:"error",title:"Arquivos invÃ¡lidos",text:"Alguns arquivos selecionados nÃ£o sÃ£o PDFs vÃ¡lidos e nÃ£o serÃ£o enviados."}),!0):(this.$swal({icon:"error",title:"Erro de validaÃ§Ã£o",text:"A descriÃ§Ã£o do produto Ã© obrigatÃ³ria"}),!1):(this.$swal({icon:"error",title:"Erro de validaÃ§Ã£o",text:"Selecione uma classe para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de validaÃ§Ã£o",text:"Selecione um grupo para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de validaÃ§Ã£o",text:"O nome do produto Ã© obrigatÃ³rio"}),!1)},convertToUUID(a){if(!a)return null;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(o.test(a))return console.log("categoria_id jÃ¡ Ã© um UUID vÃ¡lido:",a),a;const t=parseInt(a,10);if(isNaN(t))return console.warn("categoria_id nÃ£o Ã© um nÃºmero nem UUID vÃ¡lido:",a),(0,Ha.A)();const e=`00000000-0000-0000-0000-${t.toString().padStart(12,"0")}`;return console.log(`Converteu categoria_id ${a} para UUID: ${e}`),e}}},Za=Qa;var Ya=(0,C.A)(Za,ja,Va,!1,null,"35984911",null);const Xa=Ya.exports,Ka={name:"Cadastro",components:{CadastroProduto:Xa},data(){return{showDropdown:!1,modalEmailAberto:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await N.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuÃ¡rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},Wa=Ka;var ao=(0,C.A)(Wa,ka,Ua,!1,null,"5e32585a",null);const oo=ao.exports;var to=function(){var a=this,o=a._self._c;return o("div",{staticClass:"analise-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("â–¼")])]),a.showDropdown?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.usuarioNome))]),o("small",[a._v(a._s(a.usuarioEmail))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("AnaliseProduto",{attrs:{id:a.produtoId}})],1)])},eo=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])}],so=function(){var a=this,o=a._self._c;return o("div",{staticClass:"analise-container"},[a.loading?o("div",{staticClass:"loading"},[o("p",[a._v("Carregando...")])]):a.produto?o("div",{staticClass:"produto-analise"},[o("h2",[a._v("AnÃ¡lise de Produto")]),o("div",{staticClass:"produto-info"},[o("div",{staticClass:"produto-header"},[o("h3",[a._v(a._s(a.produto.nome))]),o("div",{staticClass:"produto-actions"},["pendente"===a.produto.status?o("button",{staticClass:"btn-diligencia",on:{click:function(o){return a.solicitarDiligencia(a.produto.id)}}},[a._v(" ğŸ” Solicitar DiligÃªncia ")]):a._e(),"diligencia"===a.produto.status?o("button",{staticClass:"btn-ver-diligencias",on:{click:function(o){return a.visualizarDiligencias(a.produto.id)}}},[a._v(" ğŸ“‹ Ver DiligÃªncias ")]):a._e()])]),o("div",{staticClass:"info-grid"},[o("div",{staticClass:"info-item"},[o("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produto.marca)+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produto.modelo)+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produto.fabricante)+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produto.cnpj)+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Origem:")]),a._v(" "+a._s(a.produto.origem||"NÃ£o informada")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Registro na Anvisa/MS:")]),a._v(" "+a._s(a.produto.registro_anvisa||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("CBPF:")]),a._v(" "+a._s(a.produto.cbpf||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("CÃ³digo do Material:")]),a._v(" "+a._s(a.produto.codigo_material||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item full-width"},[o("strong",[a._v("DescriÃ§Ã£o:")]),a._v(" "+a._s(a.produto.descricao||"NÃ£o informada")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Status Atual:")]),o("span",{staticClass:"status-pill",class:a.getStatusClass(a.produto.status)},[a._v(" "+a._s(a.produto.status)+" ")])]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Data de Cadastro:")]),a._v(" "+a._s(a.formatDate(a.produto.criado_em))+" ")])])]),a.documentos.length>0?o("div",{staticClass:"documentos-section"},[o("h3",[a._v("Documentos")]),o("div",{staticClass:"documentos-list"},a._l(a.documentos,(function(t){return o("div",{key:t.id,staticClass:"documento-item"},[o("div",{staticClass:"doc-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"doc-info"},[o("p",{staticClass:"doc-name"},[a._v(a._s(t.nome))]),o("p",{staticClass:"doc-type"},[a._v(a._s(t.tipo))])]),o("a",{staticClass:"doc-action",attrs:{href:t.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),o("div",{staticClass:"analise-form"},[o("h3",[a._v("Parecer TÃ©cnico")]),a.produto?o("div",{staticClass:"edital-section"},[o("div",{staticClass:"edital-info"},[o("h4",[a._v("ğŸ“‹ Edital de PrÃ©-QualificaÃ§Ã£o")]),a.produto.edital_prequalificacao?o("div",{staticClass:"edital-vinculado"},[o("div",{staticClass:"edital-badge"},[o("span",{staticClass:"edital-icon"},[a._v("âœ…")]),o("span",{staticClass:"edital-text"},[a._v(a._s(a.produto.edital_prequalificacao))])]),o("button",{staticClass:"btn-edital-alterar",attrs:{type:"button"},on:{click:a.abrirModalVincularEdital}},[a._v(" ğŸ”„ Alterar Edital ")])]):o("div",{staticClass:"edital-nao-vinculado"},[a._m(0),o("button",{staticClass:"btn-edital-vincular",attrs:{type:"button"},on:{click:a.abrirModalVincularEdital}},[a._v(" ğŸ”— Vincular Edital ")])])])]):a._e(),o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarAnalise.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"parecer"}},[a._v("ObservaÃ§Ãµes / Parecer")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.parecer,expression:"analise.parecer"}],attrs:{id:"parecer",rows:"4",required:""},domProps:{value:a.analise.parecer},on:{input:function(o){o.target.composing||a.$set(a.analise,"parecer",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("DecisÃ£o")]),o("div",{staticClass:"radio-group"},[o("label",{staticClass:"radio-label"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"aprovado",required:""},domProps:{checked:a._q(a.analise.status,"aprovado")},on:{change:function(o){return a.$set(a.analise,"status","aprovado")}}}),a._v(" Aprovar ")]),o("label",{staticClass:"radio-label"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"reprovado",required:""},domProps:{checked:a._q(a.analise.status,"reprovado")},on:{change:function(o){return a.$set(a.analise,"status","reprovado")}}}),a._v(" Reprovar ")])])]),"reprovado"===a.analise.status?o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"motivacao"}},[a._v("MotivaÃ§Ã£o da ReprovaÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.motivacao,expression:"analise.motivacao"}],attrs:{id:"motivacao",rows:"6",placeholder:"Descreva detalhadamente os motivos que levaram Ã  reprovaÃ§Ã£o deste produto",required:""},domProps:{value:a.analise.motivacao},on:{input:function(o){o.target.composing||a.$set(a.analise,"motivacao",o.target.value)}}}),o("small",{staticClass:"helper-text"},[a._v("Este campo serÃ¡ exibido ao fornecedor para justificar a reprovaÃ§Ã£o do produto")])]):a._e(),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.submitting}},[a._v(" "+a._s(a.submitting?"Salvando...":"Salvar AnÃ¡lise")+" ")]),o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.voltar}},[a._v(" Voltar ")])])])]),a.analisesAnteriores.length>0?o("div",{staticClass:"analises-anteriores"},[o("h3",[a._v("AnÃ¡lises Anteriores")]),a._l(a.analisesAnteriores,(function(t){return o("div",{key:t.id,staticClass:"analise-historico"},[o("div",{staticClass:"analise-header"},[o("span",{staticClass:"status-pill",class:a.getStatusClass(t.status)},[a._v(a._s(t.status))]),o("span",{staticClass:"analise-data"},[a._v(a._s(a.formatDate(t.criado_em)))])]),o("div",{staticClass:"analise-conteudo"},[a.produto.edital_prequalificacao?o("div",{staticClass:"edital-referencia"},[o("strong",[a._v(a._s(a.produto.edital_prequalificacao))])]):a._e(),o("p",[a._v(a._s(t.parecer))]),"reprovado"===t.status&&t.motivacao?o("div",{staticClass:"motivacao-reprovacao"},[o("h4",[a._v("MotivaÃ§Ã£o da ReprovaÃ§Ã£o:")]),o("p",[a._v(a._s(t.motivacao))])]):a._e()])])}))],2):a._e()]):o("div",{staticClass:"not-found"},[o("p",[a._v("Produto nÃ£o encontrado ou vocÃª nÃ£o tem permissÃ£o para visualizÃ¡-lo.")]),o("button",{staticClass:"btn-secondary",on:{click:a.voltar}},[a._v("Voltar")])]),a.modalVincularEdital?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVincularEdital}},[o("div",{staticClass:"modal-content vincular-edital-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ”— Vincular Edital de PrÃ©-QualificaÃ§Ã£o")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalVincularEdital}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"produto-info-display"},[o("h4",[a._v("ğŸ“¦ Produto:")]),o("p",[o("strong",[a._v(a._s(a.produto?.nome))]),a._v(" - "+a._s(a.produto?.marca)+" "+a._s(a.produto?.modelo))])]),o("form",{on:{submit:function(o){return o.preventDefault(),a.vincularEdital.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"editalSelect"}},[a._v("ğŸ“‹ Selecionar Edital Existente *")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.editalSelecionado,expression:"editalSelecionado"}],attrs:{id:"editalSelect",required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.editalSelecionado=o.target.multiple?t:t[0]}}},[o("option",{attrs:{value:""}},[a._v("Selecione um edital...")]),a._l(a.editaisDisponiveis,(function(t){return o("option",{key:t.id,domProps:{value:t}},[a._v(" Edital nÂº "+a._s(t.numero)+" - "+a._s(t.objeto)+" ")])}))],2)]),a.editalSelecionado?o("div",{staticClass:"edital-preview"},[o("h5",[a._v("ğŸ‘ï¸ PrÃ©-visualizaÃ§Ã£o:")]),o("div",{staticClass:"preview-content"},[o("p",[o("strong",[a._v("NÃºmero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),o("p",[o("strong",[a._v("Objeto:")]),a._v(" "+a._s(a.editalSelecionado.objeto))]),o("p",[o("strong",[a._v("Data de PublicaÃ§Ã£o:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_publicacao)))]),o("div",{staticClass:"preview-resultado"},[o("strong",[a._v("Resultado da vinculaÃ§Ã£o:")]),o("span",{staticClass:"edital-resultado"},[a._v("Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº "+a._s(a.editalSelecionado.numero))])])])]):a._e()])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalVincularEdital}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!a.editalSelecionado||a.salvandoVinculacao},on:{click:a.vincularEdital}},[a.salvandoVinculacao?o("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoVinculacao?"Vinculando...":"Vincular Edital")+" ")])])])]):a._e()])},io=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"edital-alerta"},[o("span",{staticClass:"alerta-icon"},[a._v("âš ï¸")]),o("span",[a._v("Nenhum edital vinculado a este produto")])])}],ro=t(3405);const no={name:"AnaliseProduto",props:{id:{type:String,required:!0}},data(){return{produto:null,documentos:[],analisesAnteriores:[],analise:{parecer:"",status:"",motivacao:""},modalVincularEdital:!1,editaisDisponiveis:[],editalSelecionado:null,salvandoVinculacao:!1,loading:!0,submitting:!1}},created(){this.carregarDados()},methods:{async carregarDados(){try{this.loading=!0;const{data:a,error:o}=await N.ND.from("produtos").select("*").eq("id",this.id).single();if(o)throw o;this.produto=a;const{data:t,error:e}=await N.ND.from("documentos").select("*").eq("produto_id",this.id);if(e)throw e;this.documentos=t||[];const{data:s,error:i}=await N.ND.from("analises").select("*").eq("produto_id",this.id).order("criado_em",{ascending:!1});if(i)throw i;this.analisesAnteriores=s||[]}catch(a){console.error("Erro ao carregar dados:",a),alert("Erro ao carregar dados do produto. Por favor, tente novamente.")}finally{this.loading=!1}},async salvarAnalise(){try{if(this.submitting=!0,"reprovado"===this.analise.status&&!this.analise.motivacao)return this.$swal({icon:"error",title:"Campo obrigatÃ³rio",text:"Ã‰ necessÃ¡rio preencher a motivaÃ§Ã£o da reprovaÃ§Ã£o"}),void(this.submitting=!1);const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;let t;if(o){console.log("UsuÃ¡rio autenticado:",o.email);const{data:a,error:e}=await N.ND.from("usuarios").select("id").eq("email",o.email).maybeSingle();if(e&&console.error("Erro ao buscar ID do usuÃ¡rio:",e),a?.id)console.log("ID do usuÃ¡rio encontrado na tabela usuarios:",a.id),t=a.id;else{console.warn("UsuÃ¡rio nÃ£o encontrado na tabela, gerando UUID"),t=this.gerarUUID();const{error:a}=await N.ND.from("usuarios").insert({id:t,email:o.email,nome:o.email.split("@")[0],tenant_id:this.produto.tenant_id,tipo:"avaliador",ativo:!0});a&&console.error("Erro ao criar usuÃ¡rio automaticamente:",a)}}else console.warn("Nenhum usuÃ¡rio autenticado, gerando UUID"),t=this.gerarUUID();console.log("Salvando anÃ¡lise com avaliador_id:",t);const e={produto_id:this.id,tenant_id:this.produto.tenant_id,avaliador_id:t,parecer:this.analise.parecer,status:this.analise.status};"reprovado"===this.analise.status&&(e.motivacao=this.analise.motivacao);const{error:s}=await N.ND.from("analises").insert(e);if(s)throw console.error("Erro detalhado ao salvar anÃ¡lise:",s),new Error(`Erro ao salvar anÃ¡lise: ${s.message}`);const{error:i}=await N.ND.from("produtos").update({status:this.analise.status}).eq("id",this.id);if(i)throw i;this.$swal({icon:"success",title:"AnÃ¡lise salva com sucesso!",showConfirmButton:!1,timer:1500}),await this.carregarDados(),this.analise={parecer:"",status:"",motivacao:""}}catch(a){console.error("Erro ao salvar anÃ¡lise:",a);let o="Erro ao salvar anÃ¡lise.";a.message&&a.message.includes("uuid")?o="Erro no formato de identificaÃ§Ã£o. Este problema foi corrigido, tente novamente.":a.message&&(o=a.message),this.$swal({icon:"error",title:"Erro ao processar anÃ¡lise",text:o})}finally{this.submitting=!1}},formatDate(a){if(!a)return"";const o=new Date(a);return o.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";default:return""}},voltar(){this.$router.push("/dashboard")},gerarUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const o=16*Math.random()|0,t="x"==a?o:3&o|8;return t.toString(16)}))},async abrirModalVincularEdital(){this.modalVincularEdital=!0,await this.carregarEditaisDisponiveis()},fecharModalVincularEdital(){this.modalVincularEdital=!1,this.editalSelecionado=null,this.editaisDisponiveis=[]},async carregarEditaisDisponiveis(){try{console.log("Carregando editais para tenant:",this.produto.tenant_id);const{data:a,error:o}=await N.ND.from("editais").select("*").eq("tenant_id",this.produto.tenant_id).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(o)throw console.error("Erro detalhado ao carregar editais:",o),o;console.log("Editais encontrados:",a),this.editaisDisponiveis=a||[],0===this.editaisDisponiveis.length&&this.$swal({icon:"info",title:"Nenhum edital encontrado",text:'NÃ£o hÃ¡ editais publicados disponÃ­veis para vinculaÃ§Ã£o. Verifique se existem editais com status "PUBLICADO" para este Ã³rgÃ£o.'})}catch(a){console.error("Erro ao carregar editais disponÃ­veis:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel carregar os editais disponÃ­veis. Tente novamente."}),this.editaisDisponiveis=[]}},async vincularEdital(){if(this.editalSelecionado){this.salvandoVinculacao=!0;try{const a=`Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº ${this.editalSelecionado.numero}`,{error:o}=await N.ND.from("produtos").update({edital_prequalificacao:a,edital_id:this.editalSelecionado.id,updated_at:(new Date).toISOString()}).eq("id",this.produto.id).eq("tenant_id",this.produto.tenant_id);if(o)throw o;this.produto.edital_prequalificacao=a,this.produto.edital_id=this.editalSelecionado.id,this.$swal({icon:"success",title:"Sucesso!",text:"Edital vinculado com sucesso!",timer:2e3,showConfirmButton:!1}),this.fecharModalVincularEdital()}catch(a){console.error("Erro ao vincular edital:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel vincular o edital. Tente novamente."})}finally{this.salvandoVinculacao=!1}}},async solicitarDiligencia(a){try{const{value:o}=await this.$swal({title:"ğŸ” Solicitar DiligÃªncia",html:'\n            <div style="text-align: left; padding: 10px;">\n              <div style="margin-bottom: 20px;">\n                <label for="tipo_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  ğŸ“‹ Tipo de DiligÃªncia:\n                </label>\n                <select id="tipo_diligencia" class="swal2-input" style="width: 100%; font-size: 14px;">\n                  <option value="">Selecione o tipo</option>\n                  <option value="DOCUMENTACAO_FALTANTE">ğŸ“„ DocumentaÃ§Ã£o Faltante</option>\n                  <option value="AMOSTRA_INADEQUADA">ğŸ”¬ Amostra Inadequada</option>\n                  <option value="ESPECIFICACAO_INCOMPLETA">ğŸ“ EspecificaÃ§Ã£o Incompleta</option>\n                  <option value="CERTIFICACAO_PENDENTE">âœ… CertificaÃ§Ã£o Pendente</option>\n                  <option value="ESCLARECIMENTO_TECNICO">ğŸ”§ Esclarecimento TÃ©cnico</option>\n                  <option value="OUTRO">âœï¸ Outro (especificar)</option>\n                </select>\n                <div id="tipo_outro_container" style="display: none; margin-top: 10px;">\n                  <input \n                    type="text" \n                    id="tipo_outro_texto" \n                    class="swal2-input" \n                    placeholder="Digite o tipo de diligÃªncia..."\n                    style="width: 100%; font-size: 14px;"\n                  >\n                </div>\n              </div>\n              \n              <div style="margin-bottom: 20px;">\n                <label for="descricao_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  âœï¸ DescriÃ§Ã£o Detalhada:\n                </label>\n                <textarea \n                  id="descricao_diligencia" \n                  class="swal2-textarea" \n                  placeholder="Descreva detalhadamente o que precisa ser providenciado pelo fornecedor..."\n                  style="width: 100%; min-height: 120px; font-size: 14px; line-height: 1.5;"\n                ></textarea>\n              </div>\n              \n              <div style="margin-bottom: 20px; padding: 15px; background: #e8f4fd; border-left: 4px solid #3498db; border-radius: 4px;">\n                <div style="display: flex; align-items: center; margin-bottom: 8px;">\n                  <span style="font-size: 18px; margin-right: 8px;">â°</span>\n                  <strong style="color: #2c3e50;">Prazo para Resposta:</strong>\n                </div>\n                <p style="margin: 0; color: #34495e; font-size: 14px;">\n                  <strong>30 dias Ãºteis</strong> (padrÃ£o do sistema)\n                </p>\n                <small style="color: #6c757d; font-size: 12px; margin-top: 5px; display: block;">\n                  ğŸ“… A data limite serÃ¡ calculada automaticamente excluindo fins de semana\n                </small>\n              </div>\n            </div>\n          ',width:"600px",focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ“¤ Enviar DiligÃªncia",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#f39c12",cancelButtonColor:"#6c757d",didOpen:()=>{const a=document.getElementById("tipo_diligencia"),o=document.getElementById("tipo_outro_container");a.addEventListener("change",(function(){"OUTRO"===this.value?(o.style.display="block",setTimeout((()=>{document.getElementById("tipo_outro_texto").focus()}),100)):o.style.display="none"}))},preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,o=document.getElementById("tipo_outro_texto").value,t=document.getElementById("descricao_diligencia").value,e=30;let s=a;if("OUTRO"===a){if(!o||o.trim().length<3)return this.$swal.showValidationMessage("âš ï¸ Por favor, especifique o tipo de diligÃªncia (mÃ­nimo 3 caracteres)"),!1;s=o.trim()}return a?!t||t.trim().length<20?(this.$swal.showValidationMessage("âš ï¸ A descriÃ§Ã£o deve ter pelo menos 20 caracteres"),!1):{tipo:s,descricao:t,prazo:e}:(this.$swal.showValidationMessage("âš ï¸ Por favor, selecione o tipo de diligÃªncia"),!1)}});o&&await this.salvarDiligencia(a,o)}catch(o){console.error("Erro ao solicitar diligÃªncia:",o)}},async salvarDiligencia(a,o){try{if(!this.produto.email_fornecedor)return void this.$swal({title:"âš ï¸ Email do Fornecedor NecessÃ¡rio",text:"Para enviar a diligÃªncia, Ã© necessÃ¡rio que o produto tenha o email do fornecedor cadastrado. Deseja continuar sem enviar email?",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar sem Email",cancelButtonText:"Cancelar",confirmButtonColor:"#f39c12"}).then((async t=>{t.isConfirmed&&await this.processarDiligencia(a,o,!1)}));await this.processarDiligencia(a,o,!0)}catch(t){console.error("Erro ao salvar diligÃªncia:",t),this.$swal({title:"âŒ Erro",text:"Erro ao solicitar diligÃªncia",icon:"error"})}},async processarDiligencia(a,o,t=!0){try{const s=this.calcularDataUtil(new Date,o.prazo),{data:i,error:r}=await N.ND.from("diligencias").insert({produto_id:a,tenant_id:this.produto.tenant_id,tipo:o.tipo,descricao:o.descricao,prazo_dias:o.prazo,data_limite:s.toISOString(),status:"PENDENTE",solicitado_por:"CPM"}).select().single();if(r)throw r;const{error:n}=await N.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(n)throw n;let c=!1;if(t&&this.produto.email_fornecedor)try{const a=await(0,ro.lY)({destinatario:this.produto.email_fornecedor,produto:this.produto,diligencia:{...i,data_limite:s}});c=a.success,a.success||console.error("Erro no envio do email:",a.message)}catch(e){console.error("Erro ao enviar email:",e)}const l=t&&c?" O fornecedor foi notificado por email.":t&&!c?" âš ï¸ A diligÃªncia foi salva, mas houve erro no envio do email.":" (Sem notificaÃ§Ã£o por email)";this.$swal({title:"âœ… Sucesso!",text:`DiligÃªncia solicitada com sucesso.${l}`,icon:c||!t?"success":"warning",confirmButtonColor:"#28a745"}),await this.carregarDados()}catch(s){console.error("Erro ao processar diligÃªncia:",s),this.$swal({title:"âŒ Erro",text:"Erro ao processar diligÃªncia",icon:"error"})}},async visualizarDiligencias(a){try{const{data:o,error:t}=await N.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(t)throw t;let e='<div style="text-align: left; padding: 10px;">';o&&o.length>0?(e+='<h4 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“‹ HistÃ³rico de DiligÃªncias:</h4>',o.forEach(((a,o)=>{const t="PENDENTE"===a.status?"#f39c12":"ATENDIDA"===a.status?"#28a745":"#dc3545",s="PENDENTE"===a.status?"â³":"ATENDIDA"===a.status?"âœ…":"âŒ";e+=`\n              <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin: 15px 0; background: ${"PENDENTE"===a.status?"#fff3cd":"ATENDIDA"===a.status?"#d4edda":"#f8d7da"};">\n                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                  <strong style="color: #2c3e50;">DiligÃªncia #${o+1}</strong>\n                  <span style="color: ${t}; font-weight: bold;">\n                    ${s} ${a.status}\n                  </span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">Tipo:</strong> \n                  <span style="color: #6c757d;">${a.tipo.replace(/_/g," ")}</span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">DescriÃ§Ã£o:</strong>\n                  <div style="background: white; padding: 10px; border-radius: 4px; margin-top: 5px; border-left: 4px solid ${t};">\n                    ${a.descricao}\n                  </div>\n                </div>\n                \n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; font-size: 12px; color: #6c757d;">\n                  <div>ğŸ“… <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}</div>\n                  <div>ğŸ• <strong>Solicitado:</strong> ${this.formatDate(a.criado_em)}</div>\n                </div>\n              </div>\n            `}))):e+='\n            <div style="text-align: center; padding: 40px; color: #6c757d;">\n              <div style="font-size: 48px; margin-bottom: 15px;">ğŸ“­</div>\n              <p>Nenhuma diligÃªncia encontrada para este produto.</p>\n            </div>\n          ',e+="</div>",this.$swal({title:"ğŸ“‹ DiligÃªncias do Produto",html:e,width:"700px",confirmButtonColor:"#007bff"})}catch(o){console.error("Erro ao carregar diligÃªncias:",o),this.$swal({title:"âŒ Erro",text:"Erro ao carregar diligÃªncias do produto",icon:"error"})}},calcularDataUtil(a,o){const t=new Date(a);let e=0;while(e<o)t.setDate(t.getDate()+1),0!==t.getDay()&&6!==t.getDay()&&e++;return t}}},co=no;var lo=(0,C.A)(co,so,io,!1,null,"594feca8",null);const uo=lo.exports,mo={name:"Analise",components:{AnaliseProduto:uo},data(){return{showDropdown:!1,usuarioNome:"UsuÃ¡rio",usuarioEmail:""}},computed:{produtoId(){return this.$route.params.id}},async created(){await this.carregarDadosUsuario()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await N.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuÃ¡rio:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.$swal({title:"âš™ï¸ ConfiguraÃ§Ãµes",text:"Configure o email no Dashboard principal para salvar as configuraÃ§Ãµes globais.",icon:"info"})},abrirConfiguracoesEmail(){this.closeDropdown(),this.$swal({title:"ğŸ“§ Configurar Email",text:"Acesse o Dashboard principal para configurar o email do sistema.",icon:"info"})},async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},po=mo;var vo=(0,C.A)(po,to,eo,!1,null,"7083c854",null);const go=vo.exports;var _o=function(){var a=this,o=a._self._c;return o("div",{staticClass:"catalogo-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("â–¼")])]),a.dropdownOpen?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.nomeUsuario))]),o("small",[a._v(a._s(a.emailUsuario))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("CatalogoEletronico")],1),a.modalEmailAberto?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[o("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[a._m(2),o("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da OrganizaÃ§Ã£o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeOrganizacao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"emailRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;ComissÃ£o de PadronizaÃ§Ã£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"assinatura",o.target.value)}}})])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),o("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[o("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},ho=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])},function(){var a=this,o=a._self._c;return o("h3",[o("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da OrganizaÃ§Ã£o")])}],fo=function(){var a=this,o=a._self._c;return o("div",{staticClass:"catalogo-container"},[o("div",{staticClass:"catalogo-header"},[o("h2",[a._v("CatÃ¡logo EletrÃ´nico de Bens Padronizados")]),o("div",{staticClass:"export-buttons"},[o("button",{staticClass:"btn-exportar btn-resumido",attrs:{disabled:a.exportandoPDF},on:{click:a.exportarCatalogoPDF}},[a.exportandoPDF&&"resumido"===a.tipoExportacao?o("span",{staticClass:"spinner-small"}):a._e(),a._v(" "+a._s(a.exportandoPDF&&"resumido"===a.tipoExportacao?"Gerando...":"ğŸ“„ CatÃ¡logo Legal")+" ")]),o("button",{staticClass:"btn-exportar btn-detalhado",attrs:{disabled:a.exportandoPDF},on:{click:a.exportarCatalogoDetalhado}},[a.exportandoPDF&&"detalhado"===a.tipoExportacao?o("span",{staticClass:"spinner-small"}):a._e(),a._v(" "+a._s(a.exportandoPDF&&"detalhado"===a.tipoExportacao?"Gerando...":"ğŸ“‹ CatÃ¡logo Completo")+" ")])])]),o("div",{staticClass:"search-filters"},[o("div",{staticClass:"search-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.searchTerm,expression:"searchTerm"}],attrs:{type:"text",placeholder:"Buscar produto..."},domProps:{value:a.searchTerm},on:{input:[function(o){o.target.composing||(a.searchTerm=o.target.value)},a.filtrarProdutos]}})]),o("div",{staticClass:"filters"},[o("div",{staticClass:"categoria-filter"},[a._m(0),o("div",{staticClass:"dropdown"},[o("button",{staticClass:"dropdown-toggle",attrs:{type:"button"},on:{click:a.toggleCategoriaDropdown}},[a._v(" "+a._s(a.categoriaAtual)+" ")]),o("div",{staticClass:"dropdown-menu",class:{show:a.showCategoriaDropdown}},[a.carregandoCategorias?o("div",{staticClass:"dropdown-item loading"},[o("div",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status"}}),o("span",[a._v("Carregando...")])]):[o("a",{staticClass:"dropdown-item",on:{click:function(o){return a.selecionarCategoria(null)}}},[a._v("Todos os grupos")]),0===a.categorias.length?o("div",{staticClass:"dropdown-item empty"},[a._v(" Nenhum grupo disponÃ­vel ")]):a._l(a.categorias,(function(t){return o("a",{key:t.id,staticClass:"dropdown-item",class:{active:t.id===a.filtroCategoria},on:{click:function(o){return a.selecionarCategoria(t)}}},[a._v(" "+a._s(t.nome)+" ")])}))]],2)])])])]),a.produtosFiltradosOrdenados.length>0?o("div",{staticClass:"produtos-grid"},a._l(a.produtosFiltradosOrdenados,(function(t){return o("div",{key:t.id,staticClass:"produto-card",on:{click:function(o){return a.verDetalhesProduto(t.id)}}},[o("div",{staticClass:"produto-info"},[o("h3",[a._v(a._s(t.nome))]),o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(t.marca))]),o("div",{staticClass:"status-marca"},[o("span",{staticClass:"status-badge",class:a.getStatusMarcaClass(t)},[a._v(a._s(a.getStatusMarca(t)))])]),o("p",[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(t.modelo))]),o("p",[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(t.fabricante))])])])})),0):o("div",{staticClass:"empty-state"},[o("p",[a._v("Nenhum produto encontrado.")])]),a.produtoSelecionado?o("div",{staticClass:"produto-modal",on:{click:function(o){return o.target!==o.currentTarget?null:a.fecharModal.apply(null,arguments)}}},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.produtoSelecionado.nome))]),o("button",{staticClass:"btn-close",on:{click:a.fecharModal}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"produto-detalhes"},[o("p",[o("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),o("p",[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo))]),o("p",[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),o("p",[o("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj))]),o("p",[o("strong",[a._v("CÃ³digo Material:")]),a._v(" "+a._s(a.produtoSelecionado.codigo_material))]),a.produtoSelecionado.descricao?o("p",[o("strong",[a._v("DescriÃ§Ã£o:")]),a._v(" "+a._s(a.produtoSelecionado.descricao))]):a._e(),o("div",{staticClass:"avaliacoes-section"},[o("div",{staticClass:"avaliacoes-header",class:{active:a.showAvaliacoes},on:{click:a.toggleAvaliacoes}},[o("h4",[a._v("AvaliaÃ§Ãµes de Desempenho (RDM)")]),o("div",{staticClass:"avaliacao-summary"},[a.avaliacaoMedia>0?o("div",{staticClass:"stars-container"},[o("div",{staticClass:"stars"},a._l(5,(function(t){return o("span",{key:t,staticClass:"star",class:{filled:a.avaliacaoMedia>=t,half:a.avaliacaoMedia>=t-.5&&a.avaliacaoMedia<t}},[a._v("â˜…")])})),0),o("span",{staticClass:"rating-number"},[a._v(a._s(a.avaliacaoMedia))]),o("span",{staticClass:"rating-count"},[a._v("("+a._s(a.avaliacoes.length)+" avaliaÃ§Ãµes)")])]):o("div",{staticClass:"no-ratings"},[a._v(" Sem avaliaÃ§Ãµes ainda ")]),o("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showAvaliacoes?"â–²":"â–¼"))])])]),a.showAvaliacoes?o("div",{staticClass:"avaliacoes-content"},[0===a.avaliacoes.length?o("div",{staticClass:"no-avaliacoes"},[a._v(" Este produto ainda nÃ£o possui avaliaÃ§Ãµes de desempenho. ")]):o("div",{staticClass:"avaliacoes-list"},a._l(a.avaliacoes,(function(t,e){return o("div",{key:e,staticClass:"avaliacao-item"},[o("div",{staticClass:"avaliacao-header"},[o("span",{staticClass:"avaliacao-tipo",class:t.tipo.toLowerCase()},[a._v(" "+a._s(t.tipo)+" ")]),o("div",{staticClass:"avaliacao-stars"},a._l(5,(function(e){return o("span",{key:e,staticClass:"star",class:{filled:t.avaliacao>=e}},[a._v("â˜…")])})),0)]),t.comentario?o("div",{staticClass:"avaliacao-comentario"},[a._v(" "+a._s(t.comentario)+" ")]):a._e(),o("div",{staticClass:"avaliacao-footer"},[o("span",{staticClass:"avaliador"},[a._v(a._s(t.avaliador))]),o("span",{staticClass:"avaliacao-data"},[a._v(a._s(a.formatarData(t.data)))])])])})),0)]):a._e()]),o("div",{staticClass:"tabs-container mt-4"},[o("div",{staticClass:"tabs-header"},[o("button",{staticClass:"tab-button",class:{active:"avaliacoes"===a.activeTab},on:{click:function(o){return a.setActiveTab("avaliacoes")}}},[o("span",[a._v("AvaliaÃ§Ãµes de UsuÃ¡rios")]),o("div",{staticClass:"tab-info"},[a.avaliacoes.length>0?o("span",{staticClass:"tab-badge"},[a._v(a._s(a.avaliacoes.length))]):a._e(),o("span",{staticClass:"toggle-icon"},[a._v(a._s("avaliacoes"===a.activeTab&&a.showAvaliacoesContent?"â–²":"â–¼"))])])]),o("button",{staticClass:"tab-button",class:{active:"reclamacoes"===a.activeTab},on:{click:function(o){return a.setActiveTab("reclamacoes")}}},[o("span",[a._v("ReclamaÃ§Ãµes de UsuÃ¡rios")]),o("div",{staticClass:"tab-info"},[a.reclamacoes.length>0?o("span",{staticClass:"tab-badge"},[a._v(a._s(a.reclamacoes.length))]):a._e(),o("span",{staticClass:"toggle-icon"},[a._v(a._s("reclamacoes"===a.activeTab&&a.showReclamacoesContent?"â–²":"â–¼"))])])])]),o("div",{staticClass:"tabs-content"},["avaliacoes"===a.activeTab?o("div",{staticClass:"tab-panel"},[o("div",{staticClass:"tab-header-toggle",on:{click:a.toggleAvaliacoesContent}},[o("h5",[a._v("Lista de AvaliaÃ§Ãµes")]),o("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showAvaliacoesContent?"â–²":"â–¼"))])]),a.showAvaliacoesContent?o("div",{staticClass:"tab-content-collapsible"},[0===a.avaliacoes.length?o("div",{staticClass:"no-avaliacoes"},[a._v(" Este produto ainda nÃ£o possui avaliaÃ§Ãµes de desempenho. ")]):o("div",{staticClass:"avaliacoes-list"},a._l(a.avaliacoes,(function(t,e){return o("div",{key:e,staticClass:"avaliacao-item"},[o("div",{staticClass:"avaliacao-header"},[o("span",{staticClass:"avaliacao-tipo",class:t.tipo.toLowerCase()},[a._v(" "+a._s(t.tipo)+" ")]),o("div",{staticClass:"avaliacao-stars"},a._l(5,(function(e){return o("span",{key:e,staticClass:"star",class:{filled:t.avaliacao>=e}},[a._v("â˜…")])})),0)]),t.comentario?o("div",{staticClass:"avaliacao-comentario"},[a._v(" "+a._s(t.comentario)+" ")]):a._e(),o("div",{staticClass:"avaliacao-footer"},[o("span",{staticClass:"avaliador"},[a._v(a._s(t.avaliador))]),o("span",{staticClass:"avaliacao-data"},[a._v(a._s(a.formatarData(t.data)))])]),t.ciencia_cpm||t.manifestacao_cpm?o("div",{staticClass:"cpm-response"},[a._m(1,!0),t.ciencia_cpm?o("div",{staticClass:"cpm-ciencia"},[o("strong",[a._v("CiÃªncia:")]),a._v(" "+a._s(a.formatarData(t.ciencia_cpm))+" ")]):a._e(),t.manifestacao_cpm?o("div",{staticClass:"cpm-manifestacao"},[o("strong",[a._v("ManifestaÃ§Ã£o:")]),a._v(" "+a._s(t.manifestacao_cpm)+" ")]):a._e()]):a._e()])})),0)]):a._e()]):a._e(),"reclamacoes"===a.activeTab?o("div",{staticClass:"tab-panel"},[o("div",{staticClass:"tab-header-toggle",on:{click:a.toggleReclamacoesContent}},[o("h5",[a._v("Lista de ReclamaÃ§Ãµes")]),o("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showReclamacoesContent?"â–²":"â–¼"))])]),a.showReclamacoesContent?o("div",{staticClass:"tab-content-collapsible"},[0===a.reclamacoes.length?o("div",{staticClass:"text-center text-muted py-3"},[a._v(" Nenhuma reclamaÃ§Ã£o registrada ")]):o("div",{staticClass:"reclamacoes-list"},a._l(a.reclamacoesSorted,(function(t){return o("div",{key:t.id,staticClass:"reclamacao-item"},[o("div",{staticClass:"reclamacao-header"},[o("div",{staticClass:"d-flex align-items-center"},[o("span",{staticClass:"badge",class:a.getStatusBadgeClass(t.status)},[a._v(a._s(t.status))]),o("span",{staticClass:"reclamante-nome"},[a._v(a._s(t.nome_reclamante))]),o("span",{staticClass:"reclamante-setor"},[a._v(a._s(t.unidade_setor))])]),o("span",{staticClass:"reclamacao-data"},[a._v(a._s(a.formatDate(t.data_reclamacao)))])]),o("div",{staticClass:"reclamacao-content"},[o("div",{staticClass:"problema-box"},[o("h6",{staticClass:"box-title"},[a._v("Problema Reportado:")]),o("p",{staticClass:"box-text"},[a._v(a._s(t.registro_reclamacao))])]),t.sugestoes?o("div",{staticClass:"sugestao-box"},[o("h6",{staticClass:"box-title"},[a._v("SugestÃµes de Melhoria:")]),o("p",{staticClass:"box-text"},[a._v(a._s(t.sugestoes))])]):a._e(),t.providencias_cpm?o("div",{staticClass:"providencias-box"},[o("h6",{staticClass:"box-title"},[a._v("ProvidÃªncias Tomadas:")]),o("p",{staticClass:"box-text"},[a._v(a._s(t.providencias_cpm))])]):a._e()])])})),0)]):a._e()]):a._e()])]),o("div",{staticClass:"documentos-section"},[o("h4",[a._v("Documentos e PadronizaÃ§Ã£o")]),o("div",{staticClass:"padronizacao-info"},[o("div",{staticClass:"info-row"},[o("div",{staticClass:"info-item"},[o("span",{staticClass:"info-label"},[a._v("PadronizaÃ§Ã£o:")]),o("span",{staticClass:"info-value"},[a._v(" "+a._s(a.produtoSelecionado.edital_prequalificacao||"Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº ______/____")+" ")]),a.produtoSelecionado.edital_prequalificacao?a._e():o("button",{staticClass:"btn-action btn-vincular",on:{click:a.abrirModalVincularEdital}},[a._v(" ğŸ”— Vincular Edital ")])])]),a.produtoSelecionado.processo_cancelamento?o("div",{staticClass:"info-row"},[o("div",{staticClass:"info-item"},[o("span",{staticClass:"info-label"},[a._v("DespadronizaÃ§Ã£o:")]),o("span",{staticClass:"info-value"},[a._v(" "+a._s(a.produtoSelecionado.processo_cancelamento||"Processo de cancelamento da DCB nÂº _______/____")+" ")])])]):a._e(),o("div",{staticClass:"info-row"},[o("div",{staticClass:"info-item"},[o("span",{staticClass:"info-label"},[a._v("Status Atual:")]),o("span",{staticClass:"status-badge",class:a.getStatusMarcaClass(a.produtoSelecionado)},[a._v(" "+a._s(a.getStatusMarca(a.produtoSelecionado))+" ")]),"Em Vigor"!==a.getStatusMarca(a.produtoSelecionado)||a.produtoSelecionado.processo_cancelamento?a._e():o("button",{staticClass:"btn-action btn-despadronizar",on:{click:a.abrirModalDespadronizar}},[a._v(" âŒ Despadronizar ")])])]),a.produtoSelecionado.validade_dcb?o("div",{staticClass:"info-row"},[o("div",{staticClass:"info-item"},[o("span",{staticClass:"info-label"},[a._v("Validade DCB:")]),o("span",{staticClass:"info-value"},[a._v(" "+a._s(a.formatarData(a.produtoSelecionado.validade_dcb))+" ")])])]):a._e()]),a.documentos.length>0?o("div",{staticClass:"documentos-anexos"},[o("h5",[a._v("Documentos Anexos")]),o("ul",a._l(a.documentos,(function(t){return o("li",{key:t.id},[o("a",{attrs:{href:t.arquivo_url,target:"_blank"}},[a._v(a._s(t.nome))])])})),0)]):a._e()])])])])]):a._e(),a.modalVincularEdital?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVincularEdital}},[o("div",{staticClass:"modal-content vincular-edital-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("Vincular Edital de PrÃ©-QualificaÃ§Ã£o")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalVincularEdital}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"produto-info-display"},[o("h4",[a._v("Produto:")]),o("p",[o("strong",[a._v(a._s(a.produtoSelecionado?.nome))]),a._v(" - "+a._s(a.produtoSelecionado?.marca)+" "+a._s(a.produtoSelecionado?.modelo))])]),o("form",{on:{submit:function(o){return o.preventDefault(),a.vincularEdital.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"editalSelect"}},[a._v("Selecionar Edital Existente *")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.editalSelecionado,expression:"editalSelecionado"}],attrs:{id:"editalSelect",required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.editalSelecionado=o.target.multiple?t:t[0]}}},[o("option",{attrs:{value:""}},[a._v("Selecione um edital...")]),a._l(a.editaisDisponiveis,(function(t){return o("option",{key:t.id,domProps:{value:t}},[a._v(" "+a._s(t.numero)+" - "+a._s(t.descricao)+" ")])}))],2)]),a.editalSelecionado?o("div",{staticClass:"edital-preview"},[o("h5",[a._v("Detalhes do Edital Selecionado:")]),o("p",[o("strong",[a._v("NÃºmero:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),o("p",[o("strong",[a._v("DescriÃ§Ã£o:")]),a._v(" "+a._s(a.editalSelecionado.descricao))]),a.editalSelecionado.data_publicacao?o("p",[o("strong",[a._v("Data de PublicaÃ§Ã£o:")]),a._v(" "+a._s(a.formatarData(a.editalSelecionado.data_publicacao)))]):a._e(),o("p",[o("strong",[a._v("Status:")]),a._v(" "+a._s(a.editalSelecionado.status))])]):a._e()])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalVincularEdital}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:!a.editalSelecionado||a.salvandoVinculacao},on:{click:a.vincularEdital}},[a.salvandoVinculacao?o("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoVinculacao?"Vinculando...":"Vincular Edital")+" ")])])])]):a._e(),a.modalDespadronizar?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDespadronizar}},[o("div",{staticClass:"modal-content despadronizar-modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("Despadronizar Produto")]),o("button",{staticClass:"btn-close",on:{click:a.fecharModalDespadronizar}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"produto-info-display"},[o("h4",[a._v("Produto:")]),o("p",[o("strong",[a._v(a._s(a.produtoSelecionado?.nome))]),a._v(" - "+a._s(a.produtoSelecionado?.marca)+" "+a._s(a.produtoSelecionado?.modelo))])]),a._m(2),o("form",{on:{submit:function(o){return o.preventDefault(),a.despadronizarProduto.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"numeroProcesso"}},[a._v("NÃºmero do Processo de Cancelamento *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.numero_processo,expression:"despadronizacao.numero_processo"}],attrs:{id:"numeroProcesso",type:"text",required:"",placeholder:"Ex: 2024/001"},domProps:{value:a.despadronizacao.numero_processo},on:{input:function(o){o.target.composing||a.$set(a.despadronizacao,"numero_processo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"motivoDespadronizacao"}},[a._v("Motivo da DespadronizaÃ§Ã£o *")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.motivo,expression:"despadronizacao.motivo"}],attrs:{id:"motivoDespadronizacao",rows:"4",required:"",placeholder:"Descreva detalhadamente o motivo da despadronizaÃ§Ã£o..."},domProps:{value:a.despadronizacao.motivo},on:{input:function(o){o.target.composing||a.$set(a.despadronizacao,"motivo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"documentoDespadronizacao"}},[a._v("Documento ComprobatÃ³rio *")]),o("input",{attrs:{type:"file",id:"documentoDespadronizacao",accept:".pdf,.doc,.docx",required:""},on:{change:a.handleFileUpload}}),o("small",{staticClass:"file-info"},[a._v("Formatos aceitos: PDF, DOC, DOCX (mÃ¡x. 10MB)")])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"dataDespadronizacao"}},[a._v("Data de VigÃªncia da DespadronizaÃ§Ã£o *")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.despadronizacao.data_vigencia,expression:"despadronizacao.data_vigencia"}],attrs:{id:"dataDespadronizacao",type:"date",required:""},domProps:{value:a.despadronizacao.data_vigencia},on:{input:function(o){o.target.composing||a.$set(a.despadronizacao,"data_vigencia",o.target.value)}}})])])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalDespadronizar}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:!a.formularioDespadronizacaoValido||a.salvandoDespadronizacao},on:{click:a.despadronizarProduto}},[a.salvandoDespadronizacao?o("span",{staticClass:"spinner"}):a._e(),a._v(" "+a._s(a.salvandoDespadronizacao?"Processando...":"Confirmar DespadronizaÃ§Ã£o")+" ")])])])]):a._e()])},Co=[function(){var a=this,o=a._self._c;return o("label",[o("strong",[a._v("Grupo:")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"cpm-header"},[o("h6",[a._v("ManifestaÃ§Ã£o da CPM")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"warning-message"},[o("p",[o("strong",[a._v("âš ï¸ AtenÃ§Ã£o:")]),a._v(" Esta aÃ§Ã£o irÃ¡ remover este produto da lista de itens padronizados.")])])}];const bo={name:"CatalogoEletronico",data(){return{produtos:[],produtosFiltrados:[],categorias:[],searchTerm:"",filtroCategoria:"",categoriaAtual:"Todos os grupos",showCategoriaDropdown:!1,showAvaliacoes:!1,showReclamacoes:!1,activeTab:"avaliacoes",showAvaliacoesContent:!1,showReclamacoesContent:!1,produtoSelecionado:null,documentos:[],avaliacoes:[],avaliacaoMedia:0,carregandoCategorias:!0,categoriaSelecionada:null,currentTenantId:null,loading:!1,reclamacoes:(0,e.KR)([]),produtosDespadronizados:[],modalVincularEdital:!1,modalDespadronizar:!1,editaisDisponiveis:[],editalSelecionado:null,salvandoVinculacao:!1,salvandoDespadronizacao:!1,despadronizacao:{numero_processo:"",motivo:"",data_vigencia:"",arquivo:null},exportandoPDF:!1,tipoExportacao:null}},created(){this.obterTenantId().then((()=>{this.carregarDados()})),document.addEventListener("click",this.closeDropdownOnClickOutside)},mounted(){this.carregarCategoriasDireto(),this.showCategoriaDropdown=!1},beforeUnmount(){document.removeEventListener("click",this.closeDropdownOnClickOutside)},methods:{async obterTenantId(){try{const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)return void console.error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");if(o.user_metadata?.tenant_id)return this.currentTenantId=o.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:t,error:e}=await N.ND.from("usuarios").select("tenant_id").eq("email",o.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);t?.tenant_id?(this.currentTenantId=t.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID nÃ£o encontrado para o usuÃ¡rio")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){console.log("Iniciando carregamento de dados"),this.carregandoCategorias=!0,this.loading=!0;try{if(!this.currentTenantId&&(console.error("Tenant ID nÃ£o disponÃ­vel. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return console.error("NÃ£o foi possÃ­vel obter o tenant_id, impossÃ­vel carregar dados"),void this.$swal({icon:"error",title:"Erro ao carregar dados",text:"NÃ£o foi possÃ­vel identificar sua conta. Por favor, faÃ§a login novamente."});console.log("Buscando categorias do Supabase...");const{data:a,error:o}=await N.ND.from("categorias").select("*");o?console.error("Erro ao carregar categorias:",o):(this.categorias=a||[],console.log(`${this.categorias.length} categorias carregadas`)),console.log("Buscando produtos padronizados do Supabase...");let t=N.ND.from("produtos").select("\n            *,\n            dcb_certificados!produto_id (\n              numero_dcb,\n              data_validade,\n              status\n            )\n          ").eq("tenant_id",this.currentTenantId).in("status",["homologado","aprovado"]);const{data:e,error:s}=await t;if(s)console.error("Erro ao carregar produtos:",s),this.produtos=[];else{let a=(e||[]).map((a=>{if(a.numero_dcb&&a.validade_dcb)return console.log(`ğŸ“‹ DCB encontrado no produto: ${a.nome} - ${a.numero_dcb}`),{...a,dcb_status:"ativo"};if(a.dcb_certificados&&a.dcb_certificados.length>0){const o=a.dcb_certificados[0];return console.log(`ğŸ“‹ DCB encontrado na tabela: ${a.nome} - ${o.numero_dcb}`),{...a,numero_dcb:o.numero_dcb,validade_dcb:o.data_validade,dcb_status:o.status}}return console.log(`â³ Aguardando DCB para: ${a.nome}`),a}));const o=new Map;a.forEach((a=>{const t=`${a.nome}|${a.marca||""}|${a.modelo||""}|${a.fabricante||""}`,e=o.get(t);if(e){let s=!0;const i=!(!a.numero_dcb||!a.validade_dcb),r=!(!e.numero_dcb||!e.validade_dcb);i&&!r?(s=!1,console.log(`ğŸ”„ Priorizando produto COM DCB: ${a.nome} (${a.status} com DCB ${a.numero_dcb})`)):i===r?"homologado"===a.status&&"aprovado"===e.status&&(s=!1,console.log(`ğŸ”„ Priorizando produto homologado: ${a.nome} (${e.status} â†’ ${a.status})`)):!i&&r&&console.log(`âœ… Mantendo produto COM DCB: ${e.nome} (${e.status} com DCB ${e.numero_dcb})`),s||o.set(t,a)}else o.set(t,a)})),this.produtos=Array.from(o.values()),console.log(`${this.produtos.length} produtos Ãºnicos carregados (${a.length-this.produtos.length} duplicatas removidas)`),console.log("Produtos homologados:",this.produtos.filter((a=>"homologado"===a.status)).length),console.log("Produtos aprovados:",this.produtos.filter((a=>"aprovado"===a.status)).length),console.log("Produtos com DCB:",this.produtos.filter((a=>a.numero_dcb)).length),console.log("Produtos aguardando DCB:",this.produtos.filter((a=>"aprovado"===a.status&&!a.numero_dcb)).length)}await this.carregarProdutosDespadronizados(),this.filtrarProdutos()}catch(a){console.error("Erro no carregamento de dados:",a),this.$swal({icon:"error",title:"Erro ao carregar dados",text:"Ocorreu um erro ao carregar os dados. Tente novamente."})}finally{this.carregandoCategorias=!1,this.loading=!1}},async carregarProdutosDespadronizados(){try{console.log("Carregando produtos despadronizados...");const{data:a,error:o}=await N.ND.from("marcas_despadronizadas").select("produto_id").eq("tenant_id",this.currentTenantId).eq("status_atual","ativa");o?(console.error("Erro ao carregar produtos despadronizados:",o),this.produtosDespadronizados=[]):(this.produtosDespadronizados=(a||[]).filter((a=>a.produto_id)).map((a=>a.produto_id)),console.log(`${this.produtosDespadronizados.length} produtos despadronizados encontrados`))}catch(a){console.error("Erro ao carregar produtos despadronizados:",a),this.produtosDespadronizados=[]}},async carregarCategoriasDireto(){try{console.log("Tentando carregar categorias diretamente...");const{data:a,error:o}=await N.ND.from("categorias").select("*");if(o)return void console.error("Erro ao carregar categorias direto:",o);console.log("Resposta direta de categorias:",a),a&&a.length>0&&0===this.categorias.length&&(console.log("Atualizando categorias com dados diretos"),this.categorias=a)}catch(a){console.error("ExceÃ§Ã£o ao carregar categorias direto:",a)}},filtrarProdutos(){console.log("Filtrando produtos por:",this.filtroCategoria,"e texto:",this.searchTerm),this.produtosFiltrados=this.produtos.filter((a=>{const o=!this.filtroCategoria||a.categoria_id===this.filtroCategoria,t=!this.searchTerm||a.nome.toLowerCase().includes(this.searchTerm.toLowerCase())||a.descricao&&a.descricao.toLowerCase().includes(this.searchTerm.toLowerCase());return o&&t})),console.log("Produtos filtrados:",this.produtosFiltrados.length)},async verDetalhesProduto(a){try{if(!this.currentTenantId)return void console.error("NÃ£o foi possÃ­vel identificar o tenant_id");const{data:e,error:s}=await N.ND.from("produtos").select("*").eq("id",a).eq("tenant_id",this.currentTenantId).single();if(s)throw console.error("Erro ao carregar produto:",s),s;if(!e)return console.error("Produto nÃ£o encontrado ou nÃ£o pertence ao tenant atual"),void this.$swal({icon:"error",title:"Produto nÃ£o encontrado",text:"O produto solicitado nÃ£o existe ou vocÃª nÃ£o tem permissÃ£o para visualizÃ¡-lo."});this.produtoSelecionado=e;const{data:i,error:r}=await N.ND.from("documentos").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId);if(r)throw r;this.documentos=i||[];const n=await N.ND.from("material_feedbacks").select("*").eq("produto_id",a);let c={data:[],error:null};try{c=await N.ND.from("rdm_feedbacks").select("*").eq("produto_id",a)}catch(o){console.warn("Erro na primeira tentativa de RDM feedbacks, tentando estrutura alternativa:",o.message);try{c=await N.ND.from("rdm_feedbacks").select("*").eq("id",a)}catch(t){console.warn("Tabela rdm_feedbacks nÃ£o disponÃ­vel ou sem estrutura compatÃ­vel:",t.message),c={data:[],error:null}}}n.error&&console.error("Erro ao carregar feedbacks:",n.error),c.error&&!c.error.code?.includes("42")&&console.error("Erro ao carregar feedbacks RDM:",c.error);const l=n.data||[],d=c.data||[];if(this.avaliacoes=[...l.map((a=>({id:a.id,avaliacao:a.rating||0,comentario:a.comentario,data:a.data_feedback||a.criado_em,tipo:"Feedback",avaliador:"Feedback de UsuÃ¡rio"}))),...d.map((a=>({id:a.id,avaliacao:a.rating||0,comentario:a.comentario,data:a.data_feedback||a.criado_em,tipo:"RDM",avaliador:"AvaliaÃ§Ã£o RDM"})))],this.avaliacoes.sort(((a,o)=>new Date(o.data)-new Date(a.data))),this.avaliacoes.length>0){const a=this.avaliacoes.reduce(((a,o)=>a+o.avaliacao),0);this.avaliacaoMedia=parseFloat((a/this.avaliacoes.length).toFixed(1))}else this.avaliacaoMedia=0;await this.carregarReclamacoes()}catch(o){console.error("Erro ao carregar detalhes do produto:",o),this.$swal({icon:"error",title:"Erro ao carregar detalhes",text:"NÃ£o foi possÃ­vel carregar os detalhes do produto. Tente novamente."})}},fecharModal(){this.produtoSelecionado=null,this.documentos=[],this.avaliacoes=[],this.avaliacaoMedia=0,this.showAvaliacoes=!1},closeDropdownOnClickOutside(a){const o=this.$el.querySelector(".dropdown");o&&!o.contains(a.target)&&(this.showCategoriaDropdown=!1)},selecionarCategoria(a){console.log("Categoria selecionada:",a),this.categoriaSelecionada=a,this.categoriaAtual=a?a.nome:"Todos os grupos",this.filtroCategoria=a?a.id:"",this.showCategoriaDropdown=!1,this.filtrarProdutos()},toggleCategoriaDropdown(){this.showCategoriaDropdown=!this.showCategoriaDropdown},toggleAvaliacoes(){this.showAvaliacoes=!this.showAvaliacoes},toggleReclamacoes(){this.showReclamacoes=!this.showReclamacoes},setActiveTab(a){this.activeTab=a,"avaliacoes"===a?(this.showAvaliacoesContent=!0,this.showReclamacoesContent=!1):"reclamacoes"===a&&(this.showReclamacoesContent=!0,this.showAvaliacoesContent=!1)},toggleAvaliacoesContent(){this.showAvaliacoesContent=!this.showAvaliacoesContent},toggleReclamacoesContent(){this.showReclamacoesContent=!this.showReclamacoesContent},formatarData(a){if(!a)return"Data nÃ£o disponÃ­vel";try{const o=new Date(a);return o.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(o){return console.error("Erro ao formatar data:",o),"Data invÃ¡lida"}},async carregarReclamacoes(){try{if(!this.produtoSelecionado?.codigo_material)return void console.log("CÃ³digo do material nÃ£o encontrado no produto");console.log("Buscando reclamaÃ§Ãµes para o cÃ³digo de material:",this.produtoSelecionado.codigo_material);const{data:a,error:o}=await N.ND.from("reclamacoes_usuarios").select("*").eq("codigo_material",this.produtoSelecionado.codigo_material).order("data_reclamacao",{ascending:!1});if(o)throw console.error("Erro ao carregar reclamaÃ§Ãµes:",o),o;console.log(`ReclamaÃ§Ãµes encontradas: ${a?.length||0}`,a),this.reclamacoes=a||[]}catch(a){console.error("Erro ao carregar reclamaÃ§Ãµes:",a),this.reclamacoes=[]}},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):""},getStatusBadgeClass(a){const o={ABERTA:"badge-warning",EM_ANALISE:"badge-info",RESOLVIDA:"badge-success",REJEITADA:"badge-danger"};return o[a]||"badge-secondary"},getTipoAvaliacao(a){return"RDM"===a.tipo?"RDM":"FEEDBACK"===a.tipo?"Feedback":"AvaliaÃ§Ã£o"},getDocumentName(a){if(!a)return"";const o=a.split("/");return o[o.length-1]},getStatusMarca(a){if(this.produtosDespadronizados.includes(a.id))return"Despadronizado";if(!a.validade_dcb)return"Aguardando DCB";const o=new Date,t=new Date(a.validade_dcb);return t<o?"Vencido":"Em Vigor"},getStatusMarcaClass(a){const o=this.getStatusMarca(a);switch(o){case"Em Vigor":return"status-em-vigor";case"Vencido":return"status-vencido";case"Despadronizado":return"status-despadronizado";case"Aguardando DCB":return"status-aguardando-dcb";default:return"status-despadronizado"}},async abrirModalVincularEdital(){this.modalVincularEdital=!0,await this.carregarEditaisDisponiveis()},fecharModalVincularEdital(){this.modalVincularEdital=!1,this.editalSelecionado=null,this.editaisDisponiveis=[]},async carregarEditaisDisponiveis(){try{console.log("Carregando editais para tenant:",this.currentTenantId);const{data:a,error:o}=await N.ND.from("editais").select("*").eq("tenant_id",this.currentTenantId).eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(o)throw console.error("Erro detalhado ao carregar editais:",o),o;console.log("Editais encontrados:",a),this.editaisDisponiveis=a||[],0===this.editaisDisponiveis.length&&this.$swal({icon:"info",title:"Nenhum edital encontrado",text:'NÃ£o hÃ¡ editais publicados disponÃ­veis para vinculaÃ§Ã£o. Verifique se existem editais com status "PUBLICADO" para este Ã³rgÃ£o.'})}catch(a){console.error("Erro ao carregar editais:",a),this.$swal({icon:"error",title:"Erro",text:`NÃ£o foi possÃ­vel carregar os editais disponÃ­veis: ${a.message}`})}},async vincularEdital(){if(this.editalSelecionado){this.salvandoVinculacao=!0;try{const a=`Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº ${this.editalSelecionado.numero}`,{error:o}=await N.ND.from("produtos").update({edital_prequalificacao:a,edital_id:this.editalSelecionado.id,updated_at:(new Date).toISOString()}).eq("id",this.produtoSelecionado.id).eq("tenant_id",this.currentTenantId);if(o)throw o;this.produtoSelecionado.edital_prequalificacao=a,this.produtoSelecionado.edital_id=this.editalSelecionado.id,this.$swal({icon:"success",title:"Sucesso!",text:"Edital vinculado com sucesso!",timer:2e3,showConfirmButton:!1}),this.fecharModalVincularEdital()}catch(a){console.error("Erro ao vincular edital:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel vincular o edital. Tente novamente."})}finally{this.salvandoVinculacao=!1}}},abrirModalDespadronizar(){this.modalDespadronizar=!0,this.despadronizacao={numero_processo:"",motivo:"",data_vigencia:"",arquivo:null}},fecharModalDespadronizar(){this.modalDespadronizar=!1,this.despadronizacao={numero_processo:"",motivo:"",data_vigencia:"",arquivo:null}},handleFileUpload(a){const o=a.target.files[0];if(o){if(o.size>10485760)return this.$swal({icon:"error",title:"Arquivo muito grande",text:"O arquivo deve ter no mÃ¡ximo 10MB."}),void(a.target.value="");this.despadronizacao.arquivo=o}},async despadronizarProduto(){if(this.formularioDespadronizacaoValido){this.salvandoDespadronizacao=!0;try{let a=null;if(this.despadronizacao.arquivo){const o=`despadronizacao_${this.produtoSelecionado.id}_${Date.now()}_${this.despadronizacao.arquivo.name}`,{data:t,error:e}=await N.ND.storage.from("documentos").upload(o,this.despadronizacao.arquivo);if(e)throw e;const{data:{publicUrl:s}}=N.ND.storage.from("documentos").getPublicUrl(o);a=s}const o=`Processo de cancelamento da DCB nÂº ${this.despadronizacao.numero_processo}`,{error:t}=await N.ND.from("produtos").update({processo_cancelamento:o,motivo_despadronizacao:this.despadronizacao.motivo,data_despadronizacao:this.despadronizacao.data_vigencia,documento_despadronizacao:a,status:"despadronizado",updated_at:(new Date).toISOString()}).eq("id",this.produtoSelecionado.id).eq("tenant_id",this.currentTenantId);if(t)throw t;this.produtoSelecionado.processo_cancelamento=o,this.produtoSelecionado.motivo_despadronizacao=this.despadronizacao.motivo,this.produtoSelecionado.data_despadronizacao=this.despadronizacao.data_vigencia,this.produtoSelecionado.documento_despadronizacao=a,this.produtoSelecionado.status="despadronizado",this.$swal({icon:"success",title:"Produto Despadronizado",text:"O produto foi despadronizado com sucesso!",timer:3e3,showConfirmButton:!1}),this.fecharModalDespadronizar()}catch(a){console.error("Erro ao despadronizar produto:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel despadronizar o produto. Tente novamente."})}finally{this.salvandoDespadronizacao=!1}}},async exportarCatalogoPDF(){this.exportandoPDF=!0,this.tipoExportacao="resumido";try{const{data:a}=await N.ND.from("tenants").select("nome").eq("id",this.currentTenantId).single(),o=a?.nome||"Ã“rgÃ£o PÃºblico",{data:t}=await N.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).in("status",["aprovado","julgado_aprovado","homologado"]).order("nome"),{data:e}=await N.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).eq("status","despadronizado").order("nome"),s={orgao:o,dataGeracao:(new Date).toLocaleDateString("pt-BR"),produtosPadronizados:t||[],produtosDespadronizados:e||[]};this.gerarPDFCatalogo(s)}catch(a){console.error("Erro ao exportar catÃ¡logo:",a),this.$swal({icon:"error",title:"Erro na ExportaÃ§Ã£o",text:"NÃ£o foi possÃ­vel gerar o catÃ¡logo em PDF. Tente novamente."})}finally{this.exportandoPDF=!1,this.tipoExportacao=null}},gerarPDFCatalogo(a){const o=this.criarHTMLCatalogo(a),t=window.open("","_blank");t.document.write(o),t.document.close(),t.onload=()=>{t.print(),t.close()}},criarHTMLCatalogo(a){const o=a.produtosPadronizados.length+a.produtosDespadronizados.length;return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="UTF-8">\n          <title>CatÃ¡logo de Bens - ${a.orgao}</title>\n          <style>\n            @page { \n              margin: 20mm; \n              size: A4;\n            }\n            body {\n              font-family: Arial, sans-serif;\n              font-size: 12px;\n              line-height: 1.4;\n              color: #333;\n              margin: 0;\n              padding: 0;\n            }\n            .cabecalho {\n              text-align: center;\n              margin-bottom: 30px;\n              padding-bottom: 20px;\n              border-bottom: 2px solid #2c3e50;\n            }\n            .cabecalho h1 {\n              color: #2c3e50;\n              font-size: 20px;\n              margin: 0 0 10px 0;\n              font-weight: bold;\n            }\n            .cabecalho h2 {\n              color: #666;\n              font-size: 16px;\n              margin: 0 0 15px 0;\n              font-weight: normal;\n            }\n            .info-legal {\n              background-color: #f8f9fa;\n              padding: 15px;\n              border-left: 4px solid #007bff;\n              margin: 20px 0;\n              font-size: 11px;\n            }\n            .secao {\n              margin-bottom: 30px;\n            }\n            .secao h3 {\n              background-color: #2c3e50;\n              color: white;\n              padding: 10px;\n              margin: 0 0 15px 0;\n              font-size: 14px;\n              font-weight: bold;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-bottom: 20px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 8px;\n              text-align: left;\n              vertical-align: top;\n            }\n            th {\n              background-color: #f8f9fa;\n              font-weight: bold;\n              font-size: 11px;\n            }\n            td {\n              font-size: 10px;\n            }\n            .status-padronizado {\n              color: #28a745;\n              font-weight: bold;\n            }\n            .status-despadronizado {\n              color: #dc3545;\n              font-weight: bold;\n            }\n            .rodape {\n              margin-top: 40px;\n              padding-top: 20px;\n              border-top: 1px solid #ddd;\n              text-align: center;\n              font-size: 10px;\n              color: #666;\n            }\n            .estatisticas {\n              display: flex;\n              justify-content: space-around;\n              margin: 20px 0;\n              background-color: #f8f9fa;\n              padding: 15px;\n              border-radius: 5px;\n            }\n            .estatistica {\n              text-align: center;\n            }\n            .estatistica .numero {\n              font-size: 18px;\n              font-weight: bold;\n              color: #2c3e50;\n            }\n            .estatistica .label {\n              font-size: 11px;\n              color: #666;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="cabecalho">\n            <h1>CATÃLOGO DE BENS PADRONIZADOS E DESPADRONIZADOS</h1>\n            <h2>${a.orgao}</h2>\n            <p><strong>Data de GeraÃ§Ã£o:</strong> ${a.dataGeracao}</p>\n          </div>\n          \n          <div class="info-legal">\n            <strong>Base Legal:</strong> CatÃ¡logo elaborado em conformidade com o art. 15 da Lei nÂº 14.133/2021 \n            (Nova Lei de LicitaÃ§Ãµes e Contratos Administrativos), que estabelece a obrigatoriedade de \n            manutenÃ§Ã£o de catÃ¡logo de bens padronizados pelos Ã³rgÃ£os pÃºblicos.\n          </div>\n          \n          <div class="estatisticas">\n            <div class="estatistica">\n              <div class="numero">${a.produtosPadronizados.length}</div>\n              <div class="label">Bens Padronizados</div>\n            </div>\n            <div class="estatistica">\n              <div class="numero">${a.produtosDespadronizados.length}</div>\n              <div class="label">Bens Despadronizados</div>\n            </div>\n            <div class="estatistica">\n              <div class="numero">${o}</div>\n              <div class="label">Total de Itens</div>\n            </div>\n          </div>\n          \n          ${a.produtosPadronizados.length>0?`\n          <div class="secao">\n            <h3>ğŸ“‹ BENS PADRONIZADOS</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 15%">CÃ³digo</th>\n                  <th style="width: 40%">EspecificaÃ§Ã£o</th>\n                  <th style="width: 20%">Marca</th>\n                  <th style="width: 15%">Modelo</th>\n                  <th style="width: 10%">Status</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${a.produtosPadronizados.map((a=>`\n                  <tr>\n                    <td><strong>${a.codigo_material||a.codigo||"N/A"}</strong></td>\n                    <td>${a.nome||"N/A"}<br><small>${a.descricao||""}</small></td>\n                    <td>${a.marca||"N/A"}</td>\n                    <td>${a.modelo||"N/A"}</td>\n                    <td><span class="status-padronizado">PADRONIZADO</span></td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n          </div>\n          `:""}\n          \n          ${a.produtosDespadronizados.length>0?`\n          <div class="secao">\n            <h3>âŒ BENS DESPADRONIZADOS</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 12%">CÃ³digo</th>\n                  <th style="width: 30%">EspecificaÃ§Ã£o</th>\n                  <th style="width: 15%">Marca</th>\n                  <th style="width: 12%">Modelo</th>\n                  <th style="width: 10%">Status</th>\n                  <th style="width: 21%">Motivo da DespadronizaÃ§Ã£o</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${a.produtosDespadronizados.map((a=>`\n                  <tr>\n                    <td><strong>${a.codigo_material||a.codigo||"N/A"}</strong></td>\n                    <td>${a.nome||"N/A"}<br><small>${a.descricao||""}</small></td>\n                    <td>${a.marca||"N/A"}</td>\n                    <td>${a.modelo||"N/A"}</td>\n                    <td><span class="status-despadronizado">DESPADRONIZADO</span></td>\n                    <td><small>${a.motivo_despadronizacao||"NÃ£o informado"}</small></td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n          </div>\n          `:""}\n          \n          <div class="rodape">\n            <p><strong>CatÃ¡logo gerado automaticamente pelo Sistema Comprar Bem</strong></p>\n            <p>Este documento possui validade legal conforme Lei nÂº 14.133/2021</p>\n            <p>Data e hora de geraÃ§Ã£o: ${(new Date).toLocaleString("pt-BR")}</p>\n          </div>\n        </body>\n        </html>\n      `},async exportarCatalogoDetalhado(){this.exportandoPDF=!0,this.tipoExportacao="detalhado";try{const{data:a}=await N.ND.from("tenants").select("nome").eq("id",this.currentTenantId).single(),o=a?.nome||"Ã“rgÃ£o PÃºblico",{data:t}=await N.ND.from("produtos").select("\n            *,\n            categorias:categoria_id(nome)\n          ").eq("tenant_id",this.currentTenantId).in("status",["aprovado","julgado_aprovado","homologado"]).order("nome"),{data:e}=await N.ND.from("produtos").select("\n            *,\n            categorias:categoria_id(nome)\n          ").eq("tenant_id",this.currentTenantId).eq("status","despadronizado").order("nome"),{data:s}=await N.ND.from("marcas_despadronizadas").select("*").eq("tenant_id",this.currentTenantId).eq("status_atual","ativa"),i={orgao:o,dataGeracao:(new Date).toLocaleDateString("pt-BR"),produtosPadronizados:t||[],produtosDespadronizados:e||[],marcasDespadronizadas:s||[]};this.gerarPDFCatalogoDetalhado(i)}catch(a){console.error("Erro ao exportar catÃ¡logo detalhado:",a),this.$swal({icon:"error",title:"Erro na ExportaÃ§Ã£o",text:"NÃ£o foi possÃ­vel gerar o catÃ¡logo detalhado em PDF. Tente novamente."})}finally{this.exportandoPDF=!1,this.tipoExportacao=null}},gerarPDFCatalogoDetalhado(a){const o=this.criarHTMLCatalogoDetalhado(a),t=window.open("","_blank");t.document.write(o),t.document.close(),t.onload=()=>{t.print(),t.close()}},criarHTMLCatalogoDetalhado(a){const o=a.produtosPadronizados.length+a.produtosDespadronizados.length;return`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset="UTF-8">\n          <title>CatÃ¡logo Completo de Bens - ${a.orgao}</title>\n          <style>\n            @page { \n              margin: 15mm; \n              size: A4;\n            }\n            body {\n              font-family: Arial, sans-serif;\n              font-size: 11px;\n              line-height: 1.3;\n              color: #333;\n              margin: 0;\n              padding: 0;\n            }\n            .cabecalho {\n              text-align: center;\n              margin-bottom: 25px;\n              padding-bottom: 15px;\n              border-bottom: 2px solid #2c3e50;\n            }\n            .cabecalho h1 {\n              color: #2c3e50;\n              font-size: 18px;\n              margin: 0 0 8px 0;\n              font-weight: bold;\n            }\n            .cabecalho h2 {\n              color: #666;\n              font-size: 14px;\n              margin: 0 0 10px 0;\n              font-weight: normal;\n            }\n            .info-legal {\n              background-color: #f8f9fa;\n              padding: 12px;\n              border-left: 4px solid #007bff;\n              margin: 15px 0;\n              font-size: 10px;\n            }\n            .secao {\n              margin-bottom: 25px;\n              page-break-inside: avoid;\n            }\n            .secao h3 {\n              background-color: #2c3e50;\n              color: white;\n              padding: 8px;\n              margin: 0 0 12px 0;\n              font-size: 13px;\n              font-weight: bold;\n            }\n            table {\n              width: 100%;\n              border-collapse: collapse;\n              margin-bottom: 15px;\n              font-size: 9px;\n            }\n            th, td {\n              border: 1px solid #ddd;\n              padding: 6px;\n              text-align: left;\n              vertical-align: top;\n            }\n            th {\n              background-color: #f8f9fa;\n              font-weight: bold;\n              font-size: 9px;\n            }\n            .status-padronizado {\n              color: #28a745;\n              font-weight: bold;\n            }\n            .status-despadronizado {\n              color: #dc3545;\n              font-weight: bold;\n            }\n            .rodape {\n              margin-top: 30px;\n              padding-top: 15px;\n              border-top: 1px solid #ddd;\n              text-align: center;\n              font-size: 9px;\n              color: #666;\n            }\n            .estatisticas {\n              display: flex;\n              justify-content: space-around;\n              margin: 15px 0;\n              background-color: #f8f9fa;\n              padding: 12px;\n              border-radius: 5px;\n            }\n            .estatistica {\n              text-align: center;\n            }\n            .estatistica .numero {\n              font-size: 16px;\n              font-weight: bold;\n              color: #2c3e50;\n            }\n            .estatistica .label {\n              font-size: 10px;\n              color: #666;\n            }\n            .detalhes-adicionais {\n              font-size: 8px;\n              color: #666;\n              background-color: #f9f9f9;\n              padding: 4px;\n            }\n          </style>\n        </head>\n        <body>\n          <div class="cabecalho">\n            <h1>CATÃLOGO COMPLETO DE BENS PADRONIZADOS E DESPADRONIZADOS</h1>\n            <h2>${a.orgao}</h2>\n            <p><strong>Data de GeraÃ§Ã£o:</strong> ${a.dataGeracao} | <strong>Tipo:</strong> RelatÃ³rio Detalhado</p>\n          </div>\n          \n          <div class="info-legal">\n            <strong>Base Legal:</strong> CatÃ¡logo elaborado em conformidade com o art. 15 da Lei nÂº 14.133/2021. \n            Este relatÃ³rio contÃ©m informaÃ§Ãµes detalhadas para gestÃ£o interna e controle administrativo.\n          </div>\n          \n          <div class="estatisticas">\n            <div class="estatistica">\n              <div class="numero">${a.produtosPadronizados.length}</div>\n              <div class="label">Bens Padronizados</div>\n            </div>\n            <div class="estatistica">\n              <div class="numero">${a.produtosDespadronizados.length}</div>\n              <div class="label">Bens Despadronizados</div>\n            </div>\n            <div class="estatistica">\n              <div class="numero">${o}</div>\n              <div class="label">Total de Itens</div>\n            </div>\n          </div>\n          \n          ${a.produtosPadronizados.length>0?`\n          <div class="secao">\n            <h3>ğŸ“‹ BENS PADRONIZADOS - INFORMAÃ‡Ã•ES COMPLETAS</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 10%">CÃ³digo</th>\n                  <th style="width: 25%">EspecificaÃ§Ã£o</th>\n                  <th style="width: 12%">Marca</th>\n                  <th style="width: 10%">Modelo</th>\n                  <th style="width: 12%">Fabricante</th>\n                  <th style="width: 8%">Categoria</th>\n                  <th style="width: 8%">Status</th>\n                  <th style="width: 15%">Detalhes TÃ©cnicos</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${a.produtosPadronizados.map((a=>`\n                  <tr>\n                    <td><strong>${a.codigo_material||a.codigo||"N/A"}</strong></td>\n                    <td>\n                      <strong>${a.nome||"N/A"}</strong>\n                      ${a.descricao?`<br><small>${a.descricao}</small>`:""}\n                    </td>\n                    <td>${a.marca||"N/A"}</td>\n                    <td>${a.modelo||"N/A"}</td>\n                    <td>${a.fabricante||"N/A"}</td>\n                    <td>${a.categorias?.nome||"N/A"}</td>\n                    <td><span class="status-padronizado">PADRONIZADO</span></td>\n                    <td class="detalhes-adicionais">\n                      ${a.cnpj?`<strong>CNPJ:</strong> ${a.cnpj}<br>`:""}\n                      ${a.data_aprovacao?`<strong>Aprovado:</strong> ${new Date(a.data_aprovacao).toLocaleDateString("pt-BR")}<br>`:""}\n                      ${a.validade_dcb?`<strong>DCB vÃ¡lido atÃ©:</strong> ${new Date(a.validade_dcb).toLocaleDateString("pt-BR")}<br>`:""}\n                      ${a.edital_prequalificacao?`<strong>Edital:</strong> ${a.edital_prequalificacao}`:""}\n                    </td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n          </div>\n          `:""}\n          \n          ${a.produtosDespadronizados.length>0?`\n          <div class="secao">\n            <h3>âŒ BENS DESPADRONIZADOS - INFORMAÃ‡Ã•ES COMPLETAS</h3>\n            <table>\n              <thead>\n                <tr>\n                  <th style="width: 10%">CÃ³digo</th>\n                  <th style="width: 20%">EspecificaÃ§Ã£o</th>\n                  <th style="width: 12%">Marca</th>\n                  <th style="width: 10%">Modelo</th>\n                  <th style="width: 12%">Fabricante</th>\n                  <th style="width: 8%">Status</th>\n                  <th style="width: 15%">Motivo DespadronizaÃ§Ã£o</th>\n                  <th style="width: 13%">Detalhes Processo</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${a.produtosDespadronizados.map((a=>`\n                  <tr>\n                    <td><strong>${a.codigo_material||a.codigo||"N/A"}</strong></td>\n                    <td>\n                      <strong>${a.nome||"N/A"}</strong>\n                      ${a.descricao?`<br><small>${a.descricao}</small>`:""}\n                    </td>\n                    <td>${a.marca||"N/A"}</td>\n                    <td>${a.modelo||"N/A"}</td>\n                    <td>${a.fabricante||"N/A"}</td>\n                    <td><span class="status-despadronizado">DESPADRONIZADO</span></td>\n                    <td><small>${a.motivo_despadronizacao||"NÃ£o informado"}</small></td>\n                    <td class="detalhes-adicionais">\n                      ${a.processo_cancelamento?`<strong>Processo:</strong> ${a.processo_cancelamento}<br>`:""}\n                      ${a.data_despadronizacao?`<strong>Data:</strong> ${new Date(a.data_despadronizacao).toLocaleDateString("pt-BR")}<br>`:""}\n                      ${a.cnpj?`<strong>CNPJ:</strong> ${a.cnpj}`:""}\n                    </td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n          </div>\n          `:""}\n          \n          <div class="rodape">\n            <p><strong>CatÃ¡logo Detalhado gerado automaticamente pelo Sistema Comprar Bem</strong></p>\n            <p>Este documento contÃ©m informaÃ§Ãµes completas para gestÃ£o interna e controle administrativo</p>\n            <p>Data e hora de geraÃ§Ã£o: ${(new Date).toLocaleString("pt-BR")}</p>\n          </div>\n        </body>\n        </html>\n      `}},computed:{avaliacoesSorted(){return[...this.avaliacoes].sort(((a,o)=>{const t=new Date(a.data),e=new Date(o.data);return e-t}))},reclamacoesSorted(){return[...this.reclamacoes].sort(((a,o)=>new Date(o.data_reclamacao)-new Date(a.data_reclamacao)))},averageRating(){if(!this.avaliacoes.length)return 0;const a=this.avaliacoes.reduce(((a,o)=>a+(o.avaliacao||0)),0);return(a/this.avaliacoes.length).toFixed(1)},produtosFiltradosOrdenados(){return[...this.produtosFiltrados].sort(((a,o)=>a.nome.localeCompare(o.nome,"pt-BR",{sensitivity:"base"})))},formularioDespadronizacaoValido(){return this.despadronizacao.numero_processo&&this.despadronizacao.motivo&&this.despadronizacao.data_vigencia&&this.despadronizacao.arquivo}}},Do=bo;var Eo=(0,C.A)(Do,fo,Co,!1,null,"307ae68c",null);const Ao=Eo.exports,wo={name:"Catalogo",components:{CatalogoEletronico:Ao},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}},closeDropdown(){this.dropdownOpen=!1}}},xo=wo;var Po=(0,C.A)(xo,_o,ho,!1,null,"67cc3180",null);const So=Po.exports;var yo=function(){var a=this,o=a._self._c;return o("div",{staticClass:"feedback-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[o("div",{staticClass:"profile-avatar"},[a._v(" ğŸ‘¤ ")]),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("â–¼")])]),a.dropdownOpen?o("div",{staticClass:"dropdown-menu"},[o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" âš™ï¸ ConfiguraÃ§Ã£o ")]),o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ğŸ“§ Configurar Email ")]),o("hr",{staticClass:"dropdown-divider"}),o("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" ğŸšª Sair ")])]):a._e()])])]),o("main",{staticClass:"main-content"},[o("FormularioRDM")],1),a.modalEmailAberto?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[o("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[a._m(1),o("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da OrganizaÃ§Ã£o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeOrganizacao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"emailRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;ComissÃ£o de PadronizaÃ§Ã£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"assinatura",o.target.value)}}})])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),o("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[o("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},Oo=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("h3",[o("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da OrganizaÃ§Ã£o")])}],$o=function(){var a=this,o=a._self._c;return o("div",{staticClass:"rdm-container"},[o("h2",[a._v("RelatÃ³rio de Desempenho de Material (RDM)")]),o("form",{on:{submit:function(o){return o.preventDefault(),a.enviarFeedback.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"produto"}},[a._v("Produto*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.feedback.rdm_id,expression:"feedback.rdm_id"}],attrs:{id:"produto",required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.feedback,"rdm_id",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione o produto...")]),a._l(a.produtos,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" - "+a._s(t.codigo||"Sem cÃ³digo")+" ")])}))],2)]),o("div",{staticClass:"form-group"},[o("label",[a._v("AvaliaÃ§Ã£o*")]),o("div",{staticClass:"avaliacao"},a._l(5,(function(t){return o("div",{key:t,staticClass:"estrela",class:{ativa:a.feedback.rating>=t},on:{click:function(o){a.feedback.rating=t}}},[a._v(" â˜… ")])})),0)]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"comentario"}},[a._v("Justificativa da avaliaÃ§Ã£o*")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.feedback.comentario,expression:"feedback.comentario"}],attrs:{id:"comentario",rows:"4",placeholder:"Ex: Equipamento apresentou falha apÃ³s 3 meses de uso...",required:""},domProps:{value:a.feedback.comentario},on:{input:function(o){o.target.composing||a.$set(a.feedback,"comentario",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"sugestoes"}},[a._v("SugestÃµes")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.feedback.sugestoes,expression:"feedback.sugestoes"}],attrs:{id:"sugestoes",rows:"3",placeholder:"Ex: Melhorar a qualidade do material, incluir manual em portuguÃªs..."},domProps:{value:a.feedback.sugestoes},on:{input:function(o){o.target.composing||a.$set(a.feedback,"sugestoes",o.target.value)}}})]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},No=[];const Ro={name:"FormularioRDM",data(){return{feedback:{rdm_id:"",rating:0,comentario:"",sugestoes:"",material_nome:"",material_codigo:""},produtos:[],loading:!1,currentUser:null,currentTenantId:null,error:null}},created(){this.carregarProdutos(),this.obterUsuarioAtual()},methods:{async obterUsuarioAtual(){try{const{data:{session:a},error:o}=await N.ND.auth.getSession();if(o)throw o;if(!a?.user)throw new Error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");{this.currentUser=a.user;const{data:o,error:t}=await N.ND.from("usuarios").select("tenant_id").eq("email",a.user.email).single();if(t&&"PGRST116"!==t.code)throw t;this.currentTenantId=o?.tenant_id||a.user.user_metadata?.tenant_id||(0,Ha.A)()}}catch(a){console.error("Erro ao obter dados do usuÃ¡rio:",a),this.$swal({icon:"error",title:"Erro de AutenticaÃ§Ã£o",text:"Por favor, faÃ§a login novamente para enviar um feedback."})}},async carregarProdutos(){try{if(this.currentTenantId||await this.obterUsuarioAtual(),!this.currentTenantId)throw new Error("NÃ£o foi possÃ­vel identificar o tenant_id");const{data:a,error:o}=await N.ND.from("produtos").select("*").eq("status","aprovado").eq("tenant_id",this.currentTenantId).order("nome");if(o)throw o;this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),this.$swal({icon:"error",title:"Erro ao carregar produtos",text:"NÃ£o foi possÃ­vel carregar a lista de produtos. Por favor, recarregue a pÃ¡gina."})}},async enviarFeedback(){if(0!==this.feedback.rating)if(this.feedback.rdm_id)if(this.feedback.comentario&&""!==this.feedback.comentario.trim())try{if(this.loading=!0,this.error=null,!this.currentUser?.email)throw new Error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");const{data:a,error:o}=await N.ND.from("usuarios").select("id, tenant_id").eq("email",this.currentUser.email).single();if(o&&"PGRST116"!==o.code)throw o;const t=this.produtos.find((a=>a.id===this.feedback.rdm_id));if(!t)throw new Error("Produto nÃ£o encontrado");const e={id:(0,Ha.A)(),tenant_id:this.currentTenantId,rdm_id:this.feedback.rdm_id,usuario_rdm_id:a.id,rating:this.feedback.rating,comentario:this.feedback.comentario||null,sugestoes:this.feedback.sugestoes||null,material_nome:t.nome,material_codigo:t.codigo||"N/A",criado_em:(new Date).toISOString()},{error:s}=await N.ND.from("rdm_feedbacks").insert(e);if(s)throw s;this.$swal({icon:"success",title:"Feedback enviado!",text:"Seu feedback foi enviado com sucesso."}),this.limparFormulario()}catch(a){console.error("Erro ao enviar feedback:",a);let o="Por favor, tente novamente.";"UsuÃ¡rio nÃ£o estÃ¡ autenticado"===a.message?o="Por favor, faÃ§a login para enviar um feedback.":"23505"===a.code&&(o="VocÃª jÃ¡ enviou um feedback para este produto."),this.$swal({icon:"error",title:"Erro ao enviar feedback",text:o}),this.error=a}finally{this.loading=!1}else this.$swal({icon:"warning",title:"Justificativa necessÃ¡ria",text:"Por favor, preencha a justificativa da avaliaÃ§Ã£o."});else this.$swal({icon:"warning",title:"Produto necessÃ¡rio",text:"Por favor, selecione um produto para avaliar."});else this.$swal({icon:"warning",title:"AvaliaÃ§Ã£o necessÃ¡ria",text:"Por favor, selecione uma avaliaÃ§Ã£o de 1 a 5 estrelas."})},limparFormulario(){this.feedback={rdm_id:"",rating:0,comentario:"",sugestoes:"",material_nome:"",material_codigo:""},this.error=null}}},Io=Ro;var To=(0,C.A)(Io,$o,No,!1,null,"4dd1cd6a",null);const Fo=To.exports,Mo={name:"Feedback",components:{FormularioRDM:Fo},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},mounted(){this.carregarConfiguracoes()},methods:{async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}}}},zo=Mo;var Lo=(0,C.A)(zo,yo,Oo,!1,null,"4accd64c",null);const Bo=Lo.exports;var qo=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dcb-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[o("div",{staticClass:"profile-avatar"},[a._v(" ğŸ‘¤ ")]),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("â–¼")])]),a.dropdownOpen?o("div",{staticClass:"dropdown-menu"},[o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" âš™ï¸ ConfiguraÃ§Ã£o ")]),o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ğŸ“§ Configurar Email ")]),o("hr",{staticClass:"dropdown-divider"}),o("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" ğŸšª Sair ")])]):a._e()])])]),o("main",{staticClass:"main-content"},[o("FormularioDCB")],1)])},ko=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])}],Uo=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dcb-container"},[o("h2",[a._v("DeclaraÃ§Ã£o de Conformidade de Bem (DCB)")]),o("div",{staticClass:"search-container"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"produto"}},[a._v("Selecione o produto")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.produtoSelecionado,expression:"produtoSelecionado"}],attrs:{id:"produto"},on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.produtoSelecionado=o.target.multiple?t:t[0]},a.carregarDetalhes]}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.produtos,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" - "+a._s(t.marca)+" - "+a._s(t.modelo)+" ")])}))],2)])]),a.loading?o("div",{staticClass:"loading"},[o("p",[a._v("Carregando informaÃ§Ãµes...")])]):a.produtoDetalhes?o("div",{staticClass:"produto-detalhes"},[o("div",{staticClass:"dcb-section"},[o("h3",[a._v("PRODUTO CERTIFICADO")]),o("div",{staticClass:"primeiro-quadro"},[a._m(0),o("div",{staticClass:"info-grid"},[o("div",{staticClass:"info-item full-width"},[o("strong",[a._v("1.1. Nome do Produto:")]),a._v(" "+a._s(a.produtoDetalhes.nome||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoDetalhes.marca||"NÃ£o informada")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoDetalhes.modelo||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoDetalhes.fabricante||"NÃ£o informado")+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("CNPJ do Fabricante:")]),a._v(" "+a._s(a.produtoDetalhes.cnpj||"NÃ£o informado")+" ")])])])]),o("div",{staticClass:"dcb-section"},[o("h3",[a._v("DADOS DA CERTIFICAÃ‡ÃƒO")]),o("div",{staticClass:"primeiro-quadro"},[a._m(1),o("div",{staticClass:"status-info"},[a._m(2),o("div",{staticClass:"info-item",staticStyle:{"margin-left":"40px"}},[o("strong",[a._v("Status:")]),o("span",{staticClass:"status-badge",class:a.getStatusDCBClass()},[a._v(" "+a._s(a.getStatusDCB())+" ")])]),o("div",{staticClass:"info-item",staticStyle:{"margin-left":"40px"}},[o("strong",[a._v("1.1.1. Origem:")]),a._v(" Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº "+a._s(a.produtoDetalhes.numero_edital||"XXX/YYYY")+" ")])]),o("div",{staticClass:"info-grid"},[o("div",{staticClass:"info-item"},[o("strong",[a._v("Data de EmissÃ£o:")]),a._v(" "+a._s(a.formatarData(a.produtoDetalhes.data_emissao))+" ")]),o("div",{staticClass:"info-item"},[o("strong",[a._v("Data de Validade:")]),a._v(" "+a._s(a.formatarData(a.produtoDetalhes.data_validade))+" ")])])])]),a.documentos.length>0?o("div",{staticClass:"documentos"},[o("h3",[a._v("Documentos Anexos")]),o("ul",{staticClass:"documentos-lista"},a._l(a.documentos,(function(t){return o("li",{key:t.id,staticClass:"documento-item"},[o("span",{staticClass:"doc-icon"},[a._v("ğŸ“„")]),o("span",{staticClass:"doc-nome"},[a._v(a._s(t.nome))]),o("a",{staticClass:"btn-download",attrs:{href:t.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),o("div",{staticClass:"dcb-actions"},[o("div",{staticClass:"button-group"},[o("button",{staticClass:"btn-primary",attrs:{disabled:!a.produtoAprovado},on:{click:a.visualizarDCB}},[a._v(" ğŸ‘ï¸ Visualizar DCB ")]),o("button",{staticClass:"btn-secondary",attrs:{disabled:!a.produtoAprovado},on:{click:a.baixarDCB}},[a._v(" ğŸ“¥ Baixar DCB (PDF) ")])]),a.produtoAprovado?a._e():o("p",{staticClass:"aviso"},[a._v(" âš ï¸ Somente produtos aprovados possuem DeclaraÃ§Ã£o de Conformidade disponÃ­vel. ")])])]):a._e()])},jo=[function(){var a=this,o=a._self._c;return o("p",[o("strong",[a._v("1. Primeiro quadro")])])},function(){var a=this,o=a._self._c;return o("p",[o("strong",[a._v("1. Primeiro quadro")])])},function(){var a=this,o=a._self._c;return o("p",{staticStyle:{"margin-left":"20px"}},[o("strong",[a._v("1.1.")]),a._v(' Incluir abaixo de "Status":')])}],Vo=t(1749);const Go={name:"FormularioDCB",data(){return{produtoSelecionado:"",produtoDetalhes:null,documentos:[],produtos:[],loading:!1,currentTenantId:null}},computed:{produtoAprovado(){return this.produtoDetalhes&&"aprovado"===this.produtoDetalhes.status}},created(){this.obterTenantId().then((()=>{this.carregarProdutos()}))},methods:{async obterTenantId(){try{const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)return void console.error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");if(o.user_metadata?.tenant_id)return void(this.currentTenantId=o.user_metadata.tenant_id);const{data:t,error:e}=await N.ND.from("usuarios").select("tenant_id").eq("email",o.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);t?.tenant_id&&(this.currentTenantId=t.tenant_id)}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarProdutos(){try{if(!this.currentTenantId)return void console.error("Tenant ID nÃ£o disponÃ­vel");const{data:a,error:o}=await N.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).eq("status","aprovado").order("nome");if(o)throw o;this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel carregar os produtos."})}},async carregarDetalhes(){if(!this.produtoSelecionado)return this.produtoDetalhes=null,void(this.documentos=[]);try{this.loading=!0;const{data:a,error:o}=await N.ND.from("produtos").select("*").eq("id",this.produtoSelecionado).single();if(o)throw o;if(console.log("Produto carregado:",a),a.data_emissao||(a.data_emissao=(new Date).toISOString().split("T")[0]),!a.data_validade){const o=new Date;o.setFullYear(o.getFullYear()+1),a.data_validade=o.toISOString().split("T")[0]}a.numero_edital||(a.numero_edital=`001/${(new Date).getFullYear()}`),this.produtoDetalhes=a,console.log("Detalhes do produto definidos:",this.produtoDetalhes);const{data:t,error:e}=await N.ND.from("documentos").select("*").eq("produto_id",this.produtoSelecionado);if(e)throw e;this.documentos=t||[]}catch(a){console.error("Erro ao carregar detalhes do produto:",a),this.$swal({icon:"error",title:"Erro",text:"NÃ£o foi possÃ­vel carregar os detalhes do produto."})}finally{this.loading=!1}},getStatusDCB(){if(!this.produtoDetalhes||!this.produtoDetalhes.data_validade)return"VENCIDA";const a=new Date,o=new Date(this.produtoDetalhes.data_validade);return o>a?"EM VIGOR":"VENCIDA"},getStatusDCBClass(){const a=this.getStatusDCB();return{"status-em-vigor":"EM VIGOR"===a,"status-vencida":"VENCIDA"===a}},formatarData(a){if(!a)return"NÃ£o informada";try{const o=new Date(a);return o.toLocaleDateString("pt-BR")}catch(o){return"Data invÃ¡lida"}},visualizarDCB(){if(!this.produtoDetalhes||!this.produtoAprovado)return void this.$swal({icon:"error",title:"NÃ£o disponÃ­vel",text:"Apenas produtos aprovados possuem DeclaraÃ§Ã£o de Conformidade disponÃ­vel."});const a=this.criarConteudoDCB();this.$swal({title:"DeclaraÃ§Ã£o de Conformidade de Bem",html:a,width:"800px",showConfirmButton:!0,confirmButtonText:"Fechar",showCancelButton:!0,cancelButtonText:"ğŸ“¥ Baixar PDF",cancelButtonColor:"#3498db"}).then((a=>{a.isDismissed&&"cancel"===a.dismiss&&this.baixarDCB()}))},baixarDCB(){if(this.produtoDetalhes&&this.produtoAprovado)try{const a=new Vo.jsPDF("p","mm","a4"),o=this.produtoDetalhes,t=(new Date).getFullYear();a.setFont("helvetica"),a.setFontSize(9),a.text("(Logo do Ã³rgÃ£o ou entidade)",20,15),a.text("(Nome do Ã³rgÃ£o ou entidade)",130,15),a.text("ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM",115,22),a.setFontSize(14),a.setFont("helvetica","bold");const e="DECLARAÃ‡ÃƒO DE CONFORMIDADE DE BEM",s=a.getTextWidth(e);a.text(e,(210-s)/2,35),a.setFontSize(12);const i=`DCB NÂº ${o.id}/${t}`,r=a.getTextWidth(i);a.text(i,(210-r)/2,42),a.line(20,47,190,47);let n=55;a.setFontSize(11),a.setFont("helvetica","bold"),a.text("PRODUTO CERTIFICADO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("1. Primeiro quadro",20,n),n+=5,a.text(`1.1. Nome: ${o.nome||"NÃ£o informado"}`,25,n),n+=4,a.text(`Marca: ${o.marca||"NÃ£o informada"}`,25,n),n+=4,a.text(`Modelo: ${o.modelo||"NÃ£o informado"}`,25,n),n+=4,a.text(`Fabricante: ${o.fabricante||"NÃ£o informado"}`,25,n),n+=4,a.text(`CNPJ do Fabricante: ${o.cnpj||"NÃ£o informado"}`,25,n),n+=10,a.setFont("helvetica","bold"),a.setFontSize(11),a.text("DADOS DA CERTIFICAÃ‡ÃƒO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(9),a.text("1. Primeiro quadro",20,n),n+=5,a.text('1.1. Incluir abaixo de "Status":',25,n),n+=4,a.text(`Status: ${this.getStatusDCB()}`,30,n),n+=4,a.text(`1.1.1. Origem: Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº ${o.numero_edital||"XXX/YYYY"}`,30,n),n+=10,a.setFont("helvetica","bold"),a.setFontSize(11),a.text("DECLARAÃ‡ÃƒO",20,n),n+=6,a.setFont("helvetica","normal"),a.setFontSize(8);const c=["A ComissÃ£o de PadronizaÃ§Ã£o de Materiais â€“ CPM do(a) _______ (nome do Ã³rgÃ£o/entidade)","_______, constituÃ­da por meio do(a) __________ [informar o tipo de instrumento","(resoluÃ§Ã£o/portaria), nÃºmero e ano de expediÃ§Ã£o], DECLARA que:","","1Âº) o produto especificado nesta DCB foi submetido Ã  demonstraÃ§Ã£o funcional e anÃ¡lise","tÃ©cnica, devidamente monitoradas e documentadas por esta CPM em processo administrativo","prÃ³prio, com estrita observÃ¢ncia Ã s formalidades legais e regulamentares, tendo sido","considerado apto e, portanto, APROVADO para o uso e a finalidade a que se destina, uma","vez que atendeu aos requisitos tÃ©cnicos exigidos pelo Edital de PrÃ©-QualificaÃ§Ã£o de Bens","em referÃªncia, sendo a sua marca comercial e modelo lanÃ§ados no CatÃ¡logo EletrÃ´nico de","Bens Padronizados deste(a) Ã³rgÃ£o/entidade, para fins de aquisiÃ§Ãµes futuras e eventuais,","conforme previsto na Lei Federal nÂº 14.133/2021 (Lei de LicitaÃ§Ãµes e Contratos);","","2Âº) expirada a sua vigÃªncia, esta DCB somente poderÃ¡ ser renovada mediante a realizaÃ§Ã£o","de nova demonstraÃ§Ã£o do produto nela especificado, para fins de reanÃ¡lise tÃ©cnica e","funcional monitoradas e documentadas pela CPM."];c.forEach((o=>{a.text(o,20,n),n+=""===o?2:4})),n+=8,a.text("Local e data ___________",20,n),n+=12,a.text("(assinatura digital)",20,n),n+=5,a.setFont("helvetica","bold"),a.text("ComissÃ£o de PadronizaÃ§Ã£o de Materiais",20,n),n+=4,a.text("Presidente da CPM",20,n);const l=`DCB_${o.nome}_${o.id}_${t}.pdf`;a.save(l),this.$swal({icon:"success",title:"PDF Gerado!",text:`DCB baixada como: ${l}`,timer:3e3,showConfirmButton:!1})}catch(a){console.error("Erro ao gerar PDF:",a),this.$swal({icon:"error",title:"Erro ao gerar PDF",text:"Ocorreu um erro ao gerar o arquivo PDF."})}else this.$swal({icon:"error",title:"NÃ£o disponÃ­vel",text:"Apenas produtos aprovados possuem DeclaraÃ§Ã£o de Conformidade disponÃ­vel."})},criarConteudoDCB(){const a=this.produtoDetalhes,o=((new Date).toLocaleDateString("pt-BR"),(new Date).getFullYear());return`\n        <div style="text-align: left; font-family: Arial, sans-serif; line-height: 1.6; padding: 20px;">\n          <div style="text-align: center; margin-bottom: 30px; border-bottom: 2px solid #2c3e50; padding-bottom: 20px;">\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">\n              <div style="text-align: left;">\n                <strong>(Logo do Ã³rgÃ£o<br>ou entidade)</strong>\n              </div>\n              <div style="text-align: right;">\n                <strong>(Nome do Ã³rgÃ£o ou entidade)<br>\n                ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM</strong>\n              </div>\n            </div>\n            <h2 style="margin: 20px 0 10px 0; font-size: 18px; font-weight: bold;">DECLARAÃ‡ÃƒO DE CONFORMIDADE DE BEM</h2>\n            <h3 style="margin: 5px 0; font-size: 16px;">DCB NÂº ${a.id}/${o}</h3>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">PRODUTO CERTIFICADO</h4>\n            <p style="margin: 8px 0;"><strong>1. Primeiro quadro</strong></p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>1.1. Nome:</strong> ${a.nome||"NÃ£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Marca:</strong> ${a.marca||"NÃ£o informada"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Modelo:</strong> ${a.modelo||"NÃ£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>Fabricante:</strong> ${a.fabricante||"NÃ£o informado"}</p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>CNPJ do Fabricante:</strong> ${a.cnpj||"NÃ£o informado"}</p>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">DADOS DA CERTIFICAÃ‡ÃƒO</h4>\n            <p style="margin: 8px 0;"><strong>1. Primeiro quadro</strong></p>\n            <p style="margin: 8px 0; margin-left: 20px;"><strong>1.1.</strong> Incluir abaixo de "Status":</p>\n            <p style="margin: 8px 0; margin-left: 40px;"><strong>Status:</strong> ${this.getStatusDCB()}</p>\n            <p style="margin: 8px 0; margin-left: 40px;"><strong>1.1.1. Origem:</strong> Edital de PrÃ©-QualificaÃ§Ã£o de Bens nÂº ${a.numero_edital||"XXX/YYYY"}</p>\n          </div>\n          \n          <div style="margin-bottom: 25px;">\n            <h4 style="color: #2c3e50; margin-bottom: 15px; font-size: 16px; font-weight: bold;">DECLARAÃ‡ÃƒO</h4>\n            <p style="margin: 10px 0; text-align: justify;">\n              A ComissÃ£o de PadronizaÃ§Ã£o de Materiais â€“ CPM do(a) <strong>_______ (nome do Ã³rgÃ£o/entidade) _______</strong>, constituÃ­da por meio do(a) <strong>__________ [informar o tipo de instrumento (resoluÃ§Ã£o/portaria), nÃºmero e ano de expediÃ§Ã£o]</strong>, <strong>DECLARA</strong> que:\n            </p>\n            \n            <p style="margin: 15px 0; text-align: justify;">\n              <strong>1Âº)</strong> o produto especificado nesta DCB foi submetido Ã  demonstraÃ§Ã£o funcional e anÃ¡lise tÃ©cnica, devidamente monitoradas e documentadas por esta CPM em processo administrativo prÃ³prio, com estrita observÃ¢ncia Ã s formalidades legais e regulamentares, tendo sido considerado apto e, portanto, <strong>APROVADO</strong> para o uso e a finalidade a que se destina, uma vez que atendeu aos requisitos tÃ©cnicos exigidos pelo Edital de PrÃ©-QualificaÃ§Ã£o de Bens em referÃªncia, sendo a sua marca comercial e modelo lanÃ§ados no <strong>CatÃ¡logo EletrÃ´nico de Bens Padronizados</strong> deste(a) Ã³rgÃ£o/entidade, para fins de aquisiÃ§Ãµes futuras e eventuais, conforme previsto na Lei Federal nÂº 14.133/2021 (Lei de LicitaÃ§Ãµes e Contratos);\n            </p>\n            \n            <p style="margin: 15px 0; text-align: justify;">\n              <strong>2Âº)</strong> expirada a sua vigÃªncia, esta DCB somente poderÃ¡ ser renovada mediante a realizaÃ§Ã£o de nova demonstraÃ§Ã£o do produto nela especificado, para fins de reanÃ¡lise tÃ©cnica e funcional monitoradas e documentadas pela CPM.\n            </p>\n          </div>\n          \n          <div style="margin-top: 50px; text-align: center;">\n            <p style="margin: 20px 0;">Local e data ___________</p>\n            <br><br>\n            <p style="margin: 10px 0;">(assinatura digital)</p>\n            <p style="margin: 5px 0; font-weight: bold;">ComissÃ£o de PadronizaÃ§Ã£o de Materiais</p>\n            <p style="margin: 5px 0; font-weight: bold;">Presidente da CPM</p>\n          </div>\n        </div>\n      `}}},Jo=Go;var Ho=(0,C.A)(Jo,Uo,jo,!1,null,"95e4a772",null);const Qo=Ho.exports,Zo={name:"DCB",components:{FormularioDCB:Qo},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}}}},Yo=Zo;var Xo=(0,C.A)(Yo,qo,ko,!1,null,"5236f06a",null);const Ko=Xo.exports;var Wo=function(){var a=this,o=a._self._c;return o("div",{staticClass:"ccl-view"},[o("header",{staticClass:"app-header"},[a._m(0),a.isUsuarioCCL?a._e():o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),a.isUsuarioCCL?o("div",{staticClass:"ccl-indicator"},[o("span",{staticClass:"ccl-badge"},[a._v("âš–ï¸ CCL - Acesso Exclusivo")])]):a._e(),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("â–¼")])]),a.showDropdown?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.usuarioNome))]),o("small",[a._v(a._s(a.usuarioEmail))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("DashboardCCL")],1)])},at=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])}],ot=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dashboard"},[o("h2",[a._v("Painel ComissÃ£o de ContrataÃ§Ã£o ou LicitaÃ§Ã£o")]),o("div",{staticClass:"tab-header"},[o("button",{staticClass:"tab-button",class:{active:"dashboard"===a.activeTab},on:{click:function(o){return a.setActiveTab("dashboard")}}},[a._v(" ğŸ“Š Dashboard "),a.notificacoes.filter((a=>!a.lido)).length>0?o("span",{staticClass:"tab-notification"},[a._v(" "+a._s(a.notificacoes.filter((a=>!a.lido)).length)+" ")]):a._e()]),o("button",{staticClass:"tab-button",class:{active:"atas"===a.activeTab},on:{click:function(o){return a.setActiveTab("atas")}}},[a._v(" ğŸ“‹ Atas de Julgamento ")]),o("button",{staticClass:"tab-button",class:{active:"homologacoes"===a.activeTab},on:{click:function(o){return a.setActiveTab("homologacoes")}}},[a._v(" âœ… HomologaÃ§Ãµes ")])]),o("div",{staticClass:"tab-content"},[o("div",{directives:[{name:"show",rawName:"v-show",value:"dashboard"===a.activeTab,expression:"activeTab === 'dashboard'"}],staticClass:"tab-pane"},[o("div",{staticClass:"stats-container"},[o("div",{staticClass:"stat-card status-pendente-card"},[o("div",{staticClass:"stat-icon"},[a._v("âš–ï¸")]),o("h3",[a._v("Processos em Julgamento")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))]),o("p",{staticClass:"stat-description"},[a._v("Aguardando decisÃ£o da CCL")])]),o("div",{staticClass:"stat-card status-aprovado-card"},[o("div",{staticClass:"stat-icon"},[a._v("âœ…")]),o("h3",[a._v("HomologaÃ§Ãµes")]),o("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))]),o("p",{staticClass:"stat-description"},[a._v("Processos homologados este mÃªs")])]),o("div",{staticClass:"stat-card status-recurso-card",class:{"stat-card-alert":a.prazosVencidos>0}},[o("div",{staticClass:"stat-icon"},[a._v("ğŸ“„")]),o("h3",[a._v("Recursos em AnÃ¡lise")]),o("div",{staticClass:"stat-value"},[a._v(" "+a._s(a.recursosEmAnalise)+" "),a.prazosVencidos>0?o("span",{staticClass:"alert-badge"},[a._v(" "+a._s(a.prazosVencidos)+" vencido"+a._s(a.prazosVencidos>1?"s":"")+" ")]):a._e()]),o("p",{staticClass:"stat-description"},[a._v("Aguardando julgamento")])])]),o("div",{staticClass:"dashboard-section"},[a._m(0),a.processosPendentesArray.length>0?o("table",[a._m(1),o("tbody",a._l(a.processosPendentesPaginados,(function(t){return o("tr",{key:t.id},[o("td",{staticClass:"processo-info"},[o("strong",[a._v(a._s(t.numero_processo))])]),o("td",{staticClass:"objeto-processo"},[o("span",{staticClass:"objeto-text",attrs:{title:t.objeto||"Objeto nÃ£o informado"}},[a._v(" "+a._s(a.truncateText(t.objeto||"Objeto nÃ£o informado",80))+" ")])]),o("td",{staticClass:"orgao-info"},[o("span",{staticClass:"orgao-nome"},[a._v(a._s(t.nome_orgao||"Ã“rgÃ£o nÃ£o informado"))])]),o("td",[a._v(a._s(a.formatDate(t.data_assinatura_orgao||t.atualizado_em)))]),o("td",[o("span",{staticClass:"prazo-badge",class:a.getPrazoCCLClass(t.data_assinatura_orgao||t.atualizado_em)},[a._v(" "+a._s(a.calcularPrazoCCL(t.data_assinatura_orgao||t.atualizado_em))+" ")])]),o("td",[o("span",{staticClass:"status-badge",class:a.getStatusClass(t.status)},[a._v(" "+a._s(a.formatarStatusProcesso(t.status))+" ")])]),o("td",{staticClass:"actions-cell"},[o("div",{staticClass:"action-buttons"},[o("button",{staticClass:"btn-small btn-secondary",attrs:{title:"Ver detalhes do processo"},on:{click:function(o){return a.visualizarProcesso(t)}}},[a._v(" ğŸ‘ï¸ Ver ")]),"julgamento_ccl"===t.status?o("button",{staticClass:"btn-small btn-primary",attrs:{title:"Iniciar julgamento tÃ©cnico CCL"},on:{click:function(o){return a.iniciarJulgamentoCCL(t)}}},[a._v(" âš–ï¸ Julgar ")]):a._e(),"julgamento_ccl"===t.status?o("button",{staticClass:"btn-small btn-warning",attrs:{title:"Devolver processo para correÃ§Ãµes"},on:{click:function(o){return a.devolverProcesso(t)}}},[a._v(" â†©ï¸ Devolver ")]):a._e(),"ata_ccl"===t.status?o("button",{staticClass:"btn-small btn-success",attrs:{title:"Enviar ata para publicaÃ§Ã£o pelo Ã³rgÃ£o"},on:{click:function(o){return a.tramitarAtaCCL(t)}}},[a._v(" ğŸ“‹ Enviar Ata ")]):a._e(),"ata_ccl"===t.status?o("button",{staticClass:"btn-small btn-warning",attrs:{title:"Devolver processo para correÃ§Ãµes"},on:{click:function(o){return a.devolverProcesso(t)}}},[a._v(" â†©ï¸ Devolver ")]):a._e()])])])})),0)]):a._e(),a.processosPendentesArray.length>0?o("div",{staticClass:"pagination-controls"},[o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.processosPendentes.paginaAtual<=1},on:{click:function(o){return a.paginaAnterior("processosPendentes")}}},[a._v(" â† Anterior ")]),o("span",{staticClass:"pagination-info"},[a._v(" PÃ¡gina "+a._s(a.paginacao.processosPendentes.paginaAtual)+" de "+a._s(a.calcularTotalPaginas("processosPendentes")||1)+" ("+a._s(a.processosPendentesArray.length)+" itens) ")]),o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.processosPendentes.paginaAtual>=a.calcularTotalPaginas("processosPendentes")},on:{click:function(o){return a.proximaPagina("processosPendentes")}}},[a._v(" PrÃ³xima â†’ ")])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("âš–ï¸")]),o("h4",[a._v("NÃ£o hÃ¡ processos administrativos pendentes")]),o("p",[a._v("NÃ£o hÃ¡ processos administrativos finalizados pela CPM aguardando julgamento da CCL.")])])]),a.notificacoes.filter((a=>!a.lido)).length>0?o("div",{staticClass:"alertas-section"},[o("div",{staticClass:"alertas-header"},[o("h3",[a._v("ğŸš¨ Alertas CrÃ­ticos")]),o("button",{staticClass:"btn-link",on:{click:a.marcarTodosComoLidos}},[a._v(" Marcar todos como lidos ")]),o("button",{staticClass:"btn-link",staticStyle:{"margin-left":"10px",color:"#dc3545"},on:{click:a.limparNotificacoesAntigas}},[a._v(" ğŸ—‘ï¸ Limpar antigas ")])]),o("div",{staticClass:"alertas-grid"},a._l(a.notificacoes.filter((a=>!a.lido)),(function(t){return o("div",{key:t.id,staticClass:"alerta-card",class:t.tipo},[o("div",{staticClass:"alerta-icon"},[a._v(" "+a._s(a.getAlertaIcon(t.tipo))+" ")]),o("div",{staticClass:"alerta-content"},[o("h5",[a._v(a._s(t.titulo))]),o("p",[a._v(a._s(t.mensagem))]),o("small",[a._v(a._s(a.formatDate(t.criado_em)))])]),o("div",{staticClass:"alerta-actions"},[o("button",{staticClass:"btn-small btn-primary",on:{click:function(o){return a.abrirAlerta(t)}}},[a._v(" Ver Detalhes ")]),o("button",{staticClass:"btn-small btn-secondary",on:{click:function(o){return a.marcarComoLido(t.id)}}},[a._v(" âœ“ Lido ")])])])})),0)]):a._e(),o("div",{staticClass:"dashboard-section"},[a._m(2),a.recursos.length>0?o("table",[a._m(3),o("tbody",a._l(a.recursosAnalisePageinados,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.recorrente))]),o("td",[o("strong",[a._v(a._s(t.produto_nome))]),o("br"),o("small",[a._v(a._s(t.ata_referencia))])]),o("td",[a._v(a._s(a.formatDate(t.data_recurso)))]),o("td",[o("span",{staticClass:"prazo-badge",class:a.getPrazoRecursoClass(t.prazo_final)},[a._v(" "+a._s(a.formatDate(t.prazo_final))+" ")])]),o("td",[o("span",{staticClass:"status-badge",class:a.getRecursoStatusClass(t.status)},[a._v(" "+a._s(t.status)+" ")])]),o("td",[o("button",{staticClass:"btn-small btn-primary",on:{click:function(o){return a.analisarRecurso(t)}}},[a._v(" ğŸ“‹ Analisar ")]),o("button",{staticClass:"btn-small btn-secondary",on:{click:function(o){return a.visualizarDocumentacaoRecurso(t)}}},[a._v(" ğŸ“„ Docs ")])])])})),0)]):a._e(),a.recursos.length>0?o("div",{staticClass:"pagination-controls"},[o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.recursosAnalise.paginaAtual<=1},on:{click:function(o){return a.paginaAnterior("recursosAnalise")}}},[a._v(" â† Anterior ")]),o("span",{staticClass:"pagination-info"},[a._v(" PÃ¡gina "+a._s(a.paginacao.recursosAnalise.paginaAtual)+" de "+a._s(a.calcularTotalPaginas("recursosAnalise")||1)+" ("+a._s(a.recursos.length)+" itens) ")]),o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.recursosAnalise.paginaAtual>=a.calcularTotalPaginas("recursosAnalise")},on:{click:function(o){return a.proximaPagina("recursosAnalise")}}},[a._v(" PrÃ³xima â†’ ")])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“„")]),o("h4",[a._v("NÃ£o hÃ¡ recursos em anÃ¡lise")]),o("p",[a._v("Todas as decisÃµes da CCL estÃ£o dentro do prazo recursal ou jÃ¡ foram julgadas.")])])])]),o("div",{directives:[{name:"show",rawName:"v-show",value:"atas"===a.activeTab,expression:"activeTab === 'atas'"}],staticClass:"atas-julgamento tab-pane"},[a._m(4),o("div",{staticClass:"atas-stats"},[o("div",{staticClass:"ata-stat-card"},[o("div",{staticClass:"ata-stat-icon"},[a._v("âœï¸")]),o("div",{staticClass:"ata-stat-info"},[o("h4",[a._v(a._s(a.atasEmElaboracao.length))]),o("p",[a._v("Atas em ElaboraÃ§Ã£o")])])]),o("div",{staticClass:"ata-stat-card"},[o("div",{staticClass:"ata-stat-icon"},[a._v("ğŸ“‹")]),o("div",{staticClass:"ata-stat-info"},[o("h4",[a._v(a._s(a.atasPublicadasRecentes.length))]),o("p",[a._v("Atas Publicadas")])])]),o("div",{staticClass:"ata-stat-card"},[o("div",{staticClass:"ata-stat-icon"},[a._v("ğŸ“„")]),o("div",{staticClass:"ata-stat-info"},[o("h4",[a._v(a._s(a.atasEmElaboracao.length+a.atasPublicadasRecentes.length))]),o("p",[a._v("Total de Atas CCL")])])])]),o("div",{staticClass:"atas-content"},[o("div",{staticClass:"atas-section"},[o("div",{staticClass:"section-header"},[o("div",{staticClass:"section-title-container"},[a._m(5),o("button",{staticClass:"btn-criar-nova-ata",on:{click:a.abrirModalCriarAta}},[a._v(" â• Criar Nova Ata ")])])]),a.atasEmElaboracao.length>0?o("div",{staticClass:"atas-table-container"},[o("table",{staticClass:"atas-elaboracao-table"},[a._m(6),o("tbody",a._l(a.atasEmElaboracao,(function(t){return o("tr",{key:t.id},[o("td",[o("strong",[a._v(a._s(t.numero_ata||`ATA-CCL-${String(t.id).slice(-4)}`))])]),o("td",[a._v(a._s(a.formatDate(t.data_inicio)))]),o("td",{staticClass:"processos-cell"},[o("span",{staticClass:"badge-info"},[a._v(a._s(t.processos_count||0)+" processo(s)")])]),a._m(7,!0),o("td",{staticClass:"actions-cell"},[o("div",{staticClass:"action-buttons"},[o("button",{staticClass:"btn-small btn-primary",attrs:{title:"Continuar elaborando a ata"},on:{click:function(o){return a.editarAta(t)}}},[a._v(" âœï¸ Continuar ")]),o("button",{staticClass:"btn-small btn-success",attrs:{title:"Finalizar e publicar ata"},on:{click:function(o){return a.finalizarAtaElaboracao(t)}}},[a._v(" ğŸ¯ Finalizar ")]),o("button",{staticClass:"btn-small btn-secondary",attrs:{title:"Visualizar rascunho"},on:{click:function(o){return a.visualizarAta(t)}}},[a._v(" ğŸ‘ï¸ Visualizar ")])])])])})),0)])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("âœï¸")]),o("h4",[a._v("Nenhuma ata em elaboraÃ§Ã£o")]),o("p",[a._v('Use o botÃ£o "Criar Nova Ata" para criar atas selecionando os processos julgados.')])])]),o("div",{staticClass:"atas-section"},[a._m(8),a.atasPublicadasRecentes.length>0?o("div",{staticClass:"atas-table-container"},[o("table",{staticClass:"atas-publicadas-table"},[a._m(9),o("tbody",a._l(a.atasPublicadasRecentes,(function(t){return o("tr",{key:t.id},[o("td",[o("strong",[a._v(a._s(t.numero||`ATA-${String(t.id).slice(-4)}`))])]),o("td",[a._v(a._s(a.formatDate(t.dataPublicacao)))]),o("td",{staticClass:"processos-cell"},[o("span",{staticClass:"badge-info"},[a._v(a._s(t.totalProcessos||0)+" processo(s)")])]),a._m(10,!0),o("td",{staticClass:"actions-cell"},[o("div",{staticClass:"action-buttons"},[o("button",{staticClass:"btn-small btn-primary",attrs:{title:"Baixar arquivo PDF da ata"},on:{click:function(o){return a.baixarAta(t)}}},[a._v(" ğŸ“„ Baixar PDF ")]),a.podeExibirBotaoTramitar(t)?o("button",{staticClass:"btn-small btn-success",attrs:{title:"Continuar tramitaÃ§Ã£o do processo"},on:{click:function(o){return a.tramitarProcessoAta(t)}}},[a._v(" âš–ï¸ Tramitar ")]):a._e()])])])})),0)])]):o("div",{staticClass:"empty-state"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“‹")]),o("h4",[a._v("Nenhuma ata publicada ainda")]),o("p",[a._v("As atas aparecerÃ£o aqui depois de serem elaboradas e oficialmente publicadas.")])])]),a.atasPublicadasRecentes.length>0?o("div",{staticClass:"pagination-controls"},[o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.atasPublicadas.paginaAtual<=1},on:{click:function(o){return a.paginaAnterior("atasPublicadas")}}},[a._v(" â† Anterior ")]),o("span",{staticClass:"pagination-info"},[a._v(" PÃ¡gina "+a._s(a.paginacao.atasPublicadas.paginaAtual)+" de "+a._s(a.calcularTotalPaginas("atasPublicadas")||1)+" ("+a._s(a.atasPublicadasRecentes.length)+" itens) ")]),o("button",{staticClass:"pagination-btn",attrs:{disabled:a.paginacao.atasPublicadas.paginaAtual>=a.calcularTotalPaginas("atasPublicadas")},on:{click:function(o){return a.proximaPagina("atasPublicadas")}}},[a._v(" PrÃ³xima â†’ ")])]):o("div",{staticClass:"empty-message"},[o("p",[a._v("NÃ£o hÃ¡ atas publicadas recentemente.")])])])])]),a.mostrarModalCriarAta?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalCriarAta}},[o("div",{staticClass:"modal-criar-ata",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“ Criar Nova Ata CCL")]),o("button",{staticClass:"btn-fechar-modal",on:{click:a.fecharModalCriarAta}},[a._v("âœ–ï¸")])]),o("div",{staticClass:"modal-body"},[a._m(11),a.carregandoProcessosModal?o("div",{staticClass:"processos-loading"},[o("p",[a._v("ğŸ”„ Carregando processos...")])]):0===a.processosDisponiveis.length?o("div",{staticClass:"no-processos"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“‹")]),o("h4",[a._v("Nenhum processo disponÃ­vel")]),o("p",[a._v("NÃ£o hÃ¡ processos aprovados pela CCL disponÃ­veis para criaÃ§Ã£o de ata.")])]):o("div",{staticClass:"processos-container"},[o("div",{staticClass:"selection-controls-modal"},[o("button",{staticClass:"btn-small btn-outline",attrs:{disabled:a.processosSelecionadosModal.length===a.processosDisponiveis.length},on:{click:a.selecionarTodosProcessosModal}},[a._v(" â˜‘ï¸ Selecionar Todos ")]),o("button",{staticClass:"btn-small btn-outline",attrs:{disabled:0===a.processosSelecionadosModal.length},on:{click:a.limparSelecaoProcessosModal}},[a._v(" âŒ Limpar SeleÃ§Ã£o ")]),o("span",{staticClass:"selection-info"},[a._v(a._s(a.processosSelecionadosModal.length)+" de "+a._s(a.processosDisponiveis.length)+" selecionados")])]),o("div",{staticClass:"processos-list"},a._l(a.processosDisponiveis,(function(t){return o("div",{key:t.id,staticClass:"processo-item",class:{selecionado:a.processosSelecionadosModal.includes(t.id)},on:{click:function(o){return a.toggleProcessoModal(t.id)}}},[o("div",{staticClass:"processo-checkbox"},[o("input",{directives:[{name:"model",rawName:"v-model",value:a.processosSelecionadosModal,expression:"processosSelecionadosModal"}],attrs:{type:"checkbox"},domProps:{value:t.id,checked:Array.isArray(a.processosSelecionadosModal)?a._i(a.processosSelecionadosModal,t.id)>-1:a.processosSelecionadosModal},on:{click:function(a){a.stopPropagation()},change:function(o){var e=a.processosSelecionadosModal,s=o.target,i=!!s.checked;if(Array.isArray(e)){var r=t.id,n=a._i(e,r);s.checked?n<0&&(a.processosSelecionadosModal=e.concat([r])):n>-1&&(a.processosSelecionadosModal=e.slice(0,n).concat(e.slice(n+1)))}else a.processosSelecionadosModal=i}}})]),o("div",{staticClass:"processo-details"},[o("div",{staticClass:"processo-numero"},[o("strong",[a._v(a._s(t.numero_processo))])]),o("div",{staticClass:"processo-orgao"},[a._v(" "+a._s(t.nome_orgao)+" ")]),o("div",{staticClass:"processo-meta"},[o("span",{staticClass:"data-julgamento"},[a._v(a._s(a.formatDate(t.ata_emitida_ccl_em)))])])])])})),0)])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn-secondary",on:{click:a.fecharModalCriarAta}},[a._v(" Cancelar ")]),o("button",{staticClass:"btn-primary",attrs:{disabled:0===a.processosSelecionadosModal.length},on:{click:a.confirmarCriacaoAta}},[a._v(" ğŸ“ Criar Ata ("+a._s(a.processosSelecionadosModal.length)+" processo"+a._s(1!==a.processosSelecionadosModal.length?"s":"")+") ")])])])]):a._e(),o("div",{directives:[{name:"show",rawName:"v-show",value:"homologacoes"===a.activeTab,expression:"activeTab === 'homologacoes'"}],staticClass:"homologacoes tab-pane"},[o("div",{staticClass:"homologacoes-header",staticStyle:{"margin-bottom":"30px"}},[o("HomologacoesCCL",{ref:"homologacoesCCL"})],1)])])},tt=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“‹ Processos Aguardando Julgamento CCL")]),o("p",{staticClass:"section-description"},[a._v(" Processos administrativos assinados pelo Ã³rgÃ£o competente que aguardam anÃ¡lise tÃ©cnica e julgamento pela CCL ")])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("NÃºmero do Processo")]),o("th",[a._v("Objeto")]),o("th",[a._v("Ã“rgÃ£o Solicitante")]),o("th",[a._v("Data Assinatura")]),o("th",[a._v("Prazo CCL")]),o("th",[a._v("SituaÃ§Ã£o")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“„ Recursos em AnÃ¡lise")]),o("p",{staticClass:"section-description"},[a._v(" Recursos apresentados contra decisÃµes da CCL que aguardam julgamento (prazo: 3 dias Ãºteis - art. 165 da Lei 14.133/2021) ")])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Recorrente")]),o("th",[a._v("Produto/Ata")]),o("th",[a._v("Data do Recurso")]),o("th",[a._v("Prazo Final")]),o("th",[a._v("Status")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"atas-header"},[o("h3",[a._v("ğŸ“‹ Atas de Julgamento CCL")]),o("p",{staticClass:"atas-description"},[a._v(" Acompanhe as atas de julgamento tÃ©cnico emitidas pela CCL apÃ³s anÃ¡lise dos processos de padronizaÃ§Ã£o ")])])},function(){var a=this,o=a._self._c;return o("div",[o("h4",[a._v("âœï¸ Atas em ElaboraÃ§Ã£o")]),o("p",{staticClass:"section-description"},[a._v("Atas que estÃ£o sendo criadas apÃ³s julgamentos recentes")])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Ata")]),o("th",[a._v("Data CriaÃ§Ã£o")]),o("th",[a._v("Processos")]),o("th",[a._v("Status")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("td",[o("span",{staticClass:"status-badge status-elaboracao"},[a._v(" âœï¸ Em ElaboraÃ§Ã£o ")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"section-header"},[o("h4",[a._v("ğŸ“‹ Atas Publicadas")]),o("p",{staticClass:"section-description"},[a._v("Atas oficiais jÃ¡ finalizadas e publicadas")])])},function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("Ata")]),o("th",[a._v("Data PublicaÃ§Ã£o")]),o("th",[a._v("Processos")]),o("th",[a._v("Status")]),o("th",[a._v("AÃ§Ãµes")])])])},function(){var a=this,o=a._self._c;return o("td",[o("span",{staticClass:"status-badge status-publicada"},[a._v(" ğŸ“‹ Publicada ")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modal-instructions"},[o("p",[a._v("Selecione os processos que devem ser incluÃ­dos na nova ata de julgamento:")])])}],et=t(5445),st=(t(6507),function(){var a=this,o=a._self._c;return o("div",{staticClass:"homologacoes-ccl"},[o("div",{staticClass:"section-card"},[o("div",{staticClass:"section-header"},[o("h3",[a._v("ğŸ“‹ HomologaÃ§Ãµes & DecisÃµes da Autoridade")]),o("div",{staticClass:"section-actions"},[o("button",{staticClass:"btn-primary",on:{click:a.carregarHomologacoes}},[a._v(" ğŸ”„ Atualizar ")])])]),a.homologacoes.length>0?o("div",{staticClass:"homologacoes-container"},a._l(a.homologacoesPaginadas,(function(t){return o("div",{key:t.id,staticClass:"homologacao-card"},[o("div",{staticClass:"homologacao-header"},[o("div",{staticClass:"homologacao-info"},[o("h4",[a._v(a._s(t.numeroAta))]),o("p",{staticClass:"data"},[a._v(a._s(a.formatDate(t.dataHomologacao)))])]),o("div",{staticClass:"homologacao-status"},[o("span",{staticClass:"status-badge",class:a.getStatusClass(t.tipo)},[a._v(" "+a._s(a.formatStatus(t.tipo))+" ")])])]),o("div",{staticClass:"homologacao-actions"},[o("button",{staticClass:"btn-small btn-primary",on:{click:function(o){return a.visualizarAta(t)}}},[a._v(" ğŸ“‹ Ver Ata ")]),o("button",{staticClass:"btn-small btn-secondary",on:{click:function(o){return a.baixarPDF(t)}}},[a._v(" ğŸ“¥ PDF ")]),o("button",{staticClass:"btn-small btn-success",on:{click:function(o){return a.verDCBs(t)}}},[a._v(" ğŸ“œ DCBs ")]),"diligencia"===t.tipo?o("button",{staticClass:"btn-small btn-warning",attrs:{title:"Tomar decisÃ£o final como Autoridade Competente"},on:{click:function(o){return a.decidirHomologacao(t)}}},[a._v(" âš–ï¸ Decidir ")]):a._e(),"diligencia_direta"===t.tipo?o("button",{staticClass:"btn-small btn-success",attrs:{title:"Confirmar homologaÃ§Ã£o direta da CCL"},on:{click:function(o){return a.confirmarHomologacaoCCL(t)}}},[a._v(" âœ… Confirmar ")]):"homologada"===t.tipo?o("button",{staticClass:"btn-small btn-success",attrs:{title:"Enviar processo homologado de volta para CPM para expediÃ§Ã£o de DCBs"},on:{click:function(o){return a.enviarParaCPM(t)}}},[a._v(" ğŸ“¤ Enviar para CPM ")]):"incluindo_marcas"===t.tipo?o("span",{staticClass:"btn-small btn-success",attrs:{title:"Processo concluÃ­do - produtos no catÃ¡logo"}},[a._v(" âœ… ConcluÃ­do ")]):"indeferida"===t.tipo?o("span",{staticClass:"btn-small btn-danger",attrs:{title:"Processo foi indeferido"}},[a._v(" âŒ Indeferido ")]):a._e()])])})),0):o("div",{staticClass:"empty-state"},[o("p",[a._v("Nenhuma homologaÃ§Ã£o encontrada")])]),a.homologacoes.length>0?o("div",{staticClass:"pagination-controls"},[o("button",{staticClass:"btn-pagination",attrs:{disabled:1===a.paginaAtual},on:{click:a.paginaAnterior}},[a._v(" â† Anterior ")]),o("span",{staticClass:"pagination-info"},[a._v(" PÃ¡gina "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),o("button",{staticClass:"btn-pagination",attrs:{disabled:a.paginaAtual===a.totalPaginas},on:{click:a.proximaPagina}},[a._v(" PrÃ³xima â†’ ")])]):a._e()])])}),it=[];const rt={name:"HomologacoesCCL",data(){return{homologacoes:[],loading:!1,paginaAtual:1,itensPorPagina:5}},computed:{totalPaginas(){return Math.ceil(this.homologacoes.length/this.itensPorPagina)},homologacoesPaginadas(){const a=(this.paginaAtual-1)*this.itensPorPagina,o=a+this.itensPorPagina;return this.homologacoes.slice(a,o)},currentTenantId(){return this.$store.getters.getTenantId||this.$store.state.user?.user?.user_metadata?.tenant_id||this.$store.state.user?.tenant_id||"8329e25e-8a01-4fc6-ab15-7a83dd874bde"}},mounted(){this.carregarHomologacoes()},methods:{async carregarHomologacoes(){if(this.currentTenantId){this.loading=!0;try{const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            status,\n            ata_emitida_ccl_em,\n            created_at,\n            updated_at,\n            tenant_id,\n            ata_julgamento_ccl\n          ").eq("tenant_id",this.currentTenantId).in("status",["ata_julgamento_ccl_homologacao","ata_julgamento_ccl_indeferimento","diligencia_ccl","homologado","indeferido"]).order("updated_at",{ascending:!1}).limit(20);if(o)throw o;this.homologacoes=a?.map((a=>({id:a.id,numeroAta:`${a.numero_processo}`,dataHomologacao:a.ata_emitida_ccl_em||a.updated_at||a.created_at,tipo:this.determinarTipo(a.status,a.ata_julgamento_ccl),processo:a})))||[]}catch(a){console.error("Erro ao carregar homologaÃ§Ãµes:",a),this.$swal({title:"âŒ Erro",text:"Erro ao carregar homologaÃ§Ãµes",icon:"error"})}finally{this.loading=!1}}else console.log("âŒ HomologacoesCCL: Sem tenant_id")},decidirHomologacao(a){this.$swal({title:"âš–ï¸ DecisÃ£o da Autoridade",text:`Processo: ${a.numeroAta}`,icon:"question",showCancelButton:!0,showDenyButton:!0,confirmButtonText:"âœ… Homologar",denyButtonText:"âŒ Indeferir",cancelButtonText:"ğŸ“„ DiligÃªncia"}).then((o=>{o.isConfirmed?this.processarDecisao(a,"HOMOLOGADO"):o.isDenied?this.processarDecisao(a,"INDEFERIDO"):o.isDismissed&&this.processarDecisao(a,"EM DILIGÃŠNCIA")}))},async processarDecisao(a,o){try{if(console.log("ğŸ“‹ Registrando decisÃ£o:",{processoId:a.id,numeroAta:a.numeroAta,decisao:o,dataDecisao:(new Date).toISOString()}),a.processo){const t="HOMOLOGADO"===o?"homologado":"INDEFERIDO"===o?"indeferido":"diligencia_ccl",{error:e}=await N.ND.from("processos_administrativos").update({status:t,updated_at:(new Date).toISOString()}).eq("id",a.processo.id).eq("tenant_id",this.currentTenantId);if(e)throw e}const t={HOMOLOGADO:"#28a745",INDEFERIDO:"#dc3545","EM DILIGÃŠNCIA":"#ffc107"};this.$swal({title:"âœ… DecisÃ£o Registrada",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4 style="color: ${t[o]};">${o}</h4>\n              <p><strong>Processo:</strong> ${a.numeroAta}</p>\n              <p><strong>DecisÃ£o registrada em:</strong> ${this.formatDate(new Date)}</p>\n            </div>\n          `,icon:"success",timer:3e3}),await this.carregarHomologacoes()}catch(t){console.error("Erro ao processar decisÃ£o:",t),this.$swal({title:"âŒ Erro",text:`Erro ao registrar decisÃ£o: ${t.message}`,icon:"error"})}},determinarTipo(a,o=""){switch(a){case"ata_julgamento_ccl_homologacao":const a=o&&o.includes("homologaÃ§Ã£o direta");return a?"diligencia_direta":"diligencia";case"ata_julgamento_ccl_indeferimento":return"diligencia";case"diligencia_ccl":return"diligencia";case"homologado":return"homologada";case"expedindo_dcbs":return"expedindo_dcbs";case"incluindo_marcas":return"incluindo_marcas";case"indeferido":return"indeferida";default:return"diligencia"}},getStatusClass(a){switch(a){case"homologada":return"status-aprovado";case"indeferida":return"status-reprovado";case"diligencia":return"status-pendente";default:return"status-padrao"}},formatStatus(a){switch(a){case"homologada":return"âœ… HOMOLOGADA - AGUARDA ENVIO PARA CPM";case"expedindo_dcbs":return"ğŸ“„ EXPEDINDO DCBs - AGUARDA INCLUSÃƒO NO CATÃLOGO";case"incluindo_marcas":return"ğŸ¯ CONCLUÃDO - PRODUTOS NO CATÃLOGO";case"indeferida":return"âŒ INDEFERIDA (FINAL)";case"diligencia":return"ğŸ“„ AGUARDANDO DECISÃƒO DA AUTORIDADE";case"diligencia_direta":return"âš¡ AGUARDANDO CONFIRMAÃ‡ÃƒO CCL";default:return a}},confirmarHomologacaoCCL(a){this.$swal({title:"âœ… Confirmar HomologaÃ§Ã£o Direta",html:`\n          <div style="text-align: left; padding: 15px;">\n            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #2e7d32;">ğŸ“‹ Processo: ${a.numeroAta}</h4>\n              <p style="margin: 5px 0;"><strong>Status:</strong> Aprovado pela CCL para homologaÃ§Ã£o direta</p>\n              <p style="margin: 5px 0;"><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n            </div>\n            \n            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 15px;">\n              <h5 style="margin: 0 0 8px 0; color: #856404; font-size: 14px;">âš¡ HomologaÃ§Ã£o Direta:</h5>\n              <p style="margin: 0; font-size: 13px;">\n                A CCL jÃ¡ analisou e aprovou este processo. A confirmaÃ§Ã£o irÃ¡ homologar definitivamente \n                e emitir as DCBs automaticamente.\n              </p>\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 8px;">ğŸ“ ObservaÃ§Ãµes da HomologaÃ§Ã£o:</label>\n              <textarea id="observacoesHomologacao" class="swal2-textarea" rows="3" \n                placeholder="ObservaÃ§Ãµes adicionais sobre a homologaÃ§Ã£o (opcional)..." \n                style="width: 100%; box-sizing: border-box;"></textarea>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"âœ… Confirmar HomologaÃ§Ã£o",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#28a745",width:"500px",preConfirm:()=>{const a=document.getElementById("observacoesHomologacao").value;return{observacoes:a.trim()}}}).then((o=>{o.isConfirmed&&this.processarConfirmacaoHomologacao(a,o.value.observacoes)}))},async processarConfirmacaoHomologacao(a,o){try{const{error:o}=await N.ND.from("processos_administrativos").update({status:"homologado",updated_at:(new Date).toISOString()}).eq("id",a.processo.id).eq("tenant_id",this.currentTenantId);if(o)throw o;this.$swal({title:"âœ… Processo Homologado!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4 style="color: #28a745;">HOMOLOGAÃ‡ÃƒO CONFIRMADA</h4>\n              <p><strong>Processo:</strong> ${a.numeroAta}</p>\n              <p><strong>Homologado em:</strong> ${this.formatDate(new Date)}</p>\n              <div style="background: #e8f5e8; padding: 12px; border-radius: 8px; margin-top: 15px;">\n                <p style="margin: 0; font-size: 14px;">\n                  ğŸ¯ <strong>DCBs serÃ£o emitidas automaticamente</strong>\n                </p>\n              </div>\n            </div>\n          `,icon:"success",timer:4e3}),await this.carregarHomologacoes()}catch(t){console.error("Erro ao confirmar homologaÃ§Ã£o:",t),this.$swal({title:"âŒ Erro",text:`Erro ao confirmar homologaÃ§Ã£o: ${t.message}`,icon:"error"})}},formatDate(a){if(!a)return"";const o=new Date(a);return o.toLocaleDateString("pt-BR")},async visualizarAta(a){try{const{data:o,error:t}=await N.ND.from("processos_administrativos").select("ata_julgamento_ccl, numero_processo, status").eq("id",a.processo.id).eq("tenant_id",this.currentTenantId).single();if(t)throw t;const e=o.ata_julgamento_ccl||"ConteÃºdo da ata nÃ£o encontrado.";this.$swal({title:`ğŸ“‹ Ata de Julgamento - ${o.numero_processo}`,html:`\n            <div style="text-align: left; padding: 20px; max-height: 400px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #007bff;">\n                <h4 style="margin: 0 0 10px 0; color: #007bff;">ğŸ“„ InformaÃ§Ãµes do Processo</h4>\n                <p style="margin: 5px 0;"><strong>Processo:</strong> ${o.numero_processo}</p>\n                <p style="margin: 5px 0;"><strong>Status:</strong> ${o.status}</p>\n                <p style="margin: 5px 0;"><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n              </div>\n              \n              <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6;">\n                <h5 style="margin: 0 0 15px 0; color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px;">ğŸ“‹ ConteÃºdo da Ata:</h5>\n                <div style="white-space: pre-wrap; font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.5; color: #333;">\n                  ${e}\n                </div>\n              </div>\n            </div>\n          `,showCancelButton:!0,cancelButtonText:"âŒ Fechar",showConfirmButton:!0,confirmButtonText:"ğŸ“„ Baixar PDF",confirmButtonColor:"#007bff",width:"700px",customClass:{htmlContainer:"custom-swal-container"}}).then((o=>{o.isConfirmed&&this.baixarPDF(a)}))}catch(o){console.error("Erro ao visualizar ata:",o),this.$swal({title:"âŒ Erro",text:`Erro ao carregar ata: ${o.message}`,icon:"error"})}},async baixarPDF(a){try{const{data:o,error:e}=await N.ND.from("processos_administrativos").select("*").eq("id",a.processo.id).eq("tenant_id",this.currentTenantId).single();if(e)throw e;const{jsPDF:s}=window.jspdf||t(1749);if(!s)throw new Error("Biblioteca jsPDF nÃ£o encontrada");const i=new s,r=i.internal.pageSize.getWidth(),n=20;i.setFontSize(16),i.setFont("helvetica","bold"),i.text("ATA DE JULGAMENTO DA CCL",r/2,30,{align:"center"}),i.setFontSize(12),i.setFont("helvetica","normal"),i.text(`Processo: ${o.numero_processo}`,n,50),i.text(`Data: ${this.formatDate(a.dataHomologacao)}`,n,60),i.text(`Status: ${o.status}`,n,70),i.setLineWidth(.5),i.line(n,80,r-n,80);let c=95;i.setFontSize(11),i.setFont("helvetica","normal");const l=o.ata_julgamento_ccl||"ConteÃºdo da ata nÃ£o disponÃ­vel.",d=i.splitTextToSize(l,r-2*n);d.forEach((a=>{c>270&&(i.addPage(),c=20),i.text(a,n,c),c+=6}));const u=i.internal.getNumberOfPages();for(let a=1;a<=u;a++)i.setPage(a),i.setFontSize(8),i.setFont("helvetica","italic"),i.text(`PÃ¡gina ${a} de ${u}`,r/2,285,{align:"center"}),i.text(`Gerado em: ${(new Date).toLocaleString("pt-BR")}`,r-n,285,{align:"right"});const m=`Ata_${o.numero_processo.replace("/","_")}_${(new Date).toISOString().split("T")[0]}.pdf`;i.save(m),this.$swal({title:"âœ… PDF Gerado!",text:`Arquivo "${m}" baixado com sucesso`,icon:"success",timer:3e3})}catch(o){console.error("Erro ao gerar PDF:",o),this.$swal({title:"âŒ Erro ao gerar PDF",text:"NÃ£o foi possÃ­vel gerar o PDF. Verifique se a biblioteca jsPDF estÃ¡ carregada.",icon:"error"})}},async verDCBs(a){try{const{data:o,error:t}=await N.ND.from("produtos").select("\n            id,\n            nome,\n            codigo,\n            status,\n            dcb_numero,\n            dcb_data_emissao,\n            dcb_status,\n            created_at\n          ").eq("processo_id",a.processo.id).eq("tenant_id",this.currentTenantId).order("created_at",{ascending:!1});if(t)throw t;const e=o?.filter((a=>a.dcb_numero))||[],s=o?.filter((a=>!a.dcb_numero))||[];this.$swal({title:`ğŸ“œ DCBs do Processo ${a.numeroAta}`,html:`\n            <div style="text-align: left; padding: 20px; max-height: 500px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #007bff;">\n                <h4 style="margin: 0 0 10px 0; color: #007bff;">ğŸ“„ Resumo do Processo</h4>\n                <p style="margin: 5px 0;"><strong>Processo:</strong> ${a.numeroAta}</p>\n                <p style="margin: 5px 0;"><strong>Status:</strong> ${this.formatStatus(a.tipo)}</p>\n                <p style="margin: 5px 0;"><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n                <p style="margin: 5px 0;"><strong>Total de Produtos:</strong> ${o?.length||0}</p>\n              </div>\n\n              ${e.length>0?`\n                <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #28a745;">\n                  <h5 style="margin: 0 0 15px 0; color: #155724;">âœ… DCBs Emitidas (${e.length})</h5>\n                  ${e.map((a=>`\n                    <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border: 1px solid #c3e6cb;">\n                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">\n                        <strong style="color: #155724;">${a.nome}</strong>\n                        <span style="background: #28a745; color: white; padding: 2px 8px; border-radius: 12px; font-size: 11px;">\n                          ${a.dcb_status||"ATIVA"}\n                        </span>\n                      </div>\n                      <p style="margin: 4px 0; font-size: 13px;"><strong>DCB:</strong> ${a.dcb_numero}</p>\n                      <p style="margin: 4px 0; font-size: 13px;"><strong>CÃ³digo:</strong> ${a.codigo}</p>\n                      <p style="margin: 4px 0; font-size: 13px;"><strong>EmissÃ£o:</strong> ${a.dcb_data_emissao?this.formatDate(a.dcb_data_emissao):"NÃ£o informada"}</p>\n                    </div>\n                  `)).join("")}\n                </div>\n              `:""}\n\n              ${s.length>0?`\n                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">\n                  <h5 style="margin: 0 0 15px 0; color: #856404;">â³ Aguardando DCB (${s.length})</h5>\n                  ${s.map((a=>`\n                    <div style="background: white; padding: 12px; border-radius: 6px; margin-bottom: 10px; border: 1px solid #ffeaa7;">\n                      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">\n                        <strong style="color: #856404;">${a.nome}</strong>\n                        <span style="background: #ffc107; color: #212529; padding: 2px 8px; border-radius: 12px; font-size: 11px;">\n                          ${a.status||"PENDENTE"}\n                        </span>\n                      </div>\n                      <p style="margin: 4px 0; font-size: 13px;"><strong>CÃ³digo:</strong> ${a.codigo}</p>\n                      <p style="margin: 4px 0; font-size: 13px;"><strong>Status:</strong> Aguardando expediÃ§Ã£o de DCB</p>\n                    </div>\n                  `)).join("")}\n                </div>\n              `:""}\n\n              ${0===o?.length?'\n                <div style="background: #f8d7da; padding: 15px; border-radius: 8px; border-left: 4px solid #dc3545; text-align: center;">\n                  <h5 style="margin: 0 0 10px 0; color: #721c24;">âŒ Nenhum produto encontrado</h5>\n                  <p style="margin: 0; color: #721c24;">\n                    NÃ£o hÃ¡ produtos associados a este processo ou ainda nÃ£o foram cadastrados no sistema.\n                  </p>\n                </div>\n              ':""}\n\n              <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-top: 15px;">\n                <p style="margin: 0; font-size: 12px; color: #1976d2;">\n                  ğŸ’¡ <strong>Dica:</strong> As DCBs sÃ£o emitidas apÃ³s a homologaÃ§Ã£o e tramitaÃ§Ã£o para a CPM.\n                </p>\n              </div>\n            </div>\n          `,showCancelButton:!0,cancelButtonText:"âœ… Fechar",showConfirmButton:e.length>0,confirmButtonText:"ğŸ“¥ Baixar RelatÃ³rio DCBs",confirmButtonColor:"#007bff",width:"600px"}).then((o=>{o.isConfirmed&&e.length>0&&this.gerarRelatorioDCBs(a,e)}))}catch(o){console.error("Erro ao carregar DCBs:",o),this.$swal({title:"âŒ Erro",text:`Erro ao carregar DCBs: ${o.message}`,icon:"error"})}},async gerarRelatorioDCBs(a,o){try{const{jsPDF:e}=window.jspdf||t(1749);if(!e)throw new Error("Biblioteca jsPDF nÃ£o encontrada");const s=new e,i=s.internal.pageSize.getWidth(),r=20;s.setFontSize(14),s.setFont("helvetica","bold"),s.text("RELATÃ“RIO DE DCBs",i/2,30,{align:"center"}),s.setFontSize(12),s.setFont("helvetica","normal"),s.text(`Processo: ${a.numeroAta}`,r,50),s.text(`Data: ${this.formatDate(a.dataHomologacao)}`,r,60),s.text(`Total de DCBs: ${o.length}`,r,70),s.setLineWidth(.5),s.line(r,80,i-r,80);let n=95;s.setFontSize(10),o.forEach(((a,o)=>{n>250&&(s.addPage(),n=20),s.setFont("helvetica","bold"),s.text(`${o+1}. ${a.nome}`,r,n),n+=8,s.setFont("helvetica","normal"),s.text(`DCB: ${a.dcb_numero}`,r+5,n),n+=6,s.text(`CÃ³digo: ${a.codigo}`,r+5,n),n+=6,s.text(`Status: ${a.dcb_status||"ATIVA"}`,r+5,n),n+=6,s.text(`EmissÃ£o: ${a.dcb_data_emissao?this.formatDate(a.dcb_data_emissao):"NÃ£o informada"}`,r+5,n),n+=15}));const c=s.internal.getNumberOfPages();for(let a=1;a<=c;a++)s.setPage(a),s.setFontSize(8),s.setFont("helvetica","italic"),s.text(`PÃ¡gina ${a} de ${c}`,i/2,285,{align:"center"}),s.text(`Gerado em: ${(new Date).toLocaleString("pt-BR")}`,i-r,285,{align:"right"});const l=`Relatorio_DCBs_${a.numeroAta.replace("/","_")}_${(new Date).toISOString().split("T")[0]}.pdf`;s.save(l),this.$swal({title:"âœ… RelatÃ³rio Gerado!",text:`Arquivo "${l}" baixado com sucesso`,icon:"success",timer:3e3})}catch(e){console.error("Erro ao gerar relatÃ³rio:",e),this.$swal({title:"âŒ Erro ao gerar relatÃ³rio",text:"NÃ£o foi possÃ­vel gerar o relatÃ³rio de DCBs.",icon:"error"})}},proximaPagina(){this.paginaAtual<this.totalPaginas&&this.paginaAtual++},paginaAnterior(){this.paginaAtual>1&&this.paginaAtual--},async enviarParaCPM(a){this.$swal({title:"ğŸ“¤ Enviar para CPM",html:`\n          <div style="text-align: left; padding: 15px;">\n            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #2e7d32;">ğŸ“‹ Processo: ${a.numeroAta}</h4>\n              <p style="margin: 5px 0;"><strong>Status:</strong> Homologado pela Autoridade</p>\n              <p style="margin: 5px 0;"><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n            </div>\n            \n            <div style="background: #fff3cd; padding: 12px; border-radius: 8px; margin-bottom: 15px;">\n              <h5 style="margin: 0 0 8px 0; color: #856404; font-size: 14px;">ğŸ“¤ TramitaÃ§Ã£o para CPM:</h5>\n              <p style="margin: 0; font-size: 13px;">\n                O processo serÃ¡ enviado de volta para a CPM para:<br>\n                â€¢ ExpediÃ§Ã£o das DCBs<br>\n                â€¢ InclusÃ£o dos produtos no catÃ¡logo eletrÃ´nico\n              </p>\n            </div>\n            \n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 8px;">ğŸ“ ObservaÃ§Ãµes da TramitaÃ§Ã£o:</label>\n              <textarea id="observacoesTramitacao" class="swal2-textarea" rows="3" \n                placeholder="ObservaÃ§Ãµes sobre o envio para CPM (opcional)..." \n                style="width: 100%; box-sizing: border-box;"></textarea>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"ğŸ“¤ Enviar para CPM",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#28a745",width:"500px",preConfirm:()=>{const a=document.getElementById("observacoesTramitacao").value;return{observacoes:a.trim()}}}).then((o=>{o.isConfirmed&&this.processarEnvioParaCPM(a,o.value.observacoes)}))},async processarEnvioParaCPM(a,o){try{const t=await et.A.enviarProcessoFlexivel(a.processo.id,"expedindo_dcbs","ENVIO_PARA_CPM","Processo homologado enviado para CPM para expediÃ§Ã£o de DCBs e inclusÃ£o no catÃ¡logo. "+(o?"ObservaÃ§Ãµes: "+o:""));if(!t.sucesso)throw new Error("Erro na tramitaÃ§Ã£o");this.$swal({title:"ğŸ“¤ Enviado para CPM!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4 style="color: #28a745;">PROCESSO TRAMITADO COM SUCESSO</h4>\n              <p><strong>Processo:</strong> ${a.numeroAta}</p>\n              <p><strong>Enviado em:</strong> ${this.formatDate(new Date)}</p>\n              <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-top: 15px;">\n                <p style="margin: 0; font-size: 14px;">\n                  ğŸ¢ <strong>Processo agora estÃ¡ com a CPM</strong>\n                </p>\n                <p style="margin: 5px 0 0 0; font-size: 12px;">\n                  A CPM irÃ¡ expedir as DCBs e incluir no catÃ¡logo\n                </p>\n              </div>\n            </div>\n          `,icon:"success",timer:4e3}),await this.carregarHomologacoes()}catch(t){console.error("Erro ao enviar para CPM:",t),this.$swal({title:"âŒ Erro",text:`Erro ao enviar para CPM: ${t.message}`,icon:"error"})}}}},nt=rt;var ct=(0,C.A)(nt,st,it,!1,null,"7ea2f4f8",null);const lt=ct.exports,dt={name:"DashboardCCL",components:{HomologacoesCCL:lt},data(){return{activeTab:"dashboard",processosPendentesArray:[],atasRecentes:[],pendentes:0,aprovados:0,recursosEmAnalise:0,categorias:[],currentTenantId:null,loading:!1,recursos:[],notificacoes:[],prazosVencidos:0,prazosUrgentes:0,autoCheckInterval:null,isLoadingData:!1,dataLoadTimeout:null,atasEmAndamento:0,atasPublicadas:0,processosPendentes:0,atasEmElaboracao:[],atasPublicadasRecentes:[],processosProntosParaAta:[],processosSelecionados:[],mostrarModalCriarAta:!1,processosDisponiveis:[],processosSelecionadosModal:[],carregandoProcessosModal:!1,homologacoesPendentes:0,homologacoesAprovadas:0,homologacoesIndeferidas:0,dcbsEmitidas:0,processosPendentesHomologacao:[],homologacoesRecentes:[],dcbsAtivas:[],paginacao:{atasElaboracao:{paginaAtual:1,itensPorPagina:5,total:0},atasPublicadas:{paginaAtual:1,itensPorPagina:5,total:0},processosPendentes:{paginaAtual:1,itensPorPagina:5,total:0},homologacoesRecentes:{paginaAtual:1,itensPorPagina:5,total:0},dcbsAtivas:{paginaAtual:1,itensPorPagina:5,total:0},recursos:{paginaAtual:1,itensPorPagina:5,total:0},processosPendentes:{paginaAtual:1,itensPorPagina:5,total:0},recursosAnalise:{paginaAtual:1,itensPorPagina:5,total:0}}}},computed:{atasElaboracaoPaginadas(){const a=(this.paginacao.atasElaboracao.paginaAtual-1)*this.paginacao.atasElaboracao.itensPorPagina,o=a+this.paginacao.atasElaboracao.itensPorPagina;return this.atasEmElaboracao.slice(a,o)},atasPublicadasPaginadas(){const a=(this.paginacao.atasPublicadas.paginaAtual-1)*this.paginacao.atasPublicadas.itensPorPagina,o=a+this.paginacao.atasPublicadas.itensPorPagina;return this.atasPublicadasRecentes.slice(a,o)},processosPendentesHomologacaoPaginados(){const a=(this.paginacao.processosPendentes.paginaAtual-1)*this.paginacao.processosPendentes.itensPorPagina,o=a+this.paginacao.processosPendentes.itensPorPagina;return this.processosPendentesHomologacao.slice(a,o)},homologacoesRecentesPaginadas(){const a=(this.paginacao.homologacoesRecentes.paginaAtual-1)*this.paginacao.homologacoesRecentes.itensPorPagina,o=a+this.paginacao.homologacoesRecentes.itensPorPagina;return this.homologacoesRecentes.slice(a,o)},dcbsAtivasPaginadas(){const a=(this.paginacao.dcbsAtivas.paginaAtual-1)*this.paginacao.dcbsAtivas.itensPorPagina,o=a+this.paginacao.dcbsAtivas.itensPorPagina;return this.dcbsAtivas.slice(a,o)},recursosPaginados(){const a=(this.paginacao.recursos.paginaAtual-1)*this.paginacao.recursos.itensPorPagina,o=a+this.paginacao.recursos.itensPorPagina;return this.recursos.slice(a,o)},processosPendentesPaginados(){const a=(this.paginacao.processosPendentes.paginaAtual-1)*this.paginacao.processosPendentes.itensPorPagina,o=a+this.paginacao.processosPendentes.itensPorPagina,t=this.processosPendentesArray.slice(a,o);return console.log("ğŸ–¥ï¸ [DEBUG CCL TEMPLATE] processosPendentesPaginados chamado"),console.log("ğŸ–¥ï¸ [DEBUG CCL TEMPLATE] this.processosPendentesArray.length:",this.processosPendentesArray?.length||0),console.log("ğŸ–¥ï¸ [DEBUG CCL TEMPLATE] resultado.length:",t?.length||0),t?.length>0&&t.forEach((a=>{console.log(`ğŸ–¥ï¸ [DEBUG CCL TEMPLATE] Processo para template: ${a.numero_processo} - Status: ${a.status}`)})),t},recursosAnalisePageinados(){const a=(this.paginacao.recursosAnalise.paginaAtual-1)*this.paginacao.recursosAnalise.itensPorPagina,o=a+this.paginacao.recursosAnalise.itensPorPagina;return this.recursos.slice(a,o)}},created(){this.obterTenantId().then((a=>{a?(this.carregarDados(!0),this.carregarCategorias(),this.atualizarDadosAtas(),this.carregarHomologacoes(),this.carregarProcessosPendentesHomologacao(),this.carregarHomologacoesRecentes(),this.carregarDCBsAtivas(),this.iniciarMonitoramentoPrazos()):console.warn("NÃ£o foi possÃ­vel obter tenant ID no created()")}))},watch:{currentTenantId:{handler(a,o){a&&a!==o&&!this.isLoadingData&&(console.log("ğŸ”„ [DEBUG CCL] Tenant ID mudou, recarregando dados:",a),this.dataLoadTimeout&&clearTimeout(this.dataLoadTimeout),this.dataLoadTimeout=setTimeout((()=>{this.isLoadingData||(this.isLoadingData=!0,this.$nextTick((()=>{this.carregarDados(!0).finally((()=>{this.isLoadingData=!1}))})))}),500))},immediate:!1},activeTab(a,o){a!==o&&this.currentTenantId&&("homologacoes"===a?(console.log("Entrando na aba homologaÃ§Ãµes - recarregando dados especÃ­ficos..."),this.carregarHomologacoes(),this.carregarProcessosPendentesHomologacao(),this.carregarHomologacoesRecentes()):"atas"===a?(console.log("Entrando na aba atas de julgamento - recarregando dados especÃ­ficos..."),this.atualizarDadosAtas()):"dashboard"===a&&0===this.processosPendentesArray.length&&(console.log("Voltando ao dashboard - recarregando apenas se necessÃ¡rio..."),this.carregarDados(!0)))}},beforeUnmount(){this.autoCheckInterval&&clearInterval(this.autoCheckInterval),this.dataLoadTimeout&&clearTimeout(this.dataLoadTimeout)},methods:{setActiveTab(a){this.activeTab=a},podeExibirBotaoTramitar(a){let o=null;a.ata_completa?.processos_administrativos&&(o=Array.isArray(a.ata_completa.processos_administrativos)?a.ata_completa.processos_administrativos[0]?.status:a.ata_completa.processos_administrativos.status);const t=o&&["ata_ccl","publicacao_ata"].includes(o);return t},decidirHomologacao(a){this.$swal({title:"âš–ï¸ DecisÃ£o da Autoridade",text:`Processo: ${a.numeroAta}`,icon:"question",showCancelButton:!0,showDenyButton:!0,confirmButtonText:"âœ… Homologar",denyButtonText:"âŒ Indeferir",cancelButtonText:"ğŸ“„ DiligÃªncia"}).then((o=>{o.isConfirmed?this.$swal("âœ… Homologado!",`Processo ${a.numeroAta} foi homologado`,"success"):o.isDenied?this.$swal("âŒ Indeferido!",`Processo ${a.numeroAta} foi indeferido`,"error"):o.isDismissed&&this.$swal("ğŸ“„ DiligÃªncia!",`Processo ${a.numeroAta} mantido em diligÃªncia`,"info")}))},async atualizarDadosAtas(){console.log("ğŸ”„ Atualizando dados das atas automaticamente...");try{await this.carregarAtasJulgamento(),await this.carregarAtasEmElaboracao(),await this.carregarProcessosProntosParaAta(),console.log("âœ… Dados das atas atualizados automaticamente"),this.$forceUpdate(),console.log("ğŸ“Š Atas em elaboraÃ§Ã£o:",this.atasEmElaboracao.length),console.log("ğŸ“‹ Atas publicadas:",this.atasPublicadasRecentes.length),console.log("ğŸ¯ Processos prontos para ata:",this.processosProntosParaAta?.length||0)}catch(a){console.error("Erro na atualizaÃ§Ã£o automÃ¡tica:",a)}},async carregarProcessosProntosParaAta(){try{console.log("ğŸ“‹ Carregando processos prontos para criaÃ§Ã£o de ata...");const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            objeto,\n            status,\n            nome_orgao,\n            ata_emitida_ccl_em,\n            ata_julgamento_ccl,\n            recomendacao_ccl,\n            tipo_processo,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).eq("status","ata_ccl").order("ata_emitida_ccl_em",{ascending:!1});if(o)throw o;this.processosProntosParaAta=a||[],console.log("âœ… Processos prontos para ata carregados:",this.processosProntosParaAta.length)}catch(a){console.error("âŒ Erro ao carregar processos prontos para ata:",a),this.processosProntosParaAta=[]}},async abrirModalCriarAta(){this.mostrarModalCriarAta=!0,this.processosSelecionadosModal=[],await this.carregarProcessosDisponiveis()},fecharModalCriarAta(){this.mostrarModalCriarAta=!1,this.processosDisponiveis=[],this.processosSelecionadosModal=[],this.carregandoProcessosModal=!1},async carregarProcessosDisponiveis(){try{this.carregandoProcessosModal=!0,console.log("ğŸ“‹ Carregando processos disponÃ­veis para criaÃ§Ã£o de ata..."),console.log("ğŸ” Tenant ID:",this.currentTenantId),console.log("ğŸ” Buscando processos com status: ata_ccl");const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            objeto,\n            status,\n            nome_orgao,\n            ata_emitida_ccl_em,\n            ata_julgamento_ccl,\n            recomendacao_ccl,\n            tipo_processo,\n            criado_em,\n            ata_emitida_ccl_em\n          ").eq("tenant_id",this.currentTenantId).eq("status","ata_ccl").order("ata_emitida_ccl_em",{ascending:!1});if(console.log("ğŸ” Consulta resultado - Error:",o),console.log("ğŸ” Consulta resultado - Dados:",a),console.log("ğŸ” Processos encontrados:",a?.length||0),o)throw o;this.processosDisponiveis=a||[],console.log("âœ… Processos disponÃ­veis carregados:",this.processosDisponiveis.length),a&&a.length>0&&a.forEach((a=>{console.log(`ğŸ“‹ Processo disponÃ­vel: ${a.numero_processo} - Status: ${a.status}`)}))}catch(a){console.error("âŒ Erro ao carregar processos disponÃ­veis:",a),this.processosDisponiveis=[],this.$swal({title:"âŒ Erro",text:"Erro ao carregar processos disponÃ­veis.",icon:"error"})}finally{this.carregandoProcessosModal=!1}},selecionarTodosProcessosModal(){this.processosSelecionadosModal=this.processosDisponiveis.map((a=>a.id))},limparSelecaoProcessosModal(){this.processosSelecionadosModal=[]},toggleProcessoModal(a){const o=this.processosSelecionadosModal.indexOf(a);o>-1?this.processosSelecionadosModal.splice(o,1):this.processosSelecionadosModal.push(a)},async confirmarCriacaoAta(){0!==this.processosSelecionadosModal.length?(await this.criarNovaAta(this.processosSelecionadosModal,"modal"),this.fecharModalCriarAta()):this.$swal({title:"âš ï¸ AtenÃ§Ã£o",text:"Selecione pelo menos um processo para criar a ata.",icon:"warning"})},async criarNovaAta(a,o){try{if(console.log("ğŸ“ Criando nova ata CCL para processos:",a),console.log("ğŸ” Tipo de criaÃ§Ã£o:",o),console.log("ğŸ” NÃºmero de processos selecionados:",a?.length),console.log("ğŸ” Current Tenant ID:",this.currentTenantId),!this.currentTenantId)throw new Error("Tenant ID nÃ£o disponÃ­vel");if(!a||0===a.length)throw new Error("Nenhum processo selecionado");const t=await this.gerarNumeroAta();console.log("ğŸ” NÃºmero da ata gerado:",t);const e=await this.gerarConteudoAtaInicial(a);console.log("ğŸ” ConteÃºdo da ata gerado:",e.substring(0,100)+"...");const s={tenant_id:this.currentTenantId,numero:t,periodo:this.obterPeriodoAtual(),descricao:"Ata de Julgamento CCL - "+(1===a.length?"Processo Individual":"Processos MÃºltiplos"),total_processos:a.length,status_ata:"ELABORACAO",conteudo_ata:e};console.log("ğŸ” Dados a serem inseridos:",s);const{data:i,error:r}=await N.ND.from("atas_julgamento").insert([s]).select().single();if(r)throw r;const{error:n}=await N.ND.from("processos_administrativos").update({status:"publicacao_ata"}).in("id",a);if(n)throw n;await this.vincularProdutosAta(i.id,a),this.processosSelecionados=[],await this.atualizarDadosAtas(),this.$swal({title:"âœ… Ata Criada!",text:`Ata ${t} criada com sucesso! VocÃª pode encontrÃ¡-la na seÃ§Ã£o "Atas em ElaboraÃ§Ã£o".`,icon:"success",timer:3e3,showConfirmButton:!1}),console.log("âœ… Ata criada com sucesso:",i)}catch(t){console.error("âŒ Erro ao criar ata:",t);let a="Erro ao criar a ata. Tente novamente.";t.message?a=t.message:t.details?a=`Erro no banco de dados: ${t.details}`:t.hint&&(a=`Dica: ${t.hint}`),this.$swal({title:"âŒ Erro",text:a,icon:"error"})}},async gerarNumeroAta(){try{const a=(new Date).getFullYear(),{data:o,error:t}=await N.ND.from("atas_julgamento").select("numero").eq("tenant_id",this.currentTenantId).like("numero",`%CCL%${a}%`).order("numero",{ascending:!1});if(t)throw t;console.log("ğŸ” Atas existentes do ano:",o);let e=1;if(o&&o.length>0){const a=o.map((a=>{const o=a.numero.match(/CCL-(\d+)-(\d{4})/);return o?parseInt(o[1]):0})).filter((a=>a>0)).sort(((a,o)=>o-a));console.log("ğŸ” NÃºmeros existentes:",a),a.length>0&&(e=a[0]+1)}const s=`ATA-CCL-${String(e).padStart(3,"0")}-${a}`;console.log("ğŸ” NÃºmero gerado:",s);const{data:i}=await N.ND.from("atas_julgamento").select("id").eq("numero",s).limit(1);if(i&&i.length>0){const o=Date.now().toString().slice(-6),t=`ATA-CCL-${o}-${a}`;return console.log("âš ï¸ NÃºmero duplicado detectado, usando fallback:",t),t}return s}catch(a){console.error("Erro ao gerar nÃºmero da ata:",a);const o=Date.now().toString().slice(-6);return`ATA-CCL-${o}-${(new Date).getFullYear()}`}},async obterNumerosProcessos(a){try{const{data:o}=await N.ND.from("processos_administrativos").select("numero_processo").in("id",a);return o?.map((a=>a.numero_processo))||[]}catch(o){return console.error("Erro ao obter nÃºmeros dos processos:",o),[]}},obterPeriodoAtual(){const a=new Date,o=String(a.getMonth()+1).padStart(2,"0"),t=a.getFullYear();return`${o}/${t}`},async gerarConteudoAtaInicial(a){try{const o=await this.obterNumerosProcessos(a);return`Ata de Julgamento da ComissÃ£o Central de LicitaÃ§Ã£o (CCL) referente aos processos: ${o.join(", ")}. Ata criada em ${(new Date).toLocaleDateString("pt-BR")}.`}catch(o){return"Ata de Julgamento da ComissÃ£o Central de LicitaÃ§Ã£o (CCL)."}},async vincularProdutosAta(a,o){try{console.log("ğŸ”— Iniciando vinculaÃ§Ã£o de produtos Ã  ata:",a),console.log("ğŸ” Processos:",o);const{data:t,error:e}=await N.ND.from("produtos").select("id, nome, marca, modelo, ccl_status, ccl_data_julgamento").eq("tenant_id",this.currentTenantId).eq("ccl_status","aprovado").is("ata_julgamento_id",null).order("ccl_data_julgamento",{ascending:!1}).limit(50);if(e)return void console.error("Erro ao buscar produtos:",e);if(console.log("ğŸ” Produtos aprovados encontrados:",t?.length||0),t&&t.length>0){const{error:o}=await N.ND.from("produtos").update({ata_julgamento_id:a}).in("id",t.map((a=>a.id))).eq("tenant_id",this.currentTenantId);if(o)return void console.error("Erro ao atualizar produtos:",o);console.log(`âœ… ${t.length} produtos vinculados Ã  ata ${a}`),t.forEach((a=>{console.log(`  - ${a.nome} (${a.marca}/${a.modelo})`)}))}else console.log("â„¹ï¸ Nenhum produto aprovado disponÃ­vel para vincular Ã  ata")}catch(t){console.error("Erro ao vincular produtos Ã  ata:",t)}},truncateText(a,o){return a?a.length<=o?a:a.substring(0,o)+"...":""},async carregarProcessosPendentes(){console.log("ğŸ”„ Recarregando processos pendentes..."),await this.carregarDados(!0),this.$swal({title:"âœ… Sucesso!",text:"Lista de processos atualizada com sucesso!",icon:"success",timer:2e3,showConfirmButton:!1})},gerarRelatorioProcessos(){this.$swal({title:"ğŸ“Š RelatÃ³rio de Processos CCL",text:"Esta funcionalidade gerarÃ¡ um relatÃ³rio detalhado dos processos sob anÃ¡lise da CCL.",icon:"info",showCancelButton:!0,confirmButtonText:"ğŸ“„ Gerar PDF",cancelButtonText:"Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"Em desenvolvimento",text:"A geraÃ§Ã£o de relatÃ³rios serÃ¡ implementada em breve.",icon:"info"})}))},gerarRelatorioAtas(){this.$swal({title:"ğŸ“‹ RelatÃ³rio de Atas CCL",text:"Esta funcionalidade gerarÃ¡ um relatÃ³rio das atas de julgamento emitidas pela CCL.",icon:"info",showCancelButton:!0,confirmButtonText:"ğŸ“„ Gerar PDF",cancelButtonText:"Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"Em desenvolvimento",text:"A geraÃ§Ã£o de relatÃ³rios de atas serÃ¡ implementada em breve.",icon:"info"})}))},async editarAta(a){try{const{data:o,error:t}=await N.ND.from("atas_julgamento").select("*").eq("id",a.id).eq("tenant_id",this.currentTenantId).single();if(t)throw t;const e=o.numero||`ATA-CCL-${o.id}`,s=o.conteudo_ata||this.gerarConteudoPadraoAta(o),i=o.descricao||"",{value:r}=await this.$swal({title:`âœï¸ Editor de Ata - ${e}`,html:`\n            <div style="text-align: left; max-width: 800px; margin: 0 auto;">\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">ğŸ“‹ DescriÃ§Ã£o/Resumo da Ata:</label>\n                <textarea id="descricaoAta" class="swal2-textarea" rows="3" \n                  placeholder="Descreva brevemente o conteÃºdo desta ata de julgamento..."\n                  style="width: 100%; min-height: 80px;">${i}</textarea>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">ğŸ“„ ConteÃºdo Completo da Ata:</label>\n                <textarea id="conteudoAta" class="swal2-textarea" rows="15" \n                  placeholder="Digite o conteÃºdo completo da ata de julgamento..."\n                  style="width: 100%; min-height: 400px; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.4;">${s}</textarea>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; margin: 10px 0; font-size: 12px;">\n                <strong>ğŸ’¡ Dicas:</strong>\n                <ul style="margin: 5px 0; padding-left: 20px;">\n                  <li>Use formataÃ§Ã£o clara e objetiva</li>\n                  <li>Inclua fundamentaÃ§Ã£o tÃ©cnica das decisÃµes</li>\n                  <li>Mencione todos os processos julgados</li>\n                  <li>Mantenha linguagem formal e tÃ©cnica</li>\n                </ul>\n              </div>\n            </div>\n          `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar AlteraÃ§Ãµes",cancelButtonText:"âŒ Cancelar",width:"90%",customClass:{container:"editor-ata-container"},preConfirm:()=>{const a=document.getElementById("descricaoAta").value.trim(),o=document.getElementById("conteudoAta").value.trim();return a?o?{descricao:a,conteudo:o}:(this.$swal.showValidationMessage("Por favor, preencha o conteÃºdo da ata"),!1):(this.$swal.showValidationMessage("Por favor, preencha a descriÃ§Ã£o da ata"),!1)}});if(r){const{error:t}=await N.ND.from("atas_julgamento").update({descricao:r.descricao,conteudo_ata:r.conteudo,atualizado_em:(new Date).toISOString(),progresso_elaboracao:Math.min(100,(o.progresso_elaboracao||0)+25)}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(t)throw t;await this.atualizarDadosAtas(),this.$swal({title:"âœ… Ata Atualizada!",text:`A ata ${e} foi atualizada com sucesso.`,icon:"success",timer:2e3,showConfirmButton:!1})}}catch(o){console.error("Erro ao editar ata:",o),this.$swal({title:"âŒ Erro ao Editar",text:`Erro ao editar ata: ${o.message}`,icon:"error"})}},gerarConteudoPadraoAta(a){const o=(new Date).toLocaleDateString("pt-BR"),t=a.numero||`ATA-CCL-${a.id}`;return`ATA DE JULGAMENTO ${t}\n\nDATA: ${o}\nCOMISSÃƒO DE COMPRA E LICITAÃ‡ÃƒO - CCL\n\nPROCESSOS ANALISADOS: ${a.total_processos||0}\n\n1. ABERTURA DA SESSÃƒO\nEm ${o}, reuniu-se a ComissÃ£o de Compra e LicitaÃ§Ã£o - CCL para anÃ¡lise e julgamento dos processos administrativos encaminhados pela ComissÃ£o de PadronizaÃ§Ã£o de Materiais - CPM.\n\n2. ANÃLISE DOS PROCESSOS\nOs membros da CCL procederam Ã  anÃ¡lise tÃ©cnica e legal dos processos administrativos, verificando:\n- Conformidade tÃ©cnica dos produtos/serviÃ§os\n- AdequaÃ§Ã£o Ã s especificaÃ§Ãµes estabelecidas\n- DocumentaÃ§Ã£o apresentada pelos fornecedores\n- Atendimento aos requisitos normativos aplicÃ¡veis\n\n3. DECISÃ•ES TOMADAS\n[Descrever aqui as decisÃµes especÃ­ficas para cada processo analisado]\n\n4. ENCAMINHAMENTOS\nOs processos aprovados sÃ£o encaminhados Ã  Autoridade Competente para homologaÃ§Ã£o final.\n\n5. ENCERRAMENTO\nNada mais havendo a ser tratado, foi encerrada a presente sessÃ£o.\n\nCCL - ComissÃ£o de Compra e LicitaÃ§Ã£o`},async visualizarAta(a){try{console.log("ğŸ‘ï¸ Visualizando ata completa:",a.id);const{data:o,error:t}=await N.ND.from("atas_julgamento").select("*").eq("id",a.id).eq("tenant_id",this.currentTenantId).single();if(t)throw console.error("Erro ao buscar ata completa:",t),t;console.log("âœ… Ata completa carregada:",o);let e=null;if(a.processo_completo)console.log("ğŸ‘ï¸ Usando dados do processo jÃ¡ carregados:",a.numero_processo),e=a.processo_completo;else if(o.processo_id){console.log("ğŸ”— Buscando processo especÃ­fico da ata:",o.processo_id);const a=await N.ND.from("processos_administrativos").select("numero_processo, objeto, ata_julgamento_ccl, id, tipo_processo, nome_orgao").eq("id",o.processo_id).eq("tenant_id",this.currentTenantId).single();a.error||(e=a.data)}let s="";e&&(s=`\n            <div style="background: #f5f5f5; padding: 10px; border-radius: 5px; margin: 10px 0;">\n              <h4>ğŸ“„ Processo Relacionado</h4>\n              <p><strong>NÃºmero:</strong> ${e.numero_processo}</p>\n              <p><strong>Objeto:</strong> ${(e.objeto||"").substring(0,100)}${e.objeto&&e.objeto.length>100?"...":""}</p>\n              <p><strong>Data Julgamento:</strong> ${this.formatDate(e.ata_emitida_ccl_em)}</p>\n            </div>\n            <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; margin: 10px 0;">\n              <h4>âš–ï¸ FundamentaÃ§Ã£o CCL</h4>\n              <p style="text-align: justify;">${e.ata_julgamento_ccl||"NÃ£o disponÃ­vel"}</p>\n            </div>\n          `),this.$swal({title:`ğŸ“„ VisualizaÃ§Ã£o da Ata - ${o.numero||`ATA-${String(o.id).slice(-4)}`}`,html:`\n            <div style="text-align: left; max-height: 600px; overflow-y: auto;">\n              \x3c!-- CabeÃ§alho da Ata --\x3e\n              <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #007bff;">\n                <h4 style="margin-top: 0;">ğŸ“‹ InformaÃ§Ãµes da Ata</h4>\n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">\n                  <div>\n                    <p><strong>NÃºmero:</strong> ${o.numero||`ATA-${String(o.id).slice(-4)}`}</p>\n                    <p><strong>Status:</strong> ${o.status_ata||"EM ELABORAÃ‡ÃƒO"}</p>\n                    <p><strong>Total Processos:</strong> ${o.total_processos||1}</p>\n                  </div>\n                  <div>\n                    <p><strong>PerÃ­odo:</strong> ${o.periodo||"N/A"}</p>\n                    <p><strong>Data PublicaÃ§Ã£o:</strong> ${this.formatDate(o.data_publicacao)}</p>\n                    <p><strong>Progresso:</strong> ${o.progresso_elaboracao||0}%</p>\n                  </div>\n                </div>\n                ${o.descricao?`<p><strong>DescriÃ§Ã£o:</strong> ${o.descricao}</p>`:""}\n              </div>\n\n              \x3c!-- ConteÃºdo da Ata Editado --\x3e\n              <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #28a745;">\n                <h4 style="margin-top: 0; color: #155724;">ğŸ“„ CONTEÃšDO DA ATA</h4>\n                <div style="background: white; padding: 15px; border-radius: 5px; white-space: pre-line; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.4; max-height: 300px; overflow-y: auto; border: 1px solid #dee2e6;">\n                  ${o.conteudo_ata||'ConteÃºdo da ata ainda nÃ£o foi editado. Use o botÃ£o "âœï¸ Continuar" para adicionar conteÃºdo.'}\n                </div>\n              </div>\n\n              \x3c!-- InformaÃ§Ãµes do Processo Relacionado --\x3e\n              ${s}\n              \n              \x3c!-- AÃ§Ãµes DisponÃ­veis --\x3e\n              <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">\n                <h4 style="margin-top: 0; color: #856404;">âš¡ AÃ§Ãµes DisponÃ­veis</h4>\n                <div style="display: flex; gap: 10px; flex-wrap: wrap;">\n                  <button onclick="window.editarAtaCompleta('${o.id}')" \n                          style="background: #007bff; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">\n                    âœï¸ Editar ConteÃºdo\n                  </button>\n                  ${e?`\n                    <button onclick="window.gerarPDFComAta('${o.id}', '${e.id}')" \n                            style="background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">\n                      ğŸ“„ Baixar PDF\n                    </button>\n                  `:""}\n                  <button onclick="window.finalizarAta('${o.id}')" \n                          style="background: #dc3545; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">\n                    ğŸ¯ Finalizar Ata\n                  </button>\n                </div>\n              </div>\n            </div>\n          `,icon:"info",confirmButtonText:"Fechar",width:"700px",didOpen:()=>{window.editarAtaCompleta=a=>{this.$swal.close(),this.editarAta(o)},window.gerarPDFComAta=async(a,t)=>{try{this.$swal.close(),e&&o&&await this.visualizarProcessoComAta(e,o)}catch(s){console.error("Erro ao gerar PDF:",s),this.$swal({title:"âŒ Erro",text:"Erro ao gerar PDF com ata.",icon:"error"})}},window.finalizarAta=a=>{this.$swal.close(),this.finalizarAtaElaboracao(o)}},willClose:()=>{delete window.editarAtaCompleta,delete window.gerarPDFComAta,delete window.finalizarAta}})}catch(o){console.error("Erro ao visualizar ata:",o),this.$swal({title:"ğŸ“„ Visualizar Ata",html:`\n            <div style="text-align: left;">\n              <p><strong>NÃºmero:</strong> ${a.numero||a.numero_ata||"N/A"}</p>\n              <p><strong>Status:</strong> ${a.status||"Em ElaboraÃ§Ã£o"}</p>\n              <p><strong>ObservaÃ§Ã£o:</strong> Use "ğŸ“„ Baixar PDF" para ver detalhes completos</p>\n            </div>\n          `,icon:"info",confirmButtonText:"Fechar"})}},async baixarAta(a){try{console.log("ğŸ“„ Gerando PDF para ata:",a.numero);const{data:o,error:t}=await N.ND.from("atas_julgamento").select("*").eq("id",a.id).eq("tenant_id",this.currentTenantId).single();t?console.error("Erro ao buscar ata completa:",t):o&&(console.log("âœ… Ata completa encontrada no banco:",o.numero),a={...a,...o});let e=null,s=[];if(a.processo_id){console.log("ğŸ”— Buscando processo especÃ­fico da ata:",a.processo_id);const o=await N.ND.from("processos_administrativos").select("*").eq("id",a.processo_id).eq("tenant_id",this.currentTenantId).single();o.error||(e=o.data,s=[e])}else if(a.processos_incluidos&&a.processos_incluidos.length>0){console.log("ğŸ”— Buscando processos consolidados da ata:",a.processos_incluidos);const o=await N.ND.from("processos_administrativos").select("*").in("id",a.processos_incluidos).eq("tenant_id",this.currentTenantId);!o.error&&o.data.length>0&&(s=o.data,e=s[0])}else{console.log("ğŸ” Fallback: Verificando produtos vinculados Ã  ata");const{data:o,error:t}=await N.ND.from("produtos").select("id, nome, marca, modelo").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId);if(!t&&o&&o.length>0){console.log("âœ… Encontrados",o.length,"produtos vinculados Ã  ata");const t=a.numero?.match(/(\d{3}\/\d{4})/);if(t){const a=t[1];console.log("ğŸ” Tentando buscar processo pelo nÃºmero extraÃ­do da ata:",a);const o=await N.ND.from("processos_administrativos").select("*").eq("numero_processo",a).eq("tenant_id",this.currentTenantId);!o.error&&o.data.length>0&&(s=o.data,e=s[0],console.log("âœ… Encontrado processo pelo nÃºmero da ata:",e.numero_processo))}}if(!e&&a.data_publicacao){console.log("ğŸ” Fallback 2: Buscando processos por data de publicaÃ§Ã£o");const o=new Date(a.data_publicacao);o.setHours(0,0,0,0);const t=new Date(a.data_publicacao);t.setHours(23,59,59,999);const i=await N.ND.from("processos_administrativos").select("*").eq("tenant_id",this.currentTenantId).eq("status","aprovado_ccl").gte("ata_emitida_ccl_em",o.toISOString()).lte("ata_emitida_ccl_em",t.toISOString());!i.error&&i.data.length>0&&(s=i.data,e=s[0],console.log("âœ… Encontrados processos por data:",s.map((a=>a.numero_processo))))}}if(!e||0===s.length)return console.log("âš ï¸ Gerando PDF apenas com dados da ata (sem processos)"),void await this.gerarPDFSomenteAta(a);this.$swal({title:"ğŸ“„ Gerar RelatÃ³rio com Ata",text:`Gerando relatÃ³rio completo ${s.length>1?`dos ${s.length} processos`:`do processo ${e.numero_processo}`} incluindo a Ata de Julgamento CCL...`,icon:"info",showCancelButton:!0,confirmButtonText:"ğŸ“„ Gerar PDF",cancelButtonText:"Cancelar"}).then((async o=>{o.isConfirmed&&await this.gerarRelatorioComAta(e,a,s)}))}catch(o){console.error("Erro ao buscar processo da ata:",o),this.$swal({title:"âŒ Erro",text:"Erro ao buscar dados do processo.",icon:"error"})}},async gerarRelatorioComAta(a,o,t=null){try{const e=t||[a];console.log("ğŸ“„ Gerando relatÃ³rio com Ata CCL para processo(s):",e.map((a=>a.numero_processo)).join(", ")),this.visualizarProcessoComAta(a,o,e)}catch(e){console.error("Erro ao gerar relatÃ³rio com ata:",e),this.$swal({title:"âŒ Erro ao Gerar RelatÃ³rio",text:`Erro: ${e.message}`,icon:"error"})}},async visualizarProcessoComAta(a,o){try{console.log("ğŸ“„ Gerando relatÃ³rio completo com Ata CCL (Fl. 003):",a.id,a.numero_processo);const s=await Promise.resolve().then(t.bind(t,3722)),i=s.default,r=await Promise.resolve().then(t.bind(t,6507)),n=await r.default.obterProcesso(a.id);let c=await r.default.listarDocumentosProcesso(a.id),l=[];if("padronizacao"===n.tipo_processo){l=await r.default.listarProdutosProcesso(a.id);const o=await r.default.getTenantId(),{data:t}=await N.ND.from("documentos_produtos_processo").select("*").eq("processo_id",a.id).eq("tenant_id",o);if(t&&t.length>0)for(const a of t)c.push({id:`produto_${a.id}`,tipo_documento:"DOCUMENTO_PRODUTO",nome_documento:`${a.nome_produto} - ${a.nome_arquivo}`,titulo:`${a.nome_produto} - ${a.nome_arquivo}`,descricao:`Documento tÃ©cnico do produto ${a.nome_produto}`,data_autuacao:a.created_at,arquivo_url:a.url_arquivo,nome_arquivo:a.nome_arquivo})}let d=null;try{const{data:o}=await N.ND.from("dfd_processo").select("*").eq("processo_id",a.id).single();d=o,console.log("âœ… DFD carregado do banco:",d)}catch(e){console.log("âš ï¸ DFD nÃ£o encontrado no banco, usando dados padrÃ£o"),d={justificativa:"Justificativa da necessidade conforme processo administrativo e demanda apresentada pelos setores solicitantes.",descricao_necessidade:"DescriÃ§Ã£o detalhada da necessidade identificada para padronizaÃ§Ã£o/despadronizaÃ§Ã£o dos produtos especificados.",criterios_aceitacao:"CritÃ©rios de aceitaÃ§Ã£o e ensaios estabelecidos conforme normas tÃ©cnicas aplicÃ¡veis.",observacoes_especiais:"ObservaÃ§Ãµes especiais e condiÃ§Ãµes especÃ­ficas do processo de avaliaÃ§Ã£o.",modelo_usado:"MODELO_1"}}const u=await i.methods.completarDocumentosProcesso.call({formatarData:this.formatarData,formatarStatus:this.formatarStatus,...i.methods},n,c,l,d),m={id:`ata_ccl_${o.id}`,tipo_documento:"ATA_JULGAMENTO_CCL",nome_documento:"Ata de Julgamento CCL",titulo:"ATA DE JULGAMENTO TÃ‰CNICO - CCL",descricao:`Ata de julgamento da CCL para o processo ${n.numero_processo}`,data_autuacao:o.data_publicacao||(new Date).toISOString(),numero_folha:3,conteudo_html:await this.gerarHTMLAtaCCLCompleta(n,o)},p=u.find((a=>1===a.numero_folha)),v=u.find((a=>2===a.numero_folha)),g=u.filter((a=>!a.numero_folha||a.numero_folha>2));let _=4;g.forEach((a=>{(!a.numero_folha||a.numero_folha>3)&&(a.numero_folha=_++)}));const h=[p,v,m,...g].filter(Boolean);console.log("ğŸ“„ Estrutura do PDF com Ata:",h.map((a=>({folha:a.numero_folha,tipo:a.tipo_documento,titulo:a.titulo}))));const f=i.methods.gerarHTMLRelatorio.call({formatarData:this.formatarData,formatarStatus:this.formatarStatus},n,h,l),C=new Blob([f],{type:"text/html"}),b=(URL.createObjectURL(C),n.numero_processo||n.id,(new Date).toISOString().split("T")[0],window.open("","_blank"));b.document.write(f),b.document.close(),setTimeout((()=>{if(b&&!b.closed){const a=b.document.createElement("div");a.id="download-controls",a.style.cssText="\n              position: fixed; \n              top: 10px; \n              right: 10px; \n              background: #fff; \n              border: 2px solid #dc3545; \n              border-radius: 8px; \n              padding: 15px; \n              box-shadow: 0 4px 8px rgba(0,0,0,0.2); \n              z-index: 9999;\n              display: flex;\n              gap: 10px;\n              font-family: Arial, sans-serif;\n            ";const o=b.document.createElement("button");o.innerHTML="ğŸ“„ Baixar PDF",o.style.cssText="\n              background: #dc3545; \n              color: white; \n              border: none; \n              padding: 8px 15px; \n              border-radius: 5px; \n              cursor: pointer;\n              font-weight: bold;\n            ",o.onclick=()=>{a.style.display="none",setTimeout((()=>{b.print(),setTimeout((()=>{a&&(a.style.display="flex")}),1e3)}),100)};const t=b.document.createElement("button");t.innerHTML="âŒ Fechar",t.style.cssText="\n              background: #6c757d; \n              color: white; \n              border: none; \n              padding: 8px 15px; \n              border-radius: 5px; \n              cursor: pointer;\n              font-weight: bold;\n            ",t.onclick=()=>b.close(),a.appendChild(o),a.appendChild(t),b.document.body.appendChild(a)}}),500),console.log("âœ… RelatÃ³rio com Ata CCL (Fl. 003) gerado com sucesso")}catch(e){console.error("âŒ Erro ao gerar relatÃ³rio com ata:",e),this.$swal({title:"âŒ Erro ao Gerar RelatÃ³rio",text:`Erro: ${e.message}`,icon:"error"})}},async gerarHTMLAtaCCLCompleta(a,o){const t=(new Date).toLocaleDateString("pt-BR"),e=(new Date).toLocaleTimeString("pt-BR");let s='\n        <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px; text-align: center;">\n          ğŸ“‹ Nenhum produto encontrado para este processo\n        </div>\n      ';try{const{data:o,error:t}=await N.ND.from("produtos").select("*").eq("processo_id",a.id).eq("tenant_id",this.currentTenantId);!t&&o&&o.length>0&&(s=`\n            <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">\n              <thead>\n                <tr style="background: #f8f9fa;">\n                  <th style="padding: 10px; border: 1px solid #ddd; text-align: left; font-weight: bold;">Produto</th>\n                  <th style="padding: 10px; border: 1px solid #ddd; text-align: left; font-weight: bold;">Marca/Modelo</th>\n                  <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: bold;">Status</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${o.map((a=>`\n                  <tr>\n                    <td style="padding: 10px; border: 1px solid #ddd;">${a.nome||"Produto nÃ£o especificado"}</td>\n                    <td style="padding: 10px; border: 1px solid #ddd;">${a.marca||"N/A"} ${a.modelo||""}</td>\n                    <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">\n                      <span style="background: #d4edda; color: #155724; padding: 4px 8px; border-radius: 4px; font-size: 10pt;">\n                        âœ… APROVADO\n                      </span>\n                    </td>\n                  </tr>\n                `)).join("")}\n              </tbody>\n            </table>\n            <div style="margin-top: 10px; padding: 10px; background: #d4edda; border-radius: 5px; font-size: 10pt; color: #155724;">\n              <strong>ğŸ“Š Resumo:</strong> ${o.length} produto(s) analisado(s) e aprovado(s) tecnicamente pela CCL\n            </div>\n          `)}catch(i){console.error("Erro ao buscar produtos para ata:",i)}return`\n        <div class="documento-pagina">\n          <div class="folha-numero">Fl. 003</div>\n          \n          <div class="documento-header">\n            <div class="brasao-header" style="text-align: center; margin-bottom: 30px;">\n              <h1 style="font-size: 16pt; margin: 0; color: #1a1a1a;">${a.nome_orgao||"Ã“RGÃƒO ADMINISTRATIVO"}</h1>\n              <h2 style="font-size: 14pt; margin: 5px 0 0 0; color: #333;">COMISSÃƒO CENTRAL DE LICITAÃ‡ÃƒO - CCL</h2>\n              <h3 style="font-size: 12pt; margin: 5px 0 0 0; color: #666;">Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021</h3>\n            </div>\n            \n            <div class="linha-decorativa" style="border-top: 2px solid #333; margin: 20px 0;"></div>\n            \n            <h2 style="text-align: center; font-size: 14pt; margin: 20px 0; text-transform: uppercase; font-weight: bold;">\n              ATA DE JULGAMENTO TÃ‰CNICO - CCL\n            </h2>\n          </div>\n\n          <div class="documento-content" style="font-size: 11pt; line-height: 1.6;">\n            \n            <div class="secao-identificacao" style="margin-bottom: 25px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                1. IDENTIFICAÃ‡ÃƒO DO PROCESSO\n              </h3>\n              <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; width: 30%; font-weight: bold; background: #f8f9fa;">NÃºmero do Processo:</td>\n                  <td style="padding: 8px;">${a.numero_processo}</td>\n                </tr>\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">Ã“rgÃ£o Solicitante:</td>\n                  <td style="padding: 8px;">${a.nome_orgao||"NÃ£o informado"}</td>\n                </tr>\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">Tipo de Processo:</td>\n                  <td style="padding: 8px;">${"padronizacao"===a.tipo_processo?"PadronizaÃ§Ã£o":"DespadronizaÃ§Ã£o"}</td>\n                </tr>\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">Data de Julgamento:</td>\n                  <td style="padding: 8px;">${this.formatDate(a.ata_emitida_ccl_em||new Date)}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">Ata CCL NÃºmero:</td>\n                  <td style="padding: 8px;">${o.numero_ata||o.numero||"N/A"}</td>\n                </tr>\n              </table>\n            </div>\n            \n            <div class="secao-objeto" style="margin-bottom: 25px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                2. OBJETO DO PROCESSO\n              </h3>\n              <div style="text-align: justify; padding: 15px; background: #f9f9f9; border-left: 4px solid #007bff;">\n                ${a.objeto||"Objeto nÃ£o especificado"}\n              </div>\n            </div>\n            \n            <div class="secao-decisao" style="margin-bottom: 25px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                3. DECISÃƒO DA CCL\n              </h3>\n              <div style="text-align: center; padding: 20px; background: #d4edda; border: 2px solid #28a745; border-radius: 8px; margin: 15px 0;">\n                <h4 style="font-size: 13pt; color: #155724; margin: 0; font-weight: bold;">\n                  âœ… PROCESSO APROVADO TECNICAMENTE\n                </h4>\n              </div>\n              <table style="width: 100%; border-collapse: collapse;">\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; width: 30%; font-weight: bold; background: #f8f9fa;">Status Final:</td>\n                  <td style="padding: 8px; color: #28a745; font-weight: bold;">APROVADO CCL</td>\n                </tr>\n                <tr style="border-bottom: 1px solid #ddd;">\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">Data da DecisÃ£o:</td>\n                  <td style="padding: 8px;">${t} - ${e}</td>\n                </tr>\n                <tr>\n                  <td style="padding: 8px; font-weight: bold; background: #f8f9fa;">PrÃ³xima Etapa:</td>\n                  <td style="padding: 8px;">Assessoria JurÃ­dica para anÃ¡lise legal</td>\n                </tr>\n              </table>\n            </div>\n            \n            <div class="secao-produtos" style="margin-bottom: 25px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                4. PRODUTOS ANALISADOS\n              </h3>\n              <div id="lista-produtos-ata" style="margin-bottom: 15px;">\n                ${s}\n              </div>\n            </div>\n            \n            <div class="secao-fundamentacao" style="margin-bottom: 25px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                5. FUNDAMENTAÃ‡ÃƒO TÃ‰CNICA DA CCL\n              </h3>\n              <div style="text-align: justify; padding: 15px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px;">\n                ${a.ata_julgamento_ccl||a.fundamentacao_tecnica_ccl||`\n                  A ComissÃ£o Central de LicitaÃ§Ã£o, apÃ³s anÃ¡lise tÃ©cnica detalhada do processo administrativo, \n                  considerando os aspectos tÃ©cnicos, normativos e de conformidade, deliberou pela aprovaÃ§Ã£o \n                  do presente processo de ${"padronizacao"===a.tipo_processo?"padronizaÃ§Ã£o":"despadronizaÃ§Ã£o"}.\n                  <br><br>\n                  A decisÃ£o foi baseada na avaliaÃ§Ã£o dos documentos apresentados, verificaÃ§Ã£o da adequaÃ§Ã£o \n                  tÃ©cnica dos produtos e conformidade com as especificaÃ§Ãµes estabelecidas no processo administrativo.\n                  <br><br>\n                  O processo atende aos requisitos tÃ©cnicos e normativos aplicÃ¡veis, estando apto para \n                  prosseguimento na tramitaÃ§Ã£o administrativa.\n                `}\n              </div>\n            </div>\n            \n            <div class="secao-proximos-passos" style="margin-bottom: 30px;">\n              <h3 style="font-size: 12pt; font-weight: bold; margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 5px;">\n                6. ENCAMINHAMENTOS\n              </h3>\n              <ol style="margin: 0; padding-left: 20px;">\n                <li style="margin-bottom: 10px;"><strong>Assessoria JurÃ­dica:</strong> Para anÃ¡lise da conformidade legal do processo</li>\n                <li style="margin-bottom: 10px;"><strong>Ã“rgÃ£o ResponsÃ¡vel:</strong> Para acompanhamento da tramitaÃ§Ã£o</li>\n                <li style="margin-bottom: 10px;"><strong>CPM:</strong> Para controle e registro da decisÃ£o</li>\n                <li style="margin-bottom: 10px;"><strong>Sistema:</strong> AtualizaÃ§Ã£o automÃ¡tica do status do processo</li>\n              </ol>\n            </div>\n            \n            <div class="secao-assinaturas" style="margin-top: 40px;">\n              <table style="width: 100%; border-collapse: collapse;">\n                <tr>\n                  <td style="text-align: center; padding: 30px 10px; border-top: 1px solid #000; width: 50%;">\n                    <strong>COMISSÃƒO CENTRAL DE LICITAÃ‡ÃƒO</strong><br>\n                    <small>Data: ${t}</small>\n                  </td>\n                  <td style="text-align: center; padding: 30px 10px; border-top: 1px solid #000; width: 50%;">\n                    <strong>SISTEMA COMPRAR BEM</strong><br>\n                    <small>Gerado automaticamente</small>\n                  </td>\n                </tr>\n              </table>\n            </div>\n            \n            <div class="rodape-ata" style="margin-top: 30px; font-size: 9pt; color: #666; text-align: center; border-top: 1px solid #ddd; padding-top: 15px;">\n              <p><strong>Sistema de PrÃ©-QualificaÃ§Ã£o de Bens</strong> | Lei nÂº 14.133/2021 | Processo ${a.numero_processo}</p>\n              <p>Documento gerado automaticamente em ${t} Ã s ${e}</p>\n            </div>\n          </div>\n        </div>\n      `},gerarHTMLAtaCCL(a,o){return`\n        <div class="documento-header">\n          <h1>${a.nome_orgao||"Ã“rgÃ£o Administrativo"}</h1>\n          <h2>ATA DE JULGAMENTO TÃ‰CNICO - CCL</h2>\n          <p>Processo nÂº ${a.numero_processo}</p>\n        </div>\n\n        <div class="documento-content">\n          <h3>IDENTIFICAÃ‡ÃƒO DO PROCESSO</h3>\n          <p><strong>NÃºmero do Processo:</strong> ${a.numero_processo}</p>\n          <p><strong>Objeto:</strong> ${a.objeto}</p>\n          <p><strong>Data do Julgamento CCL:</strong> ${this.formatDate(a.ata_emitida_ccl_em||new Date)}</p>\n          \n          <h3>DECISÃƒO DA CCL</h3>\n          <p><strong>DecisÃ£o:</strong> APROVADO TECNICAMENTE</p>\n          <p><strong>Ata NÃºmero:</strong> ${o.numero||"N/A"}</p>\n          <p><strong>Data de PublicaÃ§Ã£o:</strong> ${this.formatDate(o.dataPublicacao||new Date)}</p>\n          \n          <h3>FUNDAMENTAÃ‡ÃƒO TÃ‰CNICA</h3>\n          <div style="text-align: justify; margin: 20px 0;">\n            ${a.ata_julgamento_ccl||"FundamentaÃ§Ã£o tÃ©cnica da decisÃ£o CCL."}\n          </div>\n          \n          <h3>PRÃ“XIMOS PASSOS</h3>\n          <p>O processo segue para anÃ¡lise da Assessoria JurÃ­dica conforme fluxo estabelecido.</p>\n          \n          <div style="margin-top: 40px; text-align: center;">\n            <p><strong>ComissÃ£o Central de LicitaÃ§Ã£o - CCL</strong></p>\n            <p>Data: ${this.formatDate(new Date)}</p>\n          </div>\n        </div>\n      `},async obterProcessoCompleto(a){try{const{default:o}=await Promise.resolve().then(t.bind(t,6507));return await o.obterProcesso(a)}catch(o){return console.error("Erro ao obter processo completo:",o),null}},getStatusRecursoClass(a){switch(a){case"Em prazo recursal":return"status-recurso-prazo";case"Sem recursos":return"status-sem-recursos";case"Com recursos":return"status-com-recursos";default:return"status-indefinido"}},async obterTenantId(){try{if(this.currentTenantId)return this.currentTenantId;const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)return void console.error("UsuÃ¡rio nÃ£o estÃ¡ autenticado");let t=null;if(o.user_metadata?.tenant_id)t=o.user_metadata.tenant_id;else{const{data:a,error:e}=await N.ND.from("usuarios").select("tenant_id").eq("email",o.email).single();if(e)return void console.error("Erro ao buscar tenant_id:",e);t=a?.tenant_id}return t&&t!==this.currentTenantId?this.currentTenantId=t:t||console.error("Tenant ID nÃ£o encontrado para o usuÃ¡rio"),t}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarCategorias(){try{const{data:a,error:o}=await N.ND.from("categorias").select("*");if(o)throw o;this.categorias=a||[]}catch(a){console.error("Erro ao carregar categorias:",a)}},getCategoriaName(a){const o=this.categorias.find((o=>o.id===a));return o?o.nome:"Categoria nÃ£o encontrada"},async carregarDados(a=!1){try{if(this.isLoadingData&&!a)return void console.log("ğŸ”„ [DEBUG CCL] JÃ¡ carregando dados, ignorando chamada duplicada");if(this.loading=!0,this.isLoadingData=!0,!this.currentTenantId)return console.error("Tenant ID nÃ£o disponÃ­vel"),this.loading=!1,void(this.isLoadingData=!1);if(!a&&this.processosPendentesArray.length>0)return console.log("ğŸ”„ [DEBUG CCL] Dados jÃ¡ carregados, usando cache"),this.loading=!1,void(this.isLoadingData=!1);console.log("ğŸ” [DEBUG CCL] Iniciando busca de processos..."),console.log("ğŸ” [DEBUG CCL] Tenant ID:",this.currentTenantId);const{data:o,error:t}=await N.ND.from("processos_administrativos").select("id, numero_processo, status, tipo_processo, tenant_id").eq("tenant_id",this.currentTenantId).order("atualizado_em",{ascending:!1});if(t)throw console.error("âŒ [DEBUG CCL] Erro ao buscar todos os processos:",t),t;console.log("ğŸ“Š [DEBUG CCL] TODOS os processos do tenant:",o?.length||0),o?.forEach((a=>{console.log(`ğŸ“‹ [DEBUG CCL] Processo: ${a.numero_processo} - Status: ${a.status} - Tipo: ${a.tipo_processo}`)}));const e=(o||[]).filter((a=>"julgamento_ccl"===a.status));if(console.log("ğŸ¯ [DEBUG CCL] Status filtrados para CCL:",["julgamento_ccl"]),console.log("ğŸ¯ [DEBUG CCL] Processos que deveriam aparecer:"),o?.forEach((a=>{"julgamento_ccl"===a.status?console.log(`âœ… DEVE APARECER: ${a.numero_processo} - Status: ${a.status}`):console.log(`âŒ NÃƒO APARECE: ${a.numero_processo} - Status: ${a.status}`)})),console.log("ğŸ¯ [DEBUG CCL] Processos FILTRADOS para CCL:",e.length),e.forEach((a=>{console.log(`âœ… [DEBUG CCL] Processo para CCL: ${a.numero_processo} - Status: ${a.status}`)})),console.log("ğŸ“Š CCL Dashboard - Processos encontrados:",e?.length||0),e?.forEach((a=>{console.log(`ğŸ“‹ Processo ${a.numero_processo} - Status: ${a.status} - Tipo: ${a.tipo_processo}`)})),e.length>0){const a=e.map((a=>a.id)),{data:o,error:t}=await N.ND.from("processos_administrativos").select("*").in("id",a).eq("tenant_id",this.currentTenantId);t?(console.error("âŒ [DEBUG CCL] Erro ao buscar dados completos:",t),this.processosPendentesArray=[]):(this.processosPendentesArray=Array.isArray(o)?o:[],console.log("âœ… [DEBUG CCL] Dados completos carregados:",this.processosPendentesArray.length))}else console.log("âš ï¸ [DEBUG CCL] Nenhum processo filtrado encontrado"),this.processosPendentesArray=[];await this.carregarRecursos(),this.recursos||(this.recursos=[]),console.log("ğŸ” [DEBUG CCL] Iniciando contagem por status..."),console.log("ğŸ” [DEBUG CCL] Tenant ID:",this.currentTenantId);const s=await Promise.all([this.contarPorStatus(["aprovado","reprovado"]),this.contarPorStatus(["julgado_aprovado","julgado_reprovado"]),this.contarPorStatus("homologado")]);console.log("ğŸ” [DEBUG CCL] Stats counts:",s);const i=Array.isArray(this.processosPendentes)?this.processosPendentes:[];this.pendentes=s[0]||i.filter((a=>"julgamento_ccl"===a.status)).length,this.aprovados=s[1]||i.filter((a=>"julgado_ccl"===a.status)).length,this.homologados=s[2],console.log("ğŸ” [DEBUG CCL] Contadores finais:"),console.log("- Pendentes:",this.pendentes),console.log("- Aprovados:",this.aprovados),console.log("- Homologados:",this.homologados),this.recursosEmAnalise=this.recursos.filter((a=>"EM ANÃLISE"===a.status||"AGUARDANDO CPM"===a.status)).length,console.log("- Recursos em anÃ¡lise:",this.recursosEmAnalise),this.atualizarTotalPaginacao("processosPendentes",this.processosPendentesArray.length),this.atualizarTotalPaginacao("recursosAnalise",this.recursos.length)}catch(o){console.error("Erro ao carregar dados:",o)}finally{this.loading=!1,this.isLoadingData=!1}},async contarPorStatus(a){if(!this.currentTenantId)return console.warn("ğŸ” [DEBUG CCL] Sem tenant ID para contar status:",a),0;console.log("ğŸ” [DEBUG CCL] Contando status:",a,"para tenant:",this.currentTenantId);let o=N.ND.from("processos_administrativos").select("id",{count:"exact"}).eq("tenant_id",this.currentTenantId);o=Array.isArray(a)?o.in("status",a):o.eq("status",a);const{count:t,error:e}=await o;return e?(console.error(`ğŸ” [DEBUG CCL] Erro ao contar produtos ${a}:`,e),0):(console.log(`ğŸ” [DEBUG CCL] Resultado contagem ${a}:`,t),t||0)},formatDate(a){if(!a)return"";if(a instanceof Date)return a.toLocaleDateString("pt-BR");const o=String(a);if(o.includes("T")){const a=new Date(o);return a.toLocaleDateString("pt-BR")}if(o.includes("-")){const a=o.split("-");if(3===a.length)return`${a[2]}/${a[1]}/${a[0]}`}const t=new Date(o);return isNaN(t.getTime())?o:t.toLocaleDateString("pt-BR")},formatarStatus(a){switch(a){case"pendente":return"Em avaliaÃ§Ã£o";case"aprovado":return"Em DiligÃªncia";case"reprovado":return"Em AnÃ¡lise";case"diligencia":return"Em diligÃªncia";default:return a}},formatarStatusCPM(a){switch(a){case"aprovado":return"FavorÃ¡vel";case"julgado_aprovado":return"Julgado FavorÃ¡vel";case"julgado_reprovado":return"Julgado DesfavorÃ¡vel";case"homologado":return"Homologado";case"reprovado":return"DesfavorÃ¡vel";case"diligencia":return"Com DiligÃªncia";case"pendente":return"Em AnÃ¡lise";default:return a}},formatarStatusProcesso(a){switch(a){case"assinado_admin":return"Pronto para Julgamento";case"julgamento_ccl":return"Em Julgamento pela CCL";case"ata_ccl":return"Ata de Julgamento CCL";case"aprovado_ccl":return"Aprovado pela CCL";case"ata_julgamento_ccl_aprovacao":return"Ata de Julgamento Emitida - Recomenda AprovaÃ§Ã£o";case"ata_julgamento_ccl_rejeicao":return"Ata de Julgamento Emitida - Recomenda RejeiÃ§Ã£o";case"diligencia_ccl":return"DiligÃªncia CCL";case"homologado":return"Homologado pela Autoridade Competente";case"indeferido":return"Indeferido pela Autoridade Competente";case"tramitando_ccl":return"Em AnÃ¡lise CCL";default:return a}},getTipoProcessoClass(a){switch(a){case"PadronizaÃ§Ã£o":return"tipo-padronizacao";case"DespadronizaÃ§Ã£o":return"tipo-despadronizacao";default:return"tipo-default"}},async visualizarProcesso(a){try{console.log("ğŸ“„ Visualizando processo na CCL:",a.id,a.numero_processo);const o=await Promise.resolve().then(t.bind(t,3722)),e=o.default;await e.methods.gerarRelatorio.call({formatarData:this.formatarData,formatarStatus:this.formatarStatus,...e.methods},a)}catch(o){console.error("Erro ao visualizar processo:",o),alert(`Erro ao gerar relatÃ³rio: ${o.message}`)}},formatarData(a){return a?new Date(a).toLocaleDateString("pt-BR"):"N/A"},async tramitarProcessoAdministrativo(a){try{const o=confirm(`âš–ï¸ TRAMITAR PROCESSO PARA JULGAMENTO\n\nProcesso: ${a.numero_processo}\nStatus atual: Assinado pelo Ã“rgÃ£o Administrativo\nPrÃ³ximo status: Em Julgamento pela CCL\n\nConfirma a tramitaÃ§Ã£o?`);if(!o)return;console.log("ğŸš€ Tramitando processo para julgamento CCL:",a.id),console.log("ğŸ“Š Status atual do processo:",a.status),console.log("ğŸ“Š Tipo do processo:",a.tipo_processo);const t=await et.A.enviarProcesso(a.id,"Processo tramitado para julgamento da CCL");if(console.log("ğŸ“Š Resultado da tramitaÃ§Ã£o:",t),!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o do processo");this.$swal({title:"âœ… Processo Tramitado!",text:`O processo ${a.numero_processo} foi tramitado para julgamento da CCL com sucesso.`,icon:"success"}),await this.carregarDados(!0)}catch(o){console.error("Erro ao tramitar processo:",o),this.$swal({title:"âŒ Erro na TramitaÃ§Ã£o",text:`Erro ao tramitar processo: ${o.message}`,icon:"error"})}},async julgarProcessoAdministrativo(a){try{const{value:o}=await this.$swal({title:`ğŸ“‹ Emitir Ata de Julgamento - Processo ${a.numero_processo}`,html:`\n            <div style="text-align: left; padding: 15px; max-height: 70vh; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 10px 0;">ğŸ“„ Dados do Processo</h4>\n                <p><strong>NÃºmero:</strong> ${a.numero_processo}</p>\n                <p><strong>Tipo:</strong> ${a.tipo_processo||"PrÃ©-qualificaÃ§Ã£o de Bens"}</p>\n                <p><strong>Data de AutuaÃ§Ã£o:</strong> ${this.formatDate(a.criado_em)}</p>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">\n                  ğŸ“‹ RecomendaÃ§Ã£o da CCL para a Autoridade Competente:\n                  <span style="color: red;">*</span>\n                </label>\n                <select id="recomendacaoProcesso" class="swal2-select" style="width: 100%; padding: 8px;">\n                  <option value="">Selecione a recomendaÃ§Ã£o...</option>\n                  <option value="recomendar_homologacao">âœ… Recomendar HomologaÃ§Ã£o</option>\n                  <option value="recomendar_indeferimento">âŒ Recomendar Indeferimento</option>\n                  <option value="solicitar_diligencia">ğŸ“„ Solicitar DiligÃªncia Ã  CPM</option>\n                </select>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">\n                  ğŸ” FundamentaÃ§Ã£o Legal:\n                  <span style="color: red;">*</span>\n                </label>\n                <textarea id="fundamentacaoLegal" class="swal2-textarea" rows="3" placeholder="Base legal da decisÃ£o (Ex: Art. 78, Â§ 2Âº da Lei 14.133/2021 c/c Regulamento Interno...)" style="width: 100%; padding: 8px;"></textarea>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">\n                  ğŸ“ AnÃ¡lise TÃ©cnica da CCL:\n                  <span style="color: red;">*</span>\n                </label>\n                <textarea id="fundamentacaoProcesso" class="swal2-textarea" rows="6" placeholder="Descreva a anÃ¡lise tÃ©cnica detalhada realizada pela CCL sobre o trabalho da CPM, incluindo a verificaÃ§Ã£o da regularidade dos procedimentos, anÃ¡lise da documentaÃ§Ã£o apresentada, e avaliaÃ§Ã£o dos pareceres tÃ©cnicos..." style="width: 100%; padding: 8px;"></textarea>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">\n                  ğŸ’¡ ConsideraÃ§Ãµes Adicionais:\n                </label>\n                <textarea id="consideracoesAdicionais" class="swal2-textarea" rows="3" placeholder="ObservaÃ§Ãµes adicionais da CCL (se houver)..." style="width: 100%; padding: 8px;"></textarea>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h5 style="margin: 0 0 10px 0; color: #2e7d32;">ğŸ“‹ Fluxo da Ata de Julgamento:</h5>\n                <ol style="margin: 0; padding-left: 20px; font-size: 13px;">\n                  <li>CCL elabora Ata de Julgamento com anÃ¡lise tÃ©cnica completa</li>\n                  <li>Ata Ã© salva em formato Word e posteriormente em PDF</li>\n                  <li>Documento Ã© assinado eletronicamente por todos os membros da CCL</li>\n                  <li>Ata Ã© anexada ao processo administrativo</li>\n                  <li>Processo Ã© encaminhado Ã  Autoridade Competente para decisÃ£o final</li>\n                </ol>\n              </div>\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px;">\n                <small><strong>âš ï¸ Importante:</strong> A CCL elabora a Ata de Julgamento com recomendaÃ§Ã£o tÃ©cnica. A decisÃ£o final de homologar ou indeferir Ã© competÃªncia exclusiva da Autoridade Competente.</small>\n              </div>\n            </div>\n          `,width:"90%",maxWidth:"800px",heightAuto:!1,customClass:{container:"swal2-container-modal",popup:"swal2-popup-modal"},showCancelButton:!0,confirmButtonText:"ğŸ“‹ Emitir Ata de Julgamento",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("recomendacaoProcesso").value,o=document.getElementById("fundamentacaoProcesso").value.trim(),t=document.getElementById("fundamentacaoLegal").value.trim(),e=document.getElementById("consideracoesAdicionais").value.trim();return a?t?o?{recomendacao:a,fundamentacao:o,fundamentacaoLegal:t,consideracoesAdicionais:e}:(this.$swal.showValidationMessage("A anÃ¡lise tÃ©cnica da CCL Ã© obrigatÃ³ria"),!1):(this.$swal.showValidationMessage("A fundamentaÃ§Ã£o legal Ã© obrigatÃ³ria"),!1):(this.$swal.showValidationMessage("Selecione uma recomendaÃ§Ã£o"),!1)}});if(!o)return;let t;switch(o.recomendacao){case"recomendar_homologacao":t="ata_julgamento_ccl_homologacao";break;case"recomendar_indeferimento":t="ata_julgamento_ccl_indeferimento";break;case"solicitar_diligencia":t="diligencia_ccl";break}console.log("ğŸ” DEBUG JULGAMENTO:"),console.log("- RecomendaÃ§Ã£o escolhida:",o.recomendacao),console.log("- Novo status definido:",t),console.log("- ID do processo:",a.id);const{error:e}=await N.ND.from("processos_administrativos").update({status:t,ata_julgamento_ccl:o.fundamentacao,recomendacao_ccl:o.recomendacao,fundamentacao_legal_ccl:o.fundamentacaoLegal,consideracoes_adicionais_ccl:o.consideracoesAdicionais,ata_emitida_ccl_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()}).eq("id",a.id);if(e)throw e;console.log("âœ… Status atualizado no banco para:",t);const{data:s}=await N.ND.from("processos_administrativos").select("status, numero_processo").eq("id",a.id).single();console.log("ğŸ” Status verificado no banco:",s),await this.carregarDados(!0),this.$swal({title:"ğŸ“‹ Ata de Julgamento Emitida!",text:`A Ata de Julgamento do processo ${a.numero_processo} foi criada com sucesso. O processo serÃ¡ encaminhado Ã  Autoridade Competente para decisÃ£o final.`,icon:"success"})}catch(o){console.error("Erro ao julgar processo:",o),this.$swal({title:"âŒ Erro",text:`Erro ao registrar julgamento: ${o.message}`,icon:"error"})}},async emitirAtaJulgamento(a){try{const{value:o}=await this.$swal({title:`ğŸ“‹ Emitir Ata de Julgamento - Processo ${a.numeroAta}`,html:`\n            <div style="text-align: left; padding: 15px;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 10px 0;">ğŸ“„ Dados do Processo</h4>\n                <p><strong>Ata:</strong> ${a.numeroAta}</p>\n                <p><strong>Produtos:</strong> ${a.totalProdutos}</p>\n                <p><strong>Data do Julgamento CCL:</strong> ${this.formatDate(a.dataJulgamento)}</p>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">RecomendaÃ§Ã£o da CCL para a Autoridade Competente:</label>\n                <select id="recomendacaoAta" class="swal2-select" style="width: 100%;">\n                  <option value="">Selecione a recomendaÃ§Ã£o...</option>\n                  <option value="recomendar_homologacao">ğŸ“‹ Recomendar HomologaÃ§Ã£o do Processo</option>\n                  <option value="recomendar_indeferimento">ğŸ“‹ Recomendar Indeferimento do Processo</option>\n                  <option value="solicitar_esclarecimentos">ğŸ“‹ Solicitar Esclarecimentos Adicionais</option>\n                </select>\n              </div>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">FundamentaÃ§Ã£o TÃ©cnica da CCL:</label>\n                <textarea id="fundamentacaoAta" class="swal2-textarea" rows="6" placeholder="Descreva a anÃ¡lise tÃ©cnica completa que serÃ¡ incluÃ­da na Ata de Julgamento..." style="width: 100%;"></textarea>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h5 style="margin: 0 0 10px 0; color: #2e7d32;">ğŸ“‹ Fluxo da Ata de Julgamento:</h5>\n                <ol style="margin: 0; padding-left: 20px; font-size: 13px;">\n                  <li>CCL elabora Ata com anÃ¡lise tÃ©cnica e recomendaÃ§Ã£o</li>\n                  <li>Ata Ã© salva em formato Word e PDF</li>\n                  <li>Documento Ã© assinado eletronicamente pelos membros da CCL</li>\n                  <li>Ata Ã© anexada ao processo administrativo</li>\n                  <li>Processo Ã© remetido Ã  Autoridade Competente para decisÃ£o final</li>\n                </ol>\n              </div>\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px;">\n                <small><strong>âš ï¸ Importante:</strong> A CCL elabora a Ata com recomendaÃ§Ã£o tÃ©cnica. A decisÃ£o final de homologar ou indeferir Ã© competÃªncia exclusiva da Autoridade Competente.</small>\n              </div>\n            </div>\n          `,width:"700px",showCancelButton:!0,confirmButtonText:"ğŸ“‹ Emitir Ata de Julgamento",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("recomendacaoAta").value,o=document.getElementById("fundamentacaoAta").value.trim();return a?o?{recomendacao:a,fundamentacao:o}:(this.$swal.showValidationMessage("A fundamentaÃ§Ã£o tÃ©cnica Ã© obrigatÃ³ria"),!1):(this.$swal.showValidationMessage("Selecione uma recomendaÃ§Ã£o"),!1)}});if(!o)return;this.$swal({title:"ğŸ“‹ Ata de Julgamento Emitida!",html:`\n            <div style="text-align: left; padding: 15px;">\n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 10px 0; color: #2e7d32;">âœ… Ata Criada com Sucesso</h4>\n                <p><strong>Processo:</strong> ${a.numeroAta}</p>\n                <p><strong>RecomendaÃ§Ã£o:</strong> ${o.recomendacao.replace("recomendar_","").replace("_"," ").toUpperCase()}</p>\n                <p><strong>Status:</strong> Aguardando assinatura eletrÃ´nica dos membros da CCL</p>\n              </div>\n              \n              <div style="background: #d1ecf1; padding: 15px; border-radius: 8px;">\n                <h5 style="margin: 0 0 10px 0; color: #0277bd;">ğŸ“‹ PrÃ³ximos Passos:</h5>\n                <ol style="margin: 0; padding-left: 20px; font-size: 13px;">\n                  <li>Ata serÃ¡ disponibilizada para assinatura eletrÃ´nica</li>\n                  <li>ApÃ³s assinatura, serÃ¡ salva como PDF</li>\n                  <li>Processo serÃ¡ encaminhado Ã  Autoridade Competente</li>\n                  <li>Autoridade decidirÃ¡ pela homologaÃ§Ã£o ou indeferimento</li>\n                </ol>\n              </div>\n            </div>\n          `,icon:"success",confirmButtonText:"âœ… Entendido"}),await this.carregarDados(!0)}catch(o){console.error("Erro ao emitir ata de julgamento:",o),this.$swal({title:"âŒ Erro",text:`Erro ao emitir ata de julgamento: ${o.message}`,icon:"error"})}},async julgarProcessoCCL(a){try{const{value:o}=await this.$swal({title:`âš–ï¸ Julgamento CCL - ${a.numeroAta}`,html:`\n            <div style="text-align: left; padding: 10px; max-width: 100%; box-sizing: border-box;">\n              <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 8px 0; font-size: 16px;">ğŸ“„ Resumo do Processo</h4>\n                <p style="margin: 5px 0; word-wrap: break-word;"><strong>Ata:</strong> ${a.numeroAta}</p>\n                <p style="margin: 5px 0;"><strong>Produtos:</strong> ${a.totalProdutos}</p>\n                <p style="margin: 5px 0;"><strong>Data Julgamento CCL:</strong> ${this.formatDate(a.dataJulgamento)}</p>\n                <p style="margin: 5px 0; word-wrap: break-word;"><strong>RecomendaÃ§Ã£o da CCL:</strong> <span style="color: #2e7d32; font-weight: bold;">${a.decisaoCCL}</span></p>\n              </div>\n              \n              <div style="margin-bottom: 12px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px;">DecisÃ£o da CCL:</label>\n                <select id="decisaoCCL" class="swal2-select" style="width: 100%; box-sizing: border-box;">\n                  <option value="">Selecione a decisÃ£o...</option>\n                  <option value="homologar">âœ… APROVAR - Recomendar aprovaÃ§Ã£o do processo</option>\n                  <option value="diligencia">ğŸ“„ DILIGÃŠNCIA - Solicitar correÃ§Ãµes/esclarecimentos</option>\n                </select>\n              </div>\n              \n              <div style="margin-bottom: 12px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px;">Parecer TÃ©cnico da CCL:</label>\n                <textarea id="parecerCCL" class="swal2-textarea" rows="5" \n                  placeholder="Fundamente tecnicamente sua decisÃ£o..." \n                  style="width: 100%; box-sizing: border-box; resize: vertical;"></textarea>\n              </div>\n              \n              <div style="background: #e3f2fd; padding: 12px; border-radius: 8px; margin-bottom: 12px;">\n                <h5 style="margin: 0 0 8px 0; color: #1976d2; font-size: 14px;">âš–ï¸ Efeitos da DecisÃ£o:</h5>\n                <div style="font-size: 12px; line-height: 1.4;">\n                  <p style="margin: 3px 0;"><strong>âœ… HOMOLOGAÃ‡ÃƒO:</strong> Processo aprovado, DCBs serÃ£o emitidas</p>\n                  <p style="margin: 3px 0;"><strong>âŒ INDEFERIMENTO:</strong> Processo rejeitado, fornecedores notificados</p>\n                  <p style="margin: 3px 0;"><strong>ğŸ“„ DILIGÃŠNCIA:</strong> Processo retorna para anÃ¡lise complementar</p>\n                </div>\n              </div>\n              \n              <div style="background: #fff3cd; padding: 8px; border-radius: 4px;">\n                <small style="font-size: 12px;"><strong>âš ï¸ Importante:</strong> Esta Ã© a decisÃ£o final da Autoridade Competente sobre a recomendaÃ§Ã£o tÃ©cnica emitida pela CCL.</small>\n              </div>\n            </div>\n          `,width:"750px",maxWidth:"92vw",showCancelButton:!0,confirmButtonText:"âš–ï¸ Confirmar Julgamento",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("decisaoCCL").value,o=document.getElementById("parecerCCL").value.trim();return a?o?{decisao:a,parecer:o}:(this.$swal.showValidationMessage("O parecer tÃ©cnico Ã© obrigatÃ³rio"),!1):(this.$swal.showValidationMessage("Selecione uma decisÃ£o"),!1)}});if(!o)return;const t=await et.A.enviarProcesso(a.id,`CCL julgou processo: ${o.decisao.toUpperCase()} - ${o.parecer}`);if(!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o do processo");let e,s,i,r;switch(o.decisao){case"homologar":e="âœ… CCL Aprovou o Processo!",s="success",i="#2e7d32",r="\n              <li>Processo serÃ¡ enviado para Assessoria JurÃ­dica</li>\n              <li>AnÃ¡lise jurÃ­dica serÃ¡ realizada</li>\n              <li>ApÃ³s aprovaÃ§Ã£o jurÃ­dica, edital serÃ¡ publicado</li>\n              <li>Autoridade Competente farÃ¡ homologaÃ§Ã£o final</li>\n            ";break;case"indeferir":e="âŒ CCL Rejeitou o Processo",s="warning",i="#d32f2f",r="\n              <li>Processo serÃ¡ devolvido para CPM</li>\n              <li>CPM pode fazer correÃ§Ãµes e reenviar</li>\n              <li>Fornecedores serÃ£o notificados</li>\n              <li>Nova anÃ¡lise serÃ¡ necessÃ¡ria se aplicÃ¡vel</li>\n            ";break;case"diligencia":e="ğŸ“„ CCL Solicitou DiligÃªncia",s="info",i="#1976d2",r="\n              <li>Processo serÃ¡ devolvido para CPM</li>\n              <li>CPM deve providenciar esclarecimentos</li>\n              <li>ApÃ³s correÃ§Ãµes, retorna para nova anÃ¡lise CCL</li>\n              <li>Nova decisÃ£o serÃ¡ tomada pela CCL</li>\n            ";break}await this.$swal({title:e,html:`\n            <div style="text-align: left; padding: 15px;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 10px 0; color: ${i};">DecisÃ£o Registrada</h4>\n                <p><strong>Processo:</strong> ${a.numeroAta}</p>\n                <p><strong>DecisÃ£o:</strong> ${o.decisao.toUpperCase()}</p>\n                <p><strong>Data:</strong> ${this.formatDate(new Date)}</p>\n              </div>\n              \n              <div style="background: #e8f5e8; padding: 15px; border-radius: 8px;">\n                <h5 style="margin: 0 0 10px 0; color: ${i};">ğŸ“‹ PrÃ³ximos Passos:</h5>\n                <ol style="margin: 0; padding-left: 20px; font-size: 13px;">\n                  ${r}\n                </ol>\n              </div>\n            </div>\n          `,icon:s,confirmButtonText:"âœ… Entendido"}),await this.carregarDados(!0),await this.carregarProcessosPendentesHomologacao(),await this.carregarHomologacoesRecentes(),this.$forceUpdate()}catch(o){console.error("Erro ao processar decisÃ£o da autoridade:",o),this.$swal({title:"âŒ Erro",text:`Erro ao processar decisÃ£o: ${o.message}`,icon:"error"})}},async carregarHomologacoesRecentes(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            objeto,\n            status,\n            decisao_autoridade,\n            fundamentacao_autoridade,\n            data_decisao_autoridade,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).in("status",["aprovado_ccl","aprovado_juridico","edital_publicado","homologado"]).order("data_decisao_autoridade",{ascending:!1}).limit(10);if(o)return void console.error("Erro ao carregar homologaÃ§Ãµes recentes:",o);this.homologacoesRecentes=(a||[]).map((a=>({id:a.id,numeroAta:a.numero_processo,dataHomologacao:a.data_decisao_autoridade,totalProdutos:1,autoridade:"Autoridade Competente",motivo:a.fundamentacao_autoridade||"DecisÃ£o fundamentada",tipo:"homologar"===a.decisao_autoridade?"homologada":"indeferir"===a.decisao_autoridade?"indeferida":"diligencia"}))),this.homologacoesAprovadas=this.homologacoesRecentes.filter((a=>"homologada"===a.tipo)).length,this.homologacoesIndeferidas=this.homologacoesRecentes.filter((a=>"indeferida"===a.tipo)).length,console.log("âœ… HomologaÃ§Ãµes recentes carregadas:",this.homologacoesRecentes.length)}catch(a){console.error("Erro ao carregar homologaÃ§Ãµes recentes:",a)}},calcularPrazoCCL(a){if(!a)return"Sem prazo";const o=new Date,t=new Date(a),e=this.adicionarDiasUteis(t,10);if(o>e)return"Vencido";const s=this.calcularDiasUteisEntre(o,e);return s<=0?"Hoje":`${s} dias Ãºteis`},getPrazoCCLClass(a){if(!a)return"prazo-indefinido";const o=new Date,t=new Date(a),e=this.adicionarDiasUteis(t,10);if(o>e)return"prazo-vencido";const s=this.calcularDiasUteisEntre(o,e);return s<=2?"prazo-urgente":s<=5?"prazo-atencao":"prazo-normal"},getRecursoStatusClass(a){const o={"AGUARDANDO AUTORIDADE":"status-pendente",HOMOLOGADO:"status-aprovado",INDEFERIDO:"status-rejeitado","EM DILIGÃŠNCIA":"status-diligencia","EM ANÃLISE":"status-analise"};return o[a]||"status-padrao"},calcularPrazoRestante(a){if(!a)return"Sem prazo";const o=new Date,t=this.adicionarDiasUteis(new Date(a),10);if(o>t)return"Vencido";const e=this.calcularDiasUteisEntre(o,t);return 0===e?"Hoje (Ãºltimo dia Ãºtil)":1===e?"1 dia Ãºtil":`${e} dias Ãºteis`},getPrazoClass(a){if(!a)return"prazo-indefinido";const o=new Date,t=this.adicionarDiasUteis(new Date(a),10);if(o>t)return"prazo-vencido";const e=this.calcularDiasUteisEntre(o,t);return e<=1?"prazo-urgente":e<=3?"prazo-atencao":"prazo-normal"},async julgarProcesso(a){const o=await this.buscarInformacoesTecnicasProduto(a.id);this.$swal({title:"âš–ï¸ Julgamento CCL - AnÃ¡lise TÃ©cnica Completa",html:`\n          <div style="text-align: left; padding: 15px; max-height: 600px; overflow-y: auto;">\n            \x3c!-- CabeÃ§alho do Processo --\x3e\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h3 style="margin: 0 0 10px 0; color: #2c3e50;">ğŸ“‹ Dados do Processo</h3>\n              <p><strong>Produto:</strong> ${a.nome}</p>\n              <p><strong>Marca/Modelo:</strong> ${a.marca} ${a.modelo||""}</p>\n              <p><strong>Fabricante:</strong> ${a.fabricante||"NÃ£o informado"}</p>\n              <p><strong>Categoria:</strong> ${this.getCategoriaName(a.categoria_id)}</p>\n              <p><strong>Data de Cadastro:</strong> ${this.formatDate(a.criado_em)}</p>\n            </div>\n\n            \x3c!-- Parecer TÃ©cnico da CPM --\x3e\n            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #1976d2;">ğŸ”¬ Parecer TÃ©cnico da CPM</h4>\n              <p><strong>Status:</strong> <span style="color: ${this.getStatusColor(a.status)}; font-weight: bold;">${this.formatarStatusCPM(a.status)}</span></p>\n              <p><strong>Data da AnÃ¡lise:</strong> ${this.formatDate(a.atualizado_em)}</p>\n              ${a.observacoes_cpm?`<p><strong>ObservaÃ§Ãµes CPM:</strong> ${a.observacoes_cpm}</p>`:""}\n              ${o.laudos?`<p><strong>Laudos TÃ©cnicos:</strong> ${o.laudos}</p>`:""}\n              ${o.amostras?`<p><strong>Amostras Testadas:</strong> ${o.amostras}</p>`:""}\n            </div>\n\n            \x3c!-- DocumentaÃ§Ã£o TÃ©cnica --\x3e\n            <div style="background: #fff3e0; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 10px 0; color: #f57c00;">ğŸ“„ DocumentaÃ§Ã£o TÃ©cnica</h4>\n              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 14px;">\n                <label><input type="checkbox" id="doc_catalogo" checked disabled> CatÃ¡logo TÃ©cnico</label>\n                <label><input type="checkbox" id="doc_manual" checked disabled> Manual do Produto</label>\n                <label><input type="checkbox" id="doc_certificados" checked disabled> Certificados (ABNT/ISO)</label>\n                <label><input type="checkbox" id="doc_laudos" checked disabled> Laudos de LaboratÃ³rio</label>\n                <label><input type="checkbox" id="doc_normas" checked disabled> Atendimento a Normas</label>\n                <label><input type="checkbox" id="doc_garantia" checked disabled> Termo de Garantia</label>\n              </div>\n            </div>\n\n            \x3c!-- AnÃ¡lise de Conformidade --\x3e\n            <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 15px 0; color: #7b1fa2;">âœ… AnÃ¡lise de Conformidade CCL</h4>\n              \n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">ğŸ” AdequaÃ§Ã£o Ã s EspecificaÃ§Ãµes TÃ©cnicas:</label>\n                <select id="adequacao_tecnica" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="plenamente_adequado">Plenamente Adequado</option>\n                  <option value="adequado_ressalvas">Adequado com Ressalvas</option>\n                  <option value="inadequado">Inadequado</option>\n                </select>\n              </div>\n\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">ğŸ“‹ Atendimento aos Requisitos MÃ­nimos:</label>\n                <select id="requisitos_minimos" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="atende_plenamente">Atende Plenamente</option>\n                  <option value="atende_parcialmente">Atende Parcialmente</option>\n                  <option value="nao_atende">NÃ£o Atende</option>\n                </select>\n              </div>\n\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">âš–ï¸ Conformidade Legal (Lei 14.133/2021):</label>\n                <select id="conformidade_legal" class="swal2-select" style="width: 100%; margin-bottom: 5px;">\n                  <option value="">Selecione...</option>\n                  <option value="conforme">Conforme</option>\n                  <option value="nao_conforme">NÃ£o Conforme</option>\n                </select>\n              </div>\n            </div>\n\n            \x3c!-- RecomendaÃ§Ã£o da CCL --\x3e\n            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n              <h4 style="margin: 0 0 15px 0; color: #388e3c;">ğŸ“‹ RecomendaÃ§Ã£o da CCL para Autoridade Competente</h4>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">RecomendaÃ§Ã£o TÃ©cnica:</label>\n                <select id="decisaoCCL" class="swal2-select" style="width: 100%;">\n                  <option value="">Selecione uma recomendaÃ§Ã£o</option>\n                  <option value="recomendar_homologacao">ğŸ“‹ Recomendar HomologaÃ§Ã£o (Aprovar prÃ©-qualificaÃ§Ã£o)</option>\n                  <option value="diligencia">ğŸ“‹ Solicitar DiligÃªncia Ã  CPM</option>\n                  <option value="pendencia">â³ Aguardar DocumentaÃ§Ã£o Complementar</option>\n                </select>\n              </div>\n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 10px;">\n                <small><strong>âš ï¸ Importante:</strong> Esta Ã© uma recomendaÃ§Ã£o tÃ©cnica da CCL. A decisÃ£o final de homologar ou indeferir serÃ¡ tomada pela Autoridade Competente.</small>\n              </div>\n            </div>\n\n            \x3c!-- FundamentaÃ§Ã£o --\x3e\n            <div style="background: #fff8e1; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n              <h4 style="margin: 0 0 15px 0; color: #f9a825;">ğŸ“ FundamentaÃ§Ã£o da DecisÃ£o</h4>\n              <textarea id="fundamentacao" class="swal2-textarea" placeholder="FundamentaÃ§Ã£o tÃ©cnica e jurÃ­dica da decisÃ£o (obrigatÃ³rio - art. 5Âº Lei 14.133/2021)..." style="height: 120px; width: 100%;"></textarea>\n              \n              <div style="margin-top: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 8px;">ğŸ“š Base Legal/Normativa:</label>\n                <textarea id="base_legal" class="swal2-textarea" placeholder="Cite artigos da Lei 14.133/2021, normas tÃ©cnicas (ABNT) e outros dispositivos aplicÃ¡veis..." style="height: 80px; width: 100%;"></textarea>\n              </div>\n            </div>\n\n            \x3c!-- InformaÃ§Ãµes Adicionais --\x3e\n            <div style="background: #f5f5f5; padding: 15px; border-radius: 8px;">\n              <h4 style="margin: 0 0 15px 0; color: #424242;">ğŸ“‹ InformaÃ§Ãµes Complementares</h4>\n              <div style="margin-bottom: 10px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">ObservaÃ§Ãµes da CCL:</label>\n                <textarea id="observacoes_ccl" class="swal2-textarea" placeholder="ObservaÃ§Ãµes adicionais (opcional)..." style="height: 60px; width: 100%;"></textarea>\n              </div>\n              \n              <div style="margin-top: 15px;">\n                <label><input type="checkbox" id="incluir_ata" checked> Incluir na prÃ³xima Ata de Julgamento</label>\n              </div>\n              \n              <div style="margin-top: 10px; font-size: 12px; color: #666;">\n                <strong>Nota:</strong> Esta decisÃ£o serÃ¡ registrada conforme art. 78, Â§ 2Âº da Lei 14.133/2021 e incluÃ­da na Ata de Julgamento da CCL.\n              </div>\n            </div>\n          </div>\n        `,width:"900px",showCancelButton:!0,confirmButtonText:"ğŸ“‹ Emitir Ata de Julgamento",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#2e7d32",cancelButtonColor:"#d32f2f",preConfirm:()=>{const a=document.getElementById("decisaoCCL").value,o=document.getElementById("fundamentacao").value.trim(),t=document.getElementById("base_legal").value.trim(),e=document.getElementById("adequacao_tecnica").value,s=document.getElementById("requisitos_minimos").value,i=document.getElementById("conformidade_legal").value,r=document.getElementById("observacoes_ccl").value.trim(),n=document.getElementById("incluir_ata").checked;return a?o?e?s?i?{decisao:a,fundamentacao:o,baseLegal:t,adequacaoTecnica:e,requisitosMinimos:s,conformidadeLegal:i,observacoesCcl:r,incluirAta:n}:(this.$swal.showValidationMessage("Informe a conformidade legal"),!1):(this.$swal.showValidationMessage("Informe o atendimento aos requisitos mÃ­nimos"),!1):(this.$swal.showValidationMessage("Informe a adequaÃ§Ã£o Ã s especificaÃ§Ãµes tÃ©cnicas"),!1):(this.$swal.showValidationMessage("A fundamentaÃ§Ã£o Ã© obrigatÃ³ria (art. 5Âº Lei 14.133/2021)"),!1):(this.$swal.showValidationMessage("Selecione uma decisÃ£o da CCL"),!1)}}).then((async o=>{if(o.isConfirmed)try{await this.salvarJulgamentoCCL(a,o.value),this.$swal({title:"âš–ï¸ Julgamento Registrado",text:"A decisÃ£o da CCL foi registrada com sucesso e serÃ¡ incluÃ­da na prÃ³xima ata de julgamento.",icon:"success",confirmButtonText:"âœ… OK"}),await this.carregarDados()}catch(t){this.$swal({title:"âŒ Erro",text:`Erro ao registrar julgamento: ${t.message}`,icon:"error"})}}))},async buscarInformacoesTecnicasProduto(a){try{const{data:o,error:t}=await N.ND.from("produtos").select("observacoes_cpm, laudos_tecnicos, amostras_testadas").eq("id",a).single();return t?(console.error("Erro ao buscar informaÃ§Ãµes tÃ©cnicas:",t),{}):{laudos:o?.laudos_tecnicos||"NÃ£o informado",amostras:o?.amostras_testadas||"NÃ£o informado"}}catch(o){return console.error("Erro ao buscar informaÃ§Ãµes tÃ©cnicas:",o),{}}},getStatusColor(a){switch(a){case"aprovado":return"#4caf50";case"reprovado":return"#f44336";case"diligencia":return"#ff9800";case"pendente":return"#2196f3";default:return"#666"}},async salvarJulgamentoCCL(a,o){try{const t=this.mapearDecisaoParaStatus(o.decisao),{error:e}=await N.ND.from("produtos").update({status:t,observacoes_ccl:o.fundamentacao,adequacao_tecnica:o.adequacaoTecnica,requisitos_minimos:o.requisitosMinimos,conformidade_legal:o.conformidadeLegal,base_legal:o.baseLegal,observacoes_ccl_adicional:o.observacoesCcl,julgado_em:(new Date).toISOString(),atualizado_em:(new Date).toISOString()}).eq("id",a.id);if(e)throw new Error(`Erro ao atualizar produto: ${e.message}`);o.incluirAta&&"homologado"===o.decisao&&console.log("Produto serÃ¡ incluÃ­do na prÃ³xima ata de julgamento"),console.log("Julgamento CCL salvo com sucesso para produto:",a.id)}catch(t){throw console.error("Erro ao salvar julgamento CCL:",t),t}},mapearDecisaoParaStatus(a){switch(a){case"recomendar_homologacao":return"ata_julgamento_recomenda_aprovacao";case"recomendar_indeferimento":return"ata_julgamento_recomenda_rejeicao";case"diligencia":return"diligencia";case"pendencia":return"pendencia_documentacao";default:return"julgamento_pendente"}},getFeriadosNacionais(a){const o=[`${a}-01-01`,`${a}-04-21`,`${a}-05-01`,`${a}-09-07`,`${a}-10-12`,`${a}-11-02`,`${a}-11-15`,`${a}-12-25`],t=[];return 2024===a?t.push("2024-02-12","2024-02-13","2024-03-29","2024-05-30"):2025===a&&t.push("2025-03-03","2025-03-04","2025-04-18","2025-06-19"),[...o,...t]},isFeriado(a){const o=a.toISOString().split("T")[0],t=a.getFullYear(),e=this.getFeriadosNacionais(t);return e.includes(o)},isFimDeSemana(a){const o=a.getDay();return 0===o||6===o},isDiaUtil(a){return!this.isFimDeSemana(a)&&!this.isFeriado(a)},adicionarDiasUteis(a,o){const t=new Date(a);let e=0;while(e<o)t.setDate(t.getDate()+1),this.isDiaUtil(t)&&e++;return t},calcularDiasUteisEntre(a,o){const t=new Date(a),e=new Date(o);let s=0;const i=new Date(t);while(i<=e)this.isDiaUtil(i)&&s++,i.setDate(i.getDate()+1);return s},calcularPrazoRecursal(a,o=3){const t=this.adicionarDiasUteis(new Date(a),o);return t},calcularPrazoHomologacaoUtil(a,o=10){const t=this.adicionarDiasUteis(new Date(a),o);return t},getPrazoRecursoClass(a){if(!a)return"prazo-indefinido";const o=new Date,t=new Date(a);if(o>t)return"prazo-vencido";const e=this.calcularDiasUteisEntre(o,t);return e<=0?"prazo-urgente":e<=1?"prazo-atencao":"prazo-normal"},visualizarDocumentacao(a){this.$swal({title:"ğŸ“„ DocumentaÃ§Ã£o do Processo",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Produto: ${a.nome}</h4>\n            <p><strong>Marca:</strong> ${a.marca}</p>\n            <hr>\n            <h5>Documentos DisponÃ­veis:</h5>\n            <ul style="text-align: left;">\n              <li>ğŸ“‹ Parecer TÃ©cnico da CPM</li>\n              <li>ğŸ“‘ DocumentaÃ§Ã£o do Fornecedor</li>\n              <li>ğŸ”¬ Laudos TÃ©cnicos</li>\n              <li>ğŸ“ Ata de Recebimento de Amostras</li>\n              <li>ğŸ“„ Edital de Chamamento PÃºblico</li>\n            </ul>\n            <div style="margin-top: 20px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.baixarDocumentacaoProduto('${a.id}')">\n                ğŸ“¥ Baixar DocumentaÃ§Ã£o Completa\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"âŒ Fechar"})},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"julgado_aprovado":return"status-aprovado";case"julgado_reprovado":return"status-reprovado";case"homologado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";case"diligencia":return"status-diligencia";default:return"status-pendente"}},publicarDecisao(a){this.$swal({title:"AÃ§Ã£o Simulada",text:"Em uma implementaÃ§Ã£o completa, abriria um formulÃ¡rio para registrar a decisÃ£o da comissÃ£o e publicar no DiÃ¡rio Oficial.",icon:"info"})},async carregarRecursos(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("recursos").select("\n            id,\n            ata_referencia,\n            recorrente,\n            produto_nome,\n            data_recurso,\n            prazo_final,\n            status,\n            fundamentacao,\n            decisao,\n            fundamentacao_decisao,\n            responsavel_decisao,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).order("data_recurso",{ascending:!1}).limit(10);if(o)return void console.error("Erro ao carregar recursos:",o);a&&a.length>0?(this.recursos=a,this.atualizarTotalPaginacao("recursosAnalise",a.length),console.log("Recursos carregados do banco de dados:",a.length)):(this.recursos=[],this.atualizarTotalPaginacao("recursosAnalise",0),console.log("Nenhum recurso encontrado no banco"))}catch(a){console.error("Erro ao carregar recursos:",a),this.recursos=[],this.atualizarTotalPaginacao("recursosAnalise",0)}},async carregarAtasJulgamento(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("atas_julgamento").select("\n            id,\n            numero,\n            periodo,\n            descricao,\n            data_publicacao,\n            status_ata,\n            total_processos,\n            conteudo_ata,\n            processo_id\n          ").eq("tenant_id",this.currentTenantId).in("status_ata",["EM PRAZO","FINALIZADA","HOMOLOGADA"]).order("data_publicacao",{ascending:!1}).limit(10);if(o)return void console.error("Erro ao carregar atas de julgamento reais:",o);if(a&&a.length>0){for(const o of a){let a=null;if(o.processo_id){console.log("ğŸ” Buscando processo para ata:",o.numero,"processo_id:",o.processo_id);const{data:t,error:e}=await N.ND.from("processos_administrativos").select("id, status, numero_processo").eq("id",o.processo_id).eq("tenant_id",this.currentTenantId).single();!e&&t&&(a=t,console.log("âœ… Processo encontrado por ID:",a))}if(!a){console.log("ğŸ” Tentativa 2: Buscando processo por ata_julgamento_ccl contendo:",o.numero);const{data:t,error:e}=await N.ND.from("processos_administrativos").select("id, status, numero_processo, ata_julgamento_ccl").eq("tenant_id",this.currentTenantId).in("status",["ata_ccl","publicacao_ata","julgamento_ccl"]).order("created_at",{ascending:!1}).limit(10);if(!e&&t){const e=t.find((a=>a.ata_julgamento_ccl&&a.ata_julgamento_ccl.includes(o.numero)));e&&(a=e,console.log("âœ… Processo encontrado por ata_julgamento_ccl:",a),await N.ND.from("atas_julgamento").update({processo_id:a.id}).eq("id",o.id).eq("tenant_id",this.currentTenantId))}}if(!a){console.log("ğŸ” Tentativa 3: Extraindo nÃºmero do processo da ata:",o.numero);const t=o.numero.match(/ATA-CCL-(\d+)-(\d+)/);if(t){const e=`${t[1].padStart(3,"0")}/${t[2]}`;console.log("ğŸ” NÃºmero do processo extraÃ­do:",e);const{data:s,error:i}=await N.ND.from("processos_administrativos").select("id, status, numero_processo").eq("numero_processo",e).eq("tenant_id",this.currentTenantId).single();!i&&s&&(a=s,console.log("âœ… Processo encontrado por nÃºmero:",a),await N.ND.from("atas_julgamento").update({processo_id:a.id}).eq("id",o.id).eq("tenant_id",this.currentTenantId))}}a?o.processos_administrativos=a:console.log("âŒ Nenhum processo encontrado para ata:",o.numero)}this.atasPublicadasRecentes=a.map((a=>{new Date(a.data_publicacao||a.criado_em);return{id:a.id,numero:a.numero,numero_processo:a.numero_processo,dataPublicacao:a.data_publicacao,periodo:a.periodo,totalProcessos:a.total_processos||1,statusRecursal:a.status_ata,conteudoAta:a.conteudo_ata,objeto:a.descricao,orgao:"CCL",tipo_processo:a.tipo_processo,data_julgamento:a.data_publicacao,processo_id:a.processo_id,ata_completa:a}})),this.atasPublicadas=a.length,this.atualizarTotalPaginacao("atasPublicadas",a.length),console.log("âœ… Atas PUBLICADAS carregadas (da tabela atas_julgamento):",a.length)}else this.atasPublicadas=0,this.atualizarTotalPaginacao("atasPublicadas",0),console.log("Nenhuma ata de julgamento encontrada no banco")}catch(a){console.error("Erro ao carregar atas de julgamento:",a)}},async carregarAtasEmElaboracao(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("atas_julgamento").select("\n            id,\n            numero,\n            periodo,\n            total_processos,\n            status_ata,\n            observacoes\n          ").eq("tenant_id",this.currentTenantId).in("status_ata",["ELABORACAO","EM_ELABORACAO"]).order("id",{ascending:!1});if(o)return void console.error("Erro ao carregar atas em elaboraÃ§Ã£o:",o);a&&a.length>0?(this.atasEmElaboracao=a.map((a=>({id:a.id,numero_ata:a.numero,numero:a.numero,periodo:a.periodo,processos_count:a.total_processos,status:"elaboracao",data_inicio:a.data_inicio_elaboracao||a.criado_em,responsavel:a.responsavel_elaboracao||"CCL",progresso:a.progresso_elaboracao||0,observacoes:a.observacoes,criadoEm:a.criado_em,atualizadoEm:a.atualizado_em}))),this.atasEmAndamento=a.length,this.atualizarTotalPaginacao("atasElaboracao",a.length),console.log("Atas em elaboraÃ§Ã£o carregadas do banco:",a.length)):(this.atasEmAndamento=0,this.atualizarTotalPaginacao("atasElaboracao",0),console.log("Nenhuma ata em elaboraÃ§Ã£o encontrada no banco"))}catch(a){console.error("Erro ao carregar atas em elaboraÃ§Ã£o:",a)}},async carregarHomologacoes(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("homologacoes").select("\n            id,\n            numero_ata,\n            data_homologacao,\n            tipo_homologacao,\n            total_produtos,\n            autoridade_competente,\n            fundamentacao,\n            arquivo_pdf_url,\n            observacoes,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).order("data_homologacao",{ascending:!1}).limit(10);if(o)return void console.error("Erro ao carregar homologaÃ§Ãµes:",o);a&&a.length>0?(this.homologacoesRecentes=a.map((a=>({id:a.id,numeroAta:a.numero_ata,dataHomologacao:a.data_homologacao,totalProdutos:a.total_produtos,tipo:a.tipo_homologacao.toLowerCase(),autoridade:a.autoridade_competente,motivo:a.fundamentacao,arquivoPdfUrl:a.arquivo_pdf_url,observacoes:a.observacoes,criadoEm:a.criado_em}))),this.homologacoesAprovadas=a.filter((a=>"HOMOLOGADA"===a.tipo_homologacao)).length,this.homologacoesIndeferidas=a.filter((a=>"INDEFERIDA"===a.tipo_homologacao)).length,this.atualizarTotalPaginacao("homologacoesRecentes",a.length),console.log("HomologaÃ§Ãµes carregadas do banco:",a.length)):(this.atualizarTotalPaginacao("homologacoesRecentes",0),console.log("Nenhuma homologaÃ§Ã£o encontrada no banco"))}catch(a){console.error("Erro ao carregar homologaÃ§Ãµes:",a)}},async carregarProcessosPendentesHomologacao(){try{if(!this.currentTenantId)return;const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            objeto,\n            status,\n            ata_emitida_ccl_em,\n            ata_julgamento_ccl,\n            recomendacao_ccl,\n            fundamentacao_legal_ccl,\n            decisao_autoridade,\n            fundamentacao_autoridade,\n            data_decisao_autoridade,\n            criado_em,\n            atualizado_em\n          ").eq("tenant_id",this.currentTenantId).in("status",["ata_julgamento_ccl_homologacao","homologado"]).order("ata_emitida_ccl_em",{ascending:!0});if(console.log("Debug Processos HomologaÃ§Ã£o:"),console.log("- Tenant ID:",this.currentTenantId),console.log("- Query error:",o),console.log("- Processos encontrados:",a?.length||0),console.log("- Dados dos processos:",a),o)return void console.error("Erro ao carregar processos pendentes de homologaÃ§Ã£o:",o);if(a&&a.length>0){this.processosPendentesHomologacao=a.map((a=>{const o="homologado"===a.status&&a.decisao_autoridade;return{id:a.id,numeroAta:a.numero_processo,dataJulgamento:a.ata_emitida_ccl_em,totalProdutos:1,decisaoCCL:this.mapearRecomendacaoParaTexto(a.recomendacao_ccl),statusRecursos:this.determinarStatusRecursosProcesso(a.status),observacoes:a.fundamentacao_legal_ccl,jaDecidido:o,tipoDecisao:o?this.mapearDecisaoAutoridade(a.decisao_autoridade):null,dataDecisao:a.data_decisao_autoridade}}));const o=this.processosPendentesHomologacao.filter((a=>!a.jaDecidido)),t=this.processosPendentesHomologacao.filter((a=>a.jaDecidido));this.homologacoesPendentes=o.length,this.processosPendentes=o.length,console.log("Processos pendentes de homologaÃ§Ã£o:",o.length),console.log("Processos jÃ¡ decididos:",t.length),this.atualizarTotalPaginacao("processosPendentes",this.processosPendentesHomologacao.length)}else this.homologacoesPendentes=0,this.processosPendentes=0,this.atualizarTotalPaginacao("processosPendentes",0),console.log("Nenhum processo encontrado")}catch(a){console.error("Erro ao carregar processos pendentes de homologaÃ§Ã£o:",a)}},mapearStatusParaDecisao(a){switch(a){case"PUBLICADA_EM_PRAZO":case"PUBLICADA_ENCERRADA":return"APROVADA";case"PUBLICADA_COM_RECURSOS":return"APROVADA COM RECURSOS";case"PUBLICADA_PRAZO_VENCIDO":return"PARCIALMENTE APROVADA";default:return"APROVADA"}},determinarStatusRecursos(a){switch(a){case"PUBLICADA_EM_PRAZO":return"EM PRAZO RECURSAL";case"PUBLICADA_ENCERRADA":return"SEM RECURSOS";case"PUBLICADA_COM_RECURSOS":return"RECURSOS JULGADOS";case"PUBLICADA_PRAZO_VENCIDO":return"PRAZO VENCIDO";default:return"SEM RECURSOS"}},mapearRecomendacaoParaTexto(a){switch(a){case"recomendar_homologacao":return"HOMOLOGAÃ‡ÃƒO RECOMENDADA";case"recomendar_indeferimento":return"INDEFERIMENTO RECOMENDADO";case"solicitar_esclarecimentos":return"ESCLARECIMENTOS SOLICITADOS";default:return"APROVADA"}},determinarStatusRecursosProcesso(a){switch(a){case"julgado_ccl":return"AGUARDANDO AUTORIDADE";case"homologado_autoridade":return"HOMOLOGADO";case"indeferido_autoridade":return"INDEFERIDO";case"diligencia_autoridade":return"EM DILIGÃŠNCIA";default:return"EM ANÃLISE"}},mapearDecisaoAutoridade(a){switch(a){case"homologar":return"HOMOLOGADA";case"indeferir":return"INDEFERIDA";case"diligencia":return"DILIGÃŠNCIA SOLICITADA";default:return null}},async carregarDCBsAtivas(){try{if(!this.currentTenantId)return;await N.ND.rpc("atualizar_status_dcbs");const{data:a,error:o}=await N.ND.from("dcbs").select("\n            id,\n            numero_completo,\n            numero,\n            ano,\n            produto_nome,\n            marca,\n            modelo,\n            fabricante,\n            data_emissao,\n            data_validade,\n            status_dcb,\n            autoridade_emissora,\n            arquivo_pdf_url,\n            qr_code_data,\n            observacoes,\n            criado_em\n          ").eq("tenant_id",this.currentTenantId).in("status_dcb",["ATIVA","VENCENDO"]).order("data_emissao",{ascending:!1}).limit(20);if(o)return void console.error("Erro ao carregar DCBs ativas:",o);if(a&&a.length>0){this.dcbsAtivas=a.map((a=>({id:a.id,numero:a.numero_completo,numeroSeparado:a.numero,ano:a.ano,produto:a.produto_nome,marca:a.marca,modelo:a.modelo,fabricante:a.fabricante,dataEmissao:a.data_emissao,validade:a.data_validade,status:a.status_dcb,autoridade:a.autoridade_emissora,arquivoPdf:a.arquivo_pdf_url,qrCode:a.qr_code_data,observacoes:a.observacoes,criadoEm:a.criado_em})));const{count:o}=await N.ND.from("dcbs").select("*",{count:"exact",head:!0}).eq("tenant_id",this.currentTenantId);this.dcbsEmitidas=o||0,this.atualizarTotalPaginacao("dcbsAtivas",a.length),console.log("DCBs ativas carregadas do banco:",a.length),console.log("Total de DCBs emitidas:",this.dcbsEmitidas)}else console.log("Nenhuma DCB ativa encontrada no banco"),this.dcbsEmitidas=0,this.atualizarTotalPaginacao("dcbsAtivas",0)}catch(a){console.error("Erro ao carregar DCBs ativas:",a)}},async gerarDCBsAutomaticamente(a,o){try{const{data:t,error:e}=await N.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status\n          ").eq("tenant_id",this.currentTenantId).eq("status","aprovado").limit(o.totalProdutos||50);if(e)return void console.error("Erro ao buscar produtos para DCB:",e);if(!t||0===t.length)return void console.log("Nenhum produto aprovado encontrado para gerar DCBs");const s=(new Date).getFullYear(),i=t.map(((o,t)=>({tenant_id:this.currentTenantId,homologacao_id:a.id,produto_id:o.id,numero:null,ano:s,produto_nome:o.nome,marca:o.marca,modelo:o.modelo||"NÃ£o informado",fabricante:o.fabricante||"NÃ£o informado",data_emissao:a.data_homologacao,data_validade:new Date(new Date(a.data_homologacao).getTime()+31536e6).toISOString(),status_dcb:"ATIVA",autoridade_emissora:a.autoridade_competente})));for(const a of i){const{data:o,error:t}=await N.ND.rpc("obter_proximo_numero_dcb",{tenant_uuid:this.currentTenantId,ano_dcb:s});if(t){console.error("Erro ao obter prÃ³ximo nÃºmero DCB:",t);continue}a.numero=o;const{error:e}=await N.ND.from("dcbs").insert([a]);e&&console.error("Erro ao inserir DCB:",e)}console.log(`${i.length} DCBs geradas automaticamente para homologaÃ§Ã£o ${a.numero_ata}`)}catch(t){throw console.error("Erro ao gerar DCBs automaticamente:",t),t}},async analisarRecurso(a){try{const o=new Date(a.prazo_final)<new Date,t=await this.$swal({title:"ğŸ“‹ Analisar Recurso Administrativo",html:`\n            <div style="text-align: left; padding: 15px;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 10px 0; color: #495057;">ğŸ“„ Dados do Recurso</h4>\n                <p><strong>Produto/Processo:</strong> ${a.produto_nome}</p>\n                <p><strong>Recorrente:</strong> ${a.recorrente}</p>\n                <p><strong>Ata ReferÃªncia:</strong> ${a.ata_referencia}</p>\n                <p><strong>Data do Recurso:</strong> ${this.formatDate(a.data_recurso)}</p>\n                <p><strong>Prazo para DecisÃ£o:</strong> ${this.formatDate(a.prazo_final)} \n                  ${o?'<span style="color: #dc3545; font-weight: bold;">(VENCIDO)</span>':'<span style="color: #28a745; font-weight: bold;">(EM PRAZO)</span>'}\n                </p>\n                <p><strong>Status Atual:</strong> ${a.status}</p>\n              </div>\n              \n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px;">\n                <h5 style="margin: 0 0 10px 0; color: #495057;">ğŸ“ FundamentaÃ§Ã£o do Recorrente</h5>\n                <div style="background: #f9f9f9; padding: 10px; border-radius: 4px; max-height: 150px; overflow-y: auto;">\n                  ${a.fundamentacao||"FundamentaÃ§Ã£o nÃ£o disponÃ­vel"}\n                </div>\n              </div>\n              \n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px;">\n                <h5 style="margin: 0 0 20px 0; color: #495057; text-align: center;">âš–ï¸ DecisÃ£o da ComissÃ£o</h5>\n                \n                \x3c!-- DecisÃ£o --\x3e\n                <div style="margin-bottom: 20px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">DecisÃ£o sobre o Recurso:</label>\n                  <select id="decisaoRecurso" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px; background: white;">\n                    <option value="">ğŸ”½ Selecione uma decisÃ£o</option>\n                    <option value="deferido">âœ… DEFERIR - Reverter decisÃ£o da CCL (procedente)</option>\n                    <option value="indeferido">âŒ INDEFERIR - Manter decisÃ£o da CCL (improcedente)</option>\n                    <option value="encaminhar_cpm">ğŸ“‹ ENCAMINHAR para CPM - Requerer nova anÃ¡lise tÃ©cnica</option>\n                  </select>\n                </div>\n                \n                \x3c!-- FundamentaÃ§Ã£o --\x3e\n                <div style="margin-bottom: 20px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">FundamentaÃ§Ã£o Legal e TÃ©cnica:</label>\n                  <textarea id="fundamentacaoRecurso" \n                            style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px; font-family: Arial, sans-serif; resize: vertical; min-height: 120px;" \n                            placeholder="Justificativa da decisÃ£o com base legal e tÃ©cnica...\n                            \nExemplo:\n- AnÃ¡lise da fundamentaÃ§Ã£o apresentada\n- VerificaÃ§Ã£o da tempestividade \n- Base legal: Lei 14.133/2021, Art. XXX\n- ConsideraÃ§Ãµes tÃ©cnicas especÃ­ficas"></textarea>\n                </div>\n                \n                \x3c!-- ResponsÃ¡vel --\x3e\n                <div style="margin-bottom: 15px;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">ResponsÃ¡vel pela DecisÃ£o:</label>\n                  <input id="responsavelRecurso" \n                         style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px;" \n                         type="text" \n                         placeholder="Nome do responsÃ¡vel pela decisÃ£o" \n                         value="${this.usuarioNome||"CCL"}">\n                </div>\n              </div>\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n                <small><strong>ğŸ“š Base Legal:</strong> Art. 165-171 da Lei 14.133/2021. A decisÃ£o serÃ¡ registrada e encaminhada para conhecimento das partes.</small>\n              </div>\n            </div>\n          `,width:"950px",showCancelButton:!0,confirmButtonText:"âœ… Confirmar DecisÃ£o",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("decisaoRecurso").value,o=document.getElementById("fundamentacaoRecurso").value.trim(),t=document.getElementById("responsavelRecurso").value.trim();return a?o?t?{decisao:a,fundamentacao:o,responsavel:t}:(this.$swal.showValidationMessage("Informe o responsÃ¡vel pela decisÃ£o"),!1):(this.$swal.showValidationMessage("Informe a fundamentaÃ§Ã£o da decisÃ£o"),!1):(this.$swal.showValidationMessage("Selecione uma decisÃ£o"),!1)}});if(!t.isConfirmed)return;const e={decisao:t.value.decisao,fundamentacao_decisao:t.value.fundamentacao,responsavel_decisao:t.value.responsavel,data_decisao:(new Date).toISOString(),status:"encaminhar_cpm"===t.value.decisao?"AGUARDANDO CPM":"deferido"===t.value.decisao?"DEFERIDO":"INDEFERIDO",atualizado_em:(new Date).toISOString()};console.log("Atualizando recurso:",a.id,"com dados:",e);const{data:s,error:i}=await N.ND.from("recursos").update(e).eq("id",a.id).select();if(console.log("Resultado da atualizaÃ§Ã£o:",{updatedData:s,error:i}),i)return console.warn("Erro ao salvar decisÃ£o (tabela pode nÃ£o existir):",i),void this.$swal({title:"âš ï¸ Erro ao Salvar DecisÃ£o",html:`\n              <div style="text-align: left; padding: 15px;">\n                <p>NÃ£o foi possÃ­vel salvar a decisÃ£o no banco de dados.</p>\n                <p><strong>PossÃ­vel causa:</strong> Tabela de recursos nÃ£o existe.</p>\n                <p><strong>AÃ§Ã£o necessÃ¡ria:</strong> Execute o script <code>criar_tabela_recursos.sql</code></p>\n                <hr>\n                <p><strong>DecisÃ£o registrada localmente:</strong></p>\n                <p><strong>Recurso:</strong> ${a.produto_nome}</p>\n                <p><strong>DecisÃ£o:</strong> ${t.value.decisao.toUpperCase()}</p>\n                <p><strong>ResponsÃ¡vel:</strong> ${t.value.responsavel}</p>\n              </div>\n            `,icon:"warning"});await this.carregarRecursos(),await this.carregarDados();const r="deferido"===t.value.decisao?"DEFERIDO":"indeferido"===t.value.decisao?"INDEFERIDO":"ENCAMINHADO PARA CPM";this.$swal({title:"âœ… Recurso Analisado com Sucesso!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>ğŸ“‹ DecisÃ£o Registrada</h4>\n              <p><strong>Recurso:</strong> ${a.produto_nome}</p>\n              <p><strong>Recorrente:</strong> ${a.recorrente}</p>\n              <p><strong>DecisÃ£o:</strong> <span style="font-weight: bold; color: ${"deferido"===t.value.decisao?"#28a745":"indeferido"===t.value.decisao?"#dc3545":"#ffc107"};">${r}</span></p>\n              <p><strong>ResponsÃ¡vel:</strong> ${t.value.responsavel}</p>\n              <p><strong>Data da DecisÃ£o:</strong> ${this.formatDate(new Date)}</p>\n              <hr>\n              <p>A decisÃ£o foi registrada e constarÃ¡ na documentaÃ§Ã£o oficial do processo.</p>\n            </div>\n          `,icon:"success",confirmButtonText:"ğŸ“„ Gerar Documento",showCancelButton:!0,cancelButtonText:"âœ… OK"}).then((o=>{o.isConfirmed&&this.gerarDocumentoRecurso(a,t.value)}))}catch(o){console.error("Erro ao analisar recurso:",o),this.$swal({title:"âŒ Erro ao Processar DecisÃ£o",text:`Erro: ${o.message}`,icon:"error"})}},async gerarDocumentoRecurso(a,o){try{const{jsPDF:e}=await Promise.resolve().then(t.bind(t,1749)),s=new e,i=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight();let n=25;s.setFontSize(16),s.setFont(void 0,"bold"),s.text("COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)",i/2,n,{align:"center"}),n+=8,s.setFontSize(12),s.setFont(void 0,"normal"),s.text("Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021",i/2,n,{align:"center"}),n+=15,s.setLineWidth(.5),s.line(30,n,i-30,n),n+=20,s.setFontSize(16),s.setFont(void 0,"bold"),s.text("DECISÃƒO DE RECURSO ADMINISTRATIVO",i/2,n,{align:"center"}),n+=20,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("I. IDENTIFICAÃ‡ÃƒO DO RECURSO",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal");const c=[["Protocolo:",`REC-${String(a.id).substring(0,8).toUpperCase()}/${(new Date).getFullYear()}`],["Recorrente:",a.recorrente],["Produto/Processo:",a.produto_nome],["Ata de ReferÃªncia:",a.ata_referencia],["Data do Recurso:",this.formatDate(a.data_recurso)],["Prazo Final:",this.formatDate(a.prazo_final)]];c.forEach((([a,o])=>{s.setFont(void 0,"bold"),s.text(a,35,n),s.setFont(void 0,"normal"),s.text(o,90,n),n+=8})),n+=10,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("II. FUNDAMENTAÃ‡ÃƒO DO RECORRENTE",30,n),n+=12,s.setFontSize(10),s.setFont(void 0,"normal");const l=a.fundamentacao||"FundamentaÃ§Ã£o nÃ£o disponÃ­vel",d=s.splitTextToSize(l,i-60);s.text(d,35,n),n+=5*d.length+15,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("III. DECISÃƒO DA COMISSÃƒO",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal");const u=[["DecisÃ£o:",o.decisao.toUpperCase()],["ResponsÃ¡vel:",o.responsavel],["Data da DecisÃ£o:",this.formatDate(new Date)],["Status:","deferido"===o.decisao?"DEFERIDO (Procedente)":"indeferido"===o.decisao?"INDEFERIDO (Improcedente)":"ENCAMINHADO PARA CPM"]];u.forEach((([a,o])=>{s.setFont(void 0,"bold"),s.text(a,35,n),s.setFont(void 0,"normal"),s.text(o,90,n),n+=8})),n+=10,s.setFontSize(12),s.setFont(void 0,"bold"),s.text("FundamentaÃ§Ã£o Legal e TÃ©cnica:",35,n),n+=10,s.setFontSize(10),s.setFont(void 0,"normal");const m=s.splitTextToSize(o.fundamentacao,i-60);s.text(m,35,n),n+=5*m.length+20,n>r-80&&(s.addPage(),n=30),s.setFontSize(14),s.setFont(void 0,"bold"),s.text("IV. BASE LEGAL",30,n),n+=12,s.setFontSize(10),s.setFont(void 0,"normal");const p=["â€¢ Lei nÂº 14.133/2021 - Nova Lei de LicitaÃ§Ãµes e Contratos","â€¢ Art. 165 - Direito de recurso dos interessados","â€¢ Art. 166 - Prazo para interposiÃ§Ã£o de recurso (3 dias Ãºteis)","â€¢ Art. 167 - Processamento dos recursos administrativos","â€¢ Art. 169 - DecisÃ£o dos recursos pela comissÃ£o competente"];p.forEach((a=>{s.text(a,35,n),n+=6})),n+=20,s.setFontSize(11),s.setFont(void 0,"bold"),s.text(`${o.responsavel}`,i/2,n,{align:"center"}),n+=6,s.setFont(void 0,"normal"),s.text("ComissÃ£o de ContrataÃ§Ã£o ou LicitaÃ§Ã£o (CCL)",i/2,n,{align:"center"}),s.setFontSize(8),s.text(`Documento gerado em: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}`,30,r-15),s.text("Sistema Comprar Bem - Recursos Administrativos",i-30,r-15,{align:"right"});const v=`Recurso_${String(a.id).substring(0,8)}_${o.decisao}_${(new Date).toISOString().split("T")[0]}.pdf`;s.save(v),this.$swal({title:"ğŸ“„ Documento Gerado!",text:`O documento PDF foi gerado com sucesso: ${v}`,icon:"success"})}catch(e){console.error("Erro ao gerar documento:",e),this.$swal({title:"âŒ Erro ao Gerar Documento",text:`Erro: ${e.message}`,icon:"error"})}},visualizarDocumentacaoRecurso(a){this.$swal({title:"ğŸ“„ DocumentaÃ§Ã£o do Recurso",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Recurso: ${a.produto_nome}</h4>\n            <p><strong>Recorrente:</strong> ${a.recorrente}</p>\n            <p><strong>Protocolo:</strong> ${a.id.toUpperCase()}</p>\n            <hr>\n            <h5>Documentos DisponÃ­veis:</h5>\n            <ul style="text-align: left;">\n              <li>ğŸ“‹ RazÃµes do Recurso</li>\n              <li>ğŸ“‘ Ata de Julgamento Original (${a.ata_referencia})</li>\n              <li>ğŸ” DocumentaÃ§Ã£o TÃ©cnica</li>\n              <li>ğŸ“ Parecer da CPM</li>\n              <li>âš–ï¸ FundamentaÃ§Ã£o da CCL</li>\n            </ul>\n            <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Prazo Final:</strong> ${this.formatDate(a.prazo_final)}</small>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.baixarDocumentacaoRecursoEspecifico('${a.id}')">\n                ğŸ“¥ Baixar DocumentaÃ§Ã£o Completa\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"âŒ Fechar"})},julgarRecurso(a){const o=this.recursos.find((o=>o.id===a));o&&this.analisarRecurso(o)},async criarRecurso(a){try{if(!this.currentTenantId)throw new Error("Tenant ID nÃ£o disponÃ­vel");const{data:o,error:t}=await N.ND.from("recursos").insert([{tenant_id:this.currentTenantId,produto_id:a.produto_id,ata_referencia:a.ata_referencia,recorrente:a.recorrente,produto_nome:a.produto_nome,data_recurso:a.data_recurso,prazo_final:a.prazo_final,status:"EM ANÃLISE",fundamentacao:a.fundamentacao}]).select();if(t)throw t;return await this.carregarDados(),o[0]}catch(o){throw console.error("Erro ao criar recurso:",o),o}},iniciarMonitoramentoPrazos(){this.limparNotificacoesAntigas(),this.verificarPrazos(),this.autoCheckInterval=setInterval((()=>{this.verificarPrazos()}),3e5),console.log("Sistema de monitoramento de prazos iniciado")},async verificarPrazos(){try{this.limparNotificacoesAntigas(),await this.verificarPrazosRecursos(),await this.verificarPrazosJulgamento(),await this.verificarPrazosHomologacao(),this.atualizarContadoresAlertas()}catch(a){console.error("Erro ao verificar prazos:",a)}},limparNotificacoesAntigas(){const a=new Date;this.notificacoes=this.notificacoes.filter((o=>{if("homologacao-atrasada"===o.tipo&&o.ata_id){const t=this.processosPendentesHomologacao.find((a=>a.id===o.ata_id));if(t){const o=new Date(t.dataJulgamento),e=a-o,s=Math.floor(e/864e5);if(s>30)return!1}}if("julgamento-vencido"===o.tipo&&o.produto_id){const t=this.produtosPendentes.find((a=>a.id===o.produto_id));if(t){const o=new Date(t.criado_em),e=new Date(o);e.setDate(o.getDate()+10);const s=e-a,i=Math.ceil(s/864e5);if(i<0&&Math.abs(i)>30)return!1}}if("prazo-vencido"===o.tipo&&o.recurso_id){const t=this.recursos.find((a=>a.id===o.recurso_id));if(t){const o=new Date(t.prazo_final),e=o-a,s=Math.ceil(e/864e5);if(s<0&&Math.abs(s)>30)return!1}}return!0}))},async verificarPrazosRecursos(){if(!this.recursos||0===this.recursos.length)return;const a=new Date;this.recursos.forEach((o=>{const t=new Date(o.prazo_final),e=t-a,s=Math.ceil(e/864e5);if(s<0&&"EM ANÃLISE"===o.status){if(Math.abs(s)>30)return;this.criarNotificacao({tipo:"prazo-vencido",titulo:"Prazo de Recurso Vencido",mensagem:`Recurso de ${o.recorrente} para ${o.produto_nome} estÃ¡ ${Math.abs(s)} dia(s) em atraso`,recurso_id:o.id,prioridade:"alta"})}else s<=1&&s>=0&&"EM ANÃLISE"===o.status&&this.criarNotificacao({tipo:"prazo-urgente",titulo:"Prazo de Recurso Urgente",mensagem:`Recurso de ${o.recorrente} para ${o.produto_nome} vence ${0===s?"hoje":"amanhÃ£"}`,recurso_id:o.id,prioridade:"media"})}))},async verificarPrazosJulgamento(){if(!this.produtosPendentes||0===this.produtosPendentes.length)return;const a=new Date;this.produtosPendentes.forEach((o=>{const t=new Date(o.criado_em),e=new Date(t);e.setDate(t.getDate()+10);const s=e-a,i=Math.ceil(s/864e5);if(i<0){if(Math.abs(i)>30)return;this.criarNotificacao({tipo:"julgamento-vencido",titulo:"Prazo de Julgamento Vencido",mensagem:`Produto ${o.nome} estÃ¡ ${Math.abs(i)} dia(s) sem julgamento da CCL`,produto_id:o.id,prioridade:"alta"})}else i<=2&&i>=0&&this.criarNotificacao({tipo:"julgamento-urgente",titulo:"Julgamento Urgente NecessÃ¡rio",mensagem:`Produto ${o.nome} precisa ser julgado em ${i} dia(s)`,produto_id:o.id,prioridade:"media"})}))},async verificarPrazosHomologacao(){if(this.processosPendentesHomologacao&&this.processosPendentesHomologacao.length>0){const a=new Date;this.processosPendentesHomologacao.forEach((o=>{const t=new Date(o.dataJulgamento),e=a-t,s=Math.floor(e/864e5);s>30||(s>10?this.criarNotificacao({tipo:"homologacao-atrasada",titulo:"HomologaÃ§Ã£o Atrasada",mensagem:`Ata ${o.numeroAta} aguarda homologaÃ§Ã£o hÃ¡ ${s} dias`,ata_id:o.id,prioridade:"alta"}):s>7&&this.criarNotificacao({tipo:"homologacao-urgente",titulo:"HomologaÃ§Ã£o Pendente",mensagem:`Ata ${o.numeroAta} aguarda homologaÃ§Ã£o hÃ¡ ${s} dias`,ata_id:o.id,prioridade:"media"}))}))}},criarNotificacao(a){const o=this.notificacoes.find((o=>o.tipo===a.tipo&&(o.recurso_id===a.recurso_id||o.produto_id===a.produto_id||o.ata_id===a.ata_id)));if(!o){const o={id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...a,criado_em:(new Date).toISOString(),lido:!1};this.notificacoes.unshift(o),this.notificacoes.length>20&&(this.notificacoes=this.notificacoes.slice(0,20)),"alta"===a.prioridade&&this.mostrarToast(o)}},atualizarContadoresAlertas(){this.prazosVencidos=this.notificacoes.filter((a=>a.tipo.includes("vencido")&&!a.lido)).length,this.prazosUrgentes=this.notificacoes.filter((a=>a.tipo.includes("urgente")&&!a.lido)).length},getAlertaIcon(a){switch(a){case"prazo-vencido":case"julgamento-vencido":case"homologacao-atrasada":return"ğŸš¨";case"prazo-urgente":case"julgamento-urgente":case"homologacao-urgente":return"âš ï¸";default:return"ğŸ“¢"}},abrirAlerta(a){let o=`\n        <div style="text-align: left; padding: 15px;">\n          <h4>${a.titulo}</h4>\n          <p>${a.mensagem}</p>\n          <hr>\n          <small><strong>Criado em:</strong> ${this.formatDate(a.criado_em)}</small>\n        `;if(a.recurso_id){const t=this.recursos.find((o=>o.id===a.recurso_id));t&&(o+=`\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="document.dispatchEvent(new CustomEvent('abrirRecurso', {detail: '${t.id}'}))">\n                ğŸ“‹ Analisar Recurso\n              </button>\n            </div>\n          `)}a.produto_id&&(o+=`\n          <div style="margin-top: 15px;">\n            <button class="swal2-confirm swal2-styled" onclick="document.dispatchEvent(new CustomEvent('abrirProduto', {detail: '${a.produto_id}'}))">\n              âš–ï¸ Julgar Processo\n            </button>\n          </div>\n        `),o+="</div>",this.$swal({title:"ğŸš¨ Detalhes do Alerta",html:o,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"âŒ Fechar"}),this.marcarComoLido(a.id)},marcarComoLido(a){const o=this.notificacoes.find((o=>o.id===a));o&&(o.lido=!0,this.atualizarContadoresAlertas())},marcarTodosComoLidos(){this.notificacoes.forEach((a=>a.lido=!0)),this.atualizarContadoresAlertas()},mostrarToast(a){this.$swal({title:a.titulo,text:a.mensagem,icon:"warning",toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0})},async criarNovaAtaAutomatica(){try{const{data:a,error:o}=await N.ND.from("processos_administrativos").select("\n            id,\n            numero_processo,\n            objeto,\n            status,\n            ata_emitida_ccl_em,\n            ata_julgamento_ccl,\n            recomendacao_ccl,\n            fundamentacao_legal_ccl,\n            consideracoes_adicionais_ccl,\n            observacoes_ccl\n          ").eq("tenant_id",this.currentTenantId).in("status",["ata_ccl","ata_julgamento_ccl_homologacao","ata_julgamento_ccl_indeferimento","ata_julgamento_ccl_aprovacao","ata_julgamento_ccl_rejeicao"]).not("ata_emitida_ccl_em","is",null);if(o)throw o;if(!a||0===a.length)return void this.$swal({title:"âš ï¸ Nenhum Processo DisponÃ­vel",text:"NÃ£o hÃ¡ processos julgados disponÃ­veis para incluir em uma nova ata. Realize julgamentos primeiro.",icon:"warning"});const t=(a,o=80)=>a?a.length>o?a.substring(0,o)+"...":a:"Processo de prÃ©-qualificaÃ§Ã£o",e=a.map((a=>`\n          <tr style="border-bottom: 1px solid #dee2e6; transition: background 0.2s;" onmouseover="this.style.background='#f8f9fa'" onmouseout="this.style.background='white'">\n            <td style="padding: 12px 8px; font-weight: bold; color: #0d6efd; vertical-align: top;">${a.numero_processo}</td>\n            <td style="padding: 12px 8px; word-wrap: break-word; line-height: 1.4; vertical-align: top;" title="${a.objeto||"Processo de prÃ©-qualificaÃ§Ã£o"}">${t(a.objeto,120)}</td>\n            <td style="padding: 12px 8px; text-align: center; vertical-align: top;">\n              <span style="padding: 6px 12px; border-radius: 16px; font-size: 12px; font-weight: 600; color: white; background: ${"recomendar_homologacao"===a.recomendacao_ccl?"#28a745":"#dc3545"}; display: inline-block; white-space: nowrap;">\n                ${"recomendar_homologacao"===a.recomendacao_ccl?"âœ… HomologaÃ§Ã£o":"âŒ Indeferimento"}\n              </span>\n            </td>\n            <td style="padding: 12px 8px; text-align: center; color: #6c757d; vertical-align: top; font-size: 12px;">${this.formatDate(a.ata_emitida_ccl_em)}</td>\n          </tr>\n        `)).join(""),s=await this.$swal({title:"ğŸ“‹ Criar Nova Ata de Julgamento",html:`\n            <div style="text-align: left; padding: 15px;">\n              \x3c!-- FormulÃ¡rio da Ata --\x3e\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">ğŸ“„ Dados da Ata</h4>\n                \n                \x3c!-- Linha 1: PerÃ­odo e NÃºmero lado a lado --\x3e\n                <div style="display: flex; gap: 15px; margin-bottom: 15px;">\n                  <div style="flex: 1;">\n                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">PerÃ­odo de ReferÃªncia:</label>\n                    <input id="periodoAta" class="swal2-input" type="text" placeholder="Ex: Janeiro 2025" value="${(new Date).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}" style="margin: 0; width: 100%;">\n                  </div>\n                  <div style="flex: 1;">\n                    <label style="display: block; font-weight: bold; margin-bottom: 5px;">NÃºmero da Ata:</label>\n                    <input id="numeroAta" class="swal2-input" type="text" placeholder="Ex: ATA-CCL-008/2025" value="ATA-CCL-${String(Math.floor(900*Math.random())+100)}/${(new Date).getFullYear()}" style="margin: 0; width: 100%;">\n                  </div>\n                </div>\n                \n                \x3c!-- Linha 2: DescriÃ§Ã£o --\x3e\n                <div style="margin-bottom: 0;">\n                  <label style="display: block; font-weight: bold; margin-bottom: 5px;">DescriÃ§Ã£o:</label>\n                  <textarea id="descricaoAta" class="swal2-textarea" placeholder="DescriÃ§Ã£o da ata de julgamento..." rows="3" style="margin: 0; width: 100%;">Ata de julgamento da ComissÃ£o de ContrataÃ§Ã£o ou LicitaÃ§Ã£o referente aos processos de prÃ©-qualificaÃ§Ã£o de bens do perÃ­odo.</textarea>\n                </div>\n              </div>\n\n              \x3c!-- Lista de Processos --\x3e\n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">ğŸ“‹ Processos a serem incluÃ­dos (${a.length})</h4>\n                <div style="max-height: 300px; overflow-y: auto; border: 1px solid #e9ecef; border-radius: 4px;">\n                  <table style="width: 100%; font-size: 13px; border-collapse: collapse;">\n                    <thead>\n                      <tr style="background: #f8f9fa; position: sticky; top: 0;">\n                        <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid #dee2e6; font-weight: 600; width: 15%;">Processo</th>\n                        <th style="padding: 12px 8px; text-align: left; border-bottom: 2px solid #dee2e6; font-weight: 600; width: 50%;">DescriÃ§Ã£o</th>\n                        <th style="padding: 12px 8px; text-align: center; border-bottom: 2px solid #dee2e6; font-weight: 600; width: 20%;">RecomendaÃ§Ã£o</th>\n                        <th style="padding: 12px 8px; text-align: center; border-bottom: 2px solid #dee2e6; font-weight: 600; width: 15%;">Data Julgamento</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      ${e}\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n\n              <div style="background: #d1ecf1; padding: 10px; border-radius: 4px; margin-top: 15px;">\n                <small><strong>ğŸ“ PrÃ³ximos passos:</strong> ApÃ³s criar a ata, ela estarÃ¡ disponÃ­vel na aba "Atas de Julgamento" para elaboraÃ§Ã£o do conteÃºdo e publicaÃ§Ã£o oficial.</small>\n              </div>\n            </div>\n          `,width:"900px",showCancelButton:!0,confirmButtonText:"âœ… Criar Ata com "+a.length+" Processos",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#28a745",preConfirm:()=>{const a=document.getElementById("periodoAta").value.trim(),o=document.getElementById("numeroAta").value.trim(),t=document.getElementById("descricaoAta").value.trim();return a&&o?{periodo:a,numero:o,descricao:t}:(this.$swal.showValidationMessage("Preencha o perÃ­odo e nÃºmero da ata"),!1)}});if(!s.isConfirmed)return;const i={tenant_id:this.currentTenantId,numero:s.value.numero,periodo:s.value.periodo,descricao:s.value.descricao,total_processos:a.length,status_ata:"ELABORACAO",conteudo_ata:this.gerarConteudoAtaComProdutos(a,s.value)},{data:r,error:n}=await N.ND.from("atas_julgamento").insert([i]).select();if(n)throw n;const c=r[0].id,{data:l,error:d}=await N.ND.from("produtos").select("id").in("processo_id",a.map((a=>a.id))).eq("tenant_id",this.currentTenantId);if(d)throw d;if(l&&l.length>0){const{error:a}=await N.ND.from("produtos").update({ata_julgamento_id:c,atualizado_em:(new Date).toISOString()}).in("id",l.map((a=>a.id)));if(a)throw a;console.log(`âœ… ${l.length} produtos vinculados Ã  ata ${c}`)}else console.warn("âš ï¸ Nenhum produto encontrado para vincular Ã  ata");await this.atualizarDadosAtas(),await this.carregarDados(!0),this.$swal({title:"âœ… Ata Criada com Sucesso!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>${s.value.numero}</h4>\n              <p><strong>PerÃ­odo:</strong> ${s.value.periodo}</p>\n              <p><strong>Processos incluÃ­dos:</strong> ${a.length}</p>\n              <hr>\n              <p>ğŸ”„ <strong>Status:</strong> ELABORAÃ‡ÃƒO</p>\n              <p>A ata foi criada e estÃ¡ disponÃ­vel na seÃ§Ã£o <strong>"ğŸ“ Atas em ElaboraÃ§Ã£o"</strong> para:</p>\n              <ul style="text-align: left; margin: 10px 0; padding-left: 30px;">\n                <li>Revisar conteÃºdo</li>\n                <li>Ajustar fundamentaÃ§Ãµes</li>\n                <li>Finalizar para publicaÃ§Ã£o</li>\n              </ul>\n            </div>\n          `,icon:"success",confirmButtonText:"ğŸ“ Ver Atas em ElaboraÃ§Ã£o",showCancelButton:!0,cancelButtonText:"âœ… OK"}).then((a=>{a.isConfirmed&&(this.activeTab="atas")}))}catch(a){console.error("Erro ao criar nova ata:",a),this.$swal({title:"âŒ Erro ao Criar Ata",text:`Erro: ${a.message}`,icon:"error"})}},async criarAtaAutomatica(a,o){try{console.log("ğŸ—ï¸ Criando ata automÃ¡tica para processo aprovado:",a.numero_processo);const t=new Date,e=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),r=`ATA-CCL-${e}${s}${i}-${String(a.id).slice(-4)}`,{data:n,error:c}=await N.ND.from("atas_julgamento").insert({tenant_id:this.currentTenantId,numero:r,processo_id:a.id,numero_processo:a.numero_processo,data_inicio:t.toISOString(),data_publicacao:t.toISOString(),periodo:`${s}/${e}`,total_processos:1,status_ata:"EM_ELABORACAO",conteudo_ata:`Ata de Julgamento CCL referente ao processo ${a.numero_processo}\n\nDECISÃƒO: APROVADO\n\nFUNDAMENTAÃ‡ÃƒO: ${o.fundamentacao}`,observacoes:`Ata criada automaticamente apÃ³s julgamento CCL do processo ${a.numero_processo}`}).select().single();if(c)return void console.error("Erro ao criar ata automÃ¡tica:",c);console.log("âœ… Ata automÃ¡tica criada:",r);const l=n.id,{data:d,error:u}=await N.ND.from("produtos").select("id, nome").eq("processo_id",a.id).eq("tenant_id",this.currentTenantId);if(!u&&d&&d.length>0){const{error:a}=await N.ND.from("produtos").update({ata_julgamento_id:l,status:"julgado_aprovado",atualizado_em:(new Date).toISOString()}).in("id",d.map((a=>a.id)));a?console.error("Erro ao vincular produtos:",a):console.log(`âœ… ${d.length} produtos vinculados Ã  ata automÃ¡tica ${l}`)}else console.warn("âš ï¸ Nenhum produto encontrado no processo para vincular Ã  ata automÃ¡tica");await this.atualizarDadosAtas()}catch(t){console.error("Erro ao criar ata automÃ¡tica:",t)}},async gerarPDFSomenteAta(a){try{console.log("ğŸ“„ Gerando PDF somente com dados da ata:",a.numero);const{data:o,error:e}=await N.ND.from("atas_julgamento").select("*").eq("id",a.id).eq("tenant_id",this.currentTenantId).single();if(e)throw console.error("Erro ao buscar ata completa:",e),e;if(!o)throw new Error("Ata nÃ£o encontrada no banco de dados");console.log("âœ… Ata encontrada no banco:",o.numero);const{jsPDF:s}=await Promise.resolve().then(t.bind(t,1749)),i=new s,r=i.internal.pageSize.getWidth(),n=i.internal.pageSize.getHeight(),c=20;let l=40;i.setFontSize(14),i.setFont("helvetica","bold"),i.text("SISTEMA COMPRAR BEM",r/2,l,{align:"center"}),l+=8,i.setFontSize(12),i.setFont("helvetica","normal"),i.text("GESTAO DE PROCESSOS ADMINISTRATIVOS",r/2,l,{align:"center"}),l+=15,i.setLineWidth(.5),i.line(c,l,r-c,l),l+=15,i.setFontSize(16),i.setFont("helvetica","bold"),i.text("ATA DE JULGAMENTO CCL",r/2,l,{align:"center"}),l+=20,i.setFontSize(11),i.setFont("helvetica","normal");let d=16;if(d+=32,o.descricao){d+=13;const a=i.splitTextToSize(o.descricao,r-50);d+=6*a.length+3}if(o.conteudo_ata){d+=21,i.setFontSize(10);const a=i.splitTextToSize(o.conteudo_ata,r-50);d+=6*a.length,i.setFontSize(11)}i.setDrawColor(0,0,0),i.setFillColor(245,245,245),i.roundedRect(c,l,r-2*c,d,2,2,"FD");let u=l+8;if(i.setFont("helvetica","bold"),i.text("Numero da Ata:",c+5,u),i.setFont("helvetica","normal"),i.text(o.numero||"Nao informado",c+45,u),u+=8,o.data_publicacao?(i.setFont("helvetica","bold"),i.text("Data de Publicacao:",c+5,u),i.setFont("helvetica","normal"),i.text(new Date(o.data_publicacao).toLocaleDateString("pt-BR"),c+55,u),u+=8):u+=8,o.status_ata?(i.setFont("helvetica","bold"),i.text("Status:",c+5,u),i.setFont("helvetica","normal"),i.text(o.status_ata,c+25,u),u+=8):u+=8,o.total_processos?(i.setFont("helvetica","bold"),i.text("Total de Processos:",c+5,u),i.setFont("helvetica","normal"),i.text(o.total_processos.toString(),c+55,u),u+=8):u+=8,o.descricao){u+=5,i.setFont("helvetica","bold"),i.text("Descricao da Ata:",c+5,u),u+=8,i.setFont("helvetica","normal"),i.setFontSize(10);const a=i.splitTextToSize(o.descricao,r-50);for(const o of a)i.text(o,c+5,u),u+=6;i.setFontSize(11),u+=3}if(o.conteudo_ata){u+=5,i.setFont("helvetica","bold"),i.text("Conteudo Completo da Ata:",c+5,u),u+=8,i.setLineWidth(.2),i.setDrawColor(100,100,100),i.line(c+5,u,r-c-5,u),u+=8,i.setFont("helvetica","normal"),i.setFontSize(10);const a=i.splitTextToSize(o.conteudo_ata,r-50);for(const o of a)i.text(o,c+5,u),u+=6;i.setFontSize(11)}l+=d+15;const m=n-25;i.setLineWidth(.3),i.line(c,m-5,r-c,m-5),i.setFontSize(9),i.setFont("helvetica","normal");const p=`Gerado em: ${(new Date).toLocaleDateString("pt-BR")} as ${(new Date).toLocaleTimeString("pt-BR")}`;i.text(p,c,m);const v="Sistema Comprar Bem - Gestao de Processos Administrativos";i.text(v,r-c,m,{align:"right"}),i.setFontSize(8),i.setFont("helvetica","italic"),i.text("Documento oficial gerado automaticamente pelo sistema",r/2,m+8,{align:"center"});const g=`Ata_CCL_${(o.numero||"SemNumero").replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;i.save(g),this.$swal({title:"âœ… PDF Gerado!",text:`Arquivo ${g} baixado com sucesso.`,icon:"success",timer:3e3,showConfirmButton:!1})}catch(o){console.error("Erro ao gerar PDF da ata:",o),this.$swal({title:"âŒ Erro ao Gerar PDF",text:o.message||"Erro interno do sistema",icon:"error"})}},async tramitarProcessoAta(a){try{console.log("ğŸ”„ Iniciando tramitaÃ§Ã£o para ata:",a.numero);const{data:o,error:t}=await N.ND.from("atas_julgamento").select("*").eq("id",a.id).eq("tenant_id",this.currentTenantId).single();if(t||!o)throw new Error("NÃ£o foi possÃ­vel encontrar os dados da ata");let e=[];if(console.log("ğŸ” DEBUG: Dados da ata completa:",o),console.log("ğŸ” DEBUG: processo_id:",o.processo_id),console.log("ğŸ” DEBUG: Processo jÃ¡ carregado em ata.ata_completa:",a.ata_completa?.processos_administrativos),a.ata_completa?.processos_administrativos&&(console.log("âœ… Usando processo jÃ¡ carregado:",a.ata_completa.processos_administrativos),e=[a.ata_completa.processos_administrativos]),0===e.length&&!o.processo_id&&o.numero_processo){console.log("ğŸ”§ CORREÃ‡ÃƒO: Encontrado numero_processo sem processo_id, buscando...");const{data:a,error:t}=await N.ND.from("processos_administrativos").select("id").eq("numero_processo",o.numero_processo).eq("tenant_id",this.currentTenantId).single();!t&&a&&(console.log("ğŸ”§ CORREÃ‡ÃƒO: Processo encontrado, atualizando ata..."),await N.ND.from("atas_julgamento").update({processo_id:a.id}).eq("id",o.id).eq("tenant_id",this.currentTenantId),o.processo_id=a.id,console.log("âœ… CORREÃ‡ÃƒO: Ata atualizada com processo_id:",a.id))}if(0===e.length&&o.processo_id){console.log("ğŸ” DEBUG: Buscando processo Ãºnico:",o.processo_id);const{data:a,error:t}=await N.ND.from("processos_administrativos").select("*").eq("id",o.processo_id).eq("tenant_id",this.currentTenantId).single();console.log("ğŸ” DEBUG: Resultado busca processo Ãºnico:",{data:a,error:t}),!t&&a&&(e=[a])}else if(0===e.length&&o.processos_incluidos&&o.processos_incluidos.length>0){console.log("ğŸ” DEBUG: Buscando processos consolidados:",o.processos_incluidos);const{data:a,error:t}=await N.ND.from("processos_administrativos").select("*").in("id",o.processos_incluidos).eq("tenant_id",this.currentTenantId);console.log("ğŸ” DEBUG: Resultado busca processos consolidados:",{data:a,error:t}),!t&&a&&(e=a)}if(0===e.length&&o.numeros_processos&&o.numeros_processos.length>0){console.log("ğŸ” DEBUG: FALLBACK - Buscando por nÃºmeros de processo:",o.numeros_processos);const{data:a,error:t}=await N.ND.from("processos_administrativos").select("*").in("numero_processo",o.numeros_processos).eq("tenant_id",this.currentTenantId);console.log("ğŸ” DEBUG: Resultado busca por nÃºmeros:",{data:a,error:t}),!t&&a&&(e=a)}if(0===e.length){console.log("ğŸ” DEBUG: FALLBACK 2 - Buscando processos com status de ata CCL");const{data:a,error:t}=await N.ND.from("processos_administrativos").select("*").eq("tenant_id",this.currentTenantId).in("status",["ata_ccl","ata_julgamento_emitida_ccl","em_prazo_recursal"]).order("created_at",{ascending:!1}).limit(10);if(console.log("ğŸ” DEBUG: Processos com status CCL encontrados:",a),!t&&a&&a.length>0){const{value:t}=await this.$swal({title:"ğŸ” Selecionar Processo",width:"650px",html:`\n                <div style="text-align: left; margin: 20px 0;">\n                  <p>NÃ£o foi possÃ­vel identificar automaticamente o processo relacionado Ã  ata <strong>${o.numero}</strong>.</p>\n                  <p>Selecione o processo correto:</p>\n                  <br>\n                  <div style="max-height: 350px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px; background: #fafafa;">\n                    ${a.map(((a,o)=>`\n                      <div \n                        data-processo-id="${a.id}"\n                        style="\n                          padding: 15px; \n                          margin: 5px;\n                          border-radius: 6px;\n                          border: 2px solid transparent;\n                          cursor: pointer; \n                          transition: all 0.2s;\n                          background: white;\n                          box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n                        " \n                        onmouseover="this.style.borderColor='#3b82f6'; this.style.transform='translateY(-1px)'"\n                        onmouseout="if(!this.classList.contains('selected')) { this.style.borderColor='transparent'; this.style.transform='translateY(0)'; }"\n                        onclick="\n                          document.querySelectorAll('[data-processo-id]').forEach(el => {\n                            el.classList.remove('selected');\n                            el.style.borderColor = 'transparent';\n                            el.style.backgroundColor = 'white';\n                          });\n                          this.classList.add('selected');\n                          this.style.borderColor = '#3b82f6';\n                          this.style.backgroundColor = '#eff6ff';\n                          document.getElementById('processoSelecionado').value = '${a.id}';\n                        ">\n                        <div style="font-weight: 600; color: #1e40af; font-size: 15px; margin-bottom: 8px;">\n                          ğŸ“‹ ${a.numero_processo}\n                        </div>\n                        <div style="display: flex; align-items: center; gap: 12px; font-size: 13px; color: #64748b;">\n                          <span style="background: #e0f2fe; color: #0369a1; padding: 4px 8px; border-radius: 4px; font-weight: 500;">\n                            ${a.status}\n                          </span>\n                          <span style="color: #6b7280;">\n                            ğŸ“… ${this.formatDate(a.created_at)}\n                          </span>\n                        </div>\n                      </div>\n                    `)).join("")}\n                  </div>\n                  <input type="hidden" id="processoSelecionado" value="">\n                  <div style="margin-top: 15px; padding: 12px; background: #f0f9ff; border: 1px solid #bfdbfe; border-radius: 6px; font-size: 13px; color: #1e40af;">\n                    ğŸ’¡ <strong>Dica:</strong> Clique em um processo para selecionÃ¡-lo antes de confirmar.\n                  </div>\n                </div>\n              `,showCancelButton:!0,confirmButtonText:"âœ… Confirmar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("processoSelecionado").value;return a||(this.$swal.showValidationMessage("Por favor, clique em um processo para selecionÃ¡-lo"),!1)}});if(t){const o=a.find((a=>a.id===t));o&&(e=[o])}}}if(console.log("ğŸ” DEBUG: Processos finais encontrados:",e),0===e.length)throw new Error("NÃ£o foi possÃ­vel encontrar processos relacionados Ã  ata. Verifique se a ata estÃ¡ corretamente vinculada aos processos.");const{value:s}=await this.$swal({title:"âš–ï¸ Tramitar Processo"+(e.length>1?"s":""),html:`\n            <div style="text-align: left; margin: 20px 0;">\n              <p><strong>Ata:</strong> ${o.numero}</p>\n              <p><strong>Processo${e.length>1?"s":""}:</strong> ${e.map((a=>a.numero_processo)).join(", ")}</p>\n              <br>\n              <p>A ata foi publicada. Conforme orientaÃ§Ã£o do cliente, a CCL deve submeter o processo Ã  decisÃ£o da Autoridade Competente:</p>\n            </div>\n            \n            <select id="tipoTramitacao" class="swal2-select" style="width: 100%; padding: 15px; margin: 20px 0; font-size: 16px;">\n              <option value="">Selecione a prÃ³xima etapa...</option>\n              <option value="autoridade">ğŸ‘¨â€ğŸ’¼ Submeter Ã  Autoridade Competente (para decisÃ£o)</option>\n              <option value="juridico">âš–ï¸ Enviar para Assessoria JurÃ­dica (se houver dÃºvidas)</option>\n            </select>\n          `,showCancelButton:!0,confirmButtonText:"âœ… Tramitar",cancelButtonText:"âŒ Cancelar",width:500,preConfirm:()=>{const a=document.getElementById("tipoTramitacao").value;return a||(this.$swal.showValidationMessage("Selecione o tipo de tramitaÃ§Ã£o"),!1)}});if(!s)return;await this.executarTramitacaoAta(e,s,o)}catch(o){console.error("Erro na tramitaÃ§Ã£o:",o),this.$swal({title:"âŒ Erro na TramitaÃ§Ã£o",text:o.message||"Erro interno do sistema",icon:"error"})}},async executarTramitacaoAta(a,o,t){try{let s="",i="";switch(o){case"autoridade":s="homologado",i=`Processo${a.length>1?"s":""} submetido${a.length>1?"s":""} Ã  Autoridade Competente para decisÃ£o`;break;case"juridico":s="analise_juridica",i=`Processo${a.length>1?"s":""} enviado${a.length>1?"s":""} para Assessoria JurÃ­dica`;break}for(const o of a){const{error:a}=await N.ND.from("processos_administrativos").update({status:s}).eq("id",o.id).eq("tenant_id",this.currentTenantId);if(a)throw a;try{await Ma.A.enviarNotificacaoTramitacao(o.id,o.status,s,`Processo tramitado via ata ${t.numero}. ${i}`)}catch(e){console.warn("Erro ao enviar notificaÃ§Ã£o por email:",e)}}await this.carregarDados(),await this.atualizarDadosAtas(),this.$swal({title:"âœ… TramitaÃ§Ã£o Realizada!",text:i,icon:"success",timer:3e3,showConfirmButton:!1})}catch(s){throw console.error("Erro ao executar tramitaÃ§Ã£o:",s),s}},async finalizarAtaElaboracao(a){try{const o=await this.$swal({title:"ğŸ¯ Finalizar Ata de Julgamento",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4 style="color: #495057; margin-bottom: 15px;">ğŸ“‹ ${a.numero_ata||a.numero}</h4>\n              <p style="margin-bottom: 20px; color: #666;">\n                Ao finalizar, esta ata serÃ¡ <strong>oficialmente publicada</strong> e movida para "ğŸ“‹ Atas Publicadas".\n              </p>\n              <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; margin: 15px 0;">\n                <strong>âš ï¸ AtenÃ§Ã£o:</strong><br>\n                ApÃ³s a publicaÃ§Ã£o, a ata nÃ£o poderÃ¡ mais ser editada.\n              </div>\n              <p style="color: #495057; margin-top: 15px;">\n                Confirma a <strong>finalizaÃ§Ã£o e publicaÃ§Ã£o</strong> desta ata?\n              </p>\n            </div>\n          `,icon:"question",showCancelButton:!0,confirmButtonText:"ğŸ¯ Sim, Finalizar e Publicar",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#dc3545"});if(!o.isConfirmed)return;const t=new Date,e=new Date(t);e.setDate(e.getDate()+3);const{error:s}=await N.ND.from("atas_julgamento").update({status_ata:"EM PRAZO",data_publicacao:t.toISOString(),data_inicio_prazo_recursal:t.toISOString(),data_fim_prazo_recursal:e.toISOString(),progresso_elaboracao:100,atualizado_em:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(s)throw s;await this.atualizarDadosAtas(),await this.$nextTick(),setTimeout((async()=>{await this.atualizarDadosAtas(),this.$forceUpdate()}),500),this.$swal({title:"ğŸ‰ Ata Finalizada e Publicada!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>${a.numero_ata||a.numero}</h4>\n              <p>âœ… Status atualizado para: <strong>EM PRAZO RECURSAL</strong></p>\n              <p>ğŸ“… Publicada em: <strong>${t.toLocaleDateString("pt-BR")}</strong></p>\n              <p>â° Prazo para recursos atÃ©: <strong>${e.toLocaleDateString("pt-BR")}</strong></p>\n              <hr style="margin: 20px 0;">\n              <p style="color: #28a745; font-weight: bold;">\n                ğŸ¯ A ata foi movida para "ğŸ“‹ Atas Publicadas"\n              </p>\n            </div>\n          `,icon:"success",confirmButtonText:"ğŸ“‹ Ver Atas Publicadas",showCancelButton:!0,cancelButtonText:"âœ… OK"}).then((a=>{a.isConfirmed&&console.log("âœ… Ata finalizada e usuÃ¡rio pode ver atas publicadas")}))}catch(o){console.error("Erro ao finalizar ata:",o),this.$swal({title:"âŒ Erro ao Finalizar Ata",text:o.message||"Erro interno do sistema",icon:"error"})}},async finalizarAta(a){const o=await this.$swal({title:"âœ… Finalizar Ata de Julgamento",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numero}</h4>\n            <p><strong>PerÃ­odo:</strong> ${a.periodo}</p>\n            <p><strong>Total de processos:</strong> ${a.totalProcessos}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <h5>âš ï¸ AtenÃ§Ã£o:</h5>\n              <p>Ao finalizar a ata:</p>\n              <ul style="text-align: left; margin-left: 20px;">\n                <li>SerÃ¡ gerado o documento PDF oficial</li>\n                <li>SerÃ¡ publicado extrato no DiÃ¡rio Oficial</li>\n                <li>SerÃ¡ aberto prazo recursal de 3 dias Ãºteis</li>\n                <li>A ata nÃ£o poderÃ¡ mais ser editada</li>\n              </ul>\n            </div>\n            <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Confirma a finalizaÃ§Ã£o?</strong> Esta aÃ§Ã£o nÃ£o pode ser desfeita.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"âœ… Confirmar FinalizaÃ§Ã£o",cancelButtonText:"âŒ Cancelar",confirmButtonColor:"#28a745"});if(o.isConfirmed)try{const o=new Date,t=this.adicionarDiasUteis(o,3),{error:e}=await N.ND.from("atas_julgamento").update({status_ata:"EM PRAZO",data_publicacao:o.toISOString(),data_inicio_prazo_recursal:o.toISOString(),data_fim_prazo_recursal:t.toISOString(),progresso_elaboracao:100,atualizado_em:(new Date).toISOString()}).eq("id",a.id).eq("tenant_id",this.currentTenantId);if(e)throw e;await this.atualizarDadosAtas(),await this.carregarDados(),await this.$nextTick(),setTimeout((async()=>{await this.atualizarDadosAtas(),this.$forceUpdate()}),500),this.$swal({title:"ğŸ‰ Ata Finalizada e Publicada!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>${a.numero}</h4>\n              <p>âœ… Status atualizado para: <strong>EM PRAZO RECURSAL</strong></p>\n              <p>ğŸ“… Publicada em: <strong>${o.toLocaleDateString("pt-BR")}</strong></p>\n              <p>â° Prazo recursal atÃ©: <strong>${t.toLocaleDateString("pt-BR")}</strong></p>\n              <hr>\n              <p>A ata agora estÃ¡ disponÃ­vel na seÃ§Ã£o <strong>"ğŸ“‹ Atas Publicadas Recentemente"</strong></p>\n            </div>\n          `,icon:"success"})}catch(t){console.error("Erro ao finalizar ata:",t),this.$swal({title:"âŒ Erro ao Finalizar",text:`Erro: ${t.message}`,icon:"error"})}},visualizarHistorico(){this.$swal({title:"ğŸ“Š HistÃ³rico de Atas",html:'\n          <div style="text-align: left; padding: 15px;">\n            <h5>Filtros de Pesquisa:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data inÃ­cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <select class="swal2-select" style="margin-bottom: 15px;">\n              <option value="">Todos os status</option>\n              <option value="elaboracao">Em elaboraÃ§Ã£o</option>\n              <option value="publicada">Publicadas</option>\n              <option value="prazo_recursal">Em prazo recursal</option>\n              <option value="encerrada">Encerradas</option>\n            </select>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>EstatÃ­sticas Gerais:</h6>\n              <p>ğŸ“‹ Total de atas: 25</p>\n              <p>âœ… Atas publicadas: 23</p>\n              <p>ğŸ“„ Processos julgados: 284</p>\n              <p>âš–ï¸ Taxa de aprovaÃ§Ã£o: 78%</p>\n            </div>\n          </div>\n        ',showCancelButton:!0,confirmButtonText:"ğŸ” Pesquisar",cancelButtonText:"âŒ Fechar"})},getStatusRecursalClass(a){switch(a){case"EM PRAZO":return"status-em-prazo";case"ENCERRADO":return"status-encerrado";case"COM RECURSOS":return"status-com-recursos";default:return"status-indefinido"}},async baixarPDF(a){try{console.log("ğŸ“„ Gerando PDF para ata:",a.numero),console.log("ğŸ” DEBUG: Dados completos da ata:",JSON.stringify(a,null,2));let o=null,e=[];if(a.processo_id){console.log("ğŸ”— Buscando processo especÃ­fico da ata:",a.processo_id);const t=await N.ND.from("processos_administrativos").select("*").eq("id",a.processo_id).eq("tenant_id",this.currentTenantId).single();t.error||(o=t.data,e=[o])}else if(a.processos_incluidos&&a.processos_incluidos.length>0){console.log("ğŸ”— Buscando processos consolidados da ata:",a.processos_incluidos);const t=await N.ND.from("processos_administrativos").select("*").in("id",a.processos_incluidos).eq("tenant_id",this.currentTenantId);!t.error&&t.data.length>0&&(e=t.data,o=e[0])}else{console.log("ğŸ” Fallback: Verificando produtos vinculados Ã  ata"),console.log("ğŸ” DEBUG: ata.id =",a.id,"tenant_id =",this.currentTenantId);const{data:t,error:s}=await N.ND.from("produtos").select("id, nome, marca, modelo").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId);if(console.log("ğŸ” DEBUG: Produtos encontrados:",t,"Error:",s),!s&&t&&t.length>0){console.log("âœ… Encontrados",t.length,"produtos vinculados Ã  ata");const s=a.numero?.match(/(\d{3}\/\d{4})/);if(s){const a=s[1];console.log("ğŸ” Tentando buscar processo pelo nÃºmero extraÃ­do da ata:",a);const t=await N.ND.from("processos_administrativos").select("*").eq("numero_processo",a).eq("tenant_id",this.currentTenantId);console.log("ğŸ” DEBUG: Resultado busca por nÃºmero:",t.data,"Error:",t.error),!t.error&&t.data.length>0&&(e=t.data,o=e[0],console.log("âœ… Encontrado processo pelo nÃºmero da ata:",o.numero_processo))}}if(!o&&a.data_publicacao){console.log("ğŸ” Fallback 2: Buscando processos por data de publicaÃ§Ã£o"),console.log("ğŸ” DEBUG: Data da ata:",a.data_publicacao);const t=new Date(a.data_publicacao);t.setHours(0,0,0,0);const s=new Date(a.data_publicacao);s.setHours(23,59,59,999),console.log("ğŸ” DEBUG: Range de data:",t.toISOString(),"atÃ©",s.toISOString());const i=await N.ND.from("processos_administrativos").select("*").eq("tenant_id",this.currentTenantId).eq("status","aprovado_ccl").gte("ata_emitida_ccl_em",t.toISOString()).lte("ata_emitida_ccl_em",s.toISOString());console.log("ğŸ” DEBUG: Processos por data:",i.data,"Error:",i.error),!i.error&&i.data.length>0&&(e=i.data,o=e[0],console.log("âœ… Encontrados processos por data:",e.map((a=>a.numero_processo))))}if(!o){console.log("ğŸ” Fallback 3: Buscando qualquer processo aprovado recente");const a=await N.ND.from("processos_administrativos").select("*").eq("tenant_id",this.currentTenantId).eq("status","aprovado_ccl").order("ata_emitida_ccl_em",{ascending:!1}).limit(5);console.log("ğŸ” DEBUG: Processos recentes:",a.data,"Error:",a.error),!a.error&&a.data.length>0&&(e=a.data,o=e[0],console.log("âœ… Usando processo recente como fallback:",o.numero_processo))}}if(!o||0===e.length)return void this.$swal({title:"âŒ Erro",text:"NÃ£o foi possÃ­vel encontrar o(s) processo(s) relacionado(s) Ã  ata. Verifique se a ata estÃ¡ corretamente vinculada aos processos.",icon:"error"});const{jsPDF:s}=await Promise.resolve().then(t.bind(t,1749)),{data:i,error:r}=await N.ND.from("produtos").select("\n            id,\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            status,\n            julgado_em,\n            adequacao_tecnica,\n            observacoes_ccl,\n            base_legal\n          ").eq("ata_julgamento_id",a.id).eq("tenant_id",this.currentTenantId);if(r)throw r;const n=new s,c=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight();let d=25;n.setFontSize(16),n.setFont(void 0,"bold"),n.text("COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)",c/2,d,{align:"center"}),d+=8,n.setFontSize(12),n.setFont(void 0,"normal"),n.text("Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021",c/2,d,{align:"center"}),d+=15,n.setLineWidth(.5),n.line(30,d,c-30,d),d+=20,n.setFontSize(18),n.setFont(void 0,"bold"),n.text("ATA DE JULGAMENTO",c/2,d,{align:"center"}),d+=15,n.setFontSize(12),n.setFont(void 0,"normal"),n.text(`NÃºmero: ${a.numero||"NÃ£o informado"}`,30,d),d+=8,n.text(`PerÃ­odo: ${a.periodo||"NÃ£o informado"}`,30,d),d+=8,n.text(`Data de PublicaÃ§Ã£o: ${this.formatDate(a.dataPublicacao||a.data_publicacao)}`,30,d),d+=8,n.text(`Status: ${a.statusRecursal||a.status_recursal||a.status_ata||"NÃ£o informado"}`,30,d),d+=20;const u=i?.filter((a=>"julgado_aprovado"===a.status))||[],m=i?.filter((a=>"julgado_reprovado"===a.status))||[];if(n.setFontSize(14),n.setFont(void 0,"bold"),n.text("RESUMO DOS JULGAMENTOS",30,d),d+=15,n.setFontSize(11),n.setFont(void 0,"normal"),n.text("Total de processos julgados: 1",35,d),d+=8,n.text(`Produtos aprovados: ${u.length}`,35,d),d+=8,n.text(`Produtos reprovados: ${m.length}`,35,d),d+=20,u.length>0&&(n.setFontSize(14),n.setFont(void 0,"bold"),n.text("PRODUTOS APROVADOS",30,d),d+=12,u.forEach(((a,o)=>{d>l-40&&(n.addPage(),d=30),n.setFontSize(11),n.setFont(void 0,"bold"),n.text(`${o+1}. ${a.nome||"Nome nÃ£o informado"}`,35,d),d+=6,n.setFont(void 0,"normal"),n.text(`Marca: ${a.marca||"NÃ£o informada"} | Modelo: ${a.modelo||"NÃ£o informado"}`,40,d),d+=6,n.text(`Fabricante: ${a.fabricante||"NÃ£o informado"}`,40,d),d+=6,n.text(`Julgado em: ${this.formatDate(a.julgado_em)||"Data nÃ£o informada"}`,40,d),d+=6,a.adequacao_tecnica&&(n.text(`AdequaÃ§Ã£o TÃ©cnica: ${a.adequacao_tecnica}`,40,d),d+=6),d+=5})),d+=10),m.length>0&&(d>l-60&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("PRODUTOS REPROVADOS",30,d),d+=12,m.forEach(((a,o)=>{d>l-40&&(n.addPage(),d=30),n.setFontSize(11),n.setFont(void 0,"bold"),n.text(`${o+1}. ${a.nome||"Nome nÃ£o informado"}`,35,d),d+=6,n.setFont(void 0,"normal"),n.text(`Marca: ${a.marca||"NÃ£o informada"} | Modelo: ${a.modelo||"NÃ£o informado"}`,40,d),d+=6,n.text(`Fabricante: ${a.fabricante||"NÃ£o informado"}`,40,d),d+=6,n.text(`Julgado em: ${this.formatDate(a.julgado_em)||"Data nÃ£o informada"}`,40,d),d+=6,a.observacoes_ccl&&(n.setFont(void 0,"italic"),n.text(`Motivo: ${a.observacoes_ccl}`,40,d),d+=6),d+=5}))),a.conteudoAta||a.conteudo_ata){d>l-80&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("CONTEÃšDO COMPLETO DA ATA",30,d),d+=12,n.setFontSize(10),n.setFont(void 0,"normal");let t=a.conteudoAta||a.conteudo_ata;t&&""!==t.trim()&&"conteudo da ata"!==t||(t=`\nPROCESSO${e.length>1?"S":""} NÂº: ${e.length>1?e.map((a=>a.numero_processo)).join(", "):o?.numero_processo||"NÃ£o informado"}\n\nOBJETO: PrÃ©-qualificaÃ§Ã£o de bens conforme Lei 14.133/2021\n\nDECISÃƒO DA CCL: APROVADO\n\nFUNDAMENTAÃ‡ÃƒO: A ComissÃ£o Central de LicitaÃ§Ã£o, apÃ³s anÃ¡lise tÃ©cnica detalhada dos produtos apresentados, considerando os aspectos tÃ©cnicos, normativos e de conformidade com as especificaÃ§Ãµes estabelecidas, deliberou pela APROVAÃ‡ÃƒO dos produtos relacionados neste processo.\n\n${u.length>0?`\nPRODUTOS APROVADOS (${u.length}):\n${u.map(((a,o)=>`${o+1}. ${a.nome} - ${a.marca} (${a.modelo})`)).join("\n")}\n`:""}\n\nOs produtos aprovados atendem aos requisitos tÃ©cnicos e normativos aplicÃ¡veis, estando aptos para inclusÃ£o no catÃ¡logo eletrÃ´nico de bens padronizados.\n\nPRÃ“XIMOS PASSOS: Processo encaminhado Ã  Assessoria JurÃ­dica para anÃ¡lise da conformidade legal.\n\nData do julgamento: ${this.formatDate(a.dataPublicacao||a.data_publicacao)}\n            `.trim());const s=n.splitTextToSize(t,c-70);n.text(s,35,d)}const p=n.internal.getNumberOfPages();for(let a=1;a<=p;a++)n.setPage(a),n.setLineWidth(.3),n.line(30,l-25,c-30,l-25),n.setFontSize(8),n.setFont(void 0,"normal"),n.text("Sistema Comprar Bem - Atas de Julgamento CCL",30,l-18),n.text(`PÃ¡gina ${a} de ${p}`,c/2,l-18,{align:"center"}),n.text("Lei 14.133/2021",c-30,l-18,{align:"right"}),n.text(`Gerado em: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}`,30,l-12);const v=`ATA_${(a.numero||"SemNumero").replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;n.save(v),this.$swal({title:"âœ… PDF Gerado!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>ğŸ“‹ ${a.numero||"Ata sem nÃºmero"}</h4>\n              <p><strong>Arquivo:</strong> ${v}</p>\n              <p>PDF da ata de julgamento gerado com sucesso!</p>\n              <p><strong>ğŸ“Š ConteÃºdo:</strong></p>\n              <ul style="text-align: left; margin: 10px 0; padding-left: 30px;">\n                <li>${u.length} produto(s) aprovado(s)</li>\n                <li>${m.length} produto(s) reprovado(s)</li>\n                <li>InformaÃ§Ãµes detalhadas de cada julgamento</li>\n                <li>Base legal e fundamentaÃ§Ãµes</li>\n              </ul>\n            </div>\n          `,icon:"success"})}catch(o){console.error("Erro ao gerar PDF da ata:",o),this.$swal({title:"âŒ Erro ao Gerar PDF",text:`Erro: ${o.message}`,icon:"error"})}},async gerenciarRecursos(a){try{const{data:o,error:t}=await N.ND.from("recursos").select("*").eq("ata_referencia",a.numero).eq("tenant_id",this.currentTenantId).order("data_recurso",{ascending:!1});t&&console.warn("Erro ao carregar recursos (talvez tabela nÃ£o exista):",t);const e=o||[],s=this.formatDate(a.dataFimPrazoRecursal),i=a.dataFimPrazoRecursal&&new Date(a.dataFimPrazoRecursal)<new Date;this.$swal({title:"ğŸ“„ Gerenciar Recursos Administrativos",html:`\n            <div style="text-align: left; padding: 15px; max-height: 500px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h4 style="margin: 0 0 10px 0; color: #495057;">ğŸ“‹ InformaÃ§Ãµes da Ata</h4>\n                <p><strong>NÃºmero:</strong> ${a.numero}</p>\n                <p><strong>Data PublicaÃ§Ã£o:</strong> ${this.formatDate(a.dataPublicacao)}</p>\n                <p><strong>Status Recursal:</strong> ${a.statusRecursal}</p>\n                <p><strong>Prazo para Recursos:</strong> ${s||"NÃ£o definido"}</p>\n                ${i?'<p style="color: #dc3545; font-weight: bold;">âš ï¸ Prazo recursal VENCIDO</p>':'<p style="color: #28a745; font-weight: bold;">âœ… Prazo recursal ATIVO</p>'}\n              </div>\n              \n              <div style="background: #fff; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 15px 0; color: #495057;">ğŸ“„ Recursos Protocolados (${e.length})</h4>\n                ${e.length>0?e.map((a=>`\n                    <div style="border-bottom: 1px solid #eee; padding: 10px 0;">\n                      <div style="display: flex; justify-content: space-between; align-items: center;">\n                        <div>\n                          <strong>${a.recorrente||"Recorrente nÃ£o informado"}</strong>\n                          <p style="margin: 5px 0; color: #666;">Produto: ${a.produto_nome||"NÃ£o especificado"}</p>\n                          <small>Protocolado em: ${this.formatDate(a.data_recurso)}</small>\n                        </div>\n                        <span class="status-badge ${this.getRecursoStatusClass(a.status)}">\n                          ${a.status||"EM ANÃLISE"}\n                        </span>\n                      </div>\n                    </div>\n                  `)).join(""):'<div style="text-align: center; color: #666; padding: 20px;"><p><em>Nenhum recurso protocolado ainda.</em></p></div>'}\n              </div>\n              \n              ${i?"":'\n                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n                  <h5 style="color: #1976d2; margin: 0 0 10px 0;">âš¡ AÃ§Ãµes DisponÃ­veis</h5>\n                  <button id="novoRecurso" class="swal2-confirm swal2-styled" style="margin: 5px;">\n                    â• Protocolar Novo Recurso\n                  </button>\n                  <button id="analisarRecursos" class="swal2-confirm swal2-styled" style="margin: 5px; background: #4caf50;">\n                    ğŸ” Analisar Recursos Existentes\n                  </button>\n                </div>\n              '}\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px;">\n                <small><strong>ğŸ“š Base Legal:</strong> Art. 165-171 da Lei 14.133/2021 - Recursos administrativos em processos licitatÃ³rios</small>\n              </div>\n            </div>\n          `,width:"700px",showCancelButton:!0,confirmButtonText:"ğŸ“¥ Gerar RelatÃ³rio PDF",cancelButtonText:"âŒ Fechar",didOpen:()=>{const o=document.getElementById("novoRecurso"),t=document.getElementById("analisarRecursos");o&&(o.onclick=()=>{this.$swal.close(),this.novoRecurso(a)}),t&&(t.onclick=()=>{this.$swal.close(),this.analisarRecursos(a,e)})}})}catch(o){console.error("Erro ao gerenciar recursos:",o),this.$swal({title:"âŒ Erro ao Carregar Recursos",text:`Erro: ${o.message}`,icon:"error"})}},async novoRecurso(a){try{const o=await this.$swal({title:"â• Protocolar Novo Recurso",html:`\n            <div style="text-align: left; padding: 15px;">\n              <p><strong>Ata:</strong> ${a.numero}</p>\n              <hr>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Recorrente:</label>\n                <input id="recorrente" class="swal2-input" type="text" placeholder="Nome da empresa/pessoa">\n              </div>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Documento (CNPJ/CPF) - <em>Opcional</em>:</label>\n                <input id="documento" class="swal2-input" type="text" placeholder="CNPJ ou CPF do recorrente (opcional)">\n              </div>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Produto/Processo:</label>\n                <input id="produtoNome" class="swal2-input" type="text" placeholder="Nome do produto contestado">\n              </div>\n              <div style="margin-bottom: 15px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">FundamentaÃ§Ã£o do Recurso:</label>\n                <textarea id="fundamentacao" class="swal2-textarea" rows="4" placeholder="Descreva os motivos e fundamentos legais do recurso..."></textarea>\n              </div>\n              <div style="background: #f8f9fa; padding: 10px; border-radius: 4px;">\n                <small><strong>âš ï¸ Prazo:</strong> Recursos devem ser protocolados em atÃ© 3 dias Ãºteis apÃ³s a publicaÃ§Ã£o da ata.</small>\n              </div>\n            </div>\n          `,showCancelButton:!0,confirmButtonText:"âœ… Protocolar Recurso",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("recorrente").value.trim(),o=document.getElementById("documento").value.trim(),t=document.getElementById("produtoNome").value.trim(),e=document.getElementById("fundamentacao").value.trim();return a&&t&&e?{recorrente:a,documento:o,produtoNome:t,fundamentacao:e}:(this.$swal.showValidationMessage("Preencha todos os campos obrigatÃ³rios"),!1)}});if(!o.isConfirmed)return;const t=new Date,e=this.adicionarDiasUteis(t,3),s={tenant_id:this.currentTenantId,ata_referencia:a.numero,produto_nome:o.value.produtoNome,recorrente:o.value.recorrente,documento_recorrente:o.value.documento,data_recurso:t.toISOString(),prazo_final:e.toISOString(),fundamentacao:o.value.fundamentacao,status:"EM ANÃLISE"},{data:i,error:r}=await N.ND.from("recursos").insert([s]).select();if(r)return console.error("Erro ao inserir recurso:",r),void(r.message.includes('relation "recursos" does not exist')||"42P01"===r.code||r.message.includes("recursos")?this.$swal({title:"âš ï¸ Tabela de Recursos NÃ£o Encontrada",html:`\n                <div style="text-align: left; padding: 15px;">\n                  <p>A tabela de recursos ainda nÃ£o foi criada no banco de dados.</p>\n                  <p><strong>AÃ§Ã£o necessÃ¡ria:</strong></p>\n                  <ol>\n                    <li>Execute o script SQL: <code>criar_tabela_recursos.sql</code></li>\n                    <li>Depois tente protocolar o recurso novamente</li>\n                  </ol>\n                  <hr>\n                  <p><strong>Erro tÃ©cnico:</strong> ${r.message}</p>\n                  <p><strong>Dados do recurso (temporÃ¡rio):</strong></p>\n                  <p><strong>Recorrente:</strong> ${o.value.recorrente}</p>\n                  <p><strong>Produto:</strong> ${o.value.produtoNome}</p>\n                  <p><strong>Status:</strong> Aguardando criaÃ§Ã£o da tabela</p>\n                </div>\n              `,icon:"warning"}):this.$swal({title:"âŒ Erro ao Protocolar Recurso",text:`Erro: ${r.message}`,icon:"error"}));await this.carregarRecursos(),await this.carregarDados();const n=`REC-${String(i[0].id).substring(0,8).toUpperCase()}/${(new Date).getFullYear()}`;this.$swal({title:"âœ… Recurso Protocolado com Sucesso!",html:`\n            <div style="text-align: center; padding: 20px;">\n              <h4>ğŸ“„ Protocolo: ${n}</h4>\n              <p><strong>Recorrente:</strong> ${o.value.recorrente}</p>\n              <p><strong>Produto:</strong> ${o.value.produtoNome}</p>\n              <p><strong>Status:</strong> EM ANÃLISE</p>\n              <p><strong>Prazo para DecisÃ£o:</strong> ${this.formatDate(e)}</p>\n              <hr>\n              <p>O recurso foi protocolado e serÃ¡ analisado pela ComissÃ£o dentro do prazo legal.</p>\n            </div>\n          `,icon:"success",confirmButtonText:"ğŸ“‹ Ver Recursos",showCancelButton:!0,cancelButtonText:"âœ… OK"}).then((a=>{a.isConfirmed&&(this.activeTab="dashboard")}))}catch(o){console.error("Erro ao criar recurso:",o),this.$swal({title:"âŒ Erro ao Protocolar Recurso",text:`Erro: ${o.message}`,icon:"error"})}},async analisarRecursos(a,o){try{let t=o;if(!t||0===t.length){const{data:o,error:e}=await N.ND.from("recursos").select("*").eq("ata_referencia",a.numero).eq("tenant_id",this.currentTenantId).order("data_recurso",{ascending:!1});!e&&o&&(t=o)}if(!t||0===t.length)return void this.$swal({title:"ğŸ“„ Nenhum Recurso Encontrado",text:`NÃ£o hÃ¡ recursos protocolados para a ata ${a.numero}.`,icon:"info"});const e=t.map((a=>{const o=new Date(a.prazo_final)<new Date,t="EM ANÃLISE"===a.status?"#ffc107":"DEFERIDO"===a.status?"#28a745":"INDEFERIDO"===a.status?"#dc3545":"#6c757d";return`\n            <div style="border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: #fff;">\n              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                <h6 style="margin: 0; color: #495057;">ğŸ“„ ${a.produto_nome}</h6>\n                <span style="background: ${t}; color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">\n                  ${a.status}\n                </span>\n              </div>\n              <p style="margin: 5px 0;"><strong>Recorrente:</strong> ${a.recorrente}</p>\n              <p style="margin: 5px 0;"><strong>Data do Recurso:</strong> ${this.formatDate(a.data_recurso)}</p>\n              <p style="margin: 5px 0;"><strong>Prazo Final:</strong> ${this.formatDate(a.prazo_final)} \n                ${o?'<span style="color: #dc3545; font-weight: bold;">(VENCIDO)</span>':'<span style="color: #28a745; font-weight: bold;">(EM PRAZO)</span>'}\n              </p>\n              \n              <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">\n                <strong>FundamentaÃ§Ã£o:</strong><br>\n                <small>${a.fundamentacao||"NÃ£o informada"}</small>\n              </div>\n              \n              ${"EM ANÃLISE"===a.status?`\n                <button onclick="analisarRecursoEspecifico('${a.id}')" \n                        style="background: #007bff; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; margin-top: 10px;">\n                  ğŸ“‹ Analisar Este Recurso\n                </button>\n              `:a.decisao?`\n                <div style="background: #e9ecef; padding: 10px; border-radius: 4px; margin-top: 10px; font-size: 14px;">\n                  <strong>DecisÃ£o:</strong> ${a.decisao.toUpperCase()}<br>\n                  <strong>ResponsÃ¡vel:</strong> ${a.responsavel_decisao||"NÃ£o informado"}<br>\n                  <strong>Data:</strong> ${this.formatDate(a.data_decisao)}\n                </div>\n              `:""}\n            </div>\n          `})).join("");this.$swal({title:"ğŸ” AnÃ¡lise de Recursos Administrativos",html:`\n            <div style="text-align: left; padding: 15px; max-height: 600px; overflow-y: auto;">\n              <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h5 style="margin: 0 0 10px 0; color: #495057;">ğŸ“‹ InformaÃ§Ãµes da Ata</h5>\n                <p><strong>NÃºmero:</strong> ${a.numero}</p>\n                <p><strong>Total de Recursos:</strong> ${t.length}</p>\n                <p><strong>Em AnÃ¡lise:</strong> ${t.filter((a=>"EM ANÃLISE"===a.status)).length}</p>\n                <p><strong>Julgados:</strong> ${t.filter((a=>"EM ANÃLISE"!==a.status)).length}</p>\n              </div>\n              \n              <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">\n                <h6 style="color: #1976d2; margin: 0 0 10px 0;">âš–ï¸ Processo de AnÃ¡lise</h6>\n                <ol style="margin: 0; padding-left: 20px; font-size: 14px;">\n                  <li>VerificaÃ§Ã£o da tempestividade (3 dias Ãºteis)</li>\n                  <li>AnÃ¡lise da fundamentaÃ§Ã£o legal</li>\n                  <li>AvaliaÃ§Ã£o tÃ©cnica do mÃ©rito</li>\n                  <li>AnÃ¡lise tÃ©cnica e recomendaÃ§Ã£o motivada Ã  Autoridade Competente</li>\n                  <li>ComunicaÃ§Ã£o Ã s partes interessadas</li>\n                </ol>\n              </div>\n              \n              <h6 style="color: #495057; margin-bottom: 15px;">ğŸ“„ Recursos Protocolados:</h6>\n              ${e}\n            </div>\n          `,width:"900px",confirmButtonText:"ğŸ“Š Gerar RelatÃ³rio Geral",showCancelButton:!0,cancelButtonText:"âŒ Fechar",didOpen:()=>{window.analisarRecursoEspecifico=a=>{this.$swal.close();const o=t.find((o=>o.id===a));o&&this.analisarRecurso(o)}}}).then((o=>{o.isConfirmed&&this.gerarRelatorioRecursos(a,t)}))}catch(t){console.error("Erro ao analisar recursos:",t),this.$swal({title:"âŒ Erro ao Carregar Recursos",text:`Erro: ${t.message}`,icon:"error"})}},async gerarRelatorioRecursos(a,o){try{const{jsPDF:e}=await Promise.resolve().then(t.bind(t,1749)),s=new e,i=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight();let n=25;s.setFontSize(16),s.setFont(void 0,"bold"),s.text("COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)",i/2,n,{align:"center"}),n+=8,s.setFontSize(12),s.setFont(void 0,"normal"),s.text("Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021",i/2,n,{align:"center"}),n+=15,s.setLineWidth(.5),s.line(30,n,i-30,n),n+=20,s.setFontSize(16),s.setFont(void 0,"bold"),s.text("RELATÃ“RIO GERAL DE RECURSOS ADMINISTRATIVOS",i/2,n,{align:"center"}),n+=20,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("I. INFORMAÃ‡Ã•ES DA ATA",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal");const c=[["NÃºmero da Ata:",a.numero],["Total de Recursos:",o.length.toString()],["Em AnÃ¡lise:",o.filter((a=>"EM ANÃLISE"===a.status)).length.toString()],["Deferidos:",o.filter((a=>"DEFERIDO"===a.status)).length.toString()],["Indeferidos:",o.filter((a=>"INDEFERIDO"===a.status)).length.toString()],["Data do RelatÃ³rio:",this.formatDate(new Date)]];c.forEach((([a,o])=>{s.setFont(void 0,"bold"),s.text(a,35,n),s.setFont(void 0,"normal"),s.text(o,100,n),n+=8})),n+=15,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("II. RECURSOS PROTOCOLADOS",30,n),n+=12,o.forEach(((a,o)=>{n>r-60&&(s.addPage(),n=30),s.setFontSize(12),s.setFont(void 0,"bold"),s.text(`${o+1}. ${a.produto_nome}`,35,n),n+=10,s.setFontSize(10),s.setFont(void 0,"normal");const t=[`Recorrente: ${a.recorrente}`,`Data do Recurso: ${this.formatDate(a.data_recurso)}`,`Prazo Final: ${this.formatDate(a.prazo_final)}`,`Status: ${a.status}`];if(a.decisao&&(t.push(`DecisÃ£o: ${a.decisao.toUpperCase()}`),t.push(`ResponsÃ¡vel: ${a.responsavel_decisao||"NÃ£o informado"}`),t.push(`Data da DecisÃ£o: ${this.formatDate(a.data_decisao)}`)),t.forEach((a=>{s.text(a,40,n),n+=6})),a.fundamentacao){s.text("FundamentaÃ§Ã£o:",40,n),n+=6;const o=s.splitTextToSize(a.fundamentacao,i-80);s.text(o,45,n),n+=5*o.length}n+=10})),s.setFontSize(8),s.text(`RelatÃ³rio gerado em: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}`,30,r-15),s.text("Sistema Comprar Bem - Recursos Administrativos",i-30,r-15,{align:"right"});const l=`Relatorio_Recursos_${(a.numero||"SemNumero").replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;s.save(l),this.$swal({title:"ğŸ“„ RelatÃ³rio Gerado!",text:`O relatÃ³rio PDF foi gerado com sucesso: ${l}`,icon:"success"})}catch(e){console.error("Erro ao gerar relatÃ³rio:",e),this.$swal({title:"âŒ Erro ao Gerar RelatÃ³rio",text:`Erro: ${e.message}`,icon:"error"})}},calcularPrazoHomologacao(a){if(!a)return"Sem prazo";const o=new Date(a),t=new Date,e=this.adicionarDiasUteis(o,10);if(t>e){const a=this.calcularDiasUteisEntre(e,t);return`Vencido hÃ¡ ${a} dia${a>1?"s":""} Ãºteis`}const s=this.calcularDiasUteisEntre(t,e);return 0===s?"Ãšltimo dia Ãºtil":1===s?"1 dia Ãºtil restante":`${s} dias Ãºteis restantes`},getPrazoHomologacaoClass(a){if(!a)return"prazo-indefinido";const o=new Date(a),t=new Date,e=this.adicionarDiasUteis(o,10);if(t>e)return"prazo-vencido";const s=this.calcularDiasUteisEntre(t,e);return s<=1?"prazo-urgente":s<=3?"prazo-atencao":"prazo-normal"},consultarPendentes(){this.$swal({title:"ğŸ“‹ Consulta de Processos Pendentes",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h5>Filtros de Pesquisa:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data inÃ­cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <select class="swal2-select" style="margin-bottom: 15px;">\n              <option value="">Todos os status de recursos</option>\n              <option value="sem_recursos">Sem recursos</option>\n              <option value="recursos_julgados">Recursos julgados</option>\n              <option value="com_recursos_pendentes">Com recursos pendentes</option>\n            </select>\n            <hr>\n            <div style="background: #e3f2fd; padding: 15px; border-radius: 4px;">\n              <h6>Resumo de PendÃªncias:</h6>\n              <p>â³ Aguardando homologaÃ§Ã£o: ${this.homologacoesPendentes}</p>\n              <p>ğŸ“‹ Atas sem recursos: 2</p>\n              <p>ğŸ“„ Atas com recursos julgados: 1</p>\n              <p>âš¡ Urgente (> 15 dias): 0</p>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"ğŸ” Aplicar Filtros",cancelButtonText:"âŒ Fechar"})},relatorioHomologacoes(){this.$swal({title:"ğŸ“Š RelatÃ³rio de HomologaÃ§Ãµes",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h5>PerÃ­odo do RelatÃ³rio:</h5>\n            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">\n              <input type="date" class="swal2-input" placeholder="Data inÃ­cio" style="margin: 0;">\n              <input type="date" class="swal2-input" placeholder="Data fim" style="margin: 0;">\n            </div>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>EstatÃ­sticas Gerais (Este Ano):</h6>\n              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">\n                <div>\n                  <p><strong>âœ… HomologaÃ§Ãµes:</strong> ${this.homologacoesAprovadas+47}</p>\n                  <p><strong>âŒ Indeferimentos:</strong> ${this.homologacoesIndeferidas+3}</p>\n                  <p><strong>ğŸ“œ DCBs Emitidas:</strong> ${this.dcbsEmitidas}</p>\n                </div>\n                <div>\n                  <p><strong>â±ï¸ Tempo MÃ©dio:</strong> 5,2 dias</p>\n                  <p><strong>ğŸ“‹ Taxa AprovaÃ§Ã£o:</strong> 94%</p>\n                  <p><strong>ğŸ”„ RenovaÃ§Ãµes:</strong> 23</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"ğŸ“¥ Gerar PDF",cancelButtonText:"âŒ Fechar"})},baixarPDFHomologacao(a){this.$swal({title:"ğŸ“¥ Download de HomologaÃ§Ã£o",text:`Baixando documento de homologaÃ§Ã£o ${a.numeroAta}...`,icon:"info",timer:2e3,showConfirmButton:!1})},visualizarDCBs(a){this.$swal({title:"ğŸ“œ DCBs da HomologaÃ§Ã£o",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Data:</strong> ${this.formatDate(a.dataHomologacao)}</p>\n            <hr>\n            <h5>DCBs Emitidas:</h5>\n            <div style="background: #f8f9fa; padding: 10px; border-radius: 4px; margin: 10px 0;">\n              <p><strong>DCB 001/2024:</strong> Monitor de Sinais Vitais - MedTech Pro</p>\n              <p><strong>DCB 002/2024:</strong> Desfibrilador AutomÃ¡tico - CardiacSafe</p>\n              <p><strong>DCB 003/2024:</strong> Autoclave Hospitalar - SterilMax</p>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.open('/api/downloads/dcbs-todas.pdf', '_blank')">\n                ğŸ“¥ Baixar Todas as DCBs\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"âŒ Fechar"})},notificarFornecedores(a){this.$swal({title:"ğŸ“§ Notificar Fornecedores",html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>Ata: ${a.numeroAta}</h4>\n            <p><strong>Tipo:</strong> ${"homologada"===a.tipo?"HomologaÃ§Ã£o":"Indeferimento"}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Tipo de NotificaÃ§Ã£o:</label>\n              <select class="swal2-select">\n                <option value="email">E-mail</option>\n                <option value="postal">Correio</option>\n                <option value="ambos">E-mail + Correio</option>\n              </select>\n            </div>\n            <div style="background: #e3f2fd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <h6>Fornecedores a serem notificados:</h6>\n              <p>â€¢ MedTech Pro - medtech@empresa.com</p>\n              <p>â€¢ CardiacSafe - contato@cardiacsafe.com</p>\n              <p>â€¢ SterilMax - vendas@sterilmax.com.br</p>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"ğŸ“¤ Enviar NotificaÃ§Ãµes",cancelButtonText:"âŒ Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"âœ… NotificaÃ§Ãµes Enviadas",text:"Todos os fornecedores foram notificados sobre a decisÃ£o.",icon:"success"})}))},getDCBStatusClass(a){switch(a){case"ATIVA":return"dcb-ativa";case"VENCENDO":return"dcb-vencendo";case"VENCIDA":return"dcb-vencida";case"CANCELADA":return"dcb-cancelada";default:return"dcb-indefinida"}},visualizarDCB(a){this.$swal({title:`ğŸ“œ DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto}</h4>\n            <p><strong>Marca:</strong> ${a.marca}</p>\n            <p><strong>Status:</strong> ${a.status}</p>\n            <hr>\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 4px;">\n              <h6>InformaÃ§Ãµes da DCB:</h6>\n              <p><strong>Emitida em:</strong> ${this.formatDate(a.dataEmissao)}</p>\n              <p><strong>VÃ¡lida atÃ©:</strong> ${this.formatDate(a.validade)}</p>\n              <p><strong>Autoridade:</strong> Dr. JoÃ£o Silva - SecretÃ¡rio</p>\n              <p><strong>CPM ResponsÃ¡vel:</strong> ComissÃ£o de PadronizaÃ§Ã£o de Materiais</p>\n            </div>\n            <div style="margin-top: 15px;">\n              <button class="swal2-confirm swal2-styled" onclick="window.open(\`/api/downloads/dcb-\${dcb.numero}.pdf\`, '_blank')">\n                ğŸ“¥ Baixar DCB Oficial\n              </button>\n            </div>\n          </div>\n        `,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"âŒ Fechar"})},renovarDCB(a){this.$swal({title:`ğŸ”„ Renovar DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto} - ${a.marca}</h4>\n            <p><strong>Validade atual:</strong> ${this.formatDate(a.validade)}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nova data de validade:</label>\n              <input id="novaValidade" class="swal2-input" type="date" value="">\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Justificativa:</label>\n              <textarea id="justificativaRenovacao" class="swal2-textarea" placeholder="Motivo da renovaÃ§Ã£o..." style="height: 80px;">RenovaÃ§Ã£o padrÃ£o - produto mantÃ©m conformidade tÃ©cnica e qualidade.</textarea>\n            </div>\n            <div style="background: #fff3cd; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>Nota:</strong> A renovaÃ§Ã£o manterÃ¡ o mesmo nÃºmero da DCB com validade estendida.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"ğŸ”„ Confirmar RenovaÃ§Ã£o",cancelButtonText:"âŒ Cancelar"}).then((a=>{a.isConfirmed&&this.$swal({title:"âœ… DCB Renovada",text:"A DCB foi renovada com sucesso e permanece ativa no catÃ¡logo.",icon:"success"})}))},cancelarDCB(a){this.$swal({title:`âŒ Cancelar DCB ${a.numero}/${a.ano}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <h4>${a.produto} - ${a.marca}</h4>\n            <p><strong>Status atual:</strong> ${a.status}</p>\n            <hr>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Motivo do cancelamento:</label>\n              <select id="motivoCancelamento" class="swal2-select">\n                <option value="">Selecione o motivo</option>\n                <option value="problemas_qualidade">Problemas de Qualidade</option>\n                <option value="descontinuacao">DescontinuaÃ§Ã£o do Produto</option>\n                <option value="mudanca_normativa">MudanÃ§a de Normativa</option>\n                <option value="solicitacao_fornecedor">SolicitaÃ§Ã£o do Fornecedor</option>\n                <option value="outros">Outros Motivos</option>\n              </select>\n            </div>\n            <div style="margin: 15px 0;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">FundamentaÃ§Ã£o:</label>\n              <textarea id="fundamentacaoCancelamento" class="swal2-textarea" placeholder="Justificativa detalhada..." style="height: 100px;"></textarea>\n            </div>\n            <div style="background: #f8d7da; padding: 10px; border-radius: 4px; margin-top: 15px;">\n              <small><strong>AtenÃ§Ã£o:</strong> O cancelamento remove o produto do catÃ¡logo e impede futuras aquisiÃ§Ãµes.</small>\n            </div>\n          </div>\n        `,showCancelButton:!0,confirmButtonText:"âŒ Confirmar Cancelamento",cancelButtonText:"ğŸ”™ Cancelar",confirmButtonColor:"#dc3545"}).then((a=>{a.isConfirmed&&this.$swal({title:"ğŸ“ DCB Cancelada",text:"A DCB foi cancelada e o produto removido do catÃ¡logo oficial.",icon:"warning"})}))},verTodas(){this.$swal({title:"ğŸ“‹ Todas as HomologaÃ§Ãµes",text:"Em uma implementaÃ§Ã£o completa, abriria uma tela com filtros avanÃ§ados e paginaÃ§Ã£o.",icon:"info"})},gerenciarDCBs(){this.$swal({title:"ğŸ“œ Gerenciar DCBs",text:"Em uma implementaÃ§Ã£o completa, abriria o mÃ³dulo completo de gestÃ£o de DCBs.",icon:"info"})},gerarConteudoAtaComProdutos(a,o){const t=a.filter((a=>"julgado_aprovado"===a.status)),e=a.filter((a=>"julgado_reprovado"===a.status));return`\nATA DE JULGAMENTO DA COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)\n\nNÃºmero: ${o?.numero||"A ser definido"}\nPerÃ­odo: ${o?.periodo||this.obterPeriodoAtual()}\nData de ElaboraÃ§Ã£o: ${(new Date).toLocaleDateString("pt-BR")}\n\nRESUMO:\n- Total de processos julgados: ${a.length}\n- Produtos aprovados: ${t.length}\n- Produtos reprovados: ${e.length}\n\nPRODUTOS APROVADOS:\n${t.map(((a,o)=>`\n${o+1}. ${a.nome} - ${a.marca}\n   AdequaÃ§Ã£o TÃ©cnica: ${a.adequacao_tecnica}\n   Base Legal: ${a.base_legal||"Lei 14.133/2021"}\n`)).join("")}\n\nPRODUTOS REPROVADOS:\n${e.map(((a,o)=>`\n${o+1}. ${a.nome} - ${a.marca}\n   Motivo: ${a.observacoes_ccl||"NÃ£o atendimento aos requisitos tÃ©cnicos"}\n`)).join("")}\n\n[CONTEÃšDO A SER COMPLETADO NA ELABORAÃ‡ÃƒO FINAL]\n      `.trim()},async baixarDocumentacaoProduto(a){try{const{jsPDF:o}=await Promise.resolve().then(t.bind(t,1749)),{data:e,error:s}=await N.ND.from("produtos").select("*").eq("id",a).eq("tenant_id",this.currentTenantId).single();if(s)throw s;const{data:i,error:r}=await N.ND.from("documentos").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId).order("nome",{ascending:!0});if(r&&console.warn("Erro ao carregar documentos:",r),!e)return void this.$swal({title:"âš ï¸ Produto NÃ£o Encontrado",text:"NÃ£o foi possÃ­vel encontrar os dados do produto.",icon:"warning"});const n=new o,c=n.internal.pageSize.getWidth(),l=n.internal.pageSize.getHeight();let d=25;n.setFontSize(16),n.setFont(void 0,"bold"),n.text("COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)",c/2,d,{align:"center"}),d+=8,n.setFontSize(12),n.setFont(void 0,"normal"),n.text("Sistema de PrÃ©-QualificaÃ§Ã£o de Bens - Lei 14.133/2021",c/2,d,{align:"center"}),d+=15,n.setLineWidth(.5),n.line(30,d,c-30,d),d+=20,n.setFontSize(16),n.setFont(void 0,"bold"),n.text("DOCUMENTAÃ‡ÃƒO TÃ‰CNICA COMPLETA",c/2,d,{align:"center"}),d+=8,n.setFontSize(12),n.text("Processo de PrÃ©-QualificaÃ§Ã£o de Bem",c/2,d,{align:"center"}),d+=20,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("I. IDENTIFICAÃ‡ÃƒO DO BEM",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const u=[["Nome do Produto:",e.nome||"NÃ£o informado"],["Marca:",e.marca||"NÃ£o informado"],["Modelo:",e.modelo||"NÃ£o informado"],["Fabricante:",e.fabricante||"NÃ£o informado"],["CÃ³digo do Material:",e.codigo_material||"NÃ£o informado"],["Categoria:",this.getCategoriaName(e.categoria_id)||"NÃ£o informado"],["CNPJ Fabricante:",e.cnpj_fabricante||e.cnpj||"NÃ£o informado"]];u.forEach((([a,o])=>{n.setFont(void 0,"bold"),n.text(a,35,d),n.setFont(void 0,"normal"),n.text(o,90,d),d+=8})),d+=10,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("II. HISTÃ“RICO DO PROCESSO",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const m=[["Data de Cadastro:",this.formatDate(e.criado_em)],["Status Atual:",this.formatarStatusCPM(e.status)],["Ãšltima AtualizaÃ§Ã£o:",this.formatDate(e.atualizado_em)]];if(e.julgado_em&&m.push(["Data do Julgamento CCL:",this.formatDate(e.julgado_em)]),e.adequacao_tecnica&&m.push(["AdequaÃ§Ã£o TÃ©cnica:",e.adequacao_tecnica]),m.forEach((([a,o])=>{n.setFont(void 0,"bold"),n.text(a,35,d),n.setFont(void 0,"normal"),n.text(o,90,d),d+=8})),d+=15,n.setFontSize(14),n.setFont(void 0,"bold"),n.text("III. PARECER TÃ‰CNICO DA CPM",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),e.observacoes_cpm){const a=n.splitTextToSize(e.observacoes_cpm,c-70);n.text(a,35,d),d+=6*a.length+10}else n.setFont(void 0,"italic"),n.text("Parecer da CPM nÃ£o disponÃ­vel.",35,d),d+=15;if(d>l-80&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("IV. DECISÃƒO DA COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),e.observacoes_ccl){n.setFont(void 0,"bold"),n.text("FundamentaÃ§Ã£o da DecisÃ£o:",35,d),d+=8,n.setFont(void 0,"normal");const a=n.splitTextToSize(e.observacoes_ccl,c-70);n.text(a,35,d),d+=6*a.length+10}if(e.base_legal){n.setFont(void 0,"bold"),n.text("Base Legal:",35,d),d+=8,n.setFont(void 0,"normal");const a=n.splitTextToSize(e.base_legal,c-70);n.text(a,35,d),d+=6*a.length+10}if(e.observacoes_ccl||e.base_legal||(n.setFont(void 0,"italic"),n.text("Processo ainda nÃ£o foi julgado pela CCL.",35,d),d+=15),e.especificacoes_tecnicas){d>l-60&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text("V. ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal");const a=n.splitTextToSize(e.especificacoes_tecnicas,c-70);n.text(a,35,d),d+=6*a.length+15}if(i&&i.length>0){d>l-80&&(n.addPage(),d=30),n.setFontSize(14),n.setFont(void 0,"bold"),n.text(e.especificacoes_tecnicas?"VI. DOCUMENTOS ANEXOS":"V. DOCUMENTOS ANEXOS",30,d),d+=12,n.setFontSize(11),n.setFont(void 0,"normal"),n.text("Os seguintes documentos estÃ£o vinculados a este produto:",35,d),d+=10,i.forEach(((a,o)=>{d>l-40&&(n.addPage(),d=30),n.setFont(void 0,"bold"),n.text(`${o+1}. ${a.nome}`,35,d),d+=6,n.setFont(void 0,"normal"),n.text(`Tipo: ${a.tipo||"NÃ£o especificado"}`,40,d),d+=6,a.arquivo_url&&(n.setFontSize(9),n.setFont(void 0,"italic"),n.text(`URL: ${a.arquivo_url}`,40,d),d+=6,n.setFontSize(11)),d+=3})),d+=10,n.setFontSize(10),n.setFont(void 0,"italic");const a=n.splitTextToSize("Nota: Os documentos listados acima estÃ£o disponÃ­veis digitalmente no sistema e podem ser acessados atravÃ©s das URLs fornecidas ou solicitados Ã  administraÃ§Ã£o.",c-70);n.text(a,35,d),d+=5*a.length+15}const p=n.internal.getNumberOfPages();for(let a=1;a<=p;a++)n.setPage(a),n.setLineWidth(.3),n.line(30,l-25,c-30,l-25),n.setFontSize(8),n.setFont(void 0,"normal"),n.text("Sistema Comprar Bem - PrÃ©-QualificaÃ§Ã£o de Bens",30,l-18),n.text(`PÃ¡gina ${a} de ${p}`,c/2,l-18,{align:"center"}),n.text("Lei 14.133/2021",c-30,l-18,{align:"right"}),n.text(`Documento gerado em: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}`,30,l-12),n.text("Processo de PrÃ©-QualificaÃ§Ã£o - CCL",c-30,l-12,{align:"right"});const v=`CCL_${(e.nome||"Produto").replace(/[^a-zA-Z0-9]/g,"_")}_${(new Date).toISOString().split("T")[0]}.pdf`;n.save(v),this.$swal({title:"âœ… DocumentaÃ§Ã£o Gerada!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>ğŸ“‹ ${e.nome}</h4>\n              <p><strong>Arquivo:</strong> ${v}</p>\n              <p>DocumentaÃ§Ã£o tÃ©cnica completa gerada com sucesso!</p>\n              ${i&&i.length>0?`<p><strong>ğŸ“ ${i.length} documento(s) anexo(s)</strong> incluÃ­do(s) no PDF</p>`:"<p><em>Nenhum documento anexo vinculado ao produto</em></p>"}\n            </div>\n          `,icon:"success",confirmButtonText:"âœ… Perfeito!"})}catch(o){console.error("Erro ao gerar PDF:",o),this.$swal({title:"âŒ Erro ao Gerar PDF",text:`Erro: ${o.message}`,icon:"error"})}},async baixarDocumentacaoRecursoEspecifico(a){try{const{jsPDF:o}=await Promise.resolve().then(t.bind(t,1749)),e=this.recursos?.find((o=>o.id===a));if(!e)return void this.$swal({title:"âš ï¸ Recurso NÃ£o Encontrado",text:"NÃ£o foi possÃ­vel encontrar os dados do recurso.",icon:"warning"});const s=new o,i=s.internal.pageSize.getWidth(),r=s.internal.pageSize.getHeight();let n=25;s.setFontSize(16),s.setFont(void 0,"bold"),s.text("COMISSÃƒO DE CONTRATAÃ‡ÃƒO OU LICITAÃ‡ÃƒO (CCL)",i/2,n,{align:"center"}),n+=8,s.setFontSize(12),s.setFont(void 0,"normal"),s.text("Recurso Administrativo - Lei 14.133/2021, Art. 165-171",i/2,n,{align:"center"}),n+=15,s.setLineWidth(.5),s.line(30,n,i-30,n),n+=20,s.setFontSize(16),s.setFont(void 0,"bold"),s.text("DOCUMENTAÃ‡ÃƒO DE RECURSO ADMINISTRATIVO",i/2,n,{align:"center"}),n+=20,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("I. IDENTIFICAÃ‡ÃƒO DO RECURSO",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal");const c=[["Protocolo:",a],["Produto:",e.produto_nome||"NÃ£o informado"],["Recorrente:",e.recorrente||"NÃ£o informado"],["Data do Recurso:",this.formatDate(e.data_recurso)],["Prazo Final:",this.formatDate(e.prazo_final)],["Status Atual:",e.status||"Em AnÃ¡lise"],["Ata de ReferÃªncia:",e.ata_referencia||"NÃ£o informado"]];if(c.forEach((([a,o])=>{s.setFont(void 0,"bold"),s.text(a,35,n),s.setFont(void 0,"normal"),s.text(o,90,n),n+=8})),n+=15,s.setFontSize(14),s.setFont(void 0,"bold"),s.text("II. FUNDAMENTAÃ‡ÃƒO DO RECURSO",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal"),e.fundamentacao){const a=s.splitTextToSize(e.fundamentacao,i-70);s.text(a,35,n),n+=6*a.length+15}else s.setFont(void 0,"italic"),s.text("FundamentaÃ§Ã£o nÃ£o disponÃ­vel.",35,n),n+=15;if(s.setFontSize(14),s.setFont(void 0,"bold"),s.text("III. ANÃLISE E DECISÃƒO DA CCL",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal"),e.decisao){if(s.setFont(void 0,"bold"),s.text("DecisÃ£o:",35,n),n+=8,s.setFont(void 0,"normal"),s.text(e.decisao.toUpperCase(),35,n),n+=10,e.fundamentacao_decisao){s.setFont(void 0,"bold"),s.text("FundamentaÃ§Ã£o da DecisÃ£o:",35,n),n+=8,s.setFont(void 0,"normal");const a=s.splitTextToSize(e.fundamentacao_decisao,i-70);s.text(a,35,n),n+=6*a.length+15}}else s.setFont(void 0,"italic"),s.text("Recurso ainda em anÃ¡lise pela CCL.",35,n),n+=15;s.setFontSize(14),s.setFont(void 0,"bold"),s.text("IV. BASE LEGAL",30,n),n+=12,s.setFontSize(11),s.setFont(void 0,"normal");const l=["â€¢ Lei nÂº 14.133/2021 - Nova Lei de LicitaÃ§Ãµes e Contratos","â€¢ Art. 165 - Direito de recurso dos interessados","â€¢ Art. 166 - Prazo para interposiÃ§Ã£o de recurso","â€¢ Art. 167 - Processamento dos recursos","â€¢ Art. 168 - Efeito suspensivo dos recursos","â€¢ Art. 169 - DecisÃ£o dos recursos","â€¢ Art. 170 - Recursos contra atos da CCL","â€¢ Art. 171 - Irrecorribilidade das decisÃµes"];l.forEach((a=>{s.text(a,35,n),n+=6}));const d=s.internal.getNumberOfPages();for(let t=1;t<=d;t++)s.setPage(t),s.setLineWidth(.3),s.line(30,r-25,i-30,r-25),s.setFontSize(8),s.setFont(void 0,"normal"),s.text("Sistema Comprar Bem - Recursos Administrativos",30,r-18),s.text(`PÃ¡gina ${t} de ${d}`,i/2,r-18,{align:"center"}),s.text("Lei 14.133/2021 - Art. 165-171",i-30,r-18,{align:"right"}),s.text(`Documento gerado em: ${(new Date).toLocaleDateString("pt-BR")} Ã s ${(new Date).toLocaleTimeString("pt-BR")}`,30,r-12),s.text(`Protocolo: ${a}`,i-30,r-12,{align:"right"});const u=`CCL_Recurso_${e.produto_nome?.replace(/[^a-zA-Z0-9]/g,"_")||"Recurso"}_${(new Date).toISOString().split("T")[0]}.pdf`;s.save(u),this.$swal({title:"âœ… DocumentaÃ§Ã£o do Recurso Gerada!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <h4>âš–ï¸ ${e.produto_nome||"Recurso Administrativo"}</h4>\n              <p><strong>Recorrente:</strong> ${e.recorrente}</p>\n              <p><strong>Arquivo:</strong> ${u}</p>\n              <p>DocumentaÃ§Ã£o completa do recurso gerada com sucesso!</p>\n            </div>\n          `,icon:"success",confirmButtonText:"âœ… Perfeito!"})}catch(o){console.error("Erro ao gerar PDF do recurso:",o),this.$swal({title:"âŒ Erro ao Gerar PDF",text:`Erro: ${o.message}`,icon:"error"})}},mudarPagina(a,o){o>=1&&o<=this.calcularTotalPaginas(a)&&(this.paginacao[a].paginaAtual=o)},calcularTotalPaginas(a){const o=this.paginacao[a].total,t=this.paginacao[a].itensPorPagina;return o>0?Math.ceil(o/t):1},atualizarTotalPaginacao(a,o){this.paginacao[a].total=o,this.paginacao[a].paginaAtual>this.calcularTotalPaginas(a)&&(this.paginacao[a].paginaAtual=1)},proximaPagina(a){const o=this.calcularTotalPaginas(a);this.paginacao[a].paginaAtual<o&&this.paginacao[a].paginaAtual++},paginaAnterior(a){this.paginacao[a].paginaAtual>1&&this.paginacao[a].paginaAtual--},async iniciarJulgamentoCCL(a){try{const{value:o}=await this.$swal({title:"âš–ï¸ Julgamento TÃ©cnico CCL",html:`\n            <div style="text-align: left; padding: 10px; max-width: 100%; box-sizing: border-box;">\n              <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-bottom: 15px;">\n                <h4 style="margin: 0 0 8px 0; font-size: 16px;">ğŸ“„ Dados do Processo</h4>\n                <p style="margin: 5px 0; word-wrap: break-word;"><strong>NÃºmero:</strong> ${a.numero_processo}</p>\n                <p style="margin: 5px 0; word-wrap: break-word;"><strong>Objeto:</strong> ${a.objeto||"NÃ£o informado"}</p>\n                <p style="margin: 5px 0;"><strong>Status:</strong> ${this.formatarStatusProcesso(a.status)}</p>\n              </div>\n              \n              <div style="margin-bottom: 12px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px;">DecisÃ£o TÃ©cnica da CCL:</label>\n                <select id="decisaoTecnica" class="swal2-select" style="width: 95%; box-sizing: border-box;">\n                  <option value="">Selecione a decisÃ£o...</option>\n                  <option value="aprovar">âœ… APROVAR - Enviar para Atas de Julgamento (fluxo normal)</option>\n                  <option value="aprovar_homologacao_direta">âš¡ HOMOLOGAR DIRETAMENTE - Enviar para HomologaÃ§Ãµes (decisÃ£o direta da CCL)</option>\n                  <option value="devolver">â†©ï¸ DEVOLVER - Solicitar correÃ§Ãµes</option>\n                </select>\n              </div>\n              \n              <div style="margin-bottom: 12px;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px;">FundamentaÃ§Ã£o TÃ©cnica:</label>\n                <textarea id="fundamentacaoTecnica" class="swal2-textarea" rows="4" \n                  placeholder="Descreva a anÃ¡lise tÃ©cnica realizada e fundamente sua decisÃ£o..." \n                  style="width: 95%; box-sizing: border-box; resize: vertical;"></textarea>\n              </div>\n              \n            </div>\n          `,width:"700px",maxWidth:"90vw",showCancelButton:!0,confirmButtonText:"âš–ï¸ Confirmar Julgamento",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("decisaoTecnica").value,o=document.getElementById("fundamentacaoTecnica").value.trim();return a?o?{decisao:a,fundamentacao:o}:(this.$swal.showValidationMessage("A fundamentaÃ§Ã£o tÃ©cnica Ã© obrigatÃ³ria"),!1):(this.$swal.showValidationMessage("Selecione uma decisÃ£o tÃ©cnica"),!1)}});if(!o)return;let t;switch(console.log("ğŸ” [DEBUG] DecisÃ£o selecionada:",o.decisao),console.log("ğŸ” [DEBUG] FundamentaÃ§Ã£o:",o.fundamentacao),o.decisao){case"aprovar":if(console.log("ğŸ” [DEBUG] Executando caso APROVAR - enviando para ata_ccl"),t=await et.A.enviarProcessoFlexivel(a.id,"ata_ccl","GERAR_ATA_CCL",`CCL aprovou tecnicamente - gerando ata de julgamento: ${o.fundamentacao}`),console.log("ğŸ” [DEBUG] Resultado da tramitaÃ§Ã£o APROVAR:",t),t&&t.sucesso){const{error:t}=await N.ND.from("processos_administrativos").update({ata_julgamento_ccl:o.fundamentacao,ata_emitida_ccl_em:(new Date).toISOString(),recomendacao_ccl:"recomendar_homologacao"}).eq("id",a.id);t?console.warn("Erro ao salvar dados da ata CCL:",t):console.log("âœ… Campos ata_ccl preenchidos para aprovaÃ§Ã£o normal")}break;case"aprovar_homologacao_direta":if(console.log("ğŸ” [DEBUG] Executando caso APROVAR_HOMOLOGACAO_DIRETA - enviando para homologaÃ§Ãµes"),t=await et.A.enviarProcessoFlexivel(a.id,"ata_julgamento_ccl_homologacao","HOMOLOGACAO_DIRETA_CCL",`CCL aprovou para homologaÃ§Ã£o direta: ${o.fundamentacao}`),console.log("ğŸ” [DEBUG] Resultado da tramitaÃ§Ã£o HOMOLOGACAO_DIRETA:",t),t&&t.sucesso){const{error:t}=await N.ND.from("processos_administrativos").update({ata_julgamento_ccl:`CCL aprovou para homologaÃ§Ã£o direta: ${o.fundamentacao}`,ata_emitida_ccl_em:(new Date).toISOString()}).eq("id",a.id);t?console.warn("Erro ao salvar dados da ata CCL:",t):console.log("âœ… Campos ata_emitida_ccl_em e ata_julgamento_ccl preenchidos")}break;case"devolver":t=await et.A.devolverProcesso(a.id,"SolicitaÃ§Ã£o de correÃ§Ãµes tÃ©cnicas pela CCL",o.fundamentacao);break}if(!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o do processo");const{error:e}=await N.ND.from("processos_administrativos").update({ata_julgamento_ccl:o.fundamentacao,ata_emitida_ccl_em:(new Date).toISOString()}).eq("id",a.id);e&&console.warn("Erro ao salvar dados CCL (processo foi tramitado):",e),"aprovar"===o.decisao&&console.log("âœ… Processo aprovado e disponÃ­vel para criaÃ§Ã£o de ata manual");const s={aprovar:"aprovado",devolver:"devolvido para correÃ§Ãµes"}[o.decisao];await this.$swal({title:"âœ… Julgamento Realizado!",html:`\n            <p>Processo <strong>${a.numero_processo}</strong> foi <strong>${s}</strong> pela CCL.</p>\n            <p><strong>Novo status:</strong> ${t.statusNovo}</p>\n            <p><strong>PrÃ³ximo responsÃ¡vel:</strong> ${t.proximoResponsavel||"Definido pelo sistema"}</p>\n          `,icon:"success"}),await this.carregarDados(!0),await this.atualizarDadosAtas(),"aprovar_homologacao_direta"===o.decisao&&this.$refs.homologacoesCCL&&await this.$refs.homologacoesCCL.carregarHomologacoes()}catch(o){console.error("Erro no julgamento CCL:",o),await this.$swal({title:"âŒ Erro no Julgamento",text:o.message||"Erro interno do sistema",icon:"error"})}},async devolverProcesso(a){try{const{value:o}=await this.$swal({title:"â†©ï¸ Devolver Processo",html:`\n            <div style="text-align: left; padding: 15px;">\n              <p><strong>Processo:</strong> ${a.numero_processo}</p>\n              <p><strong>Status atual:</strong> ${this.formatarStatusProcesso(a.status)}</p>\n              \n              <div style="margin: 15px 0;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">Motivo da devoluÃ§Ã£o:</label>\n                <textarea id="motivoDevolucao" class="swal2-textarea" rows="4" \n                  placeholder="Descreva os motivos pelos quais o processo estÃ¡ sendo devolvido..." \n                  style="width: 100%;"></textarea>\n              </div>\n              \n              <div style="background: #fff3cd; padding: 10px; border-radius: 4px;">\n                <small><strong>âš ï¸ AtenÃ§Ã£o:</strong> O processo serÃ¡ devolvido para a CPM com status de devoluÃ§Ã£o.</small>\n              </div>\n            </div>\n          `,width:"600px",showCancelButton:!0,confirmButtonText:"â†©ï¸ Confirmar DevoluÃ§Ã£o",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("motivoDevolucao").value.trim();return a||(this.$swal.showValidationMessage("O motivo da devoluÃ§Ã£o Ã© obrigatÃ³rio"),!1)}});if(!o)return;const t=await et.A.devolverProcesso(a.id,o,`Processo devolvido pela CCL: ${o}`);if(!t||!t.sucesso)throw new Error("Falha na devoluÃ§Ã£o do processo");await this.$swal({title:"âœ… Processo Devolvido!",html:`\n            <p>Processo <strong>${a.numero_processo}</strong> foi devolvido para a CPM.</p>\n            <p><strong>Novo status:</strong> ${t.statusNovo}</p>\n          `,icon:"success"}),await this.carregarDados(!0)}catch(o){console.error("Erro na devoluÃ§Ã£o:",o),await this.$swal({title:"âŒ Erro na DevoluÃ§Ã£o",text:o.message||"Erro interno do sistema",icon:"error"})}},async tramitarAtaCCL(a){try{const{value:o}=await this.$swal({title:"ğŸ“‹ Enviar Ata para PublicaÃ§Ã£o",html:`\n            <div style="text-align: left; padding: 15px;">\n              <p><strong>Processo:</strong> ${a.numero_processo}</p>\n              <p><strong>Status atual:</strong> ${this.formatarStatusProcesso(a.status)}</p>\n              \n              <div style="margin: 15px 0;">\n                <label style="display: block; font-weight: bold; margin-bottom: 5px;">ObservaÃ§Ãµes (opcional):</label>\n                <textarea id="observacoesAta" class="swal2-textarea" rows="3" \n                  placeholder="ObservaÃ§Ãµes sobre a ata de julgamento..." \n                  style="width: 100%;"></textarea>\n              </div>\n              \n              <div style="background: #d1ecf1; padding: 10px; border-radius: 4px;">\n                <small><strong>ğŸ“¢ PrÃ³ximo passo:</strong> O processo serÃ¡ enviado para o Ã“rgÃ£o Administrativo publicar a ata e abrir prazo recursal.</small>\n              </div>\n            </div>\n          `,width:"600px",showCancelButton:!0,confirmButtonText:"ğŸ“‹ Enviar para PublicaÃ§Ã£o",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("observacoesAta").value.trim();return a||"Ata de julgamento CCL concluÃ­da, enviada para publicaÃ§Ã£o."}});if(void 0===o)return;const t=await et.A.enviarProcessoFlexivel(a.id,"publicacao_ata","PUBLICAR_DIRETA",o);if(!t||!t.sucesso)throw new Error("Falha na tramitaÃ§Ã£o da ata");await this.$swal({title:"âœ… Ata Enviada!",html:`\n            <p>Ata do processo <strong>${a.numero_processo}</strong> foi enviada para publicaÃ§Ã£o.</p>\n            <p><strong>Novo status:</strong> ${t.statusNovo}</p>\n            <p><strong>ResponsÃ¡vel:</strong> Ã“rgÃ£o Administrativo</p>\n          `,icon:"success"}),await this.carregarDados(!0)}catch(o){console.error("Erro ao tramitar ata:",o),await this.$swal({title:"âŒ Erro na TramitaÃ§Ã£o",text:o.message||"Erro interno do sistema",icon:"error"})}}},async visualizarProcessoHomologacao(a){try{const{data:o,error:t}=await N.ND.from("processos_administrativos").select("\n          *,\n          produtos:produtos(*)\n        ").eq("id",a.id).single();if(t)throw t;this.$swal({title:`ğŸ“‹ Processo: ${a.numeroAta}`,html:`\n          <div style="text-align: left; padding: 15px;">\n            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n              <h4 style="margin: 0 0 10px 0; color: #2c3e50;">ğŸ“„ InformaÃ§Ãµes do Processo</h4>\n              <p><strong>Tipo:</strong> ${o.tipo_processo?.toUpperCase()}</p>\n              <p><strong>Ã“rgÃ£o:</strong> ${o.nome_orgao}</p>\n              <p><strong>Status:</strong> Aguardando HomologaÃ§Ã£o da Autoridade</p>\n              <p><strong>Data do Julgamento CCL:</strong> ${this.formatDate(o.ata_emitida_ccl_em)}</p>\n            </div>\n            \n            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 15px;">\n              <h4 style="margin: 0 0 10px 0; color: #2c3e50;">âš–ï¸ RecomendaÃ§Ã£o da CCL</h4>\n              <p><strong>DecisÃ£o:</strong> ${"recomendar_homologacao"===o.recomendacao_ccl?"âœ… HOMOLOGAÃ‡ÃƒO RECOMENDADA":"âŒ INDEFERIMENTO RECOMENDADO"}</p>\n              <div style="background: white; padding: 10px; border-radius: 4px; margin-top: 10px;">\n                <strong>FundamentaÃ§Ã£o:</strong><br>\n                ${o.ata_julgamento_ccl||"FundamentaÃ§Ã£o nÃ£o disponÃ­vel"}\n              </div>\n            </div>\n            \n            <div style="background: #fff3cd; padding: 15px; border-radius: 8px;">\n              <h4 style="margin: 0 0 10px 0; color: #856404;">â° Prazo para HomologaÃ§Ã£o</h4>\n              <p><strong>Status:</strong> ${this.calcularPrazoHomologacao(o.ata_emitida_ccl_em)}</p>\n              <p><small>A Autoridade Competente tem 15 dias Ãºteis para decidir sobre a homologaÃ§Ã£o.</small></p>\n            </div>\n          </div>\n        `,width:700,showCancelButton:!0,confirmButtonText:"ğŸ“§ Notificar Autoridade",cancelButtonText:"âœ… OK",reverseButtons:!0}).then((o=>{o.isConfirmed&&this.notificarAutoridade(a)}))}catch(o){console.error("Erro ao visualizar processo:",o),this.$swal({title:"âŒ Erro",text:"Erro ao carregar dados do processo.",icon:"error"})}},async notificarAutoridade(a){const{value:o}=await this.$swal({title:"ğŸ“§ Notificar Autoridade Competente",html:`\n        <div style="text-align: left; padding: 15px;">\n          <p><strong>Processo:</strong> ${a.numeroAta}</p>\n          <p><strong>Julgado em:</strong> ${this.formatDate(a.dataJulgamento)}</p>\n          <p><strong>Prazo:</strong> ${this.calcularPrazoHomologacao(a.dataJulgamento)}</p>\n          <hr>\n          <label style="display: block; font-weight: bold; margin-bottom: 10px;">Tipo de NotificaÃ§Ã£o:</label>\n          <select id="tipoNotificacao" class="swal2-input" style="margin-bottom: 15px;">\n            <option value="lembrete">ğŸ“… Lembrete de Prazo</option>\n            <option value="urgente">âš ï¸ Urgente - Prazo Vencendo</option>\n            <option value="atrasado">ğŸš¨ Processo em Atraso</option>\n            <option value="solicitacao">ğŸ“‹ SolicitaÃ§Ã£o de DecisÃ£o</option>\n          </select>\n          <label style="display: block; font-weight: bold; margin-bottom: 5px;">ObservaÃ§Ãµes (opcional):</label>\n          <textarea id="observacoes" class="swal2-textarea" placeholder="InformaÃ§Ãµes adicionais sobre a notificaÃ§Ã£o..."></textarea>\n        </div>\n      `,showCancelButton:!0,confirmButtonText:"ğŸ“§ Enviar NotificaÃ§Ã£o",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("tipoNotificacao").value,o=document.getElementById("observacoes").value;return{tipo:a,observacoes:o}}});if(o)try{await new Promise((a=>setTimeout(a,1e3))),this.$swal({title:"âœ… NotificaÃ§Ã£o Enviada!",html:`\n            <div style="text-align: center; padding: 15px;">\n              <p>A notificaÃ§Ã£o foi enviada com sucesso para a Autoridade Competente.</p>\n              <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; margin: 10px 0;">\n                <strong>Tipo:</strong> ${"lembrete"===o.tipo?"ğŸ“… Lembrete de Prazo":"urgente"===o.tipo?"âš ï¸ Urgente":"atrasado"===o.tipo?"ğŸš¨ Processo em Atraso":"ğŸ“‹ SolicitaÃ§Ã£o de DecisÃ£o"}<br>\n                <strong>Processo:</strong> ${a.numeroAta}\n              </div>\n              <p><small>A autoridade receberÃ¡ o aviso por email e no sistema.</small></p>\n            </div>\n          `,icon:"success",timer:3e3})}catch(t){console.error("Erro ao enviar notificaÃ§Ã£o:",t),this.$swal({title:"âŒ Erro",text:"Erro ao enviar notificaÃ§Ã£o. Tente novamente.",icon:"error"})}},mounted(){window.baixarDocumentacaoProduto=a=>this.baixarDocumentacaoProduto(a),window.baixarDocumentacaoRecursoEspecifico=a=>this.baixarDocumentacaoRecursoEspecifico(a)}},ut=dt;var mt=(0,C.A)(ut,ot,tt,!1,null,"3096fa16",null);const pt=mt.exports,vt={name:"CCL",components:{DashboardCCL:pt},data(){return{dropdownOpen:!1,modalEmailAberto:!1,isUsuarioCCL:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",configEmail:{nomeOrganizacao:"",emailRemetente:"",nomeRemetente:"",assinatura:""},showDropdown:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},mounted(){},beforeUnmount(){},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await N.ND.auth.getUser();if(a){this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0];const{data:o,error:t}=await N.ND.from("usuarios").select("perfil_usuario").eq("id",a.id).single();console.log("ğŸ” Dados do usuÃ¡rio CCL:",{usuario:o,errorUsuario:t,userId:a.id}),this.isUsuarioCCL="ccl"===o?.perfil_usuario,console.log("âœ… IsUsuarioCCL:",this.isUsuarioCCL),this.isUsuarioCCL&&console.log("ğŸ”’ UsuÃ¡rio CCL logado - NavegaÃ§Ã£o restrita")}}catch(a){console.error("Erro ao carregar dados do usuÃ¡rio:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},closeDropdown(){this.showDropdown=!1}}},gt=vt;var _t=(0,C.A)(gt,Wo,at,!1,null,"20f7cfa4",null);const ht=_t.exports;var ft=function(){var a=this,o=a._self._c;return o("div",{staticClass:"classificacao-view"},[o("header",{staticClass:"app-header"},[a._m(0),o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),o("div",{staticClass:"user-menu"},[o("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("â–¼")])]),a.dropdownOpen?o("div",{staticClass:"dropdown-menu"},[o("div",{staticClass:"dropdown-header"},[o("div",{staticClass:"user-avatar-large"},[a._v("ğŸ‘¤")]),o("div",{staticClass:"user-details"},[o("strong",[a._v(a._s(a.nomeUsuario))]),o("small",[a._v(a._s(a.emailUsuario))])])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[o("span",{staticClass:"item-icon"},[a._v("âš™ï¸")]),o("span",[a._v("ConfiguraÃ§Ãµes")])]),o("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[o("span",{staticClass:"item-icon"},[a._v("ğŸ“§")]),o("span",[a._v("Configurar Email")])]),o("hr",{staticClass:"dropdown-divider"}),o("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[o("span",{staticClass:"item-icon"},[a._v("ğŸšª")]),o("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?o("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),o("main",{staticClass:"main-content"},[o("Classificacao")],1),a.modalEmailAberto?o("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[o("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[a._m(2),o("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da OrganizaÃ§Ã£o")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeOrganizacao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"emailRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"nomeRemetente",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;ComissÃ£o de PadronizaÃ§Ã£o de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(o){o.target.composing||a.$set(a.configEmail,"assinatura",o.target.value)}}})])]),o("div",{staticClass:"modal-footer"},[o("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),o("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[o("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},Ct=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"profile-avatar"},[o("span",{staticClass:"profile-icon"},[a._v("ğŸ‘¤")])])},function(){var a=this,o=a._self._c;return o("h3",[o("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da OrganizaÃ§Ã£o")])}],bt=function(){var a=this,o=a._self._c;return o("div",{staticClass:"classificacao-container"},[o("h2",[a._v("ClassificaÃ§Ã£o de Materiais")]),o("div",{staticClass:"tabs"},[o("button",{class:["tab-button",{active:"grupos"===a.activeTab}],on:{click:function(o){a.activeTab="grupos"}}},[a._v(" Grupos ")]),o("button",{class:["tab-button",{active:"classes"===a.activeTab}],on:{click:function(o){a.activeTab="classes"}}},[a._v(" Classes ")])]),o("div",{staticClass:"tab-content"},["grupos"===a.activeTab?o("GruposList"):a._e(),"classes"===a.activeTab?o("ClassesList"):a._e()],1)])},Dt=[],Et=function(){var a=this,o=a._self._c;return o("div",{staticClass:"grupos-list"},[o("div",{staticClass:"header"},[o("h3",[a._v("Gerenciamento de Grupos")]),o("button",{staticClass:"btn-add",on:{click:function(o){a.mostrarFormulario=!0}}},[a._v(" Adicionar Grupo ")])]),a.loading?o("div",{staticClass:"loading"},[o("p",[a._v("Carregando grupos...")])]):0===a.grupos.length?o("div",{staticClass:"empty-state"},[o("p",[a._v("Nenhum grupo cadastrado.")])]):o("div",{staticClass:"grupos-table"},[o("table",[a._m(0),o("tbody",a._l(a.grupos,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.codigo||t.id.slice(0,8)))]),o("td",[a._v(a._s(t.nome))]),o("td",[a._v(a._s(t.descricao||"-"))]),o("td",[a._v(a._s(a.formatarData(t.created_at)))]),o("td",{staticClass:"actions"},[o("button",{staticClass:"btn-edit",on:{click:function(o){return a.editarGrupo(t)}}},[a._v("Editar")]),o("button",{staticClass:"btn-delete",on:{click:function(o){return a.confirmarExclusao(t)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?o("div",{staticClass:"modal"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Grupo")]),o("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarGrupo.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"codigo"}},[a._v("CÃ³digo do Grupo")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.codigo,expression:"grupoAtual.codigo"}],attrs:{id:"codigo",type:"text",placeholder:"Ex: GRP001"},domProps:{value:a.grupoAtual.codigo},on:{input:function(o){o.target.composing||a.$set(a.grupoAtual,"codigo",o.target.value)}}}),o("small",[a._v("Se nÃ£o informado, serÃ¡ gerado automaticamente")])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nome"}},[a._v("Nome do Grupo*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.nome,expression:"grupoAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.grupoAtual.nome},on:{input:function(o){o.target.composing||a.$set(a.grupoAtual,"nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"descricao"}},[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.descricao,expression:"grupoAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.grupoAtual.descricao},on:{input:function(o){o.target.composing||a.$set(a.grupoAtual,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},At=[function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("CÃ³digo do Grupo")]),o("th",[a._v("Nome")]),o("th",[a._v("DescriÃ§Ã£o")]),o("th",[a._v("Data de CriaÃ§Ã£o")]),o("th",[a._v("AÃ§Ãµes")])])])}];const wt={name:"GruposList",setup(){const a=(0,e.KR)([]),o=(0,e.KR)(!0),t=(0,e.KR)(!1),s=(0,e.KR)(!1),i=(0,e.KR)(!1),r=(0,e.Kh)({id:null,codigo:"",nome:"",descricao:""});(0,e.sV)((async()=>{await n()}));const n=async()=>{try{o.value=!0;const{data:t,error:e}=await N.ND.from("grupos").select("*").order("nome");if(e)throw e;a.value=t||[]}catch(t){console.error("Erro ao carregar grupos:",t),alert("Erro ao carregar grupos. Por favor, tente novamente.")}finally{o.value=!1}},c=a=>{if(!a)return"-";const o=new Date(a);return o.toLocaleDateString("pt-BR")},l=a=>{i.value=!0,r.id=a.id,r.codigo=a.codigo||"",r.nome=a.nome,r.descricao=a.descricao||"",s.value=!0},d=()=>{s.value=!1,i.value=!1,r.id=null,r.codigo="",r.nome="",r.descricao=""},u=async()=>{try{if(t.value=!0,i.value){console.log("Atualizando grupo:",{id:r.id,codigo:r.codigo,nome:r.nome,descricao:r.descricao});const{data:a,error:o}=await N.ND.from("grupos").select("*").eq("id",r.id).single();if(o)throw console.error("Erro ao buscar grupo:",o),new Error(`Grupo nÃ£o encontrado: ${o.message}`);console.log("Grupo encontrado:",a);const t={nome:r.nome.trim()};r.codigo&&r.codigo.trim()&&(t.codigo=r.codigo.trim()),r.descricao&&r.descricao.trim()&&(t.descricao=r.descricao.trim()),console.log("Dados para atualizaÃ§Ã£o:",t);const{data:e,error:s}=await N.ND.from("grupos").update(t).eq("id",r.id).select();if(s)throw console.error("Erro na atualizaÃ§Ã£o:",s),new Error(`Erro ao atualizar: ${s.message}`);console.log("Grupo atualizado com sucesso:",e),alert("Grupo atualizado com sucesso!")}else{let a=r.codigo;if(!a){const{data:o}=await N.ND.from("grupos").select("codigo").order("created_at",{ascending:!1}).limit(1),t=o&&o[0]&&o[0].codigo&&parseInt(o[0].codigo.replace(/\D/g,""))||0;a=`GRP${String(t+1).padStart(3,"0")}`}const{error:o}=await N.ND.from("grupos").insert({codigo:a,nome:r.nome,descricao:r.descricao});if(o)throw o;alert("Grupo adicionado com sucesso!")}await n(),d()}catch(a){console.error("Erro ao salvar grupo:",a),alert(`Erro ao ${i.value?"atualizar":"adicionar"} grupo: ${a.message}`)}finally{t.value=!1}},m=a=>{confirm(`Deseja realmente excluir o grupo "${a.nome}"?`)&&p(a.id)},p=async a=>{try{o.value=!0;const{data:t,error:e}=await N.ND.from("classes").select("id").eq("grupo_id",a);if(e)throw e;if(t&&t.length>0)return void alert(`NÃ£o Ã© possÃ­vel excluir este grupo porque existem ${t.length} classes associadas a ele.`);const{data:s,error:i}=await N.ND.from("produtos").select("id").eq("grupo_id",a);if(i)throw i;if(s&&s.length>0)return void alert(`NÃ£o Ã© possÃ­vel excluir este grupo porque existem ${s.length} produtos associados a ele.`);const{error:r}=await N.ND.from("grupos").delete().eq("id",a);if(r)throw r;alert("Grupo excluÃ­do com sucesso!"),await n()}catch(t){console.error("Erro ao excluir grupo:",t),alert(`Erro ao excluir grupo: ${t.message}`)}finally{o.value=!1}};return{grupos:a,loading:o,salvando:t,mostrarFormulario:s,modoEdicao:i,grupoAtual:r,carregarGrupos:n,formatarData:c,editarGrupo:l,fecharFormulario:d,salvarGrupo:u,confirmarExclusao:m}}},xt=wt;var Pt=(0,C.A)(xt,Et,At,!1,null,"761478a4",null);const St=Pt.exports;var yt=function(){var a=this,o=a._self._c;return o("div",{staticClass:"classes-list"},[o("div",{staticClass:"header"},[o("h3",[a._v("Gerenciamento de Classes")]),o("button",{staticClass:"btn-add",on:{click:function(o){a.mostrarFormulario=!0}}},[a._v(" Adicionar Classe ")])]),a.loading?o("div",{staticClass:"loading"},[o("p",[a._v("Carregando classes...")])]):0===a.classes.length?o("div",{staticClass:"empty-state"},[o("p",[a._v("Nenhuma classe cadastrada.")])]):o("div",{staticClass:"classes-table"},[o("table",[a._m(0),o("tbody",a._l(a.classes,(function(t){return o("tr",{key:t.id},[o("td",[a._v(a._s(t.codigo||t.id.slice(0,8)))]),o("td",[a._v(a._s(t.nome))]),o("td",[a._v(a._s(a.getNomeGrupo(t.grupo_id)))]),o("td",[a._v(a._s(t.descricao||"-"))]),o("td",[a._v(a._s(a.formatarData(t.created_at)))]),o("td",{staticClass:"actions"},[o("button",{staticClass:"btn-edit",on:{click:function(o){return a.editarClasse(t)}}},[a._v("Editar")]),o("button",{staticClass:"btn-delete",on:{click:function(o){return a.confirmarExclusao(t)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?o("div",{staticClass:"modal"},[o("div",{staticClass:"modal-content"},[o("div",{staticClass:"modal-header"},[o("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Classe")]),o("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("Ã—")])]),o("div",{staticClass:"modal-body"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.salvarClasse.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.grupo_id,expression:"classeAtual.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.classeAtual,"grupo_id",o.target.multiple?t:t[0])}}},[o("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(t){return o("option",{key:t.id,domProps:{value:t.id}},[a._v(" "+a._s(t.nome)+" ")])}))],2),0===a.grupos.length?o("div",{staticClass:"error-text"},[o("p",[a._v("Ã‰ necessÃ¡rio cadastrar pelo menos um grupo antes de adicionar classes.")])]):a._e()]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"codigo"}},[a._v("CÃ³digo da Classe")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.codigo,expression:"classeAtual.codigo"}],attrs:{id:"codigo",type:"text",placeholder:"Ex: CLS001"},domProps:{value:a.classeAtual.codigo},on:{input:function(o){o.target.composing||a.$set(a.classeAtual,"codigo",o.target.value)}}}),o("small",[a._v("Se nÃ£o informado, serÃ¡ gerado automaticamente")])]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"nome"}},[a._v("Nome da Classe*")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.nome,expression:"classeAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.classeAtual.nome},on:{input:function(o){o.target.composing||a.$set(a.classeAtual,"nome",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"descricao"}},[a._v("DescriÃ§Ã£o")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.descricao,expression:"classeAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.classeAtual.descricao},on:{input:function(o){o.target.composing||a.$set(a.classeAtual,"descricao",o.target.value)}}})]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando||0===a.grupos.length}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},Ot=[function(){var a=this,o=a._self._c;return o("thead",[o("tr",[o("th",[a._v("CÃ³digo da Classe")]),o("th",[a._v("Nome")]),o("th",[a._v("Grupo")]),o("th",[a._v("DescriÃ§Ã£o")]),o("th",[a._v("Data de CriaÃ§Ã£o")]),o("th",[a._v("AÃ§Ãµes")])])])}];const $t={name:"ClassesList",setup(){const a=(0,e.KR)([]),o=(0,e.KR)([]),t=(0,e.KR)(!0),s=(0,e.KR)(!1),i=(0,e.KR)(!1),r=(0,e.KR)(!1),n=(0,e.Kh)({id:null,grupo_id:"",codigo:"",nome:"",descricao:""});(0,e.sV)((async()=>{await Promise.all([c(),l()])}));const c=async()=>{try{const{data:a,error:t}=await N.ND.from("grupos").select("*").order("nome");if(t)throw t;o.value=a||[]}catch(a){console.error("Erro ao carregar grupos:",a),alert("Erro ao carregar grupos. Por favor, tente novamente.")}},l=async()=>{try{t.value=!0;const{data:o,error:e}=await N.ND.from("classes").select("*").order("nome");if(e)throw e;a.value=o||[]}catch(o){console.error("Erro ao carregar classes:",o),alert("Erro ao carregar classes. Por favor, tente novamente.")}finally{t.value=!1}},d=a=>{const t=o.value.find((o=>o.id===a));return t?t.nome:"Grupo nÃ£o encontrado"},u=a=>{if(!a)return"-";const o=new Date(a);return o.toLocaleDateString("pt-BR")},m=a=>{r.value=!0,n.id=a.id,n.grupo_id=a.grupo_id,n.codigo=a.codigo||"",n.nome=a.nome,n.descricao=a.descricao||"",i.value=!0},p=()=>{i.value=!1,r.value=!1,n.id=null,n.grupo_id="",n.codigo="",n.nome="",n.descricao=""},v=async()=>{try{if(s.value=!0,r.value){const{error:a}=await N.ND.from("classes").update({grupo_id:n.grupo_id,codigo:n.codigo,nome:n.nome,descricao:n.descricao}).eq("id",n.id);if(a)throw a;alert("Classe atualizada com sucesso!")}else{let a=n.codigo;if(!a){const{data:o}=await N.ND.from("classes").select("codigo").order("created_at",{ascending:!1}).limit(1),t=o&&o[0]&&o[0].codigo&&parseInt(o[0].codigo.replace(/\D/g,""))||0;a=`CLS${String(t+1).padStart(3,"0")}`}const{error:o}=await N.ND.from("classes").insert({grupo_id:n.grupo_id,codigo:a,nome:n.nome,descricao:n.descricao});if(o)throw o;alert("Classe adicionada com sucesso!")}await l(),p()}catch(a){console.error("Erro ao salvar classe:",a),alert(`Erro ao ${r.value?"atualizar":"adicionar"} classe: ${a.message}`)}finally{s.value=!1}},g=a=>{confirm(`Deseja realmente excluir a classe "${a.nome}"?`)&&_(a.id)},_=async a=>{try{t.value=!0;const{data:o,error:e}=await N.ND.from("produtos").select("id").eq("classe_id",a);if(e)throw e;if(o&&o.length>0)return void alert(`NÃ£o Ã© possÃ­vel excluir esta classe porque existem ${o.length} produtos associados a ela.`);const{error:s}=await N.ND.from("classes").delete().eq("id",a);if(s)throw s;alert("Classe excluÃ­da com sucesso!"),await l()}catch(o){console.error("Erro ao excluir classe:",o),alert(`Erro ao excluir classe: ${o.message}`)}finally{t.value=!1}};return{classes:a,grupos:o,loading:t,salvando:s,mostrarFormulario:i,modoEdicao:r,classeAtual:n,carregarClasses:l,carregarGrupos:c,getNomeGrupo:d,formatarData:u,editarClasse:m,fecharFormulario:p,salvarClasse:v,confirmarExclusao:g}}},Nt=$t;var Rt=(0,C.A)(Nt,yt,Ot,!1,null,"32eb1edc",null);const It=Rt.exports,Tt={name:"Classificacao",components:{GruposList:St,ClassesList:It},setup(){const a=(0,e.KR)("grupos");return{activeTab:a}}},Ft=Tt;var Mt=(0,C.A)(Ft,bt,Dt,!1,null,"ae10c55c",null);const zt=Mt.exports,Lt={name:"ClassificacaoView",components:{Classificacao:zt},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"ğŸ“§ Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligÃªncias</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - ComissÃ£o de PadronizaÃ§Ã£o de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"ğŸ’¾ Salvar",cancelButtonText:"âŒ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,o=document.getElementById("nomeRemetente").value;return a&&o?{emailRemetente:a,nomeRemetente:o}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const o={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(o)),this.$swal({title:"âœ… Sucesso!",text:"ConfiguraÃ§Ãµes de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const o=JSON.parse(a);this.emailRemetente=o.emailRemetente||this.emailRemetente,this.nomeRemetente=o.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configuraÃ§Ãµes:",a)}},closeDropdown(){this.dropdownOpen=!1}}},Bt=Lt;var qt=(0,C.A)(Bt,ft,Ct,!1,null,"556d8bc4",null);const kt=qt.exports;var Ut=function(){var a=this,o=a._self._c;return o("div",{staticClass:"login-rdm-container"},[a._m(0),o("main",{staticClass:"login-main"},[o("div",{staticClass:"container"},[o("div",{staticClass:"login-card"},[a._m(1),o("form",{staticClass:"login-form",on:{submit:function(o){return o.preventDefault(),a.fazerLogin.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"email"}},[a._v("ğŸ“§ E-mail:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.email,expression:"loginData.email"}],attrs:{type:"email",id:"email",placeholder:"Digite seu email",required:"",disabled:a.carregando},domProps:{value:a.loginData.email},on:{input:function(o){o.target.composing||a.$set(a.loginData,"email",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"senha"}},[a._v("ğŸ”’ Senha:")]),o("div",{staticClass:"password-input"},["checkbox"===(a.mostrarSenha?"text":"password")?o("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:"checkbox"},domProps:{checked:Array.isArray(a.loginData.senha)?a._i(a.loginData.senha,null)>-1:a.loginData.senha},on:{change:function(o){var t=a.loginData.senha,e=o.target,s=!!e.checked;if(Array.isArray(t)){var i=null,r=a._i(t,i);e.checked?r<0&&a.$set(a.loginData,"senha",t.concat([i])):r>-1&&a.$set(a.loginData,"senha",t.slice(0,r).concat(t.slice(r+1)))}else a.$set(a.loginData,"senha",s)}}}):"radio"===(a.mostrarSenha?"text":"password")?o("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:"radio"},domProps:{checked:a._q(a.loginData.senha,null)},on:{change:function(o){return a.$set(a.loginData,"senha",null)}}}):o("input",{directives:[{name:"model",rawName:"v-model",value:a.loginData.senha,expression:"loginData.senha"}],attrs:{id:"senha",placeholder:"Digite sua senha",required:"",disabled:a.carregando,type:a.mostrarSenha?"text":"password"},domProps:{value:a.loginData.senha},on:{input:function(o){o.target.composing||a.$set(a.loginData,"senha",o.target.value)}}}),o("button",{staticClass:"toggle-password",attrs:{type:"button",disabled:a.carregando},on:{click:function(o){a.mostrarSenha=!a.mostrarSenha}}},[a._v(" "+a._s(a.mostrarSenha?"ğŸ™ˆ":"ğŸ‘ï¸")+" ")])]),a.primeiroAcesso?o("small",{staticClass:"password-hint"},[a._v(" ğŸ’¡ Use a senha temporÃ¡ria enviada por email ")]):a._e()]),a.mensagem?o("div",{staticClass:"alert",class:a.tipoMensagem},[a._v(" "+a._s(a.mensagem)+" ")]):a._e(),o("button",{staticClass:"btn-login",attrs:{type:"submit",disabled:a.carregando||!a.loginData.email||!a.loginData.senha}},[a.carregando?o("span",[a._v("â³ Entrando...")]):o("span",[a._v("ğŸš€ Entrar no Sistema")])])]),o("div",{staticClass:"login-footer"},[o("div",{staticClass:"links"},[o("a",{attrs:{href:"#"},on:{click:function(o){o.preventDefault(),a.mostrarModalAjuda=!0}}},[a._v("â“ Esqueci minha senha")]),o("a",{attrs:{href:"#"},on:{click:function(o){o.preventDefault(),a.mostrarModalContato=!0}}},[a._v("ğŸ“ Suporte")])]),a._m(2)])]),a._m(3)])]),a.mostrarModalAjuda?o("div",{staticClass:"modal-overlay",on:{click:function(o){a.mostrarModalAjuda=!1}}},[o("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("â“ Esqueci minha senha")]),o("button",{staticClass:"btn-close",on:{click:function(o){a.mostrarModalAjuda=!1}}},[a._v("âœ•")])]),a._m(4)])]):a._e(),a.mostrarModalContato?o("div",{staticClass:"modal-overlay",on:{click:function(o){a.mostrarModalContato=!1}}},[o("div",{staticClass:"modal",on:{click:function(a){a.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[o("h3",[a._v("ğŸ“ Suporte TÃ©cnico")]),o("button",{staticClass:"btn-close",on:{click:function(o){a.mostrarModalContato=!1}}},[a._v("âœ•")])]),a._m(5)])]):a._e()])},jt=[function(){var a=this,o=a._self._c;return o("header",{staticClass:"login-header"},[o("div",{staticClass:"container"},[o("div",{staticClass:"logo-section"},[o("h1",[a._v("ğŸ¥ Sistema Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Dashboard RDM On-line")])])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"card-header"},[o("h2",[a._v("ğŸ” Acesso RDM")]),o("p",[a._v("FaÃ§a login para emitir RDMs")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"info"},[o("small",[a._v("ğŸ”’ Acesso seguro e criptografado")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"info-cards"},[o("div",{staticClass:"info-card"},[o("h3",[a._v("ğŸ“ O que vocÃª pode fazer")]),o("ul",[o("li",[a._v("âœ… Emitir RDMs on-line")]),o("li",[a._v("ğŸ“Š Acompanhar status das solicitaÃ§Ãµes")]),o("li",[a._v("ğŸ“‹ Consultar histÃ³rico")]),o("li",[a._v("ğŸ”” Receber notificaÃ§Ãµes automÃ¡ticas")])])]),o("div",{staticClass:"info-card"},[o("h3",[a._v("âš¡ Primeiro Acesso?")]),o("p",[a._v("Informe o e-mail e senha recebidos por e-mail")]),o("ol",[o("li",[a._v("Use o e-mail e senha enviados por e-mail")]),o("li",[a._v("Altere sua senha no primeiro login")]),o("li",[a._v("Configure suas preferÃªncias")]),o("li",[a._v("Comece a usar o sistema!")])])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modal-body"},[o("p",[a._v("Entre em contato com o CPM para redefinir sua senha:")]),o("div",{staticClass:"contact-info"},[o("p",[a._v("ğŸ“§ "),o("strong",[a._v("E-mail:")]),a._v(" comprarbemteste@gmail.com")]),o("p",[a._v("ğŸ“ "),o("strong",[a._v("Telefone:")]),a._v(" (61) 3315-2425")])]),o("p",[o("small",[a._v("ğŸ’¡ Informe seu nome completo e unidade/setor")])])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"modal-body"},[o("div",{staticClass:"contact-info"},[o("h4",[a._v("ğŸ’¬ Canais de Atendimento:")]),o("p",[a._v("ğŸ“§ "),o("strong",[a._v("E-mail:")]),a._v(" comprarbemteste@gmail.com")]),o("p",[a._v("ğŸ“ "),o("strong",[a._v("Telefone:")]),a._v(" (61) 3315-2425")]),o("p",[a._v("ğŸ• "),o("strong",[a._v("HorÃ¡rio:")]),a._v(" Segunda a Sexta, 8h Ã s 17h")])]),o("div",{staticClass:"faq"},[o("h4",[a._v("â“ Problemas Comuns:")]),o("ul",[o("li",[o("strong",[a._v("NÃ£o recebi o email:")]),a._v(" Verifique spam/lixeira")]),o("li",[o("strong",[a._v("Senha nÃ£o funciona:")]),a._v(" Certifique-se de usar a senha temporÃ¡ria")]),o("li",[o("strong",[a._v("Conta bloqueada:")]),a._v(" Contate o CPM")])])])])}];const Vt={name:"LoginRDM",data(){return{loginData:{email:"",senha:""},carregando:!1,mostrarSenha:!1,mensagem:"",tipoMensagem:"",primeiroAcesso:!1,mostrarModalAjuda:!1,mostrarModalContato:!1}},async mounted(){await this.verificarSessaoExistente()},methods:{async verificarSessaoExistente(){try{const{data:a}=await N.ND.auth.getSession();if(a?.session?.user){const{data:o,error:t}=await N.ND.from("usuarios_rdm").select("*").eq("email",a.session.user.email).single();!t&&o&&(console.log("UsuÃ¡rio RDM jÃ¡ logado, redirecionando..."),this.$router.push("/dashboard-rdm"))}}catch(a){console.log("Nenhuma sessÃ£o ativa encontrada")}},async fazerLogin(){if(!this.carregando){this.carregando=!0,this.mensagem="";try{console.log("ğŸ” Tentativa de login RDM:",this.loginData.email),console.log("ğŸ” Buscando usuÃ¡rio RDM no banco:",this.loginData.email);const{data:a,error:o}=await N.ND.from("usuarios_rdm").select("*").eq("email",this.loginData.email),t=a&&a.length>0?a[0]:null;if(console.log("ğŸ” Resultado da busca:",{encontrou:!!t,erro:o?.message||"Nenhum erro",dados:t?{id:t.id,nome:t.nome_usuario,email:t.email,ativo:t.ativo,tem_senha:!!t.senha_temporaria}:null}),o)throw console.error("âŒ Erro na consulta ao banco:",o),new Error("Erro ao consultar banco de dados. Tente novamente.");if(!t)throw new Error("Email nÃ£o encontrado. Verifique se o email estÃ¡ correto ou contate o CPM.");if(!t.ativo)throw new Error("UsuÃ¡rio inativo. Contate o CPM para ativar sua conta.");if(console.log("âœ… UsuÃ¡rio RDM encontrado:",t.nome_usuario),t.senha_temporaria!==this.loginData.senha)throw new Error("Senha incorreta. Verifique sua senha cadastrada.");console.log("âœ… Login realizado com sucesso - senha validada"),localStorage.setItem("usuarioRDM",JSON.stringify({id:t.id,user_id:t.user_id,nome_usuario:t.nome_usuario,email:t.email,unidade_setor:t.unidade_setor,nome_coordenador:t.nome_coordenador,materiais:t.materiais,tenant_id:t.tenant_id})),await N.ND.from("usuarios_rdm").update({atualizado_em:(new Date).toISOString(),convite_aceito:!0}).eq("id",t.id),this.mensagem=`ğŸ‰ Bem-vindo(a), ${t.nome_usuario}!`,this.tipoMensagem="success",console.log("âœ… Login RDM realizado com sucesso!"),setTimeout((()=>{this.$router.push("/dashboard-rdm")}),1500)}catch(a){console.error("âŒ Erro no login RDM:",a),this.mensagem=a.message,this.tipoMensagem="error"}finally{this.carregando=!1}}}}},Gt=Vt;var Jt=(0,C.A)(Gt,Ut,jt,!1,null,"d3851fe0",null);const Ht=Jt.exports;var Qt=function(){var a=this,o=a._self._c;return o("div",{staticClass:"dashboard-rdm"},[o("header",{staticClass:"dashboard-header"},[o("div",{staticClass:"container"},[o("div",{staticClass:"header-content"},[a._m(0),o("div",{staticClass:"user-section"},[o("div",{staticClass:"user-info"},[o("span",{staticClass:"user-name"},[a._v("ğŸ‘¤ "+a._s(a.usuarioAtual.nome_usuario))]),o("span",{staticClass:"user-sector"},[a._v("ğŸ¢ "+a._s(a.usuarioAtual.unidade_setor))])]),o("button",{staticClass:"btn-logout",on:{click:a.logout}},[a._v("ğŸšª Sair")])])])])]),o("nav",{staticClass:"nav-tabs"},[o("div",{staticClass:"container"},[o("div",{staticClass:"tabs"},[o("button",{staticClass:"tab-btn",class:{active:"avaliacao"===a.activeTab},on:{click:function(o){a.activeTab="avaliacao"}}},[a._v(" â­ AvaliaÃ§Ã£o de Materiais ")]),o("button",{staticClass:"tab-btn",class:{active:"historico"===a.activeTab},on:{click:function(o){a.activeTab="historico"}}},[a._v(" ğŸ“‹ HistÃ³rico ")]),o("button",{staticClass:"tab-btn",class:{active:"materiais"===a.activeTab},on:{click:function(o){a.activeTab="materiais"}}},[a._v(" ğŸ“¦ Meus Materiais ")]),o("button",{staticClass:"tab-btn",class:{active:"perfil"===a.activeTab},on:{click:function(o){a.activeTab="perfil"}}},[a._v(" âš™ï¸ Perfil ")])])])]),o("main",{staticClass:"main-content"},[o("div",{staticClass:"container"},["avaliacao"===a.activeTab?o("div",{staticClass:"tab-content"},[a._m(1),o("div",{staticClass:"reclamacao-form-card"},[o("form",{on:{submit:function(o){return o.preventDefault(),a.enviarReclamacao.apply(null,arguments)}}},[o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ‘¤ Dados do Reclamante")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Reclamante:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.nome_reclamante,expression:"novaReclamacao.nome_reclamante"}],attrs:{type:"text",required:""},domProps:{value:a.novaReclamacao.nome_reclamante},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"nome_reclamante",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Telefone:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.telefone,expression:"novaReclamacao.telefone"}],attrs:{type:"tel",placeholder:"(00) 00000-0000",required:""},domProps:{value:a.novaReclamacao.telefone},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"telefone",o.target.value)}}})])]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Email:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.email,expression:"novaReclamacao.email"}],attrs:{type:"email",required:""},domProps:{value:a.novaReclamacao.email},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"email",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Unidade/Setor:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.unidade_setor,expression:"novaReclamacao.unidade_setor"}],attrs:{type:"text",required:""},domProps:{value:a.novaReclamacao.unidade_setor},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"unidade_setor",o.target.value)}}})])])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ“¦ Dados do Material")]),o("div",{staticClass:"form-group"},[o("label",[a._v("Selecionar Material:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.materialSelecionadoReclamacao,expression:"materialSelecionadoReclamacao"}],attrs:{required:""},on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.materialSelecionadoReclamacao=o.target.multiple?t:t[0]},a.preencherDadosMaterial]}},[o("option",{attrs:{value:""}},[a._v("Selecione um material sob sua responsabilidade")]),a._l(a.usuarioAtual.materiais,(function(t){return o("option",{key:t.produto_id,domProps:{value:t}},[a._v(" "+a._s(t.nome)+" - "+a._s(t.codigo)+" ")])}))],2),0===a.usuarioAtual.materiais?.length?o("small",{staticClass:"error-text"},[a._v(" âš ï¸ VocÃª nÃ£o possui materiais cadastrados. Entre em contato com a CPM. ")]):a._e()]),a.materialSelecionadoReclamacao?o("div",{staticClass:"material-info-reclamacao"},[o("h4",[a._v("ğŸ“‹ Dados do Material Selecionado:")]),o("div",{staticClass:"form-row"},[o("div",{staticClass:"form-group"},[o("label",[a._v("Nome do Material:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.nome_material,expression:"novaReclamacao.nome_material"}],staticClass:"readonly-input",attrs:{type:"text",readonly:""},domProps:{value:a.novaReclamacao.nome_material},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"nome_material",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("CÃ³digo do Material:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.codigo_material,expression:"novaReclamacao.codigo_material"}],staticClass:"readonly-input",attrs:{type:"text",readonly:""},domProps:{value:a.novaReclamacao.codigo_material},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"codigo_material",o.target.value)}}})])]),o("div",{staticClass:"form-group"},[o("label",[a._v("Marca e Modelo:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.marca_modelo,expression:"novaReclamacao.marca_modelo"}],attrs:{type:"text",placeholder:"Informe a marca e modelo especÃ­ficos (se necessÃ¡rio)"},domProps:{value:a.novaReclamacao.marca_modelo},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"marca_modelo",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("â­ AvaliaÃ§Ã£o da Qualidade (obrigatÃ³rio):")]),o("div",{staticClass:"star-rating"},a._l(5,(function(t){return o("span",{key:t,staticClass:"star",class:{active:(a.novaReclamacao.rating||0)>=t},attrs:{title:`${t} estrela${t>1?"s":""}`},on:{click:function(o){a.novaReclamacao.rating=t}}},[a._v(" â­ ")])})),0),a.novaReclamacao.rating?o("small",{staticClass:"rating-info"},[a._v(" AvaliaÃ§Ã£o: "+a._s(a.novaReclamacao.rating)+"/5 estrelas ")]):o("small",{staticClass:"error-text"},[a._v(" âš ï¸ Por favor, dÃª uma avaliaÃ§Ã£o de 1 a 5 estrelas ")])])]):a._e()]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸ’¬ ComentÃ¡rios e ObservaÃ§Ãµes")]),o("div",{staticClass:"form-group"},[o("label",[a._v("ObservaÃ§Ãµes sobre o Material:")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.comentario,expression:"novaReclamacao.comentario"}],attrs:{rows:"3",placeholder:"Como estÃ¡ sendo a experiÃªncia com este material? Qualidade, durabilidade, eficÃ¡cia..."},domProps:{value:a.novaReclamacao.comentario},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"comentario",o.target.value)}}})])]),o("div",{staticClass:"form-section"},[o("h3",[a._v("ğŸš¨ Problemas e ReclamaÃ§Ãµes (opcional)")]),o("div",{staticClass:"form-group"},[o("label",[a._v("DescriÃ§Ã£o de Problemas:")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.registro_reclamacao,expression:"novaReclamacao.registro_reclamacao"}],attrs:{rows:"4",placeholder:"Se houver problemas, defeitos ou situaÃ§Ãµes negativas, descreva detalhadamente aqui... (opcional)"},domProps:{value:a.novaReclamacao.registro_reclamacao},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"registro_reclamacao",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("SugestÃµes de Melhoria:")]),o("textarea",{directives:[{name:"model",rawName:"v-model",value:a.novaReclamacao.sugestoes,expression:"novaReclamacao.sugestoes"}],attrs:{rows:"3",placeholder:"SugestÃµes para melhorias ou soluÃ§Ãµes... (opcional)"},domProps:{value:a.novaReclamacao.sugestoes},on:{input:function(o){o.target.composing||a.$set(a.novaReclamacao,"sugestoes",o.target.value)}}})])]),o("div",{staticClass:"form-actions"},[o("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.limparAvaliacao}},[a._v(" ğŸ—‘ï¸ Limpar ")]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.enviandoReclamacao||!a.novaReclamacao.rating}},[a.enviandoReclamacao?o("span",[a._v("â³ Enviando...")]):o("span",[a._v("â­ Enviar AvaliaÃ§Ã£o")])])])])])]):a._e(),"historico"===a.activeTab?o("div",{staticClass:"tab-content"},[a._m(2),o("div",{staticClass:"historico-container"},[o("div",{staticClass:"filters-card"},[o("div",{staticClass:"filters-row"},[o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ” Buscar:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],attrs:{type:"text",placeholder:"Material, cÃ³digo..."},domProps:{value:a.filtros.busca},on:{input:[function(o){o.target.composing||a.$set(a.filtros,"busca",o.target.value)},a.aplicarFiltros]}})]),o("div",{staticClass:"filter-group"},[o("label",[a._v("â­ AvaliaÃ§Ã£o:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.rating,expression:"filtros.rating"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"rating",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todas")]),o("option",{attrs:{value:"5"}},[a._v("â­â­â­â­â­ (5 estrelas)")]),o("option",{attrs:{value:"4"}},[a._v("â­â­â­â­ (4 estrelas)")]),o("option",{attrs:{value:"3"}},[a._v("â­â­â­ (3 estrelas)")]),o("option",{attrs:{value:"2"}},[a._v("â­â­ (2 estrelas)")]),o("option",{attrs:{value:"1"}},[a._v("â­ (1 estrela)")])])]),o("div",{staticClass:"filter-group"},[o("label",[a._v("ğŸ“… PerÃ­odo:")]),o("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.periodo,expression:"filtros.periodo"}],on:{change:[function(o){var t=Array.prototype.filter.call(o.target.options,(function(a){return a.selected})).map((function(a){var o="_value"in a?a._value:a.value;return o}));a.$set(a.filtros,"periodo",o.target.multiple?t:t[0])},a.aplicarFiltros]}},[o("option",{attrs:{value:""}},[a._v("Todos")]),o("option",{attrs:{value:"hoje"}},[a._v("Hoje")]),o("option",{attrs:{value:"semana"}},[a._v("Esta Semana")]),o("option",{attrs:{value:"mes"}},[a._v("Este MÃªs")]),o("option",{attrs:{value:"trimestre"}},[a._v("Ãšltimo Trimestre")])])])])]),o("div",{staticClass:"feedbacks-list"},[a.carregandoHistorico?o("div",{staticClass:"loading-card"},[a._v(" â³ Carregando histÃ³rico... ")]):0===a.historicoFeedbacks.length?o("div",{staticClass:"empty-state-card"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“­")]),o("h3",[a._v("Nenhuma avaliaÃ§Ã£o encontrada")]),o("p",[a._v("VocÃª ainda nÃ£o enviou nenhuma avaliaÃ§Ã£o de material.")]),o("button",{staticClass:"btn-primary",on:{click:function(o){a.activeTab="avaliacao"}}},[a._v(" â­ Fazer Primeira AvaliaÃ§Ã£o ")])]):o("div",{staticClass:"feedbacks-grid"},a._l(a.historicoFeedbacks,(function(t){return o("div",{key:t.id,staticClass:"feedback-card-history"},[o("div",{staticClass:"feedback-header"},[o("h4",[a._v(a._s(t.material_nome))]),o("div",{staticClass:"rating-display"},a._l(5,(function(e){return o("span",{key:e,staticClass:"star",class:{active:t.rating>=e}},[a._v("â­")])})),0)]),o("div",{staticClass:"feedback-content"},[o("p",{staticClass:"feedback-details"},[o("strong",[a._v("CÃ³digo:")]),a._v(" "+a._s(t.material_codigo)),o("br"),o("strong",[a._v("AvaliaÃ§Ã£o:")]),a._v(" "+a._s(t.rating)+"/5 estrelas ")]),t.comentario?o("p",{staticClass:"feedback-comentario"},[o("strong",[a._v("ComentÃ¡rio:")]),a._v(" "+a._s(t.comentario)+" ")]):a._e()]),o("div",{staticClass:"feedback-footer"},[o("span",{staticClass:"feedback-date"},[a._v("ğŸ“… "+a._s(a.formatDate(t.criado_em)))])])])})),0)])])]):a._e(),"materiais"===a.activeTab?o("div",{staticClass:"tab-content"},[a._m(3),o("div",{staticClass:"materiais-container"},[0===a.usuarioAtual.materiais?.length?o("div",{staticClass:"empty-state-card"},[o("div",{staticClass:"empty-icon"},[a._v("ğŸ“¦")]),o("h3",[a._v("Nenhum material cadastrado")]),o("p",[a._v("VocÃª ainda nÃ£o possui materiais sob sua responsabilidade.")]),o("p",[a._v("Entre em contato com a CPM para solicitar acesso aos materiais do seu setor.")])]):o("div",{staticClass:"materiais-grid"},a._l(a.usuarioAtual.materiais,(function(t){return o("div",{key:t.produto_id,staticClass:"material-card"},[o("div",{staticClass:"material-header"},[o("h4",[a._v(a._s(t.nome))]),o("span",{staticClass:"material-code"},[a._v(a._s(t.codigo))])]),o("div",{staticClass:"material-info"},[o("p",[o("strong",[a._v("Periodicidade de AvaliaÃ§Ã£o:")]),a._v(" "+a._s(t.periodicidade_rdm))]),o("p",[o("strong",[a._v("PrÃ³xima AvaliaÃ§Ã£o:")]),a._v(" "+a._s(a.calcularProximaAvaliacao(t)))])]),o("div",{staticClass:"material-actions"},[o("button",{staticClass:"btn-avaliar",on:{click:function(o){a.activeTab="avaliacao"}}},[a._v(" â­ Avaliar Material ")])])])})),0)])]):a._e(),"perfil"===a.activeTab?o("div",{staticClass:"tab-content"},[a._m(4),o("div",{staticClass:"perfil-container"},[o("div",{staticClass:"perfil-cards"},[o("div",{staticClass:"perfil-card"},[o("h3",[a._v("ğŸ‘¤ Dados Pessoais")]),o("div",{staticClass:"perfil-info"},[o("p",[o("strong",[a._v("Nome:")]),a._v(" "+a._s(a.usuarioAtual.nome_usuario))]),o("p",[o("strong",[a._v("Email:")]),a._v(" "+a._s(a.usuarioAtual.email))]),o("p",[o("strong",[a._v("Unidade/Setor:")]),a._v(" "+a._s(a.usuarioAtual.unidade_setor))]),o("p",[o("strong",[a._v("Coordenador:")]),a._v(" "+a._s(a.usuarioAtual.nome_coordenador))])])]),o("div",{staticClass:"perfil-card"},[o("h3",[a._v("ğŸ“Š EstatÃ­sticas")]),o("div",{staticClass:"stats-grid"},[o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(a.totalFeedbacks))]),o("span",{staticClass:"stat-label"},[a._v("AvaliaÃ§Ãµes Enviadas")])]),o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(a.feedbacksRecentes))]),o("span",{staticClass:"stat-label"},[a._v("Ãšltimos 30 dias")])]),o("div",{staticClass:"stat-item"},[o("span",{staticClass:"stat-number"},[a._v(a._s(a.usuarioAtual.materiais?.length||0))]),o("span",{staticClass:"stat-label"},[a._v("Materiais Sob Responsabilidade")])])])]),o("div",{staticClass:"perfil-card"},[o("h3",[a._v("ğŸ”’ Alterar Senha")]),o("form",{staticClass:"senha-form",on:{submit:function(o){return o.preventDefault(),a.alterarSenha.apply(null,arguments)}}},[o("div",{staticClass:"form-group"},[o("label",[a._v("Senha Atual:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.senhaAtual,expression:"alteracaoSenha.senhaAtual"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.senhaAtual},on:{input:function(o){o.target.composing||a.$set(a.alteracaoSenha,"senhaAtual",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Nova Senha:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.novaSenha,expression:"alteracaoSenha.novaSenha"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.novaSenha},on:{input:function(o){o.target.composing||a.$set(a.alteracaoSenha,"novaSenha",o.target.value)}}})]),o("div",{staticClass:"form-group"},[o("label",[a._v("Confirmar Nova Senha:")]),o("input",{directives:[{name:"model",rawName:"v-model",value:a.alteracaoSenha.confirmaSenha,expression:"alteracaoSenha.confirmaSenha"}],attrs:{type:"password",required:""},domProps:{value:a.alteracaoSenha.confirmaSenha},on:{input:function(o){o.target.composing||a.$set(a.alteracaoSenha,"confirmaSenha",o.target.value)}}})]),o("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.alterandoSenha}},[a.alterandoSenha?o("span",[a._v("â³ Alterando...")]):o("span",[a._v("ğŸ”’ Alterar Senha")])])])])])])]):a._e()])])])},Zt=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo-section"},[o("h1",[a._v("ğŸ¥ Sistema Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Dashboard RDM On-line")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"page-header"},[o("h2",[a._v("â­ AvaliaÃ§Ã£o de Materiais")]),o("p",[a._v("Avalie a qualidade dos materiais e registre problemas ou sugestÃµes")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"page-header"},[o("h2",[a._v("ğŸ“‹ HistÃ³rico de AvaliaÃ§Ãµes")]),o("p",[a._v("Veja suas avaliaÃ§Ãµes e feedbacks anteriores")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"page-header"},[o("h2",[a._v("ğŸ“¦ Meus Materiais")]),o("p",[a._v("Materiais sob sua responsabilidade para avaliaÃ§Ã£o")])])},function(){var a=this,o=a._self._c;return o("div",{staticClass:"page-header"},[o("h2",[a._v("âš™ï¸ Meu Perfil")]),o("p",[a._v("InformaÃ§Ãµes da sua conta e configuraÃ§Ãµes")])])}];const Yt={name:"DashboardRDM",data(){return{activeTab:"avaliacao",usuarioAtual:{},novaReclamacao:{nome_reclamante:"",telefone:"",email:"",unidade_setor:"",nome_material:"",codigo_material:"",marca_modelo:"",rating:0,comentario:"",registro_reclamacao:"",sugestoes:""},materialSelecionadoReclamacao:null,enviandoReclamacao:!1,historicoFeedbacks:[],carregandoHistorico:!1,filtros:{busca:"",rating:"",periodo:""},alteracaoSenha:{senhaAtual:"",novaSenha:"",confirmaSenha:""},alterandoSenha:!1}},computed:{totalFeedbacks(){return this.historicoFeedbacks.length},feedbacksRecentes(){return this.historicoFeedbacks.filter((a=>{const o=new Date;return o.setMonth(o.getMonth()-1),new Date(a.criado_em)>=o})).length}},async mounted(){await this.carregarDadosUsuario(),await this.carregarHistoricoFeedbacks(),this.inicializarReclamacao()},watch:{activeTab(a){"historico"===a&&this.carregarHistoricoFeedbacks()}},methods:{async carregarDadosUsuario(){try{const a=localStorage.getItem("usuarioRDM");if(!a)throw new Error("Dados do usuÃ¡rio nÃ£o encontrados");if(this.usuarioAtual=JSON.parse(a),!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usuÃ¡rio incompletos");console.log("âœ… Dados do usuÃ¡rio carregados:",{nome:this.usuarioAtual.nome_usuario,id:this.usuarioAtual.id,tenant_id:this.usuarioAtual.tenant_id,materiais:this.usuarioAtual.materiais?.length||0})}catch(a){console.error("âŒ Erro ao carregar dados do usuÃ¡rio:",a),alert("Erro ao carregar dados do usuÃ¡rio. Por favor, faÃ§a login novamente."),this.$router.push("/rdm")}},inicializarReclamacao(){this.novaReclamacao.nome_reclamante=this.usuarioAtual.nome_usuario||"",this.novaReclamacao.email=this.usuarioAtual.email||"",this.novaReclamacao.unidade_setor=this.usuarioAtual.unidade_setor||"",this.novaReclamacao.rating=0,this.novaReclamacao.comentario=""},async carregarHistoricoFeedbacks(){this.carregandoHistorico=!0;try{if(!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usuÃ¡rio incompletos");const{data:a,error:o}=await N.ND.from("material_feedbacks").select("*").eq("usuario_rdm_id",this.usuarioAtual.id).eq("tenant_id",this.usuarioAtual.tenant_id).order("criado_em",{ascending:!1});if(o)throw o;this.historicoFeedbacks=a||[],this.aplicarFiltros()}catch(a){console.error("âŒ [HISTÃ“RICO] Erro:",a),this.historicoFeedbacks=[],alert("Erro ao carregar histÃ³rico: "+a.message)}finally{this.carregandoHistorico=!1}},aplicarFiltros(){if(!this.historicoFeedbacks)return;let a=[...this.historicoFeedbacks];if(this.filtros.busca){const o=this.filtros.busca.toLowerCase();a=a.filter((a=>a.material_nome?.toLowerCase().includes(o)||a.material_codigo?.toLowerCase().includes(o)))}if(this.filtros.rating&&(a=a.filter((a=>a.rating==this.filtros.rating))),this.filtros.periodo){const o=new Date;a=a.filter((a=>{const t=new Date(a.criado_em);switch(this.filtros.periodo){case"hoje":return t.toDateString()===o.toDateString();case"semana":const a=new Date(o.getTime()-6048e5);return t>=a;case"mes":return t.getMonth()===o.getMonth()&&t.getFullYear()===o.getFullYear();case"trimestre":const e=new Date(o.getTime()-7776e6);return t>=e;default:return!0}}))}},calcularProximaAvaliacao(a){const o=new Date,t=a.periodicidade_rdm||"MENSAL";switch(t.toUpperCase()){case"SEMANAL":o.setDate(o.getDate()+7);break;case"QUINZENAL":o.setDate(o.getDate()+15);break;case"MENSAL":o.setMonth(o.getMonth()+1);break;case"TRIMESTRAL":o.setMonth(o.getMonth()+3);break;case"SEMESTRAL":o.setMonth(o.getMonth()+6);break;case"ANUAL":o.setFullYear(o.getFullYear()+1);break;default:o.setMonth(o.getMonth()+1)}return o.toLocaleDateString("pt-BR")},async enviarReclamacao(){if(!this.enviandoReclamacao){this.enviandoReclamacao=!0;try{if(console.log("ğŸ“¤ [RECLAMAÃ‡ÃƒO] Enviando reclamaÃ§Ã£o..."),!this.usuarioAtual.id||!this.usuarioAtual.tenant_id)throw new Error("Dados do usuÃ¡rio incompletos");if(!this.materialSelecionadoReclamacao)throw new Error("Nenhum material selecionado");const a={id:crypto.randomUUID(),tenant_id:this.usuarioAtual.tenant_id,usuario_rdm_id:this.usuarioAtual.id,produto_id:this.materialSelecionadoReclamacao.produto_id,material_nome:this.novaReclamacao.nome_material,material_codigo:this.novaReclamacao.codigo_material,rating:this.novaReclamacao.rating,comentario:this.novaReclamacao.comentario||"",criado_em:(new Date).toISOString()};console.log("ğŸ’¾ [AVALIAÃ‡ÃƒO] Dados preparados:",a);const{error:o}=await N.ND.from("material_feedbacks").insert([a]);if(o)throw console.error("âŒ [AVALIAÃ‡ÃƒO] Erro ao salvar feedback:",o),new Error(o.message);if(console.log("âœ… [AVALIAÃ‡ÃƒO] Feedback salvo com sucesso!"),this.novaReclamacao.registro_reclamacao?.trim()){const a={id:crypto.randomUUID(),tenant_id:this.usuarioAtual.tenant_id,usuario_rdm_id:this.usuarioAtual.id,nome_reclamante:this.novaReclamacao.nome_reclamante,telefone:this.novaReclamacao.telefone,email:this.novaReclamacao.email,unidade_setor:this.novaReclamacao.unidade_setor,nome_material:this.novaReclamacao.nome_material,codigo_material:this.novaReclamacao.codigo_material,marca_modelo:this.novaReclamacao.marca_modelo,registro_reclamacao:this.novaReclamacao.registro_reclamacao,sugestoes:this.novaReclamacao.sugestoes||"",status:"ABERTA",data_reclamacao:(new Date).toISOString()},{error:o}=await N.ND.from("reclamacoes_usuarios").insert([a]);if(o)throw console.error("âŒ [RECLAMAÃ‡ÃƒO] Erro ao salvar reclamaÃ§Ã£o:",o),new Error(o.message)}await this.carregarHistoricoFeedbacks(),alert("âœ… AvaliaÃ§Ã£o enviada com sucesso!"),this.limparAvaliacao()}catch(a){console.error("âŒ [RECLAMAÃ‡ÃƒO] Erro ao enviar:",a),alert("Erro ao enviar: "+a.message)}finally{this.enviandoReclamacao=!1}}},preencherDadosMaterial(){this.materialSelecionadoReclamacao&&(this.novaReclamacao.nome_material=this.materialSelecionadoReclamacao.nome,this.novaReclamacao.codigo_material=this.materialSelecionadoReclamacao.codigo,this.novaReclamacao.marca_modelo="",console.log("ğŸ“¦ [RECLAMAÃ‡ÃƒO] Material selecionado:",this.materialSelecionadoReclamacao.nome))},limparAvaliacao(){this.novaReclamacao={nome_reclamante:this.usuarioAtual.nome_usuario||"",telefone:"",email:this.usuarioAtual.email||"",unidade_setor:this.usuarioAtual.unidade_setor||"",nome_material:"",codigo_material:"",marca_modelo:"",rating:0,comentario:"",registro_reclamacao:"",sugestoes:""},this.materialSelecionadoReclamacao=null},formatDate(a){return new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},async alterarSenha(){if(this.alteracaoSenha.novaSenha===this.alteracaoSenha.confirmaSenha){this.alterandoSenha=!0;try{alert("ğŸ‰ Senha alterada com sucesso!"),this.alteracaoSenha={senhaAtual:"",novaSenha:"",confirmaSenha:""}}catch(a){console.error("âŒ Erro ao alterar senha:",a),alert("âŒ Erro ao alterar senha: "+a.message)}finally{this.alterandoSenha=!1}}else alert("âŒ As senhas nÃ£o coincidem!")},async logout(){confirm("Tem certeza que deseja sair?")&&(localStorage.removeItem("usuarioRDM"),this.$router.push("/rdm"))}}},Xt=Yt;var Kt=(0,C.A)(Xt,Qt,Zt,!1,null,"3b94202a",null);const Wt=Kt.exports;var ae=function(){var a=this,o=a._self._c;return o("div",{staticClass:"pesquisa-tecnica-view"},[o("PesquisaBot")],1)},oe=[];const te={name:"PesquisaTecnica",components:{PesquisaBot:aa}},ee=te;var se=(0,C.A)(ee,ae,oe,!1,null,"923bc138",null);const ie=se.exports;var re=function(){var a=this,o=a._self._c;return o("div",{staticClass:"processos-view"},[o("header",{staticClass:"app-header"},[a._m(0),a.isUsuarioProcessosOnly?a._e():o("nav",{staticClass:"main-nav"},[o("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),o("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[o("span",[a._v("CatÃ¡logo")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),o("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[o("span",[a._v("ClassificaÃ§Ã£o")]),o("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),o("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),o("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")]),o("router-link",{staticClass:"nav-item",attrs:{to:"/processos-administrativos"}},[o("span",[a._v("Processos")]),o("span",{staticClass:"nav-subtitle"},[a._v("Administrativos")])])],1),a.isUsuarioProcessosOnly?o("div",{staticClass:"processos-indicator"},["orgao_administrativo"===a.perfilUsuario?o("span",{staticClass:"processos-badge"},[a._v(" ğŸ“‹ Ã“rgÃ£o Administrativo - Assinaturas e HomologaÃ§Ãµes ")]):a._e(),"assessoria_juridica"===a.perfilUsuario?o("span",{staticClass:"processos-badge"},[a._v(" âš–ï¸ Assessoria JurÃ­dica - AnÃ¡lise Legal ")]):a._e()]):a._e(),o("div",{staticClass:"user-menu"},[o("div",{staticClass:"profile-dropdown"},[o("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[o("div",{staticClass:"profile-avatar"},[a._v(" ğŸ‘¤ ")]),o("div",{staticClass:"profile-info"},[o("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),o("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),o("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("â–¼")])]),a.dropdownOpen?o("div",{staticClass:"dropdown-menu"},[o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" âš™ï¸ ConfiguraÃ§Ã£o ")]),o("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ğŸ“§ Configurar Email ")]),o("hr",{staticClass:"dropdown-divider"}),o("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" ğŸšª Sair ")])]):a._e()])])]),o("main",{staticClass:"main-content"},[o("ProcessosAdministrativosComponent")],1)])},ne=[function(){var a=this,o=a._self._c;return o("div",{staticClass:"logo"},[o("div",{staticClass:"logo-content"},[o("h1",[a._v("Comprar Bem")]),o("span",{staticClass:"subtitle"},[a._v("Compras PÃºblicas Inteligentes")])])])}],ce=t(3722);const le={name:"ProcessosAdministrativos",components:{ProcessosAdministrativosComponent:ce["default"]},data(){return{nomeUsuario:"",emailUsuario:"",dropdownOpen:!1,isUsuarioProcessosOnly:!1,perfilUsuario:""}},async mounted(){await this.verificarAutenticacao(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async verificarAutenticacao(){try{const{data:a}=await N.ND.auth.getSession(),o=a?.session?.user;if(!o)return void this.$router.push("/");this.nomeUsuario=o.user_metadata?.nome||o.email?.split("@")[0]||"UsuÃ¡rio",this.emailUsuario=o.email||"";const{data:t}=await N.ND.from("usuarios").select("perfil_usuario").eq("id",o.id).single();this.perfilUsuario=t?.perfil_usuario||"",this.isUsuarioProcessosOnly=["orgao_administrativo","assessoria_juridica"].includes(this.perfilUsuario),this.isUsuarioProcessosOnly&&console.log(`ğŸ”’ UsuÃ¡rio ${this.perfilUsuario} logado - Acesso restrito a Processos Administrativos`)}catch(a){console.error("Erro na verificaÃ§Ã£o de autenticaÃ§Ã£o:",a),this.$router.push("/")}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){const o=this.$el?.querySelector(".profile-dropdown");o&&!o.contains(a.target)&&(this.dropdownOpen=!1)},abrirConfiguracaoEmail(){alert("ConfiguraÃ§Ã£o de email em desenvolvimento"),this.dropdownOpen=!1},async logout(){try{await N.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.dropdownOpen=!1}}},de=le;var ue=(0,C.A)(de,re,ne,!1,null,"25e44d5a",null);const me=ue.exports;e.Ay.use(P.Ay);const pe=[{path:"/",name:"Home",component:B,meta:{requiresAuth:!1}},{path:"/dashboard",name:"Dashboard",component:qa,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"dashboard"}},{path:"/cadastro",name:"Cadastro",component:oo,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"cadastro_produtos"}},{path:"/analise/:id",name:"Analise",component:go,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"cadastro_produtos"}},{path:"/catalogo",name:"Catalogo",component:So,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"catalogo_marcas"}},{path:"/feedback",name:"Feedback",component:Bo,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"rdm"}},{path:"/dcb",name:"DCB",component:Ko,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"dcb"}},{path:"/classificacao",name:"Classificacao",component:kt,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"classificacao"}},{path:"/produtos/:id",name:"DetalheProduto",component:()=>t.e(961).then(t.bind(t,9961)),props:!0,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"cadastro_produtos"}},{path:"/pesquisa-tecnica",name:"PesquisaTecnica",component:ie,meta:{requiresAuth:!0,requiredProfiles:["cpm"],moduloRequired:"cadastro_produtos"}},{path:"/ccl",name:"CCL",component:ht,meta:{requiresAuth:!0,requiredProfiles:["ccl"],moduloRequired:"painel_ccl"}},{path:"/processos-administrativos",name:"ProcessosAdministrativos",component:me,meta:{requiresAuth:!0,requiredProfiles:["cpm","orgao_administrativo","assessoria_juridica"],moduloRequired:"processos_administrativos"}},{path:"/registro-orgao",name:"RegistroOrgao",component:()=>t.e(645).then(t.bind(t,1645)),meta:{requiresAuth:!1}},{path:"/validar-dcb/:numero/:ano",name:"ValidarDCB",component:()=>t.e(796).then(t.bind(t,1796)),props:!0,meta:{requiresAuth:!1}},{path:"/rdm",name:"LoginRDM",component:Ht,meta:{requiresAuth:!1}},{path:"/dashboard-rdm",name:"DashboardRDM",component:Wt,meta:{requiresAuth:!1}},{path:"/catalogo-publico",name:"CatalogoPublico",component:()=>t.e(829).then(t.bind(t,2829)),meta:{requiresAuth:!1}},{path:"/acesso-negado",name:"AcessoNegado",component:()=>t.e(83).then(t.bind(t,1083)),meta:{requiresAuth:!0}},{path:"/debug-usuarios",name:"DebugUsuarios",component:()=>t.e(46).then(t.bind(t,2046)),meta:{requiresAuth:!1}},{path:"*",name:"NotFound",component:()=>t.e(220).then(t.bind(t,8220)),meta:{requiresAuth:!1}}],ve=new P.Ay({mode:"hash",base:"/ComprarBem/",routes:pe});ve.beforeEach((async(a,o,t)=>{const e=a.matched.some((a=>a.meta.requiresAuth));if(e)try{const{data:o}=await N.ND.auth.getSession(),i=o?.session?.user;if(e&&!i)return void t("/");const r=a.meta.requiredProfiles,n=a.meta.moduloRequired;if(r||n)try{const o=await Fa.A.obterPerfilUsuarioAtual();if(!o)return console.warn("UsuÃ¡rio sem perfil definido"),void t("/acesso-negado");if("ccl"===o.perfil_usuario&&"/ccl"!==a.path)return console.log("UsuÃ¡rio CCL redirecionado para painel exclusivo"),void t("/ccl");if(("orgao_administrativo"===o.perfil_usuario||"assessoria_juridica"===o.perfil_usuario)&&"/dashboard"===a.path)return console.log(`UsuÃ¡rio ${o.perfil_usuario} redirecionado para processos administrativos`),void t("/processos-administrativos");if(r&&!r.includes(o.perfil_usuario))return console.warn(`Acesso negado: perfil ${o.perfil_usuario} nÃ£o permitido para rota ${a.path}`),void t("/acesso-negado");if(n){const a=await Fa.A.verificarAcessoModulo(n);if(!a)return console.warn(`Acesso negado: usuÃ¡rio nÃ£o tem acesso ao mÃ³dulo ${n}`),void t("/acesso-negado")}t()}catch(s){return console.error("Erro ao verificar permissÃµes:",s),void t("/acesso-negado")}else t()}catch(s){console.error("Erro na verificaÃ§Ã£o de autenticaÃ§Ã£o:",s),e?t("/"):t()}else t()}));const ge=ve;var _e=t(3518);e.Ay.use(_e.Ay);const he=new _e.Ay.Store({state:{user:null,tenant:null,isLoading:!1},mutations:{SET_USER(a,o){a.user=o},SET_TENANT(a,o){a.tenant=o},SET_LOADING(a,o){a.isLoading=o}},actions:{async fetchUser({commit:a}){const{data:o}=await N.ND.auth.getSession(),t=o?.session?.user;if(a("SET_USER",t),t){const{data:o,error:e}=await N.ND.from("tenants").select("*").eq("id",t.user_metadata?.tenant_id).single();!e&&o&&a("SET_TENANT",o)}},setLoading({commit:a},o){a("SET_LOADING",o)}},getters:{isAuthenticated:a=>!!a.user,currentUser:a=>a.user,currentTenant:a=>a.tenant,isLoading:a=>a.isLoading}});var fe=t(5329),Ce=t(5170),be=t.n(Ce);e.Ay.config.productionTip=!1,e.Ay.use(fe.A),e.Ay.use(be()),new e.Ay({router:ge,store:he,render:a=>a(x),mounted(){console.log("ğŸš€ Sistema Comprar Bem carregado - NotificaÃ§Ãµes automÃ¡ticas via GitHub Actions")}}).$mount("#app")},6507:(a,o,t)=>{t.r(o),t.d(o,{ProcessosAdministrativosService:()=>r,default:()=>n});var e=t(452),s=t(3112),i=t(2045);class r{static async listarProcessos(a={}){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");let t=e.ND.from("vw_processos_resumo").select("*").eq("tenant_id",o).order("data_autuacao",{ascending:!1});a.tipo_processo&&(t=t.eq("tipo_processo",a.tipo_processo)),a.status&&(t=t.eq("status",a.status)),a.busca&&(t=t.or(`numero_processo.ilike.%${a.busca}%,objeto.ilike.%${a.busca}%`));const{data:s,error:i}=await t;if(i)throw console.error("Erro ao listar processos:",i),i;return s||[]}catch(o){throw console.error("Erro no serviÃ§o de processos:",o),o}}static async obterProcesso(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("processos_administrativos").select("\n          *,\n          documentos:documentos_processo(*),\n          produtos:produtos_prequalificacao(*),\n          recursos:recursos_processo(*),\n          dfd:dfd_processo(*),\n          tramitacao:tramitacao_processo(*)\n        ").eq("id",a).eq("tenant_id",o).single();if(s)throw console.error("Erro ao obter processo:",s),s;return t&&(t.total_documentos=t.documentos?.length||0,t.total_produtos=t.produtos?.length||0,console.log(`Processo ${a} carregado:`,{total_documentos:t.total_documentos,total_produtos:t.total_produtos,documentos:t.documentos?.map((a=>({id:a.id,titulo:a.titulo||a.nome_documento,numero_folha:a.numero_folha}))),produtos:t.produtos?.map((a=>({id:a.id,nome:a.nome})))})),t}catch(o){throw console.error("Erro no serviÃ§o de processos:",o),o}}static async criarProcesso(a){try{const o=await(0,e.EO)(),{data:t}=await e.ND.auth.getSession(),s=t?.session?.user;if(!o||!s)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");let i;i="padronizacao"===a.tipo_processo?"CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.":"DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS.";const r={...a,objeto:i,tenant_id:o,criado_por:s.id,atualizado_por:s.id,status:"rascunho"},{data:n,error:c}=await e.ND.from("processos_administrativos").insert(r).select().single();if(c)throw console.error("Erro ao criar processo:",c),c;return await this.criarFolhaRosto(n.id,{numeroProcesso:n.numero_processo,tipoProcesso:n.tipo_processo,dadosOrgao:{nome:a.nome_orgao||"PREFEITURA MUNICIPAL",departamento:"DEPARTAMENTO DE COMPRAS E LICITAÃ‡Ã•ES"}}),n}catch(o){throw console.error("Erro no serviÃ§o de processos:",o),o}}static async atualizarProcesso(a,o){try{const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),i=s?.session?.user;if(!t||!i)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:r,error:n}=await e.ND.from("processos_administrativos").select("id, tenant_id, status").eq("id",a);if(console.log("ğŸ” Debug - Verificando processo existente:",{id:a,tenantId:t,processoExistente:r,errorVerificacao:n}),n)throw new Error(`Erro ao verificar processo: ${n.message}`);if(!r||0===r.length)throw new Error(`Processo com ID ${a} nÃ£o encontrado`);if(r.length>1)throw new Error(`MÃºltiplos processos encontrados com ID ${a}`);const c=r[0];if(c.tenant_id!==t)throw new Error(`Processo nÃ£o pertence ao tenant atual. Esperado: ${t}, Encontrado: ${c.tenant_id}`);const{data:l,error:d}=await e.ND.from("processos_administrativos").update({...o,atualizado_por:i.id,atualizado_em:(new Date).toISOString()}).eq("id",a).eq("tenant_id",t).select().single();if(d)throw console.error("Erro ao atualizar processo:",d),d;return l}catch(t){throw console.error("Erro no serviÃ§o de processos:",t),t}}static async vincularEditalProcesso(a,o){try{const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),i=s?.session?.user;if(!t||!i)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");let r=o.arquivo_url||null;if(o.arquivo&&!r){const t=o.arquivo,s=`edital_${a}_${Date.now()}.pdf`,{data:i,error:n}=await e.ND.storage.from("processos-documentos").upload(s,t,{cacheControl:"3600",upsert:!1});if(n)throw new Error(`Erro ao fazer upload do edital: ${n.message}`);const{data:c}=e.ND.storage.from("processos-documentos").getPublicUrl(i.path);r=c.publicUrl}const{data:n,error:c}=await e.ND.from("processos_administrativos").update({numero_edital:o.numero_edital,ano_edital:o.ano_edital,edital_id:o.edital_id,edital_pdf_url:r,edital_vinculado:!0,data_vinculacao_edital:(new Date).toISOString(),atualizado_por:i.id,atualizado_em:(new Date).toISOString()}).eq("id",a).eq("tenant_id",t).select().single();if(c)throw console.error("Erro ao vincular edital:",c),c;const l=await this.obterProximoNumeroFolha(a),d={processo_id:a,tipo_documento:"EDITAL",nome_documento:`Edital de PrÃ©-QualificaÃ§Ã£o nÂº ${o.numero_edital}`,titulo:`Edital de PrÃ©-QualificaÃ§Ã£o nÂº ${o.numero_edital}`,descricao:o.descricao||"Edital de Chamamento PÃºblico anexado ao processo",conteudo_html:this.gerarHTMLEdital(o),numero_sequencial:l,numero_folha:l,arquivo_url:r};return await this.criarDocumento(d),n}catch(t){throw console.error("Erro ao vincular edital ao processo:",t),t}}static async obterDocumentacaoProdutos(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("produtos_prequalificacao").select("\n          *,\n          produto_info:produtos!inner (\n            nome,\n            marca,\n            modelo,\n            fabricante,\n            registro_anvisa,\n            registro_inmetro,\n            cbpf,\n            norma_abnt,\n            norma_regulamentadora,\n            origem,\n            codigo_material,\n            descricao\n          ),\n          documentos_produto:arquivos_produto (\n            id,\n            nome_arquivo,\n            tipo_arquivo,\n            tamanho,\n            url_arquivo,\n            data_upload\n          )\n        ").eq("processo_id",a).eq("tenant_id",o);if(s)throw console.error("Erro ao obter documentaÃ§Ã£o dos produtos:",s),s;const i=t.map((a=>({produto_id:a.produto_id,nome_produto:a.produto_info.nome,marca:a.produto_info.marca,modelo:a.produto_info.modelo,fabricante:a.produto_info.fabricante,documentacao_tecnica:{numero_anvisa:a.produto_info.registro_anvisa,certificado_inmetro:a.produto_info.registro_inmetro,cbpf:a.produto_info.cbpf,norma_abnt:a.produto_info.norma_abnt,norma_regulamentadora:a.produto_info.norma_regulamentadora,origem:a.produto_info.origem,codigo_material:a.produto_info.codigo_material,especificacao_detalhada:a.produto_info.descricao},documentos_anexados:a.documentos_produto||[],checklist_documentacao:this.gerarChecklistDocumentacao(a.produto_info)})));return i}catch(o){throw console.error("Erro ao obter documentaÃ§Ã£o dos produtos:",o),o}}static gerarChecklistDocumentacao(a){const o=[];return o.push({documento:"EspecificaÃ§Ã£o tÃ©cnica completa",obrigatÃ³rio:!0,presente:!!a.descricao,valor:a.descricao}),a.registro_anvisa&&o.push({documento:"Certificado de Registro ANVISA/MS",obrigatÃ³rio:!0,presente:!0,valor:a.registro_anvisa}),a.registro_inmetro&&o.push({documento:"CertificaÃ§Ã£o/Registro INMETRO",obrigatÃ³rio:!0,presente:!0,valor:a.registro_inmetro}),a.cbpf&&o.push({documento:"Certificado de Boas PrÃ¡ticas de FabricaÃ§Ã£o",obrigatÃ³rio:!0,presente:!0,valor:a.cbpf}),a.norma_abnt&&o.push({documento:"Norma ABNT aplicÃ¡vel",obrigatÃ³rio:!0,presente:!0,valor:a.norma_abnt}),a.norma_regulamentadora&&o.push({documento:"Norma Regulamentadora",obrigatÃ³rio:!0,presente:!0,valor:a.norma_regulamentadora}),o.push({documento:"Manual tÃ©cnico em portuguÃªs",obrigatÃ³rio:!1,presente:!1,observacao:"Verificar se foi anexado nos documentos do produto"}),o.push({documento:"InstruÃ§Ãµes de uso",obrigatÃ³rio:!1,presente:!1,observacao:"Conforme RDC 751/2022 quando aplicÃ¡vel"}),o}static gerarHTMLEdital(a){const o=(new Date).toLocaleDateString("pt-BR");return`\n      <div class="documento-edital">\n        <h1>EDITAL DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS</h1>\n        <h2>NÂº ${a.numero_edital}</h2>\n        \n        <div class="secao">\n          <h3>IDENTIFICAÃ‡ÃƒO</h3>\n          <p><strong>NÃºmero do Edital:</strong> ${a.numero_edital}</p>\n          <p><strong>Data de VinculaÃ§Ã£o ao Processo:</strong> ${o}</p>\n          ${a.data_publicacao?`<p><strong>Data de PublicaÃ§Ã£o:</strong> ${new Date(a.data_publicacao).toLocaleDateString("pt-BR")}</p>`:""}\n        </div>\n\n        ${a.objeto?`\n        <div class="secao">\n          <h3>OBJETO</h3>\n          <p>${a.objeto}</p>\n        </div>\n        `:""}\n\n        <div class="secao">\n          <h3>DOCUMENTO ANEXADO</h3>\n          <p>O edital completo com todos os anexos obrigatÃ³rios estÃ¡ disponÃ­vel em formato PDF.</p>\n          ${a.arquivo_url?`<p><strong>Link do Arquivo:</strong> <a href="${a.arquivo_url}" target="_blank" style="color: #1976d2; text-decoration: underline;">${a.arquivo_url}</a></p>`:""}\n          ${a.observacoes?`<p><strong>ObservaÃ§Ãµes:</strong> ${a.observacoes}</p>`:""}\n        </div>\n\n        <div class="assinatura">\n          <p>Data: ${o}</p>\n          <br>\n          <p>_________________________________________</p>\n          <p>ResponsÃ¡vel pela vinculaÃ§Ã£o do edital</p>\n        </div>\n      </div>\n    `}static async listarDocumentosProcesso(a){try{const t=await(0,e.EO)();if(!t)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:s,error:i}=await e.ND.from("documentos_processo").select("*").eq("processo_id",a).eq("tenant_id",t).order("numero_folha",{ascending:!0});if(i)throw console.error("Erro ao listar documentos:",i),i;console.log(`ğŸ“‹ Encontrados ${s?.length||0} documentos para o processo ${a}`);try{const{data:o,error:i}=await e.ND.from("documentos_complementares_processo").select("*").eq("processo_id",a).eq("tenant_id",t);if(!i&&o?.length>0){console.log(`ğŸ“ Encontrados ${o.length} documentos complementares`);const a=o.map((a=>({...a,tipo_documento:"DOCUMENTO_COMPLEMENTAR",nome_documento:a.nome_documento||a.nome_arquivo||"Documento Complementar",titulo:a.titulo||a.nome_documento||a.nome_arquivo||"Documento Complementar",descricao:a.descricao||"Documento complementar adicionado ao processo"})));s.push(...a)}}catch(o){console.log("Tabela de documentos complementares nÃ£o encontrada ou vazia")}return console.log(`ğŸ“„ Total de documentos encontrados: ${s?.length||0}`),s||[]}catch(t){throw console.error("Erro no serviÃ§o de documentos:",t),t}}static async criarDocumento(a){try{const o=await(0,e.EO)(),{data:t}=await e.ND.auth.getSession(),s=t?.session?.user;if(!o||!s)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");let i=a.numero_folha;i||(i=await this.obterProximoNumeroFolha(a.processo_id));const r={...a,numero_folha:i,tenant_id:o,criado_por:s.id},{data:n,error:c}=await e.ND.from("documentos_processo").insert(r).select().single();if(c)throw console.error("Erro ao criar documento:",c),c;return n}catch(o){throw console.error("Erro no serviÃ§o de documentos:",o),o}}static async obterProximoNumeroFolha(a){try{const{data:o,error:t}=await e.ND.from("documentos_processo").select("numero_folha").eq("processo_id",a).order("numero_folha",{ascending:!1}).limit(1).single();if(t&&"PGRST116"!==t.code)return console.error("Erro ao buscar Ãºltimo nÃºmero de folha:",t),1;const s=o?.numero_folha||0;return s+1}catch(o){return console.error("Erro ao obter prÃ³ximo nÃºmero de folha:",o),1}}static formatarNumeroFolha(a){return`Fl. ${a.toString().padStart(3,"0")}`}static async criarFolhaRosto(a){try{const o=await this.obterProcesso(a),t={processo_id:a,tipo_documento:"folha_rosto",titulo:"Folha de Rosto",descricao:"Folha de rosto do processo administrativo",conteudo_html:this.gerarHTMLFolhaRosto(o),numero_folha:1};return await this.criarDocumento(t)}catch(o){throw console.error("Erro ao criar folha de rosto:",o),o}}static gerarHTMLFolhaRosto(a){const o=(new Date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),t="CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.",e="DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS.";return`\n      <div class="folha-rosto" style="width: 21cm; min-height: 29.7cm; margin: 0 auto; padding: 2cm; background: white; font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.6;">\n        \n        \x3c!-- Formato EXATO conforme INSTRUÃ‡ÃƒO PROCESSUAL (1).pdf --\x3e\n        <div style="text-align: center; margin-bottom: 3cm;">\n          <div style="border: 2px solid #000; padding: 1.5cm;">\n            \n            <div style="font-weight: bold; font-size: 14pt; margin-bottom: 1cm;">\n              PROCESSO ADMINISTRATIVO NÂº ${a.numero_processo||"[nÃºmero/ano]"}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>NOME DO Ã“RGÃƒO:</strong> ${a.nome_orgao}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>INTERESSADO(A):</strong> ${a.unidade_interessada}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>DATA DE AUTUAÃ‡ÃƒO:</strong> ${o}\n            </div>\n            \n            <div style="text-align: left;">\n              <strong>OBJETO:</strong> ${"padronizacao"===a.tipo_processo?t:e}\n            </div>\n            \n          </div>\n        </div>\n\n        \x3c!-- EspaÃ§o para carimbo/assinatura --\x3e\n        <div style="margin-top: 4cm; text-align: center; font-size: 10pt; color: #666;">\n          <p>Fl. 001</p>\n        </div>\n        \n      </div>\n    `}static async criarDFD(a,o){try{console.log("ğŸ” DEBUG criarDFD - processoId recebido:",a),console.log("ğŸ” DEBUG criarDFD - dadosDFD:",o);const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),r=s?.session?.user;if(!t||!r)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:n,error:c}=await e.ND.from("processos_administrativos").select("id, numero_processo").eq("id",a).eq("tenant_id",t).single();if(console.log("ğŸ” DEBUG criarDFD - processo existente:",n),console.log("ğŸ” DEBUG criarDFD - erro ao buscar processo:",c),c||!n)throw new Error(`Processo ${a} nÃ£o encontrado ou nÃ£o pertence ao tenant atual`);const l=this.gerarHTMLDFD(o),d=await i["default"].registrarDocumento({processo_id:a,tenant_id:t,tipo_documento:"DFD",nome_documento:`Documento de FormalizaÃ§Ã£o de Demanda - ${o.modelo_usado.toUpperCase()}`,conteudo:o,conteudo_html:l,criado_por:r.id}),u={id:d.id,processo_id:a,documento_id:d.id,...o,tenant_id:t,folha_numero:d.folha_numero},{data:m,error:p}=await e.ND.from("dfd_processo").insert(u).select().single();if(p)throw console.error("Erro ao criar registro DFD:",p),await i["default"].removerDocumento(d.id),p;return console.log(`DFD criado com sucesso: ${d.folha_numero}`),{dfd:m,documento:d,folha_numero:d.folha_numero}}catch(t){throw console.error("Erro no serviÃ§o de DFD:",t),t}}static gerarHTMLDFD(a){return`\n      <div class="documento-dfd">\n        <h1>DOCUMENTO DE FORMALIZAÃ‡ÃƒO DE DEMANDA - ${a.modelo_usado?.toUpperCase()||"MODELO PADRÃƒO"}</h1>\n        \n        ${a.nome_presidente?`\n        <div class="secao">\n          <h2>DADOS DO DEMANDANTE</h2>\n          <p><strong>Nome do Presidente da CPPM:</strong> ${a.nome_presidente}</p>\n          ${a.matricula_presidente?`<p><strong>MatrÃ­cula:</strong> ${a.matricula_presidente}</p>`:""}\n          ${a.email_presidente?`<p><strong>E-mail:</strong> ${a.email_presidente}</p>`:""}\n          ${a.telefone_presidente?`<p><strong>Telefone:</strong> ${a.telefone_presidente}</p>`:""}\n        </div>\n        `:""}\n        \n        <div class="secao">\n          <h2>JUSTIFICATIVA</h2>\n          <p>${a.justificativa}</p>\n        </div>\n\n        <div class="secao">\n          <h2>DESCRIÃ‡ÃƒO DA NECESSIDADE</h2>\n          <p>${a.necessidade_descricao}</p>\n        </div>\n\n        ${a.produtos_especificacao?`\n        <div class="secao">\n          <h2>PRODUTOS A SEREM PRÃ‰-QUALIFICADOS</h2>\n          <p><strong>EspecificaÃ§Ã£o dos Produtos/ServiÃ§os:</strong> ${a.produtos_especificacao}</p>\n        </div>\n        `:""}\n\n        ${a.quantidade_amostras||a.previsao_aquisicoes?`\n        <div class="secao">\n          <h2>QUANTIDADES E AMOSTRAGEM</h2>\n          ${a.quantidade_amostras?`<p><strong>Quantidade de Amostras para AnÃ¡lise:</strong> ${a.quantidade_amostras}</p>`:""}\n          ${a.previsao_aquisicoes?`<p><strong>AquisiÃ§Ãµes Previstas (12 meses):</strong> ${a.previsao_aquisicoes}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.especificacoes_tecnicas?`\n        <div class="secao">\n          <h2>ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS DETALHADAS</h2>\n          <p><strong>EspecificaÃ§Ãµes TÃ©cnicas ObrigatÃ³rias:</strong> ${a.especificacoes_tecnicas}</p>\n        </div>\n        `:""}\n\n        ${a.ensaios_exigidos||a.criterios_aceitacao?`\n        <div class="secao">\n          <h2>CRITÃ‰RIOS DE ACEITAÃ‡ÃƒO E ENSAIOS</h2>\n          ${a.criterios_aceitacao?`<p><strong>CritÃ©rios de AceitaÃ§Ã£o:</strong> ${a.criterios_aceitacao}</p>`:""}\n          ${a.ensaios_exigidos?`<p><strong>Ensaios e Testes Exigidos:</strong> ${a.ensaios_exigidos}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.quantidade_estimada?`\n        <div class="secao">\n          <h2>QUANTIDADE ESTIMADA</h2>\n          <p>${a.quantidade_estimada}</p>\n        </div>\n        `:""}\n\n        ${a.prazo_entrega?`\n        <div class="secao">\n          <h2>PRAZO DE ENTREGA</h2>\n          <p>${a.prazo_entrega}</p>\n        </div>\n        `:""}\n\n        ${a.local_entrega_amostras||a.prazo_entrega_amostras?`\n        <div class="secao">\n          <h2>CONDIÃ‡Ã•ES DE ENTREGA</h2>\n          ${a.local_entrega_amostras?`<p><strong>Local de Entrega das Amostras:</strong> ${a.local_entrega_amostras}</p>`:""}\n          ${a.prazo_entrega_amostras?`<p><strong>Prazo para Entrega das Amostras:</strong> ${a.prazo_entrega_amostras} dias</p>`:""}\n        </div>\n        `:""}\n\n        ${a.produtos_despadronizar?`\n        <div class="secao">\n          <h2>PRODUTOS A SEREM DESPADRONIZADOS</h2>\n          <p><strong>IdentificaÃ§Ã£o dos Produtos/ServiÃ§os:</strong> ${a.produtos_despadronizar}</p>\n        </div>\n        `:""}\n\n        ${a.fonte_rdm||a.fonte_reclamacoes_usuarios||a.fonte_sistema_comprar_bem||a.fonte_analise_tecnica||a.outras_fontes?`\n        <div class="secao">\n          <h2>FONTE DAS INFORMAÃ‡Ã•ES</h2>\n          <p><strong>Origem das ReclamaÃ§Ãµes/Problemas:</strong></p>\n          <ul>\n            ${a.fonte_rdm?"<li>âœ… RelatÃ³rios RDM (RelatÃ³rio de Desempenho de Material)</li>":""}\n            ${a.fonte_reclamacoes_usuarios?"<li>âœ… ReclamaÃ§Ãµes de usuÃ¡rios finais</li>":""}\n            ${a.fonte_sistema_comprar_bem?'<li>âœ… Sistema "Reclame Aqui" do Comprar Bem</li>':""}\n            ${a.fonte_analise_tecnica?"<li>âœ… AnÃ¡lise tÃ©cnica da CPPM</li>":""}\n            ${a.fonte_outras?"<li>âœ… Outros</li>":""}\n          </ul>\n          ${a.outras_fontes?`<p><strong>Outras Fontes:</strong> ${a.outras_fontes}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.descricao_problemas?`\n        <div class="secao">\n          <h2>MOTIVAÃ‡Ã•ES PARA DESPADRONIZAÃ‡ÃƒO</h2>\n          <p><strong>Principais Problemas Identificados:</strong> ${a.descricao_problemas}</p>\n          ${a.frequencia_problemas?`<p><strong>FrequÃªncia dos Problemas:</strong> ${a.frequencia_problemas}</p>`:""}\n          ${a.impacto_problemas?`<p><strong>Impacto dos Problemas:</strong> ${a.impacto_problemas}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.quantidade_adquirida||a.prejuizo_estimado||a.rdms_negativos?`\n        <div class="secao">\n          <h2>DADOS QUANTITATIVOS</h2>\n          ${a.quantidade_adquirida?`<p><strong>Quantidade Adquirida (Ãºltimos 12 meses):</strong> ${a.quantidade_adquirida}</p>`:""}\n          ${a.prejuizo_estimado?`<p><strong>PrejuÃ­zo Estimado:</strong> R$ ${a.prejuizo_estimado}</p>`:""}\n          ${a.rdms_negativos?`<p><strong>NÃºmero de RDMs Negativos:</strong> ${a.rdms_negativos}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.parecer_tecnico||a.alternativas_avaliadas?`\n        <div class="secao">\n          <h2>ANÃLISE TÃ‰CNICA</h2>\n          ${a.parecer_tecnico?`<p><strong>Parecer TÃ©cnico da CPPM:</strong> ${a.parecer_tecnico}</p>`:""}\n          ${a.alternativas_avaliadas?`<p><strong>Alternativas Avaliadas:</strong> ${a.alternativas_avaliadas}</p>`:""}\n        </div>\n        `:""}\n\n        ${a.local_entrega?`\n        <div class="secao">\n          <h2>LOCAL DE ENTREGA</h2>\n          <p>${a.local_entrega}</p>\n        </div>\n        `:""}\n\n        ${a.criterios_aceitacao?`\n        <div class="secao">\n          <h2>CRITÃ‰RIOS DE ACEITAÃ‡ÃƒO</h2>\n          <p>${a.criterios_aceitacao}</p>\n        </div>\n        `:""}\n\n        ${a.base_legal?`\n        <div class="secao">\n          <h2>BASE LEGAL</h2>\n          <p>${a.base_legal}</p>\n        </div>\n        `:""}\n\n        ${a.impacto_esperado?`\n        <div class="secao">\n          <h2>IMPACTO ESPERADO</h2>\n          <p>${a.impacto_esperado}</p>\n        </div>\n        `:""}\n\n        ${a.riscos_identificados?`\n        <div class="secao">\n          <h2>RISCOS IDENTIFICADOS</h2>\n          <p>${a.riscos_identificados}</p>\n        </div>\n        `:""}\n\n        ${a.medidas_mitigadoras?`\n        <div class="secao">\n          <h2>MEDIDAS MITIGADORAS</h2>\n          <p>${a.medidas_mitigadoras}</p>\n        </div>\n        `:""}\n\n        ${a.prazo_vigencia?`\n        <div class="secao">\n          <h2>PRAZO DE VIGÃŠNCIA</h2>\n          <p>${a.prazo_vigencia} meses</p>\n        </div>\n        `:""}\n\n        ${a.periodicidade_revisao?`\n        <div class="secao">\n          <h2>PERIODICIDADE DE REVISÃƒO</h2>\n          <p>${a.periodicidade_revisao}</p>\n        </div>\n        `:""}\n\n        ${a.fonte_reclamacoes?`\n        <div class="secao">\n          <h2>FONTE DAS RECLAMAÃ‡Ã•ES</h2>\n          <p>${a.fonte_reclamacoes}</p>\n        </div>\n        `:""}\n\n        ${a.descricao_problemas?`\n        <div class="secao">\n          <h2>PROBLEMAS IDENTIFICADOS</h2>\n          <p>${a.descricao_problemas}</p>\n        </div>\n        `:""}\n\n        ${a.observacoes_especiais?`\n        <div class="secao">\n          <h2>OBSERVAÃ‡Ã•ES ESPECIAIS</h2>\n          <p>${a.observacoes_especiais}</p>\n        </div>\n        `:""}\n\n        <div class="assinatura">\n          <p>Data: ${(new Date).toLocaleDateString("pt-BR")}</p>\n          <br>\n          <p>_________________________________________</p>\n          <p>Presidente da CPPM</p>\n        </div>\n      </div>\n    `}static async adicionarProduto(a,o,t=!1){try{const s=await(0,e.EO)();if(!s)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");if(o.id){const{data:i,error:r}=await e.ND.from("produtos_prequalificacao").select("id, processo_id").eq("id",o.id).eq("tenant_id",s).single();if(i&&!r&&i.processo_id===a)return console.log("âœ… Produto jÃ¡ existe no mesmo processo, retornando o existente"),i;if(i&&!r&&i.processo_id!==a&&!t){const a=new Error("Este produto jÃ¡ foi usado em um processo de prÃ©-qualificaÃ§Ã£o. Deseja reutilizÃ¡-lo mesmo assim?");throw a.code="PRODUTO_JA_USADO",a.produtoId=o.id,a}}const i={processo_id:a,...o,tenant_id:s},{data:r,error:n}=await e.ND.from("produtos_prequalificacao").insert(i).select().single();if(n){if(console.error("Erro ao adicionar produto:",n),"23505"===n.code){const a=new Error("Este produto jÃ¡ foi usado em um processo de prÃ©-qualificaÃ§Ã£o. Deseja reutilizÃ¡-lo mesmo assim?");throw a.code="PRODUTO_JA_USADO",a.produtoId=o.id,a}throw n}return console.log("âœ… Produto salvo com sucesso:",r.nome_produto),await this.vincularDocumentosProdutoProcesso(a,r),r}catch(s){throw console.error("Erro no serviÃ§o de produtos:",s),s}}static async vincularDocumentosProdutoProcesso(a,o){try{const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),i=s?.session?.user;if(!t||!i)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");console.log(`ğŸ“ Vinculando documentos do produto ${o.nome_produto} ao processo`),console.log("ğŸ” INVESTIGAÃ‡ÃƒO - Buscando documentos em arquivos_produto");const{data:r,error:n}=await e.ND.from("arquivos_produto").select("*").eq("produto_id",o.id);console.log("ğŸ“‹ RESULTADO arquivos_produto:",{documentosArquivos:r,errorArquivos:n}),console.log("ğŸ” INVESTIGAÃ‡ÃƒO - Buscando documentos na estrutura do produto");const{data:c,error:l}=await e.ND.from("produtos").select("*, documentos:arquivos_produto(*)").eq("id",o.id).single();console.log("ğŸ“‹ RESULTADO produto completo:",{produtoCompleto:c,errorProduto:l}),console.log("ğŸ” INVESTIGAÃ‡ÃƒO 3 - Verificando campo documentos no produto salvo:",o.documentos);let d=[];o.documentos&&Array.isArray(o.documentos)&&(console.log('ğŸ‰ SUCESSO! Documentos encontrados no campo "documentos" do produto salvo!'),d=o.documentos),console.log("ğŸ“‹ Documentos candidatos encontrados:",d);let u=null;if(d.length>0?(console.log('ğŸ‰ USANDO documentos do campo "documentos" (JSON no produto)!'),u=d):r&&r.length>0?(console.log("ğŸ“‹ USANDO documentos da tabela arquivos_produto"),u=r):c?.documentos&&c.documentos.length>0&&(console.log("ğŸ“‹ USANDO documentos da relaÃ§Ã£o produto->arquivos_produto"),u=c.documentos),n)return void console.warn("âš ï¸ Erro ao buscar documentos do produto:",n);if(!u||0===u.length)return void console.log("â„¹ï¸ Produto nÃ£o possui documentos para vincular em nenhuma tabela investigada");console.log(`ğŸ“‹ Encontrados ${u.length} documentos do produto`);const m=u.map((e=>({processo_id:a,produto_id:o.id,tenant_id:t,nome_arquivo:e.nome_arquivo||e.nome,tipo_arquivo:e.tipo_arquivo||e.tipo,tamanho:e.tamanho||null,url_arquivo:e.url_arquivo||e.arquivo_url,nome_produto:o.nome_produto,marca:o.marca,fabricante:o.fabricante,criado_por:i.id})));console.log("ğŸ“‹ DEBUG - Documentos mapeados para salvar:",m);const{data:p,error:v}=await e.ND.from("documentos_produtos_processo").upsert(m,{onConflict:"processo_id,produto_id,nome_arquivo,tenant_id"}).select();if(v)throw console.error("âŒ Erro ao salvar documentos do produto no processo:",v),v;console.log(`âœ… ${p?.length||m.length} documentos vinculados ao processo com sucesso`)}catch(t){console.error("Erro ao vincular documentos do produto ao processo:",t)}}static async listarProdutosProcesso(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("produtos_prequalificacao").select("*").eq("processo_id",a).eq("tenant_id",o);if(s)throw console.error("Erro ao listar produtos:",s),s;return t||[]}catch(o){throw console.error("Erro no serviÃ§o de produtos:",o),o}}static async assinarDocumento(a,o){try{const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),i=s?.session?.user;if(!t||!i)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const r={documento_id:a,usuario_id:i.id,nome_completo:o.nome_completo,cargo:o.cargo,tipo_assinatura:o.tipo_assinatura||"eletronica",hash_documento:o.hash_documento,ip_assinatura:o.ip_assinatura,observacoes:o.observacoes,tenant_id:t},{data:n,error:c}=await e.ND.from("assinaturas_processo").insert(r).select().single();if(c)throw console.error("Erro ao criar assinatura:",c),c;const{data:l,error:d}=await e.ND.from("documentos_processo").update({assinado:!0,data_assinatura:(new Date).toISOString(),assinado_por:i.id,cargo_assinante:o.cargo}).eq("id",a).eq("tenant_id",t).select().single();if(d)throw console.error("Erro ao atualizar documento:",d),d;return{assinatura:n,documento:l}}catch(t){throw console.error("Erro no serviÃ§o de assinatura:",t),t}}static async obterTramitacao(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("tramitacao_processo").select("\n          *,\n          responsavel_info:responsavel(*)\n        ").eq("processo_id",a).eq("tenant_id",o).order("data_tramitacao",{ascending:!1});if(s)throw console.error("Erro ao obter tramitaÃ§Ã£o:",s),s;return t||[]}catch(o){throw console.error("Erro no serviÃ§o de tramitaÃ§Ã£o:",o),o}}static async criarRecurso(a,o){try{const t=await(0,e.EO)();if(!t)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const s={processo_id:a,...o,tenant_id:t},{data:i,error:r}=await e.ND.from("recursos_processo").insert(s).select().single();if(r)throw console.error("Erro ao criar recurso:",r),r;return i}catch(t){throw console.error("Erro no serviÃ§o de recursos:",t),t}}static async listarRecursosProcesso(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("recursos_processo").select("*").eq("processo_id",a).eq("tenant_id",o).order("data_interposicao",{ascending:!1});if(s)throw console.error("Erro ao listar recursos:",s),s;return t||[]}catch(o){throw console.error("Erro no serviÃ§o de recursos:",o),o}}static async obterPerfilUsuario(){try{const{data:a}=await e.ND.auth.getSession(),o=a?.session?.user;if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado");const{data:t}=await e.ND.from("usuarios").select("perfil_usuario").eq("id",o.id).single();return t?.perfil_usuario||null}catch(a){return console.error("Erro ao obter perfil do usuÃ¡rio:",a),null}}static async verificarPermissaoTransicao(a,o){try{const t=await this.obterPerfilUsuario(),e=await this.obterProcesso(a);if(!t||!e)return!1;const s=e.status,i={cpm:{rascunho:["criado_cpm"],criado_cpm:["aprovado_cpm","rejeitado_cpm"],assinado_admin:["julgamento_ccl"],rejeitado_admin:["aprovado_cpm","rejeitado_cpm"],rejeitado_juridico:["aprovado_cpm","rejeitado_cpm"],rejeitado_ccl:["aprovado_cpm","rejeitado_cpm"]},ccl:{julgamento_ccl:["aprovado_ccl","rejeitado_ccl"]},orgao_administrativo:{aprovado_cpm:["assinado_admin","rejeitado_admin"],aprovado_ccl:["homologado","rejeitado_final"],aprovado_juridico:["homologado","rejeitado_final"]},assessoria_juridica:{assinado_admin:["aprovado_juridico","rejeitado_juridico"]}},r=i[t]?.[s]||[];return r.includes(o)}catch(t){return console.error("Erro ao verificar permissÃ£o de transiÃ§Ã£o:",t),!1}}static async tramitarProcesso(a,o,t=""){try{const r=await this.verificarPermissaoTransicao(a,o);if(!r)throw new Error("UsuÃ¡rio nÃ£o tem permissÃ£o para realizar esta transiÃ§Ã£o");const n=await(0,e.EO)(),{data:c}=await e.ND.auth.getSession(),l=c?.session?.user,d=await this.obterPerfilUsuario(),u=await this.obterProcesso(a),m=u.status,{data:p,error:v}=await e.ND.from("processos_administrativos").update({status:o,atualizado_por:l.id,atualizado_em:(new Date).toISOString()}).eq("id",a).eq("tenant_id",n).select().single();if(v)throw v;const g={processo_id:a,status_anterior:m,status_novo:o,responsavel:l.id,perfil_responsavel:d,observacoes:t,data_tramitacao:(new Date).toISOString(),tenant_id:n},{data:_,error:h}=await e.ND.from("tramitacao_processo").insert(g).select().single();h&&console.warn("Erro ao registrar tramitaÃ§Ã£o:",h);try{await s.A.enviarNotificacaoTramitacao(a,m,o,t)}catch(i){console.warn("Erro ao enviar notificaÃ§Ã£o por email:",i)}return{processo:p,tramitacao:_}}catch(r){throw console.error("Erro ao tramitar processo:",r),r}}static async submeterParaAnalise(a,o=""){return await this.tramitarProcesso(a,"criado_cpm",o)}static async aprovarCPM(a,o=""){return await this.tramitarProcesso(a,"aprovado_cpm",o)}static async rejeitarCPM(a,o=""){return await this.tramitarProcesso(a,"rejeitado_cpm",o)}static async assinarAdministrativo(a,o=""){return await this.tramitarProcesso(a,"assinado_admin",o)}static async rejeitarAdministrativo(a,o=""){return await this.tramitarProcesso(a,"rejeitado_admin",o)}static async aprovarJuridico(a,o=""){return await this.tramitarProcesso(a,"aprovado_juridico",o)}static async rejeitarJuridico(a,o=""){return await this.tramitarProcesso(a,"rejeitado_juridico",o)}static async homologarProcesso(a,o=""){const t=await this.tramitarProcesso(a,"homologado",o),e=await this.obterProcesso(a);return"padronizacao"===e.tipo_processo&&(await this.incluirProdutosNoCatalogo(a),await this.gerarDCB(a)),t}static async rejeitarFinal(a,o=""){return await this.tramitarProcesso(a,"rejeitado_final",o)}static async enviarParaCCL(a,o=""){const t=await this.obterProcesso(a);if("assinado_admin"!==t.status)throw new Error("Processo deve estar assinado pelo Ã“rgÃ£o Administrativo antes de ser enviado para CCL");return await this.tramitarProcesso(a,"julgamento_ccl",o)}static async aprovarCCL(a,o=""){return await this.tramitarProcesso(a,"aprovado_ccl",o)}static async rejeitarCCL(a,o=""){return await this.tramitarProcesso(a,"rejeitado_ccl",o)}static async incluirProdutosNoCatalogo(a){try{const o=await this.listarProdutosProcesso(a),t=await(0,e.EO)();for(const s of o){const{data:o}=await e.ND.from("produtos").select("id").eq("nome",s.nome_produto).eq("fabricante",s.fabricante).eq("tenant_id",t).single();if(!o){const o={nome:s.nome_produto,fabricante:s.fabricante,categoria:s.categoria,subcategoria:s.subcategoria,especificacoes:s.especificacoes_tecnicas,status:"ativo",pre_qualificado:!0,processo_id:a,tenant_id:t};await e.ND.from("produtos").insert(o)}}}catch(o){console.error("Erro ao incluir produtos no catÃ¡logo:",o)}}static async gerarDCB(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const t=await this.obterProcesso(a),s=await this.listarProdutosProcesso(a);if(0===s.length)return console.warn("Nenhum produto encontrado para gerar DCB"),null;const i=await this.gerarNumeroDCB(o),r=await this.obterProximoNumeroFolha(a),n={processo_id:a,tipo_documento:"dcb",titulo:`DeclaraÃ§Ã£o de Conformidade de Bem - DCB NÂº ${i}`,descricao:"DeclaraÃ§Ã£o de Conformidade de Bem emitida apÃ³s homologaÃ§Ã£o",conteudo_html:this.gerarHTMLDCB(t,s,i),numero_folha:r,numero_dcb:i},c=await this.criarDocumento(n);return await this.registrarDCB({processo_id:a,numero_dcb:i,documento_id:c.id,produtos_incluidos:s.length,data_emissao:(new Date).toISOString(),tenant_id:o}),console.log(`DCB NÂº ${i} gerada automaticamente para processo ${t.numero_processo}`),c}catch(o){throw console.error("Erro ao gerar DCB:",o),o}}static async gerarNumeroDCB(a){try{const o=(new Date).getFullYear(),{data:t,error:s}=await e.ND.from("dcb_emitidas").select("numero_dcb").eq("tenant_id",a).like("numero_dcb",`${o}%`).order("numero_dcb",{ascending:!1}).limit(1).single();let i=1;if(t&&!s){const a=t.numero_dcb.split("/");2===a.length&&(i=parseInt(a[1])+1)}const r=`${o}/${i.toString().padStart(4,"0")}`;return r}catch(o){return console.error("Erro ao gerar nÃºmero DCB:",o),`${(new Date).getFullYear()}/0001`}}static async registrarDCB(a){try{const{data:o,error:t}=await e.ND.from("dcb_emitidas").insert(a).select().single();if(t)throw console.error("Erro ao registrar DCB:",t),t;return o}catch(o){throw console.error("Erro ao registrar DCB:",o),o}}static gerarHTMLDCB(a,o,t){const e=(new Date).toLocaleDateString("pt-BR"),s=(new Date).getFullYear()+2;return`\n      <div class="dcb-documento">\n        <div class="numero-folha" style="text-align: right; margin-bottom: 20px;">\n          <strong>${this.formatarNumeroFolha(a.total_documentos+1)}</strong>\n        </div>\n        \n        <div class="cabecalho-dcb">\n          <h1>DECLARAÃ‡ÃƒO DE CONFORMIDADE DE BEM</h1>\n          <h2>DCB NÂº ${t}</h2>\n          <p><strong>Processo Administrativo:</strong> ${a.numero_processo}</p>\n          <p><strong>Ã“rgÃ£o:</strong> ${a.nome_orgao}</p>\n        </div>\n\n        <div class="secao">\n          <h3>IDENTIFICAÃ‡ÃƒO</h3>\n          <p><strong>Data de EmissÃ£o:</strong> ${e}</p>\n          <p><strong>Validade:</strong> AtÃ© 31/12/${s}</p>\n          <p><strong>Base Legal:</strong> Art. 80, inciso II, da Lei Federal nÂº 14.133/2021</p>\n        </div>\n\n        <div class="secao">\n          <h3>PRODUTOS PRÃ‰-QUALIFICADOS</h3>\n          <p>Os produtos relacionados abaixo foram submetidos ao procedimento de prÃ©-qualificaÃ§Ã£o e atendem aos requisitos mÃ­nimos de qualidade, estÃ©tica, rendimento, durabilidade, adequaÃ§Ã£o ao uso e Ã  finalidade:</p>\n          \n          <table border="1" style="width: 100%; border-collapse: collapse; margin: 20px 0;">\n            <thead>\n              <tr style="background-color: #f0f0f0;">\n                <th style="padding: 8px; text-align: left;">Item</th>\n                <th style="padding: 8px; text-align: left;">Produto</th>\n                <th style="padding: 8px; text-align: left;">Marca/Modelo</th>\n                <th style="padding: 8px; text-align: left;">Categoria</th>\n              </tr>\n            </thead>\n            <tbody>\n              ${o.map(((a,o)=>`\n                <tr>\n                  <td style="padding: 8px;">${o+1}</td>\n                  <td style="padding: 8px;">${a.nome_produto}</td>\n                  <td style="padding: 8px;">${a.marca||"N/A"}${a.modelo?` / ${a.modelo}`:""}</td>\n                  <td style="padding: 8px;">${a.categoria_produto||"N/A"}</td>\n                </tr>\n              `)).join("")}\n            </tbody>\n          </table>\n        </div>\n\n        <div class="secao">\n          <h3>CONDIÃ‡Ã•ES DE VALIDADE</h3>\n          <ul>\n            <li>Esta DCB autoriza a inclusÃ£o dos produtos relacionados no CatÃ¡logo EletrÃ´nico de Bens Padronizados;</li>\n            <li>Os produtos mantÃªm a prÃ©-qualificaÃ§Ã£o enquanto nÃ£o houver alteraÃ§Ã£o nas especificaÃ§Ãµes tÃ©cnicas;</li>\n            <li>A validade pode ser revogada a qualquer tempo mediante justificativa tÃ©cnica;</li>\n            <li>RenovaÃ§Ã£o sujeita a novo procedimento de prÃ©-qualificaÃ§Ã£o conforme cronograma da CPM.</li>\n          </ul>\n        </div>\n\n        <div class="observacoes">\n          <h3>OBSERVAÃ‡Ã•ES</h3>\n          <p>Esta DeclaraÃ§Ã£o de Conformidade foi emitida automaticamente apÃ³s a homologaÃ§Ã£o do processo administrativo de prÃ©-qualificaÃ§Ã£o, em conformidade com os procedimentos estabelecidos na Lei nÂº 14.133/2021.</p>\n        </div>\n\n        <div class="assinatura" style="margin-top: 50px;">\n          <p>Data: ${e}</p>\n          <br>\n          <br>\n          <p>_________________________________________</p>\n          <p><strong>Presidente da ComissÃ£o Permanente de PadronizaÃ§Ã£o de Materiais - CPM</strong></p>\n          <p>${a.nome_orgao}</p>\n        </div>\n      </div>\n    `}static obterAcoesDisponiveis(a,o){const t={rascunho:{cpm:["submeter_analise"]},criado_cpm:{cpm:["aprovar_cpm","rejeitar_cpm"]},aprovado_cpm:{orgao_administrativo:["assinar_admin","rejeitar_admin"]},assinado_admin:{cpm:["enviar_ccl"],assessoria_juridica:["aprovar_juridico","rejeitar_juridico"]},julgamento_ccl:{ccl:["aprovar_ccl","rejeitar_ccl"]},aprovado_ccl:{orgao_administrativo:["homologar","rejeitar_final"]},aprovado_juridico:{orgao_administrativo:["homologar","rejeitar_final"]},rejeitado_cpm:{cpm:["aprovar_cpm"]},rejeitado_admin:{cpm:["aprovar_cpm"]},rejeitado_juridico:{cpm:["aprovar_cpm"]},rejeitado_ccl:{cpm:["aprovar_cpm"]}};return t[a]?.[o]||[]}static async assinarDocumentoPorPerfil(a,o=""){try{const t=await this.obterPerfilUsuario(),{data:s}=await e.ND.auth.getSession(),i=s?.session?.user;if(!t||!i)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem perfil");const{data:r}=await e.ND.from("usuarios").select("nome, perfil_usuario").eq("id",i.id).single(),n={cpm:"Presidente da CPM",orgao_administrativo:"Autoridade Administrativa Competente",assessoria_juridica:"Assessor JurÃ­dico"},c={nome_completo:r.nome,cargo:n[t]||"Servidor PÃºblico",tipo_assinatura:"eletronica",ip_assinatura:"",observacoes:o};return await this.assinarDocumento(a,c)}catch(t){throw console.error("Erro ao assinar documento por perfil:",t),t}}static async getTenantId(){return await(0,e.EO)()}static async obterEstatisticas(){try{const a=await(0,e.EO)();if(!a)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:o,error:t}=await e.ND.from("processos_administrativos").select("status").eq("tenant_id",a);if(t)throw t;const{data:s,error:i}=await e.ND.from("processos_administrativos").select("tipo_processo").eq("tenant_id",a);if(i)throw i;const r=new Date;r.setDate(r.getDate()-30);const{data:n,error:c}=await e.ND.from("processos_administrativos").select("id").eq("tenant_id",a).gte("criado_em",r.toISOString());if(c)throw c;const l={total:o.length,por_status:o.reduce(((a,o)=>(a[o.status]=(a[o.status]||0)+1,a)),{}),por_tipo:s.reduce(((a,o)=>(a[o.tipo_processo]=(a[o.tipo_processo]||0)+1,a)),{}),recentes:n.length};return l}catch(a){throw console.error("Erro ao obter estatÃ­sticas:",a),a}}static formatarNumeroProcesso(a){return a||"Aguardando numeraÃ§Ã£o"}static obterStatusProcesso(a){const o={rascunho:{label:"Em CriaÃ§Ã£o",cor:"gray"},em_criacao:{label:"Em CriaÃ§Ã£o",cor:"gray"},criado_cpm:{label:"Criado pela CPM",cor:"blue"},aguardando_assinatura_orgao:{label:"Aguardando Assinatura",cor:"orange"},aguardando_assinatura_orgao_desp:{label:"Aguardando Assinatura",cor:"orange"},submetido_autoridade:{label:"Submetido Ã  Autoridade Competente",cor:"yellow"},abertura_autorizada:{label:"Abertura Autorizada",cor:"green"},edital_chamamento:{label:"Edital de Chamamento PÃºblico",cor:"purple"},analise_juridica:{label:"Em AnÃ¡lise JurÃ­dica",cor:"orange"},com_impugnacao:{label:"Com ImpugnaÃ§Ã£o ao Edital",cor:"red"},recebendo_amostras:{label:"Recebendo Amostras e DocumentaÃ§Ã£o",cor:"cyan"},avaliacao_cpm:{label:"Com AvaliaÃ§Ã£o e RelatÃ³rio da CPM",cor:"yellow"},submetido_ccl:{label:"Submetido ao Julgamento da CCL",cor:"pink"},ata_julgamento:{label:"Ata de Julgamento da CCL",cor:"purple"},publicacao_ata:{label:"PublicaÃ§Ã£o da Ata e Prazo Recursal",cor:"amber"},com_recurso:{label:"Com Recurso Administrativo",cor:"red"},expedindo_dcbs:{label:"Expedindo as DCBs",cor:"indigo"},incluindo_marcas:{label:"Incluindo Marcas no CatÃ¡logo",cor:"green"},em_criacao_desp:{label:"Em CriaÃ§Ã£o",cor:"gray"},criado_cpm_desp:{label:"Criado pela CPM",cor:"blue"},submetido_autoridade_desp:{label:"Submetido Ã  Autoridade Competente",cor:"yellow"},abertura_autorizada_desp:{label:"Abertura Autorizada",cor:"green"},aviso_publicado:{label:"Com Aviso Publicado",cor:"purple"},com_recurso_desp:{label:"Com Recurso Administrativo",cor:"red"},homologado_desp:{label:"Com HomologaÃ§Ã£o",cor:"green"},excluindo_marcas:{label:"Excluindo Marcas do CatÃ¡logo",cor:"red"},aprovado_cpm:{label:"Aprovado pela CPM",cor:"cyan"},rejeitado_cpm:{label:"Rejeitado pela CPM",cor:"red"},assinado_admin:{label:"Assinado pelo Ã“rgÃ£o",cor:"yellow"},rejeitado_admin:{label:"Rejeitado pelo Ã“rgÃ£o",cor:"red"},julgamento_ccl:{label:"Julgamento CCL",cor:"pink"},aprovado_ccl:{label:"Aprovado pela CCL",cor:"purple"},rejeitado_ccl:{label:"Rejeitado pela CCL",cor:"red"},aprovado_juridico:{label:"Aprovado Juridicamente",cor:"purple"},rejeitado_juridico:{label:"Rejeitado Juridicamente",cor:"red"},homologado:{label:"Com HomologaÃ§Ã£o",cor:"green"},rejeitado_final:{label:"Rejeitado Final",cor:"red"},iniciado:{label:"Iniciado",cor:"blue"},aguardando_aprovacao:{label:"Criado pela CPM",cor:"blue"},analise_cppm:{label:"AnÃ¡lise CPPM",cor:"yellow"},aguardando_edital:{label:"Aguardando Edital",cor:"purple"},edital_publicado:{label:"Com Edital Publicado",cor:"green"},recebendo_propostas:{label:"Recebendo Propostas",cor:"cyan"},analise_tecnica:{label:"AnÃ¡lise TÃ©cnica",cor:"indigo"},prazo_recursal:{label:"Prazo Recursal",cor:"amber"},com_recursos:{label:"Com Recursos",cor:"red"},finalizado:{label:"Finalizado",cor:"green"},cancelado:{label:"Cancelado",cor:"gray"}};return o[a]||{label:a,cor:"gray"}}static obterTipoProcesso(a){const o={padronizacao:{label:"PadronizaÃ§Ã£o",icone:"âœ…"},despadronizacao:{label:"DespadronizaÃ§Ã£o",icone:"âŒ"}};return o[a]||{label:a,icone:"ğŸ“„"}}static async criarFolhaRosto(a,o){try{const t=await(0,e.EO)(),{data:s}=await e.ND.auth.getSession(),r=s?.session?.user;if(!t||!r)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const n=this.gerarHTMLFolhaRosto(o),c=await i["default"].registrarDocumento({processo_id:a,tenant_id:t,tipo_documento:"FOLHA_ROSTO",nome_documento:"Folha de Rosto do Processo Administrativo",conteudo:o,conteudo_html:n,criado_por:r.id});return console.log(`Folha de Rosto criada: ${c.folha_numero}`),c}catch(t){throw console.error("Erro ao criar folha de rosto:",t),t}}static gerarHTMLFolhaRosto(a){const o=(new Date).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),t="CHAMAMENTO PÃšBLICO DESTINADO Ã€ REALIZAÃ‡ÃƒO DO PROCEDIMENTO AUXILIAR DE PRÃ‰-QUALIFICAÃ‡ÃƒO DE BENS PREVISTO NO ART. 80, INCISO II, DA LEI FEDERAL NÂº 14.133/2021, OBJETIVANDO PROMOVER A SELEÃ‡ÃƒO TÃ‰CNICA DE MARCAS E MODELOS DE PRODUTOS QUE POSSUAM OS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE, ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINAM, CONFORME AS CARACTERÃSTICAS E CONDIÃ‡Ã•ES CONSTANTES NO EDITAL E SEUS ANEXOS, PARA SEREM INCLUÃDOS NO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS, COM VISTAS Ã€S AQUISIÃ‡Ã•ES EVENTUAIS E FUTURAS.",e="DESPADRONIZAÃ‡ÃƒO DE MARCA(S) E MODELO(S) DE PRODUTO(S) QUE NÃƒO MAIS ATENDE(M) AOS PADRÃ•ES MÃNIMOS DE QUALIDADE, ESTÃ‰TICA, RENDIMENTO, DURABILIDADE E ADEQUAÃ‡ÃƒO AO USO E Ã€ FINALIDADE A QUE SE DESTINA(M), COM VISTAS Ã€ SUA RETIRADA DO CATÃLOGO ELETRÃ”NICO DE BENS PADRONIZADOS.";return`\n      <div class="folha-rosto" style="width: 21cm; min-height: 29.7cm; margin: 0 auto; padding: 2cm; background: white; font-family: 'Times New Roman', serif; font-size: 12pt; line-height: 1.6;">\n        \n        \x3c!-- Formato EXATO conforme INSTRUÃ‡ÃƒO PROCESSUAL (1).pdf --\x3e\n        <div style="text-align: center; margin-bottom: 3cm;">\n          <div style="border: 2px solid #000; padding: 1.5cm;">\n            \n            <div style="font-weight: bold; font-size: 14pt; margin-bottom: 1cm;">\n              PROCESSO ADMINISTRATIVO NÂº ${a.numeroProcesso}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>NOME DO Ã“RGÃƒO:</strong> ${a.dadosOrgao.nome}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>INTERESSADO(A):</strong> ${a.dadosOrgao.departamento||"COMISSÃƒO PERMANENTE DE PADRONIZAÃ‡ÃƒO DE MATERIAIS - CPPM"}\n            </div>\n            \n            <div style="margin-bottom: 1cm; text-align: left;">\n              <strong>DATA DE AUTUAÃ‡ÃƒO:</strong> ${o}\n            </div>\n            \n            <div style="text-align: left;">\n              <strong>OBJETO:</strong> ${"padronizacao"===a.tipoProcesso?t:e}\n            </div>\n            \n          </div>\n        </div>\n\n        \x3c!-- EspaÃ§o para carimbo/assinatura --\x3e\n        <div style="margin-top: 4cm; text-align: center; font-size: 10pt; color: #666;">\n          <p>Fl. 001</p>\n        </div>\n        \n      </div>\n    `}static async listarDocumentosComNumeracao(a){try{return await i["default"].listarDocumentosProcesso(a)}catch(o){throw console.error("Erro ao listar documentos com numeraÃ§Ã£o:",o),o}}static async obterRelatorioNumeracao(a){try{return await i["default"].gerarRelatorioDocumentos(a)}catch(o){throw console.error("Erro ao obter relatÃ³rio de numeraÃ§Ã£o:",o),o}}static async obterHistoricoTramitacao(a){try{const o=await(0,e.EO)();if(!o)throw new Error("UsuÃ¡rio nÃ£o autenticado ou sem tenant");const{data:t,error:s}=await e.ND.from("processos_administrativos").select("\n          id,\n          status,\n          created_at,\n          updated_at\n        ").eq("id",a).eq("tenant_id",o).single();if(s)throw console.error("Erro ao buscar histÃ³rico de tramitaÃ§Ã£o:",s),s;const i=[{id:1,data:t.created_at,status_anterior:null,status_novo:"rascunho",responsavel:"Sistema",observacoes:"Processo criado"}];return t.updated_at&&t.updated_at!==t.created_at&&i.push({id:2,data:t.updated_at,status_anterior:"rascunho",status_novo:t.status,responsavel:"Sistema",observacoes:"Status atualizado"}),i}catch(o){throw console.error("Erro ao obter histÃ³rico de tramitaÃ§Ã£o:",o),o}}}const n=r}},o={};function t(e){var s=o[e];if(void 0!==s)return s.exports;var i=o[e]={exports:{}};return a[e].call(i.exports,i,i.exports,t),i.exports}t.m=a,(()=>{var a=[];t.O=(o,e,s,i)=>{if(!e){var r=1/0;for(d=0;d<a.length;d++){for(var[e,s,i]=a[d],n=!0,c=0;c<e.length;c++)(!1&i||r>=i)&&Object.keys(t.O).every((a=>t.O[a](e[c])))?e.splice(c--,1):(n=!1,i<r&&(r=i));if(n){a.splice(d--,1);var l=s();void 0!==l&&(o=l)}}return o}i=i||0;for(var d=a.length;d>0&&a[d-1][2]>i;d--)a[d]=a[d-1];a[d]=[e,s,i]}})(),(()=>{t.n=a=>{var o=a&&a.__esModule?()=>a["default"]:()=>a;return t.d(o,{a:o}),o}})(),(()=>{var a,o=Object.getPrototypeOf?a=>Object.getPrototypeOf(a):a=>a.__proto__;t.t=function(e,s){if(1&s&&(e=this(e)),8&s)return e;if("object"===typeof e&&e){if(4&s&&e.__esModule)return e;if(16&s&&"function"===typeof e.then)return e}var i=Object.create(null);t.r(i);var r={};a=a||[null,o({}),o([]),o(o)];for(var n=2&s&&e;"object"==typeof n&&!~a.indexOf(n);n=o(n))Object.getOwnPropertyNames(n).forEach((a=>r[a]=()=>e[a]));return r["default"]=()=>e,t.d(i,r),i}})(),(()=>{t.d=(a,o)=>{for(var e in o)t.o(o,e)&&!t.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:o[e]})}})(),(()=>{t.f={},t.e=a=>Promise.all(Object.keys(t.f).reduce(((o,e)=>(t.f[e](a,o),o)),[]))})(),(()=>{t.u=a=>"js/"+a+"."+{46:"3949ee61",83:"436433a2",125:"68e8c682",130:"c618e48a",208:"cf96592d",220:"5c9e5b04",236:"61137d7b",353:"7ac320c4",420:"79143310",645:"2fe04cc9",796:"1a849ad2",828:"e23f50db",829:"99ee4b9f",913:"df2f916f",961:"e469db0d",967:"4f017123"}[a]+".js"})(),(()=>{t.miniCssF=a=>"css/"+a+"."+{46:"ce782430",83:"7cd9b7c8",220:"5a75312a",645:"3c76b20e",796:"71a35ed3",829:"3c8d7bf4",961:"401b363e"}[a]+".css"})(),(()=>{t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()})(),(()=>{t.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o)})(),(()=>{var a={},o="comprar-bem:";t.l=(e,s,i,r)=>{if(a[e])a[e].push(s);else{var n,c;if(void 0!==i)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+i){n=u;break}}n||(c=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,t.nc&&n.setAttribute("nonce",t.nc),n.setAttribute("data-webpack",o+i),n.src=e),a[e]=[s];var m=(o,t)=>{n.onerror=n.onload=null,clearTimeout(p);var s=a[e];if(delete a[e],n.parentNode&&n.parentNode.removeChild(n),s&&s.forEach((a=>a(t))),o)return o(t)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=m.bind(null,n.onerror),n.onload=m.bind(null,n.onload),c&&document.head.appendChild(n)}}})(),(()=>{t.r=a=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}})(),(()=>{t.p="/ComprarBem/"})(),(()=>{if("undefined"!==typeof document){var a=(a,o,e,s,i)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",t.nc&&(r.nonce=t.nc);var n=t=>{if(r.onerror=r.onload=null,"load"===t.type)s();else{var e=t&&t.type,n=t&&t.target&&t.target.href||o,c=new Error("Loading CSS chunk "+a+" failed.\n("+e+": "+n+")");c.name="ChunkLoadError",c.code="CSS_CHUNK_LOAD_FAILED",c.type=e,c.request=n,r.parentNode&&r.parentNode.removeChild(r),i(c)}};return r.onerror=r.onload=n,r.href=o,e?e.parentNode.insertBefore(r,e.nextSibling):document.head.appendChild(r),r},o=(a,o)=>{for(var t=document.getElementsByTagName("link"),e=0;e<t.length;e++){var s=t[e],i=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(i===a||i===o))return s}var r=document.getElementsByTagName("style");for(e=0;e<r.length;e++){s=r[e],i=s.getAttribute("data-href");if(i===a||i===o)return s}},e=e=>new Promise(((s,i)=>{var r=t.miniCssF(e),n=t.p+r;if(o(r,n))return s();a(e,n,null,s,i)})),s={524:0};t.f.miniCss=(a,o)=>{var t={46:1,83:1,220:1,645:1,796:1,829:1,961:1};s[a]?o.push(s[a]):0!==s[a]&&t[a]&&o.push(s[a]=e(a).then((()=>{s[a]=0}),(o=>{throw delete s[a],o})))}}})(),(()=>{var a={524:0};t.f.j=(o,e)=>{var s=t.o(a,o)?a[o]:void 0;if(0!==s)if(s)e.push(s[2]);else{var i=new Promise(((t,e)=>s=a[o]=[t,e]));e.push(s[2]=i);var r=t.p+t.u(o),n=new Error,c=e=>{if(t.o(a,o)&&(s=a[o],0!==s&&(a[o]=void 0),s)){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;n.message="Loading chunk "+o+" failed.\n("+i+": "+r+")",n.name="ChunkLoadError",n.type=i,n.request=r,s[1](n)}};t.l(r,c,"chunk-"+o,o)}},t.O.j=o=>0===a[o];var o=(o,e)=>{var s,i,[r,n,c]=e,l=0;if(r.some((o=>0!==a[o]))){for(s in n)t.o(n,s)&&(t.m[s]=n[s]);if(c)var d=c(t)}for(o&&o(e);l<r.length;l++)i=r[l],t.o(a,i)&&a[i]&&a[i][0](),a[i]=0;return t.O(d)},e=self["webpackChunkcomprar_bem"]=self["webpackChunkcomprar_bem"]||[];e.forEach(o.bind(null,0)),e.push=o.bind(null,e.push.bind(e))})();var e=t.O(void 0,[504],(()=>t(5860)));e=t.O(e)})();
//# sourceMappingURL=app.9e1e6038.js.map