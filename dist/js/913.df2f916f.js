"use strict";(self["webpackChunkcomprar_bem"]=self["webpackChunkcomprar_bem"]||[]).push([[913],{1913:(e,t,o)=>{function a(e,t="export.csv",o=null){if(!e||0===e.length)throw new Error("Nenhum dado para exportar");const a=o||Object.keys(e[0]);let r=a.join(";")+"\n";e.forEach((e=>{const t=a.map((t=>{let o=e[t]||"";return"string"===typeof o?(o=o.replace(/"/g,'""'),(o.includes(";")||o.includes(",")||o.includes("\n")||o.includes('"'))&&(o=`"${o}"`)):o instanceof Date?o=o.toLocaleDateString("pt-BR"):"number"===typeof o&&(o=o.toLocaleString("pt-BR")),o}));r+=t.join(";")+"\n"})),n(r,t,"text/csv;charset=utf-8;")}function r(e,t="export.xlsx",o=null){if(!e||0===e.length)throw new Error("Nenhum dado para exportar");const a=o||Object.keys(e[0]);let r="\ufeff";r+=a.join("\t")+"\n",e.forEach((e=>{const t=a.map((t=>{let o=e[t]||"";return"string"===typeof o?o=o.replace(/\n/g," "):o instanceof Date?o=o.toLocaleDateString("pt-BR"):"number"===typeof o&&(o=o.toString().replace(".",",")),o}));r+=t.join("\t")+"\n"})),n(r,t.replace(".xlsx",".xls"),"application/vnd.ms-excel;charset=utf-8;")}function n(e,t,o){const a=new Blob([e],{type:o}),r=window.URL.createObjectURL(a),n=document.createElement("a");n.href=r,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout((()=>{window.URL.revokeObjectURL(r)}),100)}function i(e,t="excel"){if(!e||0===e.length)throw new Error("Nenhuma cotação para exportar");const o=["Produto","Descrição do Produto","Fornecedor","CNPJ","Contato","Quantidade","Unidade","Preço Unitário (R$)","Preço Total (R$)","Prazo Entrega (dias)","Data Validade","Observações","Status","Data Criação"],n=e.map((e=>({Produto:e.produto_nome||"","Descrição do Produto":e.produto_descricao||"",Fornecedor:e.fornecedor_nome||"",CNPJ:s(e.fornecedor_cnpj)||"",Contato:e.fornecedor_contato||"",Quantidade:e.quantidade||"",Unidade:e.unidade_medida||"","Preço Unitário (R$)":c(e.preco_unitario)||"","Preço Total (R$)":c(e.preco_total)||"","Prazo Entrega (dias)":e.prazo_entrega||"","Data Validade":d(e.data_validade)||"",Observações:e.observacoes||"",Status:l(e.status)||"","Data Criação":d(e.created_at)||""}))),i=new Date,p=i.toISOString().split("T")[0],u=i.toTimeString().split(" ")[0].replace(/:/g,"-");if("excel"===t){const e=`cotacoes_${p}_${u}.xlsx`;r(n,e,o)}else{const e=`cotacoes_${p}_${u}.csv`;a(n,e,o)}}function c(e){return e?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e):""}function s(e){return e?e.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):""}function d(e){return e?new Date(e).toLocaleDateString("pt-BR"):""}function l(e){const t={pendente:"Pendente",enviada:"Enviada",respondida:"Respondida",aceita:"Aceita",rejeitada:"Rejeitada",expirada:"Expirada"};return t[e]||e}function p(e,t="excel"){if(!e||0===e.length)throw new Error("Nenhum comparativo para exportar");const o=e.map((e=>({Título:e.titulo||"",Descrição:e.descricao||"",Categoria:e.categoria||"",Status:l(e.status)||"","Total de Itens":e.total_itens||0,"Pontuação Máxima":e.pontuacao_maxima||0,"Fornecedor Vencedor":e.fornecedor_vencedor||"","Economia Estimada (R$)":c(e.economia_estimada)||"","Data Criação":d(e.created_at)||"","Última Atualização":d(e.updated_at)||""}))),n=new Date,i=n.toISOString().split("T")[0],s=n.toTimeString().split(" ")[0].replace(/:/g,"-");if("excel"===t){const e=`comparativos_${i}_${s}.xlsx`;r(o,e)}else{const e=`comparativos_${i}_${s}.csv`;a(o,e)}}function u(e,t="excel"){if(!e||0===e.length)throw new Error("Nenhuma análise para exportar");const o=e.map((e=>({Título:e.titulo||"",Categoria:e.categoria||"",Status:l(e.status)||"","Produtos Analisados":e.produtos_analisados||0,"Preço Médio (R$)":c(e.preco_medio)||"","Menor Preço (R$)":c(e.preco_minimo)||"","Maior Preço (R$)":c(e.preco_maximo)||"","Desvio Padrão":e.desvio_padrao||"","Outliers Detectados":e.outliers_detectados||0,Recomendação:e.recomendacao||"","Data Criação":d(e.created_at)||"","Última Atualização":d(e.updated_at)||""}))),n=new Date,i=n.toISOString().split("T")[0],s=n.toTimeString().split(" ")[0].replace(/:/g,"-");if("excel"===t){const e=`analises_precos_${i}_${s}.xlsx`;r(o,e)}else{const e=`analises_precos_${i}_${s}.csv`;a(o,e)}}o.d(t,{exportAnalises:()=>u,exportComparativos:()=>p,exportCotacoes:()=>i})}}]);
//# sourceMappingURL=913.df2f916f.js.map