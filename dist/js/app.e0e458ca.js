(()=>{"use strict";var a={3212:(a,t,e)=>{e.d(t,{ND:()=>r});var o=e(6017);const i="https://ruagsbbczuwgfflgcaol.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1YWdzYmJjenV3Z2ZmbGdjYW9sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQ0Njg5MDQsImV4cCI6MjA2MDA0NDkwNH0.S2KD6-9DpBYAOsodjibI7LGa04CspZZ5OdRQagNjoK8",r=(0,o.UU)(i,s)},4252:(a,t,e)=>{var o=e(5471),i=function(){var a=this,t=a._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},s=[],r=e(1656),n={},l=(0,r.A)(n,i,s,!1,null,null,null);const c=l.exports;var d=e(173),u=function(){var a=this,t=a._self._c;return t("div",{staticClass:"home"},[t("Login")],1)},m=[],p=function(){var a=this,t=a._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-card"},[t("h2",[a._v("Comprar Bem: Compras Inteligentes")]),t("p",[a._v("Saúde e Administração")]),t("div",{staticClass:"tabs"},[t("button",{class:{active:"login"===a.activeTab},on:{click:function(t){a.activeTab="login"}}},[a._v("Login")]),t("button",{class:{active:"register"===a.activeTab},on:{click:function(t){a.activeTab="register"}}},[a._v("Registrar")])]),"login"===a.activeTab?t("div",[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("E-mail")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.email,expression:"email"}],attrs:{id:"email",type:"email",placeholder:"Seu e-mail",required:""},domProps:{value:a.email},on:{input:function(t){t.target.composing||(a.email=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"password"}},[a._v("Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.password,expression:"password"}],attrs:{id:"password",type:"password",placeholder:"Sua senha",required:""},domProps:{value:a.password},on:{input:function(t){t.target.composing||(a.password=t.target.value)}}})]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.loading},on:{click:a.login}},[a._v(" "+a._s(a.loading?"Entrando...":"Entrar")+" ")])]):a._e(),"register"===a.activeTab?t("div",[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registerEmail"}},[a._v("E-mail")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.registerEmail,expression:"registerEmail"}],attrs:{id:"registerEmail",type:"email",placeholder:"Seu e-mail",required:""},domProps:{value:a.registerEmail},on:{input:function(t){t.target.composing||(a.registerEmail=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registerPassword"}},[a._v("Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.registerPassword,expression:"registerPassword"}],attrs:{id:"registerPassword",type:"password",placeholder:"Sua senha",required:""},domProps:{value:a.registerPassword},on:{input:function(t){t.target.composing||(a.registerPassword=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"confirmPassword"}},[a._v("Confirmar Senha")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.confirmPassword,expression:"confirmPassword"}],attrs:{id:"confirmPassword",type:"password",placeholder:"Confirme sua senha",required:""},domProps:{value:a.confirmPassword},on:{input:function(t){t.target.composing||(a.confirmPassword=t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeInstitucional"}},[a._v("Nome da Instituição")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.nomeInstitucional,expression:"nomeInstitucional"}],attrs:{id:"nomeInstitucional",type:"text",placeholder:"Nome da sua instituição",required:""},domProps:{value:a.nomeInstitucional},on:{input:function(t){t.target.composing||(a.nomeInstitucional=t.target.value)}}})]),t("button",{staticClass:"btn-primary",attrs:{type:"button"},on:{click:a.register}},[a._v(" "+a._s(a.loading?"Registrando...":"Registrar")+" ")]),t("button",{staticClass:"btn-test",staticStyle:{"margin-top":"10px"},on:{click:a.testeSimples}},[a._v(" Teste Simples ")]),a.validRegistration?a._e():t("div",{staticClass:"validation-info"},[t("p",[a._v("O formulário não está válido porque:")]),t("ul",[a.registerEmail?a._e():t("li",[a._v("Falta o e-mail")]),a.registerPassword?a._e():t("li",[a._v("Falta a senha")]),a.registerPassword&&a.registerPassword.length<6?t("li",[a._v("A senha precisa ter pelo menos 6 caracteres")]):a._e(),a.registerPassword!==a.confirmPassword?t("li",[a._v("As senhas não conferem")]):a._e(),a.nomeInstitucional?a._e():t("li",[a._v("Falta o nome da instituição")])])])]):a._e(),a.errorMsg?t("p",{staticClass:"error-message"},[a._v(a._s(a.errorMsg))]):a._e(),t("div",{staticClass:"public-access"},[t("hr",{staticStyle:{margin:"20px 0"}}),a._m(0),t("router-link",{staticClass:"btn-public",attrs:{to:"/editais-publicos"}},[a._v(" 📋 Ver Editais de Pré-Qualificação ")]),t("p",{staticStyle:{"font-size":"12px",color:"#888","text-align":"center","margin-top":"10px"}},[a._v(" Empresas podem consultar e se inscrever nos editais públicos ")])],1),"register"===a.activeTab?t("div",{staticClass:"test-buttons"},[t("button",{staticClass:"btn-test",on:{click:a.testarSupabase}},[a._v("Testar Conexão Supabase")])]):a._e()])])},v=[function(){var a=this,t=a._self._c;return t("p",{staticStyle:{"text-align":"center",color:"#666","margin-bottom":"15px"}},[t("strong",[a._v("Área Pública")])])}],g=e(3212),f=e(1303);const h={name:"Login",data(){return{activeTab:"login",email:"",password:"",registerEmail:"",registerPassword:"",confirmPassword:"",nomeInstitucional:"",loading:!1,errorMsg:""}},computed:{validRegistration(){return this.registerEmail&&this.registerPassword&&this.registerPassword===this.confirmPassword&&this.nomeInstitucional&&this.registerPassword.length>=6}},mounted(){console.log("Componente Login montado",{activeTab:this.activeTab})},watch:{activeTab(a){console.log("Aba ativa alterada para:",a)},registerEmail(a){console.log("E-mail de registro alterado:",a)},registerPassword(a){console.log("Senha de registro alterada:",a?"****":"")}},methods:{async testarSupabase(){console.log("Testando conexão com Supabase...");try{const{data:a,error:t}=await g.ND.from("tenants").select("*").limit(1);console.log("Resultado do teste tabela tenants:",{data:a,error:t}),t?alert(`Erro ao acessar tabela: ${t.message}`):alert(`Conexão OK! ${a?a.length:0} registros encontrados.`);const e=(0,f.A)();console.log("Teste UUID gerado:",e)}catch(a){console.error("Erro no teste:",a),alert(`Erro na conexão: ${a.message}`)}},async login(){try{this.loading=!0,this.errorMsg="";const{error:a}=await g.ND.auth.signInWithPassword({email:this.email,password:this.password});if(a)throw a;this.$router.push("/dashboard")}catch(a){this.errorMsg=a.message||"Erro ao fazer login"}finally{this.loading=!1}},async register(){if(console.log("Método register chamado",{email:this.registerEmail,password:"****",nomeInstitucional:this.nomeInstitucional}),!this.validRegistration)return console.log("Formulário inválido"),void(this.errorMsg="Verifique os campos do formulário");try{this.loading=!0,this.errorMsg="",console.log("Iniciando registro de usuário no Supabase...");const{data:t,error:e}=await g.ND.auth.signUp({email:this.registerEmail,password:this.registerPassword});if(console.log("Resposta do registro de usuário:",{authData:t,authError:e}),e&&!e.message.includes("already registered"))throw e;const o=t?.user?.id;console.log("ID da autenticação:",o);const i=(0,f.A)(),s=(0,f.A)();try{const{error:a}=await g.ND.from("usuarios").delete().eq("email",this.registerEmail);a&&console.warn("Aviso ao tentar remover usuário existente:",a)}catch(a){console.warn("Erro ao tentar remover usuário:",a)}console.log("Criando tenant...");const{data:r,error:n}=await g.ND.from("tenants").insert({id:i,nome:this.nomeInstitucional,descricao:`Tenant para ${this.registerEmail}`,ativo:!0}).select();if(n)throw new Error(`Erro ao criar tenant: ${n.message}`);console.log("Criando usuário...");const{data:l,error:c}=await g.ND.from("usuarios").insert({id:s,email:this.registerEmail,nome:this.nomeInstitucional,tenant_id:i,tipo:"admin",ativo:!0}).select();if(c)throw c.message.includes("duplicate key")?(this.errorMsg="Este email já está registrado. Por favor, contate o suporte.",new Error(`Email já existe na base de dados: ${c.message}`)):new Error(`Erro ao criar usuário: ${c.message}`);console.log("Atualizando tenant com user_id...");const{error:d}=await g.ND.from("tenants").update({user_id:o}).eq("id",i);d&&console.warn("Aviso: Não foi possível atualizar o tenant com user_id:",d),console.log("Registro concluído com sucesso!"),alert("Registro realizado com sucesso! Verifique seu e-mail para confirmar a conta."),this.activeTab="login",this.email=this.registerEmail}catch(t){console.error("Erro detalhado no registro:",t),this.errorMsg=this.errorMsg||t.message||"Erro ao fazer registro"}finally{this.loading=!1}},testeSimples(){console.log("Botão de teste simples clicado"),alert("Teste de evento de clique funcionando!")}}},_=h;var C=(0,r.A)(_,p,v,!1,null,"08279fd0",null);const b=C.exports,w={name:"Home",components:{Login:b}},D=w;var E=(0,r.A)(D,u,m,!1,null,null,null);const y=E.exports;var x=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("▼")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("DashboardCPM")],1)])},P=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])}],A=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard"},[t("h2",[a._v("Painel CPM")]),t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab",class:{active:"dashboard"===a.activeTab},on:{click:function(t){a.activeTab="dashboard"}}},[a._v(" Dashboard ")]),t("div",{staticClass:"tab",class:{active:"editais"===a.activeTab},on:{click:function(t){a.activeTab="editais"}}},[a._v(" Editais de Pré-Qualificação ")]),t("div",{staticClass:"tab",class:{active:"pesquisa"===a.activeTab},on:{click:function(t){a.activeTab="pesquisa"}}},[a._v(" Pesquisa de Mercado ")]),t("div",{staticClass:"tab",class:{active:"despadronizadas"===a.activeTab},on:{click:function(t){a.activeTab="despadronizadas"}}},[a._v(" Marcas Despadronizadas ")]),t("div",{staticClass:"tab",class:{active:"certificados"===a.activeTab},on:{click:function(t){a.activeTab="certificados"}}},[a._v(" Emissão de Certificados (DCB) ")])]),"dashboard"===a.activeTab?t("div",[t("div",{staticClass:"stats-container"},[t("div",{staticClass:"stat-card status-pendente-card"},[t("h3",[a._v("Produtos em Avaliação")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))])]),t("div",{staticClass:"stat-card status-aprovado-card"},[t("h3",[a._v("Produtos Aprovados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))])]),t("div",{staticClass:"stat-card status-reprovado-card"},[t("h3",[a._v("Produtos Reprovados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.reprovados))])])]),t("div",{staticClass:"recent-products"},[t("div",{staticClass:"section-header"},[t("h3",[a._v("📋 Requerimentos Recentes")]),t("div",{staticClass:"pagination-controls"},[t("label",[a._v("Itens por página:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPagina,expression:"itensPorPagina"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.itensPorPagina=t.target.multiple?e:e[0]},a.aplicarPaginacao]}},[t("option",{attrs:{value:"5"}},[a._v("5")]),t("option",{attrs:{value:"10"}},[a._v("10")]),t("option",{attrs:{value:"20"}},[a._v("20")]),t("option",{attrs:{value:"50"}},[a._v("50")])])])]),t("div",{staticClass:"filtros-inline"},[t("div",{staticClass:"filtro-inline"},[t("label",[a._v("🔤 Nome:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.nome,expression:"filtros.nome"}],attrs:{type:"text",placeholder:"Filtrar por nome..."},domProps:{value:a.filtros.nome},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"nome",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("🏷️ Marca:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.marca,expression:"filtros.marca"}],attrs:{type:"text",placeholder:"Filtrar por marca..."},domProps:{value:a.filtros.marca},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"marca",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("📊 Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?e:e[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"pendente"}},[a._v("Em Avaliação")]),t("option",{attrs:{value:"aprovado"}},[a._v("Aprovado")]),t("option",{attrs:{value:"reprovado"}},[a._v("Reprovado")]),t("option",{attrs:{value:"em_analise"}},[a._v("Em Análise")])])]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("📅 Data:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.data,expression:"filtros.data"}],attrs:{type:"date"},domProps:{value:a.filtros.data},on:{change:a.aplicarFiltros,input:function(t){t.target.composing||a.$set(a.filtros,"data",t.target.value)}}})]),t("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltros}},[a._v(" 🗑️ Limpar ")])]),a.produtosPaginados.length>0?t("table",[a._m(0),t("tbody",a._l(a.produtosPaginados,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.nome))]),t("td",[a._v(a._s(e.marca))]),t("td",["aprovado"===e.status?t("span",{staticStyle:{"background-color":"#2ecc71",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")]):"pendente"===e.status?t("span",{staticStyle:{"background-color":"#f39c12",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")]):"reprovado"===e.status?t("span",{staticStyle:{"background-color":"#e74c3c",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")]):"em_analise"===e.status?t("span",{staticStyle:{"background-color":"#3498db",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")]):"diligencia"===e.status?t("span",{staticStyle:{"background-color":"#9b59b6",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")]):t("span",{staticStyle:{"background-color":"#6c757d",color:"white",display:"inline-block",padding:"5px 10px","border-radius":"20px","font-size":"12px","text-transform":"uppercase","font-weight":"bold","min-width":"80px","text-align":"center"}},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")])]),t("td",[a._v(a._s(a.formatDate(e.criado_em)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.verProduto(e.id)}}},[a._v("Visualizar")])])])})),0)]):a._e(),a.totalPaginas>1?t("div",{staticClass:"paginacao"},[t("div",{staticClass:"paginacao-info"},[a._v(" Página "+a._s(a.paginaAtual)+" de "+a._s(a.totalPaginas)+" ")]),t("div",{staticClass:"paginacao-botoes"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtual},on:{click:function(t){return a.irParaPagina(a.paginaAtual-1)}}},[a._v(" ◀️ Anterior ")]),t("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveis,(function(e){return t("button",{key:e,class:["btn-numero",{active:e===a.paginaAtual}],on:{click:function(t){return a.irParaPagina(e)}}},[a._v(" "+a._s(e)+" ")])})),0),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtual===a.totalPaginas},on:{click:function(t){return a.irParaPagina(a.paginaAtual+1)}}},[a._v(" ▶️ Próxima ")])])]):0===a.produtos.length?t("p",[a._v("Nenhum requerimento cadastrado.")]):a.temFiltrosAplicados?t("p",[a._v("Nenhum produto encontrado com os filtros aplicados.")]):a._e()]),t("div",{staticClass:"diligencia-section"},[t("div",{staticClass:"section-header"},[t("h3",[a._v("🔍 Requerimentos com Diligências")]),t("div",{staticClass:"pagination-controls"},[t("label",[a._v("Itens por página:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.itensPorPaginaDiligencia,expression:"itensPorPaginaDiligencia"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.itensPorPaginaDiligencia=t.target.multiple?e:e[0]},a.aplicarPaginacaoDiligencia]}},[t("option",{attrs:{value:"5"}},[a._v("5")]),t("option",{attrs:{value:"10"}},[a._v("10")]),t("option",{attrs:{value:"20"}},[a._v("20")])])])]),t("div",{staticClass:"filtros-inline"},[t("div",{staticClass:"filtro-inline"},[t("label",[a._v("🔍 Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.busca,expression:"filtrosDiligencia.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDiligencia.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtrosDiligencia,"busca",t.target.value)},a.aplicarFiltrosDiligencia]}})]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("🏷️ Marca:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.marca,expression:"filtrosDiligencia.marca"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosDiligencia,"marca",t.target.multiple?e:e[0])},a.aplicarFiltrosDiligencia]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),a._l(a.marcasUnicas,(function(e){return t("option",{key:e,domProps:{value:e}},[a._v(" "+a._s(e)+" ")])}))],2)]),t("div",{staticClass:"filtro-inline"},[t("label",[a._v("📅 Data:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDiligencia.data,expression:"filtrosDiligencia.data"}],attrs:{type:"date"},domProps:{value:a.filtrosDiligencia.data},on:{change:a.aplicarFiltrosDiligencia,input:function(t){t.target.composing||a.$set(a.filtrosDiligencia,"data",t.target.value)}}})]),t("button",{staticClass:"btn-limpar-filtros",on:{click:a.limparFiltrosDiligencia}},[a._v(" 🗑️ Limpar ")])]),a.diligenciasPaginadas.length>0?t("table",[a._m(1),t("tbody",a._l(a.diligenciasPaginadas,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.nome))]),t("td",[a._v(a._s(e.marca))]),a._m(2,!0),t("td",[a._v(a._s(a.formatDate(e.criado_em)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.verProduto(e.id)}}},[a._v("Visualizar")]),t("button",{staticClass:"btn-small btn-diligencia",on:{click:function(t){return a.visualizarDiligencias(e.id)}}},[a._v("Ver Diligências")])])])})),0)]):a._e(),a.totalPaginasDiligencia>1?t("div",{staticClass:"paginacao"},[t("div",{staticClass:"paginacao-info"},[a._v(" Página "+a._s(a.paginaAtualDiligencia)+" de "+a._s(a.totalPaginasDiligencia)+" ")]),t("div",{staticClass:"paginacao-botoes"},[t("button",{staticClass:"btn-paginacao",attrs:{disabled:1===a.paginaAtualDiligencia},on:{click:function(t){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia-1)}}},[a._v(" ◀️ Anterior ")]),t("span",{staticClass:"numeros-pagina"},a._l(a.paginasVisiveisDiligencia,(function(e){return t("button",{key:e,class:["btn-numero",{active:e===a.paginaAtualDiligencia}],on:{click:function(t){return a.irParaPaginaDiligencia(e)}}},[a._v(" "+a._s(e)+" ")])})),0),t("button",{staticClass:"btn-paginacao",attrs:{disabled:a.paginaAtualDiligencia===a.totalPaginasDiligencia},on:{click:function(t){return a.irParaPaginaDiligencia(a.paginaAtualDiligencia+1)}}},[a._v(" ▶️ Próxima ")])])]):0===a.produtosComDiligencia.length?t("p",[a._v("Nenhum requerimento com diligência encontrado.")]):a.temFiltrosDiligenciaAplicados?t("p",[a._v("Nenhuma diligência encontrada com os filtros aplicados.")]):a._e()]),t("div",{staticClass:"impugnacoes-section"},[t("h3",[a._v("Impugnações ao Edital")]),a.impugnacoes.length>0?t("table",[a._m(3),t("tbody",a._l(a.impugnacoes,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.impugnante))]),t("td",[a._v(a._s(e.produto_nome))]),t("td",[a._v(a._s(a.formatDate(e.data_impugnacao)))]),t("td",[a._v(a._s(a.formatDate(e.prazo_final)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getImpugnacaoStatusClass(e.status)},[a._v(" "+a._s(e.status)+" ")])]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.analisarImpugnacao(e.id)}}},[a._v("Visualizar")])])])})),0)]):t("p",[a._v("Não há impugnações apresentadas.")])])]):a._e(),"pesquisa"===a.activeTab?t("div",{staticClass:"pesquisa-mercado"},[a._m(4)]):a._e(),"editais"===a.activeTab?t("div",{staticClass:"editais"},[t("div",{staticClass:"editais-container"},[t("div",{staticClass:"editais-stats"},[t("div",{staticClass:"stat-card editais-ativos"},[t("h4",[a._v("📋 Editais Ativos")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisAtivos.length))]),t("small",[a._v("Recebendo documentação")])]),t("div",{staticClass:"stat-card editais-rascunho"},[t("h4",[a._v("✏️ Em Elaboração")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisRascunho.length))]),t("small",[a._v("Aguardando publicação")])]),t("div",{staticClass:"stat-card editais-finalizados"},[t("h4",[a._v("✅ Finalizados")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.editaisFinalizados.length))]),t("small",[a._v("Processos concluídos")])]),t("div",{staticClass:"stat-card participantes-total"},[t("h4",[a._v("👥 Participantes")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.totalParticipantes))]),t("small",[a._v("Empresas interessadas")])])]),t("div",{staticClass:"editais-actions"},[t("div",{staticClass:"actions-left"},[t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" ➕ Novo Edital ")]),t("button",{staticClass:"btn-secondary",attrs:{disabled:a.loadingEditais},on:{click:a.carregarEditais}},[a._v(" 🔄 Atualizar ")])]),t("div",{staticClass:"actions-right"},[t("div",{staticClass:"filtro-group"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.busca,expression:"filtroEditais.busca"}],attrs:{type:"text",placeholder:"🔍 Buscar edital..."},domProps:{value:a.filtroEditais.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroEditais,"busca",t.target.value)},a.aplicarFiltrosEditais]}})]),t("div",{staticClass:"filtro-group"},[t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroEditais.status,expression:"filtroEditais.status"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroEditais,"status",t.target.multiple?e:e[0])},a.aplicarFiltrosEditais]}},[t("option",{attrs:{value:""}},[a._v("Todos os Status")]),t("option",{attrs:{value:"RASCUNHO"}},[a._v("📝 Rascunho")]),t("option",{attrs:{value:"PUBLICADO"}},[a._v("📋 Publicado")]),t("option",{attrs:{value:"CANCELADO"}},[a._v("❌ Cancelado")])])])])]),a.loadingEditais?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"loading-spinner"}),t("p",[a._v("Carregando editais...")])]):a.editaisFiltrados.length>0?t("div",{staticClass:"editais-grid"},a._l(a.editaisFiltrados,(function(e){return t("div",{key:e.id,staticClass:"edital-card",class:{"status-ativo":"PUBLICADO"===e.status,"status-rascunho":"RASCUNHO"===e.status,"status-cancelado":"CANCELADO"===e.status}},[t("div",{staticClass:"edital-header"},[t("div",{staticClass:"edital-numero"},[a._v(a._s(e.numero))]),t("div",{staticClass:"edital-status"},["PUBLICADO"===e.status?t("span",{staticClass:"badge status-publicado"},[a._v("📋 Publicado")]):"RASCUNHO"===e.status?t("span",{staticClass:"badge status-rascunho"},[a._v("✏️ Rascunho")]):"CANCELADO"===e.status?t("span",{staticClass:"badge status-cancelado"},[a._v("❌ Cancelado")]):a._e()])]),t("div",{staticClass:"edital-content"},[t("h4",[a._v(a._s(e.descricao))]),t("div",{staticClass:"edital-info"},[t("p",[t("strong",[a._v("📅 Publicação:")]),a._v(" "+a._s(a.formatDate(e.data_publicacao)))]),e.data_limite_impugnacao?t("p",[t("strong",[a._v("⏰ Prazo Impugnação:")]),a._v(" "+a._s(a.formatDate(e.data_limite_impugnacao))+" ")]):a._e(),e.participantes_count?t("p",[t("strong",[a._v("👥 Participantes:")]),a._v(" "+a._s(e.participantes_count)+" empresas ")]):a._e()])]),t("div",{staticClass:"edital-actions"},[t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.visualizarEdital(e)}}},[a._v(" 👁️ Visualizar ")]),"RASCUNHO"===e.status?t("button",{staticClass:"btn-primary btn-small",on:{click:function(t){return a.editarEdital(e)}}},[a._v(" ✏️ Editar ")]):a._e(),"PUBLICADO"===e.status?t("button",{staticClass:"btn-info btn-small",on:{click:function(t){return a.gerenciarParticipantes(e)}}},[a._v(" 👥 Participantes ")]):a._e(),t("div",{staticClass:"dropdown"},[t("button",{staticClass:"btn-secondary btn-small dropdown-toggle"},[a._v("⋮")]),t("div",{staticClass:"dropdown-menu"},[e.url_documento?t("a",{on:{click:function(t){return a.baixarDocumento(e)}}},[a._v("📥 Baixar PDF")]):a._e(),t("a",{on:{click:function(t){return a.duplicarEdital(e)}}},[a._v("📋 Duplicar")]),"RASCUNHO"===e.status?t("a",{staticClass:"text-danger",on:{click:function(t){return a.cancelarEdital(e)}}},[a._v("❌ Cancelar")]):a._e()])])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("📋")]),t("h3",[a._v("Nenhum edital encontrado")]),a.filtroEditais.busca||a.filtroEditais.status?t("p",[a._v(" Nenhum edital corresponde aos filtros aplicados. ")]):t("p",[a._v(' Ainda não há editais cadastrados. Clique em "Novo Edital" para começar. ')]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoEdital}},[a._v(" ➕ Criar Primeiro Edital ")])])]),a.modalNovoEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoEdital}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modoEdicaoEdital?"✏️ Editar Edital":"➕ Novo Edital de Pré-Qualificação"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoEdital}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarEdital.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"numero"}},[a._v("Número do Edital*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.numero,expression:"editalAtual.numero"}],attrs:{id:"numero",type:"text",placeholder:"Ex: 001/2024",required:""},domProps:{value:a.editalAtual.numero},on:{input:function(t){t.target.composing||a.$set(a.editalAtual,"numero",t.target.value)}}}),t("small",[a._v("Formato sugerido: 001/2024, 002/2024...")])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"status"}},[a._v("Status*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.status,expression:"editalAtual.status"}],attrs:{id:"status",required:""},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.editalAtual,"status",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:"RASCUNHO"}},[a._v("✏️ Rascunho")]),t("option",{attrs:{value:"PUBLICADO"}},[a._v("📋 Publicado")])])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descrição/Objeto*")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.descricao,expression:"editalAtual.descricao"}],attrs:{id:"descricao",rows:"3",placeholder:"Ex: Pré-qualificação técnica de medicamentos básicos para unidades de saúde",required:""},domProps:{value:a.editalAtual.descricao},on:{input:function(t){t.target.composing||a.$set(a.editalAtual,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"conteudo"}},[a._v("Conteúdo Detalhado")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.conteudo,expression:"editalAtual.conteudo"}],attrs:{id:"conteudo",rows:"6",placeholder:"Detalhes técnicos, especificações, critérios de avaliação..."},domProps:{value:a.editalAtual.conteudo},on:{input:function(t){t.target.composing||a.$set(a.editalAtual,"conteudo",t.target.value)}}})]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"data_publicacao"}},[a._v("Data de Publicação")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.data_publicacao,expression:"editalAtual.data_publicacao"}],attrs:{id:"data_publicacao",type:"datetime-local"},domProps:{value:a.editalAtual.data_publicacao},on:{input:function(t){t.target.composing||a.$set(a.editalAtual,"data_publicacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"data_limite_impugnacao"}},[a._v("Prazo para Impugnações")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.editalAtual.data_limite_impugnacao,expression:"editalAtual.data_limite_impugnacao"}],attrs:{id:"data_limite_impugnacao",type:"datetime-local",min:a.editalAtual.data_publicacao},domProps:{value:a.editalAtual.data_limite_impugnacao},on:{change:a.validarDataLimite,input:function(t){t.target.composing||a.$set(a.editalAtual,"data_limite_impugnacao",t.target.value)}}}),a.editalAtual.data_publicacao?t("small",{staticClass:"form-text text-muted"},[a._v(" ⚠️ Deve ser posterior à data de publicação ("+a._s(a.formatDate(a.editalAtual.data_publicacao))+") ")]):a._e()])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"arquivo"}},[a._v("Upload do Edital (PDF)")]),t("input",{attrs:{id:"arquivo",type:"file",accept:".pdf"},on:{change:a.handleFileUpload}}),t("small",[a._v("Arquivo PDF com o edital completo (máximo 10MB)")])]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoEdital}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvandoEdital}},[a._v(" "+a._s(a.salvandoEdital?"Salvando...":a.modoEdicaoEdital?"Atualizar":"Criar Edital")+" ")])])])])])]):a._e(),a.modalVisualizarEdital?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalVisualizarEdital}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("👁️ "+a._s(a.editalSelecionado.numero)+" - "+a._s(a.editalSelecionado.descricao))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalVisualizarEdital}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"edital-detalhes"},[t("div",{staticClass:"info-section"},[t("h4",[a._v("📋 Informações Gerais")]),t("div",{staticClass:"info-grid"},[t("div",[t("strong",[a._v("Número:")]),a._v(" "+a._s(a.editalSelecionado.numero))]),t("div",[t("strong",[a._v("Status:")]),t("span",{class:"badge status-"+a.editalSelecionado.status.toLowerCase()},[a._v(" "+a._s(a.editalSelecionado.status)+" ")])]),t("div",[t("strong",[a._v("Data Publicação:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_publicacao)))]),a.editalSelecionado.data_limite_impugnacao?t("div",[t("strong",[a._v("Prazo Impugnação:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_limite_impugnacao))+" ")]):a._e()])]),a.editalSelecionado.conteudo?t("div",{staticClass:"info-section"},[t("h4",[a._v("📄 Conteúdo")]),t("div",{staticClass:"conteudo-texto"},[a._v(a._s(a.editalSelecionado.conteudo))])]):a._e(),t("div",{staticClass:"info-section"},[t("h4",[a._v("📊 Estatísticas")]),t("div",{staticClass:"stats-grid"},[t("div",{staticClass:"mini-stat"},[t("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.participantes_count||0))]),t("span",{staticClass:"mini-stat-label"},[a._v("Participantes")])]),t("div",{staticClass:"mini-stat"},[t("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.produtos_submetidos||0))]),t("span",{staticClass:"mini-stat-label"},[a._v("Produtos Submetidos")])]),t("div",{staticClass:"mini-stat"},[t("span",{staticClass:"mini-stat-value"},[a._v(a._s(a.editalSelecionado.impugnacoes_count||0))]),t("span",{staticClass:"mini-stat-label"},[a._v("Impugnações")])])])])]),t("div",{staticClass:"modal-actions"},[a.editalSelecionado.url_documento?t("button",{staticClass:"btn-primary",on:{click:function(t){return a.abrirDocumento(a.editalSelecionado.url_documento)}}},[a._v(" 📄 Abrir PDF ")]):a._e(),a.editalSelecionado.url_documento?t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.baixarDocumento(a.editalSelecionado)}}},[a._v(" 📥 Baixar PDF ")]):a._e(),"RASCUNHO"===a.editalSelecionado.status?t("button",{staticClass:"btn-secondary",on:{click:a.editarEditalSelecionado}},[a._v(" ✏️ Editar ")]):a._e(),t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalVisualizarEdital}},[a._v(" Fechar ")])])])])]):a._e()]):a._e(),"despadronizadas"===a.activeTab?t("div",{staticClass:"marcas-despadronizadas"},[a._m(5)]):a._e(),"certificados"===a.activeTab?t("div",{staticClass:"certificados-dcb"},[t("div",{staticClass:"dcb-container"},[t("div",{staticClass:"dcb-stats"},[t("div",{staticClass:"stat-card dcb-pendentes"},[t("h4",[a._v("🟡 Prontos para DCB")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.produtosProntosDCB.length))]),t("small",[a._v("Produtos aprovados sem DCB")])]),t("div",{staticClass:"stat-card dcb-emitidos"},[t("h4",[a._v("✅ DCBs Emitidos")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsEmitidos.length))]),t("small",[a._v("Certificados válidos")])]),t("div",{staticClass:"stat-card dcb-vencendo"},[t("h4",[a._v("⚠️ Vencendo")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencendo.length))]),t("small",[a._v("Próximos 30 dias")])]),t("div",{staticClass:"stat-card dcb-vencidos"},[t("h4",[a._v("🔴 Vencidos")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.dcbsVencidos.length))]),t("small",[a._v("Precisam renovação")])])]),t("div",{staticClass:"dcb-tabs"},[t("div",{staticClass:"dcb-tab",class:{active:"emitir"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="emitir"}}},[a._v(" 📝 Emitir DCB ")]),t("div",{staticClass:"dcb-tab",class:{active:"historico"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="historico"}}},[a._v(" 📋 Histórico DCBs ")]),t("div",{staticClass:"dcb-tab",class:{active:"vencimentos"===a.activeTabDCB},on:{click:function(t){a.activeTabDCB="vencimentos"}}},[a._v(" ⏰ Controle Vencimentos ")])]),"emitir"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(6),t("div",{staticClass:"filtros-dcb"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("🔍 Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.busca,expression:"filtrosDCB.busca"}],attrs:{type:"text",placeholder:"Nome, marca ou fabricante..."},domProps:{value:a.filtrosDCB.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtrosDCB,"busca",t.target.value)},a.aplicarFiltrosDCB]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("📂 Categoria:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.categoria,expression:"filtrosDCB.categoria"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosDCB,"categoria",t.target.multiple?e:e[0])},a.aplicarFiltrosDCB]}},[t("option",{attrs:{value:""}},[a._v("Todas")]),t("option",{attrs:{value:"medicamentos"}},[a._v("Medicamentos")]),t("option",{attrs:{value:"materiais_medicos"}},[a._v("Materiais Médicos")]),t("option",{attrs:{value:"equipamentos"}},[a._v("Equipamentos")]),t("option",{attrs:{value:"administrativo"}},[a._v("Administrativo")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("📅 Data Aprovação:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosDCB.dataAprovacao,expression:"filtrosDCB.dataAprovacao"}],attrs:{type:"date"},domProps:{value:a.filtrosDCB.dataAprovacao},on:{change:a.aplicarFiltrosDCB,input:function(t){t.target.composing||a.$set(a.filtrosDCB,"dataAprovacao",t.target.value)}}})]),t("button",{staticClass:"btn-limpar",on:{click:a.limparFiltrosDCB}},[a._v("🗑️ Limpar")])]),a.produtosProntosDCBFiltrados.length>0?t("div",{staticClass:"produtos-dcb-lista"},a._l(a.produtosProntosDCBFiltrados,(function(e){return t("div",{key:e.id,staticClass:"produto-dcb-card"},[t("div",{staticClass:"produto-info"},[t("div",{staticClass:"produto-header"},[t("h4",[a._v(a._s(e.nome))]),t("span",{staticClass:"status-badge status-aprovado"},[a._v("✅ Aprovado")])]),t("div",{staticClass:"produto-details"},[t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(e.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(e.modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(e.fabricante))]),t("p",[t("strong",[a._v("Data Aprovação:")]),a._v(" "+a._s(a.formatDate(e.data_aprovacao||e.aprovado_em||e.criado_em)))])])]),t("div",{staticClass:"produto-actions"},[t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarProdutoDetalhes(e)}}},[a._v(" 👁️ Detalhes ")]),t("button",{staticClass:"btn-primary",attrs:{disabled:a.emitindoDCB===e.id},on:{click:function(t){return a.emitirDCB(e)}}},[a.emitindoDCB===e.id?t("span",[a._v("⏳ Emitindo...")]):t("span",[a._v("📜 Emitir DCB")])])])])})),0):0===a.produtosProntosDCB.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("📝")]),t("h3",[a._v("Nenhum produto pronto para DCB")]),t("p",[a._v("Todos os produtos aprovados já possuem DCB emitido ou não há produtos aprovados.")])]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("🔍")]),t("h3",[a._v("Nenhum produto encontrado")]),t("p",[a._v("Nenhum produto corresponde aos filtros aplicados.")])])]):a._e(),"historico"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(7),t("div",{staticClass:"filtros-dcb"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("🔢 Número DCB:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.numeroDCB,expression:"filtrosHistorico.numeroDCB"}],attrs:{type:"text",placeholder:"Ex: 001/2024"},domProps:{value:a.filtrosHistorico.numeroDCB},on:{input:[function(t){t.target.composing||a.$set(a.filtrosHistorico,"numeroDCB",t.target.value)},a.aplicarFiltrosHistorico]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("📊 Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.status,expression:"filtrosHistorico.status"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtrosHistorico,"status",t.target.multiple?e:e[0])},a.aplicarFiltrosHistorico]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"ativo"}},[a._v("Ativo")]),t("option",{attrs:{value:"vencido"}},[a._v("Vencido")]),t("option",{attrs:{value:"revogado"}},[a._v("Revogado")])])]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("📅 Período:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataInicio,expression:"filtrosHistorico.dataInicio"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataInicio},on:{change:a.aplicarFiltrosHistorico,input:function(t){t.target.composing||a.$set(a.filtrosHistorico,"dataInicio",t.target.value)}}}),t("span",[a._v("até")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtrosHistorico.dataFim,expression:"filtrosHistorico.dataFim"}],attrs:{type:"date"},domProps:{value:a.filtrosHistorico.dataFim},on:{change:a.aplicarFiltrosHistorico,input:function(t){t.target.composing||a.$set(a.filtrosHistorico,"dataFim",t.target.value)}}})])]),a.dcbsHistoricoFiltrados.length>0?t("div",{staticClass:"dcb-historico-tabela"},[t("table",[a._m(8),t("tbody",a._l(a.dcbsHistoricoFiltrados,(function(e){return t("tr",{key:e.id},[t("td",{staticClass:"dcb-numero"},[a._v(a._s(e.numero_dcb))]),t("td",[a._v(a._s(e.produto_nome))]),t("td",[a._v(a._s(e.produto_marca))]),t("td",[a._v(a._s(a.formatDate(e.data_emissao)))]),t("td",[a._v(a._s(a.formatDate(e.data_validade)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusDCBClass(e.status)},[a._v(" "+a._s(a.formatStatusDCB(e.status))+" ")])]),t("td",[t("div",{staticClass:"acoes-dcb"},[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarDCB(e)}}},[a._v(" 👁️ Ver ")]),t("button",{staticClass:"btn-small",on:{click:function(t){return a.downloadDCB(e)}}},[a._v(" 📥 PDF ")]),"ativo"===e.status?t("button",{staticClass:"btn-small btn-danger",on:{click:function(t){return a.revogarDCB(e)}}},[a._v(" 🚫 Revogar ")]):a._e()])])])})),0)])]):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("📋")]),t("h3",[a._v("Nenhum DCB encontrado")]),t("p",[a._v("Nenhum certificado corresponde aos filtros aplicados.")])])]):a._e(),"vencimentos"===a.activeTabDCB?t("div",{staticClass:"dcb-content"},[a._m(9),t("div",{staticClass:"alertas-vencimento"},[a.dcbsVencendo.length>0?t("div",{staticClass:"alerta-warning"},[t("div",{staticClass:"alerta-icon"},[a._v("⚠️")]),t("div",{staticClass:"alerta-content"},[t("h4",[a._v(a._s(a.dcbsVencendo.length)+" DCB(s) vencendo nos próximos 30 dias")]),t("p",[a._v("É recomendado iniciar o processo de renovação.")])])]):a._e(),a.dcbsVencidos.length>0?t("div",{staticClass:"alerta-danger"},[t("div",{staticClass:"alerta-icon"},[a._v("🔴")]),t("div",{staticClass:"alerta-content"},[t("h4",[a._v(a._s(a.dcbsVencidos.length)+" DCB(s) vencido(s)")]),t("p",[a._v("Produtos não podem ser utilizados em licitações até renovação.")])])]):a._e()]),a.dcbsVencendo.length>0?t("div",{staticClass:"dcb-vencimento-section"},[t("h4",[a._v("⚠️ DCBs Vencendo (Próximos 30 dias)")]),t("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencendo,(function(e){return t("div",{key:e.id,staticClass:"dcb-vencimento-card warning"},[t("div",{staticClass:"dcb-info"},[t("h5",[a._v(a._s(e.numero_dcb)+" - "+a._s(e.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(e.produto_marca))]),t("p",[t("strong",[a._v("Vence em:")]),a._v(" "+a._s(a.formatDate(e.data_validade)))]),t("p",[t("strong",[a._v("Dias restantes:")]),a._v(" "+a._s(a.calcularDiasRestantes(e.data_validade)))])]),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-warning",on:{click:function(t){return a.iniciarRenovacao(e)}}},[a._v(" 🔄 Renovar ")]),t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarDCB(e)}}},[a._v(" 👁️ Ver DCB ")])])])})),0)]):a._e(),a.dcbsVencidos.length>0?t("div",{staticClass:"dcb-vencimento-section"},[t("h4",[a._v("🔴 DCBs Vencidos")]),t("div",{staticClass:"dcb-vencimento-lista"},a._l(a.dcbsVencidos,(function(e){return t("div",{key:e.id,staticClass:"dcb-vencimento-card danger"},[t("div",{staticClass:"dcb-info"},[t("h5",[a._v(a._s(e.numero_dcb)+" - "+a._s(e.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(e.produto_marca))]),t("p",[t("strong",[a._v("Venceu em:")]),a._v(" "+a._s(a.formatDate(e.data_validade)))]),t("p",[t("strong",[a._v("Vencido há:")]),a._v(" "+a._s(a.calcularDiasVencidos(e.data_validade))+" dias")])]),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-danger",on:{click:function(t){return a.renovarDCBVencido(e)}}},[a._v(" 🔄 Renovar Urgente ")]),t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.visualizarDCB(e)}}},[a._v(" 👁️ Ver DCB ")])])])})),0)]):a._e(),0===a.dcbsVencendo.length&&0===a.dcbsVencidos.length?t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("✅")]),t("h3",[a._v("Todos os DCBs estão em dia!")]),t("p",[a._v("Não há certificados vencidos ou próximos ao vencimento.")])]):a._e()]):a._e()]),a.modalProdutoDetalhes?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDetalhes}},[t("div",{staticClass:"modal-content produto-detalhes-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("📋 Detalhes do Produto")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalDetalhes}},[a._v("✕")])]),a.produtoSelecionado?t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-detalhes-grid"},[t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("📦 Informações Básicas")]),t("p",[t("strong",[a._v("Nome:")]),a._v(" "+a._s(a.produtoSelecionado.nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj_fabricante||a.produtoSelecionado.cnpj||"Não informado"))])]),t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("✅ Status da Aprovação")]),t("p",[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge status-aprovado"},[a._v(a._s(a.formatarStatus(a.produtoSelecionado.status)))])]),t("p",[t("strong",[a._v("Data Aprovação:")]),a._v(" "+a._s(a.formatDate(a.produtoSelecionado.data_aprovacao||a.produtoSelecionado.aprovado_em||a.produtoSelecionado.criado_em)))]),t("p",[t("strong",[a._v("Aprovado por:")]),a._v(" "+a._s(a.produtoSelecionado.aprovado_por_nome||"Sistema"))])])]),a.produtoSelecionado.especificacoes_tecnicas?t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("🔧 Especificações Técnicas")]),t("pre",[a._v(a._s(a.formatarEspecificacoes(a.produtoSelecionado.especificacoes_tecnicas)))])]):a._e(),a.produtoSelecionado.observacoes_internas?t("div",{staticClass:"detalhes-section"},[t("h4",[a._v("📝 Observações")]),t("p",[a._v(a._s(a.produtoSelecionado.observacoes_internas))])]):a._e()]):a._e(),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDetalhes}},[a._v("Fechar")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.emitirDCB(a.produtoSelecionado)}}},[a._v(" 📜 Emitir DCB ")])])])]):a._e(),a.modalVisualizarDCB?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalDCB}},[t("div",{staticClass:"modal-content dcb-visualizar-modal",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("📜 Visualizar DCB")]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalDCB}},[a._v("✕")])]),a.dcbSelecionado?t("div",{staticClass:"modal-body"},[t("div",{staticClass:"dcb-preview"},[t("div",{staticClass:"dcb-header"},[t("h2",[a._v("DECLARAÇÃO DE CONFORMIDADE DE BEM")]),t("h3",[a._v("DCB Nº "+a._s(a.dcbSelecionado.numero_dcb))])]),t("div",{staticClass:"dcb-content-preview"},[t("div",{staticClass:"dcb-section"},[t("h4",[a._v("PRODUTO CERTIFICADO")]),t("p",[t("strong",[a._v("Nome:")]),a._v(" "+a._s(a.dcbSelecionado.produto_nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.dcbSelecionado.produto_marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.dcbSelecionado.produto_modelo||"N/A"))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.dcbSelecionado.produto_fabricante))])]),t("div",{staticClass:"dcb-section"},[t("h4",[a._v("DADOS DO CERTIFICADO")]),t("p",[t("strong",[a._v("Data de Emissão:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_emissao)))]),t("p",[t("strong",[a._v("Validade:")]),a._v(" "+a._s(a.formatDate(a.dcbSelecionado.data_validade)))]),t("p",[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge",class:a.getStatusDCBClass(a.dcbSelecionado.status)},[a._v(" "+a._s(a.formatStatusDCB(a.dcbSelecionado.status))+" ")])])])])])]):a._e(),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalDCB}},[a._v("Fechar")]),t("button",{staticClass:"btn-primary",on:{click:function(t){return a.downloadDCB(a.dcbSelecionado)}}},[a._v(" 📥 Download PDF ")])])])]):a._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:a.modalParticipantes,expression:"modalParticipantes"}],staticClass:"modal-participantes-overlay"},[t("div",{staticClass:"modal-participantes-content"},[t("div",{staticClass:"modal-participantes-header"},[t("h3",[a._v("👥 Participantes - "+a._s(a.editalSelecionado.numero))]),t("button",{staticClass:"btn-close-participantes",on:{click:a.fecharModalParticipantes}},[a._v("×")])]),t("div",{staticClass:"modal-participantes-body"},[t("div",{staticClass:"participantes-header"},[t("div",{staticClass:"filtros-participantes"},[t("div",{staticClass:"filtro-group"},[t("label",[a._v("🔍 Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.busca,expression:"filtroParticipantes.busca"}],attrs:{type:"text",placeholder:"Nome, CNPJ, representante..."},domProps:{value:a.filtroParticipantes.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtroParticipantes,"busca",t.target.value)},a.aplicarFiltrosParticipantes]}})]),t("div",{staticClass:"filtro-group"},[t("label",[a._v("📊 Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtroParticipantes.status,expression:"filtroParticipantes.status"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtroParticipantes,"status",t.target.multiple?e:e[0])},a.aplicarFiltrosParticipantes]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),t("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("Documentação Enviada")]),t("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em Avaliação")]),t("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),t("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),t("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),t("button",{staticClass:"btn-primary",on:{click:a.abrirModalNovoParticipante}},[a._v(" ➕ Adicionar Participante ")])]),a.loadingParticipantes?t("div",{staticClass:"loading-state"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando participantes...")])]):a.participantesFiltrados.length>0?t("div",{staticClass:"participantes-lista"},a._l(a.participantesFiltrados,(function(e){return t("div",{key:e.id,staticClass:"participante-card"},[t("div",{staticClass:"participante-info"},[t("div",{staticClass:"participante-header"},[t("h4",[a._v(a._s(e.razao_social))]),t("span",{staticClass:"status-badge",class:a.getStatusClass(e.status)},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")])]),t("div",{staticClass:"participante-details"},[t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.formatarCNPJ(e.cnpj)))]),t("p",[t("strong",[a._v("Representante:")]),a._v(" "+a._s(e.representante_legal))]),t("p",[t("strong",[a._v("Email:")]),a._v(" "+a._s(e.email))]),e.telefone?t("p",[t("strong",[a._v("Telefone:")]),a._v(" "+a._s(e.telefone))]):a._e(),t("p",[t("strong",[a._v("Data Participação:")]),a._v(" "+a._s(a.formatDate(e.data_participacao)))]),e.data_envio_documentacao?t("p",[t("strong",[a._v("Documentação Enviada:")]),a._v(" "+a._s(a.formatDate(e.data_envio_documentacao))+" ")]):a._e(),e.observacoes?t("p",[t("strong",[a._v("Observações:")]),a._v(" "+a._s(e.observacoes)+" ")]):a._e()])]),t("div",{staticClass:"participante-actions"},[t("button",{staticClass:"btn-secondary btn-small",on:{click:function(t){return a.editarParticipante(e)}}},[a._v(" ✏️ Editar ")]),t("button",{staticClass:"btn-danger btn-small",on:{click:function(t){return a.removerParticipante(e)}}},[a._v(" 🗑️ Remover ")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("👥")]),t("h3",[a._v("Nenhum participante encontrado")]),a.filtroParticipantes.busca||a.filtroParticipantes.status?t("p",[a._v(" Nenhum participante corresponde aos filtros aplicados. ")]):t("p",[a._v(' Ainda não há participantes neste edital. Clique em "Adicionar Participante" para começar. ')])])]),t("div",{staticClass:"modal-participantes-footer"},[t("button",{staticClass:"btn-secondary",on:{click:a.fecharModalParticipantes}},[a._v("Fechar")])])])]),a.modalNovoParticipante?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalNovoParticipante}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.participanteAtual.id?"✏️ Editar Participante":"➕ Novo Participante"))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalNovoParticipante}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarParticipante.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"razao_social"}},[a._v("Razão Social*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.razao_social,expression:"participanteAtual.razao_social"}],attrs:{id:"razao_social",type:"text",placeholder:"Nome da empresa",required:""},domProps:{value:a.participanteAtual.razao_social},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"razao_social",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cnpj"}},[a._v("CNPJ*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.cnpj,expression:"participanteAtual.cnpj"}],attrs:{id:"cnpj",type:"text",placeholder:"00.000.000/0000-00",required:""},domProps:{value:a.participanteAtual.cnpj},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"cnpj",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"representante_legal"}},[a._v("Representante Legal*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.representante_legal,expression:"participanteAtual.representante_legal"}],attrs:{id:"representante_legal",type:"text",placeholder:"Nome do representante",required:""},domProps:{value:a.participanteAtual.representante_legal},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"representante_legal",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("Email*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.email,expression:"participanteAtual.email"}],attrs:{id:"email",type:"email",placeholder:"contato@empresa.com",required:""},domProps:{value:a.participanteAtual.email},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"email",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"telefone"}},[a._v("Telefone")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.telefone,expression:"participanteAtual.telefone"}],attrs:{id:"telefone",type:"text",placeholder:"(11) 99999-9999"},domProps:{value:a.participanteAtual.telefone},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"telefone",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"status"}},[a._v("Status")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.status,expression:"participanteAtual.status"}],attrs:{id:"status"},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.participanteAtual,"status",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:"INTERESSADO"}},[a._v("Interessado")]),t("option",{attrs:{value:"DOCUMENTACAO_ENVIADA"}},[a._v("Documentação Enviada")]),t("option",{attrs:{value:"EM_AVALIACAO"}},[a._v("Em Avaliação")]),t("option",{attrs:{value:"APROVADO"}},[a._v("Aprovado")]),t("option",{attrs:{value:"REPROVADO"}},[a._v("Reprovado")]),t("option",{attrs:{value:"DESISTENTE"}},[a._v("Desistente")])])])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"endereco"}},[a._v("Endereço")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.endereco,expression:"participanteAtual.endereco"}],attrs:{id:"endereco",type:"text",placeholder:"Endereço completo da empresa"},domProps:{value:a.participanteAtual.endereco},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"endereco",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"observacoes"}},[a._v("Observações")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.participanteAtual.observacoes,expression:"participanteAtual.observacoes"}],attrs:{id:"observacoes",rows:"3",placeholder:"Observações sobre a participação..."},domProps:{value:a.participanteAtual.observacoes},on:{input:function(t){t.target.composing||a.$set(a.participanteAtual,"observacoes",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalNovoParticipante}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit"}},[a._v(" "+a._s(a.participanteAtual.id?"Atualizar":"Adicionar")+" Participante ")])])])])])]):a._e()]):a._e()])},N=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Marca")]),t("th",[a._v("Status")]),t("th",[a._v("Data")]),t("th",[a._v("Ações")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Marca")]),t("th",[a._v("Status")]),t("th",[a._v("Data")]),t("th",[a._v("Ações")])])])},function(){var a=this,t=a._self._c;return t("td",[t("span",{staticClass:"status-badge status-diligencia"},[a._v(" Diligência ")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Impugnante")]),t("th",[a._v("Produto")]),t("th",[a._v("Data da Impugnação")]),t("th",[a._v("Prazo Final")]),t("th",[a._v("Status")]),t("th",[a._v("Documentação")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info-card"},[t("h3",[a._v("Pesquisa de Mercado")]),t("p",[a._v("Este módulo permitirá registrar as pesquisas realizadas para conhecer e/ou avaliar as especificações técnicas e funcionalidades de produtos novos ou já existentes no mercado fornecedor, bem como os seus preços estimados, para fins de instrução dos processos destinados à padronização de marcas e modelos.")]),t("p",[a._v("Funcionalidades que serão implementadas:")]),t("ul",[t("li",[a._v("Registro de especificações técnicas de produtos e cotações de fornecedores")]),t("li",[a._v("Comparativo técnico de produtos, seus preços e condições gerais")]),t("li",[a._v("Análise de variação de preços")]),t("li",[a._v("Geração de relatórios para instrução de processos de compras")]),t("li",[a._v("Integração com bancos de preços públicos")])]),t("div",{staticClass:"em-desenvolvimento"},[t("span",[a._v("Em desenvolvimento")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info-card"},[t("h3",[a._v("Marcas Despadronizadas")]),t("p",[a._v("Este módulo permitirá gerenciar marcas e modelos que foram despadronizados ou que não atendem mais aos requisitos de padronização.")]),t("p",[a._v("Funcionalidades que serão implementadas:")]),t("ul",[t("li",[a._v("Registro de marcas e modelos despadronizados")]),t("li",[a._v("Motivos e justificativas para despadronização")]),t("li",[a._v("Histórico de despadronizações")]),t("li",[a._v("Restrições de uso para modelos despadronizados")]),t("li",[a._v("Notificação aos setores sobre despadronizações")]),t("li",[a._v("Relatórios de impacto por despadronização")]),t("li",[a._v("Registro de comunicações aos órgãos de controle")])]),t("div",{staticClass:"em-desenvolvimento"},[t("span",[a._v("Em desenvolvimento")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("📝 Produtos Prontos para Certificação DCB")]),t("p",[a._v("Produtos aprovados pela CPM que ainda não possuem DCB emitido.")])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("📋 Histórico de DCBs Emitidos")]),t("p",[a._v("Todos os certificados DCB emitidos pelo sistema.")])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Número DCB")]),t("th",[a._v("Produto")]),t("th",[a._v("Marca")]),t("th",[a._v("Data Emissão")]),t("th",[a._v("Validade")]),t("th",[a._v("Status")]),t("th",[a._v("Ações")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"section-header"},[t("h3",[a._v("⏰ Controle de Vencimentos DCB")]),t("p",[a._v("Monitoramento de DCBs próximos ao vencimento ou já vencidos.")])])}];const S={name:"DashboardCPM",data(){return{activeTab:"dashboard",produtos:[],produtosComDiligencia:[],pendentes:0,aprovados:0,reprovados:0,currentTenantId:null,loading:!1,editais:[],editaisFiltrados:[],loadingEditais:!1,modalNovoEdital:!1,modalVisualizarEdital:!1,modalParticipantes:!1,modalNovoParticipante:!1,modoEdicaoEdital:!1,salvandoEdital:!1,editalAtual:{id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:"",url_documento:"",nome_arquivo:""},editalSelecionado:{},filtroEditais:{busca:"",status:""},participantes:[],participantesFiltrados:[],loadingParticipantes:!1,participanteAtual:{id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},filtroParticipantes:{busca:"",status:""},impugnacoes:[],certificados:[],activeTabDCB:"emitir",produtosProntosDCB:[],produtosProntosDCBFiltrados:[],dcbsEmitidos:[],dcbsHistoricoFiltrados:[],dcbsVencendo:[],dcbsVencidos:[],emitindoDCB:null,modalProdutoDetalhes:!1,modalVisualizarDCB:!1,produtoSelecionado:null,dcbSelecionado:null,filtrosDCB:{busca:"",categoria:"",dataAprovacao:""},filtrosHistorico:{numeroDCB:"",status:"",dataInicio:"",dataFim:""},itensPorPagina:5,paginaAtual:1,totalPaginas:1,paginasVisiveis:[],filtros:{nome:"",marca:"",status:"",data:""},produtosPaginados:[],produtosFiltrados:[],itensPorPaginaDiligencia:5,paginaAtualDiligencia:1,totalPaginasDiligencia:1,paginasVisiveisDiligencia:[],filtrosDiligencia:{busca:"",marca:"",data:""},diligenciasFiltradas:[],diligenciasPaginadas:[]}},created(){this.obterTenantId().then((()=>{this.carregarDados()}))},async mounted(){await this.carregarDados(),this.inicializarFiltros()},computed:{marcasUnicas(){const a=[...new Set(this.produtosComDiligencia.map((a=>a.marca)))];return a.filter((a=>a)).sort()},temFiltrosAplicados(){return this.filtros.nome||this.filtros.marca||this.filtros.status||this.filtros.data},temFiltrosDiligenciaAplicados(){return this.filtrosDiligencia.busca||this.filtrosDiligencia.marca||this.filtrosDiligencia.data},editaisAtivos(){return this.editais.filter((a=>"PUBLICADO"===a.status))},editaisRascunho(){return this.editais.filter((a=>"RASCUNHO"===a.status))},editaisFinalizados(){return this.editais.filter((a=>"CANCELADO"===a.status))},totalParticipantes(){return this.editais.reduce(((a,t)=>a+(t.participantes_count||0)),0)}},methods:{async obterTenantId(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usuário não está autenticado");if(t.user_metadata?.tenant_id)return this.currentTenantId=t.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:e,error:o}=await g.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(o)return void console.error("Erro ao buscar tenant_id:",o);e?.tenant_id?(this.currentTenantId=e.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID não encontrado para o usuário")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){try{if(this.loading=!0,!this.currentTenantId&&(console.error("Tenant ID não disponível. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return void console.error("Não foi possível obter o tenant_id, impossível carregar dados");console.log("Carregando produtos para tenant_id:",this.currentTenantId);const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(t)throw t;const e=a||[];this.produtos=e.filter((a=>["pendente","aprovado","reprovado","em_analise"].includes(a.status))),console.log(`${this.produtos.length} requerimentos recentes carregados (sem diligências)`),this.produtosComDiligencia=e.filter((a=>"diligencia"===a.status)),console.log(`${this.produtosComDiligencia.length} produtos com diligência carregados`),await this.carregarImpugnacoes(),await this.carregarDadosDCB(),await this.carregarEditais();const o=await Promise.all([this.contarPorStatus("pendente"),this.contarPorStatus("aprovado"),this.contarPorStatus("reprovado")]);this.pendentes=o[0],this.aprovados=o[1],this.reprovados=o[2]}catch(a){console.error("Erro ao carregar dados:",a)}finally{this.loading=!1,this.$nextTick((()=>{this.inicializarFiltros()}))}},async contarPorStatus(a){if(!this.currentTenantId)return 0;const{count:t,error:e}=await g.ND.from("produtos").select("id",{count:"exact"}).eq("status",a).eq("tenant_id",this.currentTenantId);return e?(console.error(`Erro ao contar produtos ${a}:`,e),0):t||0},formatDate(a){if(!a)return"-";const t=new Date(a);return t.toLocaleDateString("pt-BR")},formatarStatus(a){return"pendente"===a?"em avaliação":a},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";default:return""}},verProduto(a){this.$router.push(`/analise/${a}`)},async visualizarEdital(a){console.log(`Visualizando edital com ID: ${a}`)},getImpugnacaoStatusClass(a){switch(a){case"EM ANÁLISE":return"status-pendente";case"DEFERIDA":return"status-aprovado";case"INDEFERIDA":return"status-reprovado";default:return""}},async analisarImpugnacao(a){try{const{data:t,error:e}=await g.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("id",a).single();if(e)throw e;const{value:o}=await this.$swal({title:"Análise de Impugnação",html:`\n            <div style="text-align: left;">\n              <h4>Impugnação de: ${t.impugnante}</h4>\n              <p><strong>Edital:</strong> ${t.editais?.numero} - ${t.editais?.descricao}</p>\n              <p><strong>Data:</strong> ${this.formatDate(t.data_impugnacao)}</p>\n              <p><strong>Prazo Final:</strong> ${this.formatDate(t.prazo_final)}</p>\n              <p><strong>Motivo:</strong> ${t.motivo}</p>\n              <p><strong>Status Atual:</strong> ${t.status}</p>\n            </div>\n            <hr>\n            <label for="decisao"><strong>Decisão:</strong></label>\n            <select id="decisao" class="swal2-input">\n              <option value="">Selecione uma decisão</option>\n              <option value="DEFERIDA">DEFERIDA (Procedente)</option>\n              <option value="INDEFERIDA">INDEFERIDA (Improcedente)</option>\n              <option value="PARCIALMENTE_DEFERIDA">PARCIALMENTE DEFERIDA</option>\n            </select>\n            <label for="justificativa"><strong>Justificativa da Decisão:</strong></label>\n            <textarea id="justificativa" class="swal2-textarea" placeholder="Fundamente a decisão tomada..."></textarea>\n          `,focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("decisao").value,t=document.getElementById("justificativa").value;return a?!t||t.trim().length<10?(this.$swal.showValidationMessage("A justificativa deve ter pelo menos 10 caracteres"),!1):{decisao:a,justificativa:t}:(this.$swal.showValidationMessage("Selecione uma decisão"),!1)}});o&&await this.salvarDecisaoImpugnacao(a,o.decisao,o.justificativa)}catch(t){console.error("Erro ao analisar impugnação:",t),this.$swal({title:"Erro",text:"Erro ao carregar dados da impugnação",icon:"error"})}},async carregarImpugnacoes(){try{const{data:a,error:t}=await g.ND.from("impugnacoes").select("\n            *,\n            editais (\n              numero,\n              descricao\n            )\n          ").eq("tenant_id",this.currentTenantId).order("data_impugnacao",{ascending:!1}).limit(10);if(t)throw t;this.impugnacoes=a?.map((a=>({...a,produto_nome:`Edital ${a.editais?.numero||"N/A"}`})))||[],console.log(`${this.impugnacoes.length} impugnações carregadas`)}catch(a){console.error("Erro ao carregar impugnações:",a),this.impugnacoes=[]}},async salvarDecisaoImpugnacao(a,t,e){try{const{error:o}=await g.ND.from("impugnacoes").update({status:t,justificativa_decisao:e,data_decisao:(new Date).toISOString(),analisado_por:"CPM"}).eq("id",a);if(o)throw o;this.$swal({title:"Sucesso!",text:"Decisão da impugnação salva com sucesso",icon:"success"}),await this.carregarImpugnacoes()}catch(o){console.error("Erro ao salvar decisão:",o),this.$swal({title:"Erro",text:"Erro ao salvar decisão da impugnação",icon:"error"})}},async solicitarDiligencia(a){try{const{value:t}=await this.$swal({title:"Solicitar Diligência",html:'\n             <label for="tipo_diligencia"><strong>Tipo de Diligência:</strong></label>\n             <select id="tipo_diligencia" class="swal2-input">\n               <option value="">Selecione o tipo</option>\n               <option value="DOCUMENTACAO_FALTANTE">Documentação Faltante</option>\n               <option value="AMOSTRA_INADEQUADA">Amostra Inadequada</option>\n               <option value="ESPECIFICACAO_INCOMPLETA">Especificação Incompleta</option>\n               <option value="CERTIFICACAO_PENDENTE">Certificação Pendente</option>\n               <option value="ESCLARECIMENTO_TECNICO">Esclarecimento Técnico</option>\n             </select>\n             <label for="descricao_diligencia"><strong>Descrição da Diligência:</strong></label>\n             <textarea id="descricao_diligencia" class="swal2-textarea" placeholder="Descreva detalhadamente o que precisa ser providenciado..."></textarea>\n             <label for="prazo_dias"><strong>Prazo (dias úteis):</strong></label>\n             <input type="number" id="prazo_dias" class="swal2-input" value="5" min="1" max="30">\n           ',focusConfirm:!1,preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,t=document.getElementById("descricao_diligencia").value,e=parseInt(document.getElementById("prazo_dias").value);return a?!t||t.trim().length<10?(this.$swal.showValidationMessage("A descrição deve ter pelo menos 10 caracteres"),!1):!e||e<1||e>30?(this.$swal.showValidationMessage("O prazo deve ser entre 1 e 30 dias"),!1):{tipo:a,descricao:t,prazo:e}:(this.$swal.showValidationMessage("Selecione o tipo de diligência"),!1)}});t&&await this.salvarDiligencia(a,t)}catch(t){console.error("Erro ao solicitar diligência:",t)}},async salvarDiligencia(a,t){try{const e=this.calcularDataUtil(new Date,t.prazo),{error:o}=await g.ND.from("diligencias").insert({produto_id:a,tenant_id:this.currentTenantId,tipo:t.tipo,descricao:t.descricao,prazo_dias:t.prazo,data_limite:e.toISOString(),status:"PENDENTE",solicitado_por:"CPM"});if(o)throw o;const{error:i}=await g.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(i)throw i;this.$swal({title:"Sucesso!",text:"Diligência solicitada com sucesso",icon:"success"}),await this.carregarDados()}catch(e){console.error("Erro ao salvar diligência:",e),this.$swal({title:"Erro",text:"Erro ao solicitar diligência",icon:"error"})}},async visualizarDiligencias(a){try{const{data:t,error:e}=await g.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(e)throw e;let o='<div style="text-align: left;">';t&&t.length>0?(o+="<h4>Diligências do Produto:</h4>",t.forEach(((a,t)=>{const e="PENDENTE"===a.status?"color: #f39c12":"color: #27ae60";o+=`\n               <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px;">\n                 <strong>Diligência ${t+1}</strong><br>\n                 <strong>Tipo:</strong> ${a.tipo.replace(/_/g," ")}<br>\n                 <strong>Status:</strong> <span style="${e}">${a.status}</span><br>\n                 <strong>Descrição:</strong> ${a.descricao}<br>\n                 <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}<br>\n                 <strong>Solicitado em:</strong> ${this.formatDate(a.criado_em)}\n               </div>\n             `}))):o+="<p>Nenhuma diligência encontrada para este produto.</p>",o+="</div>",this.$swal({title:"Diligências",html:o,width:"600px"})}catch(t){console.error("Erro ao carregar diligências:",t),this.$swal({title:"Erro",text:"Erro ao carregar diligências do produto",icon:"error"})}},calcularDataUtil(a,t){const e=new Date(a);let o=0;while(o<t)e.setDate(e.getDate()+1),0!==e.getDay()&&6!==e.getDay()&&o++;return e},inicializarFiltros(){this.produtosFiltrados=[...this.produtos],this.diligenciasFiltradas=[...this.produtosComDiligencia],this.aplicarFiltros(),this.aplicarFiltrosDiligencia()},aplicarFiltros(){this.produtosFiltrados=this.produtos.filter((a=>{const t=a.nome.toLowerCase().includes(this.filtros.nome.toLowerCase()),e=a.marca.toLowerCase().includes(this.filtros.marca.toLowerCase()),o=""===this.filtros.status||a.status===this.filtros.status;let i=!0;if(this.filtros.data){const t=new Date(a.criado_em).toDateString(),e=new Date(this.filtros.data).toDateString();i=t===e}return t&&e&&o&&i})),this.calcularPaginacao()},calcularPaginacao(){this.totalPaginas=Math.ceil(this.produtosFiltrados.length/this.itensPorPagina),this.paginaAtual>this.totalPaginas&&(this.paginaAtual=Math.max(1,this.totalPaginas)),this.paginasVisiveis=[];const a=5;if(this.totalPaginas<=a)for(let o=1;o<=this.totalPaginas;o++)this.paginasVisiveis.push(o);else{const t=Math.max(1,this.paginaAtual-2),e=Math.min(this.totalPaginas,t+a-1);for(let a=t;a<=e;a++)this.paginasVisiveis.push(a)}const t=(this.paginaAtual-1)*this.itensPorPagina,e=t+this.itensPorPagina;this.produtosPaginados=this.produtosFiltrados.slice(t,e)},aplicarPaginacao(){this.paginaAtual=1,this.calcularPaginacao()},irParaPagina(a){this.paginaAtual=a,this.calcularPaginacao()},limparFiltros(){this.filtros={nome:"",marca:"",status:"",data:""},this.paginaAtual=1,this.aplicarFiltros()},aplicarFiltrosDiligencia(){this.diligenciasFiltradas=this.produtosComDiligencia.filter((a=>{const t=!this.filtrosDiligencia.busca||a.nome.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.marca.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase())||a.fabricante&&a.fabricante.toLowerCase().includes(this.filtrosDiligencia.busca.toLowerCase()),e=!this.filtrosDiligencia.marca||a.marca===this.filtrosDiligencia.marca;let o=!0;if(this.filtrosDiligencia.data){const t=new Date(a.criado_em).toDateString(),e=new Date(this.filtrosDiligencia.data).toDateString();o=t===e}return t&&e&&o})),this.calcularPaginacaoDiligencia()},calcularPaginacaoDiligencia(){this.totalPaginasDiligencia=Math.ceil(this.diligenciasFiltradas.length/this.itensPorPaginaDiligencia),this.paginaAtualDiligencia>this.totalPaginasDiligencia&&(this.paginaAtualDiligencia=Math.max(1,this.totalPaginasDiligencia)),this.paginasVisiveisDiligencia=[];const a=5;if(this.totalPaginasDiligencia<=a)for(let o=1;o<=this.totalPaginasDiligencia;o++)this.paginasVisiveisDiligencia.push(o);else{const t=Math.max(1,this.paginaAtualDiligencia-2),e=Math.min(this.totalPaginasDiligencia,t+a-1);for(let a=t;a<=e;a++)this.paginasVisiveisDiligencia.push(a)}const t=(this.paginaAtualDiligencia-1)*this.itensPorPaginaDiligencia,e=t+this.itensPorPaginaDiligencia;this.diligenciasPaginadas=this.diligenciasFiltradas.slice(t,e)},aplicarPaginacaoDiligencia(){this.paginaAtualDiligencia=1,this.calcularPaginacaoDiligencia()},irParaPaginaDiligencia(a){this.paginaAtualDiligencia=a,this.calcularPaginacaoDiligencia()},limparFiltrosDiligencia(){this.filtrosDiligencia={busca:"",marca:"",data:""},this.paginaAtualDiligencia=1,this.aplicarFiltrosDiligencia()},formatarStatus(a){const t={pendente:"Em Avaliação",aprovado:"Aprovado",reprovado:"Reprovado",diligencia:"Diligência",em_analise:"Em Análise"};return t[a]||a},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";case"diligencia":return"status-diligencia";case"em_analise":return"status-em_analise";default:return`status-${a}`}},formatDate(a){if(!a)return"Não informado";try{const t=new Date(a);return isNaN(t.getTime())?"Data inválida":t.toLocaleDateString("pt-BR")}catch(t){return"Data inválida"}},async carregarDadosDCB(){try{if(!this.currentTenantId)return;console.log("Carregando dados DCB para tenant:",this.currentTenantId);const{data:a,error:t}=await g.ND.from("produtos").select("\n              *,\n              categorias(nome)\n            ").eq("tenant_id",this.currentTenantId).eq("status","aprovado").is("numero_dcb",null).order("data_aprovacao",{ascending:!1});if(t)throw t;this.produtosProntosDCB=a||[],this.produtosProntosDCBFiltrados=[...this.produtosProntosDCB];const{data:e,error:o}=await g.ND.from("dcb_certificados").select("\n              *,\n              produtos(nome, marca, modelo, fabricante)\n            ").eq("tenant_id",this.currentTenantId).order("data_emissao",{ascending:!1});if(o)throw o;const i=e||[];this.dcbsEmitidos=i.map((a=>({...a,produto_nome:a.produtos?.nome||"N/A",produto_marca:a.produtos?.marca||"N/A",produto_modelo:a.produtos?.modelo||"N/A",produto_fabricante:a.produtos?.fabricante||"N/A"}))),this.dcbsHistoricoFiltrados=[...this.dcbsEmitidos],this.calcularVencimentos(),console.log(`DCB dados carregados: ${this.produtosProntosDCB.length} prontos, ${this.dcbsEmitidos.length} emitidos`)}catch(a){console.error("Erro ao carregar dados DCB:",a),this.$swal.fire("Erro","Erro ao carregar dados DCB","error")}},calcularVencimentos(){const a=new Date,t=new Date;t.setDate(a.getDate()+30),this.dcbsVencendo=this.dcbsEmitidos.filter((e=>{if("ativo"!==e.status)return!1;const o=new Date(e.data_validade);return o>a&&o<=t})),this.dcbsVencidos=this.dcbsEmitidos.filter((t=>{if("ativo"!==t.status)return!1;const e=new Date(t.data_validade);return e<=a}))},aplicarFiltrosDCB(){let a=[...this.produtosProntosDCB];if(this.filtrosDCB.busca){const t=this.filtrosDCB.busca.toLowerCase();a=a.filter((a=>a.nome.toLowerCase().includes(t)||a.marca.toLowerCase().includes(t)||a.fabricante.toLowerCase().includes(t)))}if(this.filtrosDCB.categoria&&(a=a.filter((a=>a.categorias?.nome?.toLowerCase()===this.filtrosDCB.categoria))),this.filtrosDCB.dataAprovacao){const t=new Date(this.filtrosDCB.dataAprovacao);a=a.filter((a=>{if(!a.data_aprovacao)return!1;const e=new Date(a.data_aprovacao);return e.toDateString()===t.toDateString()}))}this.produtosProntosDCBFiltrados=a},limparFiltrosDCB(){this.filtrosDCB={busca:"",categoria:"",dataAprovacao:""},this.aplicarFiltrosDCB()},aplicarFiltrosHistorico(){let a=[...this.dcbsEmitidos];if(this.filtrosHistorico.numeroDCB){const t=this.filtrosHistorico.numeroDCB.toLowerCase();a=a.filter((a=>a.numero_dcb.toLowerCase().includes(t)))}if(this.filtrosHistorico.status&&(a=a.filter((a=>a.status===this.filtrosHistorico.status))),this.filtrosHistorico.dataInicio){const t=new Date(this.filtrosHistorico.dataInicio);a=a.filter((a=>{const e=new Date(a.data_emissao);return e>=t}))}if(this.filtrosHistorico.dataFim){const t=new Date(this.filtrosHistorico.dataFim);a=a.filter((a=>{const e=new Date(a.data_emissao);return e<=t}))}this.dcbsHistoricoFiltrados=a},async emitirDCB(a){try{this.emitindoDCB=a.id,console.log("Emitindo DCB para produto:",a.nome);const t=await this.gerarNumeroDCB(),e=new Date,o=new Date;o.setFullYear(o.getFullYear()+1);const i=o.toISOString().split("T")[0],{data:s,error:r}=await g.ND.from("dcb_certificados").insert({tenant_id:this.currentTenantId,produto_id:a.id,numero_dcb:t,data_emissao:e.toISOString(),data_validade:i,status:"ativo"}).select().single();if(r)throw r;const{error:n}=await g.ND.from("produtos").update({numero_dcb:t,validade_dcb:i}).eq("id",a.id);if(n)throw n;await this.registrarHistoricoDCB(a.id,"dcb_emitido",`DCB ${t} emitido`),await this.carregarDadosDCB(),await this.gerarPDFDCBAutomatico(s,a),this.$swal.fire({icon:"success",title:"🎉 DCB Emitido com Sucesso!",html:`\n              <div style="text-align: left; padding: 10px;">\n                <p><strong>📜 DCB:</strong> ${t}</p>\n                <p><strong>📦 Produto:</strong> ${a.nome}</p>\n                <p><strong>🏭 Marca:</strong> ${a.marca}</p>\n                <p><strong>📅 Validade:</strong> ${this.formatDate(i)}</p>\n                <hr style="margin: 15px 0;">\n                <p style="color: #28a745; font-weight: bold;">\n                  ✅ PDF oficial gerado automaticamente<br>\n                  📥 Use o botão "PDF" para baixar\n                </p>\n              </div>\n            `,showConfirmButton:!0,confirmButtonText:"📥 Baixar PDF Agora",showCancelButton:!0,cancelButtonText:"Fechar",confirmButtonColor:"#dc3545"}).then((a=>{a.isConfirmed&&this.downloadDCB(s)})),console.log("DCB emitido com sucesso:",t)}catch(t){console.error("Erro ao emitir DCB:",t),this.$swal.fire("Erro","Erro ao emitir DCB: "+t.message,"error")}finally{this.emitindoDCB=null}},async gerarNumeroDCB(){try{const{data:a,error:t}=await g.ND.from("dcb_certificados").select("numero_dcb").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1}).limit(1);if(t)throw t;const e=(new Date).getFullYear();if(!a||0===a.length)return`001/${e}`;const o=a[0].numero_dcb,[i,s]=o.split("/");if(parseInt(s)===e){const a=parseInt(i)+1;return`${a.toString().padStart(3,"0")}/${e}`}return`001/${e}`}catch(a){throw console.error("Erro ao gerar número DCB:",a),a}},async registrarHistoricoDCB(a,t,e){try{const{data:o}=await g.ND.auth.getSession(),i=o?.session?.user;await g.ND.from("workflow_historico").insert({tenant_id:this.currentTenantId,produto_id:a,usuario_id:i?.id,acao:t,observacoes:e})}catch(o){console.error("Erro ao registrar histórico:",o)}},visualizarProdutoDetalhes(a){this.produtoSelecionado=a,this.modalProdutoDetalhes=!0},fecharModalDetalhes(){this.modalProdutoDetalhes=!1,this.produtoSelecionado=null},visualizarDCB(a){this.dcbSelecionado=a,this.modalVisualizarDCB=!0},fecharModalDCB(){this.modalVisualizarDCB=!1,this.dcbSelecionado=null},async downloadDCB(a){try{console.log("Iniciando download DCB:",a.numero_dcb),this.$swal.fire({title:"Gerando PDF...",text:"Aguarde enquanto geramos seu DCB",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}}),await this.gerarPDFDCB(a),this.$swal.close()}catch(t){console.error("Erro ao fazer download:",t),this.$swal.fire("Erro","Erro ao gerar PDF do DCB: "+t.message,"error")}},async gerarPDFDCB(a){try{const o=(await e.e(323).then(e.bind(e,4323))).default,i=(await e.e(583).then(e.t.bind(e,7583,19))).default,{data:s,error:r}=await g.ND.from("produtos").select("*").eq("id",a.produto_id).single();if(r)throw r;const n=new o("portrait","mm","a4"),l=n.internal.pageSize.getWidth(),c=n.internal.pageSize.getHeight(),d=20;let u=d;n.setFontSize(16),n.setFont("helvetica","bold"),n.text("REPÚBLICA FEDERATIVA DO BRASIL",l/2,u,{align:"center"}),u+=8,n.setFontSize(14),n.text("MINISTÉRIO DA SAÚDE",l/2,u,{align:"center"}),u+=6,n.setFontSize(12),n.setFont("helvetica","normal"),n.text("Comissão de Padronização de Materiais - CPM",l/2,u,{align:"center"}),u+=15,n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,l-d,u),u+=15,n.setFontSize(18),n.setFont("helvetica","bold"),n.text("DECLARAÇÃO DE CONFORMIDADE DE BEM",l/2,u,{align:"center"}),u+=8,n.setFontSize(16),n.setTextColor(0,100,200),n.text(`DCB Nº ${a.numero_dcb}`,l/2,u,{align:"center"}),n.setTextColor(0,0,0),u+=20,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("PRODUTO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal");const m=50;n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,l-2*d,m,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Nome do Produto:",d+5,u),n.setFont("helvetica","normal"),n.text(s.nome||"N/A",d+45,u),u+=7,n.setFont("helvetica","bold"),n.text("Marca:",d+5,u),n.setFont("helvetica","normal"),n.text(s.marca||"N/A",d+20,u),u+=7,n.setFont("helvetica","bold"),n.text("Modelo:",d+5,u),n.setFont("helvetica","normal"),n.text(s.modelo||"N/A",d+22,u),u+=7,n.setFont("helvetica","bold"),n.text("Fabricante:",d+5,u),n.setFont("helvetica","normal"),n.text(s.fabricante||"N/A",d+30,u),u+=7,n.setFont("helvetica","bold"),n.text("CNPJ:",d+5,u),n.setFont("helvetica","normal"),n.text(s.cnpj_fabricante||s.cnpj||"N/A",d+20,u),u+=25,n.setFontSize(14),n.setFont("helvetica","bold"),n.text("DADOS DO CERTIFICADO",d,u),u+=10,n.setFontSize(11),n.setFont("helvetica","normal"),n.setDrawColor(200,200,200),n.setFillColor(250,250,250),n.rect(d,u,l-2*d,40,"FD"),u+=10,n.setFont("helvetica","bold"),n.text("Data de Emissão:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_emissao),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Data de Validade:",d+5,u),n.setFont("helvetica","normal"),n.text(this.formatDate(a.data_validade),d+40,u),u+=8,n.setFont("helvetica","bold"),n.text("Status:",d+5,u),n.setFont("helvetica","normal"),n.setTextColor(0,150,0),n.text(this.formatStatusDCB(a.status),d+20,u),n.setTextColor(0,0,0),u+=25,n.setFontSize(12),n.setFont("helvetica","bold"),n.text("DECLARAÇÃO",d,u),u+=10,n.setFontSize(10),n.setFont("helvetica","normal");const p=`Declaramos que o produto acima identificado foi submetido a análise técnica pela Comissão de Padronização de Materiais (CPM) deste órgão, tendo sido APROVADO para utilização em processos licitatórios, conforme previsto na Lei Federal nº 14.133/2021 (Lei de Licitações e Contratos).\n\nO presente Documento de Comprovação de Bem (DCB) atesta que o produto atende aos requisitos técnicos mínimos exigidos e está apto para fornecimento no âmbito da Administração Pública.\n\nEsta declaração possui validade até ${this.formatDate(a.data_validade)}, podendo ser renovada mediante nova análise técnica.`,v=n.splitTextToSize(p,l-2*d),f=4*v.length+80;u+f>c-30&&(n.addPage(),u=d),n.text(v,d,u),u+=4*v.length+25;try{const t=window.location.origin,e=t.includes("github.io"),o=e?`${t}/ComprarBem/#/validar-dcb/${a.numero_dcb}`:`${t}/validar-dcb/${a.numero_dcb}`,s=await i.toDataURL(o,{width:80,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),r=Math.max(u,c-120);n.addImage(s,"PNG",l-d-30,r,25,25),n.setFontSize(8),n.text("Validar DCB:",l-d-30,r+30),n.text(a.numero_dcb,l-d-30,r+33)}catch(t){console.warn("Erro ao gerar QR Code:",t)}u=c-90,n.setFontSize(10),n.setFont("helvetica","normal");const h=new Date;n.text(`Brasília, ${h.getDate().toString().padStart(2,"0")} de ${h.toLocaleDateString("pt-BR",{month:"long"})} de ${h.getFullYear()}`,d,u),u+=20,u=Math.max(u,c-85),n.setDrawColor(0,0,0),n.setLineWidth(.5),n.line(d,u,l/2-10,u),u+=8,n.setFontSize(9),n.setTextColor(0,0,0),n.text("Presidente da Comissão de Padronização de Materiais",d,u),u+=4,n.text("CPM - Ministério da Saúde",d,u),n.setFontSize(8),n.setTextColor(100,100,100);const _=`Este documento foi gerado eletronicamente pelo Sistema ComprarBem em ${h.toLocaleString("pt-BR")}`;n.text(_,l/2,c-10,{align:"center"});const C=`DCB_${a.numero_dcb.replace("/","_")}_${s.nome.replace(/[^a-zA-Z0-9]/g,"_")}.pdf`;n.save(C),console.log("PDF gerado com sucesso:",C),await this.salvarURLPDFNoBanco(a.id,C)}catch(o){throw console.error("Erro ao gerar PDF:",o),o}},async salvarURLPDFNoBanco(a,t){try{const{error:e}=await g.ND.from("dcb_certificados").update({arquivo_pdf_url:t}).eq("id",a);e&&console.warn("Erro ao salvar URL do PDF:",e)}catch(e){console.warn("Erro ao atualizar banco com PDF:",e)}},async gerarPDFDCBAutomatico(a,t){try{console.log("Gerando PDF automaticamente para DCB:",a.numero_dcb);const e={...a,produto_id:t.id};await this.gerarPDFDCB(e)}catch(e){console.warn("Erro ao gerar PDF automaticamente:",e)}},async revogarDCB(a){try{const t=await this.$swal.fire({title:"Revogar DCB?",text:`Tem certeza que deseja revogar o DCB ${a.numero_dcb}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, revogar",cancelButtonText:"Cancelar",input:"textarea",inputPlaceholder:"Digite o motivo da revogação...",inputValidator:a=>{if(!a)return"Você precisa inserir um motivo!"}});if(t.isConfirmed){const e=t.value,{error:o}=await g.ND.from("dcb_certificados").update({status:"revogado",revogado_em:(new Date).toISOString(),motivo_revogacao:e}).eq("id",a.id);if(o)throw o;await this.carregarDadosDCB(),this.$swal.fire("Sucesso!","DCB revogado com sucesso.","success")}}catch(t){console.error("Erro ao revogar DCB:",t),this.$swal.fire("Erro","Erro ao revogar DCB","error")}},async iniciarRenovacao(a){this.$swal.fire({icon:"info",title:"Renovação de DCB",text:`Processo de renovação do DCB ${a.numero_dcb} será implementado em breve.`,timer:2e3})},async renovarDCBVencido(a){this.$swal.fire({icon:"info",title:"Renovação Urgente",text:`Renovação urgente do DCB ${a.numero_dcb} será implementada em breve.`,timer:2e3})},getStatusDCBClass(a){switch(a){case"ativo":return"status-ativo";case"vencido":return"status-vencido";case"revogado":return"status-revogado";default:return"status-indefinido"}},formatStatusDCB(a){switch(a){case"ativo":return"Ativo";case"vencido":return"Vencido";case"revogado":return"Revogado";default:return a}},calcularDiasRestantes(a){const t=new Date,e=new Date(a),o=e-t,i=Math.ceil(o/864e5);return Math.max(0,i)},calcularDiasVencidos(a){const t=new Date,e=new Date(a),o=t-e,i=Math.ceil(o/864e5);return Math.max(0,i)},formatarEspecificacoes(a){return"string"===typeof a?a:"object"===typeof a?JSON.stringify(a,null,2):"N/A"},async carregarEditais(){try{if(this.loadingEditais=!0,!this.currentTenantId)return void console.error("Tenant ID não disponível para carregar editais");const{data:a,error:t}=await g.ND.from("editais").select("\n              *,\n              participantes_count:participantes_editais(count)\n            ").eq("tenant_id",this.currentTenantId).order("criado_em",{ascending:!1});if(t)throw t;this.editais=(a||[]).map((a=>({...a,participantes_count:a.participantes_count?.[0]?.count||0}))),this.aplicarFiltrosEditais(),console.log(`${this.editais.length} editais carregados`),console.log("Editais com participantes:",this.editais.map((a=>({numero:a.numero,participantes:a.participantes_count}))))}catch(a){console.error("Erro ao carregar editais:",a),this.$swal.fire("Erro","Erro ao carregar editais","error")}finally{this.loadingEditais=!1}},aplicarFiltrosEditais(){let a=[...this.editais];if(this.filtroEditais.busca){const t=this.filtroEditais.busca.toLowerCase();a=a.filter((a=>a.numero.toLowerCase().includes(t)||a.descricao.toLowerCase().includes(t)))}this.filtroEditais.status&&(a=a.filter((a=>a.status===this.filtroEditais.status))),this.editaisFiltrados=a},abrirModalNovoEdital(){this.modoEdicaoEdital=!1,this.editalAtual={id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:"",url_documento:""},this.modalNovoEdital=!0},fecharModalNovoEdital(){this.modalNovoEdital=!1,this.modoEdicaoEdital=!1,this.editalAtual={id:null,numero:"",descricao:"",conteudo:"",status:"RASCUNHO",data_publicacao:"",data_limite_impugnacao:"",url_documento:"",nome_arquivo:""}},validarDatas(){if(!this.editalAtual.data_publicacao)return this.$swal.fire("Erro","Data de publicação é obrigatória","error"),!1;if(!this.editalAtual.data_limite_impugnacao)return this.$swal.fire("Erro","Prazo para impugnações é obrigatório","error"),!1;const a=new Date(this.editalAtual.data_publicacao),t=new Date(this.editalAtual.data_limite_impugnacao);if(t<=a)return this.$swal.fire({icon:"error",title:"Erro de Data",html:`\n              <p><strong>O prazo para impugnações deve ser posterior à data de publicação!</strong></p>\n              <br>\n              <p><strong>Data de Publicação:</strong> ${this.formatDate(a)}</p>\n              <p><strong>Prazo para Impugnações:</strong> ${this.formatDate(t)}</p>\n              <br>\n              <p>Por favor, ajuste as datas e tente novamente.</p>\n            `,confirmButtonText:"Entendi"}),!1;const e=new Date(a);if(e.setFullYear(e.getFullYear()+1),t>e){const a=this.$swal.fire({icon:"warning",title:"Prazo muito distante",text:"O prazo para impugnações está mais de 1 ano após a publicação. Tem certeza?",showCancelButton:!0,confirmButtonText:"Sim, continuar",cancelButtonText:"Cancelar"});if(!a.isConfirmed)return!1}return!0},validarDataLimite(){if(!this.editalAtual.data_publicacao||!this.editalAtual.data_limite_impugnacao)return;const a=new Date(this.editalAtual.data_publicacao),t=new Date(this.editalAtual.data_limite_impugnacao);t<=a&&(this.$swal.fire({icon:"warning",title:"Atenção!",text:"O prazo para impugnações deve ser posterior à data de publicação.",timer:3e3,toast:!0,position:"top-end",showConfirmButton:!1}),this.editalAtual.data_limite_impugnacao="")},async salvarEdital(){try{if(this.salvandoEdital=!0,!this.currentTenantId)throw new Error("Tenant ID não disponível");if(!this.validarDatas())return;const a={tenant_id:this.currentTenantId,numero:this.editalAtual.numero,descricao:this.editalAtual.descricao,conteudo:this.editalAtual.conteudo,status:this.editalAtual.status,data_publicacao:this.editalAtual.data_publicacao||(new Date).toISOString(),data_limite_impugnacao:this.editalAtual.data_limite_impugnacao,url_documento:this.editalAtual.url_documento,nome_arquivo:this.editalAtual.nome_arquivo};let t;if(this.modoEdicaoEdital){const{data:e,error:o}=await g.ND.from("editais").update(a).eq("id",this.editalAtual.id).select().single();t={data:e,error:o}}else{const{data:e,error:o}=await g.ND.from("editais").insert(a).select().single();t={data:e,error:o}}if(t.error)throw t.error;await this.carregarEditais(),this.fecharModalNovoEdital(),this.$swal.fire({icon:"success",title:this.modoEdicaoEdital?"Edital Atualizado!":"Edital Criado!",text:`Edital ${this.editalAtual.numero} ${this.modoEdicaoEdital?"atualizado":"criado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar edital:",a),this.$swal.fire("Erro","Erro ao salvar edital: "+a.message,"error")}finally{this.salvandoEdital=!1}},visualizarEdital(a){this.editalSelecionado={...a},this.modalVisualizarEdital=!0},fecharModalVisualizarEdital(){this.modalVisualizarEdital=!1,this.editalSelecionado={}},editarEdital(a){this.modoEdicaoEdital=!0,this.editalAtual={id:a.id,numero:a.numero,descricao:a.descricao,conteudo:a.conteudo||"",status:a.status,data_publicacao:a.data_publicacao?new Date(a.data_publicacao).toISOString().slice(0,16):"",data_limite_impugnacao:a.data_limite_impugnacao?new Date(a.data_limite_impugnacao).toISOString().slice(0,16):"",url_documento:a.url_documento||"",nome_arquivo:a.nome_arquivo||""},this.modalNovoEdital=!0},editarEditalSelecionado(){this.fecharModalVisualizarEdital(),this.editarEdital(this.editalSelecionado)},async duplicarEdital(a){try{const t=await this.$swal.fire({title:"Duplicar Edital",text:"Digite o número do novo edital:",input:"text",inputValue:"",inputPlaceholder:"Ex: 002/2024",showCancelButton:!0,confirmButtonText:"Duplicar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"Você precisa inserir um número!"}});if(t.isConfirmed){const e=t.value,o={tenant_id:this.currentTenantId,numero:e,descricao:a.descricao+" (Cópia)",conteudo:a.conteudo,status:"RASCUNHO",data_publicacao:(new Date).toISOString(),data_limite_impugnacao:a.data_limite_impugnacao},{error:i}=await g.ND.from("editais").insert(o);if(i)throw i;await this.carregarEditais(),this.$swal.fire("Sucesso!",`Edital ${e} criado com sucesso.`,"success")}}catch(t){console.error("Erro ao duplicar edital:",t),this.$swal.fire("Erro","Erro ao duplicar edital","error")}},async cancelarEdital(a){try{const t=await this.$swal.fire({title:"Cancelar Edital",text:`Tem certeza que deseja cancelar o edital ${a.numero}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, cancelar",cancelButtonText:"Não",confirmButtonColor:"#d33"});if(t.isConfirmed){const{error:t}=await g.ND.from("editais").update({status:"CANCELADO"}).eq("id",a.id);if(t)throw t;await this.carregarEditais(),this.$swal.fire("Cancelado!",`Edital ${a.numero} foi cancelado.`,"success")}}catch(t){console.error("Erro ao cancelar edital:",t),this.$swal.fire("Erro","Erro ao cancelar edital","error")}},gerenciarParticipantes(a){console.log("Abrindo modal de participantes para:",a.numero),this.criarModalParticipantes(a)},async criarModalParticipantes(a){const{data:t,error:e}=await g.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a.id).order("data_participacao",{ascending:!1});if(e)return console.error("Erro ao carregar participantes:",e),void this.$swal.fire("Erro","Erro ao carregar participantes","error");console.log("Participantes carregados:",t);const o=`\n          <div id="modal-participantes-custom" style="\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100vw;\n            height: 100vh;\n            background: rgba(0,0,0,0.8);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            z-index: 999999;\n          ">\n            <div style="\n              background: white;\n              border-radius: 12px;\n              width: 90%;\n              max-width: 1000px;\n              max-height: 80vh;\n              overflow-y: auto;\n              box-shadow: 0 10px 30px rgba(0,0,0,0.5);\n            ">\n              <div style="\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                padding: 20px 25px;\n                border-bottom: 1px solid #eee;\n                background: #f8f9fa;\n                border-radius: 12px 12px 0 0;\n              ">\n                <h3 style="margin: 0; color: #2c3e50;">👥 Participantes - ${a.numero}</h3>\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  background: none;\n                  border: none;\n                  font-size: 24px;\n                  cursor: pointer;\n                  color: #6c757d;\n                  width: 30px;\n                  height: 30px;\n                  border-radius: 50%;\n                ">&times;</button>\n              </div>\n              \n              <div style="padding: 25px;">\n                <div style="margin-bottom: 20px;">\n                  <h4>📊 Total de Participantes: ${t.length}</h4>\n                </div>\n                \n                ${t.length>0?`\n                  <div style="display: grid; gap: 15px;">\n                    ${t.map((a=>`\n                      <div style="\n                        border: 1px solid #ddd;\n                        border-radius: 8px;\n                        padding: 20px;\n                        background: #f9f9f9;\n                      ">\n                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">\n                          <h4 style="margin: 0; color: #2c3e50;">${a.razao_social}</h4>\n                          <span style="\n                            padding: 4px 12px;\n                            border-radius: 20px;\n                            font-size: 12px;\n                            font-weight: 600;\n                            background: ${this.getStatusColor(a.status)};\n                            color: white;\n                          ">${this.getStatusText(a.status)}</span>\n                        </div>\n                        \n                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 15px;">\n                          <p style="margin: 5px 0;"><strong>CNPJ:</strong> ${this.formatarCNPJSimples(a.cnpj)}</p>\n                          <p style="margin: 5px 0;"><strong>Representante:</strong> ${a.representante_legal}</p>\n                          <p style="margin: 5px 0;"><strong>Email:</strong> ${a.email}</p>\n                          <p style="margin: 5px 0;"><strong>Telefone:</strong> ${a.telefone||"N/A"}</p>\n                          <p style="margin: 5px 0;"><strong>Data Inscrição:</strong> ${this.formatDateSimples(a.data_participacao)}</p>\n                          ${a.data_envio_documentacao?`<p style="margin: 5px 0;"><strong>Data Documentação:</strong> ${this.formatDateSimples(a.data_envio_documentacao)}</p>`:""}\n                        </div>\n                        \n                        ${a.endereco?`\n                          <div style="margin-bottom: 15px;">\n                            <p style="margin: 5px 0;"><strong>📍 Endereço:</strong> ${a.endereco}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.observacoes?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #fff3cd;\n                            border: 1px solid #ffeaa7;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #856404;">💬 Observações da Empresa:</p>\n                            <p style="margin: 8px 0 0 0; color: #856404;">${a.observacoes}</p>\n                          </div>\n                        `:""}\n                        \n                        ${a.produtos_submetidos&&a.produtos_submetidos.length>0?`\n                          <div style="\n                            margin-bottom: 15px;\n                            padding: 12px;\n                            background: #d1ecf1;\n                            border: 1px solid #bee5eb;\n                            border-radius: 6px;\n                          ">\n                            <p style="margin: 0; font-weight: 600; color: #0c5460;">📦 Produtos Submetidos:</p>\n                            <ul style="margin: 8px 0 0 20px; color: #0c5460;">\n                              ${a.produtos_submetidos.map((a=>`<li>${a.nome||a}</li>`)).join("")}\n                            </ul>\n                          </div>\n                        `:""}\n                        \n                        <div style="margin-top: 15px;">\n                          <div style="display: flex; gap: 10px; margin-bottom: 10px;">\n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'APROVADO')" style="\n                              padding: 8px 16px;\n                              background: #28a745;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">✅ Aprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'REPROVADO')" style="\n                              padding: 8px 16px;\n                              background: #dc3545;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">❌ Reprovar</button>\n                            \n                            <button onclick="window.alterarStatusParticipante('${a.id}', 'EM_AVALIACAO')" style="\n                              padding: 8px 16px;\n                              background: #ffc107;\n                              color: #212529;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">🔄 Em Avaliação</button>\n                            \n                            <button onclick="window.adicionarObservacaoInterna('${a.id}')" style="\n                              padding: 8px 16px;\n                              background: #6f42c1;\n                              color: white;\n                              border: none;\n                              border-radius: 6px;\n                              cursor: pointer;\n                              font-size: 14px;\n                            ">📝 Adicionar Observação</button>\n                          </div>\n                          \n                          ${a.observacoes_internas?`\n                            <div style="\n                              padding: 12px;\n                              background: #e9ecef;\n                              border: 1px solid #ced4da;\n                              border-radius: 6px;\n                              margin-top: 10px;\n                            ">\n                              <p style="margin: 0; font-weight: 600; color: #495057;">🔒 Observações Internas da CPM:</p>\n                              <p style="margin: 8px 0 0 0; color: #495057; font-style: italic;">${a.observacoes_internas}</p>\n                            </div>\n                          `:""}\n                        </div>\n                      </div>\n                    `)).join("")}\n                  </div>\n                `:'\n                  <div style="text-align: center; padding: 40px; color: #6c757d;">\n                    <div style="font-size: 48px; margin-bottom: 20px;">👥</div>\n                    <h3>Nenhum participante encontrado</h3>\n                    <p>Ainda não há empresas inscritas neste edital.</p>\n                  </div>\n                '}\n              </div>\n              \n              <div style="\n                padding: 20px 25px;\n                border-top: 1px solid #eee;\n                display: flex;\n                justify-content: flex-end;\n              ">\n                <button onclick="document.getElementById('modal-participantes-custom').remove()" style="\n                  padding: 10px 20px;\n                  background: #6c757d;\n                  color: white;\n                  border: none;\n                  border-radius: 6px;\n                  cursor: pointer;\n                ">Fechar</button>\n              </div>\n            </div>\n          </div>\n        `;document.body.insertAdjacentHTML("beforeend",o),window.alterarStatusParticipante=async(t,o)=>{try{const{error:e}=await g.ND.from("participantes_editais").update({status:o}).eq("id",t);if(e)throw e;document.getElementById("modal-participantes-custom").remove(),this.$swal.fire("Sucesso!",`Status alterado para ${this.getStatusText(o)}`,"success"),await this.carregarEditais(),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}catch(e){console.error("Erro ao alterar status:",e),this.$swal.fire("Erro","Erro ao alterar status do participante","error")}},window.adicionarObservacaoInterna=async t=>{try{const e=await this.$swal.fire({title:"Observação Interna da CPM",text:"Esta observação será visível apenas para a equipe da CPM",input:"textarea",inputPlaceholder:"Digite suas observações sobre a análise deste participante...",showCancelButton:!0,confirmButtonText:"Salvar",cancelButtonText:"Cancelar",inputValidator:a=>{if(!a)return"Você precisa inserir uma observação!"}});if(e.isConfirmed){const o=e.value,{error:i}=await g.ND.from("participantes_editais").update({observacoes_internas:o}).eq("id",t);if(i)throw i;document.getElementById("modal-participantes-custom").remove(),this.$swal.fire("Sucesso!","Observação interna adicionada com sucesso","success"),setTimeout((()=>{this.criarModalParticipantes(a)}),500)}}catch(e){console.error("Erro ao adicionar observação:",e),this.$swal.fire("Erro","Erro ao adicionar observação interna","error")}}},getStatusColor(a){const t={INTERESSADO:"#17a2b8",DOCUMENTACAO_ENVIADA:"#ffc107",EM_AVALIACAO:"#fd7e14",APROVADO:"#28a745",REPROVADO:"#dc3545",DESISTENTE:"#6c757d"};return t[a]||"#6c757d"},getStatusText(a){const t={INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"Documentação Enviada",EM_AVALIACAO:"Em Avaliação",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return t[a]||a},formatarCNPJSimples(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatDateSimples(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A"},abrirDocumento(a){a&&"uploads/documento-exemplo.pdf"!==a?window.open(a,"_blank"):this.$swal.fire("Aviso","Documento não disponível","warning")},async baixarDocumento(a){if(a.url_documento&&"uploads/documento-exemplo.pdf"!==a.url_documento)try{this.$swal.fire({title:"Preparando download...",text:"Aguarde um momento",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const t=document.createElement("a");t.href=a.url_documento,t.download=a.nome_arquivo||`edital_${a.numero}.pdf`,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t),this.$swal.close()}catch(t){console.error("Erro no download:",t),this.$swal.fire({icon:"error",title:"Erro no download",text:"Não foi possível baixar o arquivo. Tente novamente."})}else this.$swal.fire("Aviso","Documento não disponível para download","warning")},async handleFileUpload(a){const t=a.target.files[0];if(t){if("application/pdf"!==t.type)return this.$swal.fire("Erro","Apenas arquivos PDF são permitidos","error"),void(a.target.value="");if(t.size>10485760)return this.$swal.fire("Erro","Arquivo muito grande. Máximo 10MB","error"),void(a.target.value="");try{this.$swal.fire({title:"Fazendo upload...",text:"Aguarde enquanto o arquivo é enviado",allowOutsideClick:!1,didOpen:()=>{this.$swal.showLoading()}});const a=Date.now(),e=localStorage.getItem("tenant_id")||"default",o=`edital_${a}_${t.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,i=`${e}/editais/${o}`,{data:s,error:r}=await g.ND.storage.from("editais").upload(i,t,{cacheControl:"3600",upsert:!1});if(r)throw console.error("Erro no upload:",r),r;const{data:n}=g.ND.storage.from("editais").getPublicUrl(i);if(!n?.publicUrl)throw new Error("Não foi possível obter URL do arquivo");this.editalAtual.url_documento=n.publicUrl,this.editalAtual.nome_arquivo=t.name,this.$swal.fire({icon:"success",title:"Upload realizado!",text:"Arquivo PDF enviado com sucesso",timer:2e3})}catch(e){if(console.error("Erro no upload:",e),e.message?.includes("Bucket not found")||404===e.statusCode)try{return await this.criarBucketEditais(),void await this.handleFileUpload(a)}catch(o){console.error("Erro ao criar bucket:",o)}this.$swal.fire({icon:"error",title:"Erro no upload",text:"Não foi possível enviar o arquivo. Tente novamente.",footer:e.message||"Erro desconhecido"}),a.target.value=""}}},async criarBucketEditais(){try{const{data:a,error:t}=await g.ND.storage.createBucket("editais",{public:!0,fileSizeLimit:10485760,allowedMimeTypes:["application/pdf"]});if(t&&!t.message.includes("already exists"))throw t;console.log("Bucket editais criado/verificado com sucesso")}catch(a){throw console.error("Erro ao criar bucket editais:",a),a}},async carregarParticipantes(a){try{console.log("Carregando participantes para edital ID:",a),console.log("Tenant ID:",this.currentTenantId),this.loadingParticipantes=!0;const{data:t,error:e}=await g.ND.from("participantes_editais").select("*").eq("tenant_id",this.currentTenantId).eq("edital_id",a).order("data_participacao",{ascending:!1});if(e)throw e;console.log("Participantes carregados:",t),this.participantes=t||[],this.aplicarFiltrosParticipantes()}catch(t){console.error("Erro ao carregar participantes:",t),this.$swal.fire("Erro","Erro ao carregar participantes: "+t.message,"error")}finally{this.loadingParticipantes=!1}},aplicarFiltrosParticipantes(){let a=[...this.participantes];if(this.filtroParticipantes.busca){const t=this.filtroParticipantes.busca.toLowerCase();a=a.filter((a=>a.razao_social.toLowerCase().includes(t)||a.cnpj.includes(t)||a.representante_legal.toLowerCase().includes(t)||a.email.toLowerCase().includes(t)))}this.filtroParticipantes.status&&(a=a.filter((a=>a.status===this.filtroParticipantes.status))),this.participantesFiltrados=a},formatarCNPJ(a){return a?a.includes(".")?a:a.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/,"$1.$2.$3/$4-$5"):""},formatarStatus(a){const t={INTERESSADO:"Interessado",DOCUMENTACAO_ENVIADA:"Documentação Enviada",EM_AVALIACAO:"Em Avaliação",APROVADO:"Aprovado",REPROVADO:"Reprovado",DESISTENTE:"Desistente"};return t[a]||a},getStatusClass(a){const t={INTERESSADO:"status-interessado",DOCUMENTACAO_ENVIADA:"status-documentacao",EM_AVALIACAO:"status-avaliacao",APROVADO:"status-aprovado",REPROVADO:"status-reprovado",DESISTENTE:"status-desistente"};return t[a]||"status-default"},abrirModalNovoParticipante(){this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]},this.modalNovoParticipante=!0},fecharModalParticipantes(){this.modalParticipantes=!1,this.editalSelecionado={},this.participantes=[],this.participantesFiltrados=[],this.filtroParticipantes={busca:"",status:""}},fecharModalNovoParticipante(){this.modalNovoParticipante=!1,this.participanteAtual={id:null,razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",status:"INTERESSADO",observacoes:"",produtos_submetidos:[]}},async salvarParticipante(){try{if(!this.participanteAtual.razao_social||!this.participanteAtual.cnpj||!this.participanteAtual.representante_legal||!this.participanteAtual.email)return void this.$swal.fire("Erro","Preencha todos os campos obrigatórios","error");const a={tenant_id:this.currentTenantId,edital_id:this.editalSelecionado.id,razao_social:this.participanteAtual.razao_social,cnpj:this.participanteAtual.cnpj,representante_legal:this.participanteAtual.representante_legal,email:this.participanteAtual.email,telefone:this.participanteAtual.telefone,endereco:this.participanteAtual.endereco,status:this.participanteAtual.status,observacoes:this.participanteAtual.observacoes,produtos_submetidos:this.participanteAtual.produtos_submetidos};let t;if(this.participanteAtual.id){const{data:e,error:o}=await g.ND.from("participantes_editais").update(a).eq("id",this.participanteAtual.id).select().single();t={data:e,error:o}}else{const{data:e,error:o}=await g.ND.from("participantes_editais").insert(a).select().single();t={data:e,error:o}}if(t.error)throw t.error;await this.carregarParticipantes(this.editalSelecionado.id),this.fecharModalNovoParticipante(),this.$swal.fire({icon:"success",title:"Participante salvo!",text:`${this.participanteAtual.razao_social} foi ${this.participanteAtual.id?"atualizado":"adicionado"} com sucesso.`,timer:2e3})}catch(a){console.error("Erro ao salvar participante:",a),this.$swal.fire("Erro","Erro ao salvar participante: "+a.message,"error")}},editarParticipante(a){this.participanteAtual={...a},this.modalNovoParticipante=!0},async removerParticipante(a){try{const t=await this.$swal.fire({title:"Remover Participante",text:`Tem certeza que deseja remover ${a.razao_social}?`,icon:"warning",showCancelButton:!0,confirmButtonText:"Sim, remover",cancelButtonText:"Cancelar",confirmButtonColor:"#d33"});if(t.isConfirmed){const{error:t}=await g.ND.from("participantes_editais").delete().eq("id",a.id);if(t)throw t;await this.carregarParticipantes(this.editalSelecionado.id),await this.carregarEditais(),this.$swal.fire("Removido!","Participante removido com sucesso.","success")}}catch(t){console.error("Erro ao remover participante:",t),this.$swal.fire("Erro","Erro ao remover participante: "+t.message,"error")}}}},R=S;var I=(0,r.A)(R,A,N,!1,null,"561d54de",null);const $=I.exports,k={name:"Dashboard",components:{DashboardCPM:$},data(){return{showDropdown:!1,usuarioNome:"Usuário",usuarioEmail:"",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await g.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuário:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},T=k;var B=(0,r.A)(T,x,P,!1,null,"49a774eb",null);const M=B.exports;var F=function(){var a=this,t=a._self._c;return t("div",{staticClass:"cadastro-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("▼")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("CadastroProduto")],1)])},O=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])}],z=function(){var a=this,t=a._self._c;return t("div",{staticClass:"cadastro-produto"},[t("h2",[a._v("Cadastro de Produto")]),t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarProduto.apply(null,arguments)}}},[t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome do Produto*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.nome,expression:"produto.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.produto.nome},on:{input:function(t){t.target.composing||a.$set(a.produto,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.grupo_id,expression:"produto.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.produto,"grupo_id",t.target.multiple?e:e[0])},a.onGrupoChange]}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nome)+" ")])}))],2)])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"classe"}},[a._v("Classe*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produto.classe_id,expression:"produto.classe_id"}],attrs:{id:"classe",required:"",disabled:!a.produto.grupo_id||0===a.classes.length},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.produto,"classe_id",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.filteredClasses,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nome)+" ")])}))],2),a.produto.grupo_id&&0===a.filteredClasses.length?t("div",{staticClass:"info-text"},[a._v(" Não há classes disponíveis para este grupo. Por favor, cadastre uma classe primeiro. ")]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"marca"}},[a._v("Marca*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.marca,expression:"produto.marca"}],attrs:{id:"marca",type:"text",required:""},domProps:{value:a.produto.marca},on:{input:function(t){t.target.composing||a.$set(a.produto,"marca",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"modelo"}},[a._v("Modelo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.modelo,expression:"produto.modelo"}],attrs:{id:"modelo",type:"text",required:""},domProps:{value:a.produto.modelo},on:{input:function(t){t.target.composing||a.$set(a.produto,"modelo",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"fabricante"}},[a._v("Fabricante*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.fabricante,expression:"produto.fabricante"}],attrs:{id:"fabricante",type:"text",required:""},domProps:{value:a.produto.fabricante},on:{input:function(t){t.target.composing||a.$set(a.produto,"fabricante",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cnpj"}},[a._v("CNPJ*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.cnpjFormatado,expression:"cnpjFormatado"}],attrs:{id:"cnpj",type:"text",required:"",maxlength:"18",placeholder:"00.000.000/0000-00"},domProps:{value:a.cnpjFormatado},on:{input:[function(t){t.target.composing||(a.cnpjFormatado=t.target.value)},a.formatarCNPJ]}}),a.cnpjInvalido?t("small",{staticClass:"error-text"},[a._v("CNPJ inválido. Formato: 00.000.000/0000-00")]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email_fornecedor"}},[a._v("Email do Fornecedor*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.email_fornecedor,expression:"produto.email_fornecedor"}],attrs:{id:"email_fornecedor",type:"email",required:"",placeholder:"contato@empresa.com"},domProps:{value:a.produto.email_fornecedor},on:{input:function(t){t.target.composing||a.$set(a.produto,"email_fornecedor",t.target.value)}}}),t("small",{staticClass:"info-text"},[a._v("Email para comunicações sobre diligências")])])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"origem"}},[a._v("Origem")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.origem,expression:"produto.origem"}],attrs:{id:"origem",type:"text",placeholder:"Nacional ou Importado"},domProps:{value:a.produto.origem},on:{input:function(t){t.target.composing||a.$set(a.produto,"origem",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"registro_anvisa"}},[a._v("Registro na Anvisa/MS")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.registro_anvisa,expression:"produto.registro_anvisa"}],attrs:{id:"registro_anvisa",type:"text",placeholder:"Número do registro"},domProps:{value:a.produto.registro_anvisa},on:{input:function(t){t.target.composing||a.$set(a.produto,"registro_anvisa",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cbpf"}},[a._v("CBPF")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.cbpf,expression:"produto.cbpf"}],attrs:{id:"cbpf",type:"text",placeholder:"Certificado de Boas Práticas de Fabricação"},domProps:{value:a.produto.cbpf},on:{input:function(t){t.target.composing||a.$set(a.produto,"cbpf",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"codigo_material"}},[a._v("Código do Material")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.produto.codigo_material,expression:"produto.codigo_material"}],attrs:{id:"codigo_material",type:"text",placeholder:"Código interno do material"},domProps:{value:a.produto.codigo_material},on:{input:function(t){t.target.composing||a.$set(a.produto,"codigo_material",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descrição")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.produto.descricao,expression:"produto.descricao"}],attrs:{id:"descricao",rows:"4"},domProps:{value:a.produto.descricao},on:{input:function(t){t.target.composing||a.$set(a.produto,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Documentos (apenas PDF)")]),t("div",{staticClass:"file-upload"},[t("input",{attrs:{type:"file",multiple:"",accept:".pdf"},on:{change:a.onFileSelect}})]),t("small",{staticClass:"info-text"},[a._v("Apenas arquivos PDF são aceitos (máx. 10MB por arquivo)")]),a.selectedFiles.length>0?t("div",{staticClass:"selected-files"},[t("p",[a._v("Arquivos selecionados:")]),t("ul",a._l(a.selectedFiles,(function(e,o){return t("li",{key:o,class:{"arquivo-invalido":!a.validarArquivoPDF(e)}},[a._v(" "+a._s(e.name)+" "),a.validarArquivoPDF(e)?a._e():t("span",{staticClass:"error-text"},[a._v("(Formato inválido - apenas PDF permitido)")])])})),0)]):a._e(),a.arquivosInvalidos.length>0?t("div",{staticClass:"error-text"},[t("p",[a._v("Os seguintes arquivos não serão enviados (apenas PDF permitido):")]),t("ul",a._l(a.arquivosInvalidos,(function(e,o){return t("li",{key:o},[a._v(" "+a._s(e.name)+" ")])})),0)]):a._e()]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},q=[];const L={name:"CadastroProduto",data(){return{produto:{nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",email_fornecedor:"",origem:"",registro_anvisa:"",cbpf:"",codigo_material:"",descricao:"",status:"pendente"},cnpjFormatado:"",cnpjInvalido:!1,grupos:[],classes:[],selectedFiles:[],arquivosInvalidos:[],loading:!1,currentTenantId:null}},computed:{filteredClasses(){return this.produto.grupo_id?this.classes.filter((a=>a.grupo_id===this.produto.grupo_id)):[]}},async created(){this.carregarGrupos(),await this.obterTenantId()},methods:{async obterTenantId(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;if(!t)throw new Error("Usuário não autenticado");if(t?.user_metadata?.tenant_id)return console.log("Obteve tenant_id dos metadados:",t.user_metadata.tenant_id),void(this.currentTenantId=t.user_metadata.tenant_id);const{data:e,error:o}=await g.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(console.log("Busca de tenant_id na tabela usuarios:",{userData:e,userError:o}),e&&e.tenant_id){console.log("Obteve tenant_id da tabela usuarios:",e.tenant_id),this.currentTenantId=e.tenant_id;const{error:a}=await g.ND.auth.updateUser({data:{tenant_id:e.tenant_id}});return void(a?console.error("Erro ao atualizar metadados do usuário:",a):console.log("Metadados do usuário atualizados com sucesso"))}const i=(0,f.A)();console.log("Gerando novo tenant_id:",i);const{error:s}=await g.ND.from("usuarios").insert({id:(0,f.A)(),email:t.email,tenant_id:i,ativo:!0});s&&console.error("Erro ao inserir novo tenant_id na tabela usuarios:",s);const{error:r}=await g.ND.auth.updateUser({data:{tenant_id:i}});r?console.error("Erro ao atualizar metadados do usuário:",r):console.log("Metadados do usuário atualizados com novo tenant_id"),this.currentTenantId=i}catch(a){console.error("Erro ao obter tenant_id:",a),alert("Erro ao obter identificação do tenant. Por favor, faça login novamente."),this.$router.push("/")}},async carregarGrupos(){try{const{data:a,error:t}=await g.ND.from("grupos").select("*").order("nome");if(t)throw t;a&&a.length>0?this.grupos=a:this.grupos=[{id:1,nome:"Equipamentos Médicos"},{id:2,nome:"Equipamentos Odontológicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escritório"},{id:5,nome:"Equipamentos de Informática"},{id:6,nome:"Mobiliário"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laboratório"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar grupos:",a),this.grupos=[{id:1,nome:"Equipamentos Médicos"},{id:2,nome:"Equipamentos Odontológicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escritório"},{id:5,nome:"Equipamentos de Informática"},{id:6,nome:"Mobiliário"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laboratório"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},onGrupoChange(){this.carregarClasses()},async carregarClasses(){try{const{data:a,error:t}=await g.ND.from("classes").select("*").eq("grupo_id",this.produto.grupo_id).order("nome");if(t)throw t;a&&a.length>0?this.classes=a:this.classes=[{id:1,nome:"Equipamentos Médicos"},{id:2,nome:"Equipamentos Odontológicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escritório"},{id:5,nome:"Equipamentos de Informática"},{id:6,nome:"Mobiliário"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laboratório"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}catch(a){console.error("Erro ao carregar classes:",a),this.classes=[{id:1,nome:"Equipamentos Médicos"},{id:2,nome:"Equipamentos Odontológicos"},{id:3,nome:"Materiais Hospitalares"},{id:4,nome:"Materiais de Escritório"},{id:5,nome:"Equipamentos de Informática"},{id:6,nome:"Mobiliário"},{id:7,nome:"Medicamentos"},{id:8,nome:"Material de Laboratório"},{id:9,nome:"Equipamentos Administrativos"},{id:10,nome:"Outros"}]}},formatarCNPJ(a){let t=a.target.value.replace(/\D/g,"");t=t.substring(0,14),t.length>0&&(t=t.replace(/^(\d{2})(\d)/,"$1.$2"),t=t.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),t=t.replace(/\.(\d{3})(\d)/,".$1/$2"),t=t.replace(/(\d{4})(\d)/,"$1-$2")),this.cnpjFormatado=t,this.produto.cnpj=this.cnpjFormatado.replace(/\D/g,""),this.validarCNPJ()},validarCNPJ(){const a=this.produto.cnpj;return 14!==a.length||/^(\d)\1+$/.test(a)?(this.cnpjInvalido=!0,!1):(this.cnpjInvalido=!1,!0)},onFileSelect(a){const t=Array.from(a.target.files);this.arquivosInvalidos=[],this.selectedFiles=t.filter((a=>{const t=this.validarArquivoPDF(a);return t||this.arquivosInvalidos.push(a),t}))},validarArquivoPDF(a){const t=a.name.split(".").pop().toLowerCase(),e=a.type.toLowerCase();return"pdf"===t&&"application/pdf"===e},sanitizarNomeArquivo(a){let t=a.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(t=t.replace(/[^a-zA-Z0-9_.]/g,"_"),t.length>100){const a=t.split(".").pop();t=t.substring(0,90)+"."+a}return t},async salvarProduto(){if(this.validarFormulario())try{if(this.loading=!0,this.currentTenantId||await this.obterTenantId(),console.log("Salvando produto com tenant_id:",this.currentTenantId),!this.validarCNPJ())return this.$swal({icon:"error",title:"CNPJ Inválido",text:"Por favor, informe um CNPJ válido no formato 00.000.000/0000-00"}),void(this.loading=!1);const a={nome:this.produto.nome,descricao:this.produto.descricao,grupo_id:this.produto.grupo_id,classe_id:this.produto.classe_id,marca:this.produto.marca,modelo:this.produto.modelo,fabricante:this.produto.fabricante,cnpj:this.produto.cnpj,email_fornecedor:this.produto.email_fornecedor,origem:this.produto.origem,registro_anvisa:this.produto.registro_anvisa,cbpf:this.produto.cbpf,codigo_material:this.produto.codigo_material,status:"pendente",tenant_id:this.currentTenantId};console.log("Objeto produto a ser inserido:",a);const{data:t,error:e}=await g.ND.from("produtos").insert(a).select().single();if(e)throw console.error("Erro detalhado ao salvar produto:",e),new Error(`Erro ao salvar produto: ${e.message}`);console.log("Produto inserido com sucesso:",t);const o=this.selectedFiles.filter((a=>this.validarArquivoPDF(a)));if(o.length>0){const a=t.id;for(const t of o){const e=t.name,o=this.sanitizarNomeArquivo(t.name),i=`${Date.now()}-${o}`;console.log(`Upload de arquivo: Original "${e}" -> Sanitizado "${o}"`);const{data:s,error:r}=await g.ND.storage.from("documentos").upload(i,t);if(r){console.error("Erro ao fazer upload do arquivo:",r);continue}const{data:n}=g.ND.storage.from("documentos").getPublicUrl(i),l=n?.publicUrl||"",c={tenant_id:this.currentTenantId,produto_id:a,nome:e,tipo:t.type,arquivo_url:l},{error:d}=await g.ND.from("documentos").insert(c);d&&console.error("Erro ao registrar documento:",d)}}this.arquivosInvalidos.length>0?this.$swal({icon:"warning",title:"Produto salvo com ressalvas",text:`O produto foi salvo, mas ${this.arquivosInvalidos.length} arquivo(s) não foi(ram) enviado(s) por não serem PDFs válidos.`}):this.$swal({icon:"success",title:"Produto salvo com sucesso!",text:"O produto foi cadastrado e está aguardando aprovação."}),this.limparFormulario()}catch(a){console.error("Erro no processo de salvamento:",a),this.$swal({icon:"error",title:"Erro ao salvar produto",text:a.message||"Ocorreu um erro ao tentar salvar o produto."})}finally{this.loading=!1}},limparFormulario(){this.produto={nome:"",grupo_id:"",classe_id:"",marca:"",modelo:"",fabricante:"",cnpj:"",origem:"",registro_anvisa:"",cbpf:"",codigo_material:"",descricao:"",status:"pendente"},this.cnpjFormatado="",this.cnpjInvalido=!1,this.selectedFiles=[],this.arquivosInvalidos=[]},validarFormulario(){return this.produto.nome&&""!==this.produto.nome.trim()?this.produto.grupo_id?this.produto.classe_id?this.produto.descricao&&""!==this.produto.descricao.trim()?this.validarCNPJ()?(this.arquivosInvalidos.length>0&&this.$swal({icon:"error",title:"Arquivos inválidos",text:"Alguns arquivos selecionados não são PDFs válidos e não serão enviados."}),!0):(this.$swal({icon:"error",title:"Erro de validação",text:"O CNPJ informado é inválido"}),!1):(this.$swal({icon:"error",title:"Erro de validação",text:"A descrição do produto é obrigatória"}),!1):(this.$swal({icon:"error",title:"Erro de validação",text:"Selecione uma classe para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de validação",text:"Selecione um grupo para o produto"}),!1):(this.$swal({icon:"error",title:"Erro de validação",text:"O nome do produto é obrigatório"}),!1)},convertToUUID(a){if(!a)return null;const t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;if(t.test(a))return console.log("categoria_id já é um UUID válido:",a),a;const e=parseInt(a,10);if(isNaN(e))return console.warn("categoria_id não é um número nem UUID válido:",a),(0,f.A)();const o=`00000000-0000-0000-0000-${e.toString().padStart(12,"0")}`;return console.log(`Converteu categoria_id ${a} para UUID: ${o}`),o}}},U=L;var V=(0,r.A)(U,z,q,!1,null,"bed0857e",null);const j=V.exports,H={name:"Cadastro",components:{CadastroProduto:j},data(){return{showDropdown:!1,modalEmailAberto:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await g.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuário:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},J=H;var G=(0,r.A)(J,F,O,!1,null,"7cb6a01b",null);const K=G.exports;var Y=function(){var a=this,t=a._self._c;return t("div",{staticClass:"analise-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("▼")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("AnaliseProduto",{attrs:{id:a.produtoId}})],1)])},Z=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])}],Q=function(){var a=this,t=a._self._c;return t("div",{staticClass:"analise-container"},[a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando...")])]):a.produto?t("div",{staticClass:"produto-analise"},[t("h2",[a._v("Análise de Produto")]),t("div",{staticClass:"produto-info"},[t("div",{staticClass:"produto-header"},[t("h3",[a._v(a._s(a.produto.nome))]),t("div",{staticClass:"produto-actions"},["pendente"===a.produto.status?t("button",{staticClass:"btn-diligencia",on:{click:function(t){return a.solicitarDiligencia(a.produto.id)}}},[a._v(" 🔍 Solicitar Diligência ")]):a._e(),"diligencia"===a.produto.status?t("button",{staticClass:"btn-ver-diligencias",on:{click:function(t){return a.visualizarDiligencias(a.produto.id)}}},[a._v(" 📋 Ver Diligências ")]):a._e()])]),t("div",{staticClass:"info-grid"},[t("div",{staticClass:"info-item"},[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produto.marca)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produto.modelo)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produto.fabricante)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produto.cnpj)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Origem:")]),a._v(" "+a._s(a.produto.origem||"Não informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Registro na Anvisa/MS:")]),a._v(" "+a._s(a.produto.registro_anvisa||"Não informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CBPF:")]),a._v(" "+a._s(a.produto.cbpf||"Não informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Código do Material:")]),a._v(" "+a._s(a.produto.codigo_material||"Não informado")+" ")]),t("div",{staticClass:"info-item full-width"},[t("strong",[a._v("Descrição:")]),a._v(" "+a._s(a.produto.descricao||"Não informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Status Atual:")]),t("span",{staticClass:"status-pill",class:a.getStatusClass(a.produto.status)},[a._v(" "+a._s(a.produto.status)+" ")])]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Data de Cadastro:")]),a._v(" "+a._s(a.formatDate(a.produto.criado_em))+" ")])])]),a.documentos.length>0?t("div",{staticClass:"documentos-section"},[t("h3",[a._v("Documentos")]),t("div",{staticClass:"documentos-list"},a._l(a.documentos,(function(e){return t("div",{key:e.id,staticClass:"documento-item"},[t("div",{staticClass:"doc-icon"},[a._v("📄")]),t("div",{staticClass:"doc-info"},[t("p",{staticClass:"doc-name"},[a._v(a._s(e.nome))]),t("p",{staticClass:"doc-type"},[a._v(a._s(e.tipo))])]),t("a",{staticClass:"doc-action",attrs:{href:e.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),t("div",{staticClass:"analise-form"},[t("h3",[a._v("Parecer Técnico")]),t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarAnalise.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"parecer"}},[a._v("Observações / Parecer")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.parecer,expression:"analise.parecer"}],attrs:{id:"parecer",rows:"4",required:""},domProps:{value:a.analise.parecer},on:{input:function(t){t.target.composing||a.$set(a.analise,"parecer",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",[a._v("Decisão")]),t("div",{staticClass:"radio-group"},[t("label",{staticClass:"radio-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"aprovado",required:""},domProps:{checked:a._q(a.analise.status,"aprovado")},on:{change:function(t){return a.$set(a.analise,"status","aprovado")}}}),a._v(" Aprovar ")]),t("label",{staticClass:"radio-label"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.analise.status,expression:"analise.status"}],attrs:{type:"radio",value:"reprovado",required:""},domProps:{checked:a._q(a.analise.status,"reprovado")},on:{change:function(t){return a.$set(a.analise,"status","reprovado")}}}),a._v(" Reprovar ")])])]),"reprovado"===a.analise.status?t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"motivacao"}},[a._v("Motivação da Reprovação")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.analise.motivacao,expression:"analise.motivacao"}],attrs:{id:"motivacao",rows:"6",placeholder:"Descreva detalhadamente os motivos que levaram à reprovação deste produto",required:""},domProps:{value:a.analise.motivacao},on:{input:function(t){t.target.composing||a.$set(a.analise,"motivacao",t.target.value)}}}),t("small",{staticClass:"helper-text"},[a._v("Este campo será exibido ao fornecedor para justificar a reprovação do produto")])]):a._e(),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.submitting}},[a._v(" "+a._s(a.submitting?"Salvando...":"Salvar Análise")+" ")]),t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.voltar}},[a._v(" Voltar ")])])])]),a.analisesAnteriores.length>0?t("div",{staticClass:"analises-anteriores"},[t("h3",[a._v("Análises Anteriores")]),a._l(a.analisesAnteriores,(function(e){return t("div",{key:e.id,staticClass:"analise-historico"},[t("div",{staticClass:"analise-header"},[t("span",{staticClass:"status-pill",class:a.getStatusClass(e.status)},[a._v(a._s(e.status))]),t("span",{staticClass:"analise-data"},[a._v(a._s(a.formatDate(e.criado_em)))])]),t("div",{staticClass:"analise-conteudo"},[t("p",[a._v(a._s(e.parecer))]),"reprovado"===e.status&&e.motivacao?t("div",{staticClass:"motivacao-reprovacao"},[t("h4",[a._v("Motivação da Reprovação:")]),t("p",[a._v(a._s(e.motivacao))])]):a._e()])])}))],2):a._e()]):t("div",{staticClass:"not-found"},[t("p",[a._v("Produto não encontrado ou você não tem permissão para visualizá-lo.")]),t("button",{staticClass:"btn-secondary",on:{click:a.voltar}},[a._v("Voltar")])])])},W=[],X=e(676);const aa={from:{email:"cpm@suaorganizacao.com.br",name:"CPM - Comissão de Padronização de Materiais"},provider:{apiKey:{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_API_KEY,apiUrl:"https://api.sendgrid.v3/mail/send"}},ta={diligencia:{subject:"Diligência Solicitada - Produto em Análise",template:a=>`\n      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">\n        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; text-align: center;">\n          <h1>📋 Diligência Solicitada</h1>\n          <p>Comissão de Padronização de Materiais</p>\n        </div>\n        \n        <div style="padding: 30px; background: #f8f9fa;">\n          <h2 style="color: #333;">Prezado(a) Fornecedor,</h2>\n          \n          <p>Foi solicitada uma <strong>diligência</strong> para o produto em análise:</p>\n          \n          <div style="background: white; padding: 20px; border-left: 4px solid #667eea; margin: 20px 0;">\n            <h3 style="color: #667eea; margin-top: 0;">📦 Dados do Produto:</h3>\n            <p><strong>Nome:</strong> ${a.produto.nome}</p>\n            <p><strong>Marca:</strong> ${a.produto.marca}</p>\n            <p><strong>Modelo:</strong> ${a.produto.modelo}</p>\n            <p><strong>Fabricante:</strong> ${a.produto.fabricante}</p>\n          </div>\n          \n          <div style="background: #fff3cd; padding: 20px; border-left: 4px solid #ffc107; margin: 20px 0;">\n            <h3 style="color: #856404; margin-top: 0;">⚠️ Tipo de Diligência:</h3>\n            <p><strong>${a.diligencia.tipo}</strong></p>\n            <p>${a.diligencia.descricao}</p>\n          </div>\n          \n          <div style="background: #f8d7da; padding: 20px; border-left: 4px solid #dc3545; margin: 20px 0;">\n            <h3 style="color: #721c24; margin-top: 0;">⏰ Prazo para Resposta:</h3>\n            <p><strong>${a.diligencia.prazo_dias} dias úteis</strong></p>\n            <p><strong>Data Limite:</strong> ${new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR")}</p>\n          </div>\n          \n          <div style="background: #d4edda; padding: 20px; border-left: 4px solid #28a745; margin: 20px 0;">\n            <h3 style="color: #155724; margin-top: 0;">📝 Instruções:</h3>\n            <ul>\n              <li>Responda a esta diligência dentro do prazo estabelecido</li>\n              <li>Envie todos os documentos solicitados em formato PDF</li>\n              <li>Em caso de dúvidas, entre em contato conosco</li>\n              <li>O não atendimento da diligência pode resultar na reprovação do produto</li>\n            </ul>\n          </div>\n          \n          <div style="text-align: center; margin: 30px 0;">\n            <p style="color: #666;">Para responder esta diligência, entre em contato através do nosso sistema ou envie os documentos por email.</p>\n          </div>\n          \n          <hr style="border: none; border-top: 1px solid #ddd; margin: 30px 0;">\n          \n          <div style="color: #666; font-size: 12px;">\n            <p><strong>CPM - Comissão de Padronização de Materiais</strong></p>\n            <p>Este é um email automático. Não responda diretamente a este email.</p>\n            <p>Data de envio: ${(new Date).toLocaleDateString("pt-BR")} às ${(new Date).toLocaleTimeString("pt-BR")}</p>\n          </div>\n        </div>\n      </div>\n    `}};async function ea(a){try{console.log("📧 Iniciando envio de email de diligência...",a);try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);t.emailRemetente&&(aa.from.email=t.emailRemetente),t.nomeRemetente&&(aa.from.name=t.nomeRemetente)}}catch(t){console.error("Erro ao carregar configurações do usuário:",t)}if(!a.produto||!a.diligencia||!a.destinatario)throw new Error("Dados incompletos para envio do email");const i={personalizations:[{to:[{email:a.destinatario,name:a.produto.fabricante}]}],from:{email:aa.from.email,name:aa.from.name},subject:ta.diligencia.subject,content:[{type:"text/html",value:ta.diligencia.template(a)}]},{data:s,error:r}=await g.ND.from("emails_enviados").insert({tipo:"diligencia",destinatario:a.destinatario,assunto:ta.diligencia.subject,produto_id:a.produto.id,diligencia_id:a.diligencia.id,status:"enviando",tentativas:1}).select().single();if(r&&console.error("❌ Erro ao registrar log de email:",r),"sendgrid"==={NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_EMAIL_PROVIDER&&{NODE_ENV:"production",BASE_URL:"/ComprarBem/"}.VUE_APP_SENDGRID_API_KEY){console.log("📧 Enviando email via EmailJS (usando SendGrid configurado)...");try{const t={to_email:a.destinatario,fabricante:a.produto.fabricante,produto_nome:a.produto.nome,produto_marca:a.produto.marca,produto_modelo:a.produto.modelo,cnpj:a.produto.cnpj||"Não informado",tipo_diligencia:a.diligencia.tipo,descricao_diligencia:a.diligencia.descricao,prazo_dias:"30",data_limite:new Date(a.diligencia.data_limite).toLocaleDateString("pt-BR"),data_envio:(new Date).toLocaleDateString("pt-BR")+" às "+(new Date).toLocaleTimeString("pt-BR"),nome_responsavel:"William Martins",cargo_responsavel:"Analista CPM",email_responsavel:"comprarbemteste@gmail.com"};console.log("📧 Enviando email via EmailJS..."),console.log("📧 Dados preparados:",t);const o={serviceId:"service_7sv1naw",templateId:"template_vbp986f",publicKey:"DqGKMNJ87ch3qVxGv"};try{console.log("📧 Enviando email REAL via EmailJS..."),console.log("📧 Configuração:",o),console.log("📧 Dados:",t);const a=await X.Ay.send(o.serviceId,o.templateId,t,o.publicKey);console.log("🎉 EMAIL ENVIADO COM SUCESSO!",a)}catch(e){throw console.error("❌ Erro no EmailJS:",e),e}return s&&await g.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString(),corpo:t.message}).eq("id",s.id),console.log("✅ EMAIL PREPARADO COM SUCESSO!"),console.log("📧 Para:",t.to_email),console.log("📧 Assunto:",t.subject),{success:!0,message:"Email preparado com sucesso! (SendGrid configurado)",emailId:s?.id}}catch(o){return console.error("❌ Erro ao preparar email:",o),s&&await g.ND.from("emails_enviados").update({status:"desenvolvimento",data_envio:(new Date).toISOString(),erro_detalhes:"Erro na preparação do email"}).eq("id",s.id),{success:!0,message:"Diligência criada (modo desenvolvimento)",emailId:s?.id,development:!0}}}return console.log("🔄 Modo desenvolvimento - Simulando envio de email"),console.log("📧 Email Data:",i),await new Promise((a=>setTimeout(a,1e3))),s&&await g.ND.from("emails_enviados").update({status:"enviado",data_envio:(new Date).toISOString()}).eq("id",s.id),{success:!0,message:"Email enviado com sucesso (simulado)",emailId:s?.id}}catch(t){return console.error("❌ Erro ao enviar email de diligência:",t),{success:!1,message:t.message||"Erro interno no envio do email",error:t}}}const oa={name:"AnaliseProduto",props:{id:{type:String,required:!0}},data(){return{produto:null,documentos:[],analisesAnteriores:[],analise:{parecer:"",status:"",motivacao:""},loading:!0,submitting:!1}},created(){this.carregarDados()},methods:{async carregarDados(){try{this.loading=!0;const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("id",this.id).single();if(t)throw t;this.produto=a;const{data:e,error:o}=await g.ND.from("documentos").select("*").eq("produto_id",this.id);if(o)throw o;this.documentos=e||[];const{data:i,error:s}=await g.ND.from("analises").select("*").eq("produto_id",this.id).order("criado_em",{ascending:!1});if(s)throw s;this.analisesAnteriores=i||[]}catch(a){console.error("Erro ao carregar dados:",a),alert("Erro ao carregar dados do produto. Por favor, tente novamente.")}finally{this.loading=!1}},async salvarAnalise(){try{if(this.submitting=!0,"reprovado"===this.analise.status&&!this.analise.motivacao)return this.$swal({icon:"error",title:"Campo obrigatório",text:"É necessário preencher a motivação da reprovação"}),void(this.submitting=!1);const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;let e;if(t){console.log("Usuário autenticado:",t.email);const{data:a,error:o}=await g.ND.from("usuarios").select("id").eq("email",t.email).maybeSingle();if(o&&console.error("Erro ao buscar ID do usuário:",o),a?.id)console.log("ID do usuário encontrado na tabela usuarios:",a.id),e=a.id;else{console.warn("Usuário não encontrado na tabela, gerando UUID"),e=this.gerarUUID();const{error:a}=await g.ND.from("usuarios").insert({id:e,email:t.email,nome:t.email.split("@")[0],tenant_id:this.produto.tenant_id,tipo:"avaliador",ativo:!0});a&&console.error("Erro ao criar usuário automaticamente:",a)}}else console.warn("Nenhum usuário autenticado, gerando UUID"),e=this.gerarUUID();console.log("Salvando análise com avaliador_id:",e);const o={produto_id:this.id,tenant_id:this.produto.tenant_id,avaliador_id:e,parecer:this.analise.parecer,status:this.analise.status};"reprovado"===this.analise.status&&(o.motivacao=this.analise.motivacao);const{error:i}=await g.ND.from("analises").insert(o);if(i)throw console.error("Erro detalhado ao salvar análise:",i),new Error(`Erro ao salvar análise: ${i.message}`);const{error:s}=await g.ND.from("produtos").update({status:this.analise.status}).eq("id",this.id);if(s)throw s;this.$swal({icon:"success",title:"Análise salva com sucesso!",showConfirmButton:!1,timer:1500}),await this.carregarDados(),this.analise={parecer:"",status:"",motivacao:""}}catch(a){console.error("Erro ao salvar análise:",a);let t="Erro ao salvar análise.";a.message&&a.message.includes("uuid")?t="Erro no formato de identificação. Este problema foi corrigido, tente novamente.":a.message&&(t=a.message),this.$swal({icon:"error",title:"Erro ao processar análise",text:t})}finally{this.submitting=!1}},formatDate(a){if(!a)return"";const t=new Date(a);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";default:return""}},voltar(){this.$router.push("/dashboard")},gerarUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){const t=16*Math.random()|0,e="x"==a?t:3&t|8;return e.toString(16)}))},async solicitarDiligencia(a){try{const{value:t}=await this.$swal({title:"🔍 Solicitar Diligência",html:'\n            <div style="text-align: left; padding: 10px;">\n              <div style="margin-bottom: 20px;">\n                <label for="tipo_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  📋 Tipo de Diligência:\n                </label>\n                <select id="tipo_diligencia" class="swal2-input" style="width: 100%; font-size: 14px;">\n                  <option value="">Selecione o tipo</option>\n                  <option value="DOCUMENTACAO_FALTANTE">📄 Documentação Faltante</option>\n                  <option value="AMOSTRA_INADEQUADA">🔬 Amostra Inadequada</option>\n                  <option value="ESPECIFICACAO_INCOMPLETA">📝 Especificação Incompleta</option>\n                  <option value="CERTIFICACAO_PENDENTE">✅ Certificação Pendente</option>\n                  <option value="ESCLARECIMENTO_TECNICO">🔧 Esclarecimento Técnico</option>\n                  <option value="OUTRO">✏️ Outro (especificar)</option>\n                </select>\n                <div id="tipo_outro_container" style="display: none; margin-top: 10px;">\n                  <input \n                    type="text" \n                    id="tipo_outro_texto" \n                    class="swal2-input" \n                    placeholder="Digite o tipo de diligência..."\n                    style="width: 100%; font-size: 14px;"\n                  >\n                </div>\n              </div>\n              \n              <div style="margin-bottom: 20px;">\n                <label for="descricao_diligencia" style="display: block; font-weight: bold; margin-bottom: 8px; color: #2c3e50;">\n                  ✍️ Descrição Detalhada:\n                </label>\n                <textarea \n                  id="descricao_diligencia" \n                  class="swal2-textarea" \n                  placeholder="Descreva detalhadamente o que precisa ser providenciado pelo fornecedor..."\n                  style="width: 100%; min-height: 120px; font-size: 14px; line-height: 1.5;"\n                ></textarea>\n              </div>\n              \n              <div style="margin-bottom: 20px; padding: 15px; background: #e8f4fd; border-left: 4px solid #3498db; border-radius: 4px;">\n                <div style="display: flex; align-items: center; margin-bottom: 8px;">\n                  <span style="font-size: 18px; margin-right: 8px;">⏰</span>\n                  <strong style="color: #2c3e50;">Prazo para Resposta:</strong>\n                </div>\n                <p style="margin: 0; color: #34495e; font-size: 14px;">\n                  <strong>30 dias úteis</strong> (padrão do sistema)\n                </p>\n                <small style="color: #6c757d; font-size: 12px; margin-top: 5px; display: block;">\n                  📅 A data limite será calculada automaticamente excluindo fins de semana\n                </small>\n              </div>\n            </div>\n          ',width:"600px",focusConfirm:!1,showCancelButton:!0,confirmButtonText:"📤 Enviar Diligência",cancelButtonText:"❌ Cancelar",confirmButtonColor:"#f39c12",cancelButtonColor:"#6c757d",didOpen:()=>{const a=document.getElementById("tipo_diligencia"),t=document.getElementById("tipo_outro_container");a.addEventListener("change",(function(){"OUTRO"===this.value?(t.style.display="block",setTimeout((()=>{document.getElementById("tipo_outro_texto").focus()}),100)):t.style.display="none"}))},preConfirm:()=>{const a=document.getElementById("tipo_diligencia").value,t=document.getElementById("tipo_outro_texto").value,e=document.getElementById("descricao_diligencia").value,o=30;let i=a;if("OUTRO"===a){if(!t||t.trim().length<3)return this.$swal.showValidationMessage("⚠️ Por favor, especifique o tipo de diligência (mínimo 3 caracteres)"),!1;i=t.trim()}return a?!e||e.trim().length<20?(this.$swal.showValidationMessage("⚠️ A descrição deve ter pelo menos 20 caracteres"),!1):{tipo:i,descricao:e,prazo:o}:(this.$swal.showValidationMessage("⚠️ Por favor, selecione o tipo de diligência"),!1)}});t&&await this.salvarDiligencia(a,t)}catch(t){console.error("Erro ao solicitar diligência:",t)}},async salvarDiligencia(a,t){try{if(!this.produto.email_fornecedor)return void this.$swal({title:"⚠️ Email do Fornecedor Necessário",text:"Para enviar a diligência, é necessário que o produto tenha o email do fornecedor cadastrado. Deseja continuar sem enviar email?",icon:"warning",showCancelButton:!0,confirmButtonText:"Continuar sem Email",cancelButtonText:"Cancelar",confirmButtonColor:"#f39c12"}).then((async e=>{e.isConfirmed&&await this.processarDiligencia(a,t,!1)}));await this.processarDiligencia(a,t,!0)}catch(e){console.error("Erro ao salvar diligência:",e),this.$swal({title:"❌ Erro",text:"Erro ao solicitar diligência",icon:"error"})}},async processarDiligencia(a,t,e=!0){try{const i=this.calcularDataUtil(new Date,t.prazo),{data:s,error:r}=await g.ND.from("diligencias").insert({produto_id:a,tenant_id:this.produto.tenant_id,tipo:t.tipo,descricao:t.descricao,prazo_dias:t.prazo,data_limite:i.toISOString(),status:"PENDENTE",solicitado_por:"CPM"}).select().single();if(r)throw r;const{error:n}=await g.ND.from("produtos").update({status:"diligencia"}).eq("id",a);if(n)throw n;let l=!1;if(e&&this.produto.email_fornecedor)try{const a=await ea({destinatario:this.produto.email_fornecedor,produto:this.produto,diligencia:{...s,data_limite:i}});l=a.success,a.success||console.error("Erro no envio do email:",a.message)}catch(o){console.error("Erro ao enviar email:",o)}const c=e&&l?" O fornecedor foi notificado por email.":e&&!l?" ⚠️ A diligência foi salva, mas houve erro no envio do email.":" (Sem notificação por email)";this.$swal({title:"✅ Sucesso!",text:`Diligência solicitada com sucesso.${c}`,icon:l||!e?"success":"warning",confirmButtonColor:"#28a745"}),await this.carregarDados()}catch(i){console.error("Erro ao processar diligência:",i),this.$swal({title:"❌ Erro",text:"Erro ao processar diligência",icon:"error"})}},async visualizarDiligencias(a){try{const{data:t,error:e}=await g.ND.from("diligencias").select("*").eq("produto_id",a).order("criado_em",{ascending:!1});if(e)throw e;let o='<div style="text-align: left; padding: 10px;">';t&&t.length>0?(o+='<h4 style="color: #2c3e50; margin-bottom: 20px;">📋 Histórico de Diligências:</h4>',t.forEach(((a,t)=>{const e="PENDENTE"===a.status?"#f39c12":"ATENDIDA"===a.status?"#28a745":"#dc3545",i="PENDENTE"===a.status?"⏳":"ATENDIDA"===a.status?"✅":"❌";o+=`\n              <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin: 15px 0; background: ${"PENDENTE"===a.status?"#fff3cd":"ATENDIDA"===a.status?"#d4edda":"#f8d7da"};">\n                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                  <strong style="color: #2c3e50;">Diligência #${t+1}</strong>\n                  <span style="color: ${e}; font-weight: bold;">\n                    ${i} ${a.status}\n                  </span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">Tipo:</strong> \n                  <span style="color: #6c757d;">${a.tipo.replace(/_/g," ")}</span>\n                </div>\n                \n                <div style="margin-bottom: 8px;">\n                  <strong style="color: #495057;">Descrição:</strong>\n                  <div style="background: white; padding: 10px; border-radius: 4px; margin-top: 5px; border-left: 4px solid ${e};">\n                    ${a.descricao}\n                  </div>\n                </div>\n                \n                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px; font-size: 12px; color: #6c757d;">\n                  <div>📅 <strong>Prazo:</strong> ${this.formatDate(a.data_limite)}</div>\n                  <div>🕐 <strong>Solicitado:</strong> ${this.formatDate(a.criado_em)}</div>\n                </div>\n              </div>\n            `}))):o+='\n            <div style="text-align: center; padding: 40px; color: #6c757d;">\n              <div style="font-size: 48px; margin-bottom: 15px;">📭</div>\n              <p>Nenhuma diligência encontrada para este produto.</p>\n            </div>\n          ',o+="</div>",this.$swal({title:"📋 Diligências do Produto",html:o,width:"700px",confirmButtonColor:"#007bff"})}catch(t){console.error("Erro ao carregar diligências:",t),this.$swal({title:"❌ Erro",text:"Erro ao carregar diligências do produto",icon:"error"})}},calcularDataUtil(a,t){const e=new Date(a);let o=0;while(o<t)e.setDate(e.getDate()+1),0!==e.getDay()&&6!==e.getDay()&&o++;return e}}},ia=oa;var sa=(0,r.A)(ia,Q,W,!1,null,"1eb6b586",null);const ra=sa.exports,na={name:"Analise",components:{AnaliseProduto:ra},data(){return{showDropdown:!1,usuarioNome:"Usuário",usuarioEmail:""}},computed:{produtoId(){return this.$route.params.id}},async created(){await this.carregarDadosUsuario()},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await g.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuário:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},closeDropdown(){this.showDropdown=!1},abrirConfiguracoes(){this.closeDropdown(),this.$swal({title:"⚙️ Configurações",text:"Configure o email no Dashboard principal para salvar as configurações globais.",icon:"info"})},abrirConfiguracoesEmail(){this.closeDropdown(),this.$swal({title:"📧 Configurar Email",text:"Acesse o Dashboard principal para configurar o email do sistema.",icon:"info"})},async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()}}},la=na;var ca=(0,r.A)(la,Y,Z,!1,null,"5d87272e",null);const da=ca.exports;var ua=function(){var a=this,t=a._self._c;return t("div",{staticClass:"catalogo-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("▼")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.nomeUsuario))]),t("small",[a._v(a._s(a.emailUsuario))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("CatalogoEletronico")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(2),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organização")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comissão de Padronização de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comissão de Padronização de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},ma=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organização")])}],pa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"catalogo-container"},[t("h2",[a._v("Catálogo Eletrônico de Bens Padronizados")]),t("div",{staticClass:"search-filters"},[t("div",{staticClass:"search-box"},[t("input",{directives:[{name:"model",rawName:"v-model",value:a.searchTerm,expression:"searchTerm"}],attrs:{type:"text",placeholder:"Buscar produto..."},domProps:{value:a.searchTerm},on:{input:[function(t){t.target.composing||(a.searchTerm=t.target.value)},a.filtrarProdutos]}})]),t("div",{staticClass:"filters"},[t("div",{staticClass:"categoria-filter"},[a._m(0),t("div",{staticClass:"dropdown"},[t("button",{staticClass:"dropdown-toggle",attrs:{type:"button"},on:{click:a.toggleCategoriaDropdown}},[a._v(" "+a._s(a.categoriaAtual)+" ")]),t("div",{staticClass:"dropdown-menu",class:{show:a.showCategoriaDropdown}},[a.carregandoCategorias?t("div",{staticClass:"dropdown-item loading"},[t("div",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status"}}),t("span",[a._v("Carregando...")])]):[t("a",{staticClass:"dropdown-item",on:{click:function(t){return a.selecionarCategoria(null)}}},[a._v("Todos os grupos")]),0===a.categorias.length?t("div",{staticClass:"dropdown-item empty"},[a._v(" Nenhum grupo disponível ")]):a._l(a.categorias,(function(e){return t("a",{key:e.id,staticClass:"dropdown-item",class:{active:e.id===a.filtroCategoria},on:{click:function(t){return a.selecionarCategoria(e)}}},[a._v(" "+a._s(e.nome)+" ")])}))]],2)])])])]),a.produtosFiltrados.length>0?t("div",{staticClass:"produtos-grid"},a._l(a.produtosFiltrados,(function(e){return t("div",{key:e.id,staticClass:"produto-card",on:{click:function(t){return a.verDetalhesProduto(e.id)}}},[t("div",{staticClass:"produto-info"},[t("h3",[a._v(a._s(e.nome))]),t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(e.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(e.modelo))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(e.fabricante))])]),t("div",{staticClass:"produto-status",class:a.getStatusClass(e.status)},[a._v(" "+a._s(e.status)+" ")])])})),0):t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhum produto encontrado.")])]),a.produtoSelecionado?t("div",{staticClass:"produto-modal",on:{click:function(t){return t.target!==t.currentTarget?null:a.fecharModal.apply(null,arguments)}}},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.produtoSelecionado.nome))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModal}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"produto-detalhes"},[t("p",[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoSelecionado.marca))]),t("p",[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoSelecionado.modelo))]),t("p",[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoSelecionado.fabricante))]),t("p",[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoSelecionado.cnpj))]),a.produtoSelecionado.descricao?t("p",[t("strong",[a._v("Descrição:")]),a._v(" "+a._s(a.produtoSelecionado.descricao))]):a._e(),t("p",[t("strong",[a._v("Status:")]),a._v(" "),t("span",{class:a.getStatusClass(a.produtoSelecionado.status)},[a._v(a._s(a.produtoSelecionado.status))])]),t("div",{staticClass:"avaliacoes-section"},[t("div",{staticClass:"avaliacoes-header",class:{active:a.showAvaliacoes},on:{click:a.toggleAvaliacoes}},[t("h4",[a._v("Avaliações de Desempenho (RDM)")]),t("div",{staticClass:"avaliacao-summary"},[a.avaliacaoMedia>0?t("div",{staticClass:"stars-container"},[t("div",{staticClass:"stars"},a._l(5,(function(e){return t("span",{key:e,staticClass:"star",class:{filled:a.avaliacaoMedia>=e,half:a.avaliacaoMedia>=e-.5&&a.avaliacaoMedia<e}},[a._v("★")])})),0),t("span",{staticClass:"rating-number"},[a._v(a._s(a.avaliacaoMedia))]),t("span",{staticClass:"rating-count"},[a._v("("+a._s(a.avaliacoes.length)+" avaliações)")])]):t("div",{staticClass:"no-ratings"},[a._v(" Sem avaliações ainda ")]),t("span",{staticClass:"toggle-icon"},[a._v(a._s(a.showAvaliacoes?"▲":"▼"))])])]),a.showAvaliacoes?t("div",{staticClass:"avaliacoes-content"},[0===a.avaliacoes.length?t("div",{staticClass:"no-avaliacoes"},[a._v(" Este produto ainda não possui avaliações de desempenho. ")]):t("div",{staticClass:"avaliacoes-list"},a._l(a.avaliacoes,(function(e,o){return t("div",{key:o,staticClass:"avaliacao-item"},[t("div",{staticClass:"avaliacao-stars"},a._l(5,(function(o){return t("span",{key:o,staticClass:"star",class:{filled:e.avaliacao>=o}},[a._v("★")])})),0),t("div",{staticClass:"avaliacao-comentario"},[a._v(" "+a._s(e.comentario)+" ")]),t("div",{staticClass:"avaliacao-data"},[a._v(" "+a._s(a.obterDataAvaliacao(e))+" ")])])})),0)]):a._e()]),a.documentos.length>0?t("div",{staticClass:"documentos"},[t("h4",[a._v("Documentos")]),t("ul",a._l(a.documentos,(function(e){return t("li",{key:e.id},[t("a",{attrs:{href:e.arquivo_url,target:"_blank"}},[a._v(a._s(e.nome))])])})),0)]):a._e()])])])]):a._e()])},va=[function(){var a=this,t=a._self._c;return t("label",[t("strong",[a._v("Grupo:")])])}];const ga={name:"CatalogoEletronico",data(){return{produtos:[],produtosFiltrados:[],categorias:[],searchTerm:"",filtroCategoria:"",categoriaAtual:"Todos os grupos",showCategoriaDropdown:!1,showAvaliacoes:!1,produtoSelecionado:null,documentos:[],avaliacoes:[],avaliacaoMedia:0,carregandoCategorias:!0,categoriaSelecionada:null,currentTenantId:null,loading:!1}},created(){this.obterTenantId().then((()=>{this.carregarDados()})),document.addEventListener("click",this.closeDropdownOnClickOutside)},mounted(){this.carregarCategoriasDireto(),this.showCategoriaDropdown=!1},beforeUnmount(){document.removeEventListener("click",this.closeDropdownOnClickOutside)},methods:{async obterTenantId(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usuário não está autenticado");if(t.user_metadata?.tenant_id)return this.currentTenantId=t.user_metadata.tenant_id,void console.log("Tenant ID obtido dos metadados:",this.currentTenantId);const{data:e,error:o}=await g.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(o)return void console.error("Erro ao buscar tenant_id:",o);e?.tenant_id?(this.currentTenantId=e.tenant_id,console.log("Tenant ID obtido da tabela usuarios:",this.currentTenantId)):console.error("Tenant ID não encontrado para o usuário")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarDados(){console.log("Iniciando carregamento de dados"),this.carregandoCategorias=!0,this.loading=!0;try{if(!this.currentTenantId&&(console.error("Tenant ID não disponível. Tentando recarregar..."),await this.obterTenantId(),!this.currentTenantId))return console.error("Não foi possível obter o tenant_id, impossível carregar dados"),void this.$swal({icon:"error",title:"Erro ao carregar dados",text:"Não foi possível identificar sua conta. Por favor, faça login novamente."});console.log("Buscando categorias do Supabase...");const{data:a,error:t}=await g.ND.from("categorias").select("*");t?(console.error("Erro ao carregar categorias:",t.message),this.$swal({icon:"error",title:"Erro ao carregar categorias",text:"Não foi possível carregar as categorias. Por favor, tente novamente."})):(console.log("Categorias carregadas:",a),this.categorias=a||[],0===this.categorias.length&&console.warn("Nenhuma categoria encontrada no banco de dados")),this.carregandoCategorias=!1,console.log("Buscando produtos do Supabase para tenant_id:",this.currentTenantId);const{data:e,error:o}=await g.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId);o?(console.error("Erro ao carregar produtos:",o.message),this.$swal({icon:"error",title:"Erro ao carregar produtos",text:"Não foi possível carregar os produtos. Por favor, tente novamente."})):(console.log("Produtos carregados:",e),this.produtos=e||[],console.log(`${this.produtos.length} produtos carregados para o tenant atual`),this.produtos=this.produtos.map((a=>{const t=this.categorias.find((t=>t.id===a.categoria_id));return{...a,categoria_nome:t?t.nome:"Categoria não encontrada"}})),this.produtosFiltrados=[...this.produtos])}catch(a){console.error("Erro ao carregar dados:",a),this.$swal({icon:"error",title:"Erro ao carregar dados",text:"Ocorreu um erro inesperado. Por favor, tente novamente."})}finally{this.loading=!1}},async carregarCategoriasDireto(){try{console.log("Tentando carregar categorias diretamente...");const{data:a,error:t}=await g.ND.from("categorias").select("*");if(t)return void console.error("Erro ao carregar categorias direto:",t);console.log("Resposta direta de categorias:",a),a&&a.length>0&&0===this.categorias.length&&(console.log("Atualizando categorias com dados diretos"),this.categorias=a)}catch(a){console.error("Exceção ao carregar categorias direto:",a)}},filtrarProdutos(){console.log("Filtrando produtos por:",this.filtroCategoria,"e texto:",this.searchTerm),this.produtosFiltrados=this.produtos.filter((a=>{const t=!this.filtroCategoria||a.categoria_id===this.filtroCategoria,e=!this.searchTerm||a.nome.toLowerCase().includes(this.searchTerm.toLowerCase())||a.descricao&&a.descricao.toLowerCase().includes(this.searchTerm.toLowerCase());return t&&e})),console.log("Produtos filtrados:",this.produtosFiltrados.length)},async verDetalhesProduto(a){try{if(!this.currentTenantId)return void console.error("Não foi possível identificar o tenant_id");const{data:t,error:e}=await g.ND.from("produtos").select("*").eq("id",a).eq("tenant_id",this.currentTenantId).single();if(e)throw console.error("Erro ao carregar produto:",e),e;if(!t)return console.error("Produto não encontrado ou não pertence ao tenant atual"),void this.$swal({icon:"error",title:"Produto não encontrado",text:"O produto solicitado não existe ou você não tem permissão para visualizá-lo."});this.produtoSelecionado=t;const{data:o,error:i}=await g.ND.from("documentos").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId);if(i)throw i;this.documentos=o||[];const{data:s,error:r}=await g.ND.from("rdm_feedbacks").select("*").eq("produto_id",a).eq("tenant_id",this.currentTenantId);if(r)console.error("Erro ao carregar avaliações:",r),this.avaliacoes=[],this.avaliacaoMedia=0;else if(this.avaliacoes=s||[],this.avaliacoes.length>0&&(console.log("Campos disponíveis na avaliação:",Object.keys(this.avaliacoes[0])),console.log("Exemplo de avaliação:",this.avaliacoes[0])),this.avaliacoes.length>0){const a=this.avaliacoes.reduce(((a,t)=>a+t.avaliacao),0);this.avaliacaoMedia=parseFloat((a/this.avaliacoes.length).toFixed(1))}else this.avaliacaoMedia=0}catch(t){console.error("Erro ao carregar detalhes do produto:",t),this.$swal({icon:"error",title:"Erro ao carregar detalhes",text:"Não foi possível carregar os detalhes do produto. Tente novamente."})}},fecharModal(){this.produtoSelecionado=null,this.documentos=[],this.avaliacoes=[],this.avaliacaoMedia=0,this.showAvaliacoes=!1},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";default:return""}},closeDropdownOnClickOutside(a){const t=this.$el.querySelector(".dropdown");t&&!t.contains(a.target)&&(this.showCategoriaDropdown=!1)},selecionarCategoria(a){console.log("Categoria selecionada:",a),this.categoriaSelecionada=a,this.categoriaAtual=a?a.nome:"Todos os grupos",this.filtroCategoria=a?a.id:"",this.showCategoriaDropdown=!1,this.filtrarProdutos()},toggleCategoriaDropdown(){this.showCategoriaDropdown=!this.showCategoriaDropdown},toggleAvaliacoes(){this.showAvaliacoes=!this.showAvaliacoes},formatarData(a){if(!a)return"Data não disponível";try{const t=new Date(a);return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Erro ao formatar data:",t),"Data inválida"}},obterDataAvaliacao(a){const t=a.created_at||a.criado_em||a.data||null;return this.formatarData(t)}}},fa=ga;var ha=(0,r.A)(fa,pa,va,!1,null,"9a1e339e",null);const _a=ha.exports,Ca={name:"Catalogo",components:{CatalogoEletronico:_a},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}},closeDropdown(){this.dropdownOpen=!1}}},ba=Ca;var wa=(0,r.A)(ba,ua,ma,!1,null,"5f8dc8aa",null);const Da=wa.exports;var Ea=function(){var a=this,t=a._self._c;return t("div",{staticClass:"feedback-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[t("div",{staticClass:"profile-avatar"},[a._v(" 👤 ")]),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("▼")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ⚙️ Configuração ")]),t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" 📧 Configurar Email ")]),t("hr",{staticClass:"dropdown-divider"}),t("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" 🚪 Sair ")])]):a._e()])])]),t("main",{staticClass:"main-content"},[t("FormularioRDM")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(1),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organização")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comissão de Padronização de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comissão de Padronização de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},ya=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organização")])}],xa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"rdm-container"},[t("h2",[a._v("Relatório de Desempenho de Material (RDM)")]),t("form",{on:{submit:function(t){return t.preventDefault(),a.enviarFeedback.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"produto"}},[a._v("Produto*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.feedback.produto_id,expression:"feedback.produto_id"}],attrs:{id:"produto",required:""},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.feedback,"produto_id",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione o produto...")]),a._l(a.produtos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nome)+" - "+a._s(e.marca)+" - "+a._s(e.modelo)+" ")])}))],2)]),t("div",{staticClass:"form-group"},[t("label",[a._v("Avaliação*")]),t("div",{staticClass:"avaliacao"},a._l(5,(function(e){return t("div",{key:e,staticClass:"estrela",class:{ativa:a.feedback.avaliacao>=e},on:{click:function(t){a.feedback.avaliacao=e}}},[a._v(" ★ ")])})),0)]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"comentario"}},[a._v("Justificativa da Avaliação*")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.feedback.comentario,expression:"feedback.comentario"}],attrs:{id:"comentario",rows:"4",placeholder:"Ex: Equipamento apresentou falha após 3 meses de uso...",required:""},domProps:{value:a.feedback.comentario},on:{input:function(t){t.target.composing||a.$set(a.feedback,"comentario",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.loading}},[a._v(" "+a._s(a.loading?"Salvando...":"Salvar")+" ")])])])])},Pa=[];const Aa={name:"FormularioRDM",data(){return{feedback:{produto_id:"",avaliacao:0,comentario:""},produtos:[],loading:!1,currentUser:null,currentTenantId:null}},created(){this.carregarProdutos(),this.obterUsuarioAtual()},methods:{async obterUsuarioAtual(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;t?(this.currentUser=t,t.user_metadata?.tenant_id?this.currentTenantId=t.user_metadata.tenant_id:this.currentTenantId=(0,f.A)()):this.currentTenantId=(0,f.A)()}catch(a){console.error("Erro ao obter dados do usuário:",a),this.currentTenantId=(0,f.A)()}},async carregarProdutos(){try{if(await this.obterUsuarioAtual(),!this.currentTenantId)return console.error("Não foi possível identificar o tenant_id"),void(this.produtos=[]);console.log("Carregando produtos para o tenant:",this.currentTenantId);const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("status","aprovado").eq("tenant_id",this.currentTenantId).order("nome");if(t)throw t;console.log("Produtos carregados:",a?.length||0),this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),alert("Erro ao carregar produtos. Por favor, tente novamente.")}},async enviarFeedback(){if(0!==this.feedback.avaliacao)try{let t;if(this.loading=!0,this.currentTenantId||(this.currentTenantId=(0,f.A)()),this.currentUser?.email){console.log("Buscando ID do usuário na tabela usuarios pelo email:",this.currentUser.email);const{data:e,error:o}=await g.ND.from("usuarios").select("id").eq("email",this.currentUser.email).maybeSingle();if(o&&console.error("Erro ao buscar usuário:",o),e?.id)t=e.id,console.log("ID do usuário encontrado na tabela usuarios:",t);else{console.warn("Usuário não encontrado na tabela usuarios, gerando ID temporário"),t=(0,f.A)();try{const{error:a}=await g.ND.from("usuarios").insert({id:t,email:this.currentUser.email,nome:this.currentUser.email.split("@")[0],tenant_id:this.currentTenantId,tipo:"cliente",ativo:!0});a&&console.error("Erro ao criar usuário na tabela:",a)}catch(a){console.error("Exceção ao criar usuário:",a)}}}else console.warn("Usuário não está autenticado, gerando ID temporário"),t=(0,f.A)();console.log("Enviando feedback com:",{produto_id:this.feedback.produto_id,usuario_id:t,tenant_id:this.currentTenantId});const{error:e}=await g.ND.from("rdm_feedbacks").insert({produto_id:this.feedback.produto_id,usuario_id:t,tenant_id:this.currentTenantId,avaliacao:this.feedback.avaliacao,comentario:this.feedback.comentario});if(e)throw e;this.$swal({icon:"success",title:"Feedback enviado!",text:"Seu feedback foi enviado com sucesso."}),this.limparFormulario()}catch(t){console.error("Erro ao enviar feedback:",t),this.$swal({icon:"error",title:"Erro ao enviar feedback",text:"Por favor, tente novamente."})}finally{this.loading=!1}else alert("Por favor, selecione uma avaliação de 1 a 5 estrelas.")},limparFormulario(){this.feedback={produto_id:"",avaliacao:0,comentario:""}}}},Na=Aa;var Sa=(0,r.A)(Na,xa,Pa,!1,null,"f5b703e0",null);const Ra=Sa.exports,Ia={name:"Feedback",components:{FormularioRDM:Ra},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},mounted(){this.carregarConfiguracoes()},methods:{async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}}}},$a=Ia;var ka=(0,r.A)($a,Ea,ya,!1,null,"098da73d",null);const Ta=ka.exports;var Ba=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dcb-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-btn",on:{click:a.toggleDropdown}},[t("div",{staticClass:"profile-avatar"},[a._v(" 👤 ")]),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("▼")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" ⚙️ Configuração ")]),t("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.abrirConfiguracaoEmail.apply(null,arguments)}}},[a._v(" 📧 Configurar Email ")]),t("hr",{staticClass:"dropdown-divider"}),t("a",{staticClass:"dropdown-item logout",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),a.logout.apply(null,arguments)}}},[a._v(" 🚪 Sair ")])]):a._e()])])]),t("main",{staticClass:"main-content"},[t("FormularioDCB")],1)])},Ma=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])}],Fa=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dcb-container"},[t("h2",[a._v("Declaração de Conformidade de Bem (DCB)")]),t("div",{staticClass:"search-container"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"produto"}},[a._v("Selecione o produto")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.produtoSelecionado,expression:"produtoSelecionado"}],attrs:{id:"produto"},on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.produtoSelecionado=t.target.multiple?e:e[0]},a.carregarDetalhes]}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.produtos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nome)+" - "+a._s(e.marca)+" - "+a._s(e.modelo)+" ")])}))],2)])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando informações...")])]):a.produtoDetalhes?t("div",{staticClass:"produto-detalhes"},[t("h3",[a._v(a._s(a.produtoDetalhes.nome))]),t("div",{staticClass:"info-grid"},[t("div",{staticClass:"info-item"},[t("strong",[a._v("Marca:")]),a._v(" "+a._s(a.produtoDetalhes.marca)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Modelo:")]),a._v(" "+a._s(a.produtoDetalhes.modelo)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Fabricante:")]),a._v(" "+a._s(a.produtoDetalhes.fabricante)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CNPJ:")]),a._v(" "+a._s(a.produtoDetalhes.cnpj)+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Origem:")]),a._v(" "+a._s(a.produtoDetalhes.origem||"Não informada")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Registro na Anvisa/MS:")]),a._v(" "+a._s(a.produtoDetalhes.registro_anvisa||"Não informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("CBPF:")]),a._v(" "+a._s(a.produtoDetalhes.cbpf||"Não informado")+" ")]),t("div",{staticClass:"info-item"},[t("strong",[a._v("Código do Material:")]),a._v(" "+a._s(a.produtoDetalhes.codigo_material||"Não informado")+" ")]),t("div",{staticClass:"info-item full-width"},[t("strong",[a._v("Status:")]),t("span",{staticClass:"status-badge",class:a.getStatusClass(a.produtoDetalhes.status)},[a._v(" "+a._s(a.formatarStatus(a.produtoDetalhes.status))+" ")])])]),a.documentos.length>0?t("div",{staticClass:"documentos"},[t("h3",[a._v("Documentos")]),t("ul",{staticClass:"documentos-lista"},a._l(a.documentos,(function(e){return t("li",{key:e.id,staticClass:"documento-item"},[t("span",{staticClass:"doc-icon"},[a._v("📄")]),t("span",{staticClass:"doc-nome"},[a._v(a._s(e.nome))]),t("a",{staticClass:"btn-download",attrs:{href:e.arquivo_url,target:"_blank"}},[a._v("Visualizar")])])})),0)]):a._e(),t("div",{staticClass:"dcb-actions"},[t("button",{staticClass:"btn-primary",attrs:{disabled:!a.produtoAprovado},on:{click:a.gerarDCB}},[a._v(" Baixar Declaração de Conformidade ")]),a.produtoAprovado?a._e():t("p",{staticClass:"aviso"},[a._v(" Somente produtos aprovados possuem Declaração de Conformidade disponível. ")])])]):a._e()])},Oa=[];const za={name:"FormularioDCB",data(){return{produtoSelecionado:"",produtoDetalhes:null,documentos:[],produtos:[],loading:!1,currentTenantId:null}},computed:{produtoAprovado(){return this.produtoDetalhes&&"aprovado"===this.produtoDetalhes.status}},created(){this.obterTenantId().then((()=>{this.carregarProdutos()}))},methods:{async obterTenantId(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;if(t)if(t.user_metadata?.tenant_id)this.currentTenantId=t.user_metadata.tenant_id;else{const{data:a,error:e}=await g.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();!e&&a?.tenant_id&&(this.currentTenantId=a.tenant_id)}}catch(a){console.error("Erro ao obter dados do usuário:",a)}},async carregarProdutos(){try{if(this.loading=!0,!this.currentTenantId)return void console.error("Tenant ID não disponível");const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).order("nome");if(t)throw t;this.produtos=a||[]}catch(a){console.error("Erro ao carregar produtos:",a),this.$swal({icon:"error",title:"Erro",text:"Não foi possível carregar a lista de produtos."})}finally{this.loading=!1}},async carregarDetalhes(){if(!this.produtoSelecionado)return this.produtoDetalhes=null,void(this.documentos=[]);try{this.loading=!0;const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("id",this.produtoSelecionado).single();if(t)throw t;this.produtoDetalhes=a;const{data:e,error:o}=await g.ND.from("documentos").select("*").eq("produto_id",this.produtoSelecionado);if(o)throw o;this.documentos=e||[]}catch(a){console.error("Erro ao carregar detalhes do produto:",a),this.$swal({icon:"error",title:"Erro",text:"Não foi possível carregar os detalhes do produto."})}finally{this.loading=!1}},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";case"diligencia":return"status-diligencia";default:return""}},formatarStatus(a){switch(a){case"pendente":return"Em avaliação";case"diligencia":return"Diligência";default:return a.charAt(0).toUpperCase()+a.slice(1)}},gerarDCB(){this.produtoDetalhes&&this.produtoAprovado?this.$swal({icon:"info",title:"Funcionalidade em Desenvolvimento",text:"A geração de PDF da Declaração de Conformidade estará disponível em breve. Esta funcionalidade requer a instalação de bibliotecas adicionais no projeto."}):this.$swal({icon:"error",title:"Não disponível",text:"Apenas produtos aprovados possuem Declaração de Conformidade disponível."})}}},qa=za;var La=(0,r.A)(qa,Fa,Oa,!1,null,"9c76b404",null);const Ua=La.exports,Va={name:"DCB",components:{FormularioDCB:Ua},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}}}},ja=Va;var Ha=(0,r.A)(ja,Ba,Ma,!1,null,"bb85b182",null);const Ja=Ha.exports;var Ga=function(){var a=this,t=a._self._c;return t("div",{staticClass:"ccl-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.showDropdown},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.usuarioNome))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.usuarioEmail))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.showDropdown}},[a._v("▼")])]),a.showDropdown?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.usuarioNome))]),t("small",[a._v(a._s(a.usuarioEmail))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoes}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracoesEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.showDropdown?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("DashboardCCL")],1)])},Ka=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])}],Ya=function(){var a=this,t=a._self._c;return t("div",{staticClass:"dashboard"},[t("h2",[a._v("Painel de Comissão de Contratação ou Licitação")]),t("div",{staticClass:"tabs"},[t("div",{staticClass:"tab",class:{active:"dashboard"===a.activeTab},on:{click:function(t){a.activeTab="dashboard"}}},[a._v(" Dashboard ")]),t("div",{staticClass:"tab",class:{active:"atas"===a.activeTab},on:{click:function(t){a.activeTab="atas"}}},[a._v(" Atas de Julgamento ")]),t("div",{staticClass:"tab",class:{active:"homologacoes"===a.activeTab},on:{click:function(t){a.activeTab="homologacoes"}}},[a._v(" Homologações ")])]),"dashboard"===a.activeTab?t("div",[t("div",{staticClass:"stats-container"},[t("div",{staticClass:"stat-card status-pendente-card"},[t("h3",[a._v("Processos em Julgamento")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.pendentes))])]),t("div",{staticClass:"stat-card status-aprovado-card"},[t("h3",[a._v("Homologações")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.aprovados))])]),t("div",{staticClass:"stat-card status-diligencia-card"},[t("h3",[a._v("Processos com Diligências")]),t("div",{staticClass:"stat-value"},[a._v(a._s(a.diligencias))])])]),t("div",{staticClass:"dashboard-section"},[t("h3",[a._v("Processos Pendentes de Julgamento")]),a.produtosPendentes.length>0?t("table",[a._m(0),t("tbody",a._l(a.produtosPendentes,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.nome))]),t("td",[a._v(a._s(e.marca))]),t("td",[a._v(a._s(a.getCategoriaName(e.categoria_id)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusClass(e.status)},[a._v(" "+a._s(a.formatarStatus(e.status))+" ")])]),t("td",[a._v(a._s(a.formatDate(e.criado_em)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.publicarDecisao(e.id)}}},[a._v("Visualizar")])])])})),0)]):t("p",[a._v("Não há processos pendentes de julgamento.")])]),t("div",{staticClass:"dashboard-section"},[t("h3",[a._v("Atas de Julgamento Recentes")]),a.atasRecentes.length>0?t("table",[a._m(1),t("tbody",a._l(a.atasRecentes,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.numero))]),t("td",[a._v(a._s(e.produto_nome))]),t("td",[t("span",{staticClass:"status-badge",class:a.getStatusClass(e.decisao)},[a._v(" "+a._s(a.formatarStatus(e.decisao))+" ")])]),t("td",[a._v(a._s(a.formatDate(e.data_publicacao)))]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.visualizarAta(e.id)}}},[a._v("Visualizar")])])])})),0)]):t("p",[a._v("Não há atas de julgamento recentes.")])]),t("div",{staticClass:"dashboard-section"},[t("h3",[a._v("Recursos Apresentados")]),a.recursos.length>0?t("table",[a._m(2),t("tbody",a._l(a.recursos,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.recorrente))]),t("td",[a._v(a._s(e.produto_nome))]),t("td",[a._v(a._s(a.formatDate(e.data_recurso)))]),t("td",[a._v(a._s(a.formatDate(e.prazo_final)))]),t("td",[t("span",{staticClass:"status-badge",class:a.getRecursoStatusClass(e.status)},[a._v(" "+a._s(e.status)+" ")])]),t("td",[t("button",{staticClass:"btn-small",on:{click:function(t){return a.julgarRecurso(e.id)}}},[a._v("Visualizar")])])])})),0)]):t("p",[a._v("Não há recursos apresentados.")])])]):a._e(),"atas"===a.activeTab?t("div",{staticClass:"atas-julgamento"},[a._m(3)]):a._e(),"homologacoes"===a.activeTab?t("div",{staticClass:"homologacoes"},[a._m(4)]):a._e()])},Za=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Marca")]),t("th",[a._v("Categoria")]),t("th",[a._v("Status")]),t("th",[a._v("Data")]),t("th",[a._v("Documentação")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Número da Ata")]),t("th",[a._v("Produto")]),t("th",[a._v("Decisão")]),t("th",[a._v("Data de Publicação")]),t("th",[a._v("Documentação")])])])},function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Recorrente")]),t("th",[a._v("Produto")]),t("th",[a._v("Data do Recurso")]),t("th",[a._v("Prazo Final")]),t("th",[a._v("Status")]),t("th",[a._v("Documentação")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info-card"},[t("h3",[a._v("Atas de Julgamento")]),t("p",[a._v("Este módulo permitirá o gerenciamento completo das atas de julgamento emitidas pela Comissão de Contratação ou Licitação.")]),t("p",[a._v("Funcionalidades que serão implementadas:")]),t("ul",[t("li",[a._v("Cadastro e edição de atas de julgamento")]),t("li",[a._v("Publicação automática no Diário Oficial")]),t("li",[a._v("Comunicação com fornecedores interessados")]),t("li",[a._v("Histórico de alterações e versões")]),t("li",[a._v("Geração de relatórios consolidados")]),t("li",[a._v("Integração com sistema de processo eletrônico")])]),t("div",{staticClass:"em-desenvolvimento"},[t("span",[a._v("Em desenvolvimento")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"info-card"},[t("h3",[a._v("Homologações")]),t("p",[a._v("Este módulo permitirá o acesso a todos os arquivos em PDF de atos de homologação assinados digitalmente pela autoridade competente do órgão ou entidade.")]),t("p",[a._v("Funcionalidades que serão implementadas:")]),t("ul",[t("li",[a._v("Acesso aos documentos de homologação de padronizações de marcas e modelos")]),t("li",[a._v("Acesso aos documentos de despadronizações")]),t("li",[a._v("Registro de decisões da autoridade competente")]),t("li",[a._v("Notificação automática de homologações e indeferimentos")])]),t("div",{staticClass:"em-desenvolvimento"},[t("span",[a._v("Em desenvolvimento")])])])}];const Qa={name:"DashboardCCL",data(){return{activeTab:"dashboard",produtosPendentes:[],atasRecentes:[],pendentes:0,aprovados:0,diligencias:0,categorias:[],currentTenantId:null,loading:!1,recursos:[]}},created(){this.obterTenantId().then((()=>{this.carregarDados(),this.carregarCategorias()}))},methods:{async obterTenantId(){try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;if(!t)return void console.error("Usuário não está autenticado");if(t.user_metadata?.tenant_id)return void(this.currentTenantId=t.user_metadata.tenant_id);const{data:e,error:o}=await g.ND.from("usuarios").select("tenant_id").eq("email",t.email).single();if(o)return void console.error("Erro ao buscar tenant_id:",o);e?.tenant_id?this.currentTenantId=e.tenant_id:console.error("Tenant ID não encontrado para o usuário")}catch(a){console.error("Erro ao obter tenant_id:",a)}},async carregarCategorias(){try{const{data:a,error:t}=await g.ND.from("categorias").select("*");if(t)throw t;this.categorias=a||[]}catch(a){console.error("Erro ao carregar categorias:",a)}},getCategoriaName(a){const t=this.categorias.find((t=>t.id===a));return t?t.nome:"Categoria não encontrada"},async carregarDados(){try{if(this.loading=!0,!this.currentTenantId)return void console.error("Tenant ID não disponível");const{data:a,error:t}=await g.ND.from("produtos").select("*").eq("tenant_id",this.currentTenantId).in("status",["aprovado","reprovado"]).order("criado_em",{ascending:!1}).limit(10);if(t)throw t;this.produtosPendentes=a||[],this.atasRecentes=[{id:"1",numero:"ATA-001/2023",produto_nome:"Monitor de Sinais Vitais",decisao:"aprovado",data_publicacao:"2023-05-15"},{id:"2",numero:"ATA-002/2023",produto_nome:"Desfibrilador",decisao:"diligencia",data_publicacao:"2023-05-20"},{id:"3",numero:"ATA-003/2023",produto_nome:"Autoclave Hospitalar",decisao:"aprovado",data_publicacao:"2023-06-01"}],this.recursos=[{id:"1",recorrente:"Hospital Médico LTDA",produto_nome:"Desfibrilador",data_recurso:"2023-05-22",status:"EM ANÁLISE",prazo_final:"2023-06-06"},{id:"2",recorrente:"Equipamentos Hospitalares S.A.",produto_nome:"Bomba de Infusão",data_recurso:"2023-06-05",status:"DEFERIDO",prazo_final:"2023-06-20"},{id:"3",recorrente:"Medical Suprimentos Médicos",produto_nome:"Ventilador Pulmonar",data_recurso:"2023-06-10",status:"INDEFERIDO",prazo_final:"2023-06-25"}];const e=await Promise.all([this.contarPorStatus("pendente"),this.contarPorStatus("aprovado"),this.contarPorStatus("diligencia")]);this.pendentes=e[0],this.aprovados=e[1],this.diligencias=e[2];const o=this.atasRecentes.filter((a=>"diligencia"===a.decisao)).length;o>0&&(this.diligencias=o);const i=this.atasRecentes.filter((a=>"aprovado"===a.decisao)).length;i>0&&0===this.aprovados&&(this.aprovados=i)}catch(a){console.error("Erro ao carregar dados:",a)}finally{this.loading=!1}},async contarPorStatus(a){if(!this.currentTenantId)return 0;const{count:t,error:e}=await g.ND.from("produtos").select("id",{count:"exact"}).eq("status",a).eq("tenant_id",this.currentTenantId);return e?(console.error(`Erro ao contar produtos ${a}:`,e),0):t||0},formatDate(a){if(!a)return"";if(a.includes("T")){const t=new Date(a);return t.toLocaleDateString("pt-BR")}const t=a.split("-");return 3===t.length?`${t[2]}/${t[1]}/${t[0]}`:a},formatarStatus(a){switch(a){case"pendente":return"Em avaliação";case"aprovado":return"Homologado";case"diligencia":return"Em diligência";default:return a}},getStatusClass(a){switch(a){case"aprovado":return"status-aprovado";case"pendente":return"status-pendente";case"reprovado":return"status-reprovado";case"diligencia":return"status-diligencia";default:return""}},publicarDecisao(a){this.$swal({title:"Ação Simulada",text:"Em uma implementação completa, abriria um formulário para registrar a decisão da comissão e publicar no Diário Oficial.",icon:"info"})},visualizarAta(a){this.$swal({title:"Ação Simulada",text:"Em uma implementação completa, exibiria o documento da ata de julgamento e permitiria fazer download.",icon:"info"})},getRecursoStatusClass(a){switch(a){case"EM ANÁLISE":return"status-pendente";case"DEFERIDO":return"status-aprovado";case"INDEFERIDO":return"status-reprovado";default:return""}},julgarRecurso(a){this.$swal({title:"Ação Simulada",text:"Em uma implementação completa, abriria um formulário para julgar o recurso e permitiria acesso ao documento PDF assinado digitalmente.",icon:"info"})}}},Wa=Qa;var Xa=(0,r.A)(Wa,Ya,Za,!1,null,"b8796608",null);const at=Xa.exports,tt={name:"CCL",components:{DashboardCCL:at},data(){return{dropdownOpen:!1,modalEmailAberto:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",configEmail:{nomeOrganizacao:"",emailRemetente:"",nomeRemetente:"",assinatura:""},showDropdown:!1,usuarioNome:"comprarBemTeste",usuarioEmail:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},async created(){await this.carregarDadosUsuario(),this.carregarConfiguracoes()},mounted(){},beforeUnmount(){},methods:{async carregarDadosUsuario(){try{const{data:{user:a}}=await g.ND.auth.getUser();a&&(this.usuarioEmail=a.email,this.usuarioNome=a.user_metadata?.nome||a.email.split("@")[0])}catch(a){console.error("Erro ao carregar dados do usuário:",a)}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}},toggleDropdown(){this.showDropdown=!this.showDropdown},abrirConfiguracoesEmail(){this.closeDropdown(),this.mostrarConfigEmail()},async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}this.closeDropdown()},abrirConfiguracoes(){this.closeDropdown(),this.mostrarConfigEmail()},async mostrarConfigEmail(){const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},closeDropdown(){this.showDropdown=!1}}},et=tt;var ot=(0,r.A)(et,Ga,Ka,!1,null,"c16dfade",null);const it=ot.exports;var st=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classificacao-view"},[t("header",{staticClass:"app-header"},[a._m(0),t("nav",{staticClass:"main-nav"},[t("router-link",{attrs:{to:"/dashboard"}},[a._v("Painel CPM")]),t("router-link",{attrs:{to:"/ccl"}},[a._v("Painel CCL")]),t("router-link",{attrs:{to:"/cadastro"}},[a._v("Cadastrar Produto")]),t("router-link",{staticClass:"nav-item",attrs:{to:"/catalogo"}},[t("span",[a._v("Catálogo")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Marcas")])]),t("router-link",{staticClass:"nav-item",attrs:{to:"/classificacao"}},[t("span",[a._v("Classificação")]),t("span",{staticClass:"nav-subtitle"},[a._v("de Bens")])]),t("router-link",{attrs:{to:"/dcb"}},[a._v("DCB")]),t("router-link",{attrs:{to:"/feedback"}},[a._v("RDM")])],1),t("div",{staticClass:"user-menu"},[t("div",{ref:"profileDropdown",staticClass:"profile-dropdown"},[t("button",{staticClass:"profile-button",class:{active:a.dropdownOpen},on:{click:a.toggleDropdown}},[a._m(1),t("div",{staticClass:"profile-info"},[t("span",{staticClass:"profile-name"},[a._v(a._s(a.nomeUsuario))]),t("span",{staticClass:"profile-email"},[a._v(a._s(a.emailUsuario))])]),t("span",{staticClass:"dropdown-arrow",class:{rotated:a.dropdownOpen}},[a._v("▼")])]),a.dropdownOpen?t("div",{staticClass:"dropdown-menu"},[t("div",{staticClass:"dropdown-header"},[t("div",{staticClass:"user-avatar-large"},[a._v("👤")]),t("div",{staticClass:"user-details"},[t("strong",[a._v(a._s(a.nomeUsuario))]),t("small",[a._v(a._s(a.emailUsuario))])])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("⚙️")]),t("span",[a._v("Configurações")])]),t("button",{staticClass:"dropdown-item",on:{click:a.abrirConfiguracaoEmail}},[t("span",{staticClass:"item-icon"},[a._v("📧")]),t("span",[a._v("Configurar Email")])]),t("hr",{staticClass:"dropdown-divider"}),t("button",{staticClass:"dropdown-item logout-item",on:{click:a.logout}},[t("span",{staticClass:"item-icon"},[a._v("🚪")]),t("span",[a._v("Sair")])])]):a._e()]),a.dropdownOpen?t("div",{staticClass:"dropdown-overlay",on:{click:a.closeDropdown}}):a._e()])]),t("main",{staticClass:"main-content"},[t("Classificacao")],1),a.modalEmailAberto?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalEmail}},[t("div",{staticClass:"modal-content",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[a._m(2),t("button",{staticClass:"btn-close",on:{click:a.fecharModalEmail}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeOrganizacao"}},[a._v("Nome da Organização")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeOrganizacao,expression:"configEmail.nomeOrganizacao"}],attrs:{id:"nomeOrganizacao",type:"text",placeholder:"Ex: Prefeitura Municipal de..."},domProps:{value:a.configEmail.nomeOrganizacao},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeOrganizacao",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"emailRemetente"}},[a._v("Email Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.emailRemetente,expression:"configEmail.emailRemetente"}],attrs:{id:"emailRemetente",type:"email",placeholder:"Ex: licitacoes@prefeitura.gov.br"},domProps:{value:a.configEmail.emailRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"emailRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nomeRemetente"}},[a._v("Nome do Remetente")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.nomeRemetente,expression:"configEmail.nomeRemetente"}],attrs:{id:"nomeRemetente",type:"text",placeholder:"Ex: CPM - Comissão de Padronização de Materiais"},domProps:{value:a.configEmail.nomeRemetente},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"nomeRemetente",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"assinatura"}},[a._v("Assinatura do Email")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.configEmail.assinatura,expression:"configEmail.assinatura"}],attrs:{id:"assinatura",rows:"4",placeholder:"Ex: Atenciosamente,&#10;Comissão de Padronização de Materiais&#10;Prefeitura Municipal&#10;Telefone: (xx) xxxx-xxxx"},domProps:{value:a.configEmail.assinatura},on:{input:function(t){t.target.composing||a.$set(a.configEmail,"assinatura",t.target.value)}}})])]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",on:{click:a.fecharModalEmail}},[a._v("Cancelar")]),t("button",{staticClass:"btn btn-primary",on:{click:a.salvarConfiguracaoEmail}},[t("i",{staticClass:"fas fa-save"}),a._v(" Salvar ")])])])]):a._e()])},rt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"logo"},[t("div",{staticClass:"logo-content"},[t("h1",[a._v("Comprar Bem")]),t("span",{staticClass:"subtitle"},[a._v("Compras Públicas Inteligentes")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"profile-avatar"},[t("span",{staticClass:"profile-icon"},[a._v("👤")])])},function(){var a=this,t=a._self._c;return t("h3",[t("i",{staticClass:"fas fa-envelope"}),a._v(" Configurar Email da Organização")])}],nt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classificacao-container"},[t("h2",[a._v("Classificação de Produtos")]),t("div",{staticClass:"tabs"},[t("button",{class:["tab-button",{active:"grupos"===a.activeTab}],on:{click:function(t){a.activeTab="grupos"}}},[a._v(" Grupos ")]),t("button",{class:["tab-button",{active:"classes"===a.activeTab}],on:{click:function(t){a.activeTab="classes"}}},[a._v(" Classes ")])]),t("div",{staticClass:"tab-content"},["grupos"===a.activeTab?t("GruposList"):a._e(),"classes"===a.activeTab?t("ClassesList"):a._e()],1)])},lt=[],ct=function(){var a=this,t=a._self._c;return t("div",{staticClass:"grupos-list"},[t("div",{staticClass:"header"},[t("h3",[a._v("Gerenciamento de Grupos")]),t("button",{staticClass:"btn-add",on:{click:function(t){a.mostrarFormulario=!0}}},[a._v(" Adicionar Grupo ")])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando grupos...")])]):0===a.grupos.length?t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhum grupo cadastrado.")])]):t("div",{staticClass:"grupos-table"},[t("table",[a._m(0),t("tbody",a._l(a.grupos,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.nome))]),t("td",[a._v(a._s(e.descricao||"-"))]),t("td",[a._v(a._s(a.formatarData(e.created_at)))]),t("td",{staticClass:"actions"},[t("button",{staticClass:"btn-edit",on:{click:function(t){return a.editarGrupo(e)}}},[a._v("Editar")]),t("button",{staticClass:"btn-delete",on:{click:function(t){return a.confirmarExclusao(e)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Grupo")]),t("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarGrupo.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome do Grupo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.nome,expression:"grupoAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.grupoAtual.nome},on:{input:function(t){t.target.composing||a.$set(a.grupoAtual,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descrição")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.grupoAtual.descricao,expression:"grupoAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.grupoAtual.descricao},on:{input:function(t){t.target.composing||a.$set(a.grupoAtual,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},dt=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Descrição")]),t("th",[a._v("Data de Criação")]),t("th",[a._v("Ações")])])])}];const ut={name:"GruposList",setup(){const a=(0,o.KR)([]),t=(0,o.KR)(!0),e=(0,o.KR)(!1),i=(0,o.KR)(!1),s=(0,o.KR)(!1),r=(0,o.Kh)({id:null,nome:"",descricao:""});(0,o.sV)((async()=>{await n()}));const n=async()=>{try{t.value=!0;const{data:e,error:o}=await g.ND.from("grupos").select("*").order("nome");if(o)throw o;a.value=e||[]}catch(e){console.error("Erro ao carregar grupos:",e),alert("Erro ao carregar grupos. Por favor, tente novamente.")}finally{t.value=!1}},l=a=>{if(!a)return"-";const t=new Date(a);return t.toLocaleDateString("pt-BR")},c=a=>{s.value=!0,r.id=a.id,r.nome=a.nome,r.descricao=a.descricao||"",i.value=!0},d=()=>{i.value=!1,s.value=!1,r.id=null,r.nome="",r.descricao=""},u=async()=>{try{if(e.value=!0,s.value){const{error:a}=await g.ND.from("grupos").update({nome:r.nome,descricao:r.descricao}).eq("id",r.id);if(a)throw a;alert("Grupo atualizado com sucesso!")}else{const{error:a}=await g.ND.from("grupos").insert({nome:r.nome,descricao:r.descricao});if(a)throw a;alert("Grupo adicionado com sucesso!")}await n(),d()}catch(a){console.error("Erro ao salvar grupo:",a),alert(`Erro ao ${s.value?"atualizar":"adicionar"} grupo: ${a.message}`)}finally{e.value=!1}},m=a=>{confirm(`Deseja realmente excluir o grupo "${a.nome}"?`)&&p(a.id)},p=async a=>{try{t.value=!0;const{data:e,error:o}=await g.ND.from("classes").select("id").eq("grupo_id",a);if(o)throw o;if(e&&e.length>0)return void alert(`Não é possível excluir este grupo porque existem ${e.length} classes associadas a ele.`);const{data:i,error:s}=await g.ND.from("produtos").select("id").eq("grupo_id",a);if(s)throw s;if(i&&i.length>0)return void alert(`Não é possível excluir este grupo porque existem ${i.length} produtos associados a ele.`);const{error:r}=await g.ND.from("grupos").delete().eq("id",a);if(r)throw r;alert("Grupo excluído com sucesso!"),await n()}catch(e){console.error("Erro ao excluir grupo:",e),alert(`Erro ao excluir grupo: ${e.message}`)}finally{t.value=!1}};return{grupos:a,loading:t,salvando:e,mostrarFormulario:i,modoEdicao:s,grupoAtual:r,carregarGrupos:n,formatarData:l,editarGrupo:c,fecharFormulario:d,salvarGrupo:u,confirmarExclusao:m}}},mt=ut;var pt=(0,r.A)(mt,ct,dt,!1,null,"3509bc35",null);const vt=pt.exports;var gt=function(){var a=this,t=a._self._c;return t("div",{staticClass:"classes-list"},[t("div",{staticClass:"header"},[t("h3",[a._v("Gerenciamento de Classes")]),t("button",{staticClass:"btn-add",on:{click:function(t){a.mostrarFormulario=!0}}},[a._v(" Adicionar Classe ")])]),a.loading?t("div",{staticClass:"loading"},[t("p",[a._v("Carregando classes...")])]):0===a.classes.length?t("div",{staticClass:"empty-state"},[t("p",[a._v("Nenhuma classe cadastrada.")])]):t("div",{staticClass:"classes-table"},[t("table",[a._m(0),t("tbody",a._l(a.classes,(function(e){return t("tr",{key:e.id},[t("td",[a._v(a._s(e.nome))]),t("td",[a._v(a._s(a.getNomeGrupo(e.grupo_id)))]),t("td",[a._v(a._s(e.descricao||"-"))]),t("td",[a._v(a._s(a.formatarData(e.created_at)))]),t("td",{staticClass:"actions"},[t("button",{staticClass:"btn-edit",on:{click:function(t){return a.editarClasse(e)}}},[a._v("Editar")]),t("button",{staticClass:"btn-delete",on:{click:function(t){return a.confirmarExclusao(e)}}},[a._v("Excluir")])])])})),0)])]),a.mostrarFormulario?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h3",[a._v(a._s(a.modoEdicao?"Editar":"Adicionar")+" Classe")]),t("button",{staticClass:"btn-close",on:{click:a.fecharFormulario}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.salvarClasse.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"grupo"}},[a._v("Grupo*")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.grupo_id,expression:"classeAtual.grupo_id"}],attrs:{id:"grupo",required:""},on:{change:function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.classeAtual,"grupo_id",t.target.multiple?e:e[0])}}},[t("option",{attrs:{value:""}},[a._v("Selecione...")]),a._l(a.grupos,(function(e){return t("option",{key:e.id,domProps:{value:e.id}},[a._v(" "+a._s(e.nome)+" ")])}))],2),0===a.grupos.length?t("div",{staticClass:"error-text"},[t("p",[a._v("É necessário cadastrar pelo menos um grupo antes de adicionar classes.")])]):a._e()]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"nome"}},[a._v("Nome da Classe*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.nome,expression:"classeAtual.nome"}],attrs:{id:"nome",type:"text",required:""},domProps:{value:a.classeAtual.nome},on:{input:function(t){t.target.composing||a.$set(a.classeAtual,"nome",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"descricao"}},[a._v("Descrição")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.classeAtual.descricao,expression:"classeAtual.descricao"}],attrs:{id:"descricao",rows:"3"},domProps:{value:a.classeAtual.descricao},on:{input:function(t){t.target.composing||a.$set(a.classeAtual,"descricao",t.target.value)}}})]),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharFormulario}},[a._v("Cancelar")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.salvando||0===a.grupos.length}},[a._v(" "+a._s(a.salvando?"Salvando...":"Salvar")+" ")])])])])])]):a._e()])},ft=[function(){var a=this,t=a._self._c;return t("thead",[t("tr",[t("th",[a._v("Nome")]),t("th",[a._v("Grupo")]),t("th",[a._v("Descrição")]),t("th",[a._v("Data de Criação")]),t("th",[a._v("Ações")])])])}];const ht={name:"ClassesList",setup(){const a=(0,o.KR)([]),t=(0,o.KR)([]),e=(0,o.KR)(!0),i=(0,o.KR)(!1),s=(0,o.KR)(!1),r=(0,o.KR)(!1),n=(0,o.Kh)({id:null,grupo_id:"",nome:"",descricao:""});(0,o.sV)((async()=>{await Promise.all([l(),c()])}));const l=async()=>{try{const{data:a,error:e}=await g.ND.from("grupos").select("*").order("nome");if(e)throw e;t.value=a||[]}catch(a){console.error("Erro ao carregar grupos:",a),alert("Erro ao carregar grupos. Por favor, tente novamente.")}},c=async()=>{try{e.value=!0;const{data:t,error:o}=await g.ND.from("classes").select("*").order("nome");if(o)throw o;a.value=t||[]}catch(t){console.error("Erro ao carregar classes:",t),alert("Erro ao carregar classes. Por favor, tente novamente.")}finally{e.value=!1}},d=a=>{const e=t.value.find((t=>t.id===a));return e?e.nome:"Grupo não encontrado"},u=a=>{if(!a)return"-";const t=new Date(a);return t.toLocaleDateString("pt-BR")},m=a=>{r.value=!0,n.id=a.id,n.grupo_id=a.grupo_id,n.nome=a.nome,n.descricao=a.descricao||"",s.value=!0},p=()=>{s.value=!1,r.value=!1,n.id=null,n.grupo_id="",n.nome="",n.descricao=""},v=async()=>{try{if(i.value=!0,r.value){const{error:a}=await g.ND.from("classes").update({grupo_id:n.grupo_id,nome:n.nome,descricao:n.descricao}).eq("id",n.id);if(a)throw a;alert("Classe atualizada com sucesso!")}else{const{error:a}=await g.ND.from("classes").insert({grupo_id:n.grupo_id,nome:n.nome,descricao:n.descricao});if(a)throw a;alert("Classe adicionada com sucesso!")}await c(),p()}catch(a){console.error("Erro ao salvar classe:",a),alert(`Erro ao ${r.value?"atualizar":"adicionar"} classe: ${a.message}`)}finally{i.value=!1}},f=a=>{confirm(`Deseja realmente excluir a classe "${a.nome}"?`)&&h(a.id)},h=async a=>{try{e.value=!0;const{data:t,error:o}=await g.ND.from("produtos").select("id").eq("classe_id",a);if(o)throw o;if(t&&t.length>0)return void alert(`Não é possível excluir esta classe porque existem ${t.length} produtos associados a ela.`);const{error:i}=await g.ND.from("classes").delete().eq("id",a);if(i)throw i;alert("Classe excluída com sucesso!"),await c()}catch(t){console.error("Erro ao excluir classe:",t),alert(`Erro ao excluir classe: ${t.message}`)}finally{e.value=!1}};return{classes:a,grupos:t,loading:e,salvando:i,mostrarFormulario:s,modoEdicao:r,classeAtual:n,carregarClasses:c,carregarGrupos:l,getNomeGrupo:d,formatarData:u,editarClasse:m,fecharFormulario:p,salvarClasse:v,confirmarExclusao:f}}},_t=ht;var Ct=(0,r.A)(_t,gt,ft,!1,null,"7574422a",null);const bt=Ct.exports,wt={name:"Classificacao",components:{GruposList:vt,ClassesList:bt},setup(){const a=(0,o.KR)("grupos");return{activeTab:a}}},Dt=wt;var Et=(0,r.A)(Dt,nt,lt,!1,null,"35477b05",null);const yt=Et.exports,xt={name:"ClassificacaoView",components:{Classificacao:yt},data(){return{dropdownOpen:!1,nomeUsuario:"comprarBemTeste",emailUsuario:"comprarbemteste@gmail.com",emailRemetente:"cpm@suaorganizacao.com.br",nomeRemetente:"CPM - Comissão de Padronização de Materiais"}},mounted(){this.carregarConfiguracoes(),document.addEventListener("click",this.fecharDropdownFora)},beforeUnmount(){document.removeEventListener("click",this.fecharDropdownFora)},methods:{async logout(){try{await g.ND.auth.signOut(),this.$router.push("/")}catch(a){console.error("Erro ao fazer logout:",a)}},toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},fecharDropdownFora(a){this.$el.querySelector(".profile-dropdown").contains(a.target)||(this.dropdownOpen=!1)},async abrirConfiguracaoEmail(){this.dropdownOpen=!1;const{value:a}=await this.$swal({title:"📧 Configurar Email do Sistema",html:`\n          <div style="text-align: left; padding: 10px;">\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Email Remetente (CPM):</label>\n              <input id="emailRemetente" class="swal2-input" value="${this.emailRemetente}" type="email" placeholder="cpm@suaorganizacao.com.br">\n              <small style="color: #666; font-size: 11px;">Email que aparece como remetente das diligências</small>\n            </div>\n            <div style="margin-bottom: 15px;">\n              <label style="display: block; font-weight: bold; margin-bottom: 5px;">Nome do Remetente:</label>\n              <input id="nomeRemetente" class="swal2-input" value="${this.nomeRemetente}" type="text" placeholder="CPM - Comissão de Padronização de Materiais">\n            </div>\n          </div>\n        `,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"💾 Salvar",cancelButtonText:"❌ Cancelar",preConfirm:()=>{const a=document.getElementById("emailRemetente").value,t=document.getElementById("nomeRemetente").value;return a&&t?{emailRemetente:a,nomeRemetente:t}:(this.$swal.showValidationMessage("Por favor, preencha todos os campos"),!1)}});if(a){this.emailRemetente=a.emailRemetente,this.nomeRemetente=a.nomeRemetente;const t={emailRemetente:a.emailRemetente,nomeRemetente:a.nomeRemetente};localStorage.setItem("configsSistema",JSON.stringify(t)),this.$swal({title:"✅ Sucesso!",text:"Configurações de email salvas com sucesso!",icon:"success"})}},carregarConfiguracoes(){try{const a=localStorage.getItem("configsSistema");if(a){const t=JSON.parse(a);this.emailRemetente=t.emailRemetente||this.emailRemetente,this.nomeRemetente=t.nomeRemetente||this.nomeRemetente}}catch(a){console.error("Erro ao carregar configurações:",a)}},closeDropdown(){this.dropdownOpen=!1}}},Pt=xt;var At=(0,r.A)(Pt,st,rt,!1,null,"7461ecae",null);const Nt=At.exports;var St=function(){var a=this,t=a._self._c;return t("div",{staticClass:"editais-publicos"},[a._m(0),t("div",{staticClass:"container"},[t("div",{staticClass:"filtros-section"},[t("div",{staticClass:"filtros-grid"},[t("div",{staticClass:"filtro-item"},[t("label",[a._v("🔍 Buscar:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.busca,expression:"filtros.busca"}],attrs:{type:"text",placeholder:"Número do edital, descrição..."},domProps:{value:a.filtros.busca},on:{input:[function(t){t.target.composing||a.$set(a.filtros,"busca",t.target.value)},a.aplicarFiltros]}})]),t("div",{staticClass:"filtro-item"},[t("label",[a._v("📅 Publicados em:")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.filtros.dataPublicacao,expression:"filtros.dataPublicacao"}],attrs:{type:"date"},domProps:{value:a.filtros.dataPublicacao},on:{change:a.aplicarFiltros,input:function(t){t.target.composing||a.$set(a.filtros,"dataPublicacao",t.target.value)}}})]),t("div",{staticClass:"filtro-item"},[t("label",[a._v("⏰ Status:")]),t("select",{directives:[{name:"model",rawName:"v-model",value:a.filtros.status,expression:"filtros.status"}],on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,(function(a){return a.selected})).map((function(a){var t="_value"in a?a._value:a.value;return t}));a.$set(a.filtros,"status",t.target.multiple?e:e[0])},a.aplicarFiltros]}},[t("option",{attrs:{value:""}},[a._v("Todos")]),t("option",{attrs:{value:"ABERTO"}},[a._v("Em andamento")]),t("option",{attrs:{value:"PRAZO_FINAL"}},[a._v("Prazo final")])])])])]),a.loading?t("div",{staticClass:"loading-section"},[t("div",{staticClass:"spinner"}),t("p",[a._v("Carregando editais...")])]):a.editaisFiltrados.length>0?t("div",{staticClass:"editais-lista"},a._l(a.editaisFiltrados,(function(e){return t("div",{key:e.id,staticClass:"edital-card"},[t("div",{staticClass:"edital-header"},[t("div",{staticClass:"edital-numero"},[t("h3",[a._v(a._s(e.numero))]),t("span",{staticClass:"status-badge",class:a.getStatusClass(e)},[a._v(" "+a._s(a.getStatusText(e))+" ")])]),t("div",{staticClass:"edital-datas"},[t("p",[t("strong",[a._v("📅 Publicado:")]),a._v(" "+a._s(a.formatDate(e.data_publicacao)))]),e.data_limite_impugnacao?t("p",[t("strong",[a._v("⏰ Prazo:")]),a._v(" "+a._s(a.formatDate(e.data_limite_impugnacao))+" "),a.isPrazoFinal(e)?t("span",{staticClass:"prazo-final"},[a._v("⚠️ Últimos dias!")]):a._e()]):a._e()])]),t("div",{staticClass:"edital-content"},[t("h4",[a._v(a._s(e.descricao))]),e.conteudo?t("p",{staticClass:"edital-resumo"},[a._v(" "+a._s(e.conteudo.substring(0,200))+a._s(e.conteudo.length>200?"...":"")+" ")]):a._e()]),t("div",{staticClass:"edital-actions"},[e.url_documento?t("button",{staticClass:"btn-secondary",on:{click:function(t){return a.abrirDocumento(e.url_documento)}}},[a._v(" 📄 Ver Edital ")]):a._e(),t("button",{staticClass:"btn-primary",attrs:{disabled:!a.podeParticipar(e)},on:{click:function(t){return a.abrirModalInscricao(e)}}},[a._v(" "+a._s(a.getTextoBotao(e))+" ")])])])})),0):t("div",{staticClass:"empty-state"},[t("div",{staticClass:"empty-icon"},[a._v("📋")]),t("h3",[a._v("Nenhum edital encontrado")]),a.filtros.busca||a.filtros.dataPublicacao||a.filtros.status?t("p",[a._v(" Nenhum edital corresponde aos filtros aplicados. ")]):t("p",[a._v(" Não há editais públicos disponíveis no momento. ")])])]),a.modalInscricao?t("div",{staticClass:"modal-overlay",on:{click:a.fecharModalInscricao}},[t("div",{staticClass:"modal-content large",on:{click:function(a){a.stopPropagation()}}},[t("div",{staticClass:"modal-header"},[t("h3",[a._v("📝 Inscrição no Edital "+a._s(a.editalSelecionado.numero))]),t("button",{staticClass:"btn-close",on:{click:a.fecharModalInscricao}},[a._v("×")])]),t("div",{staticClass:"modal-body"},[t("div",{staticClass:"edital-info"},[t("h4",[a._v(a._s(a.editalSelecionado.descricao))]),t("p",[t("strong",[a._v("Prazo para participação:")]),a._v(" "+a._s(a.formatDate(a.editalSelecionado.data_limite_impugnacao)))])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.enviarInscricao.apply(null,arguments)}}},[t("h5",[a._v("📋 Dados da Empresa")]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"razao_social"}},[a._v("Razão Social*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.razao_social,expression:"inscricao.razao_social"}],attrs:{id:"razao_social",type:"text",placeholder:"Nome completo da empresa",required:""},domProps:{value:a.inscricao.razao_social},on:{input:function(t){t.target.composing||a.$set(a.inscricao,"razao_social",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"cnpj"}},[a._v("CNPJ*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.cnpj,expression:"inscricao.cnpj"}],attrs:{id:"cnpj",type:"text",placeholder:"00.000.000/0000-00",maxlength:"18",required:""},domProps:{value:a.inscricao.cnpj},on:{input:[function(t){t.target.composing||a.$set(a.inscricao,"cnpj",t.target.value)},a.aplicarMascaraCNPJ],blur:a.validarCNPJ}}),a.cnpjInvalido?t("small",{staticClass:"text-danger"},[a._v(" ⚠️ CNPJ inválido. Verifique os números digitados. ")]):a._e()])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"representante_legal"}},[a._v("Representante Legal*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.representante_legal,expression:"inscricao.representante_legal"}],attrs:{id:"representante_legal",type:"text",placeholder:"Nome do responsável",required:""},domProps:{value:a.inscricao.representante_legal},on:{input:function(t){t.target.composing||a.$set(a.inscricao,"representante_legal",t.target.value)}}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"email"}},[a._v("Email para Contato*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.email,expression:"inscricao.email"}],attrs:{id:"email",type:"email",placeholder:"contato@empresa.com",required:""},domProps:{value:a.inscricao.email},on:{input:function(t){t.target.composing||a.$set(a.inscricao,"email",t.target.value)}}})])]),t("div",{staticClass:"form-row"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"telefone"}},[a._v("Telefone*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.telefone,expression:"inscricao.telefone"}],attrs:{id:"telefone",type:"text",placeholder:"(11) 99999-9999",maxlength:"15",required:""},domProps:{value:a.inscricao.telefone},on:{input:[function(t){t.target.composing||a.$set(a.inscricao,"telefone",t.target.value)},a.aplicarMascaraTelefone]}})]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"endereco"}},[a._v("Endereço Completo*")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.endereco,expression:"inscricao.endereco"}],attrs:{id:"endereco",type:"text",placeholder:"Endereço da sede da empresa",required:""},domProps:{value:a.inscricao.endereco},on:{input:function(t){t.target.composing||a.$set(a.inscricao,"endereco",t.target.value)}}})])]),t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"observacoes"}},[a._v("Observações (Opcional)")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:a.inscricao.observacoes,expression:"inscricao.observacoes"}],attrs:{id:"observacoes",rows:"3",placeholder:"Informações adicionais sobre sua participação..."},domProps:{value:a.inscricao.observacoes},on:{input:function(t){t.target.composing||a.$set(a.inscricao,"observacoes",t.target.value)}}})]),a._m(1),t("div",{staticClass:"form-actions"},[t("button",{staticClass:"btn-secondary",attrs:{type:"button"},on:{click:a.fecharModalInscricao}},[a._v(" Cancelar ")]),t("button",{staticClass:"btn-primary",attrs:{type:"submit",disabled:a.enviandoInscricao}},[a._v(" "+a._s(a.enviandoInscricao?"Enviando...":"📤 Confirmar Inscrição")+" ")])])])])])]):a._e()])},Rt=[function(){var a=this,t=a._self._c;return t("div",{staticClass:"hero-section"},[t("div",{staticClass:"container"},[t("h1",[a._v("📋 Editais de Pré-Qualificação")]),t("p",[a._v("Consulte os editais públicos e participe dos processos de pré-qualificação técnica de bens.")])])])},function(){var a=this,t=a._self._c;return t("div",{staticClass:"form-disclaimer"},[t("div",{staticClass:"disclaimer-box"},[t("h6",[a._v("⚠️ Importante:")]),t("ul",[t("li",[a._v("Esta inscrição é apenas uma manifestação de interesse")]),t("li",[a._v("Você deverá enviar a documentação técnica conforme especificado no edital")]),t("li",[a._v("A análise será feita pela Comissão de Padronização de Materiais (CPM)")]),t("li",[a._v("O resultado será comunicado pelo email informado")])])])])}];const It={name:"EditaisPublicos",data(){return{editais:[],editaisFiltrados:[],loading:!1,modalInscricao:!1,enviandoInscricao:!1,editalSelecionado:{},filtros:{busca:"",dataPublicacao:"",status:""},inscricao:{razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",observacoes:""},cnpjInvalido:!1}},async mounted(){await this.carregarEditais()},methods:{async carregarEditais(){try{this.loading=!0;const{data:a,error:t}=await g.ND.from("editais").select("*").eq("status","PUBLICADO").order("data_publicacao",{ascending:!1});if(t)throw t;this.editais=a||[],this.aplicarFiltros()}catch(a){console.error("Erro ao carregar editais:",a),this.$swal.fire({icon:"error",title:"Erro",text:"Erro ao carregar editais públicos",zIndex:1e4})}finally{this.loading=!1}},aplicarFiltros(){let a=[...this.editais];if(this.filtros.busca){const t=this.filtros.busca.toLowerCase();a=a.filter((a=>a.numero.toLowerCase().includes(t)||a.descricao.toLowerCase().includes(t)||a.conteudo&&a.conteudo.toLowerCase().includes(t)))}this.filtros.dataPublicacao&&(a=a.filter((a=>{const t=new Date(a.data_publicacao).toISOString().split("T")[0];return t===this.filtros.dataPublicacao}))),"ABERTO"===this.filtros.status?a=a.filter((a=>this.podeParticipar(a))):"PRAZO_FINAL"===this.filtros.status&&(a=a.filter((a=>this.isPrazoFinal(a)))),this.editaisFiltrados=a},abrirModalInscricao(a){this.editalSelecionado={...a},this.modalInscricao=!0,this.limparFormulario()},fecharModalInscricao(){this.modalInscricao=!1,this.editalSelecionado={},this.limparFormulario()},limparFormulario(){this.inscricao={razao_social:"",cnpj:"",representante_legal:"",email:"",telefone:"",endereco:"",observacoes:""}},async enviarInscricao(){try{if(this.enviandoInscricao=!0,console.log("Iniciando inscrição...",{edital:this.editalSelecionado.numero,empresa:this.inscricao.razao_social}),!this.inscricao.razao_social||!this.inscricao.cnpj||!this.inscricao.representante_legal||!this.inscricao.email||!this.inscricao.telefone||!this.inscricao.endereco)return void this.$swal.fire({icon:"error",title:"Erro",text:"Preencha todos os campos obrigatórios",zIndex:1e4});if(!this.validarCNPJ())return void this.$swal.fire({icon:"error",title:"Erro",text:"CNPJ inválido. Verifique os números digitados.",zIndex:1e4});const a=this.inscricao.telefone.replace(/\D/g,"");if(a.length<10)return void this.$swal.fire({icon:"error",title:"Erro",text:"Telefone deve ter pelo menos 10 dígitos",zIndex:1e4});const t=this.inscricao.cnpj.replace(/\D/g,""),{data:e,error:o}=await g.ND.from("participantes_editais").select("id").eq("edital_id",this.editalSelecionado.id).eq("cnpj",t).single();if(o&&"PGRST116"!==o.code)throw console.error("Erro ao consultar participantes:",o),new Error("Erro ao verificar inscrição existente");if(e)return void this.$swal.fire({icon:"warning",title:"Aviso",text:"Esta empresa já está inscrita neste edital",zIndex:1e4});const{error:i}=await g.ND.from("participantes_editais").insert({tenant_id:this.editalSelecionado.tenant_id,edital_id:this.editalSelecionado.id,razao_social:this.inscricao.razao_social,cnpj:t,representante_legal:this.inscricao.representante_legal,email:this.inscricao.email,telefone:this.inscricao.telefone,endereco:this.inscricao.endereco,status:"INTERESSADO",observacoes:this.inscricao.observacoes,data_participacao:(new Date).toISOString()});if(i)throw console.error("Erro ao inserir participante:",i),i;console.log("Inscrição realizada com sucesso!"),this.fecharModalInscricao(),this.$swal.fire({icon:"success",title:"Inscrição realizada!",html:`\n            <p>Sua empresa foi inscrita no edital <strong>${this.editalSelecionado.numero}</strong> com sucesso!</p>\n            <br>\n            <p><strong>Próximos passos:</strong></p>\n            <ul style="text-align: left; margin: 10px 0;">\n              <li>Prepare a documentação técnica conforme especificado no edital</li>\n              <li>Envie os documentos no prazo estabelecido</li>\n              <li>Aguarde o contato da CPM pelo email informado</li>\n            </ul>\n          `,confirmButtonText:"Entendi",zIndex:1e4})}catch(a){console.error("Erro ao enviar inscrição:",a),this.$swal.fire({icon:"error",title:"Erro ao enviar inscrição",text:a.message,zIndex:1e4})}finally{this.enviandoInscricao=!1}},podeParticipar(a){return!a.data_limite_impugnacao||new Date<=new Date(a.data_limite_impugnacao)},isPrazoFinal(a){if(!a.data_limite_impugnacao)return!1;const t=new Date,e=new Date(a.data_limite_impugnacao),o=(e-t)/864e5;return o<=7&&o>0},getStatusClass(a){return this.podeParticipar(a)?this.isPrazoFinal(a)?"status-prazo-final":"status-aberto":"status-encerrado"},getStatusText(a){return this.podeParticipar(a)?this.isPrazoFinal(a)?"⚠️ Prazo Final":"✅ Aberto":"🔒 Encerrado"},getTextoBotao(a){return this.podeParticipar(a)?"📝 Participar":"🔒 Prazo Encerrado"},abrirDocumento(a){a&&window.open(a,"_blank")},formatDate(a){return a?new Date(a).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"},aplicarMascaraCNPJ(a){let t=a.target.value.replace(/\D/g,"");t=t.replace(/^(\d{2})(\d)/,"$1.$2"),t=t.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),t=t.replace(/\.(\d{3})(\d)/,".$1/$2"),t=t.replace(/(\d{4})(\d)/,"$1-$2"),this.inscricao.cnpj=t,this.cnpjInvalido=!1},validarCNPJ(){const a=this.inscricao.cnpj.replace(/\D/g,"");if(14!==a.length)return this.cnpjInvalido=!0,!1;if(/^(\d)\1{13}$/.test(a))return this.cnpjInvalido=!0,!1;let t=a.length-2,e=a.substring(0,t);const o=a.substring(t);let i=0,s=t-7;for(let n=t;n>=1;n--)i+=e.charAt(t-n)*s--,s<2&&(s=9);let r=i%11<2?0:11-i%11;if(r!=o.charAt(0))return this.cnpjInvalido=!0,!1;t+=1,e=a.substring(0,t),i=0,s=t-7;for(let n=t;n>=1;n--)i+=e.charAt(t-n)*s--,s<2&&(s=9);return r=i%11<2?0:11-i%11,r!=o.charAt(1)?(this.cnpjInvalido=!0,!1):(this.cnpjInvalido=!1,!0)},aplicarMascaraTelefone(a){let t=a.target.value.replace(/\D/g,"");t.length<=10?(t=t.replace(/^(\d{2})(\d)/,"($1) $2"),t=t.replace(/(\d{4})(\d)/,"$1-$2")):(t=t.replace(/^(\d{2})(\d)/,"($1) $2"),t=t.replace(/(\d{5})(\d)/,"$1-$2")),this.inscricao.telefone=t}}},$t=It;var kt=(0,r.A)($t,St,Rt,!1,null,"46686322",null);const Tt=kt.exports;o.Ay.use(d.Ay);const Bt=[{path:"/",name:"Home",component:y,meta:{requiresAuth:!1}},{path:"/editais-publicos",name:"EditaisPublicos",component:Tt,meta:{requiresAuth:!1}},{path:"/dashboard",name:"Dashboard",component:M,meta:{requiresAuth:!0}},{path:"/ccl",name:"CCL",component:it,meta:{requiresAuth:!0}},{path:"/cadastro",name:"Cadastro",component:K,meta:{requiresAuth:!0}},{path:"/analise/:id",name:"Analise",component:da,meta:{requiresAuth:!0}},{path:"/catalogo",name:"Catalogo",component:Da,meta:{requiresAuth:!0}},{path:"/feedback",name:"Feedback",component:Ta,meta:{requiresAuth:!0}},{path:"/dcb",name:"DCB",component:Ja,meta:{requiresAuth:!0}},{path:"/classificacao",name:"Classificacao",component:Nt,meta:{requiresAuth:!0}},{path:"/produtos/:id",name:"DetalheProduto",component:()=>e.e(917).then(e.bind(e,6917)),props:!0,meta:{requiresAuth:!0}},{path:"/validar-dcb/:numero/:ano",name:"ValidarDCB",component:()=>e.e(202).then(e.bind(e,6202)),props:!0,meta:{requiresAuth:!1}}],Mt=new d.Ay({mode:"hash",base:"/ComprarBem/",routes:Bt});Mt.beforeEach((async(a,t,e)=>{const o=a.matched.some((a=>a.meta.requiresAuth));if(o)try{const{data:a}=await g.ND.auth.getSession(),t=a?.session?.user;o&&!t?e("/"):e()}catch(i){console.error("Erro na verificação de autenticação:",i),o?e("/"):e()}else e()}));const Ft=Mt;var Ot=e(5353);o.Ay.use(Ot.Ay);const zt=new Ot.Ay.Store({state:{user:null,tenant:null,isLoading:!1},mutations:{SET_USER(a,t){a.user=t},SET_TENANT(a,t){a.tenant=t},SET_LOADING(a,t){a.isLoading=t}},actions:{async fetchUser({commit:a}){const{data:t}=await g.ND.auth.getSession(),e=t?.session?.user;if(a("SET_USER",e),e){const{data:t,error:o}=await g.ND.from("tenants").select("*").eq("id",e.user_metadata?.tenant_id).single();!o&&t&&a("SET_TENANT",t)}},setLoading({commit:a},t){a("SET_LOADING",t)}},getters:{isAuthenticated:a=>!!a.user,currentUser:a=>a.user,currentTenant:a=>a.tenant,isLoading:a=>a.isLoading}});var qt=e(8640),Lt=e(5201),Ut=e.n(Lt);o.Ay.config.productionTip=!1,o.Ay.use(qt.A),o.Ay.use(Ut()),new o.Ay({router:Ft,store:zt,render:a=>a(c)}).$mount("#app")}},t={};function e(o){var i=t[o];if(void 0!==i)return i.exports;var s=t[o]={exports:{}};return a[o].call(s.exports,s,s.exports,e),s.exports}e.m=a,(()=>{var a=[];e.O=(t,o,i,s)=>{if(!o){var r=1/0;for(d=0;d<a.length;d++){for(var[o,i,s]=a[d],n=!0,l=0;l<o.length;l++)(!1&s||r>=s)&&Object.keys(e.O).every((a=>e.O[a](o[l])))?o.splice(l--,1):(n=!1,s<r&&(r=s));if(n){a.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=a.length;d>0&&a[d-1][2]>s;d--)a[d]=a[d-1];a[d]=[o,i,s]}})(),(()=>{e.n=a=>{var t=a&&a.__esModule?()=>a["default"]:()=>a;return e.d(t,{a:t}),t}})(),(()=>{var a,t=Object.getPrototypeOf?a=>Object.getPrototypeOf(a):a=>a.__proto__;e.t=function(o,i){if(1&i&&(o=this(o)),8&i)return o;if("object"===typeof o&&o){if(4&i&&o.__esModule)return o;if(16&i&&"function"===typeof o.then)return o}var s=Object.create(null);e.r(s);var r={};a=a||[null,t({}),t([]),t(t)];for(var n=2&i&&o;"object"==typeof n&&!~a.indexOf(n);n=t(n))Object.getOwnPropertyNames(n).forEach((a=>r[a]=()=>o[a]));return r["default"]=()=>o,e.d(s,r),s}})(),(()=>{e.d=(a,t)=>{for(var o in t)e.o(t,o)&&!e.o(a,o)&&Object.defineProperty(a,o,{enumerable:!0,get:t[o]})}})(),(()=>{e.f={},e.e=a=>Promise.all(Object.keys(e.f).reduce(((t,o)=>(e.f[o](a,t),t)),[]))})(),(()=>{e.u=a=>"js/"+a+"."+{202:"cdd0b339",323:"7f6b400e",332:"6265e2a2",354:"8ee0fe22",418:"d7c8b7cf",583:"d47e751a",591:"1422f99d",917:"676015d7"}[a]+".js"})(),(()=>{e.miniCssF=a=>"css/"+a+"."+{202:"6df57699",917:"401b363e"}[a]+".css"})(),(()=>{e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()})(),(()=>{e.o=(a,t)=>Object.prototype.hasOwnProperty.call(a,t)})(),(()=>{var a={},t="comprar-bem:";e.l=(o,i,s,r)=>{if(a[o])a[o].push(i);else{var n,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==o||u.getAttribute("data-webpack")==t+s){n=u;break}}n||(l=!0,n=document.createElement("script"),n.charset="utf-8",n.timeout=120,e.nc&&n.setAttribute("nonce",e.nc),n.setAttribute("data-webpack",t+s),n.src=o),a[o]=[i];var m=(t,e)=>{n.onerror=n.onload=null,clearTimeout(p);var i=a[o];if(delete a[o],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((a=>a(e))),t)return t(e)},p=setTimeout(m.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=m.bind(null,n.onerror),n.onload=m.bind(null,n.onload),l&&document.head.appendChild(n)}}})(),(()=>{e.r=a=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}})(),(()=>{e.p="/ComprarBem/"})(),(()=>{if("undefined"!==typeof document){var a=(a,t,o,i,s)=>{var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",e.nc&&(r.nonce=e.nc);var n=e=>{if(r.onerror=r.onload=null,"load"===e.type)i();else{var o=e&&e.type,n=e&&e.target&&e.target.href||t,l=new Error("Loading CSS chunk "+a+" failed.\n("+o+": "+n+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=n,r.parentNode&&r.parentNode.removeChild(r),s(l)}};return r.onerror=r.onload=n,r.href=t,o?o.parentNode.insertBefore(r,o.nextSibling):document.head.appendChild(r),r},t=(a,t)=>{for(var e=document.getElementsByTagName("link"),o=0;o<e.length;o++){var i=e[o],s=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(s===a||s===t))return i}var r=document.getElementsByTagName("style");for(o=0;o<r.length;o++){i=r[o],s=i.getAttribute("data-href");if(s===a||s===t)return i}},o=o=>new Promise(((i,s)=>{var r=e.miniCssF(o),n=e.p+r;if(t(r,n))return i();a(o,n,null,i,s)})),i={524:0};e.f.miniCss=(a,t)=>{var e={202:1,917:1};i[a]?t.push(i[a]):0!==i[a]&&e[a]&&t.push(i[a]=o(a).then((()=>{i[a]=0}),(t=>{throw delete i[a],t})))}}})(),(()=>{var a={524:0};e.f.j=(t,o)=>{var i=e.o(a,t)?a[t]:void 0;if(0!==i)if(i)o.push(i[2]);else{var s=new Promise(((e,o)=>i=a[t]=[e,o]));o.push(i[2]=s);var r=e.p+e.u(t),n=new Error,l=o=>{if(e.o(a,t)&&(i=a[t],0!==i&&(a[t]=void 0),i)){var s=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;n.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",n.name="ChunkLoadError",n.type=s,n.request=r,i[1](n)}};e.l(r,l,"chunk-"+t,t)}},e.O.j=t=>0===a[t];var t=(t,o)=>{var i,s,[r,n,l]=o,c=0;if(r.some((t=>0!==a[t]))){for(i in n)e.o(n,i)&&(e.m[i]=n[i]);if(l)var d=l(e)}for(t&&t(o);c<r.length;c++)s=r[c],e.o(a,s)&&a[s]&&a[s][0](),a[s]=0;return e.O(d)},o=self["webpackChunkcomprar_bem"]=self["webpackChunkcomprar_bem"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=e.O(void 0,[504],(()=>e(4252)));o=e.O(o)})();
//# sourceMappingURL=app.e0e458ca.js.map