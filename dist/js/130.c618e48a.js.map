{"version":3,"file":"js/130.c618e48a.js","mappings":"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","sources":["webpack://comprar-bem/./src/services/wordToPdfService.js"],"sourcesContent":["/**\n * üéØ SERVI√áO DE CONVERS√ÉO WORD ‚Üí PDF PRESERVANDO 100% DO LAYOUT\n * \n * FUN√á√ÉO: Converte documentos Word para PDF mantendo formata√ß√£o id√™ntica\n * M√âTODOS: \n * 1. PDF-lib com convers√£o direta (preferido)\n * 2. LibreOffice/OnlyOffice API (se dispon√≠vel)\n * 3. Word Web API (Microsoft Office Online)\n * 4. Fallback com mammoth otimizado\n * \n * OBJETIVO: Layout 100% id√™ntico ao Word original\n * ‚úÖ Preserva tabelas exatas\n * ‚úÖ Mant√©m quadros e caixas\n * ‚úÖ Conserva marca√ß√µes e formata√ß√£o\n * ‚úÖ Fonts e espacamentos originais\n */\n\nexport class WordToPdfService {\n  constructor() {\n    this.docxConverter = null\n    this.pdfLib = null\n    this.mammoth = null\n    this.jsPDF = null\n    this.html2canvas = null\n  }\n\n  /**\n   * Fun√ß√£o principal de convers√£o com m√∫ltiplos m√©todos\n   */\n  async convertWordToPdf(fileUrl, fileName = 'documento') {\n    console.log('üéØ === CONVERS√ÉO WORD ‚Üí PDF PRESERVANDO 100% LAYOUT ===')\n    console.log('üìÑ Arquivo:', fileUrl)\n\n    // Tentar m√©todos em ordem de qualidade (do melhor para o b√°sico)\n    const methods = [\n      { name: 'CloudConvert API', fn: () => this.convertUsingCloudConvert(fileUrl, fileName) },\n      { name: 'Docx2PDF Premium', fn: () => this.convertUsingDocx2Pdf(fileUrl, fileName) },\n      { name: 'LibreOffice API', fn: () => this.convertUsingLibreOffice(fileUrl, fileName) },\n      { name: 'PDFLib Direct', fn: () => this.convertUsingPDFLib(fileUrl, fileName) },\n      { name: 'Word Web API', fn: () => this.convertUsingWordAPI(fileUrl, fileName) },\n      { name: 'Mammoth Optimized', fn: () => this.convertUsingMammothOptimized(fileUrl, fileName) }\n    ]\n\n    for (const method of methods) {\n      try {\n        console.log(`üîÑ Tentando m√©todo: ${method.name}`)\n        const result = await method.fn()\n        if (result && result.blob) {\n          console.log(`‚úÖ Sucesso com m√©todo: ${method.name}`)\n          return result\n        }\n      } catch (error) {\n        console.warn(`‚ö†Ô∏è M√©todo ${method.name} falhou:`, error.message)\n        continue\n      }\n    }\n\n    // Se todos falharam, usar fallback simples\n    console.log('üîÑ Usando fallback simples...')\n    return await this.createFallbackPdf(fileName)\n  }\n\n  /**\n   * M√âTODO 1: Convers√£o usando PDF-lib (mais preciso)\n   */\n  async convertUsingPDFLib(fileUrl, fileName) {\n    try {\n      console.log('üìö Carregando PDF-lib...')\n      \n      // Carregar biblioteca especializada\n      const pdfLibModule = await import('pdf-lib')\n      this.pdfLib = pdfLibModule\n      \n      // Baixar arquivo Word\n      const response = await fetch(fileUrl)\n      const arrayBuffer = await response.arrayBuffer()\n      \n      // Verificar se √© poss√≠vel convers√£o direta\n      const fileType = this.detectFileType(arrayBuffer)\n      \n      if (fileType === 'docx') {\n        return await this.convertDocxDirectly(arrayBuffer, fileName)\n      }\n      \n      throw new Error('Arquivo n√£o √© DOCX v√°lido')\n      \n    } catch (error) {\n      throw new Error(`PDF-lib falhou: ${error.message}`)\n    }\n  }\n\n  /**\n   * M√âTODO 2: Convers√£o usando LibreOffice API\n   */\n  async convertUsingLibreOffice(fileUrl, fileName) {\n    try {\n      console.log('üîÑ Tentando LibreOffice/OnlyOffice API...')\n      \n      // Verificar se h√° servidor LibreOffice dispon√≠vel\n      const libreOfficeUrl = this.getLibreOfficeUrl()\n      \n      if (!libreOfficeUrl) {\n        throw new Error('LibreOffice API n√£o dispon√≠vel')\n      }\n      \n      // Enviar para convers√£o\n      const formData = new FormData()\n      const response = await fetch(fileUrl)\n      const blob = await response.blob()\n      formData.append('file', blob, `${fileName}.docx`)\n      \n      const convertResponse = await fetch(`${libreOfficeUrl}/convert/pdf`, {\n        method: 'POST',\n        body: formData\n      })\n      \n      if (!convertResponse.ok) {\n        throw new Error('Falha na convers√£o LibreOffice')\n      }\n      \n      const pdfBlob = await convertResponse.blob()\n      \n      return {\n        blob: pdfBlob,\n        fileName: `${fileName}_LibreOffice.pdf`\n      }\n      \n    } catch (error) {\n      throw new Error(`LibreOffice falhou: ${error.message}`)\n    }\n  }\n\n  /**\n   * M√âTODO 3: Convers√£o usando CloudConvert API (funciona em produ√ß√£o)\n   */\n  async convertUsingCloudConvert(fileUrl, fileName) {\n    try {\n      console.log('üîÑ Tentando CloudConvert API...')\n      \n      // Verificar se h√° API key configurada\n      const apiKey = this.getCloudConvertApiKey()\n      \n      if (!apiKey) {\n        throw new Error('CloudConvert API Key n√£o configurada')\n      }\n      \n      console.log('üîë API Key length:', apiKey.length)\n      console.log('üîë API Key starts with:', apiKey.substring(0, 20) + '...')\n      \n      // Testar API key primeiro\n      console.log('üß™ Testando API key...')\n      const testResponse = await fetch('https://api.cloudconvert.com/v2/users/me', {\n        headers: {\n          'Authorization': `Bearer ${apiKey}`\n        }\n      })\n      \n      if (!testResponse.ok) {\n        const testError = await testResponse.text()\n        console.error('‚ùå API Key inv√°lida:', testResponse.status, testError)\n        throw new Error(`API Key CloudConvert inv√°lida: ${testResponse.status}`)\n      }\n      \n      const userData = await testResponse.json()\n      console.log('‚úÖ API Key v√°lida!')\n      console.log('üë§ Usu√°rio:', userData.data?.email || 'N/A')\n      console.log('üí≥ Plano:', userData.data?.subscription?.plan || 'Free')\n      console.log('üîÑ Convers√µes usadas este m√™s:', userData.data?.subscription?.usage?.conversions || 0)\n      console.log('üìä Limite mensal:', userData.data?.subscription?.limits?.conversions || 25)\n      \n      // Baixar arquivo\n      const response = await fetch(fileUrl)\n      const arrayBuffer = await response.arrayBuffer()\n      const fileBlob = new Blob([arrayBuffer])\n      \n      // 1. Criar job no CloudConvert\n      const jobResponse = await fetch('https://api.cloudconvert.com/v2/jobs', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${apiKey}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          tasks: {\n            \"import-file\": {\n              operation: \"import/upload\"\n            },\n            \"convert-file\": {\n              operation: \"convert\",\n              input: \"import-file\",\n              input_format: \"docx\",\n              output_format: \"pdf\",\n              options: {\n                pdf_a: false,\n                page_range: \"1-\",\n                margin_top: 20,\n                margin_bottom: 20,\n                margin_left: 20,\n                margin_right: 20\n              }\n            },\n            \"export-file\": {\n              operation: \"export/url\",\n              input: \"convert-file\"\n            }\n          }\n        })\n      })\n      \n      if (!jobResponse.ok) {\n        const errorText = await jobResponse.text()\n        console.error('‚ùå CloudConvert job creation failed:', {\n          status: jobResponse.status,\n          statusText: jobResponse.statusText,\n          error: errorText\n        })\n        throw new Error(`Erro ao criar job CloudConvert: ${jobResponse.status} - ${errorText}`)\n      }\n      \n      const job = await jobResponse.json()\n      \n      // 2. Upload do arquivo\n      const uploadTask = job.data.tasks.find(t => t.name === 'import-file')\n      const uploadForm = uploadTask.result.form\n      \n      const formData = new FormData()\n      Object.keys(uploadForm.parameters).forEach(key => {\n        formData.append(key, uploadForm.parameters[key])\n      })\n      formData.append('file', fileBlob, `${fileName}.docx`)\n      \n      await fetch(uploadForm.url, {\n        method: 'POST',\n        body: formData\n      })\n      \n      // 3. Aguardar convers√£o\n      let jobStatus = job.data\n      while (jobStatus.status !== 'finished' && jobStatus.status !== 'error') {\n        await new Promise(resolve => setTimeout(resolve, 2000))\n        \n        const statusResponse = await fetch(`https://api.cloudconvert.com/v2/jobs/${job.data.id}`, {\n          headers: {\n            'Authorization': `Bearer ${apiKey}`\n          }\n        })\n        \n        jobStatus = (await statusResponse.json()).data\n      }\n      \n      if (jobStatus.status === 'error') {\n        throw new Error('Erro na convers√£o CloudConvert')\n      }\n      \n      // 4. Download do PDF\n      const exportTask = jobStatus.tasks.find(t => t.name === 'export-file')\n      const pdfUrl = exportTask.result.files[0].url\n      \n      const pdfResponse = await fetch(pdfUrl)\n      const pdfBlob = await pdfResponse.blob()\n      \n      return {\n        blob: pdfBlob,\n        fileName: `${fileName}_CloudConvert.pdf`\n      }\n      \n    } catch (error) {\n      throw new Error(`CloudConvert falhou: ${error.message}`)\n    }\n  }\n\n  /**\n   * M√âTODO 4: Convers√£o usando Word Web API\n   */\n  async convertUsingWordAPI(fileUrl, fileName) {\n    try {\n      console.log('üîÑ Tentando Word Web API...')\n      \n      // Verificar se h√° chave da API Microsoft\n      const apiKey = this.getMicrosoftApiKey()\n      \n      if (!apiKey) {\n        throw new Error('Microsoft API Key n√£o encontrada')\n      }\n      \n      // Usar Microsoft Graph API para convers√£o\n      const graphUrl = 'https://graph.microsoft.com/v1.0/me/drive/items'\n      \n      // Upload tempor√°rio e convers√£o\n      const response = await fetch(fileUrl)\n      const arrayBuffer = await response.arrayBuffer()\n      \n      // Simula√ß√£o da API (implementar quando dispon√≠vel)\n      throw new Error('Word API n√£o implementada ainda')\n      \n    } catch (error) {\n      throw new Error(`Word API falhou: ${error.message}`)\n    }\n  }\n\n  /**\n   * M√âTODO 4: Mammoth otimizado para m√°xima fidelidade\n   */\n  async convertUsingMammothOptimized(fileUrl, fileName) {\n    try {\n      console.log('üîÑ Usando Mammoth otimizado...')\n      \n      await this.loadLibraries()\n      \n      const response = await fetch(fileUrl)\n      const arrayBuffer = await response.arrayBuffer()\n      \n      // Configura√ß√£o ultra-otimizada do mammoth\n      const options = {\n        styleMap: [\n          // Mapeamento mais preciso de estilos\n          \"p[style-name='Normal'] => p.normal\",\n          \"p[style-name='Title'] => h1.title\",\n          \"p[style-name='Heading 1'] => h1.heading1\",\n          \"p[style-name='Heading 2'] => h2.heading2\", \n          \"p[style-name='Heading 3'] => h3.heading3\",\n          \"p[style-name='Subtitle'] => p.subtitle\",\n          \"p[style-name='Quote'] => blockquote.quote\",\n          \"p[style-name='List Paragraph'] => ul > li.list-item\",\n          \"r[style-name='Strong'] => strong.bold\",\n          \"r[style-name='Emphasis'] => em.italic\",\n          \"table => table.word-table\",\n          \"tr => tr.table-row\",\n          \"td => td.table-cell\",\n          \"th => th.table-header\"\n        ],\n        includeDefaultStyleMap: true,\n        includeEmbeddedStyleMap: true,\n        preserveEmptyParagraphs: true,\n        convertImage: this.mammoth.images.imgElement(function(image) {\n          return image.read(\"base64\").then(function(imageBuffer) {\n            return {\n              src: \"data:\" + image.contentType + \";base64,\" + imageBuffer,\n              style: \"max-width: 100%; height: auto;\"\n            }\n          })\n        })\n      }\n\n      const result = await this.mammoth.convertToHtml({ arrayBuffer }, options)\n      \n      if (!result.value || result.value.length < 50) {\n        throw new Error('Conte√∫do HTML extra√≠do insuficiente')\n      }\n\n      // Processar HTML com fidelidade m√°xima\n      const optimizedHtml = this.prepareHtmlForMaxFidelity(result.value)\n      const imageData = await this.renderHtmlToImageOptimized(optimizedHtml)\n      const pdfBlob = await this.createPdfFromImageOptimized(imageData)\n\n      return {\n        blob: pdfBlob,\n        fileName: `${fileName}_Optimized.pdf`\n      }\n      \n    } catch (error) {\n      throw new Error(`Mammoth otimizado falhou: ${error.message}`)\n    }\n  }\n\n  /**\n   * Carregar bibliotecas b√°sicas\n   */\n  async loadLibraries() {\n    try {\n      if (this.mammoth && this.jsPDF && this.html2canvas) {\n        return // J√° carregadas\n      }\n      \n      console.log('üìö Carregando bibliotecas...')\n      \n      const [mammothModule, jsPDFModule, html2canvasModule] = await Promise.all([\n        import('mammoth'),\n        import('jspdf'),\n        import('html2canvas')\n      ])\n\n      this.mammoth = mammothModule\n      this.jsPDF = jsPDFModule.jsPDF || jsPDFModule.default\n      this.html2canvas = html2canvasModule.default\n\n      console.log('‚úÖ Bibliotecas b√°sicas carregadas')\n    } catch (error) {\n      throw new Error(`Erro ao carregar bibliotecas: ${error.message}`)\n    }\n  }\n\n  /**\n   * Detectar tipo de arquivo\n   */\n  detectFileType(arrayBuffer) {\n    const header = new Uint8Array(arrayBuffer.slice(0, 4))\n    \n    // Verificar assinatura DOCX (ZIP)\n    if (header[0] === 0x50 && header[1] === 0x4B) {\n      return 'docx'\n    }\n    \n    // Verificar assinatura DOC\n    if (header[0] === 0xD0 && header[1] === 0xCF) {\n      return 'doc'\n    }\n    \n    return 'unknown'\n  }\n\n  /**\n   * Convers√£o direta DOCX (experimental)\n   */\n  async convertDocxDirectly(arrayBuffer, fileName) {\n    // Esta √© uma implementa√ß√£o experimental\n    // Na pr√°tica, seria necess√°ria uma biblioteca mais robusta\n    throw new Error('Convers√£o direta DOCX ainda n√£o implementada')\n  }\n\n  /**\n   * Obter URL do LibreOffice\n   */\n  getLibreOfficeUrl() {\n    // Verificar se h√° servidor local ou remoto configurado\n    return process.env.LIBREOFFICE_API_URL || \n           localStorage.getItem('libreoffice_api_url') || \n           null\n  }\n\n  /**\n   * Obter chave da API Microsoft\n   */\n  getMicrosoftApiKey() {\n    return process.env.MICROSOFT_API_KEY || \n           localStorage.getItem('microsoft_api_key') || \n           null\n  }\n\n  /**\n   * Obter chave da API CloudConvert\n   */\n  getCloudConvertApiKey() {\n    // Sua API key CloudConvert\n    const API_KEY_CLOUDCONVERT = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiZDQ1ZjZiMzhkYzFkMzFiNmIyMDUzZDIyOTlkMzZjOGEzZjZhN2Q1MGM1NDk0ZjkyMTUxNmRiZjdlMjUwYzEwZDc0MzgzYzViYjBlZDNlMTMiLCJpYXQiOjE3NTI0MTYzMTguMTc4ODc3LCJuYmYiOjE3NTI0MTYzMTguMTc4ODc4LCJleHAiOjQ5MDgwODk5MTguMTc0NjI3LCJzdWIiOiI3MjQyMjkzOSIsInNjb3BlcyI6WyJ1c2VyLnJlYWQiLCJ1c2VyLndyaXRlIiwidGFzay5yZWFkIiwidGFzay53cml0ZSIsIndlYmhvb2sucmVhZCIsIndlYmhvb2sud3JpdGUiLCJwcmVzZXQucmVhZCIsInByZXNldC53cml0ZSJdfQ.rblTb7A65oxXQlsIzgz2Qa8xW-FzwvNNWFwV0zvh3qlHdW9Bg4reHADfAKh-yLzRSpEw-_sO_5HHi3SmNEweG_gc001PE_O9nuRl8pdQiE25GRerfc6H3ZnfBKlJIcMhhADEIlHyHdcz9CTWRPSQttMwjIXi2GVajgijrpY3kLyEbdMgZFRM_Yfej3TGyRM14Da-XzTx0ya0oXX1JmIVPihNgf87MwnvpdI6gItIp0fNYVhhCwH6KPzCIh21c4VP6WMWmMLpcpdtRTy1h24J0JOXBmESzX-Ju4wO61PLhgQmATdzdQsKBgTC51iwwJZZblgCIaEycJJz6OZ_KJqlE-dlvmqrUH0xJdXRf-G6OmJ5rauRKe5hR2eb7Di4ktNO8PSZ9ULf_1Ko7apsulZTiMbDc6Anbi_SFjACjtjcLzYMTWjGVGl8nGwQcOI5woZVgtkHKZe7yWFKgk-7EmdK7Kcj1OVEzwpoRqKUp9KcMAwi8Qaq9-1w-zcWsPnSjCKJM94-WMvbDajujNVKJbQa8EKgZTPdjX0yp6wljYXEBdpnOY57WUj9qUnZce2YWZ4G4_MqtNpHOBmobA8ldv8WqU8-dhEGXy3aGyPy28otuunUwQ8SSKAC9qf2k4-dKgCT6dt72Ssa1aauZmwUWvJm7Qk9jvXyE6on6nbced-qcoc'\n    \n    return process.env.CLOUDCONVERT_API_KEY || \n           localStorage.getItem('cloudconvert_api_key') || \n           API_KEY_CLOUDCONVERT ||\n           null\n  }\n\n  /**\n   * Preparar HTML para m√°xima fidelidade\n   */\n  prepareHtmlForMaxFidelity(htmlContent) {\n    console.log('üé® Preparando HTML para m√°xima fidelidade...')\n\n    const ultraOptimizedHtml = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <style>\n          /* CSS ultra-otimizado para fidelidade 100% */\n          * {\n            box-sizing: border-box !important;\n            margin: 0 !important;\n            padding: 0 !important;\n          }\n          \n          html, body {\n            width: 210mm !important;\n            min-height: 297mm !important;\n            font-family: 'Times New Roman', 'Liberation Serif', serif !important;\n            font-size: 12pt !important;\n            line-height: 1.15 !important;\n            color: #000000 !important;\n            background: #ffffff !important;\n            -webkit-print-color-adjust: exact !important;\n            print-color-adjust: exact !important;\n            overflow: visible !important;\n          }\n          \n          body {\n            padding: 25.4mm 20mm !important; /* Margens A4 padr√£o */\n            width: 210mm !important;\n            min-height: 297mm !important;\n            background: white !important;\n            display: block !important;\n            visibility: visible !important;\n          }\n          \n          /* Par√°grafos com espa√ßamento Word */\n          p, p.normal {\n            margin: 0 0 6pt 0 !important;\n            padding: 0 !important;\n            text-align: justify !important;\n            text-justify: inter-word !important;\n            color: #000000 !important;\n            background: transparent !important;\n            font-size: 12pt !important;\n            line-height: 1.15 !important;\n            orphans: 2 !important;\n            widows: 2 !important;\n          }\n          \n          /* T√≠tulos com formata√ß√£o Word exata */\n          h1.title {\n            text-align: center !important;\n            font-size: 16pt !important;\n            font-weight: bold !important;\n            margin: 0 0 12pt 0 !important;\n            page-break-after: avoid !important;\n          }\n          \n          h1.heading1 {\n            font-size: 14pt !important;\n            font-weight: bold !important;\n            margin: 12pt 0 6pt 0 !important;\n            page-break-after: avoid !important;\n          }\n          \n          h2.heading2 {\n            font-size: 13pt !important;\n            font-weight: bold !important;\n            margin: 10pt 0 6pt 0 !important;\n            page-break-after: avoid !important;\n          }\n          \n          h3.heading3 {\n            font-size: 12pt !important;\n            font-weight: bold !important;\n            margin: 8pt 0 4pt 0 !important;\n            page-break-after: avoid !important;\n          }\n          \n          p.subtitle {\n            text-align: center !important;\n            font-style: italic !important;\n            margin: 6pt 0 12pt 0 !important;\n          }\n          \n          /* Formata√ß√£o de texto */\n          strong.bold, strong, b {\n            font-weight: bold !important;\n            color: inherit !important;\n          }\n          \n          em.italic, em, i {\n            font-style: italic !important;\n            color: inherit !important;\n          }\n          \n          u {\n            text-decoration: underline !important;\n            color: inherit !important;\n          }\n          \n          /* Tabelas com bordas exatas */\n          table.word-table {\n            width: 100% !important;\n            border-collapse: collapse !important;\n            margin: 6pt 0 !important;\n            page-break-inside: avoid !important;\n            background: white !important;\n          }\n          \n          td.table-cell, th.table-header {\n            border: 1pt solid #000000 !important;\n            padding: 4pt 6pt !important;\n            vertical-align: top !important;\n            text-align: left !important;\n            background: white !important;\n            font-size: 11pt !important;\n            line-height: 1.1 !important;\n          }\n          \n          th.table-header {\n            font-weight: bold !important;\n            background-color: #f0f0f0 !important;\n            text-align: center !important;\n          }\n          \n          /* Listas com espa√ßamento Word */\n          ul {\n            margin: 6pt 0 6pt 18pt !important;\n            padding: 0 !important;\n            list-style-type: disc !important;\n          }\n          \n          ol {\n            margin: 6pt 0 6pt 18pt !important;\n            padding: 0 !important;\n            list-style-type: decimal !important;\n          }\n          \n          li.list-item, li {\n            margin: 0 0 3pt 0 !important;\n            padding: 0 !important;\n            text-align: justify !important;\n            page-break-inside: avoid !important;\n          }\n          \n          /* Cita√ß√µes */\n          blockquote.quote {\n            margin: 6pt 36pt !important;\n            padding: 0 !important;\n            font-style: italic !important;\n            text-align: justify !important;\n          }\n          \n          /* Imagens */\n          img {\n            max-width: 100% !important;\n            height: auto !important;\n            display: block !important;\n            margin: 6pt auto !important;\n          }\n          \n          /* Quebras de p√°gina */\n          .page-break {\n            page-break-before: always !important;\n            height: 0 !important;\n            margin: 0 !important;\n            padding: 0 !important;\n          }\n          \n          /* Evitar quebras √≥rf√£s */\n          p, h1, h2, h3, h4, h5, h6 {\n            page-break-inside: avoid !important;\n          }\n          \n          h1, h2, h3, h4, h5, h6 {\n            page-break-after: avoid !important;\n          }\n          \n          /* Manter listas unidas */\n          ul, ol {\n            page-break-inside: avoid !important;\n          }\n          \n          /* Espa√ßamento de linha preservado */\n          br {\n            display: block !important;\n            margin: 3pt 0 !important;\n            content: \"\" !important;\n          }\n          \n          /* Alinhamentos espec√≠ficos */\n          [style*=\"text-align: center\"], .center {\n            text-align: center !important;\n          }\n          \n          [style*=\"text-align: right\"], .right {\n            text-align: right !important;\n          }\n          \n          [style*=\"text-align: left\"], .left {\n            text-align: left !important;\n          }\n          \n          /* Preservar cores se houver */\n          [style*=\"color\"] {\n            color: inherit !important;\n          }\n          \n          /* Simular campos de formul√°rio */\n          ._underline {\n            border-bottom: 1pt solid #000 !important;\n            display: inline-block !important;\n            min-width: 3cm !important;\n            height: 1.2em !important;\n          }\n          \n          ._signature {\n            border-bottom: 1pt solid #000 !important;\n            display: inline-block !important;\n            width: 6cm !important;\n            height: 1.5em !important;\n            margin: 6pt 0 !important;\n          }\n        </style>\n      </head>\n      <body>\n        ${htmlContent}\n      </body>\n      </html>\n    `\n\n    return ultraOptimizedHtml\n  }\n\n  /**\n   * Renderizar HTML otimizado para imagem\n   */\n  async renderHtmlToImageOptimized(htmlContent) {\n    try {\n      console.log('üñºÔ∏è Renderizando HTML otimizado...')\n\n      // Criar iframe com configura√ß√µes otimizadas\n      const iframe = document.createElement('iframe')\n      iframe.style.cssText = `\n        position: absolute;\n        left: -9999px;\n        top: -9999px;\n        width: 794px;  /* A4 width em 96 DPI */\n        height: 1123px; /* A4 height em 96 DPI */\n        border: none;\n        background: white;\n        visibility: hidden;\n        z-index: -1000;\n      `\n      \n      document.body.appendChild(iframe)\n      \n      try {\n        iframe.contentDocument.open()\n        iframe.contentDocument.write(htmlContent)\n        iframe.contentDocument.close()\n        \n        // Aguardar carregamento completo\n        await new Promise(resolve => {\n          iframe.onload = resolve\n          setTimeout(resolve, 3000) // Timeout maior para garantir carregamento\n        })\n        \n        const body = iframe.contentDocument.body\n        \n        // Renderizar com configura√ß√µes ultra-otimizadas\n        const canvas = await this.html2canvas(body, {\n          scale: 2, // Resolu√ß√£o alta\n          useCORS: true,\n          allowTaint: true,\n          backgroundColor: '#ffffff',\n          width: 794,\n          height: body.scrollHeight,\n          windowWidth: 794,\n          windowHeight: body.scrollHeight,\n          x: 0,\n          y: 0,\n          scrollX: 0,\n          scrollY: 0,\n          foreignObjectRendering: false,\n          imageTimeout: 30000,\n          removeContainer: false,\n          logging: false,\n          letterRendering: true,\n          onclone: (clonedDoc) => {\n            // Aplicar configura√ß√µes extras no clone\n            clonedDoc.body.style.transform = 'scale(1)'\n            clonedDoc.body.style.transformOrigin = 'top left'\n          }\n        })\n\n        console.log('‚úÖ Imagem otimizada renderizada:', canvas.width + 'x' + canvas.height)\n        \n        return {\n          dataUrl: canvas.toDataURL('image/png', 1.0),\n          width: canvas.width,\n          height: canvas.height\n        }\n\n      } finally {\n        if (iframe && iframe.parentNode) {\n          document.body.removeChild(iframe)\n        }\n      }\n\n    } catch (error) {\n      throw new Error(`Erro na renderiza√ß√£o otimizada: ${error.message}`)\n    }\n  }\n\n  /**\n   * Criar PDF otimizado da imagem\n   */\n  async createPdfFromImageOptimized(imageData) {\n    try {\n      console.log('üìÑ Criando PDF otimizado...')\n\n      const doc = new this.jsPDF({\n        orientation: 'portrait',\n        unit: 'mm',\n        format: 'a4',\n        compress: true\n      })\n\n      const pageWidth = 210\n      const pageHeight = 297\n      const margin = 0 // Sem margem para m√°xima fidelidade\n      \n      const availableWidth = pageWidth - (margin * 2)\n      const availableHeight = pageHeight - (margin * 2)\n      \n      // Calcular escala exata\n      const scaleByWidth = availableWidth / (imageData.width * 0.264583)\n      const imgWidth = availableWidth\n      const imgHeight = (imageData.height * 0.264583) * scaleByWidth\n      \n      const totalPages = Math.ceil(imgHeight / availableHeight)\n      console.log(`üìÑ Ser√° necess√°rio ${totalPages} p√°gina(s) otimizada(s)`)\n\n      for (let pageNum = 0; pageNum < totalPages; pageNum++) {\n        if (pageNum > 0) {\n          doc.addPage()\n        }\n        \n        const yOffsetInImage = pageNum * availableHeight\n        const yPosition = margin - yOffsetInImage\n        \n        doc.addImage(\n          imageData.dataUrl,\n          'PNG',\n          margin,\n          yPosition,\n          imgWidth,\n          imgHeight,\n          undefined,\n          'FAST'\n        )\n        \n        console.log(`‚úÖ P√°gina otimizada ${pageNum + 1}/${totalPages}`)\n      }\n\n      const pdfBlob = doc.output('blob')\n      console.log('‚úÖ PDF otimizado criado:', pdfBlob.size, 'bytes')\n\n      return pdfBlob\n\n    } catch (error) {\n      throw new Error(`Erro ao criar PDF otimizado: ${error.message}`)\n    }\n  }\n\n  /**\n   * Extrair HTML do arquivo Word (m√©todo legado)\n   */\n  async extractHtmlFromWord(fileUrl) {\n    try {\n      console.log('üìÑ Baixando arquivo Word...')\n      \n      const response = await fetch(fileUrl)\n      if (!response.ok) {\n        throw new Error(`Erro ao baixar arquivo: ${response.status}`)\n      }\n\n      const arrayBuffer = await response.arrayBuffer()\n      console.log('üìÑ Arquivo baixado:', arrayBuffer.byteLength, 'bytes')\n\n      // Configura√ß√£o avan√ßada do mammoth para m√°xima fidelidade\n      const options = {\n        styleMap: [\n          \"p[style-name='Title'] => h1.title\",\n          \"p[style-name='Heading 1'] => h1\",\n          \"p[style-name='Heading 2'] => h2\", \n          \"p[style-name='Heading 3'] => h3\",\n          \"p[style-name='Subtitle'] => p.subtitle\",\n          \"p[style-name='Quote'] => blockquote\",\n          \"p[style-name='List Paragraph'] => ul > li\",\n          \"r[style-name='Strong'] => strong\",\n          \"r[style-name='Emphasis'] => em\",\n          \"table => table.word-table\",\n          \"tr => tr\",\n          \"td => td\"\n        ],\n        includeDefaultStyleMap: true,\n        includeEmbeddedStyleMap: true,\n        convertImage: this.mammoth.images.imgElement(function(image) {\n          return image.read(\"base64\").then(function(imageBuffer) {\n            return {\n              src: \"data:\" + image.contentType + \";base64,\" + imageBuffer\n            }\n          })\n        })\n      }\n\n      const result = await this.mammoth.convertToHtml({ arrayBuffer }, options)\n      \n      if (!result.value || result.value.length < 50) {\n        throw new Error('Conte√∫do HTML extra√≠do insuficiente')\n      }\n\n      console.log('‚úÖ HTML extra√≠do:', result.value.length, 'caracteres')\n      if (result.messages.length > 0) {\n        console.log('‚ö†Ô∏è Avisos:', result.messages.length)\n      }\n\n      return result.value\n\n    } catch (error) {\n      throw new Error(`Erro ao extrair HTML: ${error.message}`)\n    }\n  }\n\n  /**\n   * Preparar HTML para renderiza√ß√£o perfeita\n   */\n  prepareHtmlForRendering(htmlContent) {\n    console.log('üé® Preparando HTML para renderiza√ß√£o...')\n\n    // CSS otimizado para renderiza√ß√£o id√™ntica ao Word\n    const optimizedHtml = `\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <meta charset=\"utf-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <style>\n          * {\n            box-sizing: border-box;\n          }\n          \n          html, body {\n            width: 794px !important; /* A4 width em pixels */\n            min-height: 1123px; /* A4 height em pixels */\n            font-family: 'Times New Roman', serif !important;\n            font-size: 11pt !important;\n            line-height: 1.3 !important;\n            color: #000000 !important;\n            background: #ffffff !important;\n            margin: 0 !important;\n            padding: 0 !important;\n            -webkit-print-color-adjust: exact;\n            print-color-adjust: exact;\n            overflow: visible !important;\n          }\n          \n          body {\n            padding: 60px 40px !important; /* Margens em pixels */\n            width: 794px !important;\n            min-height: 1123px !important;\n            background: white !important;\n            display: block !important;\n            visibility: visible !important;\n          }\n          \n          /* Preserve Word formatting */\n          p {\n            margin: 8px 0 !important;\n            padding: 0 !important;\n            text-align: justify !important;\n            text-justify: inter-word;\n            color: #000000 !important;\n            background: transparent !important;\n            display: block !important;\n            visibility: visible !important;\n            font-size: 11pt !important;\n            line-height: 1.3 !important;\n          }\n          \n          h1, h2, h3, h4, h5, h6 {\n            margin: 16px 0 8px 0 !important;\n            padding: 0 !important;\n            font-weight: bold !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: block !important;\n            visibility: visible !important;\n            page-break-after: avoid;\n          }\n          \n          h1 { font-size: 16pt !important; }\n          h2 { font-size: 14pt !important; }\n          h3 { font-size: 12pt !important; }\n          \n          h1.title {\n            text-align: center;\n            font-size: 18pt;\n            margin: 24pt 0 18pt 0;\n          }\n          \n          .subtitle {\n            text-align: center;\n            font-style: italic;\n            margin: 12pt 0;\n          }\n          \n          strong, b {\n            font-weight: bold !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: inline !important;\n            visibility: visible !important;\n          }\n          \n          em, i {\n            font-style: italic !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: inline !important;\n            visibility: visible !important;\n          }\n          \n          u {\n            text-decoration: underline !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: inline !important;\n            visibility: visible !important;\n          }\n          \n          /* Tables */\n          table {\n            width: 100% !important;\n            border-collapse: collapse !important;\n            margin: 16px 0 !important;\n            background: white !important;\n            color: #000000 !important;\n            display: table !important;\n            visibility: visible !important;\n            page-break-inside: avoid;\n          }\n          \n          table.word-table {\n            border: 1px solid #000000 !important;\n          }\n          \n          td, th {\n            border: 1px solid #000000 !important;\n            padding: 8px 12px !important;\n            vertical-align: top !important;\n            text-align: left !important;\n            background: white !important;\n            color: #000000 !important;\n            display: table-cell !important;\n            visibility: visible !important;\n            font-size: 11pt !important;\n          }\n          \n          th {\n            font-weight: bold !important;\n            background-color: #f2f2f2 !important;\n            color: #000000 !important;\n          }\n          \n          /* Lists - Preservar numera√ß√£o */\n          ul, ol {\n            margin: 12px 0 !important;\n            padding-left: 30px !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: block !important;\n            visibility: visible !important;\n          }\n          \n          ol {\n            list-style-type: decimal !important;\n            counter-reset: list-counter !important;\n          }\n          \n          ul {\n            list-style-type: disc !important;\n          }\n          \n          li {\n            margin: 4px 0 !important;\n            padding: 2px 0 !important;\n            color: #000000 !important;\n            background: transparent !important;\n            display: list-item !important;\n            visibility: visible !important;\n            list-style-position: outside !important;\n          }\n          \n          /* Numera√ß√£o espec√≠fica para documentos */\n          li::marker {\n            color: #000000 !important;\n            font-weight: normal !important;\n          }\n          \n          /* Preservar numera√ß√£o customizada */\n          li[data-list-text] {\n            position: relative !important;\n          }\n          \n          li[data-list-text]::before {\n            content: attr(data-list-text) !important;\n            position: absolute !important;\n            left: -30px !important;\n            color: #000000 !important;\n            font-weight: normal !important;\n          }\n          \n          /* Block quotes */\n          blockquote {\n            margin: 12pt 24pt;\n            padding: 8pt 12pt;\n            border-left: 3pt solid #ccc;\n            background-color: #f9f9f9;\n          }\n          \n          /* Images */\n          img {\n            max-width: 100%;\n            height: auto;\n            display: block;\n            margin: 8pt auto;\n          }\n          \n          /* Page breaks e quebras inteligentes */\n          .page-break {\n            page-break-before: always;\n          }\n          \n          /* Evitar quebras no meio de se√ß√µes importantes */\n          h1, h2, h3, h4, h5, h6 {\n            page-break-after: avoid !important;\n            page-break-inside: avoid !important;\n          }\n          \n          /* Manter par√°grafos unidos com t√≠tulos seguintes */\n          p + h1, p + h2, p + h3, p + h4, p + h5, p + h6 {\n            page-break-before: avoid !important;\n          }\n          \n          /* Evitar quebras em listas */\n          li {\n            page-break-inside: avoid !important;\n          }\n          \n          /* Manter se√ß√µes importantes unidas */\n          .keep-together {\n            page-break-inside: avoid !important;\n          }\n          \n          /* Preserve spacing */\n          br {\n            display: block;\n            margin: 4pt 0;\n            content: \"\";\n          }\n          \n          /* Center alignment */\n          .center, [style*=\"text-align: center\"] {\n            text-align: center !important;\n          }\n          \n          /* Right alignment */\n          .right, [style*=\"text-align: right\"] {\n            text-align: right !important;\n          }\n          \n          /* Preserve font sizes */\n          [style*=\"font-size\"] {\n            line-height: 1.2 !important;\n          }\n          \n          /* Preserve colors */\n          [style*=\"color\"] {\n            color: inherit !important;\n          }\n          \n          /* Form fields simulation */\n          ._underline {\n            border-bottom: 1pt solid #000;\n            display: inline-block;\n            min-width: 100pt;\n          }\n          \n          /* Signature areas */\n          ._signature {\n            border-bottom: 1pt solid #000;\n            display: inline-block;\n            width: 200pt;\n            height: 20pt;\n            margin: 12pt 0;\n          }\n          \n          /* Footer/header simulation */\n          ._footer {\n            position: absolute;\n            bottom: 2cm;\n            left: 2.54cm;\n            right: 2.54cm;\n            font-size: 9pt;\n            text-align: center;\n            color: #666;\n          }\n        </style>\n      </head>\n      <body>\n        ${htmlContent}\n      </body>\n      </html>\n    `\n\n    console.log('‚úÖ HTML preparado para renderiza√ß√£o')\n    return optimizedHtml\n  }\n\n  /**\n   * Renderizar HTML p√°gina por p√°gina (NOVA ABORDAGEM)\n   */\n  async renderHtmlToImage(htmlContent) {\n    try {\n      console.log('üñºÔ∏è Renderizando HTML p√°gina por p√°gina...')\n\n      // Criar HTML otimizado para pagina√ß√£o\n      const pageBreakHtml = this.addPageBreaksToHtml(htmlContent)\n\n      // Renderizar usando m√©todo de p√°ginas individuais\n      return await this.renderPagesIndividually(pageBreakHtml)\n\n    } catch (error) {\n      console.error('‚ùå Erro na renderiza√ß√£o por p√°ginas:', error)\n      console.log('üîÑ Tentando m√©todo de fallback...')\n      return await this.renderHtmlToImageFallback(htmlContent)\n    }\n  }\n\n  /**\n   * Adicionar quebras de p√°gina inteligentes no HTML\n   */\n  addPageBreaksToHtml(htmlContent) {\n    console.log('üìÑ Adicionando quebras de p√°gina inteligentes...')\n    \n    // Inserir quebras antes de se√ß√µes principais\n    let processedHtml = htmlContent\n      .replace(/<h1/g, '<div class=\"page-break\"></div><h1')\n      .replace(/<h2/g, '<div class=\"section-break\"></div><h2')\n      .replace(/DO OBJETO/g, '<div class=\"page-break\"></div>DO OBJETO')\n      .replace(/DO PEDIDO DE ESCLARECIMENTOS/g, '<div class=\"page-break\"></div>DO PEDIDO DE ESCLARECIMENTOS')\n      .replace(/DAS DISPOSI√á√ïES GERAIS/g, '<div class=\"page-break\"></div>DAS DISPOSI√á√ïES GERAIS')\n      .replace(/DOS ANEXOS/g, '<div class=\"page-break\"></div>DOS ANEXOS')\n    \n    return processedHtml\n  }\n\n  /**\n   * Renderizar cada p√°gina individualmente\n   */\n  async renderPagesIndividually(htmlContent) {\n    try {\n      console.log('üìÑ Renderizando p√°ginas individuais...')\n\n      // Criar iframe com tamanho de p√°gina A4\n      const iframe = document.createElement('iframe')\n      iframe.style.cssText = `\n        position: absolute;\n        left: -9999px;\n        top: -9999px;\n        width: 794px;\n        height: 1123px;\n        border: none;\n        background: white;\n        visibility: hidden;\n        z-index: -1000;\n      `\n      \n      document.body.appendChild(iframe)\n      \n      try {\n        // HTML com CSS de pagina√ß√£o\n        const paginatedHtml = `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <style>\n              @page {\n                size: A4;\n                margin: 20mm;\n              }\n              \n              ${this.getPrintCSS()}\n              \n              body {\n                font-family: 'Times New Roman', serif !important;\n                font-size: 11pt !important;\n                line-height: 1.3 !important;\n                margin: 0 !important;\n                padding: 0 !important;\n                background: white !important;\n                color: black !important;\n              }\n              \n              .page-break {\n                page-break-before: always !important;\n                height: 0 !important;\n                margin: 0 !important;\n                padding: 0 !important;\n              }\n              \n              .section-break {\n                page-break-before: avoid !important;\n                margin-top: 20px !important;\n              }\n            </style>\n          </head>\n          <body>\n            ${htmlContent}\n          </body>\n          </html>\n        `\n        \n        // Escrever HTML no iframe\n        iframe.contentDocument.open()\n        iframe.contentDocument.write(paginatedHtml)\n        iframe.contentDocument.close()\n        \n        // Aguardar carregamento\n        await new Promise(resolve => {\n          iframe.onload = resolve\n          setTimeout(resolve, 2000)\n        })\n        \n        const targetElement = iframe.contentDocument.body\n        \n        console.log('üìÑ Conte√∫do carregado:', targetElement.innerText.substring(0, 100) + '...')\n        \n        // Renderizar como uma √∫nica imagem alta (sem dividir)\n        const canvas = await this.html2canvas(targetElement, {\n          scale: 1.5,\n          useCORS: true,\n          allowTaint: true,\n          backgroundColor: '#ffffff',\n          width: 794,\n          height: targetElement.scrollHeight,\n          windowWidth: 794,\n          windowHeight: targetElement.scrollHeight,\n          x: 0,\n          y: 0,\n          scrollX: 0,\n          scrollY: 0,\n          foreignObjectRendering: false,\n          imageTimeout: 15000,\n          removeContainer: false,\n          logging: false,\n          letterRendering: true\n        })\n\n        console.log('‚úÖ Imagem p√°gina renderizada:', canvas.width + 'x' + canvas.height)\n        \n        return {\n          dataUrl: canvas.toDataURL('image/png', 1.0),\n          width: canvas.width,\n          height: canvas.height\n        }\n\n      } finally {\n        if (iframe && iframe.parentNode) {\n          document.body.removeChild(iframe)\n        }\n      }\n\n    } catch (error) {\n      throw new Error(`Erro na renderiza√ß√£o por p√°ginas: ${error.message}`)\n    }\n  }\n\n  /**\n   * CSS otimizado para impress√£o/PDF\n   */\n  getPrintCSS() {\n    return `\n      * {\n        box-sizing: border-box !important;\n      }\n      \n      p {\n        margin: 6px 0 !important;\n        text-align: justify !important;\n        orphans: 3 !important;\n        widows: 3 !important;\n      }\n      \n      h1, h2, h3, h4, h5, h6 {\n        margin: 12px 0 6px 0 !important;\n        font-weight: bold !important;\n        page-break-after: avoid !important;\n        page-break-inside: avoid !important;\n        orphans: 4 !important;\n        widows: 4 !important;\n      }\n      \n      h1 { font-size: 16pt !important; }\n      h2 { font-size: 14pt !important; }\n      h3 { font-size: 12pt !important; }\n      \n      ul, ol {\n        margin: 8px 0 !important;\n        padding-left: 25px !important;\n        page-break-inside: avoid !important;\n      }\n      \n      li {\n        margin: 3px 0 !important;\n        page-break-inside: avoid !important;\n      }\n      \n      table {\n        width: 100% !important;\n        border-collapse: collapse !important;\n        margin: 10px 0 !important;\n        page-break-inside: avoid !important;\n      }\n      \n      td, th {\n        border: 1px solid #000 !important;\n        padding: 6px 8px !important;\n        font-size: 10pt !important;\n      }\n      \n      th {\n        font-weight: bold !important;\n        background-color: #f0f0f0 !important;\n      }\n      \n      strong, b {\n        font-weight: bold !important;\n      }\n      \n      em, i {\n        font-style: italic !important;\n      }\n      \n      u {\n        text-decoration: underline !important;\n      }\n    `\n  }\n\n  /**\n   * M√©todo de fallback para renderiza√ß√£o\n   */\n  async renderHtmlToImageFallback(htmlContent) {\n    try {\n      console.log('üîÑ Usando m√©todo de fallback para renderiza√ß√£o...')\n      \n      // Criar container simples\n      const container = document.createElement('div')\n      container.innerHTML = htmlContent.replace(/<html[^>]*>|<\\/html>|<head[^>]*>.*?<\\/head>|<body[^>]*>|<\\/body>/gs, '')\n      \n      container.style.cssText = `\n        position: absolute;\n        left: -9999px;\n        top: -9999px;\n        width: 794px;\n        padding: 40px;\n        background: white;\n        font-family: 'Times New Roman', serif;\n        font-size: 11pt;\n        line-height: 1.4;\n        color: black;\n        visibility: visible;\n        z-index: 9999;\n      `\n      \n      document.body.appendChild(container)\n      \n      try {\n        await new Promise(resolve => setTimeout(resolve, 1000))\n        \n        const canvas = await this.html2canvas(container, {\n          scale: 1,\n          useCORS: true,\n          allowTaint: true,\n          backgroundColor: '#ffffff',\n          logging: true\n        })\n        \n        console.log('‚úÖ Fallback renderizado:', canvas.width + 'x' + canvas.height)\n        \n        return {\n          dataUrl: canvas.toDataURL('image/png', 1.0),\n          width: canvas.width,\n          height: canvas.height\n        }\n        \n      } finally {\n        if (container && container.parentNode) {\n          document.body.removeChild(container)\n        }\n      }\n      \n    } catch (fallbackError) {\n      console.error('‚ùå Erro no fallback:', fallbackError)\n      throw new Error(`Falha na renderiza√ß√£o: ${fallbackError.message}`)\n    }\n  }\n\n  /**\n   * Criar PDF a partir da imagem (M√âTODO SIMPLIFICADO)\n   */\n  async createPdfFromImage(imageData) {\n    try {\n      console.log('üìÑ Criando PDF com m√©todo simplificado...')\n      console.log('üñºÔ∏è Dados da imagem:', {\n        width: imageData.width,\n        height: imageData.height,\n        dataUrlLength: imageData.dataUrl.length\n      })\n\n      // Verificar se a imagem √© v√°lida\n      if (!imageData.dataUrl || imageData.dataUrl.length < 100) {\n        throw new Error('Dados de imagem inv√°lidos')\n      }\n\n      const doc = new this.jsPDF({\n        orientation: 'portrait',\n        unit: 'mm',\n        format: 'a4'\n      })\n\n      // Dimens√µes A4 em mm\n      const pageWidth = 210\n      const pageHeight = 297\n      const margin = 10\n      \n      // Calcular dimens√µes mantendo propor√ß√£o\n      const availableWidth = pageWidth - (margin * 2)\n      const availableHeight = pageHeight - (margin * 2)\n      \n      // Calcular escala para caber na largura\n      const scaleByWidth = availableWidth / (imageData.width * 0.264583) // Converter pixels para mm\n      const imgWidth = availableWidth\n      const imgHeight = (imageData.height * 0.264583) * scaleByWidth\n      \n      console.log(`üìê Imagem ser√° renderizada: ${imgWidth.toFixed(1)}mm x ${imgHeight.toFixed(1)}mm`)\n      \n      // Calcular quantas p√°ginas A4 s√£o necess√°rias\n      const totalPages = Math.ceil(imgHeight / availableHeight)\n      console.log(`üìÑ Ser√° necess√°rio ${totalPages} p√°gina(s)`)\n\n      // Validar imagem\n      const img = new Image()\n      await new Promise((resolve, reject) => {\n        img.onload = resolve\n        img.onerror = reject\n        img.src = imageData.dataUrl\n      })\n      \n      // üéØ ADI√á√ÉO: Calcular quebras inteligentes que n√£o cortam se√ß√µes\n      const smartPageBreaks = this.calculateSmartPageBreaks(totalPages, availableHeight, imgHeight)\n      console.log('üìÑ Quebras inteligentes calculadas:', smartPageBreaks.length, 'p√°ginas')\n      \n      // Adicionar p√°ginas com quebras inteligentes\n      for (let pageNum = 0; pageNum < smartPageBreaks.length; pageNum++) {\n        if (pageNum > 0) {\n          doc.addPage()\n        }\n        \n        // üéØ USAR QUEBRAS INTELIGENTES ao inv√©s de divis√£o fixa\n        const yOffsetInImage = smartPageBreaks[pageNum].startY\n        const pageEndY = smartPageBreaks[pageNum].endY\n        const actualPageHeight = pageEndY - yOffsetInImage\n        \n        if (actualPageHeight > 0) {\n          // Posi√ß√£o Y negativa para mostrar a parte correta da imagem\n          const yPosition = margin - yOffsetInImage\n          \n          // Adicionar a imagem inteira, mas clipada pela p√°gina\n          doc.addImage(\n            imageData.dataUrl,\n            'PNG',\n            margin,\n            yPosition,\n            imgWidth,\n            imgHeight,\n            undefined,\n            'FAST'\n          )\n          \n          console.log(`‚úÖ P√°gina ${pageNum + 1}/${smartPageBreaks.length} - Y: ${yOffsetInImage.toFixed(1)} ‚Üí ${pageEndY.toFixed(1)}mm (altura: ${actualPageHeight.toFixed(1)}mm)`)\n        }\n      }\n\n      // Gerar blob\n      const pdfBlob = doc.output('blob')\n      console.log('‚úÖ PDF criado:', pdfBlob.size, 'bytes')\n\n      return pdfBlob\n\n    } catch (error) {\n      console.error('‚ùå Erro ao criar PDF:', error)\n      console.log('üîÑ Tentando criar PDF de fallback...')\n      return await this.createFallbackPdf('Erro na convers√£o')\n    }\n  }\n\n  /**\n   * üéØ CALCULAR QUEBRAS INTELIGENTES - Vers√£o melhorada e mais conservadora\n   */\n  calculateSmartPageBreaks(totalPages, availableHeight, imgHeight) {\n    console.log('üîß Calculando quebras inteligentes com detec√ß√£o melhorada...')\n    \n    const pageBreaks = []\n    let currentY = 0\n    \n    // üéØ NOVA ABORDAGEM: Mais conservadora e com m√∫ltiplas verifica√ß√µes\n    while (currentY < imgHeight) {\n      let nextPageEnd = Math.min(currentY + availableHeight, imgHeight)\n      const originalPageEnd = nextPageEnd\n      \n      // üîç VERIFICA√á√ÉO 1: Zona de risco para t√≠tulos/se√ß√µes (√∫ltimos 25% da p√°gina)\n      const riskZoneStart = currentY + (availableHeight * 0.75) // √öltimos 25% da p√°gina\n      const riskZoneEnd = nextPageEnd\n      \n      console.log(`üìè P√°gina atual: ${currentY.toFixed(1)} ‚Üí ${nextPageEnd.toFixed(1)}mm (zona de risco: ${riskZoneStart.toFixed(1)} ‚Üí ${riskZoneEnd.toFixed(1)}mm)`)\n      \n      // üîç VERIFICA√á√ÉO 2: Se estamos na zona de risco, seja mais conservador\n      if (riskZoneEnd - riskZoneStart > 10) { // Se h√° pelo menos 10mm de zona de risco\n        // Reduz a p√°gina para evitar cortar qualquer coisa importante nos √∫ltimos 25%\n        nextPageEnd = riskZoneStart\n        console.log(`‚ö†Ô∏è Reduzindo p√°gina para evitar zona de risco. Novo fim: ${nextPageEnd.toFixed(1)}mm`)\n      }\n      \n      // üîç VERIFICA√á√ÉO 3: Posi√ß√µes estimadas de se√ß√µes espec√≠ficas baseadas na altura total\n      const progressRatio = currentY / imgHeight\n      const sectionDetected = this.detectSectionInCurrentPage(progressRatio, currentY, nextPageEnd, availableHeight)\n      \n      if (sectionDetected.adjusted) {\n        nextPageEnd = sectionDetected.newEnd\n        console.log(`üéØ Se√ß√£o detectada: ${sectionDetected.reason}. Ajustado para: ${nextPageEnd.toFixed(1)}mm`)\n      }\n      \n      // üîç VERIFICA√á√ÉO 4: Garantir p√°gina m√≠nima (pelo menos 50% da altura normal)\n      const minPageHeight = availableHeight * 0.5\n      if (nextPageEnd - currentY < minPageHeight && currentY + minPageHeight < imgHeight) {\n        nextPageEnd = currentY + minPageHeight\n        console.log(`üìè Garantindo altura m√≠nima da p√°gina: ${nextPageEnd.toFixed(1)}mm`)\n      }\n      \n      // Adiciona esta quebra de p√°gina\n      pageBreaks.push({\n        startY: currentY,\n        endY: nextPageEnd\n      })\n      \n      console.log(`‚úÖ P√°gina ${pageBreaks.length}: ${currentY.toFixed(1)} ‚Üí ${nextPageEnd.toFixed(1)}mm (altura: ${(nextPageEnd - currentY).toFixed(1)}mm)`)\n      \n      currentY = nextPageEnd\n      \n      // Evita loop infinito\n      if (pageBreaks.length > 25) {\n        console.log('‚ö†Ô∏è Limitando a 25 p√°ginas para evitar loop infinito')\n        break\n      }\n    }\n    \n    console.log(`üìÑ Quebras inteligentes calculadas: ${pageBreaks.length} p√°ginas`)\n    return pageBreaks\n  }\n  \n  /**\n   * üîç DETECTAR SE H√Å SE√á√ÉO IMPORTANTE NA P√ÅGINA ATUAL\n   */\n  detectSectionInCurrentPage(progressRatio, currentY, proposedEnd, availableHeight) {\n    // Baseado na posi√ß√£o relativa no documento, estima onde podem estar se√ß√µes\n    const documentSections = [\n      { name: 'DO OBJETO', progress: 0.15, risk: 0.8 }, // 15% do documento, alta chance\n      { name: 'DAS CONDI√á√ïES DE PARTICIPA√á√ÉO', progress: 0.35, risk: 0.9 }, // 35% do documento\n      { name: 'DO PEDIDO DE ESCLARECIMENTOS', progress: 0.55, risk: 0.7 },\n      { name: 'DAS DISPOSI√á√ïES GERAIS', progress: 0.75, risk: 0.6 },\n      { name: 'DOS ANEXOS', progress: 0.85, risk: 0.5 }\n    ]\n    \n    for (const section of documentSections) {\n      const sectionProgress = section.progress\n      const tolerance = 0.1 // 10% de toler√¢ncia\n      \n      // Se estamos pr√≥ximos de onde uma se√ß√£o importante pode estar\n      if (Math.abs(progressRatio - sectionProgress) < tolerance) {\n        // E h√° risco de cortar (se√ß√£o come√ßaria no final da p√°gina)\n        const riskZone = currentY + (availableHeight * 0.8) // √öltimos 20%\n        \n        if (proposedEnd > riskZone) {\n          console.log(`üö® Poss√≠vel se√ß√£o '${section.name}' detectada em ~${(sectionProgress * 100).toFixed(0)}% do documento`)\n          \n          return {\n            adjusted: true,\n            newEnd: Math.max(riskZone - 5, currentY + availableHeight * 0.6), // Margem de 5mm\n            reason: `Poss√≠vel ${section.name}`\n          }\n        }\n      }\n    }\n    \n    return { adjusted: false }\n  }\n\n  /**\n   * M√©todo de fallback para convers√£o simples\n   */\n  async createFallbackPdf(fileName) {\n    console.log('‚ö†Ô∏è Usando m√©todo de fallback...')\n    \n    await this.loadLibraries()\n    \n    const doc = new this.jsPDF()\n    \n    // Cabe√ßalho\n    doc.setFontSize(16)\n    doc.setFont('helvetica', 'bold')\n    doc.text('CONVERS√ÉO AUTOM√ÅTICA', 105, 30, { align: 'center' })\n    \n    doc.setFontSize(14)\n    doc.setFont('helvetica', 'normal')\n    doc.text('Documento Word Convertido', 105, 45, { align: 'center' })\n    \n    // Informa√ß√µes\n    doc.setFontSize(12)\n    doc.text('Status: Convers√£o com formata√ß√£o limitada', 20, 70)\n    doc.text(`Arquivo original: ${fileName}`, 20, 85)\n    doc.text(`Data de convers√£o: ${new Date().toLocaleDateString('pt-BR', { \n      day: '2-digit', \n      month: '2-digit', \n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    })}`, 20, 100)\n    \n    // Mensagem explicativa\n    doc.setFontSize(11)\n    doc.text('OBSERVA√á√ÉO:', 20, 125)\n    doc.text('O sistema detectou que o documento Word possui formata√ß√£o complexa', 20, 140)\n    doc.text('que n√£o p√¥de ser totalmente preservada na convers√£o autom√°tica.', 20, 155)\n    \n    doc.text('Para obter um PDF com formata√ß√£o id√™ntica ao documento original,', 20, 175)\n    doc.text('recomendamos usar uma das seguintes alternativas:', 20, 190)\n    \n    doc.text('‚Ä¢ Microsoft Word: Arquivo ‚Üí Salvar como ‚Üí PDF', 25, 210)\n    doc.text('‚Ä¢ LibreOffice Writer: Arquivo ‚Üí Exportar como PDF', 25, 225)\n    doc.text('‚Ä¢ Google Docs: Arquivo ‚Üí Fazer download ‚Üí PDF', 25, 240)\n    doc.text('‚Ä¢ Ferramentas online: IlovePDF, SmallPDF, etc.', 25, 255)\n    \n    // Rodap√©\n    doc.setFontSize(9)\n    doc.setTextColor(100, 100, 100)\n    doc.text('Sistema ComprarBem - Convers√£o autom√°tica de documentos', 105, 280, { align: 'center' })\n\n    return doc.output('blob')\n  }\n\n  /**\n   * M√âTODO PREMIUM: Convers√£o usando docx2pdf especializado\n   */\n  async convertUsingDocx2Pdf(fileUrl, fileName) {\n    try {\n      console.log('üöÄ Tentando convers√£o PREMIUM com docx2pdf...')\n      \n      // Tentar carregar biblioteca especializada\n      let docx2pdf\n      try {\n        docx2pdf = await import('docx2pdf')\n      } catch {\n        // Se n√£o dispon√≠vel, simular\n        throw new Error('docx2pdf n√£o dispon√≠vel')\n      }\n      \n      const response = await fetch(fileUrl)\n      const arrayBuffer = await response.arrayBuffer()\n      \n      // Converter diretamente\n      const pdfBuffer = await docx2pdf.convert(arrayBuffer, {\n        preserveFormatting: true,\n        preserveTables: true,\n        preserveImages: true,\n        preserveLayout: true,\n        quality: 'high'\n      })\n      \n      return {\n        blob: new Blob([pdfBuffer], { type: 'application/pdf' }),\n        fileName: `${fileName}_Premium.pdf`\n      }\n      \n    } catch (error) {\n      throw new Error(`Docx2PDF falhou: ${error.message}`)\n    }\n  }\n}\n\n// Inst√¢ncia singleton\nexport const wordToPdfService = new WordToPdfService()\n\n// Fun√ß√£o de conveni√™ncia para uso direto\nexport async function convertWordToPdf(fileUrl, fileName) {\n  try {\n    return await wordToPdfService.convertWordToPdf(fileUrl, fileName)\n  } catch (error) {\n    console.warn('Fallback para convers√£o simples:', error.message)\n    await wordToPdfService.loadLibraries()\n    return {\n      blob: await wordToPdfService.createFallbackPdf(fileName),\n      fileName: `${fileName}_Fallback.pdf`\n    }\n  }\n}\n\n/**\n * FUN√á√ÉO ESPECIAL: Convers√£o com servidor LibreOffice local\n * Para usar: configure LIBREOFFICE_API_URL no localStorage\n * Exemplo: localStorage.setItem('libreoffice_api_url', 'http://localhost:8080')\n */\nexport async function convertWordToPdfWithLibreOffice(fileUrl, fileName) {\n  const service = new WordToPdfService()\n  try {\n    return await service.convertUsingLibreOffice(fileUrl, fileName)\n  } catch (error) {\n    console.warn('LibreOffice n√£o dispon√≠vel, usando fallback:', error.message)\n    return await convertWordToPdf(fileUrl, fileName)\n  }\n}\n\n/**\n * FUN√á√ÉO EXPERIMENTAL: Convers√£o preservando 100% do layout\n * Esta fun√ß√£o tenta usar o melhor m√©todo dispon√≠vel\n */\nexport async function convertWordToPdfPerfect(fileUrl, fileName) {\n  const service = new WordToPdfService()\n  \n  // Lista de m√©todos em ordem de qualidade\n  const perfectMethods = [\n    async () => await service.convertUsingDocx2Pdf(fileUrl, fileName),\n    async () => await service.convertUsingLibreOffice(fileUrl, fileName),\n    async () => await service.convertUsingPDFLib(fileUrl, fileName),\n    async () => await service.convertUsingMammothOptimized(fileUrl, fileName)\n  ]\n  \n  for (const method of perfectMethods) {\n    try {\n      const result = await method()\n      if (result && result.blob && result.blob.size > 1000) {\n        return result\n      }\n    } catch (error) {\n      console.warn('M√©todo falhou, tentando pr√≥ximo:', error.message)\n      continue\n    }\n  }\n  \n  // Se todos falharam, usar fallback b√°sico\n  return await convertWordToPdf(fileUrl, fileName)\n} \n\n\n\n\n"],"names":["WordToPdfService","constructor","this","docxConverter","pdfLib","mammoth","jsPDF","html2canvas","convertWordToPdf","fileUrl","fileName","console","log","methods","name","fn","convertUsingCloudConvert","convertUsingDocx2Pdf","convertUsingLibreOffice","convertUsingPDFLib","convertUsingWordAPI","convertUsingMammothOptimized","method","result","blob","error","warn","message","createFallbackPdf","pdfLibModule","response","fetch","arrayBuffer","fileType","detectFileType","convertDocxDirectly","Error","libreOfficeUrl","getLibreOfficeUrl","formData","FormData","append","convertResponse","body","ok","pdfBlob","apiKey","getCloudConvertApiKey","length","substring","testResponse","headers","testError","text","status","userData","json","data","email","subscription","plan","usage","conversions","limits","fileBlob","Blob","jobResponse","JSON","stringify","tasks","operation","input","input_format","output_format","options","pdf_a","page_range","margin_top","margin_bottom","margin_left","margin_right","errorText","statusText","job","uploadTask","find","t","uploadForm","form","Object","keys","parameters","forEach","key","url","jobStatus","Promise","resolve","setTimeout","statusResponse","id","exportTask","pdfUrl","files","pdfResponse","getMicrosoftApiKey","loadLibraries","styleMap","includeDefaultStyleMap","includeEmbeddedStyleMap","preserveEmptyParagraphs","convertImage","images","imgElement","image","read","then","imageBuffer","src","contentType","style","convertToHtml","value","optimizedHtml","prepareHtmlForMaxFidelity","imageData","renderHtmlToImageOptimized","createPdfFromImageOptimized","mammothModule","jsPDFModule","html2canvasModule","all","default","header","Uint8Array","slice","process","LIBREOFFICE_API_URL","localStorage","getItem","MICROSOFT_API_KEY","API_KEY_CLOUDCONVERT","CLOUDCONVERT_API_KEY","htmlContent","ultraOptimizedHtml","iframe","document","createElement","cssText","appendChild","contentDocument","open","write","close","onload","canvas","scale","useCORS","allowTaint","backgroundColor","width","height","scrollHeight","windowWidth","windowHeight","x","y","scrollX","scrollY","foreignObjectRendering","imageTimeout","removeContainer","logging","letterRendering","onclone","clonedDoc","transform","transformOrigin","dataUrl","toDataURL","parentNode","removeChild","doc","orientation","unit","format","compress","pageWidth","pageHeight","margin","availableWidth","availableHeight","scaleByWidth","imgWidth","imgHeight","totalPages","Math","ceil","pageNum","addPage","yOffsetInImage","yPosition","addImage","undefined","output","size","extractHtmlFromWord","byteLength","messages","prepareHtmlForRendering","renderHtmlToImage","pageBreakHtml","addPageBreaksToHtml","renderPagesIndividually","renderHtmlToImageFallback","processedHtml","replace","paginatedHtml","getPrintCSS","targetElement","innerText","container","innerHTML","fallbackError","createPdfFromImage","dataUrlLength","toFixed","img","Image","reject","onerror","smartPageBreaks","calculateSmartPageBreaks","startY","pageEndY","endY","actualPageHeight","pageBreaks","currentY","nextPageEnd","min","riskZoneStart","riskZoneEnd","progressRatio","sectionDetected","detectSectionInCurrentPage","adjusted","newEnd","reason","minPageHeight","push","proposedEnd","documentSections","progress","risk","section","sectionProgress","tolerance","abs","riskZone","max","setFontSize","setFont","align","Date","toLocaleDateString","day","month","year","hour","minute","setTextColor","docx2pdf","pdfBuffer","convert","preserveFormatting","preserveTables","preserveImages","preserveLayout","quality","type","wordToPdfService","async"],"sourceRoot":""}